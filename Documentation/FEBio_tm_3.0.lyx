#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass extbook
\begin_preamble
% Converted from Microsoft Word to LaTeX
% by Chikrii Softlab Word2TeX converter (version 5.0)
% Copyright (C) 1999-2011 Chikrii Softlab. All rights reserved.
% http://www.chikrii.com
% mailto: support@chikrii.com
% License: CSL#005010

\usepackage{latexsym}
\end_preamble
\use_default_options false
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language english
\language_package none
\inputencoding auto
\fontencoding default
\font_roman "default" "default"
\font_sans "helvet" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family sfdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type numerical
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Dev}{\operatorname{Dev}}
{\text{Dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\dev}{\operatorname{dev}}
{\text{dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\grad}{\operatorname{grad}}
{\text{grad}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Grad}{\operatorname{Grad}}
{\text{Grad}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\divg}{\operatorname{div}}
{\text{div}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Ei}{\operatorname{Ei}}
{\text{Ei}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\text{tr}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Divg}{\operatorname{Div}}
{\text{Div}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\cay}{\operatorname{cay}}
{\text{cay}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\rot}{\operatorname{rot}}
{\text{rot}}
\end_inset


\end_layout

\begin_layout Title
\begin_inset Graphics
	filename Figures/FigFEBioTitle.pdf
	width 4.88in

\end_inset


\series bold

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\series default
Theory Manual Version 3.0 
\end_layout

\begin_layout Date
Last Updated: August 29, 2018 
\end_layout

\begin_layout Paragraph*
Contributors
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Steve Maas (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:steve.maas@utah.edu}{steve.maas@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dave Rawlins (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:rawlins@sci.utah.edu}{rawlins@sci.utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Jeffrey Weiss (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:jeff.weiss@utah.edu}{jeff.weiss@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Gerard Ateshian (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:ateshian@columbia.edu}{ateshian@columbia.edu}
\end_layout

\end_inset

)
\end_layout

\begin_layout Paragraph*
Contact address
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Musculoskeletal Research Laboratories, University of Utah
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

72 S.
 Central Campus Drive, Room 2646
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Salt Lake City, Utah
\end_layout

\begin_layout Paragraph*
Website
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
MRL: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://mrl.sci.utah.edu}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

FEBio: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://febio.org}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Forum
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{https://forums.febio.org/index.php}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Acknowledgments
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Development of the FEBio project is supported in part by a grant from the
 U.S.
 National Institutes of Health (R01GM083925).
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename Figures/NIHlogo.png
	lyxscale 25
	height 0.75in

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:introduction"

\end_inset

 
\end_layout

\begin_layout Section
Overview of FEBio
\begin_inset CommandInset label
LatexCommand label
name "sec:overview"

\end_inset


\end_layout

\begin_layout Standard
FEBio is an implicit, nonlinear finite element solver that is specifically
 designed for applications in biomechanics.
 It offers analyses, constitutive models and boundary conditions that are
 relevant for this particular field.
 This section describes briefly the available features of FEBio.
 A more detailed overview of features can be found in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{http://help.mrl.sci.utah.edu/help/index.jsp}{
\backslash
emph{FEBio User's Manual}}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
FEBio supports two analysis types, namely 
\emph on
quasi-static
\emph default
 and 
\emph on
quasi-static poroelastic
\emph default
.
 In a 
\emph on
quasi-static
\emph default
 analysis the (quasi-) static response of the system is sought; inertial
 terms are ignored.
 In a 
\emph on
quasi-static poroelastic
\emph default
 analysis a coupled solid-fluid problem is solved.
 The latter analysis type is useful for modeling tissues that have high
 water content and the explicit modeling of fluid movement relative to the
 solid phase is important.
\end_layout

\begin_layout Standard
Several nonlinear constitutive models are available to allow the user to
 model the often complicated biological tissue behavior.
 Several isotropic constitutive models are supported such as Neo-Hookean,
 Mooney-Rivlin, Veronda-Westmann, Arruda-Boyce and Ogden.
 These models have a nonlinear stress-strain response.
 In addition to the isotropic models, there are several anisotropic models
 available.
 These materials show anisotropic behavior in at least one preferred direction
 and are useful for modeling biological tissues such as tendons, muscles
 and other tissues that contain fibers.
 FEBio also contains a 
\emph on
rigid body 
\emph default
material model, which can be used to model rigid structures whose deformation
 is negligible compared to the deformable geometry.
\end_layout

\begin_layout Standard
Biological tissues can interact in very complicated ways.
 Therefore FEBio supports a wide range of boundary conditions to model these
 interactions.
 These include prescribed displacements, nodal forces, and pressure forces.
 Deformable models can also be connected to rigid bodies so that the user
 can model prescribed rotations and torques.
 Rigid bodies can be connected with rigid joints.
 Even more complicated interactions can be modeled using FEBio's contact
 interfaces.
 The user can choose between different types of contact interfaces, such
 as sliding interfaces, tied interfaces and rigid wall interfaces.
 A sliding interface is defined between two surfaces that are allowed to
 separate and slide across each other but are not allowed to penetrate.
 The rigid wall interface is also similar to the sliding interface, except
 that one of the contacting surfaces is a movable rigid wall.
 As of version 1.2, there is an implementation of a sliding interface that
 allows for fluid flow crossing the contact interface.
 The tied interface is similar to the sliding interface, but in this case,
 the surfaces are not allowed to slide or separate.
 In addition, the user may specify a body force which can be used to model
 the effects of gravity or base acceleration.
\end_layout

\begin_layout Section
About this document
\begin_inset CommandInset label
LatexCommand label
name "sec:about-this-document"

\end_inset


\end_layout

\begin_layout Standard
This document is a part of a set of three manuals that accompany FEBio:
 the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{http://help.mrl.sci.utah.edu/help/index.jsp}{
\backslash
emph{FEBio User's Manual}}
\end_layout

\end_inset

, describing how to use FEBio, the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{http://febiodoc.sci.utah.edu/doxygen/}{
\backslash
emph{FEBio Developer's 
\end_layout

\begin_layout Plain Layout

Manual}}
\end_layout

\end_inset

 for users who wish to modify or add features to the code, and this manual,
 which describes the theory behind most of the FEBio algorithms.
\end_layout

\begin_layout Standard
The purpose of this manual is to provide theoretical background on many
 of the algorithms that are implemented in FEBio.
 In this way the user can develop a better understanding of how the program
 works and how it can be used to create well defined biomechanical simulations.
 The authors have tried to be as detailed as possible to make the text coherent
 and comprehensible, but due to the complexity of some of the topics, some
 descriptions only skim the surface.
 Many of the theoretical ideas discussed in this manual can and have filled
 entire bookshelves.
 The explanations contained herein should be sufficient to give the reader
 a basic understanding of the theoretical developments.
 References to textbooks and the primary literature are provided for further
 reading.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:continuum-mechanics"

\end_inset

 starts with a brief overview of some of the important concepts in continuum
 mechanics.
 Readers who are already familiar with this field can skip this chapter,
 although the material may be useful to get familiar with the notation and
 terminology used in this manual.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Nonlinear-FE-Method"

\end_inset

 describes the nonlinear finite element method.
 It also explains the Newton-Raphson method, which is the basis for most
 implementations of the nonlinear finite element method.
 A more specialized version of this algorithm, the BFGS method, is described
 as well since it is used in FEBio.
\end_layout

\begin_layout Standard
In Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Element-Library"

\end_inset

 the different element types that are available in FEBio are described in
 detail.
 FEBio currently supports 3D solid elements, such as the linear hexahedral,
 pentahedral and tetrahedral elements, as well as quadrilateral and triangular
 shell elements.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Constitutive-Models"

\end_inset

 contains a detailed description of the material models in FEBio.
 Most of these models are based on hyperelasticity, which is introduced
 in chapter 2.
 Several transversely isotropic materials are described as well.
 This also discusses the biphasic material and its implementation in FEBio.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Contact-and-Coupling"

\end_inset

 describes the basics of the theory of contact and coupling.
 In FEBio the user can connect the different parts of the geometry in a
 variety of ways.
 There are rigid interfaces where a deformable model is attached to a rigid
 model, rigid joints where two or more rigid bodies connect, and sliding
 interfaces where two surfaces are allowed to separate and slide across
 each other but are not allowed to penetrate.
 The various contact and coupling algorithms are discussed as well together
 with their implementation in FEBio.
\end_layout

\begin_layout Chapter
Continuum Mechanics
\begin_inset CommandInset label
LatexCommand label
name "chap:continuum-mechanics"

\end_inset


\end_layout

\begin_layout Standard
This chapter contains an overview of some of the important concepts from
 continuum mechanics and establishes some of the notation and terminology
 that will be used in the rest of this document.
 The section begins by introducing the important concepts of deformation,
 stress and strain.
 Next the concept of hyperelasticity is discussed.
 Finally the concept of virtual work is discussed.
 This concept will be used later to derive the nonlinear finite element
 equations.
 For a more thorough introduction to the mathematics needed for continuum
 mechanics, the user can consult 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
\end_layout

\begin_layout Section
Vectors and Tensors
\begin_inset CommandInset label
LatexCommand label
name "sec:vectors-and-tensors"

\end_inset


\end_layout

\begin_layout Standard
It is assumed that the reader is familiar with the concepts of vectors and
 tensors.
 This section summarizes the notation and some useful relations that will
 be used throughout the manual.
\end_layout

\begin_layout Standard
Vectors are denoted by small, bold letters, e.g.
 
\series bold
v
\series default
.
 Their components will be denoted by 
\begin_inset space \quad{}
\end_inset


\begin_inset Formula $v_{i}$
\end_inset

, where, unless otherwise stated, Latin under scripts such as 
\begin_inset Formula $i$
\end_inset

or 
\begin_inset Formula $I$
\end_inset

will range from 1 to 3.
 In matrix form a vector will be represented as a column vector and its
 transpose as a row vector: 
\begin_inset Formula 
\begin{equation}
\begin{array}{cc}
\mathbf{v}=\left(\begin{array}{c}
v_{1}\\
v_{2}\\
v_{3}
\end{array}\right),\quad & \mathbf{v}^{T}=\left(\begin{array}{ccc}
v_{1}, & v_{2}, & v_{3}\end{array}\right)\end{array}.\label{eq1}
\end{equation}

\end_inset

The following products are defined between vectors.
 Assume 
\series bold
u
\series default
, 
\series bold
v
\series default
 are vectors.
 Also note that the Einstein summation convention is used throughout this
 manual 
\begin_inset CommandInset citation
LatexCommand citep
key "Lai10"

\end_inset

.
\end_layout

\begin_layout Standard
The 
\emph on
dot 
\emph default
or 
\emph on
scalar product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}\cdot\mathbf{v}=u_{i}v_{i}\,.\label{eq2}
\end{equation}

\end_inset

The 
\emph on
cross product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}\times\mathbf{v}=\left[\begin{array}{c}
u_{2}v_{3}-u_{3}v_{2}\\
u_{3}v_{1}-u_{1}v_{3}\\
u_{1}v_{2}-u_{2}v_{1}
\end{array}\right]\,.\label{eq3}
\end{equation}

\end_inset

The 
\emph on
vector
\emph default
 
\emph on
outer product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{u}\otimes\mathbf{v}\right)_{ij}=u_{i}v_{j}\,.\label{eq4}
\end{equation}

\end_inset

Note that vectors are also known as first order tensors.
 Scalars are known as zero order tensors.
 The outer product, defined by equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq4"

\end_inset

, is a second order tensor.
\end_layout

\begin_layout Standard
Second order tensors are denoted by bold, capital letters, e.g.
 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
.
 Some exceptions will be made to remain consistent with the literature.
 For instance, the Cauchy stress tensor is denoted by 
\begin_inset Formula $\mathbf{\boldsymbol{\sigma}}$
\end_inset

.
 However, the nature of the objects will always be clear from the context.
 The following operations on tensors are defined.
 Assume 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset

 
\series default
are second-order tensors.
\end_layout

\begin_layout Standard
The 
\emph on
double contraction
\emph default
 or 
\emph on
tensor inner product
\emph default
 is defined as: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}:\mathbf{B}=A_{ij}B_{ij}\,.\label{eq5}
\end{equation}

\end_inset

The 
\emph on
trace
\emph default
 is defined as: 
\begin_inset Formula 
\begin{equation}
\tr\mathbf{A}=\mathbf{I}:\mathbf{A}=A_{ii}\,.\label{eq6}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the second order identity tensor with components 
\begin_inset Formula $\delta_{ij}$
\end_inset

.
\end_layout

\begin_layout Standard
In general the components of tensors will change under a change of coordinate
 system.
 Nevertheless, certain intrinsic quantities associated with them will remain
 invariant under such a transformation.
 The scalar product between two vectors is such an example.
 The double contraction between two second-order tensors is another example.
 The following set of invariants for second-order tensors is commonly used:
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}I_{1} & =\tr\mathbf{A},\\
I_{2} & =\frac{1}{2}\left(\left(\tr\mathbf{A}\right)^{2}-\tr\mathbf{A}^{2}\right)\\
I_{3} & =\det\mathbf{A}.
\end{aligned}
\,.\label{eq7}
\end{equation}

\end_inset

A tensor 
\series bold

\begin_inset Formula $\mathbf{S}$
\end_inset

 
\series default
is called symmetric if it is equal to its transpose: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\mathbf{S}^{T}\,.\label{eq8}
\end{equation}

\end_inset

A tensor 
\series bold

\begin_inset Formula $\mathbf{W}$
\end_inset

 
\series default
is called anti-symmetric if it is equal to the negative of its transpose:
 
\begin_inset Formula 
\begin{equation}
\mathbf{W}=-\mathbf{W}^{T}\,.\label{eq9}
\end{equation}

\end_inset

Any second order tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
can be written as the sum of a symmetric tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset


\series bold
 
\series default
and an anti-symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{W}$
\end_inset


\series default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}=\mathbf{S}+\mathbf{W},\label{eq10}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\frac{1}{2}\left(\mathbf{A}+\mathbf{A}^{T}\right),\mbox{\thinspace and\thinspace}\mathbf{W}=\frac{1}{2}\left(\mathbf{A}-\mathbf{A}^{T}\right).\label{eq11}
\end{equation}

\end_inset

Also note that for any tensor 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset

 
\series default
the following holds: 
\begin_inset Formula 
\begin{equation}
\mathbf{B}:\mathbf{A}=\mathbf{B}:\mathbf{S}\,,\quad\mathbf{B}:\mathbf{W}=\mathbf{0}\,.\label{eq12}
\end{equation}

\end_inset

With any anti-symmetric tensor a dual vector 
\series bold

\begin_inset Formula $\mathbf{w}$
\end_inset

 
\series default
can be associated such that, 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{w}}\cdot\mathbf{u}=\mathbf{w}\times\mathbf{u}\,,\label{eq13}
\end{equation}

\end_inset

where the second order tensor 
\begin_inset Formula $\mathbf{\hat{w}}$
\end_inset

 is defined as, 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{w}}=\left[\begin{array}{ccc}
0 & -w_{3} & w_{2}\\
w_{3} & 0 & -w_{1}\\
-w_{2} & w_{1} & 0
\end{array}\right]\,.\label{eq14}
\end{equation}

\end_inset

A second order 
\series bold

\begin_inset Formula $\mathbf{Q}$
\end_inset

 
\series default
tensor is called 
\emph on
orthogonal 
\emph default
if 
\begin_inset Formula $\mathbf{Q}^{-1}=\mathbf{Q}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
In the implementation of the FE method it is often convenient to write symmetric
 second-order tensors using 
\emph on
Voigt notation
\emph default
.
 In this notation the components of a 2
\begin_inset Formula $^{\mathrm{nd}}$
\end_inset

 order symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
are arranged as a column vector: 
\begin_inset Formula 
\begin{equation}
\left[\mathbf{A}\right]=\left[\begin{array}{c}
A_{11}\\
A_{22}\\
A_{33}\\
A_{12}\\
A_{23}\\
A_{13}
\end{array}\right]\,.\label{eq15}
\end{equation}

\end_inset

Higher order tensors will be denoted by bold, capital, script symbols, e.g.
 
\begin_inset Formula $\boldsymbol{\mathcal{A}}$
\end_inset

.
 An example of a third-order tensor is the 
\emph on
permutation tensor 
\emph default

\begin_inset Formula $\mathcal{E}_{ijk}$
\end_inset

, whose components are 1 for an even permutation of 
\begin_inset Formula $\left(1,2,3\right)$
\end_inset

, -1 for an odd permutation of 
\begin_inset Formula $\left(1,2,3\right)$
\end_inset

 and zero otherwise.
 The permutation symbol is useful for expressing the cross-product of two
 vectors in index notation: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{u}\times\mathbf{v}\right)_{i}=\mathcal{E}_{ijk}u_{j}v_{k}\,.\label{eq16}
\end{equation}

\end_inset

An example of a fourth-order tensor is the elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 which, in linear elasticity theory, relates the small strain tensor 
\begin_inset Formula $\mathbf{\boldsymbol{\varepsilon}}$
\end_inset

 and the Cauchy stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}=\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}$
\end_inset

.
\end_layout

\begin_layout Standard
Higher order tensors can be constructed from second order tensors in a similar
 way as second order tensors can be constructed from vectors.
 If 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{B}$
\end_inset

 are second order tensors, then the following fourth order tensors can be
 defind by requiring that the following must hold for any second order tensor
 
\begin_inset Formula $\mathbf{X}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\otimes\mathbf{B}\right):\mathbf{X}=\left(\mathbf{B}:\mathbf{X}\right)\mathbf{A}\,,\label{eq17}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\underline{\otimes}\,\mathbf{B}\right):\mathbf{X}=\mathbf{A}\cdot\mathbf{X}\cdot\mathbf{B}^{T}\,,\label{eq18}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\overline{\otimes}\,\mathbf{B}\right):\mathbf{X}=\mathbf{A}\cdot\mathbf{X}^{T}\cdot\mathbf{B}^{T}\,,\label{eq19}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\underline{\overline{\otimes}}\,\mathbf{B}\right):\mathbf{X}=\frac{1}{2}\left(\mathbf{A}\cdot\mathbf{X}\cdot\mathbf{B}^{T}+\mathbf{A}\cdot\mathbf{X}^{T}\cdot\mathbf{B}^{T}\right)\,.\label{eq20}
\end{equation}

\end_inset

The Cartesian component forms of the operators 
\begin_inset Formula $\otimes$
\end_inset

, 
\begin_inset Formula $\underline{\otimes}$
\end_inset

, 
\begin_inset Formula $\overline{\otimes}$
\end_inset

 and 
\begin_inset Formula $\underline{\overline{\otimes}}$
\end_inset

 are defined as follows: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\otimes\mathbf{B}\right)_{ijkl}=\mathbf{A}_{ij}\mathbf{B}_{kl}\,,\label{eq21}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\underline{\otimes}\,\mathbf{B}\right)_{ijkl}=\mathbf{A}_{ik}\mathbf{B}_{jl}\,,\label{eq22}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\overline{\otimes}\,\mathbf{B}\right)_{ijkl}=A_{il}B_{jk}\,,\label{eq23}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\,\underline{\overline{\otimes}}\,\mathbf{B}\right)_{ijkl}=\frac{1}{2}\left(A_{ik}B_{jl}+A_{il}B_{jk}\right)\,.\label{eq24}
\end{equation}

\end_inset

The fourth order identity tensors are defined as: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{A} & =\mathcal{I}:\mathbf{A}\,,\\
\mathbf{A}^{T} & =\overline{\mathcal{I}}:\mathbf{A}\,,
\end{aligned}
\label{eq25}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{I}}=\mathbf{I}\,\underline{\otimes}\,\mathbf{I}$
\end_inset

 and 
\begin_inset Formula $\overline{\boldsymbol{\mathcal{I}}}=\mathbf{I}\,\overline{\otimes}\,\mathbf{I}$
\end_inset

.
 The components are given by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathcal{I}_{ijkl} & =\delta_{ik}\delta_{jl}\,,\\
\overline{\mathcal{I}}_{ijkl} & =\delta_{il}\delta_{jk}\,.
\end{aligned}
\label{eq26}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
The Directional Derivative
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Directional-Derivative"

\end_inset


\end_layout

\begin_layout Standard
In later sections the nonlinear finite element method will be formulated.
 Anticipating an iterative solution method to solve the nonlinear equations,
 it will be necessary to linearize the quantities involved.
 This linearization process will utilize a construction called the 
\emph on
directional derivative 
\emph default

\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
\end_layout

\begin_layout Standard
The directional derivative of a function 
\begin_inset Formula $f\left(\mathbf{x}\right)$
\end_inset

 is defined as follows: 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}f\left(\mathbf{x}+\varepsilon\mathbf{u}\right)\,.\label{eq27}
\end{equation}

\end_inset

The quantity 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset

 
\series default
may be a scalar, a vector or even a vector of unknown functions.
 For instance, consider a scalar function 
\begin_inset Formula $f\left(\mathbf{x}\right)$
\end_inset

, where 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset

 
\series default
is the position vector in 
\begin_inset Formula $\mathbb{R}^{3}$
\end_inset

.
 In this case the directional derivative is given by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Df\left(\mathbf{x}\right)\left[\mathbf{u}\right] & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}f\left(\mathbf{x}+\varepsilon\mathbf{u}\right)\\
 & =\frac{\partial f}{\partial x_{i}}u_{i}\\
 & =\nabla f\cdot\mathbf{u}\,.
\end{aligned}
\label{eq28}
\end{equation}

\end_inset

Here, the symbol 
\begin_inset Formula $\nabla$
\end_inset

(
\begin_inset Quotes eld
\end_inset

nabla
\begin_inset Quotes erd
\end_inset

) depicts the gradient operator.
\end_layout

\begin_layout Standard
The linearization of a function implies that it is approximated by a linear
 function.
 Using the directional derivative, a function 
\begin_inset Formula $f$
\end_inset

 can be linearized as follows: 
\begin_inset Formula 
\begin{equation}
f\left(\mathbf{x}+\mathbf{u}\right)\cong f\left(\mathbf{x}\right)+Df\left(\mathbf{x}\right)\left[\mathbf{u}\right].\label{eq29}
\end{equation}

\end_inset

The directional derivative obeys the usual properties for derivatives.
\end_layout

\begin_layout Enumerate

\emph on
sum rule
\emph default
: If 
\begin_inset Formula $f=f_{1}+f_{2}$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=Df_{1}\left(\mathbf{x}\right)\left[\mathbf{u}\right]+Df_{2}\left(\mathbf{x}\right)\left[\mathbf{u}\right]\,.\label{eq30}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\emph on
product rule
\emph default
: If 
\begin_inset Formula $f=f_{1}\cdot f_{2}$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=f_{1}\left(\mathbf{x}\right)\cdot Df_{2}\left(\mathbf{x}\right)\left[\mathbf{u}\right]+f_{2}\cdot Df_{1}\left(\mathbf{x}\right)\left[\mathbf{u}\right]\,.\label{eq31}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\emph on
chain rule
\emph default
: If 
\begin_inset Formula $f=g\left(h\left(\mathbf{x}\right)\right)$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=Dg\left(h\left(\mathbf{x}\right)\right)\left[Dh\left(\mathbf{x}\right)\left[\mathbf{u}\right]\right]\,.\label{eq32}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Deformation, Strain and Stress
\begin_inset CommandInset label
LatexCommand label
name "sec:Deformation-Strain-Stress"

\end_inset


\end_layout

\begin_layout Subsection
The deformation gradient tensor
\begin_inset CommandInset label
LatexCommand label
name "subsec:The-deformation-gradient"

\end_inset


\end_layout

\begin_layout Standard
Consider the deformation of an object from an initial or 
\emph on
reference configuration
\emph default
 to a deformed or 
\emph on
current configuration
\emph default
.
 The location of the material particles in the reference configuration are
 denoted by 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 and are known as the 
\emph on
material coordinates.

\emph default
 Their location in the current configuration is denoted by 
\begin_inset Formula $\mathbf{x}$
\end_inset

 and known as the 
\emph on
spatial coordinates
\emph default
.
 The 
\emph on
deformation
\emph default
 
\emph on
map
\emph default
 
\begin_inset Formula $\mathbf{\boldsymbol{\varphi}}$
\end_inset

, which is a mapping from 
\begin_inset Formula $\mathbb{R}^{3}$
\end_inset

to
\begin_inset Formula $\mathbb{R}^{3}$
\end_inset

, maps the coordinates of a material point to the spatial configuration:
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\boldsymbol{\mathbf{\varphi}}\left(\mathbf{X}\right)\,.\label{eq33}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigDeformationMap.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
The deformation map
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The displacement map 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset

 
\series default
is defined as the difference between the spatial and material coordinates:
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{X}+\mathbf{u}\left(\mathbf{X}\right)\,.\label{eq34}
\end{equation}

\end_inset

The 
\emph on
deformation gradient
\emph default
 is defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{F}=\frac{\partial\mathbf{\boldsymbol{\varphi}}}{\partial\mathbf{X}}\,.\label{eq35}
\end{equation}

\end_inset

The deformation gradient relates an infinitesimal vector in the reference
 configuration 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 to the corresponding vector in the current configuration: 
\begin_inset Formula 
\begin{equation}
d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}.\label{eq36}
\end{equation}

\end_inset

The determinant of the deformation tensor 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is called the 
\emph on
volume ratio
\emph default
; it gives the volume change, or equivalently the change in density: 
\begin_inset Formula 
\begin{equation}
\rho_{0}=\rho J\,.\label{eq37}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\rho_{0}$
\end_inset

 is the density in the reference configuration and 
\begin_inset Formula $\rho$
\end_inset

 is the current density.
\end_layout

\begin_layout Standard
When dealing with incompressible and nearly incompressible materials it
 will prove useful to separate the volumetric and the deviatoric (distortional)
 components of the deformation gradient.
 Such a separation must ensure that the deviatoric part of the deformation
 gradient, namely 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

, does not produce any change in volume.
 Noting that the determinant of the deformation gradient gives the volume
 ratio, the determinant of 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

 must therefore satisfy, 
\begin_inset Formula 
\begin{equation}
\det\mathbf{\tilde{F}}=1\,.\label{eq38}
\end{equation}

\end_inset

This condition can be achieved by choosing 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

 as, 
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}\,.\label{eq39}
\end{equation}

\end_inset

Using the polar decomposition of a second order tensor, the deformation
 gradient can be written as a product of a positive definite symmetric tensor
 
\begin_inset Formula $\mathbf{V}$
\end_inset


\series bold
 
\series default
(or 
\begin_inset Formula $\mathbf{U}$
\end_inset

)
\series bold
 
\series default
and a proper orthogonal tensor 
\series bold

\begin_inset Formula $\mathbf{R}$
\end_inset


\series default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{F}=\mathbf{V}\cdot\mathbf{R}=\mathbf{R}\cdot\mathbf{U}\,.\label{eq40}
\end{equation}

\end_inset


\begin_inset Formula $\mathbf{V}$
\end_inset

 is called the 
\emph on
left
\emph default
 
\emph on
stretch tensor
\emph default
, 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is called the 
\emph on
right stretch tensor 
\emph default
and the orthogonal tensor 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is called the 
\emph on
rotation
\emph default
.
\end_layout

\begin_layout Subsection
Strain
\begin_inset CommandInset label
LatexCommand label
name "subsec:strain"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
right Cauchy-Green deformation tensor
\emph default
 is defined as follows: 
\begin_inset Formula 
\begin{equation}
\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}\,.\label{eq41}
\end{equation}

\end_inset

This tensor is an example of a 
\emph on
material tensor
\emph default
 and is typically expressed a function of the material coordinates 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
.
 The 
\emph on
left Cauchy-Green deformation tensor 
\emph default
is defined as follows: 
\begin_inset Formula 
\begin{equation}
\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}\,.\label{eq42}
\end{equation}

\end_inset

This tensor is an example of a 
\emph on
spatial tensor
\emph default
 and is typically expressed as a function of the spatial coordinates 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
.
 The implementation of the updated Lagrangian finite element method used
 by FEBio is described in the spatial configuration.
\end_layout

\begin_layout Standard
The left and right deformation tensors can also be split into volumetric
 and deviatoric components.
 With the use of,
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq39"

\end_inset

 the deviatoric deformation tensors are: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{\tilde{C}} & =\tilde{\mathbf{F}}^{T}\cdot\tilde{\mathbf{F}}=J^{-2/3}\mathbf{C}\,,\\
\mathbf{\tilde{b}} & =\tilde{\mathbf{F}}\cdot\tilde{\mathbf{F}}^{T}=J^{-2/3}\mathbf{b}\,.
\end{aligned}
\label{eq43}
\end{equation}

\end_inset

The deformation tensors defined above are not good candidates for strain
 measures since in the absence of strain they become the identity tensor
 
\begin_inset Formula $\mathbf{I}$
\end_inset

.
 However, they can be used to define strain measures.
 The 
\emph on
Green-Lagrange strain tensor
\emph default
 is defined as: 
\begin_inset Formula 
\begin{equation}
\mathbf{E}=\frac{1}{2}\left(\mathbf{C}-\mathbf{I}\right)\,.\label{eq44}
\end{equation}

\end_inset

This tensor is a material tensor.
 Its spatial equivalent is known as the 
\emph on
Almansi strain tensor 
\emph default
and is defined as: 
\begin_inset Formula 
\begin{equation}
\mathbf{e}=\frac{1}{2}\left(\mathbf{I}-\mathbf{b}^{-1}\right)\,.\label{eq45}
\end{equation}

\end_inset

In the limit of small displacement gradients, the components of both strain
 tensors are identical, resulting in the 
\emph on
small strain tensor 
\emph default
or
\emph on
 infinitesimal strain tensor
\emph default
: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\varepsilon}=\frac{1}{2}\left(\frac{\partial\mathbf{u}}{\partial\mathbf{x}}+\left(\frac{\partial\mathbf{u}}{\partial\mathbf{x}}\right)^{T}\right)\,.\label{eq46}
\end{equation}

\end_inset

Note that the small strain tensor is also the linearization of the Green
 Lagrange strain, 
\begin_inset Formula 
\begin{equation}
D\mathbf{E}\left[\mathbf{u}\right]=\mathbf{F}^{T}\cdot\boldsymbol{\varepsilon}\cdot\mathbf{F}\,.\label{eq47}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:stress"

\end_inset


\end_layout

\begin_layout Standard
The traction 
\series bold

\begin_inset Formula $\mathbf{t}$
\end_inset


\series default
 on a plane bisecting the body is given by, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n},\label{eq48}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the 
\emph on
Cauchy stress tensor
\emph default
 and 
\series bold

\begin_inset Formula $\mathbf{n}$
\end_inset


\series default
 is the outward unit normal vector to the plane.
 It can be shown that by the conservation of angular momentum that this
 tensor is symmetric (
\begin_inset Formula $\sigma_{ij}=\sigma_{ji})$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Spencer84"

\end_inset

.
 The Cauchy stress tensor, a spatial tensor, is the actual physical stress,
 that is, the force per unit deformed area.
 To simplify the equations of continuum mechanics, especially when working
 in the material configuration, several other stress measures are often
 used.
 The 
\emph on
Kirchhoff stress tensor
\emph default
 is defined as 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}=J\boldsymbol{\sigma}\,.\label{eq49}
\end{equation}

\end_inset

The 
\emph on
first Piola-Kirchhoff stress tensor
\emph default
 is given as 
\begin_inset Formula 
\begin{equation}
\mathbf{P}=J\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,.\label{eq50}
\end{equation}

\end_inset

Note that 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset


\series default
, like 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
, is not symmetric.
 Also, like 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
, 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset

 
\series default
is known as a 
\emph on
two-point
\emph default
 tensor, meaning it is neither a material nor a spatial tensor.
 Since we have two strain tensors, one spatial and one material tensor,
 it would be useful to have similar stress measures.
 The Cauchy stress is a spatial tensor and the 
\emph on
second Piola-Kirchhoff (2
\emph default

\begin_inset Formula $^{nd}$
\end_inset


\emph on
 PK) stress tensor
\emph default
, defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=J\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,,\label{eq51}
\end{equation}

\end_inset

is a material tensor.
 The inverse relations are: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbf{\sigma}}=\frac{1}{J}\boldsymbol{\tau}\,,\quad\boldsymbol{\sigma}=\frac{1}{J}\mathbf{P}\cdot\mathbf{F}^{T}\,,\quad\boldsymbol{\sigma}=\frac{1}{J}\mathbf{F}\cdot\mathbf{S}\cdot\mathbf{F}^{T}\,.\label{eq52}
\end{equation}

\end_inset

In many practical applications it is physically relevant to separate the
 hydrostatic stress and the deviatoric stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 of the Cauchy stress tensor: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\tilde{\boldsymbol{\sigma}}+p\mathbf{I}\,.\label{eq53}
\end{equation}

\end_inset

Here, the pressure is defined as 
\begin_inset Formula $p=\frac{1}{3}\tr\boldsymbol{\sigma}$
\end_inset

.
 Note that the deviatoric Cauchy stress tensor satisfies 
\begin_inset Formula $\tr\tilde{\boldsymbol{\sigma}}=0$
\end_inset

.
\end_layout

\begin_layout Standard
The directional derivative of the 2
\begin_inset Formula $^{\mathrm{nd}}$
\end_inset

 PK stress tensor needs to be calculated for the linearization of the finite
 element equations.
 For a hyperelastic material, a linear relationship between the directional
 derivative of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 and the linearized strain 
\begin_inset Formula $D\mathbf{E}\left[\mathbf{u}\right]$
\end_inset

 can be obtained: 
\begin_inset Formula 
\begin{equation}
D\mathbf{S}\left[\mathbf{u}\right]=\boldsymbol{\mathbb{C}}:D\mathbf{E}\left[\mathbf{u}\right]\,.\label{eq54}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\mathbb{C}}$
\end_inset

 is a fourth-order tensor known as the 
\emph on
material elasticity tensor
\emph default
.
 Its components are given by, 
\begin_inset Formula $\sum$
\end_inset


\begin_inset Formula 
\begin{equation}
\mathbb{C}_{IJKL}=\frac{\partial S_{IJ}}{\partial E_{KL}}=\frac{4\partial^{2}\Psi}{\partial C_{IJ}\partial C_{KL}}\,,\label{eq55}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi$
\end_inset

 is the strain-energy density function for the hyperelastic material.
 The spatial equivalent – the 
\emph on
spatial elasticity tensor 
\emph default

\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 – can be obtained by, 
\begin_inset Formula 
\begin{equation}
\mathcal{C}_{ijkl}=\frac{1}{J}F_{iI}F_{jJ}F_{kK}F_{lL}\mathcal{C}_{IJKL}.\label{eq56}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
When the constitutive behavior is only a function of the current state of
 deformation, the material is 
\emph on
elastic
\emph default
.
 In the special case when the work done by the stresses during a deformation
 is only dependent on the initial state and the final state, the material
 is termed 
\emph on
hyperelastic
\emph default
 and its behavior is path-independent.
 As a consequence of the path-independence a 
\emph on
strain energy function 
\emph default
per unit undeformed volume can be defined as the work done by the stresses
 from the initial to the final configuration: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{F}\left(\mathbf{X}\right),\mathbf{X}\right)=\int\limits _{t_{0}}^{t}\mathbf{P}\left(\mathbf{F}\left(\mathbf{X}\right),\mathbf{X}\right):\mathbf{\dot{F}}\,dt\,.\label{eq57}
\end{equation}

\end_inset

The rate of change of the potential is then given by 
\begin_inset Formula 
\begin{equation}
\dot{\Psi}\left(\mathbf{F}\left(\mathbf{X}\right),\mathbf{X}\right)=\mathbf{P}:\mathbf{\dot{F}}\,.\label{eq58}
\end{equation}

\end_inset

Or alternatively, 
\begin_inset Formula 
\begin{equation}
P_{iJ}=\sum\limits _{i,J=1}^{3}\frac{\partial\Psi}{\partial F_{iJ}}\dot{F}_{iJ}\,.\label{eq59}
\end{equation}

\end_inset

Comparing 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq58"

\end_inset

 with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq59"

\end_inset

 reveals that 
\begin_inset Formula 
\begin{equation}
\mathbf{P}\left(\mathbf{F}\left(\mathbf{X}\right),\mathbf{X}\right)=\frac{\partial\Psi\left(\mathbf{F}\left(\mathbf{X}\right),\mathbf{X}\right)}{\partial\mathbf{F}}.\label{eq60}
\end{equation}

\end_inset

This general constitutive equation can be further simplified by observing
 that, as a consequence of the objectivity requirement, 
\begin_inset Formula $\Psi$
\end_inset

 may only depend on 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
 through the stretch tensor 
\series bold

\begin_inset Formula $\mathbf{U}$
\end_inset


\series default
 and must be independent of the rotation component 
\series bold

\begin_inset Formula $\mathbf{R}$
\end_inset


\series default
.
 For convenience, however, 
\begin_inset Formula $\Psi$
\end_inset

is often expressed as a function of 
\begin_inset Formula $\mathbf{C}=\mathbf{U}^{2}=\mathbf{F}^{T}\cdot\mathbf{F}$
\end_inset

.
 Noting that 
\begin_inset Formula $\frac{1}{2}\mathbf{\dot{C}}=\mathbf{\dot{E}}$
\end_inset

 is work conjugate to the second Piola-Kirchhoff stress 
\series bold

\begin_inset Formula $\mathbf{S}$
\end_inset


\series default
, establishes the following general relationships for hyperelastic materials:
 
\begin_inset Formula 
\begin{equation}
\dot{\Psi}=\frac{\partial\Psi}{\partial\mathbf{C}}:\mathbf{\dot{C}}=\frac{1}{2}\mathbf{S}:\mathbf{\dot{C}},\quad\boxed{\mathbf{S}\left(\mathbf{C}\left(\mathbf{X}\right),\mathbf{X}\right)=2\frac{\partial\Psi}{\partial\mathbf{C}}=\frac{\partial\Psi}{\partial\mathbf{E}}}\,.\label{eq61}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Isotropic Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:isotropic-hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
The hyperelastic constitutive equations discussed so far are unrestricted
 in their application.
 Isotropic material symmetry is defined by requiring the constitutive behavior
 to be independent of the material axis chosen and, consequently, 
\begin_inset Formula $\Psi$
\end_inset

 must only be a function of the invariants of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
, 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C}\left(\mathbf{X}\right),\mathbf{X}\right)=\Psi\left(I_{1},I_{2},I_{3},\mathbf{X}\right)\,,\label{eq62}
\end{equation}

\end_inset

where the invariants of 
\series bold
C 
\series default
are defined here as, 
\begin_inset Formula 
\begin{equation}
I_{1}=\tr\mathbf{C}=\mathbf{C}:\mathbf{I},\,I_{2}=\frac{1}{2}\left[\left(\tr\mathbf{C}\right)^{2}-\tr\mathbf{C}^{2}\right],\,I_{3}=\det\mathbf{C}=J^{2}\,.\label{eq63}
\end{equation}

\end_inset

As a result of the isotropic restriction, the second Piola-Kirchhoff stress
 tensor can be written as, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\frac{\partial\Psi}{\partial\mathbf{C}}=2\frac{\partial\Psi}{\partial I_{1}}\frac{\partial I_{1}}{\partial\mathbf{C}}+2\frac{\partial\Psi}{\partial I_{2}}\frac{\partial I_{2}}{\partial\mathbf{C}}+2\frac{\partial\Psi}{\partial I_{3}}\frac{\partial I_{3}}{\partial\mathbf{C}}\,.\label{eq64}
\end{equation}

\end_inset

The second order tensors formed by the derivatives of the invariants with
 respect to 
\series bold
C
\series default
 can be evaluated as follows: 
\begin_inset Formula 
\begin{equation}
\frac{\partial I_{1}}{\partial\mathbf{C}}=\mathbf{I}\,,\,\frac{\partial I_{2}}{\partial\mathbf{C}}=I_{1}\mathbf{I}-\mathbf{C}\,,\,\frac{\partial I_{3}}{\partial\mathbf{C}}=I_{3}\mathbf{C}^{-1}\,.\label{eq65}
\end{equation}

\end_inset

Introducing expressions 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq65"

\end_inset

 into equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq64"

\end_inset

 enables the second Piola-Kirchhoff stress to be evaluated as, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\left\{ \left(\Psi_{1}+I_{1}\Psi_{2}+I_{2}\Psi_{3})\right)\mathbf{I}-\left(\Psi_{2}+I_{1}\Psi_{3}\right)\mathbf{C}\right\} +\Psi_{3}\mathbf{C}^{2}\,,\label{eq66}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{I}=\partial\Psi/\partial I_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}=\partial\Psi/\partial I_{2}$
\end_inset

, and 
\begin_inset Formula $\Psi_{3}=\partial\Psi/\partial I_{3}$
\end_inset

.
\end_layout

\begin_layout Standard
The Cauchy stresses can now be obtained from the second Piola-Kirchhoff
 stresses by using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq52"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{2}{J}\left\{ \left(\Psi_{1}+I_{1}\Psi_{2}+I_{2}\Psi_{3})\right)\mathbf{b}-\left(\Psi_{2}+I_{1}\Psi_{3}\right)\mathbf{b}^{2}\right\} +\frac{1}{J}\Psi_{3}\mathbf{b}^{3}\,.\label{eq67}
\end{equation}

\end_inset

Note that in this equation 
\begin_inset Formula $\Psi_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}$
\end_inset

, and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 still involve derivatives with respect to the invariants of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
.
 However, since the invariants of 
\series bold

\begin_inset Formula $\mathbf{b}$
\end_inset


\series default
 are identical to those of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
, the quantities
\begin_inset Formula $\Psi_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}$
\end_inset

 and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 may also be considered to be the derivatives with respect to the invariants
 of 
\series bold

\begin_inset Formula $\mathbf{b}$
\end_inset


\series default
.
\end_layout

\begin_layout Subsection
Isotropic Elasticity in Principal Directions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Elasticity-Principal"

\end_inset


\end_layout

\begin_layout Standard
For isotropic materials, the principal directions of the strain and stress
 tensors are the same.
 Let the eigenvalues of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 be denoted by 
\begin_inset Formula $\lambda_{i}^{2}$
\end_inset

 (
\begin_inset Formula $i=1,2,3)$
\end_inset

, then the strain energy density may be given as a function of these eigenvalues
, 
\begin_inset Formula $\Psi\left(\lambda_{1}^{2},\lambda_{2}^{2},\lambda_{3}^{2}\right)$
\end_inset

.
 To derive the expression for the stress, recognize that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\lambda_{i}^{2}}{\partial\mathbf{C}}=\mathbf{N}_{i}\otimes\mathbf{N}_{i}\equiv\mathbf{A}_{i}\,,\label{eq68}
\end{equation}

\end_inset

where the 
\begin_inset Formula $\mathbf{N}_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 It follows that the second Piola-Kirchhoff stress may be represented as
 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\sum\limits _{i=1}^{3}S_{i}\mathbf{A}_{i}\,,\label{eq69}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
S_{i}=2\frac{\partial\Psi}{\partial\lambda_{i}^{2}}\,.\label{eq70}
\end{equation}

\end_inset

To evaluate the material elasticity tensor, recognize that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{A}_{i}}{\partial\mathbf{C}}=\frac{1}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{A}_{i}\,\underline{\overline{\otimes}}\,\mathbf{A}_{j}+\mathbf{A}_{j}\,\underline{\overline{\otimes}}\,\mathbf{A}_{i}\right)+\frac{1}{\lambda_{i}^{2}-\lambda_{k}^{2}}\left(\mathbf{A}_{i}\,\underline{\overline{\otimes}}\,\mathbf{A}_{k}+\mathbf{A}_{k}\,\underline{\overline{\otimes}}\,\mathbf{A}_{i}\right)\,,\label{eq71}
\end{equation}

\end_inset

where 
\begin_inset Formula $i,j,k$
\end_inset

 form a permutation over 
\begin_inset Formula $1,2,3$
\end_inset

.
 Then it can be shown that the material elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathbb{C}} & =\sum\limits _{i=1}^{3}4\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{i}^{2}}\mathbf{A}_{i}\otimes\mathbf{A}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}4\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{j}^{2}}\left(\mathbf{A}_{i}\otimes\mathbf{A}_{j}+\mathbf{A}_{j}\otimes\mathbf{A}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{S_{i}-S_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{A}_{i}\,\overline{\underline{\otimes}}\,\mathbf{A}_{j}+\mathbf{A}_{j}\,\overline{\underline{\otimes}}\,\mathbf{A}_{i}\right)
\end{aligned}
\,.\label{eq72}
\end{equation}

\end_inset

When eigenvalues coincide, L'Hospital's rule may be used to evalue the coefficie
nt in the last term, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\lambda_{j}^{2}\to\lambda_{i}^{2}}2\frac{S_{i}-S_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}=4\left(\frac{\partial^{2}\Psi}{\partial\lambda_{j}^{2}\partial\lambda_{j}^{2}}-\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{j}^{2}}\right)\,.\label{eq73}
\end{equation}

\end_inset

The double summations in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq72"

\end_inset

 are arranged such that the summands represent fourth-order tensors with
 major and minor symmetries.
\end_layout

\begin_layout Standard
In the spatial frame, the Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum\limits _{i=1}^{3}\sigma_{i}\mathbf{a}_{i}\,,\label{eq74}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{i}=\mathbf{n}_{i}\otimes\mathbf{n}_{i}\,,\label{eq75}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{n}_{i}=\left(\mathbf{F}\cdot\mathbf{N}_{i}\right)/\lambda_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{b}$
\end_inset

.
 The principal normal stresses are 
\begin_inset Formula 
\begin{equation}
\sigma_{i}=\frac{\lambda_{i}}{J}\frac{\partial\Psi}{\partial\lambda_{i}}\,.\label{eq76}
\end{equation}

\end_inset

The spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\sum\limits _{i=1}^{3}\left(J^{-1}\lambda_{i}^{2}\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}}-\sigma_{i}\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}J^{-1}\lambda_{i}\lambda_{j}\frac{\partial^{2}\Psi}{\partial\lambda_{i}\partial\lambda_{j}}\left(\mathbf{a}_{i}\otimes\mathbf{a}_{j}+\mathbf{a}_{j}\otimes\mathbf{a}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{\lambda_{j}^{2}\sigma_{i}-\lambda_{i}^{2}\sigma_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{a}_{i}\,\overline{\underline{\otimes}}\,\mathbf{a}_{j}+\mathbf{a}_{j}\,\overline{\underline{\otimes}}\,\mathbf{a}_{i}\right)
\end{aligned}
\,.\label{eq77}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Nearly-Incompressible Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Nearly-Incompressible-Hyperelast"

\end_inset


\end_layout

\begin_layout Standard
A material is considered incompressible if it shows no change in volume
 during deformation, or otherwise stated, if 
\begin_inset Formula $J=1$
\end_inset

 holds throughout the entire body.
 It can be shown 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

 that if the material is incompressible the hyperelastic constitutive equation
 becomes 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\frac{\partial\tilde{\Psi}}{\partial\mathbf{C}}+pJ\mathbf{C}^{-1}\,,\label{eq78}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{\Psi}=\Psi\left(\tilde{\mathbf{C}}\right)$
\end_inset

is the deviatoric strain energy function and 
\begin_inset Formula $p$
\end_inset

 is the hydrostatic pressure.
 The presence of 
\begin_inset Formula $J$
\end_inset

 may seem unnecessary, but retaining 
\begin_inset Formula $J$
\end_inset

 has the advantage that equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq78"

\end_inset

 remains valid in the nearly incompressible case.
 Further, in practical terms, a finite element analysis rarely enforces
 
\begin_inset Formula $J=1$
\end_inset

 in a pointwise manner, and hence its retention may be important for the
 evaluation of stresses.
\end_layout

\begin_layout Standard
The process of defining constitutive equations in the case of nearly incompressi
ble hyperelasticity is simplified by adding a volumetric energy component
 
\begin_inset Formula $U\left(J\right)$
\end_inset

 to the distortional component 
\begin_inset Formula $\tilde{\Psi}\left(\mathbf{C}\right)$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C}\right)=\tilde{\Psi}\left(\mathbf{C}\right)+U\left(J\right)\,.\label{eq79}
\end{equation}

\end_inset

The second Piola-Kirchhoff tensor for a material defined by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq79"

\end_inset

 is obtained in the standard manner with the help of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq64"

\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =2\frac{\partial\Psi}{\partial\mathbf{C}}\\
 & =2\frac{\partial\tilde{\Psi}}{\partial\mathbf{C}}+2\frac{dU}{dJ}\frac{\partial J}{\partial C}\\
 & =2\frac{\partial\tilde{\Psi}}{\partial\mathbf{C}}+pJ\mathbf{C}^{-1}
\end{aligned}
\,,\label{eq80}
\end{equation}

\end_inset

where the pressure 
\begin_inset Formula $p$
\end_inset

 is defined as 
\begin_inset Formula 
\begin{equation}
p=\frac{dU}{dJ}\,.\label{eq81}
\end{equation}

\end_inset

An example for 
\begin_inset Formula $U$
\end_inset

 that will be used later in the definition of the constitutive models is
 
\begin_inset Formula 
\begin{equation}
U\left(J\right)=\frac{1}{2}\kappa\left(\ln J\right)^{2}\,.\label{eq82}
\end{equation}

\end_inset

The parameter 
\begin_inset Formula $\kappa$
\end_inset

 will be used later as a penalty factor that will enforce the (nearly-)
 incompressible constraint.
 However, 
\begin_inset Formula $\kappa$
\end_inset

 can represent a true material coefficient, namely the bulk modulus, for
 a compressible material that happens to have a hyperelastic strain energy
 function in the form of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq79"

\end_inset

.
 In the case where the dilatational energy is given by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq82"

\end_inset

, the pressure is 
\begin_inset Formula 
\begin{equation}
p=\kappa\frac{\ln J}{J}\,.\label{eq83}
\end{equation}

\end_inset

Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq80"

\end_inset

 can be further developed by applying the chain rule to the first term:
 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=pJ\mathbf{C}^{-1}+J^{-2/3}\dev\tilde{\mathbf{S}}\,,\label{eq84}
\end{equation}

\end_inset

where the 
\emph on
fictitious second Piola-Kirchoff 
\emph default
tensor 
\begin_inset CommandInset citation
LatexCommand citep
key "Holzapfel00"

\end_inset

 is defined by, 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{S}}=2\frac{\partial\tilde{\Psi}}{\partial\tilde{\mathbf{C}}}\,,\label{eq85}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Dev$
\end_inset

 is the deviator operator in the reference frame: 
\begin_inset Formula 
\begin{equation}
\Dev\left(\cdot\right)=\left(\cdot\right)-\frac{1}{3}\left(\left(\cdot\right):\mathbf{C}\right)\mathbf{C}^{-1}.\label{eq86}
\end{equation}

\end_inset

The Cauchy stress can then be obtained from equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq52"

\end_inset


\begin_inset Formula $_{\mathrm{3}}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\dev\tilde{\boldsymbol{\sigma}}\,,\label{eq87}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\frac{2}{J}\mathbf{\tilde{F}}\cdot\frac{\partial\tilde{\Psi}}{\partial\mathbf{\tilde{C}}}\cdot\mathbf{\tilde{F}}^{T}\,.\label{eq88}
\end{equation}

\end_inset

The following expression will be useful in the following development.
 
\begin_inset Formula 
\begin{equation}
\frac{d\tilde{C}_{IJ}}{dC_{KL}}=J^{-2/3}\left(\frac{1}{2}\left(\delta_{IK}\delta_{JL}+\delta_{IL}\delta_{JK}\right)-\frac{1}{3}\tilde{C}_{IJ}\tilde{C}_{KL}^{-1}\right)\,.\label{eq89}
\end{equation}

\end_inset

Notice that the contraction with a symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 results in, 
\begin_inset Formula 
\begin{equation}
\frac{d\tilde{C}_{IJ}}{dC_{KL}}A_{IJ}=J^{-2/3}\Dev A_{KL}\,.\label{eq90}
\end{equation}

\end_inset

The elasticity tensor, defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq55"

\end_inset

, takes on the following form.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbb{C}_{IJKL} & =\left(J^{2}\frac{dp}{dJ}+Jp\right)C_{IJ}^{-1}C_{KL}^{-1}-2pJ\mathcal{I}_{IJKL}\\
 & -\frac{2}{3}J^{-2/3}\left(\Dev\tilde{S}_{IJ}C_{KL}^{-1}+C_{IJ}^{-1}\Dev\tilde{S}_{KL}\right)\\
 & +\frac{2}{3}\tilde{S}_{RS}\tilde{C}_{RS}\left(\mathcal{I}_{IJKL}-\frac{1}{3}C_{KL}^{-1}C_{IJ}^{-1}\right)+J^{-4/3}\hat{\mathbb{C}}_{IJKL}
\end{aligned}
\,,\label{eq91}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\hat{\mathcal{\mathbb{C}}}_{IJKL}=\tilde{\mathcal{\mathbb{C}}}_{IJKL}-\frac{1}{3}\left(\tilde{\mathcal{\mathbb{C}}}_{IJRS}\tilde{C}_{RS}\tilde{C}_{KL}^{-1}+\tilde{\mathcal{\mathbb{C}}}_{RSKL}C_{RS}C_{IJ}^{-1}\right)+\frac{1}{9}\tilde{C}_{IJ}^{-1}\tilde{C}_{RS}\tilde{\mathbb{C}}_{RSMN}\tilde{C}_{MN}\tilde{C}_{KL}^{-1}\,.\label{eq92}
\end{equation}

\end_inset

The spatial elasticity tensor follows from, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathcal{C}_{ijkl} & =\left(J\frac{dp}{dJ}+p\right)\delta_{ij}\delta_{kl}-p\left(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk}\right)\\
 & -\frac{2}{3}\left(\dev\tilde{\sigma}_{ij}\delta_{kl}+\delta_{ij}\dev\tilde{\sigma}_{kl}\right)\\
 & +\frac{1}{3}\tilde{\sigma}_{rs}\delta_{rs}\left(\left(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk}\right)-\frac{2}{3}\delta_{ij}\delta_{kl}\right)+\hat{\mathcal{C}}_{ijkl}
\end{aligned}
\,,\label{eq93}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\hat{\mathcal{C}}_{ijkl}=\frac{1}{J}\tilde{F}_{iI}\tilde{F}_{jJ}\tilde{F}_{kK}\tilde{F}_{lL}\hat{\mathcal{\mathbb{C}}}_{IJKL}\,.\label{eq94}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Transversely Isotropic Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Hyperelas"

\end_inset


\end_layout

\begin_layout Standard
Transverse isotropy can be introduced by adding a vector field representing
 the material preferred direction explicitly into the strain energy 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"

\end_inset

.
 We require that the strain energy depends on a unit vector field 
\begin_inset Formula $\mathbf{A}$
\end_inset

, which describes the local fiber direction in the undeformed configuration.
 When the material undergoes deformation, the vector 
\begin_inset Formula $\mathbf{A}\left(\mathbf{X}\right)$
\end_inset

 may be described by a unit vector field 
\begin_inset Formula $\mathbf{a}\left(\boldsymbol{\varphi}\left(\mathbf{X}\right)\right)$
\end_inset

.
 In general, the fibers will also undergo length change.
 The fiber stretch, 
\begin_inset Formula $\lambda$
\end_inset

, can be determined in terms of the deformation gradient and the fiber direction
 in the undeformed configuration, 
\begin_inset Formula 
\begin{equation}
\lambda\mathbf{a}=\mathbf{F}\cdot\mathbf{A}\,.\label{eq95}
\end{equation}

\end_inset

Also, since 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is a unit vector, 
\begin_inset Formula 
\begin{equation}
\lambda^{2}=\mathbf{A}\cdot\mathbf{C}\cdot\mathbf{A}\,.\label{eq96}
\end{equation}

\end_inset

The strain energy function for a transversely isotropic material, 
\begin_inset Formula $\Psi\left(\mathbf{C},\mathbf{A},\mathbf{X}\right)$
\end_inset

 is an isotropic function of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}\otimes\mathbf{A}$
\end_inset

.
 It can be shown 
\begin_inset CommandInset citation
LatexCommand citep
key "Spencer84"

\end_inset

 that the following set of invariants are sufficient to describe the material
 fully: 
\begin_inset Formula 
\begin{equation}
I_{1}=\tr\mathbf{C}\,,\quad I_{2}=\frac{1}{2}\left[\left(\tr\mathbf{C}\right)^{2}-\tr\mathbf{C}^{2}\right]\,,\quad I_{3}=\det C=J^{2}\,,\label{eq97}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
I_{4}=\mathbf{A}\cdot\mathbf{C}\cdot\mathbf{A}\,,\quad I_{5}=\mathbf{A}\cdot\mathbf{C}^{2}\cdot\mathbf{A}\,.\label{eq98}
\end{equation}

\end_inset

The strain energy function can be written in terms of these invariants such
 that 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\mathbf{A},\mathbf{X}\right)=\Psi\left(I_{1}\left(\mathbf{C}\right),I_{2}\left(\mathbf{C}\right),I_{3}\left(\mathbf{C}\right),I_{4}\left(\mathbf{C},\mathbf{A}\right),I_{5}\left(\mathbf{C},\mathbf{A}\right)\right)\,.\label{eq99}
\end{equation}

\end_inset

The second Piola-Kirchhoff can now be obtained in the standard manner: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\frac{\partial\Psi}{\partial\mathbf{C}}=2\sum\limits _{i=1}^{5}\frac{\partial\Psi}{\partial I_{i}}\frac{\partial I_{i}}{\partial\mathbf{C}}\,.\label{eq100}
\end{equation}

\end_inset

In the transversely isotropic constitutive models described in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Constitutive-Models"

\end_inset

 it is further assumed that the strain energy function can be split into
 the following terms: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\mathbf{A}\right)=\Psi_{1}\left(I_{1},I_{2},I_{3}\right)+\Psi_{2}\left(I_{4}\right)+\Psi_{3}\left(I_{1},I_{2},I_{3}I_{4}\right)\,.\label{eq101}
\end{equation}

\end_inset

The strain energy function 
\begin_inset Formula $\Psi_{1}$
\end_inset

 represents the material response of the isotropic ground substance matrix,
 
\begin_inset Formula $\Psi_{2}$
\end_inset

 represents the contribution from the fiber family (e.g.
 collagen), and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 is the contribution from interactions between the fibers and matrix.
 The form 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq101"

\end_inset

 generalizes many constitutive equations that have been successfully used
 in the past to describe biological soft tissues e.g.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Horowitz88,Humphrey90,Humphrey87"

\end_inset

.
 While this relation represents a large simplification when compared to
 the general case, it also embodies almost all of the material behavior
 that one would expect from transversely isotropic, large deformation matrix-fib
er composites.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic Material
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Material"

\end_inset


\end_layout

\begin_layout Standard
Biphasic materials may be used to model deformable porous media.
 A biphasic material represents a mixture of a porous permeable solid and
 an interstitial fluid.
 Each constituent is intrinsically incompressible, but the mixture may change
 volume as interstitial fluid is exchanged with the pore space of the solid.
 Biphasic materials require the explicit modeling of fluid that permeates
 the solid.
 The biphasic material model is useful to simulate materials that show flow-depe
ndent viscoelastic behavior resulting from the frictional interactions of
 the fluid and solid.
 Several biological materials such as cartilage can be described more accurately
 this way.
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
Consider a mixture consisting of a solid constituent and a fluid constituent.
 Both constituents are considered to be intrinsically incompressible, but
 the mixture can change volume when fluid enters or leaves the porous solid
 matrix 
\begin_inset CommandInset citation
LatexCommand citep
key "Bowen80,Mow80"

\end_inset

.
 According to the kinematics of the continuum 
\begin_inset CommandInset citation
LatexCommand citep
key "Truesdell60"

\end_inset

, each constituent 
\begin_inset Formula $\alpha$
\end_inset

 of a mixture (
\begin_inset Formula $\alpha=s$
\end_inset

 for the solid and 
\begin_inset Formula $\alpha=w$
\end_inset

 for the fluid) has a separate motion 
\begin_inset Formula $\boldsymbol{\chi}^{\alpha}\left(\mathbf{X}^{\alpha},t\right)$
\end_inset

 which places particles of each mixture constituent, originally located
 at 
\begin_inset Formula $\mathbf{X}^{\alpha}$
\end_inset

, in the current configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\boldsymbol{\chi}^{\alpha}\left(\mathbf{X}^{\alpha},t\right)\,.\label{eq102}
\end{equation}

\end_inset

For the purpose of finite element analyses, the motion of the solid matrix,
 
\begin_inset Formula $\alpha=s$
\end_inset

, is of particular interest.
\end_layout

\begin_layout Standard
The governing equations that enter into the statement of virtual work are
 the conservation of linear momentum and the conservation of mass, for the
 mixture as a whole.
 Under quasi-static conditions, the conservation of momentum reduces to
 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}+\rho\mathbf{b}=\mathbf{0}\,,\label{eq103}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma$
\end_inset

 is the Cauchy stress for the mixture, 
\begin_inset Formula $\rho$
\end_inset

 is the mixture density and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the external mixture body force per mass.
 Since the mixture is porous, this stress may also be written as 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,,\label{eq104}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure and 
\begin_inset Formula $\sigma^{e}$
\end_inset

 is the effective or extra stress, resulting from the deformation of the
 solid matrix.
 Conservation of mass for the mixture requires that 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\label{eq105}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{v}^{s}=\partial\boldsymbol{\chi}^{s}/\partial t$
\end_inset

 is the solid matrix velocity and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is the flux of the fluid relative to the solid matrix.
 Let the solid matrix displacement be denoted by 
\begin_inset Formula $\mathbf{u}$
\end_inset

, then 
\begin_inset Formula $\mathbf{v}^{s}=\mathbf{\dot{u}}$
\end_inset

.
\end_layout

\begin_layout Standard
To relate the relative fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 to the fluid pressure and solid deformation, it is necessary to employ
 the equation of conservation of linear momentum for the fluid, 
\begin_inset Formula 
\begin{equation}
-\varphi^{w}\grad p+\rho^{w}\mathbf{b}^{w}+\mathbf{\hat{p}}_{d}^{w}=\mathbf{0}\,,\label{eq106}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi^{w}$
\end_inset

 is the solid matrix porosity, 
\begin_inset Formula $\rho^{w}=\varphi^{w}\rho_{T}^{w}$
\end_inset

 is the apparent fluid density and 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true fluid density, 
\begin_inset Formula $\mathbf{b}^{w}$
\end_inset

 is the external body force per mass acting on the fluid, and 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}$
\end_inset

 is the momentum exchange between the solid and fluid constituents, typically
 representing the frictional interaction between these constituents.
 This equation neglects the viscous stress of the fluid in comparison to
 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}$
\end_inset

.
 The most common constitutive relation is 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}=-\varphi^{w}\mathbf{k}^{-1}\cdot\mathbf{w}$
\end_inset

, where the second order, symmetric tensor 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability of the mixture.
 When combined with Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq106"

\end_inset

, it produces 
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\mathbf{k}\cdot\left(\grad p-\rho_{T}^{w}\mathbf{b}^{w}\right)\,,\label{eq107}
\end{equation}

\end_inset

which is equivalent to Darcy's law.
 In general, 
\begin_inset Formula $\mathbf{k}$
\end_inset

 may be a function of the deformation.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic-Solute Material
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Solute-Material"

\end_inset


\end_layout

\begin_layout Standard
A biphasic-solute material is an extension of the biphasic material model
 that also includes transport and mechano-chemical effects of a neutral
 solute.
 Transport of a solute in a porous medium includes diffusion, resulting
 from gradients in the solute concentration, and convection of the solute
 by the solvent, as a result of fluid pressure gradients.
 Mechano-chemical effects describe phenomena such as osmotic pressurization
 and swelling.
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
The governing equations adopted in this finite element implementation of
 neutral solute transport in deformable porous media are based on the framework
 of mixture theory 
\begin_inset CommandInset citation
LatexCommand citep
key "Truesdell60,Bowen76"

\end_inset

.
 A single solute is considered in this presentation for notational simplicity,
 though the extension of equations to multiple solutes is straightforward.
 Various forms of the governing equations have been presented in the prior
 literature 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03,Ateshian06"

\end_inset

, though a presentation that incorporates all the desired features of this
 implementation has not been reported previously and is thus detailed here.
\end_layout

\begin_layout Standard
The fundamental modeling assumptions adopted in this treatment are quasi-static
 conditions for momentum balance (negligible effects of inertia), intrinsic
 incompressibility of all constituents (invariant true densities), isothermal
 conditions, negligible volume fraction of solute relative to the solid
 and solvent, and negligible effects of solute and solvent viscosities (friction
 within constituents) relative to frictional interactions between constituents.
 These assumptions are often made in studies of biological tissues and cells.
 External body forces and chemical reactions are not considered.
\end_layout

\begin_layout Standard
The three constituents of the mixture are the porous-permeable solid matrix
 (
\begin_inset Formula $\alpha=s)$
\end_inset

, the solvent (
\begin_inset Formula $\alpha=w)$
\end_inset

, and the solute (
\begin_inset Formula $\alpha=u)$
\end_inset

.
 The motion of the solid matrix is described by the displacement vector
 
\begin_inset Formula $\mathbf{u}$
\end_inset

, the pressure of the interstitial fluid (solvent
\begin_inset Formula $+$
\end_inset

solute) is 
\begin_inset Formula $p$
\end_inset

, and the solute concentration (on a solution-volume basis) is 
\begin_inset Formula $c$
\end_inset

.
 The total (or mixture) stress may be described by the Cauchy stress tensor
 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}$
\end_inset

, where 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the identity tensor and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress arising from the strain in the porous solid matrix.
 Because it is porous, the solid matrix is compressible since the volume
 of pores changes as interstitial fluid enters or leaves the matrix.
 Under the conditions outlined above, the balance of linear momentum for
 the mixture reduces to 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}=-\grad p+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,.\label{eq108}
\end{equation}

\end_inset

Similarly, the equations of balance of linear momentum for the solvent and
 solute are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\rho^{w}\grad\tilde{\mu}^{w}+\mathbf{f}^{ws}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{w}\right)+\mathbf{f}^{wu}\cdot\left(\mathbf{v}^{u}-\mathbf{v}^{w}\right) & =\mathbf{0}\,,\\
-\rho^{u}\grad\tilde{\mu}^{u}+\mathbf{f}^{us}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{u}\right)+\mathbf{f}^{uw}\cdot\left(\mathbf{v}^{w}-\mathbf{v}^{u}\right) & =\mathbf{0}\,,
\end{aligned}
\label{eq109}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho^{\alpha}$
\end_inset

 is the apparent density (mass of 
\begin_inset Formula $\alpha$
\end_inset

 per volume of the mixture), 
\begin_inset Formula $\tilde{\mu}^{\alpha}$
\end_inset

 is the mechano-chemical potential and 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the velocity of constituent 
\begin_inset Formula $\alpha$
\end_inset

.
 
\begin_inset Formula $\mathbf{f}^{\alpha\beta}$
\end_inset

 is the diffusive drag tensor between constituents 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 representing momentum exchange via frictional interactions, which satisfies
 
\begin_inset Formula $\mathbf{f}^{\beta\alpha}=\mathbf{f}^{\alpha\beta}$
\end_inset

.
 An important feature of these relations is the incorporation of momentum
 exchange term between the solute and solid matrix, 
\begin_inset Formula $\mathbf{f}^{us}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{u}\right)$
\end_inset

, which is often neglected in other treatments but plays an important role
 for describing solid-solute interactions 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03,Albro08,Albro10"

\end_inset

.
 These momentum equations show that the driving force for the transport
 of solvent or solute is the gradient in its mechano-chemical potential,
 which is resisted by frictional interactions with other constituents.
\end_layout

\begin_layout Standard
The mechano-chemical potential is the sum of the mechanical and chemical
 potentials.
 The chemical potential 
\begin_inset Formula $\mu^{\alpha}$
\end_inset

 of 
\begin_inset Formula $\alpha$
\end_inset

 represents the rate at which the mixture free energy changes with increasing
 mass of 
\begin_inset Formula $\alpha$
\end_inset

.
 The mechanical potential represents the rate at which the mixture free
 energy density changes with increasing volumetric strain of 
\begin_inset Formula $\alpha$
\end_inset

.
 In a mixture of intrinsically incompressible constituents, where the volumetric
 strain is idealized to be zero, this potential is given by 
\begin_inset Formula $\left(p-p_{0}\right)/\rho_{T}^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 is the true density of 
\begin_inset Formula $\alpha$
\end_inset

 (mass of 
\begin_inset Formula $\alpha$
\end_inset

 per volume of 
\begin_inset Formula $\alpha)$
\end_inset

, which is invariant for incompressible constituents, and 
\begin_inset Formula $p_{0}$
\end_inset

 is some arbitrarily set reference pressure (e.g., ambient pressure).
\end_layout

\begin_layout Standard
From classical physical chemistry, the general form of a constitutive relation
 for the chemical potential is 
\begin_inset Formula $\mu^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\left(R\theta/M^{\alpha}\right)\ln a^{\alpha}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95"

\end_inset

, where 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the molecular weight (invariant) and 
\begin_inset Formula $a^{\alpha}$
\end_inset

 is the activity of constituent 
\begin_inset Formula $\alpha$
\end_inset

 (a non-dimensional quantity); 
\begin_inset Formula $\mu_{0}^{\alpha}\left(\theta\right)$
\end_inset

 is the chemical potential at some arbitrary reference state, at a given
 temperature.
 For solutes, physical chemistry treatments let 
\begin_inset Formula $a^{u}=\gamma c/c_{0}$
\end_inset

, where 
\begin_inset Formula $c_{0}$
\end_inset

 is the solute concentration in some standard reference state (an invariant,
 typically 
\begin_inset Formula $c_{0}=1\,\mbox{M})$
\end_inset

, and 
\begin_inset Formula $\gamma$
\end_inset

 is the non-dimensional activity coefficient, which generally depends on
 the current state (e.g., concentration) but reduces to unity under the assumption
 of ideal physico-chemical behavior 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95"

\end_inset

.
 Since this representation is strictly valid for free solutions only, whereas
 solutes may be partially excluded from some of the interstitial space of
 a porous solid matrix, Mauck et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03"

\end_inset

 extended this representation of the solute activity to let 
\begin_inset Formula $a^{u}=\gamma c/\kappa c_{0}$
\end_inset

, where the solubility 
\begin_inset Formula $\kappa$
\end_inset

 represents the fraction of the pore space which is accessible to the solute
 (
\begin_inset Formula $0<\kappa\leqslant1)$
\end_inset

.
 In this extended form, it becomes clear that even under ideal behavior
 (
\begin_inset Formula $\gamma=1)$
\end_inset

, the solute activity may be affected by the solubility.
 Indeed, for neutral solutes, the solubility also represents the partition
 coefficient of the solute between the tissue and external bath 
\begin_inset CommandInset citation
LatexCommand citep
key "Laurent63,Ogston61"

\end_inset

.
\end_layout

\begin_layout Standard
When accounting for the fact that the solute volume fraction is negligible
 compared to the solvent volume fraction 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95,Ateshian07b"

\end_inset

, the general expressions for 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{u}$
\end_inset

 take the form 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\mu}^{w} & =\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-p_{0}-R\theta\,\Phi\,c\right)\,,\\
\tilde{\mu}^{u} & =\mu_{0}^{u}\left(\theta\right)+\frac{R\theta}{M}\ln\frac{\gamma c}{\kappa c_{0}}\,,
\end{aligned}
\label{eq110}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Phi$
\end_inset

 is the osmotic coefficient (a non-dimensional function of the state), which
 deviates from unity under non-ideal physico-chemical behavior.
 Therefore, a complete description of the physico-chemical state of solvent
 and solute requires constitutive relations for 
\begin_inset Formula $\Phi$
\end_inset

 and the effective solubility 
\begin_inset Formula $\tilde{\kappa}=\kappa/\gamma$
\end_inset

, which should generally depend on the solid matrix strain and the solute
 concentration.
\end_layout

\begin_layout Standard
It is also necessary to satisfy the balance of mass for each of the constituents.
 In the absence of chemical reactions, the statement of balance of mass
 for constituent 
\begin_inset Formula $\alpha$
\end_inset

 reduces to 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=0\,.\label{eq111}
\end{equation}

\end_inset

The apparent density may be related to the true density via 
\begin_inset Formula $\rho^{\alpha}=\varphi^{\alpha}\rho_{T}^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\varphi^{\alpha}$
\end_inset

 is the volume fraction of 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture.
 Due to mixture saturation (no voids), the volume fractions add up to unity.
 Since the volume fraction of solute is considered negligible (
\begin_inset Formula $\varphi^{u}\ll\varphi^{s},\varphi^{w})$
\end_inset

, it follows that 
\begin_inset Formula $\sum\nolimits _{\alpha}\varphi^{\alpha}\approx\varphi^{s}+\varphi^{w}=1$
\end_inset

.
 Since 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 of an incompressible constituent is invariant in space and time, these
 relations may be combined to produce the mixture balance of mass relation,
 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0,\label{eq112}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

 is the volumetric flux of solvent relative to the solid.
 The balance of mass for the solute may also be written as 
\begin_inset Formula 
\begin{equation}
\frac{\partial\left(\varphi^{w}c\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}c\,\mathbf{v}^{s}\right)=0\,,\label{eq113}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{j}=\varphi^{w}c\left(\mathbf{v}^{u}-\mathbf{v}^{s}\right)$
\end_inset

 is the molar flux of solute relative to the solid.
 This mass balance relation is obtained by recognizing that the solute apparent
 density (mass per mixture volume) is related to its concentration (moles
 per solution volume) via 
\begin_inset Formula $\rho^{u}=\left(1-\varphi^{s}\right)Mc\approx\varphi^{w}Mc$
\end_inset

.
 Finally, it can be shown via standard arguments that the mass balance for
 the solid matrix reduces to 
\begin_inset Formula 
\begin{equation}
\varphi^{s}=\frac{\varphi_{r}^{s}}{J}\,,\label{eq114}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the solid volume fraction in the reference state, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}=\mathbf{I}+\grad\mathbf{u}$
\end_inset

 is the deformation gradient of the solid matrix.
\end_layout

\begin_layout Standard
Inverting the momentum balance equations in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq109"

\end_inset

, it is now possible to relate the solvent and solute fluxes to the driving
 forces according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\tilde{\mathbf{k}}\cdot\left(\rho_{T}^{w}\grad\tilde{\mu}^{w}+Mc\frac{\mathbf{d}}{d_{0}}\grad\tilde{\mu}^{u}\right)\,,\\
\mathbf{j} & =\mathbf{d}\cdot\left(-\frac{M}{R\theta}\varphi^{w}c\grad\tilde{\mu}^{u}+\frac{c}{d_{0}}\mathbf{w}\right)\,,
\end{aligned}
\label{eq115}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{d}$
\end_inset

 is the solute diffusivity tensor in the mixture (solid
\begin_inset Formula $+$
\end_inset

solution), 
\begin_inset Formula $d_{0}$
\end_inset

 is its (isotropic) diffusivity in free solution; 
\begin_inset Formula $\mathbf{\tilde{k}}$
\end_inset

 is the hydraulic permeability tensor of the solution (solvent
\begin_inset Formula $+$
\end_inset

solute) through the porous solid matrix, which depends explicitly on concentrati
on according to 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta c}{\varphi^{w}d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1},\label{eq116}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{k}$
\end_inset

 represents the hydraulic permeability tensor of the solvent through the
 solid matrix.
 The permeability and diffusivity tensors are related to the diffusive drag
 tensors appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq109"

\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k} & =\left(\varphi^{w}\right)^{2}\left(\mathbf{f}^{ws}\right)^{-1}\,,\\
\mathbf{d}_{0} & =R\theta\varphi^{w}c\left(\mathbf{f}^{uw}\right)^{-1}\equiv d_{0}\mathbf{I}\,,\\
\mathbf{d} & =R\theta\varphi^{w}c\left(\mathbf{f}^{us}+\mathbf{f}^{uw}\right)^{-1}\,,
\end{aligned}
\label{eq117}
\end{equation}

\end_inset

though these explicit relationships are not needed here since 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

 and 
\begin_inset Formula $d_{0}$
\end_inset

 may be directly specified in a particular analysis.
 Since the axiom of entropy inequality requires that the tensors 
\begin_inset Formula $\mathbf{f}^{\alpha\beta}$
\end_inset

 be positive semi-definite (see appendix of 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

), it follows that 
\begin_inset Formula $d_{0}$
\end_inset

 must be greater than or equal to the largest eigenvalue of 
\begin_inset Formula $\mathbf{d}$
\end_inset

.
 Constitutive relations are needed for these transport properties, which
 relate them to the solid matrix strain and solute concentration.
 Note that the relations in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq117"

\end_inset

 represent generalizations of Darcy's law for fluid permeation through porous
 media, and Fick's law for solute diffusion in porous media or free solution.
\end_layout

\begin_layout Subsection
Continuous Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-continuous-variables"

\end_inset


\end_layout

\begin_layout Standard
In principle, the objective of the finite element analysis is to solve for
 the three unknowns, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

, using the partial differential equations that enforce mixture momentum
 balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq108"

\end_inset

, mixture mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq112"

\end_inset

, and solute mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq113"

\end_inset

.
 The remaining solvent and solute momentum balances in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq115"

\end_inset

, and solid mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq114"

\end_inset

, have been reduced to relations that may be substituted into the three
 partial differential equations as needed.
 Solving these equations requires the application of suitable boundary condition
s that are consistent with mass, momentum and energy balances across boundary
 surfaces or interfaces.
 When defining boundaries or interfaces on the solid matrix (the conventional
 approach in solid mechanics), whose outward unit normal is 
\begin_inset Formula $\mathbf{n}$
\end_inset

, mass and momentum balance relations demonstrate that the mixture traction
 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 and normal flux components 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}=\mathbf{j}\cdot\mathbf{n}$
\end_inset

 must be continuous across the interface 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07b,Eringen65"

\end_inset

.
 Therefore, 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

 may be prescribed as boundary conditions.
\end_layout

\begin_layout Standard
Combining momentum and energy balances across an interface also demonstrates
 that 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{u}$
\end_inset

 must be continuous 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07b,Katzir-Katchalsky65"

\end_inset

, implying that these mechano-chemical potentials may be prescribed as boundary
 conditions.
 However, because of the arbitrariness of the reference states 
\begin_inset Formula $\mu_{0}^{w}$
\end_inset

, 
\begin_inset Formula $\mu_{0}^{u}$
\end_inset

, 
\begin_inset Formula $p_{0}$
\end_inset

 and 
\begin_inset Formula $c_{0}$
\end_inset

, and the ill-conditioning of the logarithm function in the limit of small
 solute concentration, the mechano-chemical potentials do not represent
 practical choices for primary variables in a finite element implementation.
 An examination of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq110"

\end_inset

 also shows that continuity of these potentials across an interface does
 not imply continuity of the fluid pressure 
\begin_inset Formula $p$
\end_inset

 or solute concentration 
\begin_inset Formula $c$
\end_inset

.
 Therefore, pressure and concentration are also unsuitable as nodal variables
 in a finite element analysis and they must be replaced by alternative choices.
 Based on the similar reasoning presented by Sun et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Sun99"

\end_inset

, an examination of the expressions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq110"

\end_inset

 shows that continuity may be enforced by using 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\,\Phi\,c\,,\\
\tilde{c} & =\frac{c}{\tilde{\kappa}}\,,
\end{aligned}
\label{eq118}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the effective fluid pressure and 
\begin_inset Formula $\tilde{c}$
\end_inset

 is the effective solute concentration in the mixture.
 Note that 
\begin_inset Formula $\tilde{p}$
\end_inset

 represents that part of the fluid pressure which does not result from osmotic
 effects (since the term 
\begin_inset Formula $R\theta\,\Phi\,c$
\end_inset

 may be viewed as the osmotic pressure contribution to 
\begin_inset Formula $p)$
\end_inset

, and 
\begin_inset Formula $\tilde{c}$
\end_inset

 is a straightforward measure of the solute activity, since 
\begin_inset Formula $a^{u}=\tilde{c}/c_{0}$
\end_inset

.
 Therefore these alternative variables have clear physical meanings.
\end_layout

\begin_layout Standard
Since the unknowns are now given by 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, the governing partial differential equations may be rewritten in the form
 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \grad\left(\tilde{p}+R\theta\,\Phi\,\tilde{\kappa}\tilde{c}\right)+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,,\\
 & \divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\\
 & \frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)=0\,,
\end{aligned}
\label{eq119}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\tilde{\mathbf{k}}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\,,\\
\mathbf{j} & =\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\,,\\
\tilde{\mathbf{k}} & =\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1}\,.
\end{aligned}
\label{eq120}
\end{equation}

\end_inset

Constitutive equations are needed to relate 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

, 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

, 
\begin_inset Formula $d_{0}$
\end_inset

, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 to the solid matrix strain and effective solute concentration.
\end_layout

\begin_layout Section
Triphasic and Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Triphasic-Multiphasic-Materials"

\end_inset


\end_layout

\begin_layout Standard
Multiphasic materials represent an extension of the biphasic-solute material,
 where the mixture may contain a multitude of solutes.
 These solutes may be either electrically charged (ionized) or neutral.
 Similarly, the solid matrix may either carry electrical charge (a fixed
 charge density) or be neutral.
 A triphasic material is a special case of a multiphasic material, having
 two solutes that carry opposite charges.
 Triphasic and multiphasic materials may be used to model porous deformable
 biological tissues whose solid matrix may be charged and whose interstitial
 fluid may contain any number of charged or neutral solutes.
 When mixture constituents are electrically charged, the response of the
 tissue to various loading conditions may encompass a range of mechano-electroch
emical phenomena, including permeation, diffusion, osmosis, streaming potentials
 and streaming currents.
 To better understand multiphasic materials, the reader is encouraged to
 review the descriptions of biphasic (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

) and biphasic-solute materials (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

).
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
In multiphasic materials the solvent is assumed to be neutral, whereas the
 solid and solutes may carry charge.
 The mixture is isothermal and all constituents are considered to be intrinsical
ly incompressible.
 Since the viscosity of the fluid constituents (solvent and solutes) is
 considered negligible relative to the frictional interactions among constituent
s, the stress tensor 
\begin_inset Formula $\sigma$
\end_inset

 for the mixture includes only a contribution from the fluid pressure 
\begin_inset Formula $p$
\end_inset

 and the stress 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 in the solid, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,.\label{eq121}
\end{equation}

\end_inset

The mechano-chemical potential of the solvent is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-p_{0}-R\theta\Phi\sum\limits _{\alpha}c^{\alpha}\right)\,,\label{eq122}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{0}^{w}\left(\theta\right)$
\end_inset

 is the solvent chemical potential in the solvent standard state, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true density of the solvent (which is invariant since the solvent
 is assumed intrinsically incompressible), 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure, 
\begin_inset Formula $p_{0}$
\end_inset

 is the corresponding pressure in the standard state, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant, 
\begin_inset Formula $\Phi$
\end_inset

 is the non-dimensional osmotic coefficient, and 
\begin_inset Formula $c^{\alpha}$
\end_inset

 is the solution volume-based concentration of solute 
\begin_inset Formula $\alpha$
\end_inset

.
 The summation is taken over all solutes in the mixture.
 The mechano-electrochemical potential of each solute is similarly given
 by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\left(\frac{z^{\alpha}F_{c}}{R\theta}\left(\psi-\psi_{0}\right)+\ln\frac{\gamma^{\alpha}c^{\alpha}}{\kappa^{\alpha}c_{0}^{\alpha}}\right),\label{eq123}
\end{equation}

\end_inset

where 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the molar mass of the solute, 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 is its activity coefficient, 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 is its solubility, 
\begin_inset Formula $z^{\alpha}$
\end_inset

 is its charge number, and 
\begin_inset Formula $c_{0}^{\alpha}$
\end_inset

 is its concentration in the solute standard state; 
\begin_inset Formula $F_{c}$
\end_inset

 is Faraday's constant, 
\begin_inset Formula $\psi$
\end_inset

 is the electrical potential of the mixture, and 
\begin_inset Formula $\psi_{0}$
\end_inset

 is the corresponding potential in the standard state.
\end_layout

\begin_layout Standard
In these relations, 
\begin_inset Formula $\Phi$
\end_inset

 and 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 are functions of state that describe the deviation of the mixture from
 ideal physico-chemical behavior; 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 represents the fraction of the pore volume which may be occupied by solute
 
\begin_inset Formula $\alpha$
\end_inset

.
 The standard state represents an arbitrary set of reference conditions
 for the physico-chemical state of each constituent.
 Therefore, the values of 
\begin_inset Formula $\mu_{0}^{w}\left(\theta\right)$
\end_inset

, 
\begin_inset Formula $p_{0}$
\end_inset

, 
\begin_inset Formula $\psi_{0}$
\end_inset

, 
\begin_inset Formula $\mu_{0}^{\alpha}\left(\theta\right)$
\end_inset

, and 
\begin_inset Formula $c_{0}^{\alpha}$
\end_inset

, remain invariant over the entire domain of definition of an analysis.
 Since 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 appear together as a ratio, they may be combined into a single material
 function, 
\begin_inset Formula $\hat{\kappa}^{\alpha}=\kappa^{\alpha}/\gamma^{\alpha}$
\end_inset

, called the effective solubility.
\end_layout

\begin_layout Standard
In multiphasic mixtures, it is also assumed that electroneutrality is satisfied
 at every point in the continuum.
 Therefore, the net electrical charge summed over all constituents must
 reduce to zero, and no net charge accumulation may occur at any time.
 Denoting the fixed charge density of the solid by 
\begin_inset Formula $c^{F}$
\end_inset

 (moles of equivalent charge per solution volume), and recognizing that
 the solvent is always considered neutral, the electroneutrality condition
 may be written as 
\begin_inset Formula 
\begin{equation}
c^{F}+\sum\limits _{\alpha}z^{\alpha}c^{\alpha}=0\,.\label{eq124}
\end{equation}

\end_inset

This condition represents a constraint on a mixture of charged constituents.
 If none of the constituents are charged (
\begin_inset Formula $c^{F}=0$
\end_inset

 and 
\begin_inset Formula $z^{\alpha}=0$
\end_inset

 for all 
\begin_inset Formula $\alpha)$
\end_inset

, the constraint disappears.
\end_layout

\begin_layout Standard
Each constituent of the mixture must satisfy the axiom of mass balance.
 In the absence of chemical reactions involving constituent 
\begin_inset Formula $\alpha$
\end_inset

, its mass balance equation is 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=0\,,\label{eq125}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho^{\alpha}$
\end_inset

 is the apparent density and 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the velocity of that constituent.
 For solutes, the apparent density is related to the concentration according
 to 
\begin_inset Formula $\rho^{\alpha}=\left(1-\varphi^{s}\right)M^{\alpha}c^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\varphi^{s}$
\end_inset

 is the volume fraction of the solid.
 When the solute volume fractions are negligible, it follows that 
\begin_inset Formula $1-\varphi^{s}\approx\varphi^{w}$
\end_inset

, where 
\begin_inset Formula $\varphi^{w}$
\end_inset

 is the solvent volume fraction.
 The molar flux of the solute relative to the solid is given by 
\begin_inset Formula $\mathbf{j}^{\alpha}=\varphi^{w}c^{\alpha}\left(\mathbf{v}^{\alpha}-\mathbf{v}^{s}\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the solute velocity.
 Using these relations, the mass balance relation for the solute may be
 rewritten as 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}c^{\alpha}\right)+\divg\mathbf{j}^{\alpha}=0\,,\label{eq126}
\end{equation}

\end_inset

where 
\begin_inset Formula $D^{s}\left(\cdot\right)/Dt$
\end_inset

 represents the material time derivative in the spatial frame, following
 the solid; 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid.
 This form of the mass balance for the solute is convenient for a finite
 element formulation where the mesh is defined on the solid matrix.
\end_layout

\begin_layout Standard
The volume flux of solvent relative to the solid is given by 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{w}$
\end_inset

 is the solvent velocity.
 When solute volume fractions are negligible, the mass balance equation
 for the mixture reduces to 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,.\label{eq126b}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, the mass balance for the solid may be reduced to the form 
\begin_inset Formula $D^{s}\left(J\varphi^{s}\right)/Dt=0$
\end_inset

, which may be integrated to produce the algebraic relation 
\begin_inset Formula $\varphi^{s}=\varphi_{r}^{s}/J$
\end_inset

, where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the solid volume fraction in the stress-free reference state of the
 solid.
\end_layout

\begin_layout Standard
Differentiating the electroneutrality condition in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

 using the material time derivative following the solid, and substituting
 the mass balance relations into the resulting expressions, produces a constrain
t on the solute fluxes: 
\begin_inset Formula 
\begin{equation}
\divg\sum\limits _{\alpha\ne s,w}z^{\alpha}\mathbf{j}^{\alpha}=0\,.\label{eq127}
\end{equation}

\end_inset

Recognizing that 
\begin_inset Formula $\mathbf{I}_{e}=F_{c}\sum\nolimits _{\alpha\ne s,w}z^{\alpha}\mathbf{j}^{\alpha}$
\end_inset

 is the current density in the mixture, with 
\begin_inset Formula $F_{c}$
\end_inset

 representing Faraday's constant, the relation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq127"

\end_inset

 reduces to one of the Maxwell's equation, 
\begin_inset Formula $\divg\mathbf{I}_{e}=0$
\end_inset

, in the special case when there can be no charge accumulation (electroneutralit
y).
\end_layout

\begin_layout Standard
As described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-continuous-variables"

\end_inset

, the fluid pressure 
\begin_inset Formula $p$
\end_inset

 and solute concentrations 
\begin_inset Formula $c^{\alpha}$
\end_inset

 are not continuous across boundaries of a mixture, whereas 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{\alpha}$
\end_inset

's for the solutes do satisfy continuity.
 Therefore, in a finite element implementation, the following continuous
 variables are used as nodal degrees of freedom: 
\begin_inset Formula 
\begin{equation}
\tilde{p}=p-R\theta\Phi\sum\limits _{\alpha\ne s,w}c^{\alpha}\,,\label{eq128}
\end{equation}

\end_inset

which represents the effective fluid pressure, and 
\begin_inset Formula 
\begin{equation}
\tilde{c}^{\alpha}=c^{\alpha}/\tilde{\kappa}^{\alpha}\,,\label{eq129}
\end{equation}

\end_inset

which represents the effective solute concentration.
 In the last expression, 
\begin_inset Formula $\tilde{\kappa}^{\alpha}$
\end_inset

 is the partition coefficient of the solute, which is related to the effective
 solubility and electric potential according to 
\begin_inset Formula 
\begin{equation}
\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\exp\left(-\frac{z^{\alpha}F_{c}\psi}{R\theta}\right)\,.\label{eq130}
\end{equation}

\end_inset

Physically, since 
\begin_inset Formula $R\theta\,\Phi\sum\nolimits _{\alpha\ne s,w}c^{\alpha}$
\end_inset

 is the osmotic (chemical) contribution to the fluid pressure, 
\begin_inset Formula $\tilde{p}$
\end_inset

 may be interpreted as that part of the total (mechano-chemical) fluid pressure
 which does not result from osmotic effects; thus, it is the mechanical
 contribution to 
\begin_inset Formula $p$
\end_inset

.
 Similarly, the effective solute concentration 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 represents the true contribution of the molar solute content to its electrochem
ical potential.
\end_layout

\begin_layout Standard
When using these variables instead of mechano-electrochemical potentials,
 the momentum equations for the solvent and solutes may be inverted to produce
 the following flux relations: 
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\tilde{\mathbf{k}}\cdot\left(\mbox{grad}\tilde{p}+R\theta\sum\limits _{\beta\ne s,w}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\mbox{grad}\tilde{c}^{\beta}\right)\,,\label{eq131}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\alpha}=\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\mbox{grad}\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\right)\,,\label{eq132}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\sum\limits _{\alpha\ne s,w}\frac{c^{\alpha}}{d_{0}^{\alpha}}\left(\mathbf{I}-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\right)\right]^{-1}\label{eq133}
\end{equation}

\end_inset

is the effective hydraulic permeability of the solution (solvent
\begin_inset Formula $+$
\end_inset

solutes) in the mixture.
 The momentum equation for the mixture is 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}=\mathbf{0}\,.\label{eq134}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Mixture of Solids
\begin_inset CommandInset label
LatexCommand label
name "sec:Mixture-of-Solids"

\end_inset


\end_layout

\begin_layout Standard
A solid material may consist of a heterogeneous mixture of various solid
 constituents that are constrained to move together.
 If each constituent is denoted by the superscript 
\begin_inset Formula $\sigma$
\end_inset

, a constrained mixture satisfies 
\begin_inset Formula $\mathbf{v}^{\sigma}=\mathbf{v}^{s}$
\end_inset

 for all 
\begin_inset Formula $\sigma$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

 is the velocity of the solid mixture.
 For example, a fiber-reinforced material may consist of a mixture of fibers
 and a ground matrix.
 In general, the constitutive relation for such a constrained mixture of
 solids may be a complex function of the mass fraction of each constituent
 as well as the ultrastructure of the constituents and their mutual interactions.
 The mass fraction of each constituent may be represented by the apparent
 density 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

, which is the ratio of the mass of 
\begin_inset Formula $\sigma$
\end_inset

 to the volume of the mixture in the reference configuration, in an elemental
 region.
 In the framework of hyperelasticity, the general representation for the
 strain energy density for such a solid mixture may have the form 
\begin_inset Formula 
\begin{equation}
\Psi=\Psi\left(\mathbf{F}^{\left(1\right)},\cdots,\mathbf{F}^{\left(n\right)},\rho_{r}^{\left(1\right)},\cdots,\rho_{r}^{\left(n\right)}\right)\,,\label{eq135}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 is the deformation gradient of constituent 
\begin_inset Formula $\sigma$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 is the number of solid constituents in the mixture.
 Though the solid constituents are constrained to move together, their deformati
on gradients are not necessarily the same, depending on how the various
 solid constituents of a constrained mixture were assembled 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10a"

\end_inset

.
\end_layout

\begin_layout Standard
With no loss of generality, it may be assumed that the strain energy density
 of the mixture is the summation of the strain energy densities of all the
 constituents, 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{F}^{\left(1\right)},\cdots,\mathbf{F}^{\left(n\right)},\rho_{r}^{\left(1\right)},\cdots,\rho_{r}^{\left(n\right)}\right)=\sum\limits _{\sigma=1}^{n}\Psi^{\sigma}\left(\mathbf{F}^{\left(1\right)},\cdots,\mathbf{F}^{\left(n\right)},\rho_{r}^{\left(1\right)},\cdots,\rho_{r}^{\left(n\right)}\right)\,,\label{eq136}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi^{\sigma}$
\end_inset

 is the strain energy density of constituent 
\begin_inset Formula $\sigma$
\end_inset

.
\end_layout

\begin_layout Standard
Now, 
\emph on
as a special case
\emph default
, we may assume that the simplest form of the constitutive relation for
 a mixture of constrained solids is 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{F}^{\left(1\right)},\cdots,\mathbf{F}^{\left(n\right)},\rho_{r}^{\left(1\right)},\cdots,\rho_{r}^{\left(n\right)}\right)=\sum\limits _{\sigma=1}^{n}\Psi^{\sigma}\left(\mathbf{F}^{\sigma},\rho_{r}^{\sigma}\right)\,.\label{eq137}
\end{equation}

\end_inset

This special form assumes that there are no explicit dependencies among
 the various solid constituents of the mixture.
 Thus, 
\begin_inset Formula $\Psi^{\sigma}$
\end_inset

 depends only on the deformation gradient and mass content of 
\begin_inset Formula $\sigma$
\end_inset

.
\end_layout

\begin_layout Standard
Furthermore, if we assume that 
\begin_inset Formula $\mathbf{F}^{\sigma}=\mathbf{F}$
\end_inset

 for all 
\begin_inset Formula $\sigma$
\end_inset

 (implying no residual stresses in the solid mixture), then the general
 form for 
\begin_inset Formula $\Psi$
\end_inset

 further reduces to 
\begin_inset Formula 
\begin{equation}
\Psi=\sum\limits _{\sigma=1}^{n}\Psi^{\sigma}\left(\mathbf{F},\rho_{r}^{\sigma}\right)\,.\label{eq138}
\end{equation}

\end_inset

Consequently, the stress tensor for the mixture becomes 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=J^{-1}\frac{\partial\Psi}{\partial\mathbf{F}}\cdot\mathbf{F}^{T}=\sum\limits _{\sigma=1}^{n}J^{-1}\frac{\partial\Psi^{\sigma}}{\partial\mathbf{F}}\cdot\mathbf{F}^{T}=\sum\limits _{\sigma=1}^{n}\boldsymbol{\sigma}^{\sigma}\,.\label{eq139}
\end{equation}

\end_inset

In other words, the stress in the solid mixture may be evaluated from the
 sum of the stresses in each mixture constituent using the same hyperelasticity
 relation as for a single, pure solid constituent.
 The fact that 
\begin_inset Formula $\Psi^{\sigma}$
\end_inset

 also depends on 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 implies that the material properties appearing in the constitutive relation
 for 
\begin_inset Formula $\boldsymbol{\sigma}^{\sigma}$
\end_inset

 are dependent on the mass content of solid 
\begin_inset Formula $\sigma$
\end_inset

 in the mixture.
\end_layout

\begin_layout Standard
For nearly-incompressible solids, using a reasoning similar to that which
 led to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq138"

\end_inset

, the uncoupled strain energy density for the solid mixture may be of the
 form 
\begin_inset Formula 
\begin{equation}
\Psi=U\left(J\right)+\sum\limits _{\sigma=1}^{n}\tilde{\Psi}^{\sigma}\left(\mathbf{\tilde{F}},\rho_{r}^{\sigma}\right)\,,\label{eq140}
\end{equation}

\end_inset

where 
\begin_inset Formula $U\left(J\right)$
\end_inset

 is the volumetric energy component, 
\begin_inset Formula $\tilde{\Psi}=\sum\nolimits _{\sigma}\tilde{\Psi}^{\sigma}$
\end_inset

 is the distortional energy component, and 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

 is the distortional part of the deformation gradient, as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Nearly-Incompressible-Hyperelast"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "sec:Equilibrium-swelling"

\end_inset


\end_layout

\begin_layout Standard
When the interstitial fluid of a porous medium contains one or more solutes,
 an osmotic pressure may be produced in the fluid if the osmolarity of the
 interstitial fluid is non-uniform, or if it is different from that of the
 external bathing solution surrounding the porous medium.
 In general, since the osmolarity of the interstitial fluid may vary over
 time in transient problems, the analysis of such swelling effects may be
 addressed using, for example, the biphasic-solute material model described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

.
 However, if we are only interested in the steady-state response for such
 types of materials, when solvent and solute fluxes have subsided, the analysis
 may be simplified considerably.
\end_layout

\begin_layout Standard
The Cauchy stress tensor for a mixture of a porous solid and interstitial
 fluid is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,,\label{eq141}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is he fluid pressure and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress in the solid matrix resulting from solid strain.
 When steady-state conditions are achieved, the fluid pressure 
\begin_inset Formula $p$
\end_inset

 results exclusively from osmotic effects and ambient conditions (i.e., it
 does not depend on the loading history).
 Thus, in analogy to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq118"

\end_inset

, 
\begin_inset Formula $p=\tilde{p}+R\theta\Phi c$
\end_inset

 where 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the mechanical pressure resulting from ambient conditions and 
\begin_inset Formula $R\theta\Phi c$
\end_inset

 is the osmotic pressure resulting from the osmolarity 
\begin_inset Formula $c$
\end_inset

 of the solution.
\end_layout

\begin_layout Standard
The osmotic pressure 
\begin_inset Formula $p$
\end_inset

 may produce swelling of the solid matrix, which is opposed by the solid
 matrix stress.
 This becomes more apparent when considering, for example, the case of a
 traction-free body.
 The traction is given by 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit outward normal to the boundary.
 When 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

, the relation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq141"

\end_inset

 produces 
\begin_inset Formula $p=\mathbf{n}\cdot\boldsymbol{\sigma}^{e}\cdot\mathbf{n}$
\end_inset

, clearly showing that the osmotic pressure 
\begin_inset Formula $p$
\end_inset

 is balanced by the swelling solid matrix.
\end_layout

\begin_layout Standard
The interstitial osmolarity (number of moles of solute per volume of interstitia
l fluid) may be related to the solute and solid content according to 
\begin_inset Formula 
\begin{equation}
c=\frac{c_{r}}{J-\varphi_{r}^{s}}\,,\label{eq142}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{r}$
\end_inset

 is the number of moles of solute per volume of the mixture in the reference
 configuration, 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the volume fraction of the solid in the reference configuration, and
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the volume ratio of the porous solid matrix.
 Neither 
\begin_inset Formula $c_{r}$
\end_inset

 nor 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 depend on the solid matrix deformation, thus 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

 provides the explicit dependence of 
\begin_inset Formula $c$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

.
 This relation shows that the osmolarity of the interstitial fluid is dependent
 on the relative change in volume of the solid matrix with deformation.
 Effectively, under equilibrium swelling conditions, the term 
\begin_inset Formula $-p\mathbf{I}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq141"

\end_inset

 represents an elastic stress and may be treated in this manner when analyzing
 equilibrium swelling conditions.
\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $p$
\end_inset

 also depends on the osmotic coefficient, if we assume that 
\begin_inset Formula $\Phi$
\end_inset

 depends on the solid strain at most via a dependence on 
\begin_inset Formula $J$
\end_inset

, we may thus state generically that 
\begin_inset Formula $p=p\left(J\right)$
\end_inset

 under equilibrium swelling.
 It follows that the elasticity tensor for 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=-\left(p+J\frac{dp}{dJ}\right)\mathbf{I}\otimes\mathbf{I}+2p\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}+\boldsymbol{\mathcal{C}}^{e}\,,\label{eq143}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the elasticity tensor of 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

.
\end_layout

\begin_layout Subsection
Perfect Osmometer
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perfect-osmometer"

\end_inset


\end_layout

\begin_layout Standard
Consider a porous medium with an interstitial fluid that consists of a solvent
 and one or more solutes, whose boundary is permeable to the solvent but
 not to the solutes (e.g., a biological cell).
 Since solutes are trapped within such a medium, 
\begin_inset Formula $c_{r}$
\end_inset

 is a constant in this type of problem.
 Since the boundary is permeable to the solvent, 
\begin_inset Formula $\tilde{p}$
\end_inset

 must be continuous across the boundary.
 Assuming ideal physicochemical conditions, 
\begin_inset Formula $\Phi=1$
\end_inset

, and zero ambient pressure, this continuity requirement implies that 
\begin_inset Formula $p=R\theta\left(c-c^{\ast}\right)$
\end_inset

, where 
\begin_inset Formula $c^{\ast}$
\end_inset

is the osmolarity of the external environment.
 Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

, it follows that 
\begin_inset Formula 
\begin{equation}
p=R\theta\left(\frac{c_{r}}{J-\varphi_{r}^{s}}-c^{\ast}\right)\,.\label{eq144}
\end{equation}

\end_inset

The reference configuration (the stress-free configuration of the solid)
 is achieved when 
\begin_inset Formula $J=1$
\end_inset

 and 
\begin_inset Formula $p=0$
\end_inset

, from which it follows that 
\begin_inset Formula $c_{r}=\left(1-\varphi_{r}^{s}\right)c_{0}^{\ast}$
\end_inset

, where 
\begin_inset Formula $c_{0}^{\ast}$
\end_inset

 is the value of 
\begin_inset Formula $c^{\ast}$
\end_inset

 in the reference state.
 Therefore 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq144"

\end_inset

 may also be written as 
\begin_inset Formula 
\begin{equation}
p=R\theta c^{\ast}\left(\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}\frac{c_{0}^{\ast}}{c^{\ast}}-1\right)\,,\label{eq145}
\end{equation}

\end_inset

and this expression may be substituted into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq143"

\end_inset

 to evaluate the corresponding elasticity tensor.
\end_layout

\begin_layout Standard
A perfect osmometer is a porous material whose interstitial fluid behaves
 ideally and whose solid matrix exhibits negligible resistance to swelling
 (
\begin_inset Formula $\boldsymbol{\sigma}^{e}\approx\mathbf{0})$
\end_inset

.
 In that case 
\begin_inset Formula $p=0$
\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq145"

\end_inset

 may be rearranged to yield 
\begin_inset Formula 
\begin{equation}
J=\left(1-\varphi_{r}^{s}\right)\frac{c_{0}^{\ast}}{c^{\ast}}+\varphi_{r}^{s}.\label{eq146}
\end{equation}

\end_inset

This equation is known as the Boyle-van't Hoff relation for a perfect osmometer.
 It predicts that variations in the relative volume of such as medium with
 changes in external osmolarity 
\begin_inset Formula $c^{\ast}$
\end_inset

 is an affine function of 
\begin_inset Formula $c_{0}^{\ast}/c^{\ast}$
\end_inset

, with the intercept at the origin representing the solid volume fraction
 and the slope representing the fluid volume fraction, in the reference
 configuration.
\end_layout

\begin_layout Standard
FEBio implements the relation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq145"

\end_inset

 for the purpose of modeling equilibrium swelling even when solid matrix
 stresses are not negligible.
 The name 
\begin_inset Quotes eld
\end_inset

perfect osmometer
\begin_inset Quotes erd
\end_inset

 is adopted for this model because it reproduces the Boyle-van't Hoff response
 in the special case when 
\begin_inset Formula $\boldsymbol{\sigma}^{e}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Subsection
Cell Growth
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cell-Growth"

\end_inset


\end_layout

\begin_layout Standard
The growth of cells requires the active uptake of soluble mass to provide
 the building blocks for various intracellular structures, such as the cytoskele
ton or chromosomes, and growth contributes to the osmolarity of the intracellula
r space.
 The resulting mechano-chemical gradient drives solvent into the cell as
 well, contributing to its volumetric growth.
\end_layout

\begin_layout Standard
Cell growth may be modeled using the 
\begin_inset Quotes eld
\end_inset

perfect osmometer
\begin_inset Quotes erd
\end_inset

 framework by simply increasing the mass of the intracellular solid matrix
 and membrane-impermeant solute.
 This is achieved by using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq144"

\end_inset

 to model the osmotic pressure and allowing the parameters 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 (normally constant) to increase over time as a result of growth.
 Since cell growth is often accompanied by cell division, and since daughter
 cells typically achieve the same solid and solute content as their parent,
 it may be convenient to assume that 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 increase proportionally, though this is not an obligatory relationship.
 To ensure that the initial configuration is a stress-free reference configurati
on, let 
\begin_inset Formula $c_{r}=\left(1-\varphi_{r}^{s}\right)c^{\ast}$
\end_inset

 in the initial state prior to growth.
\end_layout

\begin_layout Subsection
Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Donnan-Equilibrium-Swelling"

\end_inset


\end_layout

\begin_layout Standard
Consider a porous medium whose solid matrix holds a fixed electrical charge
 and whose interstitial fluid consists of a solvent and two monovalent counter-i
ons (such as Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}})$
\end_inset

.
 The boundaries of the medium are permeable to the solvent and ions.
 The fixed charge density is denoted by 
\begin_inset Formula $c^{F}$
\end_inset

; it is a measure of the number of fixed charges per volume of the interstitial
 fluid in the current configuration.
 This charge density may be either negative or positive, thereby producing
 an imbalance in the concentration of anions and cations in the interstitial
 fluid.
 To determine the osmolarity of the interstitial fluid, it is necessary
 to equate the mechano-chemical potential of the solvent and the mechano-electro
chemical potential of the ions between the porous medium and its surrounding
 bath.
 When assuming ideal physicochemical behavior, the interstitial osmolarity
 (resulting from the interstitial ions) is given by 
\begin_inset Formula 
\begin{equation}
c=\sqrt{\left(c^{F}\right)^{2}+\left(2c^{\ast}\right)^{2}}\,,\label{eq147}
\end{equation}

\end_inset

where 
\begin_inset Formula $c^{\ast}$
\end_inset

 is the salt concentration in the bath.
 Alternatively, we note that the osmolarity of the bath is 
\begin_inset Formula $\bar{c}^{\ast}=2c^{\ast}$
\end_inset

.
 Though this expression may be equated with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

, the resulting value of 
\begin_inset Formula $c_{r}$
\end_inset

 is not constant in this case, since ions may transport into or out of the
 pore space; therefore that relation is not useful here.
\end_layout

\begin_layout Standard
However, since the number of charges fixed to the solid matrix is invariant,
 we may manipulate 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

 to produce a relation between the fixed charge density in the current configura
tion, 
\begin_inset Formula $c^{F}$
\end_inset

, and the corresponding value in the reference configuration,
\begin_inset Formula $c_{r}^{F}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\,.\label{eq148}
\end{equation}

\end_inset

Now the osmotic pressure resulting from the difference in osmolarity between
 the porous medium and its surrounding bath is given by 
\begin_inset Formula 
\begin{equation}
p=R\theta\left(\sqrt{\left(\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right)\,.\label{eq149}
\end{equation}

\end_inset

This expression may be substituted into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq143"

\end_inset

 to evaluate the corresponding elasticity tensor.
\end_layout

\begin_layout Standard
When the osmotic pressure results from an imbalance in osmolarity produced
 by a fixed charge density, it is called a Donnan osmotic pressure.
 The analysis associated with this relation is called Donnan equilibrium.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "sec:Chemical-Reactions"

\end_inset


\end_layout

\begin_layout Standard
Chemical reactions may be incorportated into a multiphasic mixture by adding
 a mass supply term to the equation of mass balance, 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=\hat{\rho}^{\alpha}\,,\label{eq150}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\hat{\rho}^{\alpha}$
\end_inset

 is the volume density of mass supply to 
\begin_inset Formula $\alpha$
\end_inset

 resulting from chemical reactions with all other mixture constitutents.
 Since mass must be conserved over all constituents, mass supply terms are
 constrained by 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\hat{\rho}^{\alpha}=0\,.\label{eq151}
\end{equation}

\end_inset

In a mixture containing a solid constituent (denoted by 
\begin_inset Formula $\alpha=s$
\end_inset

 ), it is conveniemt to define the mixture domain (and thus the finite element
 mesh) on the solid and evaluate mass fluxes of constituents relative to
 the solid, 
\begin_inset Formula 
\begin{equation}
\mathbf{m}^{\alpha}=\rho^{\alpha}\left(\mathbf{v}^{\alpha}-\mathbf{v}^{s}\right)\,.\label{eq152}
\end{equation}

\end_inset

Substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq152"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq150"

\end_inset

, the differential form of the mass balance may be rewritten as 
\begin_inset Formula 
\begin{equation}
\frac{D^{s}\rho_{r}^{\alpha}}{Dt}+J\divg\mathbf{m}^{\alpha}=\hat{\rho}_{r}^{\alpha}\,,\label{eq153}
\end{equation}

\end_inset

Where 
\begin_inset Formula $D^{s}\left(\cdot\right)/Dt$
\end_inset

 represents the material time derivative in the spatial frame, following
 the solid, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid matrix; 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 is the apparent density and 
\begin_inset Formula $\hat{\rho}_{r}^{\alpha}$
\end_inset

 is the volume density of mass supply to 
\begin_inset Formula $\alpha$
\end_inset

 normalized to the mixture volume in the reference configuration, 
\begin_inset Formula 
\begin{equation}
\rho_{r}^{\alpha}=J\rho^{\alpha},\quad\hat{\rho}_{r}^{\alpha}=J\hat{\rho}^{\alpha}.\label{eq154}
\end{equation}

\end_inset

Since 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 is the mass of 
\begin_inset Formula $\alpha$
\end_inset

 in the current configuration per volume of the mixture in the reference
 configuration (an invariant quantity), this parameter represents a direct
 measure of the mass content of 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture, which may thus be used as a state variable in a framework
 that accounts for chemical reactions.
 A distinction is now made between solid and solute species in the mixture,
 since they are often treated differential in an analysis.
\end_layout

\begin_layout Subsection
Solid Matrix and Solid-Bound Molecular Constituents
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-Matrix-SBM"

\end_inset


\end_layout

\begin_layout Standard
For constituents constrained to move with the solid (denoted generically
 by 
\begin_inset Formula $\alpha=\sigma$
\end_inset

 and satisfying 
\begin_inset Formula $\mathbf{v}^{s}=\mathbf{v}^{\sigma}$
\end_inset

 , 
\begin_inset Formula $\forall\sigma)$
\end_inset

, the statement of mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

 reduces to the special form 
\begin_inset Formula 
\begin{equation}
D^{s}\rho_{r}^{\sigma}/Dt=\hat{\rho}_{r}^{\sigma}\,.\label{eq155}
\end{equation}

\end_inset

This representation makes it easy to see that alterations in 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 can occur only as a result of chemical reactions (such as synthesis, degradatio
n, or binding).
 In contrast, as seen in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

, alterations in 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 for solutes or solvent (
\begin_inset Formula $\alpha\ne\sigma)$
\end_inset

 may also occur as a result of mass transport into or out of the pore space
 of the solid matrix.
 Therefore, 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 is the natural choice of state variable for describing the content of solid
 constituents in a reactive mixture.
\end_layout

\begin_layout Standard
When multiple solid species are present, the net solid mass content may
 be given by 
\begin_inset Formula $\rho_{r}^{s}=\sum\limits _{\sigma}\rho_{r}^{\sigma}$
\end_inset

 whereas the net mass supply of solid is 
\begin_inset Formula $\hat{\rho}_{r}^{s}=\sum\limits _{\sigma}\hat{\rho}_{r}^{\sigma}$
\end_inset

 such that 
\begin_inset Formula $D^{s}\rho_{r}^{s}/Dt=\hat{\rho}_{r}^{s}$
\end_inset

.
 The referential solid volume fraction, 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

, may be evaluated from 
\begin_inset Formula 
\begin{equation}
\varphi_{r}^{s}=\varphi_{0}^{s}+\sum\limits _{\sigma}\rho_{r}^{\sigma}/\rho_{T}^{\sigma},\label{eq156}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{T}^{\sigma}$
\end_inset

 is the true density of solid constituent 
\begin_inset Formula $\sigma$
\end_inset

 (mass of 
\begin_inset Formula $\sigma$
\end_inset

 per volume of 
\begin_inset Formula $\sigma)$
\end_inset

 and 
\begin_inset Formula $\varphi_{0}^{s}$
\end_inset

 is the referential solid volume fraction of solid constituents not explicitly
 modeled by solid-bound molecules (a user-defined parameter).
 According to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq154"

\end_inset

, it follows that the solid volume fraction in the current configuration
 is given by 
\begin_inset Formula $\varphi^{s}=\varphi_{r}^{s}/J$
\end_inset

.
 Note that 
\begin_inset Formula $0\leqslant\varphi^{s}\leqslant1$
\end_inset

 under all circumstances, while 
\begin_inset Formula $0\leqslant\varphi_{r}^{s}\leqslant J$
\end_inset

, implying that 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 may exceed unity when solid growth occurs.
 In this study, it is assumed that all mixture constituents are intrinsically
 incompressible, implying that their true density is invariant.
\end_layout

\begin_layout Standard
The various constituents of the solid matrix may be electrically charged.
 Let 
\begin_inset Formula $z^{\sigma}$
\end_inset

 be the charge number (equivalent charge per mole) of solid constituent
 
\begin_inset Formula $\sigma$
\end_inset

, then the net referential fixed charge density of the solid matrix (equivalent
 charge per fluid volume in the referential configuration) is given by 
\begin_inset Formula 
\begin{equation}
c_{r}^{F}=\frac{1}{1-\varphi_{r}^{s}}\sum\limits _{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\,,\label{eq157}
\end{equation}

\end_inset

where 
\begin_inset Formula $M^{\sigma}$
\end_inset

 is the molar mass of 
\begin_inset Formula $\sigma$
\end_inset

 (an invariant quantity) and 
\begin_inset Formula $1-\varphi_{r}^{s}$
\end_inset

 represents the referential volume fraction of all fluid constituents (solvent
 
\begin_inset Formula $+$
\end_inset

 solutes) in a saturated mixture.
 Based on the kinematics of the continuum, the fixed charge density in the
 current configuration is 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\,.\label{eq158}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Solutes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solutes"

\end_inset


\end_layout

\begin_layout Standard
Solutes are denoted generically by 
\begin_inset Formula $\alpha=\iota$
\end_inset

.
 In chemistry solute content is often represented in units of molar concentratio
n (moles per fluid volume).
 It follows that solute molar concentration 
\begin_inset Formula $c^{\iota}$
\end_inset

 and molar supply 
\begin_inset Formula $\hat{c}^{\iota}$
\end_inset

 are related to 
\begin_inset Formula $\rho^{\iota}$
\end_inset

 and 
\begin_inset Formula $\hat{\rho}^{\iota}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
c^{\iota}=\frac{\rho^{\iota}}{\left(1-\varphi^{s}\right)M^{\iota}},\quad\hat{c}^{\iota}=\frac{\hat{\rho}^{\iota}}{\left(1-\varphi^{s}\right)M^{\iota}}\,.\label{eq159}
\end{equation}

\end_inset

The molar flux of constituent 
\begin_inset Formula $\iota$
\end_inset

 relative to the solid is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)c^{\iota}\left(\mathbf{v}^{\iota}-\mathbf{v}^{s}\right)\,,\label{eq160}
\end{equation}

\end_inset

where it may be noted that 
\begin_inset Formula $\mathbf{m}^{\iota}=M^{\iota}\mathbf{j}^{\iota}$
\end_inset

.
 Combining these relations with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq154"

\end_inset

 produces the desired form of the mass balance for the solutes, 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\mbox{div}\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\hat{c}^{\iota}\,.\label{eq161}
\end{equation}

\end_inset

This form is suitable for implementation in a finite element analysis where
 the mesh is defined on the solid matrix.
\end_layout

\begin_layout Subsection
Mixture with Negligible Solute Volume Fraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Negligible-Solute-Fraction"

\end_inset


\end_layout

\begin_layout Standard
The volume fraction of each constituent is given by 
\begin_inset Formula $\varphi^{\alpha}=\rho^{\alpha}/\rho_{T}^{\alpha}$
\end_inset

.
 In a saturated mixture these volume fractions satisfy 
\begin_inset Formula $\sum\limits _{\alpha}\varphi^{\alpha}=1$
\end_inset

.
 Substituting 
\begin_inset Formula $\rho^{\alpha}=\varphi^{\alpha}\rho_{T}^{\alpha}$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq150"

\end_inset

, dividing across by 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 (invariant for intrinsically incompressible constituents), and taking the
 sum of the resulting expression over all constituents produces 
\begin_inset Formula 
\begin{equation}
\divg\left(\sum\limits _{\alpha}\varphi^{\alpha}\mathbf{v}^{\alpha}\right)=\sum\limits _{\alpha}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq162}
\end{equation}

\end_inset

This mass balance relation for the mixture expresses the fact that the mixture
 volume will change as a result of chemical reactions where the true density
 of products is different from that of reactants.
 Indeed, assuming that 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 is the same for all 
\begin_inset Formula $\alpha$
\end_inset

 would nullify the right-hand-side of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq162"

\end_inset

 based on 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq151"

\end_inset

.
 We now adopt the assumption that solutes occupy a negligible volume fraction
 of the mixture (
\begin_inset Formula $\varphi^{\iota}\ll1)$
\end_inset

, from which it follows that 
\begin_inset Formula $\varphi^{s}+\varphi^{w}\approx1$
\end_inset

 and 
\begin_inset Formula $\sum\limits _{\alpha}\varphi^{\alpha}\mathbf{v}^{\alpha}\approx\mathbf{v}^{s}+\mathbf{w}$
\end_inset

, where 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

 is the volumetrix flux of solvent relative to the solid.
 Thus, the mixture mass balance may be reduced to 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\sum\limits _{\alpha}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq163}
\end{equation}

\end_inset

In the special case of the solvent (
\begin_inset Formula $\alpha=w$
\end_inset

), FEBio uses a solvent supply, 
\begin_inset Formula $\hat{\varphi}^{w}=\hat{\rho}^{w}/\hat{\rho}_{T}^{w}$
\end_inset

, which may be incorporated in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq163"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}+\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq163b}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Chemical Kinetics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Chemical-Kinetics"

\end_inset


\end_layout

\begin_layout Standard
Productions rates are described by constitutive relations which are functions
 of the state variables.
 In a biological mixture under isothermal conditions, the minimum set of
 state variables needed to describe reactive mixtures that include a solid
 matrix are: the (uniform) temperature 
\begin_inset Formula $\theta$
\end_inset

, the solid matrix deformation gradient 
\begin_inset Formula $\mathbf{F}$
\end_inset

 (or related strain measures), and the molar content 
\begin_inset Formula $c^{\alpha}$
\end_inset

 of the various constituents.
 This set differs from the classical treatment of chemical kinetics in fluid
 mixtures by the inclusion of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and the subset of constituents bound to the solid matrix.
 To maintain a consistent notation in this section, solid-bound molecular
 species are described by their molar concentrations and molar supplies
 which may be related to their referential mass density and referential
 mass supply according to 
\begin_inset Formula 
\begin{equation}
c^{\sigma}=\frac{\rho_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}},\quad\hat{c}^{\sigma}=\frac{\hat{\rho}_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}}\,.\label{eq164}
\end{equation}

\end_inset

Consider a general chemical reaction, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\to\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha}\,,\label{eq165}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

 is the chemical species representing constituent 
\begin_inset Formula $\alpha$
\end_inset

; 
\begin_inset Formula $\nu_{R}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\nu_{P}^{\alpha}$
\end_inset

 represent stoichiometric coefficients of the reactants and products, respective
ly.
 Since the molar supply of reactants and products is constrained by stoichiometr
y, it follows that all molar supplies 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 in a specific chemical reaction may be related to a production rate 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\hat{c}^{\alpha}=\nu^{\alpha}\hat{\zeta}\,,\label{eq166}
\end{equation}

\end_inset

where 
\begin_inset Formula $\nu^{\alpha}$
\end_inset

 represents the net stoichiometric coefficient for 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\nu^{\alpha}=\nu_{P}^{\alpha}-\nu_{R}^{\alpha}\,.\label{eq167}
\end{equation}

\end_inset

Thus, formulating constitutive relations for 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 is equivalent to providing a single relation for 
\begin_inset Formula $\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)$
\end_inset

.
 When the chemical reaction is reversible, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\rightleftharpoons\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha}\,,\label{eq168}
\end{equation}

\end_inset

the relations of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq167"

\end_inset

 still apply but the form of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 would be different.
\end_layout

\begin_layout Standard
Using the relations of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq159"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq164"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

, it follows in general that 
\begin_inset Formula $\hat{\rho}^{\alpha}=\left(1-\varphi^{s}\right)M^{\alpha}\nu^{\alpha}\hat{\zeta}$
\end_inset

, so that the constraint of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq151"

\end_inset

 is equivalent to enforcing stoichiometry, namely, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu^{\alpha}M^{\alpha}=0\,.\label{eq169}
\end{equation}

\end_inset

Thus, properly balancing a chemical reaction satisfies this constraint.
\end_layout

\begin_layout Standard
The mixture mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq163b"

\end_inset

 may now be rewritten as 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}^{w}\right)=\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\,,\label{eq170}
\end{equation}

\end_inset

where 
\begin_inset Formula $\overline{\mathcal{V}}=\sum\limits _{\alpha\ne w}\nu^{\alpha}\mathcal{V}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\mathcal{V}^{\alpha}=M^{\alpha}/\rho_{T}^{\alpha}$
\end_inset

 is the molar volume of 
\begin_inset Formula $\alpha$
\end_inset

.
 (Currently in FEBio, 
\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset

 is specified independently of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

, because users may choose to neglect the contribution from 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq170"

\end_inset

; therefore, if one desires to model chemical reactions, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq165"

\end_inset

 or 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq168"

\end_inset

, that involve the solvent, it is necessary to explicitly provide a solvent
 supply function compatible with the above relations, namely 
\begin_inset Formula $\hat{\varphi}^{w}=\left(1-\varphi^{s}\right)\hat{\zeta}\nu^{w}\mathcal{V}^{w}$
\end_inset

.) Similarly, the solute mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq161"

\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\divg\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\nu^{\iota}\hat{\zeta}\,.\label{eq:solute-mass-balance}
\end{equation}

\end_inset

These mass balance equations reduce to those of non-reactive mixtures when
 
\begin_inset Formula $\hat{\zeta}=0$
\end_inset

.
\end_layout

\begin_layout Section
Fluid Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Fluid-Mechanics"

\end_inset


\end_layout

\begin_layout Subsection
Mass and Momentum Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Mass-Momentum"

\end_inset


\end_layout

\begin_layout Standard
In a spatial (Eulerian) frame, the momentum balance equation for a continuum
 is
\begin_inset Formula 
\begin{equation}
\rho\mathbf{a}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,\label{eq:momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the density, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress, 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the body force per mass, and 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the acceleration, given by the material time derivative of the velocity
 
\begin_inset Formula $\mathbf{v}$
\end_inset

 in the spatial frame,
\begin_inset Formula 
\begin{equation}
\mathbf{a}=\dot{\mathbf{v}}=\frac{\partial\mathbf{v}}{\partial t}+\mathbf{L}\cdot\mathbf{v}\,,\label{eq:acceleration}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{L}=\grad\mathbf{v}$
\end_inset

 is the spatial velocity gradient.
 The mass balance equation is
\begin_inset Formula 
\begin{equation}
\dot{\rho}+\rho\divg\mathbf{v}=0\,,\label{eq:mass-balance}
\end{equation}

\end_inset

where the material time derivative of the density in the spatial frame is
\begin_inset Formula 
\begin{equation}
\dot{\rho}=\frac{\partial\rho}{\partial t}+\grad\rho\cdot\mathbf{v}\,.\label{eq:density-material-derivative}
\end{equation}

\end_inset

Let 
\begin_inset Formula $\mathbf{F}$
\end_inset

 denote the deformation gradient (the gradient of the motion with respect
 to the material coordinate).
 The material time derivative of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is related to 
\begin_inset Formula $\mathbf{L}$
\end_inset

 via
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{F}}=\mathbf{L}\cdot\mathbf{F}\,.\label{eq:F-dot}
\end{equation}

\end_inset

Let 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 denote the Jacobian of the motion (the volume ratio, or ratio of current
 to referential volume, 
\begin_inset Formula $J>0$
\end_inset

); then, the dilatation (relative change in volume between current and reference
 configurations) is given by 
\begin_inset Formula $e=J-1$
\end_inset

.
 Using the chain rule, 
\begin_inset Formula $J$
\end_inset

's material time derivative is 
\begin_inset Formula $\dot{J}=J\mathbf{F}^{-T}:\dot{\mathbf{F}}$
\end_inset

 which, when combined with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:F-dot"

\end_inset

, produces a kinematic constraint between 
\begin_inset Formula $\dot{J}$
\end_inset

 and 
\begin_inset Formula $\divg\mathbf{v}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\dot{J}=J\,\divg\mathbf{v}\,.\label{eq:divv-kinematic-relation}
\end{equation}

\end_inset

Substituting this relation into the mass balance, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance"

\end_inset

, produces 
\begin_inset Formula $\dot{\overline{\rho J}}=0$
\end_inset

, which may be integrated directly to yield
\begin_inset Formula 
\begin{equation}
\rho=\rho_{r}/J\,,\label{eq:mass-balance-integrated}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the density in the reference configuration (when 
\begin_inset Formula $J=1$
\end_inset

).
 Since 
\begin_inset Formula $\rho_{r}$
\end_inset

 is obtained by integrating the above material time derivative of 
\begin_inset Formula $\rho J$
\end_inset

, it is an intrinsic material property that must be invariant in time and
 space.
 
\end_layout

\begin_layout Standard
The Cauchy stress is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\tau}\,,\label{eq:stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the identity tensor, 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress, 
\begin_inset Formula $p$
\end_inset

 is the pressure arising from the elastic response,
\begin_inset Formula 
\begin{equation}
p=-\frac{d\Psi_{r}\left(J\right)}{dJ}\,,\label{eq:elastic-pressure}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is the free energy density of the fluid (free energy per volume of the
 continuum in the reference configuration).
 The axiom of entropy inequality dictates that 
\begin_inset Formula $\Psi_{r}$
\end_inset

 cannot be a function of the rate of deformation 
\begin_inset Formula $\mathbf{D}=\left(\mathbf{L}+\mathbf{L}^{T}\right)/2$
\end_inset

.
 In contrast, the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is generally a function of 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
\end_layout

\begin_layout Standard
Boundary conditions may be derived by satisfying mass and momentum balance
 across a moving interface 
\begin_inset Formula $\Gamma$
\end_inset

.
 Let 
\begin_inset Formula $\Gamma$
\end_inset

 divide the material domain 
\begin_inset Formula $V$
\end_inset

 into subdomains 
\begin_inset Formula $V_{+}$
\end_inset

 and 
\begin_inset Formula $V_{-}$
\end_inset

 and let the outward normal to 
\begin_inset Formula $V_{+}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 be denoted by 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 The jump condition across 
\begin_inset Formula $\Gamma$
\end_inset

 derived from the axiom of mass balance requires that
\begin_inset Formula 
\begin{equation}
\left[\left[\rho\mathbf{u}_{\Gamma}\right]\right]\cdot\mathbf{n}=0\,,\label{eq:mass-jump}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{u}_{\Gamma}\equiv\mathbf{v}-\mathbf{v}_{\Gamma}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}_{\Gamma}$
\end_inset

 is the velocity of the interface 
\begin_inset Formula $\Gamma$
\end_inset

.
 Thus, 
\begin_inset Formula $\mathbf{u}_{\Gamma}$
\end_inset

 represents the velocity of the fluid relative to 
\begin_inset Formula $\Gamma$
\end_inset

.
 The double bracket notation denotes 
\begin_inset Formula $\left[\left[f\right]\right]=f_{+}-f_{-}$
\end_inset

, where 
\begin_inset Formula $f_{+}$
\end_inset

 and 
\begin_inset Formula $f_{-}$
\end_inset

 represent the value of 
\begin_inset Formula $f$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 in 
\begin_inset Formula $V_{+}$
\end_inset

 and 
\begin_inset Formula $V_{-}$
\end_inset

, respectively.
 This jump condition implies that the mass flux normal to 
\begin_inset Formula $\Gamma$
\end_inset

 must be continuous.
 In particular, if 
\begin_inset Formula $V_{+}$
\end_inset

 is a fluid domain and 
\begin_inset Formula $V_{-}$
\end_inset

 is a solid domain, and 
\begin_inset Formula $\Gamma$
\end_inset

 denotes the solid boundary (e.g., a wall), we use 
\begin_inset Formula $\rho_{+}=\rho$
\end_inset

, 
\begin_inset Formula $\mathbf{v}_{+}=\mathbf{v}$
\end_inset

 for the fluid, and 
\begin_inset Formula $\mathbf{v}_{-}=\mathbf{v}_{\Gamma}$
\end_inset

 for the solid, such that eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-jump"

\end_inset

 reduces to 
\begin_inset Formula $\rho\left(\mathbf{v}-\mathbf{v}_{\Gamma}\right)\cdot\mathbf{n}=0$
\end_inset

.
 The jump condition derived from the axiom of linear momentum balance similarly
 requires that
\begin_inset Formula 
\begin{equation}
\left[\left[\boldsymbol{\sigma}-\rho\mathbf{u}_{\Gamma}\otimes\mathbf{u}_{\Gamma}\right]\right]\cdot\mathbf{n}=\mathbf{0}\,.\label{eq:momentum-jump}
\end{equation}

\end_inset

This condition implies that the jump in the traction 
\begin_inset Formula $\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 across 
\begin_inset Formula $\Gamma$
\end_inset

 must be balanced by the jump in momentum flux normal to 
\begin_inset Formula $\Gamma$
\end_inset

.
 In addition to jump conditions dictated by axioms of conservation, viscous
 fluids require the satisfaction of the no-slip condition,
\begin_inset Formula 
\begin{equation}
\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\left[\left[\mathbf{u}_{\Gamma}\right]\right]=\mathbf{0}\,,\label{eq:no-slip-condition}
\end{equation}

\end_inset

which implies that the velocity component tangential to 
\begin_inset Formula $\Gamma$
\end_inset

 is continuous across that interface.
\end_layout

\begin_layout Standard
In our finite element treatment we use 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 as nodal variables, implying that our formulation automatically enforces
 continuity of these variables across element boundaries, thus 
\begin_inset Formula $\left[\left[\mathbf{v}\right]\right]=\left[\left[\mathbf{u}_{\Gamma}\right]\right]=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $\left[\left[J\right]\right]=0$
\end_inset

.
 Based on eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-integrated"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

, it follows that the density and elastic pressure are continuous across
 element boundaries in this formulation, 
\begin_inset Formula $\left[\left[\rho\right]\right]=0$
\end_inset

 and 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

.
 Thus, the mass jump in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-jump"

\end_inset

 is automatically satisfied, and the momentum jump in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:momentum-jump"

\end_inset

 reduces to 
\begin_inset Formula $\left[\left[\boldsymbol{\sigma}\right]\right]\cdot\mathbf{n}=\mathbf{0}$
\end_inset

, requiring continuity of the traction, or more specifically according to
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress"

\end_inset

, the continuity of the viscous traction 
\begin_inset Formula $\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

, since 
\begin_inset Formula $p$
\end_inset

 is automatically continuous.
\end_layout

\begin_layout Subsection
Energy Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Energy-Balance"

\end_inset


\end_layout

\begin_layout Standard
The energy balance for a continuum may be written in integral form over
 a control volume 
\begin_inset Formula $V$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{d}{dt}\int_{V}\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\,dV & =-\int_{S}\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\mathbf{v}\cdot\mathbf{n}\right)\,dS+\int_{S}\mathbf{t}\cdot\mathbf{v}\,dS+\int_{V}\rho\mathbf{b}\cdot\mathbf{v}\,dV\\
 & -\int_{S}\mathbf{q}\cdot\mathbf{n}\,dS+\int_{V}\rho r\,dV
\end{aligned}
\,,\label{eq:energy-balance-integral}
\end{equation}

\end_inset

where 
\begin_inset Formula $S$
\end_inset

 is the control surface bounding 
\begin_inset Formula $V$
\end_inset

, 
\begin_inset Formula $\varepsilon$
\end_inset

 is the specific internal energy, 
\begin_inset Formula $\mathbf{q}$
\end_inset

 is the heat flux across 
\begin_inset Formula $S$
\end_inset

, and 
\begin_inset Formula $r$
\end_inset

 is the heat supply per mass to the material in 
\begin_inset Formula $V$
\end_inset

 resulting from other sources.
 Bringing the time derivative inside the integral on the left-hand-side,
 and using the divergence theorem, this integral statement of the energy
 balance may be written as
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \int_{V}\left[\rho\left(\dot{\varepsilon}+\mathbf{v}\cdot\mathbf{a}\right)+\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\divg\mathbf{v}-\frac{\dot{J}}{J}\right)\right]\,dV\\
 & =\int_{V}\left[\boldsymbol{\sigma}:\mathbf{D}-\divg\mathbf{q}+\rho r+\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\mathbf{b}\right)\right]\,dV
\end{aligned}
\,.\label{eq:energy-integral-redux}
\end{equation}

\end_inset

This statement must be valid for arbitrary control volumes and arbitrary
 processes, from which we conventionally derive the differential form of
 the axioms of mass, momentum and energy balance.
\end_layout

\begin_layout Standard
For the specialized conditions of a viscous fluid at constant temperature
 assumed in our treatment, the only state variables for the functions of
 state 
\begin_inset Formula $\varepsilon$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 are 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 (i.e., the temperature is not a state variable since it is assumed constant).
 Under these conditions the entropy inequality shows that the specific entropy
 
\begin_inset Formula $\eta$
\end_inset

 and the heat flux 
\begin_inset Formula $\mathbf{q}$
\end_inset

 must be zero, and the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 must have the form of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress"

\end_inset

 where 
\begin_inset Formula $p$
\end_inset

 is given by
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

 as a function of 
\begin_inset Formula $J$
\end_inset

 only, leaving the residual dissipation statement 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}\ge0$
\end_inset

 as a constraint that must be satisfied by constitutive relations for 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

.
 (For a Newtonian fluid, this constraint is satisfied when the viscosities
 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are positive.) From these thermodynamic restrictions we conclude that 
\begin_inset Formula $\varepsilon=\psi$
\end_inset

, where 
\begin_inset Formula $\psi$
\end_inset

 is the specific (Helmholtz) free energy, with 
\begin_inset Formula $\Psi_{r}=\rho_{r}\psi$
\end_inset

.
\end_layout

\begin_layout Standard
For the conditions adopted here (isothermal viscous fluid), the axiom of
 energy balance reduces to 
\begin_inset Formula $\rho\dot{\psi}=\boldsymbol{\sigma}:\mathbf{D}+\rho r$
\end_inset

; since 
\begin_inset Formula $\psi$
\end_inset

 is only a function of 
\begin_inset Formula $J$
\end_inset

, this expression may be further simplified using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

 to produce 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}+\rho r=0$
\end_inset

.
 In other words, isothermal conditions may be maintained only if heat dissipated
 by the viscous stress is emitted in the form of a heat supply density 
\begin_inset Formula $\rho r=-\boldsymbol{\tau}:\mathbf{D}$
\end_inset

 (heat leaving the system).
 Now, the integral form of the energy balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:energy-integral-redux"

\end_inset

 simplifies to
\begin_inset Formula 
\begin{equation}
\int_{V}\left[\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)+\rho\left(\psi+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\frac{\dot{J}}{J}-\divg\mathbf{v}\right)\right]\,dV=0\,.\label{eq:energy-isothermal-viscous}
\end{equation}

\end_inset

A comparison of this statement with the statement of virtual work, presented
 below in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual work"

\end_inset

, establishes a clear correspondence between the virtual velocity 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

, and between the virtual energy density 
\begin_inset Formula $\delta J$
\end_inset

 and 
\begin_inset Formula $\rho\left(\psi+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)$
\end_inset

, with the latter representing the sum of the internal (free) and kinetic
 energy densities.
\end_layout

\begin_layout Chapter
The Nonlinear FE Method
\begin_inset CommandInset label
LatexCommand label
name "chap:Nonlinear-FE-Method"

\end_inset


\end_layout

\begin_layout Standard
This chapter discusses the basic principles of the nonlinear finite element
 method.
 The chapter begins with a short introduction to the weak formulation and
 the principle of virtual work.
 Next, the important concept of linearization is discussed and applied to
 the principle of virtual work.
 Finally the Newton-Raphson procedure and its application to the nonlinear
 finite element method are described.
\end_layout

\begin_layout Section
Weak formulation for Solid Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Solid-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
Generally, the finite element formulation is established in terms of a weak
 form of the differential equations under consideration.
 In the context of solid mechanics this implies the use of the virtual work
 equation: 
\begin_inset Formula 
\begin{equation}
\delta W=\int\limits _{v}\boldsymbol{\sigma}:\delta\mathbf{d}\,dv-\int\limits _{v}\mathbf{f}\cdot\delta\mathbf{v}\,dv-\int\limits _{\partial v}\mathbf{t}\cdot\delta\mathbf{v}\,da=0\,.\label{eq171}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is a virtual velocity and 
\begin_inset Formula $\delta\mathbf{d}$
\end_inset

 is the virtual rate of deformation tensor.
 This equation is known as the 
\emph on
spatial virtual work equation 
\emph default
since it is formulated using spatial quantities only.
 We can also define the 
\emph on
material virtual work equation 
\emph default
by expressing the principle of virtual work using only material quantities.
 
\begin_inset Formula 
\begin{equation}
\delta W=\int\limits _{V}\mathbf{S}:\delta\mathbf{\dot{E}}\,dV-\int\limits _{V}\mathbf{f}_{0}\cdot\delta\mathbf{v}\,dV-\int\limits _{\partial V}\mathbf{t}_{0}\cdot\delta\mathbf{v}\,dA=0\,.\label{eq172}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{f}_{0}=J\mathbf{f}$
\end_inset

 is the body force per unit undeformed volume and 
\begin_inset Formula $\mathbf{t}_{0}=\mathbf{t}\left(da/dA\right)$
\end_inset

 is the traction vector per unit initial area.
\end_layout

\begin_layout Subsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-linearization"

\end_inset


\end_layout

\begin_layout Standard
Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq171"

\end_inset

 is the starting point for the nonlinear finite element method.
 It is highly nonlinear and any method attempting to solve this equation,
 such as the Newton-Raphson method, necessarily has to be iterative.
\end_layout

\begin_layout Standard
To linearize the finite element equations, the directional derivative of
 the virtual work in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq171"

\end_inset

 must be calculated.
 In an iterative procedure, the quantity 
\begin_inset Formula $\boldsymbol{\phi}$
\end_inset

 will be approximated by a trial solution 
\begin_inset Formula $\boldsymbol{\phi}_{k}$
\end_inset

.
 Linearization of the virtual work equation around this trial solution gives
 
\begin_inset Formula 
\begin{equation}
\delta W\left(\boldsymbol{\phi}_{k},\delta\mathbf{v}\right)+D\delta W\left(\boldsymbol{\phi}_{k},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=0\,.\label{eq173}
\end{equation}

\end_inset

The directional derivative of the virtual work will eventually lead to the
 definition of the stiffness matrix.
 In order to proceed, it is convenient to split the virtual work into an
 internal and external virtual work component: 
\begin_inset Formula 
\begin{equation}
D\delta W\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=D\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]-D\delta W_{ext}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right],\label{eq174}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)=\int\limits _{v}\boldsymbol{\sigma}:\delta\mathbf{d}\,dv\,,\label{eq175}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\delta W_{ext}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)=\int\limits _{v}\mathbf{f}\cdot\delta\mathbf{v}\,dv+\int\limits _{\partial v}\mathbf{t}\cdot\delta\mathbf{v}\,da\,.\label{eq176}
\end{equation}

\end_inset

The result is listed here without details of the derivation – see 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

 for details.
 The linearization of the internal virtual work is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\int\limits _{v}\delta\mathbf{d}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,dv+\int\limits _{v}\boldsymbol{\sigma}:\left[\left(\nabla\mathbf{u}\right)^{T}\cdot\nabla\delta\mathbf{v}\right]\,dv\,.\label{eq177}
\end{equation}

\end_inset

Notice that this equation is symmetric in 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 This symmetry will, upon discretization, yield a symmetric tangent matrix.
\end_layout

\begin_layout Standard
The external virtual work has contributions from both body forces and surface
 tractions.
 The precise form of the linearized external virtual work depends on the
 form of these forces.
 For surface tractions, normal pressure forces may be represented in FEBio.
 The linearized external work for this type of traction is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{ext}^{p}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right] & =\frac{1}{2}\int\limits _{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\xi}\cdot\left[\left(\frac{\partial\mathbf{u}}{\partial\eta}\times\delta\mathbf{v}\right)+\left(\frac{\partial\delta\mathbf{v}}{\partial\eta}\times\mathbf{u}\right)\right]d\xi\,d\eta\\
 & -\frac{1}{2}\int\limits _{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\eta}\cdot\left[\left(\frac{\partial\mathbf{u}}{\partial\xi}\times\delta\mathbf{v}\right)+\left(\frac{\partial\delta\mathbf{v}}{\partial\xi}\times\mathbf{u}\right)\right]d\xi\,d\eta\,.
\end{aligned}
\label{eq178}
\end{equation}

\end_inset

Discretization of this equation will also lead to a symmetric component
 of the tangent matrix.
\end_layout

\begin_layout Standard
FEBio currently supports gravity as a body force, 
\begin_inset Formula $\mathbf{f}=\rho\mathbf{g}$
\end_inset

.
 Since this force is independent of the geometry, the contribution to the
 linearized external work is zero.
 Another type of body force implemented in FEBio is the centrifugal force.
 For a body rotating with a constant angular speed 
\begin_inset Formula $\omega$
\end_inset

, about an axis passing through the point 
\begin_inset Formula $\mathbf{c}$
\end_inset

 and directed along the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

, the body force is given by 
\begin_inset Formula $\mathbf{f}=\rho\omega^{2}\mathbf{r}$
\end_inset

, where 
\begin_inset Formula $\mathbf{r}$
\end_inset

 is the vector distance from a point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 to the axis of rotation, 
\begin_inset Formula 
\begin{equation}
\mathbf{r}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\left(\mathbf{x}-\mathbf{c}\right)\,.\label{eq179}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigCentrifugalBodyForce.pdf

\end_inset


\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The resulting linearized external work is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{ext}^{f}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\int\limits _{v}\rho\omega^{2}\delta\mathbf{v}\cdot\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{u}\,dv,\label{eq180}
\end{equation}

\end_inset

which produces a symmetric expression that will yield a symmetric matrix.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-discretization"

\end_inset


\end_layout

\begin_layout Standard
The basis of the finite element method is that the domain of the problem
 (that is, the volume of the object under consideration) is divided into
 smaller subunits, called 
\emph on
finite elements
\emph default
.
 In the case of 
\emph on
isoparametric elements 
\emph default
it is further assumed that each element has a local coordinate system, named
 the 
\emph on
natural coordinates
\emph default
, and the coordinates and shape of the element are discretized using the
 same functions.
 The discretization process is established by interpolating the geometry
 in terms of the coordinates 
\begin_inset Formula $\mathbf{X}_{a}$
\end_inset

 of the 
\emph on
nodes
\emph default
 that define the geometry of a finite element, and the 
\emph on
shape functions
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{X}=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{1},\xi_{2},\xi_{3}\right)\mathbf{X}_{a}\,,\label{eq181}
\end{equation}

\end_inset

where 
\begin_inset Formula $n$
\end_inset

 is the number of nodes and 
\begin_inset Formula $\xi_{i}$
\end_inset

 are the natural coordinates.
 Similarly, the motion is described in terms of the current position 
\begin_inset Formula $\mathbf{x}_{a}\left(t\right)$
\end_inset

 of the 
\emph on
same
\emph default
 particles: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(t\right)=\sum\limits _{a=1}^{n}N_{a}\mathbf{x}_{a}\left(t\right)\,.\label{eq182}
\end{equation}

\end_inset

Quantities such as displacement, velocity and virtual velocity can be discretize
d in a similar way.
\end_layout

\begin_layout Standard
In deriving the discretized equilibrium equations, the integrations performed
 over the entire volume can be written as a sum of integrations constrained
 to the volume of an element.
 For this reason, the discretized equations are defined in terms of integrations
 over a particular element 
\begin_inset Formula $e$
\end_inset

.
 The discretized equilibrium equations for this particular element per node
 is given by 
\begin_inset Formula 
\begin{equation}
\delta W^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}\right)=\delta\mathbf{v}_{a}\cdot\left(\mathbf{T}_{a}^{\left(e\right)}-\mathbf{F}_{a}^{\left(e\right)}\right)\,,\label{eq183}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}T_{a}^{\left(e\right)} & =\int\limits _{v^{\left(e\right)}}\boldsymbol{\sigma}\cdot\nabla N_{a}\,dv\,,\\
F_{a}^{\left(e\right)} & =\int\limits _{v^{\left(e\right)}}N_{a}\mathbf{f}\,dv+\int\limits _{\partial v^{\left(e\right)}}N_{a}\mathbf{t}\,da\,.
\end{aligned}
\label{eq184}
\end{equation}

\end_inset

The linearization of the internal virtual work can be split into a 
\emph on
material
\emph default
 and an 
\emph on
initial stress
\emph default
 component 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right] & =\int\limits _{v^{\left(e\right)}}\delta\mathbf{d}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,dv+\int\limits _{v^{\left(e\right)}}\boldsymbol{\sigma}:\left[\left(\nabla\mathbf{u}\right)^{T}\cdot\nabla\delta\mathbf{v}\right]\,dv\\
 & =D\delta W_{c}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]+D\delta W_{\sigma}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]\,.
\end{aligned}
\label{eq185}
\end{equation}

\end_inset

The constitutive component can be discretized as follows: 
\begin_inset Formula 
\begin{equation}
D\delta W_{c}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\delta\mathbf{v}_{a}\cdot\left(\int\limits _{v^{\left(e\right)}}\mathbf{B}_{a}^{T}\mathbf{D}\mathbf{B}_{b}\,dv\right)\mathbf{u}_{b}\,.\label{eq186}
\end{equation}

\end_inset

The term in parentheses defines the constitutive component of the tangent
 matrix relating node 
\begin_inset Formula $a$
\end_inset

to node 
\begin_inset Formula $b$
\end_inset

in element 
\begin_inset Formula $e$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{c,ab}^{\left(e\right)}=\int\limits _{v^{\left(e\right)}}\mathbf{B}_{a}^{T}\mathbf{DB}_{b}\,dv\,.\label{eq187}
\end{equation}

\end_inset

Here, the linear strain-displacement matrix 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset


\series default
 relates the displacements to the small-strain tensor in Voigt Notation:
 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\varepsilon}=\sum\limits _{a=1}^{n}\mathbf{B}_{a}\mathbf{u}_{a}\,.\label{eq188}
\end{equation}

\end_inset

Or, written out completely, 
\begin_inset Formula 
\begin{equation}
\mathbf{B}_{a}=\left[\begin{array}{ccc}
\partial N_{a}/\partial x & 0 & 0\\
0 & \partial N_{a}/\partial y & 0\\
0 & 0 & \partial N_{a}/\partial z\\
\partial N_{a}/\partial y & \partial N_{a}/\partial x & 0\\
0 & \partial N_{a}/\partial z & \partial N_{a}/\partial y\\
\partial N_{a}/\partial z & 0 & \partial N_{a}/\partial z
\end{array}\right]\,.\label{eq189}
\end{equation}

\end_inset

The spatial constitutive matrix 
\series bold

\begin_inset Formula $\mathbf{D}$
\end_inset

 
\series default
is constructed from the components of the fourth-order tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 using the following table; 
\begin_inset Formula $D_{IJ}=\mathcal{C}_{ijkl}$
\end_inset

where
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
I/J
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
i/k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
j/l
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The initial stress component can be written as follows: 
\begin_inset Formula 
\begin{equation}
D\delta W_{\sigma}^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}\right)\left[N_{b}\mathbf{u}_{b}\right]=\int\limits _{v^{\left(e\right)}}\left(\nabla N_{a}\cdot\boldsymbol{\sigma}\cdot\nabla N_{b}\right)\mathbf{I}\,dv.\label{eq190}
\end{equation}

\end_inset

For the pressure component of the external virtual work, we find 
\begin_inset Formula 
\begin{equation}
D\delta W_{p}^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}_{a}\right)\left[N_{b}\mathbf{u}_{b}\right]=\delta\mathbf{v}_{a}\cdot\mathbf{K}_{p,ab}^{\left(e\right)}\cdot\mathbf{u}_{b}\,,\label{eq191}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{p,ab}^{\left(e\right)} & =\mathcal{E}\mathbf{k}_{p,ab}^{\left(e\right)},\\
\mathbf{k}_{p,ab}^{\left(e\right)} & =\frac{1}{2}\int_{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\xi}\left(\frac{\partial N_{a}}{\partial\eta}N_{b}-\frac{\partial N_{b}}{\partial\eta}N_{a}\right)d\xi\,d\eta\\
 & +\frac{1}{2}\int_{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\eta}\left(\frac{\partial N_{a}}{\partial\xi}N_{b}-\frac{\partial N_{b}}{\partial\xi}N_{a}\right)d\xi\,d\eta\,.
\end{aligned}
\label{eq192}
\end{equation}

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Weak formulation for biphasic materials
\begin_inset CommandInset label
LatexCommand label
name "sec:sec:Biphasic-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
A weak form of the statement conservation of linear momemtum for the quasi-stati
c case is obtained by using Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq105"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\delta W=\int_{b}\left[\delta\mathbf{v}^{s}\cdot\left(\divg\boldsymbol{\sigma}+\rho\mathbf{b}\right)+\delta p\,\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\right]dv=0\,,\label{eq193}
\end{equation}

\end_inset

where 
\begin_inset Formula $b$
\end_inset

 is the domain of interest defined on the solid matrix, 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

 is a virtual velocity of the solid and 
\begin_inset Formula $\delta p$
\end_inset

 is a virtual pressure of the fluid 
\begin_inset CommandInset citation
LatexCommand citep
key "Un06"

\end_inset

.
 
\begin_inset Formula $dv$
\end_inset

 is an elemental volume of 
\begin_inset Formula $b$
\end_inset

.
 Using the divergence theorem, this expression may be rearranged as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}\,da+\int_{\partial b}\delta p\,w_{n}\,da+\int_{b}\delta\mathbf{v}^{s}\cdot\rho\mathbf{b}\,dv\\
 & -\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}^{s}\,dv-\int_{b}\left(\mathbf{w}\cdot\grad\delta p-\delta p\,\divg\mathbf{v}^{s}\right)\,dv
\end{aligned}
\,,\label{eq194}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{d}^{s}=\left(\grad\delta\mathbf{v}^{s}+\grad^{T}\delta\mathbf{v}^{s}\right)/2$
\end_inset

 is the virtual rate of deformation tensor, 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 is the total traction on the surface 
\begin_inset Formula $\partial b$
\end_inset

, and 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 is the component of the fluid flux normal to 
\begin_inset Formula $\partial b$
\end_inset

, with 
\begin_inset Formula $\mathbf{n}$
\end_inset

 representing the unit outward normal to 
\begin_inset Formula $\partial b$
\end_inset

.
 
\begin_inset Formula $da$
\end_inset

 represents an elemental area of 
\begin_inset Formula $\partial b$
\end_inset

.
 In this type of problem, essential boundary conditions are prescribed for
 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

, and natural boundary conditions are prescribed for 
\begin_inset Formula $\mathbf{t}$
\end_inset

 and 
\begin_inset Formula $w_{n}$
\end_inset

.
 In the expression of Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq194"

\end_inset

, 
\begin_inset Formula $\delta W\left(\boldsymbol{\chi}^{s},p,\delta\mathbf{v}^{s},\delta p\right)$
\end_inset

 represents the virtual work.
\end_layout

\begin_layout Subsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-linearization"

\end_inset


\end_layout

\begin_layout Standard
Since the system of equations in Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq194"

\end_inset

 is highly nonlinear, its solution requires an iterative scheme such as
 Newton's method.
 This requires the linearization of 
\begin_inset Formula $\delta W$
\end_inset

 at some trial solution 
\begin_inset Formula $\left(\boldsymbol{\chi}_{k}^{s},p_{k}\right)$
\end_inset

, along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 in 
\begin_inset Formula $\boldsymbol{\chi}^{s}$
\end_inset

 and an increment 
\begin_inset Formula $\Delta p$
\end_inset

 in 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta p\right]=0,\label{eq195}
\end{equation}

\end_inset

where 
\begin_inset Formula $Df\left[\Delta q\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $f$
\end_inset

 along 
\begin_inset Formula $\Delta q$
\end_inset

.
 For convenience, the virtual work may be separated into its internal and
 external parts, 
\begin_inset Formula 
\begin{equation}
\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}},\label{eq196}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta W_{\mbox{int}}=\int_{b}\boldsymbol{\sigma}:\delta\mathbf{d}^{s}\,dv+\int_{b}\left(\mathbf{w}\cdot\grad\delta p-\delta p\,\frac{\dot{J}}{J}\right)\,dv,\label{eq197}
\end{equation}

\end_inset

where we have substituted 
\begin_inset Formula $\divg\mathbf{v}^{s}=\dot{J}/J$
\end_inset

, and 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}\,da+\int_{\partial b}\delta p\,w_{n}\,da+\int_{b}\delta\mathbf{v}^{s}\cdot\rho\mathbf{b}\,dv\,.\label{eq198}
\end{equation}

\end_inset

The evaluation of the directional derivatives can be performed following
 a standard approach 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
 In particular, a backward difference scheme is used to evaluate 
\begin_inset Formula $\dot{J}\approx\left(J-J^{-\Delta t}\right)/\Delta t$
\end_inset

, where 
\begin_inset Formula $J^{-\Delta t}$
\end_inset

 is the value of 
\begin_inset Formula $J$
\end_inset

 at the previous time step.
 For the internal part of the virtual work, the directional derivative along
 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}\,dv+\int_{b}\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}^{s}\right)\,dv\\
 & -\int_{b}\frac{\delta p}{\Delta t}\divg\Delta\mathbf{u}\,dv\\
 & -\int_{b}\grad\delta p\cdot\left(\boldsymbol{\mathcal{K}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad p-\rho_{T}^{w}\mathbf{b}^{w}\right)\,dv\\
 & +\int_{b}\grad\delta p\cdot\mathbf{k}\cdot\rho_{T}^{w}\left(\grad^{T}\Delta\mathbf{u}\cdot\mathbf{b}^{w}+\grad\mathbf{b}^{w}\cdot\Delta\mathbf{u}\right)dv\,,
\end{aligned}
\label{eq199}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order spatial elasticity tensor for the mixture and 
\begin_inset Formula $\Delta\boldsymbol{\varepsilon}=\left(\grad\Delta\mathbf{u}+\grad^{T}\Delta\mathbf{u}\right)/2$
\end_inset

.
 Based on the relation of Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq104"

\end_inset

, the spatial elasticity tensor may also be expanded as 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}+p\left(-\mathbf{I}\otimes\mathbf{I}+2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right),\label{eq200}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor for the solid matrix 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"

\end_inset

.
 It is related to the material elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathbb{C}}^{e}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):\boldsymbol{\mathbb{C}}^{e}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right),\label{eq201}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid matrix, 
\begin_inset Formula $\boldsymbol{\mathbb{C}}^{e}=\partial\mathbf{S}^{e}/\partial\mathbf{E}$
\end_inset

 where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is the Lagrangian strain tensor and 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the second Piola-Kirchhoff stress tensor, related to the Cauchy stress
 tensor via 
\begin_inset Formula $\boldsymbol{\sigma}^{e}=J^{-1}\mathbf{F}\cdot\mathbf{S}^{e}\cdot\mathbf{F}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
Similarly, 
\begin_inset Formula $\boldsymbol{\mathcal{K}}$
\end_inset

 is a fourth-order tensor that represents the spatial measure of the rate
 of change of permeability with strain.
 It is related to its material frame equivalent 
\begin_inset Formula $\boldsymbol{\mathbb{K}}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):\boldsymbol{\mathbb{K}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right),\label{eq202}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbb{K}}=\partial\mathbf{K}/\partial\mathbf{E}$
\end_inset

 and 
\begin_inset Formula $\mathbf{K}$
\end_inset

 is the permeability tensor in the material frame, such that 
\begin_inset Formula $\mathbf{k}=J^{-1}\mathbf{F}\cdot\mathbf{K}\cdot\mathbf{F}^{T}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{K}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}$
\end_inset

 are symmetric tensors, it follows that 
\begin_inset Formula $\boldsymbol{\mathcal{K}}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathbb{K}}$
\end_inset

 exhibit two minor symmetries (e.g., 
\begin_inset Formula $\mathcal{K}_{jikl}=\mathcal{K}_{ijkl}$
\end_inset

 and 
\begin_inset Formula $\mathcal{K}_{ijlk}=\mathcal{K}_{ijkl})$
\end_inset

.
 However, unlike the elasticity tensor, it is not necessary that these tensors
 exhibit major symmetry (e.g., 
\begin_inset Formula $\mathcal{K}_{klij}\ne\mathcal{K}_{ijkl}$
\end_inset

 in general).
\end_layout

\begin_layout Standard
The directional derivative of 
\begin_inset Formula $\delta W_{\mbox{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta p$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}\left[\Delta p\right]=-\int_{b}\grad\delta p\cdot\mathbf{k}\cdot\grad\Delta p\,dv-\int_{b}\Delta p\,\divg\delta\mathbf{v}^{s}\,dv\,.\label{eq203}
\end{equation}

\end_inset

Note that letting 
\begin_inset Formula $p=0$
\end_inset

 and 
\begin_inset Formula $\delta p=0$
\end_inset

 in the above equations recovers the virtual work relations for nonlinear
 elasticity of compressible solids.
 The resulting simplified equation emerging from Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 is symmetric to interchanges of 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

, producing a symmetric stiffness matrix in the finite element formulation
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
 However, the general relations of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq203"

\end_inset

 do not exhibit symmetry to interchanges of 
\begin_inset Formula $\left(\Delta\mathbf{u},\Delta p\right)$
\end_inset

 and 
\begin_inset Formula $\left(\delta\mathbf{v}^{s},\delta p\right)$
\end_inset

, implying that the finite element stiffness matrix for a solid-fluid mixture
 is not symmetric under general conditions.
\end_layout

\begin_layout Standard
The directional derivatives of the external virtual work 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 depend on the type of boundary conditions being considered.
 For a prescribed total normal traction 
\begin_inset Formula $t_{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{t}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot t_{n}\mathbf{n}\,da,\label{eq204}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{t}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot t_{n}\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{t}\left[\Delta p\right] & =0,
\end{aligned}
\label{eq205}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\alpha=1,2\label{eq206}
\end{equation}

\end_inset

are covariant basis (tangent) vectors on 
\begin_inset Formula $\partial b$
\end_inset

, such that 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq207}
\end{equation}

\end_inset

For a prescribed normal effective traction 
\begin_inset Formula $t_{n}^{e}$
\end_inset

, where 
\begin_inset Formula $\mathbf{t}=\left(-p+t_{n}^{e}\right)\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 is not prescribed, then 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{e}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot\left(-p+t_{n}^{e}\right)\mathbf{n}\,da\,,\label{eq208}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{e}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot\left(-p+t_{n}^{e}\right)\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{e}\left[\Delta p\right] & =-\int_{\partial b}\delta\mathbf{v}^{s}\cdot\Delta p\,\mathbf{n}\,da\,.
\end{aligned}
\label{eq209}
\end{equation}

\end_inset

For a prescribed normal fluid flux 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{w}=\int_{\partial b}\delta p\,w_{n}\,da\,,\label{eq210}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{w}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta p\,w_{n}\,\mathbf{n}\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{w}\left[\Delta p\right] & =0\,.
\end{aligned}
\label{eq211}
\end{equation}

\end_inset

Finally, for a prescribed external body force, recognizing that 
\begin_inset Formula $\rho\mathbf{b}=\rho^{s}\mathbf{b}^{s}+\rho^{w}\mathbf{b}^{w}$
\end_inset

 and assuming that the body forces 
\begin_inset Formula $\mathbf{b}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}^{w}$
\end_inset

 do not depend on 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{\text{ext}}^{b}\right)\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\mathbf{v}^{s}\cdot\left[\left(\rho^{s}grad\mathbf{b}^{s}+\rho^{w}grad\mathbf{b}^{w}\right)\cdot\Delta\mathbf{u}+\left(\divg\Delta\mathbf{u}\right)\rho_{T}^{w}\mathbf{b}^{w}\right]\,dv\,,\\
D\left(\delta W_{\text{ext}}^{b}\right)\left[\Delta p\right] & =0\,.
\end{aligned}
\label{eq212}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-discretization"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{s} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \delta p & =\sum\limits _{a=1}^{m}N_{a}\delta p_{a}\,,\\
\Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,, & \Delta p & =\sum\limits _{b=1}^{m}N_{b}\Delta p_{b}\,,
\end{aligned}
\label{eq213}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a},\delta p_{a},\Delta\mathbf{u}_{b}\mbox{\thinspace and\thinspace}\Delta p_{b}$
\end_inset

 respectively represent nodal values of 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

, 
\begin_inset Formula $\delta p$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\Delta p$
\end_inset

, and 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
 Then the discretized form of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 in Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq197"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}
\end{array}\right]\,,\label{eq214}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\mbox{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the spatial frame to the parametric
 space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\mathbf{r}_{a}^{u}=\boldsymbol{\sigma}\cdot\nabla N_{a}\,,\quad r_{a}^{p}=\mathbf{w}\cdot\nabla N_{a}-N_{a}\mbox{div}\mathbf{v}^{s}\,,\label{eq215}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\mbox{int}}$
\end_inset

 in Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq203"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta p_{b}
\end{array}\right]\,,\label{eq216}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\nabla N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\nabla N_{b}+\left(\nabla N_{a}\cdot\boldsymbol{\sigma}\cdot\nabla N_{b}\right)\mathbf{I}\\
 & -N_{a}\left[N_{b}\left(\rho^{s}\nabla\mathbf{b}^{s}+\rho^{w}\nabla\mathbf{b}^{w}\right)+\rho_{T}^{w}\mathbf{b}^{w}\otimes\nabla N_{b}\right]\,,\\
\mathbf{k}_{ab}^{up} & =-N_{b}\nabla N_{a}\,,\\
\mathbf{k}_{ab}^{pu} & =-\left(\nabla N_{a}\cdot\boldsymbol{\mathcal{K}}\cdot\nabla N_{b}\right)\cdot\left(\nabla p-\rho_{T}^{w}\mathbf{b}^{w}\right)-\frac{1}{\Delta t}N_{a}\cdot\nabla N_{b}\\
 & +\rho_{T}^{w}\left(\mathbf{b}^{w}\otimes\nabla N_{b}+N_{b}\nabla^{T}\mathbf{b}^{w}\right)\cdot\mathbf{k}\cdot\nabla N_{a}\,,\\
k_{ab}^{pp} & =-\nabla N_{a}\cdot\mathbf{k}\cdot\nabla N_{b},
\end{aligned}
\label{eq217}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 is a discrete increment in time.
 In a numerical implementation, it has been found that evaluating 
\begin_inset Formula $\divg\mathbf{v}^{s}$
\end_inset

 from 
\begin_inset Formula $\dot{J}/J$
\end_inset

, where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, yields more accurate solutions than evaluating it from the trace of 
\begin_inset Formula $\grad\mathbf{v}^{s}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07c"

\end_inset

.
\end_layout

\begin_layout Standard
For the various types of contributions to the external virtual work, a similar
 discretization produces 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}
\end{array}\right]\,,\label{eq218}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta p_{b}
\end{array}\right]\,,\label{eq219}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,.\label{eq220}
\end{equation}

\end_inset

In this case, 
\begin_inset Formula $m$
\end_inset

 represents the number of nodes on an element face.
 For a prescribed normal traction 
\begin_inset Formula $t_{n}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq204"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq205"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =t_{n}N_{a}\mathbf{n}\,, & r_{a}^{u} & =0\,,\\
\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\frac{1}{J_{\eta}}\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =\mathbf{0}\,, & k_{ab}^{pp} & =0\,,
\end{aligned}
\label{eq221}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \mathbf{v}\right\} =-\boldsymbol{\mathbf{\mathcal{E}}}\cdot\mathbf{v}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathbf{\mathcal{E}}}$
\end_inset

 is the third-order permutation pseudo-tensor.
 For a prescribed traction 
\begin_inset Formula $t_{n}^{e}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq208"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq209"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\left(-p+t_{n}^{e}\right)N_{a}\mathbf{n}\,, & r_{a}^{u} & =0\,,\\
\mathbf{K}_{ab}^{uu} & =\left(-p+t_{n}^{e}\right)N_{a}\frac{1}{J_{\eta}}\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =\mathbf{0}\,, & k_{ab}^{pp} & =0\,.
\end{aligned}
\label{eq222}
\end{equation}

\end_inset

For a prescribed normal fluid flux 
\begin_inset Formula $w_{n}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq210"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq211"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\mathbf{0}\,, & r_{a}^{u} & =w_{n}N_{a}\,,\\
\mathbf{K}_{ab}^{uu} & =\mathbf{0}\,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =w_{n}N_{a}\frac{1}{J_{\eta}}\mathbf{n}\times\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\,, & k_{ab}^{pp} & =0\,.
\end{aligned}
\label{eq223}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Weak Formulation for Biphasic-Solute Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:BS-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral for this problem is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{b}\delta\mathbf{v}\cdot\divg\boldsymbol{\sigma}\,dv+\int_{b}\delta\tilde{p}\,\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\,dv\\
 & +\int_{b}\delta\tilde{c}\left[\frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\mathbf{j}+\phi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)\right]\,dv\,,
\end{aligned}
\label{eq224}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity of the solid, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

 is the virtual effective fluid pressure, and 
\begin_inset Formula $\delta\tilde{c}$
\end_inset

 is the virtual molar energy of the solute.
 
\begin_inset Formula $b$
\end_inset

 represents the mixture domain in the spatial frame and 
\begin_inset Formula $dv$
\end_inset

 is an elemental mixture volume in 
\begin_inset Formula $b$
\end_inset

.
 In the last integral of 
\begin_inset Formula $\delta W$
\end_inset

, note that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\varphi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)=\frac{1}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\,,\label{eq225}
\end{equation}

\end_inset

where 
\begin_inset Formula $D^{s}f/Dt\equiv\partial f/\partial t+\mathbf{v}^{s}\cdot\grad f$
\end_inset

 is the material time derivative of a scalar function 
\begin_inset Formula $f$
\end_inset

 in the spatial frame, following the solid.
 Similarly, note that 
\begin_inset Formula $\divg\mathbf{v}^{s}=J^{-1}\left(D^{s}J/Dt\right)$
\end_inset

.
 Using the divergence theorem, the virtual work integral may be separated
 into internal and external contributions, 
\begin_inset Formula $\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}}$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{\text{int}} & =\int_{b}\boldsymbol{\sigma}:\delta\mathbf{d}^{s}\,dv+\int_{b}\left(\mathbf{w}\cdot\grad\delta\tilde{p}-\frac{\delta\tilde{p}}{J}\frac{D^{s}J}{Dt}\right)\,dv\\
 & +\int_{b}\left[\mathbf{j}\cdot\grad\delta\tilde{c}-\frac{\delta\tilde{c}}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\right]dv\,,\\
\delta W_{\text{ext}} & =\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\delta\tilde{c}\,j_{n}\right)\,da\,,
\end{aligned}
\label{eq226}
\end{equation}

\end_inset

with 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 being evaluated on the domain's boundary surface 
\begin_inset Formula $\partial b$
\end_inset

.
 In the first expression 
\begin_inset Formula $\delta\mathbf{d}^{s}=\left(\grad\delta\mathbf{v}+\grad^{T}\delta\mathbf{v}\right)/2$
\end_inset

 represents the virtual solid rate of deformation.
\end_layout

\begin_layout Standard
To solve this nonlinear system using an iterative Newton scheme, the virtual
 work must be linearized at trial solutions, along increments in 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta\tilde{p}\right]+D\delta W\left[\Delta\tilde{c}\right]\approx0\,,\label{eq227}
\end{equation}

\end_inset

where, for any function 
\begin_inset Formula $f\left(q\right)$
\end_inset

, 
\begin_inset Formula $Df\left[\Delta q\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $f$
\end_inset

 along 
\begin_inset Formula $\Delta q$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
 To operate the directional derivative on the integrand of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

, it is first necessary to convert the integrals from the spatial to the
 material domain 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\int_{B}\mathbf{S}:\delta\mathbf{\dot{E}}\,dV+\int_{B}\left(\mathbf{W}\cdot\grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\,dV+\int_{B}\left[\mathbf{J}\cdot\grad\delta\tilde{c}-\delta\tilde{c}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\right]dV\,,\label{eq228}
\end{equation}

\end_inset

where 
\begin_inset Formula $B$
\end_inset

 represents the mixture domain in the material frame, 
\begin_inset Formula $dV$
\end_inset

 is an elemental mixture volume in 
\begin_inset Formula $B$
\end_inset

, and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =J\,\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,,\\
\delta\mathbf{\dot{E}} & =\mathbf{F}^{T}\cdot\delta\mathbf{d}^{s}\cdot\mathbf{F}\,,\\
\mathbf{W} & =J\,\mathbf{F}^{-1}\cdot\mathbf{w}\,,\\
\mathbf{J} & =J\,\mathbf{F}^{-1}\cdot\mathbf{j}\,.
\end{aligned}
\label{eq229}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset

, and material flux vectors 
\begin_inset Formula $\mathbf{W}$
\end_inset

 and 
\begin_inset Formula $\mathbf{J}$
\end_inset

, are respectively related to 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

, 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}$
\end_inset

 by the Piola transformations for tensors and vectors 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97,Marsden94"

\end_inset

.
 Substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq229"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{W} & =-\mathbf{\tilde{K}}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}J^{-1}\mathbf{C}\cdot\mathbf{D}\cdot\grad\tilde{c}\right)\,,\\
\mathbf{J} & =\tilde{\kappa}\mathbf{D}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}J^{-1}\mathbf{C}\cdot\mathbf{W}\right)\,,
\end{aligned}
\label{eq230}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\tilde{K}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 are the material representations of the permeability and diffusivity tensors,
 related to 
\begin_inset Formula $\mathbf{\tilde{k}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{d}$
\end_inset

 via the Piola transformation, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{\tilde{K}} & =J\,\mathbf{F}^{-1}\cdot\mathbf{\tilde{k}}\cdot\mathbf{F}^{-T}\,,\\
\mathbf{D} & =J\,\mathbf{F}^{-1}\cdot\mathbf{d}\cdot\mathbf{F}^{-T}\,.
\end{aligned}
\label{eq231}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 is rather involved and a summary of the resulting lengthy expressions is
 provided below.
 In consideration of the dearth of experimental data relating 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 to the complete state of solid matrix strain (such as 
\begin_inset Formula $\mathbf{C})$
\end_inset

, this implementation assumes that the dependence of these functions on
 the strain is restricted to a dependence on the volume ratio 
\begin_inset Formula $J=\left(\det\mathbf{C}\right)^{1/2}$
\end_inset

.
 Furthermore, it is assumed that the free solution diffusivity 
\begin_inset Formula $d_{0}$
\end_inset

 is independent of the strain.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 is described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

.
 Following the linearization procedure, the resulting expressions may be
 discretized by nodally interpolating 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

 over finite elements, producing a set of equations in matrix form, as described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

.
\end_layout

\begin_layout Standard
The formulation presented in this study is implemented in FEBio by introducing
 an additional module dedicated to solute transport in deformable porous
 media.
 Classes are implemented to describe material functions for 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

, 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

 (and 
\begin_inset Formula $d_{0})$
\end_inset

, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

, which allow the formulation of any desired constitutive relation for these
 functions of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, along with corresponding derivatives of these functions with respect to
 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

.
 The implementation accepts essential boundary conditions on 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, or natural boundary conditions on 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

; initial conditions may also be specified for 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

.
 Analysis results for pressure and concentration may be displayed either
 as 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, or as 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 by inverting the relations of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq118"

\end_inset

.
\end_layout

\begin_layout Subsection
Linearization of Internal Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-linearization"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq228"

\end_inset

 may be linearized term by term along increments in 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 using the general form 
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}F\,dV\right)\left[\Delta q\right]=\int_{B}DF\left[\Delta q\right]\,dV=\int_{b}f\,dv\,.\label{eq232}
\end{equation}

\end_inset

For notational simplicity, the integral sign is omitted and the linearization
 of each term is presented in the form 
\begin_inset Formula $DF\left[\Delta q\right]\,dV=f\,dv$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{S}:\delta\dot{\mathbf{E}}\right)\left[\Delta\mathbf{u}\right]\,dV=\left[\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}+\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}\right)\right]\,dv\,,\label{eq233}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor of the mixture, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}-\left(\tilde{p}+R\theta\,\Phi\tilde{\kappa}\tilde{c}\right)\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-R\theta\tilde{c}\,J\frac{\partial\left(\Phi\tilde{\kappa}\right)}{\partial J}\mathbf{I}\otimes\mathbf{I}\,,\label{eq234}
\end{equation}

\end_inset

and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor of the solid matrix, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{S}^{e}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq235}
\end{equation}

\end_inset

The linearization of the second term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{u}^{\prime}\,dv\,,\label{eq236}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{u}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\mathbf{u}\right]=-\left(\tilde{\boldsymbol{\mathcal{K}}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -\frac{R\theta}{d_{0}}\tilde{\mathbf{k}}\cdot\left(J^{2}\frac{\partial\left(J^{-1}\tilde{\kappa}\right)}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{I}+2\tilde{\kappa}\,\Delta\boldsymbol{\varepsilon}\right)\cdot\mathbf{d}\cdot\grad\tilde{c}-\tilde{\kappa}\frac{R\theta}{d_{0}}\tilde{\mathbf{k}}\cdot\left(\boldsymbol{\mathcal{D}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\grad\tilde{c}\,,
\end{aligned}
\label{eq237}
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\boldsymbol{\mathcal{K}}} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\tilde{\mathbf{K}}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,\\
\boldsymbol{\mathcal{D}} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{D}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,
\end{aligned}
\label{eq238}
\end{equation}

\end_inset

representing the spatial tangents, with respect to the strain, of the effective
 permeability and solute diffusivity, respectively.
 These fourth-order tensors exhibit minor symmetries but not major symmetry,
 as described recently 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

.
 Since 
\begin_inset Formula $\tilde{\mathbf{K}}$
\end_inset

 is given by substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset


\begin_inset Formula $_{3}$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq231"

\end_inset


\begin_inset Formula $_{1}$
\end_inset

, the evaluation of 
\begin_inset Formula $\tilde{\boldsymbol{\mathcal{K}}}$
\end_inset

 is rather involved and it can be shown that 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{K}}}=2\left(\tilde{\mathbf{k}}\otimes\mathbf{I}-2\tilde{\mathbf{k}}\,\underline{\otimes}\,\mathbf{I}\right)-\left(\tilde{\mathbf{k}}\,\overline{\underline{\otimes}}\,\tilde{\mathbf{k}}\right):\boldsymbol{\mathcal{G}}\,,\label{eq239}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{G}} & =2\left(\mathbf{k}^{-1}\otimes\mathbf{I}-2\mathbf{k}^{-1}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-\left(\mathbf{k}^{-1}\,\underline{\otimes}\,\mathbf{k}^{-1}\right):\boldsymbol{\mathcal{K}}\\
 & +\frac{R\theta\tilde{c}}{d_{0}}J\frac{\partial}{\partial J}\left(\frac{\tilde{\kappa}}{\varphi^{w}}\right)\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\otimes\mathbf{I}\\
 & +\frac{R\theta\tilde{c}}{d_{0}}\frac{\tilde{\kappa}}{\varphi^{w}}\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\underline{\otimes}\,\mathbf{I}-\frac{1}{d_{0}}\boldsymbol{\mathcal{D}}\right)
\end{aligned}
\label{eq240}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{K}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq241}
\end{equation}

\end_inset

The next term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 linearizes to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=-\delta\tilde{p}\frac{1}{\Delta t}\divg\Delta\mathbf{u}\,dv\,,\label{eq242}
\end{equation}

\end_inset

where we used a backward difference scheme to approximate the time derivative,
 
\begin_inset Formula 
\begin{equation}
\frac{\partial J}{\partial t}\approx\frac{1}{\Delta t}\left(J-J^{-\Delta t}\right)\,,\label{eq243}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 represents the time increment relative to the previous time point.
 The next term is given by 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{c}\cdot\mathbf{j}_{u}^{\prime}\,dv,\label{eq244}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{u}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\mathbf{u}\right]=\left(J\frac{\partial\tilde{\kappa}}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{d}+\tilde{\kappa}\boldsymbol{\mathcal{D}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\\
 & +\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\left(2\Delta\boldsymbol{\varepsilon}-\left(\divg\Delta\mathbf{u}\right)\mathbf{I}\right)\cdot\mathbf{w}\right)+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{u}^{\prime}
\end{aligned}
\,.\label{eq245}
\end{equation}

\end_inset

Using a backward difference scheme for the time derivative, the last term
 is 
\begin_inset Formula 
\begin{equation}
D\left(\delta\tilde{c}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=\frac{\delta\tilde{c}}{\Delta t}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\right)}{\partial J}\tilde{c}\divg\Delta\mathbf{u}\,dv\,.\label{eq246}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the various terms in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{p}\right]\,dV=-\Delta\tilde{p}\,\divg\delta\mathbf{v}\,dv\,,\label{eq247}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\grad\delta\tilde{p}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,,\label{eq248}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}-\delta\tilde{c}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\grad\delta\tilde{c}\cdot\mathbf{d}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,.\label{eq249}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{c}\right]\,dV=\Delta\tilde{c}\left(\boldsymbol{\sigma}_{c}^{\prime}:\delta\mathbf{d}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\divg\delta\mathbf{v}\right)\,dv\,,\label{eq250}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{S}^{e}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq251}
\end{equation}

\end_inset

represents the spatial tangent of the stress with respect to the effective
 concentration.
 The next term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\tilde{c}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{c}^{\prime}\,dv\,,\label{eq252}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{c}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\tilde{c}\right]=-\Delta\tilde{c}\,\tilde{\mathbf{k}}_{c}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\left[\Delta\tilde{c}\left(\frac{\partial}{\partial\tilde{c}}\left(\frac{\tilde{\kappa}}{d_{0}}\right)\mathbf{d}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}_{c}^{\prime}\right)\cdot\grad\tilde{c}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\Delta\tilde{c}\right]\,,
\end{aligned}
\label{eq253}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\tilde{\mathbf{K}}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq254}
\end{equation}

\end_inset

is the spatial tangent of the effective hydraulic permeability with respect
 to the effective concentration.
\end_layout

\begin_layout Standard
The next term reduces to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{c}\right]\,dV=0\,.\label{eq255}
\end{equation}

\end_inset

The following term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}\right)\left[\Delta\tilde{c}\right]\,dV=\grad\delta\tilde{c}\cdot\mathbf{j}_{c}^{\prime}\,dv\,,\label{eq256}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{c}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\tilde{c}\right]\\
 & =\Delta\tilde{c}\left(\frac{\partial\tilde{\kappa}}{\partial\tilde{c}}\mathbf{d}+\tilde{\kappa}\mathbf{d}_{c}^{\prime}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\\
 & -\varphi^{w}\tilde{\kappa}\mathbf{d}\cdot\grad\Delta\tilde{c}+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{c}^{\prime}\,,
\end{aligned}
\label{eq257}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{D}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq258}
\end{equation}

\end_inset

is the spatial tangent of the diffusivity with respect to the effective
 concentration.
\end_layout

\begin_layout Standard
The last term is 
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\delta\tilde{c}\right)\left[\Delta\tilde{c}\right]\,dV=\delta\tilde{c}\frac{\varphi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\Delta\tilde{c}\,dv\,,\label{eq259}
\end{equation}

\end_inset

where we similarly used a backward difference scheme to discretize the time
 derivative.
\end_layout

\begin_layout Subsection
Linearization of External Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-linearization-external"

\end_inset


\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 depends on whether natural boundary conditions are prescribed as area densities
 or total net values over an area.
 Thus, in the case when 
\begin_inset Formula $\mathbf{t}\,da$
\end_inset

 (net force), 
\begin_inset Formula $w_{n}da$
\end_inset

 (net volumetric flow rate), or 
\begin_inset Formula $j_{n}da$
\end_inset

 (net molar flow rate) are prescribed over the elemental area 
\begin_inset Formula $da$
\end_inset

, there is no variation in 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 and it follows that 
\begin_inset Formula $D\delta W_{\text{ext}}=0$
\end_inset

.
 Alternatively, in the case when 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 or 
\begin_inset Formula $j_{n}$
\end_inset

 are prescribed, the linearization may be performed by evaluating the integral
 in the parametric space of the boundary surface 
\begin_inset Formula $\partial b$
\end_inset

, with parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2}\right)$
\end_inset

.
 Accordingly, for a point 
\begin_inset Formula $\mathbf{x}\left(\eta^{1},\eta^{2}\right)$
\end_inset

 on 
\begin_inset Formula $\partial b$
\end_inset

, surface tangents (covariant basis vectors) are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\left(\alpha=1,2\right)\label{eq260}
\end{equation}

\end_inset

and the outward unit normal is 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq261}
\end{equation}

\end_inset

The elemental area on 
\begin_inset Formula $\partial b$
\end_inset

 is 
\begin_inset Formula $da=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}$
\end_inset

.
 Consequently, the external virtual work integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\delta\tilde{c}\,j_{n}\right)\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}\,.\label{eq262}
\end{equation}

\end_inset

The directional derivative of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 may then be applied directly to its integrand, since the parametric space
 is invariant 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
\end_layout

\begin_layout Standard
If we restrict traction boundary conditions to the special case of normal
 tractions, then 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

 where 
\begin_inset Formula $t_{n}$
\end_inset

 is the prescribed normal traction component.
 Then it can be shown that the linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{\text{ext}}\right)\left[\Delta\mathbf{u}\right]=\int_{\partial b}\left(t_{n}\delta\mathbf{v}+w_{n}\delta\tilde{p}\,\mathbf{n}+j_{n}\delta\tilde{c}\,\mathbf{n}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)d\eta^{1}d\eta^{2}\,.\label{eq263}
\end{equation}

\end_inset

The linearizations along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 reduce to zero, 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{p}\right]=0$
\end_inset

 and 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{c}\right]=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-discretization"

\end_inset


\end_layout

\begin_layout Standard
To discretize the virtual work relations, let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,,\\
\delta\tilde{p} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{p}_{a}\,, & \Delta\tilde{p} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{p}_{b}\,,\\
\delta\tilde{c} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{c}_{a}\,, & \Delta\tilde{c} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{c}_{b}\,,
\end{aligned}
\label{eq264}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}_{a}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}_{a}$
\end_inset

 respectively represent the nodal values of 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

; 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
\end_layout

\begin_layout Standard
The discretized form of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}\\
r_{a}^{c}
\end{array}\right]\,,\label{eq265}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\text{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the current spatial configuration
 to the parametric space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\,,\\
r_{a}^{p} & =\mathbf{w}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial J}{\partial t}\,,\\
r_{a}^{c} & =\mathbf{j}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\,,
\end{aligned}
\label{eq266}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

, 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{c}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 Since the parametric space is invariant, time derivatives are evaluated
 in a material frame.
 For example, the time derivative 
\begin_inset Formula $D^{s}J\left(\mathbf{x},t\right)/Dt$
\end_inset

 appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 becomes 
\begin_inset Formula $\partial J\left(\eta_{k},t\right)/\partial t$
\end_inset

 when evaluated at the parametric coordinates 
\begin_inset Formula $\eta_{k}=\left(\eta_{k}^{1},\eta_{k}^{2},\eta_{k}^{3}\right)$
\end_inset

 of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\text{int}}=D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{p}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{c}\right]$
\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up} & \mathbf{k}_{ab}^{uc}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp} & k_{ab}^{pc}\\
\mathbf{k}_{ab}^{cu} & k_{ab}^{cp} & k_{ab}^{cc}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}
\end{array}\right]\,,\label{eq267}
\end{equation}

\end_inset

where the terms in the first column are the discretized form of the linearizatio
n along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uu}=\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}+\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}\,,\label{eq268}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{pu}=\left(\mathbf{w}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{pu}\,,\label{eq269}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{cu}=\left(\mathbf{j}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{cu}\,,\label{eq270}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{u} & =J\frac{\partial\tilde{\kappa}}{\partial J}\left[\mathbf{d}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\right]\otimes\grad N_{b}+\tilde{\kappa}\left({-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}}\right)\cdot\mathbf{d}\cdot\grad N_{b}\\
 & +\tilde{\kappa}\left({-\varphi^{s}\left({\mathbf{d}\cdot\grad\tilde{c}}\right)\otimes\grad N_{b}+\frac{\tilde{c}}{d_{0}}\left[{2\left({\grad N_{b}\cdot\mathbf{w}}\right)\mathbf{d}-\left({\mathbf{d}\cdot\mathbf{w}}\right)\otimes\grad N_{b}}\right]}\right)+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{b}^{u}\;,
\end{aligned}
\label{eq272}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{pu}=-\frac{1}{\Delta t}\grad N_{b},\label{eq273}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{cu}=\tilde{c}\frac{\partial\left({J\phi^{w}\tilde{\kappa}}\right)}{\partial J}\mathbf{q}_{b}^{pu}.\label{eq274}
\end{equation}

\end_inset

The terms in the second column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{up}=-N_{b}\grad N_{a},\label{eq275}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=-\grad N_{a}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b},\label{eq276}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{cp}=-\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\grad N_{a}\cdot\mathbf{d}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}.\label{eq277}
\end{equation}

\end_inset

The terms in the third column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{uc}=N_{b}\left(\boldsymbol{\sigma}_{c}^{\prime}\cdot\grad N_{a}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\grad N_{a}\right)\,,\label{eq278}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pc}=\grad N_{a}\cdot\mathbf{w}_{b}^{c}\,,\label{eq279}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{cc}=\grad N_{a}\cdot\mathbf{j}_{b}^{c}+N_{a}q_{b}^{c}\,,\label{eq280}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{b}^{c} & =-N_{b}\tilde{\mathbf{k}}_{c}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\left[N_{b}\left(\frac{\partial}{\partial\tilde{c}}\left(\frac{\tilde{\kappa}}{d_{0}}\right)\mathbf{d}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}_{c}^{\prime}\right)\cdot\grad\tilde{c}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad N_{b}\right]\,,
\end{aligned}
\label{eq281}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{j}_{b}^{c}=N_{b}\left(\frac{\partial\tilde{\kappa}}{\partial\tilde{c}}\mathbf{d}+\tilde{\kappa}\mathbf{d}_{c}^{\prime}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)+\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\grad N_{b}+\frac{\tilde{c}}{d_{0}}\mathbf{w}_{b}^{c}\right)\,,\label{eq282}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
q_{b}^{c}=-N_{b}\frac{\phi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\,.\label{eq283}
\end{equation}

\end_inset

The discretization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
N_{a}t_{n}\mathbf{n}\\
N_{a}w_{n}\\
N_{a}j_{n}
\end{array}\right]\,,\label{eq284}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|$
\end_inset

.
 The summation is performed over all surface elements on which these boundary
 conditions are prescribed.
 The discretization of 
\begin_inset Formula $-D\delta W_{\text{ext}}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ab}^{pu} & 0 & 0\\
\mathbf{k}_{ab}^{cu} & 0 & 0
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}
\end{array}\right]\,,\label{eq285}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,,\\
\mathbf{k}_{ab}^{pu} & =-w_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}\,,\\
\mathbf{k}_{ab}^{cu} & =-j_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}\,.
\end{aligned}
\label{eq286}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} $
\end_inset

 is the antisymmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 (such that 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} \cdot\mathbf{q}=\mathbf{v}\times\mathbf{q}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{q})$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Weak Formulation for Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:MP-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral for a mixture of intrinsically incompressible
 constituents combines the balance of momentum for the mixture, the balance
 of mass for the mixture, and the balance of mass for each of the solutes.
 In addition, for charged mixtures, the condition of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq127"

\end_inset

 may be enforced as a penalty constraint on each solute mass balance equation:
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{b}\delta\mathbf{v}\cdot\mbox{div}\boldsymbol{\sigma}\,dv\\
 & +\int_{b}\delta\tilde{p}\,\mbox{div}\left(\mathbf{v}^{s}+\mathbf{w}\right)\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\delta\tilde{c}^{\alpha}\left[\frac{1}{J^{s}}\frac{D^{s}}{Dt}\left(J^{s}\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)+\mbox{div}\mathbf{j}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}\mbox{div}\mathbf{j}^{\beta}\right]\,dv\,,
\end{aligned}
\label{eq287}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity of the solid, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

 is the virtual effective fluid pressure, and 
\begin_inset Formula $\delta\tilde{c}^{\alpha}$
\end_inset

 is the virtual molar energy of solute 
\begin_inset Formula $\alpha$
\end_inset

.
 Here, 
\begin_inset Formula $b$
\end_inset

 represents the mixture domain in the spatial frame and 
\begin_inset Formula $dv$
\end_inset

 is an elemental volume in 
\begin_inset Formula $b$
\end_inset

.
 Applying the divergence theorem, 
\begin_inset Formula $\delta W$
\end_inset

 may be split into internal and external contributions to the virtual work,
 
\begin_inset Formula $\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}}$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{\text{int}} & =\int_{b}\boldsymbol{\sigma}:\delta\mathbf{D}\,dv+\int_{b}\left(\mathbf{w}\cdot\mbox{grad}\delta\tilde{p}-\frac{\delta\tilde{p}}{J^{s}}\frac{D^{s}J^{s}}{Dt}\right)\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\left[\mathbf{j}^{\alpha}\cdot\mbox{grad}\delta\tilde{c}^{\alpha}-\frac{\delta\tilde{c}^{\alpha}}{J^{s}}\frac{D^{s}}{Dt}\left(J^{s}\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)\right]\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\mbox{grad}\delta\tilde{c}^{\alpha}\cdot\sum\limits _{\beta\ne s,w}z^{\beta}\mathbf{j}^{\beta}\,dv\,,
\end{aligned}
\label{eq288}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left[\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\left(j_{n}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}j_{n}^{\beta}\right)\right]\,da\,.\label{eq289}
\end{equation}

\end_inset

In these expressions, 
\begin_inset Formula $\delta\mathbf{D}=\left(\mbox{grad}\delta\mathbf{v}+\mbox{grad}^{T}\delta\mathbf{v}\right)/2$
\end_inset

, 
\begin_inset Formula $\partial b$
\end_inset

 is the boundary of 
\begin_inset Formula $b$
\end_inset

, and 
\begin_inset Formula $da$
\end_inset

 is an elemental area on 
\begin_inset Formula $\partial b$
\end_inset

.
 In this finite element formulation, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 are used as nodal variables, and essential boundary conditions may be prescribe
d on these variables.
 Natural boundary conditions are prescribed to the mixture traction, 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

, normal fluid flux, 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

, and normal solute flux, 
\begin_inset Formula $j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the outward unit normal to 
\begin_inset Formula $\partial b$
\end_inset

.
 To solve the system 
\begin_inset Formula $\delta W=0$
\end_inset

 for nodal values of 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

, it is necessary to linearize these equations, as shown for example in
 Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

 for biphasic-solute materials.
 If the mixture is charged, it is also necessary to solve for the electric
 potential 
\begin_inset Formula $\psi$
\end_inset

 by solving the algebraic relation of the electroneutrality condition in
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

, which may be rewritten as 
\begin_inset Formula 
\begin{equation}
c^{F}+\sum\limits _{\beta\ne s,w}z^{\beta}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}=0\,.\label{eq290}
\end{equation}

\end_inset

In the special case of a triphasic mixture, where solutes consist of two
 counter-ions (
\begin_inset Formula $\alpha=+,-)$
\end_inset

, this equation may be solved in closed form to produce 
\begin_inset Formula 
\begin{equation}
\psi=\frac{1}{z^{\alpha}}\frac{R\theta}{F_{c}}\ln\left(\frac{2z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha}}{-c^{F}\pm\sqrt{\left(c^{F}\right)^{2}+4\left(z^{\alpha}\right)^{2}\left(\hat{\kappa}^{+}\tilde{c}^{+}\right)\left(\hat{\kappa}^{-}\tilde{c}^{-}\right)}}\right),\quad\alpha=+,-,\label{eq291}
\end{equation}

\end_inset

Only the positive root is valid in the argument of the logarithm function.
\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-du"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\mathbf{u}\right]\,dV=\left[\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}+\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}\right)\right]\,dv\,,\label{eq292}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor of the mixture, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}-\left(\tilde{p}+R\theta\,\Phi\sum\limits _{\beta}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}\right)\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-R\theta\sum\limits _{\beta}\tilde{c}^{\beta}\,J\frac{\partial\left(\Phi\tilde{\kappa}^{\beta}\right)}{\partial J}\mathbf{I}\otimes\mathbf{I}\,,\label{eq293}
\end{equation}

\end_inset

and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor of the solid matrix, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{S}^{e}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq294}
\end{equation}

\end_inset

The linearization of the second term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{u}^{\prime}\,dv\,,\label{eq295}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{u}^{\prime} & \equiv J-\left(\tilde{\boldsymbol{\mathcal{K}}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad\tilde{p}+R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\right)\\
 & -\tilde{\mathbf{k}}\cdot R\theta\sum\limits _{\beta}\left(\left[J\frac{\partial}{\partial J}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)-\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right]\left(\divg\Delta\mathbf{u}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\left(2\Delta\boldsymbol{\varepsilon}\cdot\mathbf{d}^{\beta}+\boldsymbol{\mathcal{D}}^{\beta}:\Delta\boldsymbol{\varepsilon}\right)\right)\cdot\grad\tilde{c}^{\beta}
\end{aligned}
\label{eq296}
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\boldsymbol{\mathcal{K}}} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\tilde{\mathbf{K}}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,\\
\boldsymbol{\mathcal{D}}^{\alpha} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{D}^{\alpha}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,
\end{aligned}
\label{eq297}
\end{equation}

\end_inset

representing the spatial tangents, with respect to the strain, of the effective
 permeability and solute diffusivity, respectively.
 These fourth-order tensors exhibit minor symmetries but not major symmetry,
 as described recently 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

.
 Since 
\begin_inset Formula $\tilde{\mathbf{K}}$
\end_inset

 is given by substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset


\begin_inset Formula $_{3}$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq231"

\end_inset


\begin_inset Formula $_{1}$
\end_inset

, the evaluation of 
\begin_inset Formula $\tilde{\boldsymbol{\mathcal{K}}}$
\end_inset

 is rather involved and it can be shown that 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{K}}}=2\left(\tilde{\mathbf{k}}\otimes\mathbf{I}-2\tilde{\mathbf{k}}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-\left(\tilde{\mathbf{k}}\,\underline{\otimes}\,\tilde{\mathbf{k}}\right):\boldsymbol{\mathcal{G}}\,,\label{eq298}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{G}} & =2\left(\mathbf{k}^{-1}\otimes\mathbf{I}-2\mathbf{k}^{-1}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-\left(\mathbf{k}^{-1}\,\underline{\otimes}\,\mathbf{k}^{-1}\right):\mathbf{k}\\
 & +R\theta\sum\limits _{\beta}\frac{\tilde{c}^{\beta}}{d_{0}^{\beta}}J\frac{\partial}{\partial J}\left(\frac{\tilde{\kappa}^{\beta}}{\varphi^{w}}\right)\left(\mathbf{I}-\frac{\mathbf{d}^{\beta}}{d_{0}^{\beta}}\right)\otimes\mathbf{I}\\
 & +R\theta\sum\limits _{\beta}\frac{\tilde{c}^{\beta}}{d_{0}}\frac{\tilde{\kappa}^{\beta}}{\varphi^{w}}\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\underline{\otimes}\,\mathbf{I}-\frac{1}{d_{0}^{\beta}}\boldsymbol{\mathcal{D}}^{\beta}\right)
\end{aligned}
\label{eq299}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{K}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq300}
\end{equation}

\end_inset

The next term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 linearizes to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=-\delta\tilde{p}\frac{1}{\Delta t}\divg\Delta\mathbf{u}\,dv\,,\label{eq301}
\end{equation}

\end_inset

where we used a backward difference scheme to approximate the time derivative,
 
\begin_inset Formula 
\begin{equation}
\frac{\partial J}{\partial t}\approx\frac{1}{\Delta t}\left(J-J^{-\Delta t}\right)\,,\label{eq302}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 represents the time increment relative to the previous time point.
 The next term is given by 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{j}_{u}^{\alpha\prime}\,dv\,,\label{eq303}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{u}^{\alpha\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\mathbf{u}\right]=\left(J\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\boldsymbol{\mathcal{D}}^{\alpha}:\Delta\boldsymbol{\varepsilon}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\grad\tilde{c}^{\alpha}+\left(2\Delta\boldsymbol{\varepsilon}-\left(\divg\Delta\mathbf{u}\right)\mathbf{I}\right)\cdot\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}_{u}^{\prime}\right)
\end{aligned}
\,.\label{eq304}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{g}^{\alpha}=-\varphi^{w}\grad\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\,.\label{eq305}
\end{equation}

\end_inset

Using a backward difference scheme for the time derivative, the last term
 is 
\begin_inset Formula 
\begin{equation}
D\left(\delta\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=\frac{\delta\tilde{c}^{\alpha}}{\Delta t}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\right)}{\partial J}\tilde{c}^{\alpha}\divg\Delta\mathbf{u}\,dv\,.\label{eq306}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-dp"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the various terms in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{p}\right]\,dV=-\Delta\tilde{p}\,\divg\delta\mathbf{v}\,dv\,,\label{eq307}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\grad\delta\tilde{p}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,,\label{eq308}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}-\delta\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\frac{\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{d}^{\alpha}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,.\label{eq309}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-dc"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{c}^{\gamma}\right]dV=\Delta\tilde{c}^{\gamma}\left(\boldsymbol{\sigma}_{\gamma}^{\prime}:\delta\mathbf{d}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial\tilde{c}^{\gamma}}\divg\delta\mathbf{v}\right)\,dv\,,\label{eq310}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{\gamma}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{S}^{e}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T}\label{eq311}
\end{equation}

\end_inset

represents the spatial tangent of the stress with respect to the effective
 concentration.
 The next term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{\gamma}^{\prime}\,dv\,,\label{eq312}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{\gamma}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\tilde{c}^{\gamma}\right]=-\tilde{\mathbf{k}}_{\gamma}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\right)\Delta\tilde{c}^{\gamma}\\
 & -R\theta\tilde{\mathbf{k}}\cdot\frac{\tilde{\kappa}^{\gamma}}{d_{0}^{\gamma}}\mathbf{d}^{\gamma}\cdot\grad\Delta\tilde{c}^{\gamma}-\Delta\tilde{c}^{\gamma}R\theta\tilde{\mathbf{k}}\cdot\sum\limits _{\beta}\left(\frac{\partial}{\partial\tilde{c}^{\gamma}}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}_{\gamma}^{\beta\prime}\right)\cdot\grad\tilde{c}^{\beta}
\end{aligned}
\label{eq313}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}_{\gamma}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\tilde{\mathbf{K}}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T},\quad\mathbf{d}_{\gamma}^{\beta\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{d}^{\beta}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T}\label{eq314}
\end{equation}

\end_inset

are the spatial tangents of the effective hydraulic permeability and solute
 diffusivity with respect to the effective concentration.
\end_layout

\begin_layout Standard
The next term reduces to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=0\,.\label{eq315}
\end{equation}

\end_inset

The following term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{j}_{\gamma}^{\alpha\prime}\,dv\,,\label{eq316}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{\gamma}^{\alpha\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}^{\alpha}\left[\Delta\tilde{c}^{\gamma}\right]=\Delta\tilde{c}^{\gamma}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\mathbf{d}_{\gamma}^{\alpha\prime}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\delta_{\alpha\gamma}\grad\Delta\tilde{c}^{\gamma}+\frac{\Delta\tilde{c}^{\gamma}}{d_{0}^{\alpha}}\left(\delta_{\alpha\gamma}-\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\frac{\partial d_{0}^{\alpha}}{\partial\tilde{c}^{\gamma}}\right)\mathbf{w}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}_{\gamma}^{\prime}\right)\,.
\end{aligned}
\label{eq317}
\end{equation}

\end_inset

The last term is 
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\delta\tilde{c}^{\alpha}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\delta\tilde{c}^{\alpha}\frac{\varphi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial\tilde{c}^{\gamma}}\Delta\tilde{c}^{\gamma}\,dv\,,\label{eq318}
\end{equation}

\end_inset

where we similarly used a backward difference scheme to discretize the time
 derivative.
\end_layout

\begin_layout Subsection
Linearization of External Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-external"

\end_inset


\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq289"

\end_inset

 depends on whether natural boundary conditions are prescribed as area densities
 or total net values over an area.
 Thus, in the case when 
\begin_inset Formula $\mathbf{t}\,da$
\end_inset

 (net force), 
\begin_inset Formula $w_{n}da$
\end_inset

 (net volumetric flow rate), or 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}da$
\end_inset

 (net effective molar flow rate) are prescribed over the elemental area
 
\begin_inset Formula $da$
\end_inset

, there is no variation in 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 and it follows that 
\begin_inset Formula $D\delta W_{\text{ext}}=0$
\end_inset

.
 Alternatively, in the case when 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 or 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}$
\end_inset

 are prescribed, the linearization may be performed by evaluating the integral
 in the parametric space of the boundary surface 
\begin_inset Formula $\partial b$
\end_inset

, with parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2}\right)$
\end_inset

.
 Accordingly, for a point 
\begin_inset Formula $\mathbf{x}\left(\eta^{1},\eta^{2}\right)$
\end_inset

 on 
\begin_inset Formula $\partial b$
\end_inset

, surface tangents (covariant basis vectors) are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\left(\alpha=1,2\right)\label{eq319}
\end{equation}

\end_inset

and the outward unit normal is 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq320}
\end{equation}

\end_inset

The elemental area on 
\begin_inset Formula $\partial b$
\end_inset

 is 
\begin_inset Formula $da=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}$
\end_inset

.
 Consequently, the external virtual work integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\tilde{j}_{n}^{\alpha}\right)\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}\,,\label{eq321}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}j_{n}^{\beta}\,.\label{eq322}
\end{equation}

\end_inset

The directional derivative of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 may then be applied directly to its integrand, since the parametric space
 is invariant 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
\end_layout

\begin_layout Standard
If we restrict traction boundary conditions to the special case of normal
 tractions, then 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

 where 
\begin_inset Formula $t_{n}$
\end_inset

 is the prescribed normal traction component.
 Then it can be shown that the linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{\text{ext}}\right)\left[\Delta\mathbf{u}\right]=\int_{\partial b}\left(t_{n}\delta\mathbf{v}+w_{n}\delta\tilde{p}\,\mathbf{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\tilde{j}_{n}^{\alpha}\,\mathbf{n}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)\,d\eta^{1}d\eta^{2}\,.\label{eq323}
\end{equation}

\end_inset

The linearizations along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

 reduce to zero, 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{p}\right]=0$
\end_inset

 and 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{c}^{\gamma}\right]=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-discretization"

\end_inset


\end_layout

\begin_layout Standard
To discretize the virtual work relations, let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,,\\
\delta\tilde{p} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{p}_{a}\,, & \Delta\tilde{p} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{p}_{b}\,,\\
\delta\tilde{c}^{\alpha} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{c}_{a}^{\alpha}\,, & \Delta\tilde{c}^{\gamma} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{c}_{b}^{\gamma}\,,
\end{aligned}
\label{eq324}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}_{a}^{\alpha}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}_{a}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}_{a}^{\gamma}$
\end_inset

 respectively represent the nodal values of 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}^{\alpha}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

; 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
\end_layout

\begin_layout Standard
The discretized form of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}\\
r_{a}^{\alpha}\\
r_{a}^{\beta}
\end{array}\right]\,,\label{eq325}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\text{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the current spatial configuration
 to the parametric space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\,,\\
r_{a}^{p} & =\mathbf{w}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial J}{\partial t}\,,\\
r_{a}^{\alpha} & =\mathbf{j}^{\alpha}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)\,,
\end{aligned}
\label{eq326}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

, 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{\alpha}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 Since the parametric space is invariant, time derivatives are evaluated
 in a material frame.
 For example, the time derivative 
\begin_inset Formula $D^{s}J\left(\mathbf{x},t\right)/Dt$
\end_inset

 appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 becomes 
\begin_inset Formula $\partial J\left(\eta_{k},t\right)/\partial t$
\end_inset

 when evaluated at the parametric coordinates 
\begin_inset Formula $\eta_{k}=\left(\eta_{k}^{1},\eta_{k}^{2},\eta_{k}^{3}\right)$
\end_inset

 of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 All time derivatives are discretized using a backward difference scheme.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\text{int}}=D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{p}\right]+\sum\nolimits _{\gamma}D\delta W_{\text{int}}\left[\Delta\tilde{c}^{\gamma}\right]$
\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{cccc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up} & \mathbf{k}_{ab}^{u\alpha} & \mathbf{k}_{ab}^{u\beta}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp} & k_{ab}^{p\alpha} & k_{ab}^{p\beta}\\
\mathbf{k}_{ab}^{\alpha u} & k_{ab}^{\alpha p} & k_{ab}^{\alpha\alpha} & k_{ab}^{\alpha\beta}\\
\mathbf{k}_{ab}^{\beta u} & k_{ab}^{\beta p} & k_{ab}^{\beta\alpha} & k_{ab}^{\beta\beta}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}^{\alpha}\\
\Delta\tilde{c}_{b}^{\beta}
\end{array}\right]\,,\label{eq327}
\end{equation}

\end_inset

where the terms in the first column are the discretized form of the linearizatio
n along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uu}=\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}+\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}\,,\label{eq328}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{pu}=\left(\mathbf{w}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{pu}\,,\label{eq329}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{\alpha u}=\left(\mathbf{j}_{b}^{\alpha u}+\sum\nolimits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{\alpha u}\,,\label{eq330}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{\alpha u} & =J\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J}\mathbf{d}^{\alpha}\cdot\mathbf{g}^{\alpha}\otimes\grad N_{b}+\tilde{\kappa}^{\alpha}\mathbf{g}^{\alpha}\cdot\mathbf{d}^{\alpha}\cdot\grad N_{b}\\
 & +\tilde{\kappa}^{\alpha}\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\cdot\tilde{c}^{\alpha}\left(\grad N_{b}\otimes\mathbf{w}-\mathbf{w}\otimes\grad N_{b}+\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}+\mathbf{w}_{b}^{u}\right)\\
 & -\varphi^{s}\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\grad\tilde{c}^{\alpha}\otimes\grad N_{b}\,,
\end{aligned}
\label{eq331}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{pu}=-\frac{1}{\Delta t}\grad N_{b}\,,\label{eq332}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{\alpha u}=\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\right)}{\partial J}\mathbf{q}_{b}^{pu}\,.\label{eq333}
\end{equation}

\end_inset

The terms in the second column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{up}=-N_{b}\grad N_{a}\,,\label{eq334}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=-\grad N_{a}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}\,,\label{eq335}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{\alpha p}=\grad N_{a}\cdot\left(\mathbf{j}_{b}^{\alpha p}+\sum\limits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta p}\right)\,,\label{eq336}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{j}_{b}^{\alpha p}=-\frac{\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}\,.\label{eq337}
\end{equation}

\end_inset

The terms in the third column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{u\alpha}=N_{b}\left(\boldsymbol{\sigma}_{\alpha}^{\prime}-R\theta\left[\Phi\tilde{\kappa}^{\alpha}+\sum\limits _{\beta}\left(\frac{\partial\Phi}{\partial\tilde{c}^{\alpha}}\tilde{\kappa}^{\beta}+\Phi\frac{\partial\tilde{\kappa}^{\beta}}{\partial\tilde{c}^{\alpha}}\right)\tilde{c}^{\beta}\right]\mathbf{I}\right)\cdot\grad N_{a}\,,\label{eq338}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{p\alpha}=\grad N_{a}\cdot\mathbf{w}_{b}^{\alpha}\,,\label{eq339}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{\alpha\gamma}=\grad N_{a}\cdot\left(\mathbf{j}_{b}^{\alpha\gamma}+\sum\limits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta\gamma}\right)+N_{a}q_{b}^{\alpha\gamma}\,,\label{eq340}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{b}^{\gamma} & =N_{b}\left(\tilde{\mathbf{k}}_{\gamma}^{\prime}\cdot\mathbf{g}^{p}-R\theta\tilde{\mathbf{k}}\cdot\sum\limits _{\beta}\left(\frac{\partial}{\partial\tilde{c}^{\gamma}}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}_{c}^{\beta\gamma}\right)\cdot\grad\tilde{c}^{\beta}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\frac{\tilde{\kappa}^{\gamma}}{d_{0}^{\gamma}}\mathbf{d}^{\gamma}\cdot\grad N_{b}\,,
\end{aligned}
\label{eq341}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{\alpha\gamma} & =N_{b}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\mathbf{d}_{c}^{\alpha\gamma}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\frac{\tilde{\kappa}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\left[\delta_{\alpha\gamma}\left(N_{b}\mathbf{w}-\varphi^{w}d_{0}^{\alpha}\grad N_{b}\right)+\tilde{c}^{\alpha}\left(\mathbf{w}_{b}^{\gamma}-\frac{N_{b}}{d_{0}^{\alpha}}\frac{\partial d_{0}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{w}\right)\right]\,,
\end{aligned}
\label{eq342}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
q_{b}^{\alpha\gamma}=-N_{b}\frac{\varphi^{w}}{\Delta t}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\tilde{c}^{\alpha}+\delta_{\alpha\gamma}\tilde{\kappa}^{\alpha}\right)\,,\label{eq343}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{g}^{p}=-\grad\tilde{p}-R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\,.\label{eq344}
\end{equation}

\end_inset

The discretization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq321"

\end_inset


\series bold
 
\series default
has the form 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{c}
N_{a}t_{n}\mathbf{n}\\
N_{a}w_{n}\\
N_{a}\tilde{j}_{n}^{\alpha}\\
N_{a}\tilde{j}_{n}^{\beta}
\end{array}\right]\,,\label{eq345}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|$
\end_inset

.
 The summation is performed over all surface elements on which these boundary
 conditions are prescribed.
 The discretization of 
\begin_inset Formula $-D\delta W_{\text{ext}}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{cccc}
\mathbf{K}_{ab}^{uu} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ab}^{pu} & 0 & 0 & 0\\
\mathbf{k}_{ab}^{\alpha u} & 0 & 0 & 0\\
\mathbf{k}_{ab}^{\beta u} & 0 & 0 & 0
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}^{\alpha}\\
\Delta\tilde{c}_{b}^{\beta}
\end{array}\right]\,,\label{eq346}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,,\\
\mathbf{k}_{ab}^{pu} & =-w_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n},\\
\mathbf{k}_{ab}^{\alpha u} & =-\tilde{j}_{n}^{\alpha}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}.
\end{aligned}
\label{eq347}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} $
\end_inset

 is the antisymmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 (such that 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} \cdot\mathbf{q}=\mathbf{v}\times\mathbf{q}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{q})$
\end_inset

.
\end_layout

\begin_layout Subsection
Electric Potential and Partition Coefficient Derivatives
\begin_inset CommandInset label
LatexCommand label
name "subsec:Potential-partition-derivatives"

\end_inset


\end_layout

\begin_layout Standard
When the mixture is charged it is necessary to solve for the electric potential
 
\begin_inset Formula $\psi$
\end_inset

 using the electroneutrality condition in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

.
 This equation may be rewritted as a polynomial in 
\begin_inset Formula $\zeta$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{i=0}^{n}a_{i}\zeta^{i}\,,\label{eq348}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\zeta=\exp\left(-\frac{F_{c}\psi}{R\theta}\right)\,,\label{eq349}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
a_{i}=\begin{cases}
z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha} & i=z^{\alpha}-z^{\min}\\
c^{F} & i=-z^{\min}
\end{cases}\,.\label{eq350}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $z^{\min}=\min_{\alpha}z^{\alpha}$
\end_inset

 and the polynomial degress is 
\begin_inset Formula $n=z^{\max}-z^{\min}$
\end_inset

 where 
\begin_inset Formula $z^{\max}=\max_{\alpha}z^{\alpha}$
\end_inset

.
 Since more than one solute may carry the same charge 
\begin_inset Formula $z^{\alpha}$
\end_inset

, the coefficients 
\begin_inset Formula $a_{i}$
\end_inset

 should be evaluated from the summation of 
\begin_inset Formula $z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha}$
\end_inset

 over all such solutes.
 Only real positive roots are valid, since 
\begin_inset Formula $\psi=-R\theta\left(\ln\zeta\right)/F_{c}$
\end_inset

 according to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq349"

\end_inset

.
 Using Descartes' rule of signs, an inspection of the coefficients 
\begin_inset Formula $a_{i}$
\end_inset

 shows tht there is only one sign change in the polynomial, regardless of
 the sign of 
\begin_inset Formula $c^{F}$
\end_inset

, implying that there will always be only one positive root 
\begin_inset Formula $\zeta$
\end_inset

, which must thus be real.
 Therefore, there cannot be any ambiguity in the calculation of 
\begin_inset Formula $\psi$
\end_inset

, irrespective of the polynomial degree.
 Newton's method is used to solve for the positive real root when 
\begin_inset Formula $n>2$
\end_inset

.
\end_layout

\begin_layout Standard
Using the above relations, it follows that 
\begin_inset Formula $\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\zeta^{z^{\alpha}}$
\end_inset

.
 An examination of the equations resulting from the linearization of the
 internal virtual work shows that it is necessary to evaluate derivatives
 of 
\begin_inset Formula $\tilde{\kappa}^{\alpha}$
\end_inset

 with respect to 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\gamma}$
\end_inset

, which are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J} & =\frac{\partial\hat{\kappa}^{\alpha}}{\partial J}\zeta^{z^{\alpha}}+z^{\alpha}\tilde{\kappa}^{\alpha}\frac{1}{\zeta}\frac{\partial\zeta}{\partial J}\\
\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}} & =\frac{\partial\hat{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\zeta^{z^{\alpha}}+z^{\alpha}\tilde{\kappa}^{\alpha}\frac{1}{\zeta}\frac{\partial\zeta}{\partial\tilde{c}^{\gamma}}
\end{aligned}
\,.\label{eq351}
\end{equation}

\end_inset

In these expressions, the derivatives of 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

 are obtained from the user-defined constitutive relations for the solubility.
 Derivatives of 
\begin_inset Formula $\zeta$
\end_inset

 may be evaluated by differentiating the electroneutrality condition to
 produce 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{1}{\zeta}\frac{\partial\zeta}{\partial J} & =-\frac{\frac{\partial c^{F}}{\partial J}+\sum\nolimits _{\beta}z^{\beta}\zeta^{z^{\beta}}\tilde{c}^{\beta}\frac{\partial\hat{\kappa}^{\beta}}{\partial J}}{\sum\nolimits _{\beta}\left(z^{\beta}\right)^{2}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}}\\
\frac{1}{\zeta}\frac{\partial\zeta}{\partial\tilde{c}^{\gamma}} & =-\frac{z^{\gamma}\tilde{\kappa}^{\gamma}+\sum\nolimits _{\beta}z^{\beta}\zeta^{z^{\beta}}\tilde{c}^{\beta}\frac{\partial\hat{\kappa}^{\beta}}{\partial\tilde{c}^{\gamma}}}{\sum\nolimits _{\beta}\left(z^{\beta}\right)^{2}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}}
\end{aligned}
\,.\label{eq352}
\end{equation}

\end_inset

The derivative 
\begin_inset Formula $\partial c^{F}/\partial J$
\end_inset

 may be evaluated from 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\,,\label{eq353}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction (volume of solid in current configurat
ion per volume of the mixture in the reference configuration) and 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 is the referential fixed charge density (equivalent charge in current configura
tion per volume of the mixture in the reference configuration).
\end_layout

\begin_layout Subsection
Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-chemical-reactions"

\end_inset


\end_layout

\begin_layout Subsubsection
Virtual Work and Linearization
\end_layout

\begin_layout Standard
The contribution to 
\begin_inset Formula $\delta W$
\end_inset

 due to chemical reactions is given by 
\begin_inset Formula $\delta G$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\delta G=\int_{b}\delta\tilde{p}\left[\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\right]\,dv+\sum\limits _{\iota}\nu^{\iota}\int_{b}\delta\tilde{c}^{\iota}\left(1-\varphi^{s}\right)\hat{\zeta}\,dv\,.\label{eq354}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 along a solid displacement increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\tilde{p}\,\left(\hat{\varphi}^{w}\,\divg\Delta\mathbf{u}+\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}:\Delta\boldsymbol{\varepsilon}\right)\,dv\\
 & +\overline{\mathcal{V}}\int_{b}\delta\tilde{p}\left[\hat{\zeta}\,\divg\Delta\mathbf{u}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}:\Delta\boldsymbol{\varepsilon}\right]\,dv\\
 & +\sum_{\iota}\nu^{\iota}\int_{b}\delta\tilde{c}^{\iota}\left[\hat{\zeta}\,\divg\Delta\mathbf{u}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}:\Delta\boldsymbol{\varepsilon}\right]\,dv
\end{aligned}
\,,\label{eq354b}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}=\mathbf{F}\cdot\frac{\partial\hat{\varphi}^{w}}{\partial\mathbf{E}}\cdot\mathbf{F}^{T}\,,\quad\hat{\boldsymbol{\zeta}}_{\varepsilon}=J^{-1}\mathbf{F}\cdot\frac{\partial\hat{\zeta}}{\partial\mathbf{E}}\cdot\mathbf{F}^{T}\,.\label{eq354c}
\end{equation}

\end_inset

Currently, 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 is assumed to be independent of 
\begin_inset Formula $\tilde{p}$
\end_inset

 in FEBio; it follows that the linearization along the effective fluid pressure
 increment 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\tilde{p}\right]=\int_{b}\delta\tilde{p}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{p}}\Delta p\,dv\,.\label{eq354d}
\end{equation}

\end_inset

Finally, the linearization along a concentration increment 
\begin_inset Formula $\Delta\tilde{c}^{\iota}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\tilde{c}^{\iota}\right] & =\int_{b}\delta\tilde{p}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{c}^{\iota}}\Delta\tilde{c}^{\iota}\,dv\\
 & +\overline{\mathcal{V}}\int_{b}\delta\tilde{p}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\Delta\tilde{c}^{\iota}\,dv\\
 & +\sum_{\gamma}\nu^{\gamma}\int_{b}\delta\tilde{c}^{\gamma}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\Delta\tilde{c}^{\iota}\,dv
\end{aligned}
\,.\label{eq354e}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretized form of these expressions is given by
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\tilde{p}_{a}r_{a}^{p}+\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}r_{a}^{\gamma}\,,\label{eq354f}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}r_{a}^{p} & =\int_{b}N_{a}\,\left[\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\bar{\mathcal{V}}\right]\,dv\\
r_{a}^{\gamma} & =\nu^{\gamma}\int_{b}N_{a}\left(1-\varphi^{s}\right)\hat{\zeta}\,dv
\end{aligned}
\,.\label{eq354g}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\mathbf{u}\right] & =\sum_{a}\delta\tilde{p}_{a}\sum_{b}\mathbf{k}_{ab}^{pu}\cdot\Delta\mathbf{u}_{b}\\
 & +\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}\sum_{b}\mathbf{k}_{ab}^{\gamma u}\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\,,\label{eq354h}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{pu} & =\int_{b}N_{a}\left(\hat{\varphi}^{w}\mathbf{I}+\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}\right)\cdot\grad N_{b}\,dv\\
 & +\bar{\mathcal{V}}\int_{a}N_{a}\left[\hat{\zeta}\mathbf{I}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}\right]\cdot\grad N_{b}\,dv\\
\mathbf{k}_{ab}^{\gamma u} & =\nu^{\gamma}\int_{a}N_{a}\left[\hat{\zeta}\mathbf{I}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}\right]\cdot\grad N_{b}\,dv
\end{aligned}
\,.\label{eq354i}
\end{equation}

\end_inset

Then,
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\tilde{p}\right]=\sum_{a}\delta\tilde{p}_{a}\sum_{b}k_{ab}^{pp}\Delta\tilde{p}_{b}\,,\label{eq354j}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=\int_{b}N_{a}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{p}}N_{b}\,dv\,.\label{eq354k}
\end{equation}

\end_inset

Finally,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\tilde{c}^{\iota}\right] & =\sum_{a}\delta\tilde{p}_{a}\sum_{b}k_{ab}^{p\iota}\Delta\tilde{c}_{b}^{\iota}\\
 & +\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}\sum_{b}k_{ab}^{\gamma\iota}\Delta\tilde{c}_{b}^{\iota}
\end{aligned}
\,,\label{eq354l}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ab}^{p\iota} & =\int_{b}N_{a}N_{b}\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{c}^{\iota}}\,dv+\bar{\mathcal{V}}\int_{b}N_{a}N_{b}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\,dv\\
k_{ab}^{\gamma\iota} & =\nu^{\gamma}\int_{b}N_{a}N_{b}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\,dv
\end{aligned}
\,.\label{eq354m}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Updating Solid-Bound Molecule Concentrations
\end_layout

\begin_layout Standard
The solid-bound molecule concentrations 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 are evaluated at integration points of each element; they do not represent
 nodal degrees of freedom.
 The values of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 are updated at the end of each iteration in the solution of the nonlinear
 equations for the nodal degrees of freedom, using trapezoidal integration
 on 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq155"

\end_inset

.
 According to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq164"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

, we have 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}=\left(J-\varphi_{r}^{s}\right)M^{\sigma}\nu^{\sigma}\hat{\zeta}$
\end_inset

, which is evaluated as the average of values at 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

, then
\begin_inset Formula 
\begin{equation}
\left(\rho_{r}^{\sigma}\right)_{n+1}=\left(\rho_{r}^{\sigma}\right)_{n}+\left(\hat{\rho}_{r}^{\sigma}\right)_{n+\frac{1}{2}}\Delta t\label{eq:sbm-incremental-eq}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

.
\end_layout

\begin_layout Section
Computational Fluid Dynamics
\begin_inset CommandInset label
LatexCommand label
name "sec:Computational-Fluid-Dynamics"

\end_inset


\end_layout

\begin_layout Standard
A more detailed description of the FEBio fluid solver can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"

\end_inset

.
\end_layout

\begin_layout Subsection
Weak Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Weak-Formulation"

\end_inset


\end_layout

\begin_layout Standard
The nodal unknowns in this formulation are 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 (or 
\begin_inset Formula $e$
\end_inset

), which may be solved using the momentum balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:momentum-balance"

\end_inset

 and the kinematic constraint between 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

.
 The virtual work integral for a Galerkin finite element formulation 
\begin_inset CommandInset citation
LatexCommand cite
key "Bonet97"

\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{\Omega}\delta\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)dv\\
 & +\int_{\Omega}\delta J\left(\frac{\dot{J}}{J}-\divg\mathbf{v}\right)dv\,,
\end{aligned}
\label{eq:virtual work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is a virtual velocity and 
\begin_inset Formula $\delta J$
\end_inset

 is a virtual energy density; 
\begin_inset Formula $\Omega$
\end_inset

 is the fluid finite element domain and 
\begin_inset Formula $dv$
\end_inset

 is a differential volume in 
\begin_inset Formula $\Omega$
\end_inset

.
 This virtual work statement may be directly related to the axiom of energy
 balance, specialized to conditions of isothermal flow of viscous compressible
 fluids (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Energy-Balance"

\end_inset

).
 Using the divergence theorem, we may rewrite the weak form of this integral
 as the difference between external and internal virtual work, 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{\Omega}\boldsymbol{\tau}:\grad\delta\mathbf{v}\,dv+\int_{\Omega}\delta\mathbf{v}\cdot\left(\grad p+\rho\mathbf{a}\right)\,dv\\
 & -\int_{\Omega}\left(\delta J\frac{\dot{J}}{J}+\grad\delta J\cdot\mathbf{v}\right)\,dv\,,
\end{aligned}
\label{eq:virtual-work-internal-1}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{t}^{\tau}\,da+\int_{\Omega}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv-\int_{\partial\Omega}\delta J\,v_{n}\,da\,.\label{eq:virtual-work-external-1}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\partial\Omega$
\end_inset

 is the boundary of 
\begin_inset Formula $\Omega$
\end_inset

 and 
\begin_inset Formula $da$
\end_inset

 is a differential area on 
\begin_inset Formula $\partial\Omega$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the viscous component of the traction 
\begin_inset Formula $\mathbf{t}$
\end_inset

, and 
\begin_inset Formula $v_{n}=\mathbf{v}\cdot\mathbf{n}$
\end_inset

 is the velocity normal to the boundary 
\begin_inset Formula $\partial\Omega$
\end_inset

, with 
\begin_inset Formula $\mathbf{n}$
\end_inset

 representing the outward normal on 
\begin_inset Formula $\partial\Omega$
\end_inset

.
 From these expressions, it becomes evident that essential (Dirichlet) boundary
 conditions may be prescribed on 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

, while natural (Neumann) boundary conditions may be prescribed on 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $v_{n}$
\end_inset

.
 The appearance of velocity in both essential and natural boundary conditions
 may seem surprising at first.
 To better understand the nature of these boundary conditions, it is convenient
 to separate the velocity into its normal and tangential components, 
\begin_inset Formula $\mathbf{v}=v_{n}\mathbf{n}+\mathbf{v}_{t}$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}_{t}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{v}$
\end_inset

.
 In particular, for inviscid flow, the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 and its corresponding traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 are both zero, leaving 
\begin_inset Formula $v_{n}$
\end_inset

 as the sole natural boundary condition; similarly, 
\begin_inset Formula $J$
\end_inset

 becomes the only essential boundary condition in such flows, since 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 is unknown 
\emph on
a priori
\emph default
 on a frictionless boundary and must be obtained from the solution of the
 analysis.
 
\end_layout

\begin_layout Standard
In general, prescribing 
\begin_inset Formula $J$
\end_inset

 is equivalent to prescribing the elastic fluid pressure, since 
\begin_inset Formula $p$
\end_inset

 is only a function of 
\begin_inset Formula $J$
\end_inset

.
 On a boundary where no conditions are prescribed explicitly, we conclude
 that 
\begin_inset Formula $v_{n}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, which represents a frictionless wall.
 Conversely, it is possible to prescribe 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 on a boundary to produce a desired inflow or outflow while simultaneously
 stabilizing the flow conditions by prescribing a suitable viscous traction.
 Prescribing essential boundary conditions 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 determines the tangential velocity on a boundary as well as the elastic
 fluid pressure 
\begin_inset Formula $p$
\end_inset

, leaving the option to also prescribe the normal component of the viscous
 traction, 
\begin_inset Formula $t_{n}^{\tau}=\mathbf{t}^{\tau}\cdot\mathbf{n}$
\end_inset

, to completely determine the normal traction 
\begin_inset Formula $t_{n}=\mathbf{t}\cdot\mathbf{n}$
\end_inset

 (or else 
\begin_inset Formula $t_{n}^{\tau}$
\end_inset

 naturally equals zero).
 Mixed boundary conditions represent common physical features: Prescribing
 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 completely determines the velocity 
\begin_inset Formula $\mathbf{v}$
\end_inset

 on a boundary; prescribing 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 completely determines the traction 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 on a boundary.
 Note that 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 are mutually exclusive boundary conditions, and the same holds for 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 and the tangential component of the viscous traction, 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{t}^{\tau}$
\end_inset

.
\end_layout

\begin_layout Subsection
Temporal Discretization and Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Discretization-Linearization"

\end_inset


\end_layout

\begin_layout Standard
The time derivatives, 
\begin_inset Formula $\partial\mathbf{v}/\partial t$
\end_inset

 which appears in the expression for 
\begin_inset Formula $\mathbf{a}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:acceleration"

\end_inset

, and 
\begin_inset Formula $\partial J/\partial t$
\end_inset

 which similarly appears in 
\begin_inset Formula $\dot{J}$
\end_inset

, may be discretized upon the choice of a time integration scheme, such
 as the generalized-
\begin_inset Formula $\alpha$
\end_inset

 method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"

\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"

\end_inset

).
 The solution of the nonlinear equation 
\begin_inset Formula $\delta W=0$
\end_inset

 is obtained by linearizing this relation as
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{v}\right]+D\delta W\left[\Delta J\right]\approx0\,,\label{eq:linearized-virtual-work}
\end{equation}

\end_inset

where the operator 
\begin_inset Formula $D\delta W\left[\cdot\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $\delta W$
\end_inset

 at 
\begin_inset Formula $\left(\mathbf{v},J\right)$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 of 
\begin_inset Formula $\mathbf{v}$
\end_inset

, or 
\begin_inset Formula $\Delta J$
\end_inset

 of 
\begin_inset Formula $J$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Bonet97"

\end_inset

.
 Using the split form of 
\begin_inset Formula $\delta W$
\end_inset

 between external and internal work contributions, this relation may be
 expanded as
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\delta W_{int}\left[\Delta\mathbf{v}\right]+D\delta W_{int}\left[\Delta J\right]-D\delta W_{ext}\left[\Delta\mathbf{v}\right]\\
 & -D\delta W_{ext}\left[\Delta J\right]\approx\delta W_{ext}-\delta W_{int}\,.
\end{aligned}
\label{eq:linearized-work-split}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In this framework the finite element mesh is defined on the spatial domain
 
\begin_inset Formula $\Omega$
\end_inset

, which is fixed (time-invariant) in conventional CFD treatments.
 Thus, we can linearize 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 in the velocity and 
\begin_inset Formula $\Delta J$
\end_inset

 in the volume ratio, by simply bringing the directional derivative operator
 into the integrals of eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-internal-1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-external-1"

\end_inset

.
 The linearization of 
\begin_inset Formula $\partial\mathbf{v}/\partial t$
\end_inset

 and 
\begin_inset Formula $\partial J/\partial t$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\mathbf{v}}{dt}\right)\left[\Delta\mathbf{v}\right]=\xi\frac{\Delta\mathbf{v}}{\Delta t}\,,\label{eq:discretized-a}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial J}{\partial t}\right)\left[\Delta\mathbf{v}\right]=\xi\frac{\Delta J}{\Delta t}\,.\label{eq:discretized-J}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\Delta t$
\end_inset

 is the current time increment and 
\begin_inset Formula $\xi$
\end_inset

 is a parameter chosen as described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"

\end_inset

; for example, 
\begin_inset Formula $\xi=1$
\end_inset

 yields the backward Euler scheme, in which case 
\begin_inset Formula $\partial\mathbf{v}/\partial t\approx\left(\mathbf{v}-\mathbf{v}^{-\Delta t}\right)/\Delta t$
\end_inset

 and 
\begin_inset Formula $\partial J/\partial t\approx\left(J-J^{-\Delta t}\right)/\Delta t$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{-\Delta t}$
\end_inset

 and 
\begin_inset Formula $J^{-\Delta t}$
\end_inset

 are the velocity and volume ratio, respectively, at the previous time 
\begin_inset Formula $t-\Delta t$
\end_inset

.
 More generally, 
\begin_inset Formula $\xi$
\end_inset

 is evaluated from the spectral radius for an infinite time step, 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"

\end_inset

).
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 is then
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{v}\right] & =\int_{\Omega}\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}^{\tau}:\grad\Delta\mathbf{v}\,dv\\
 & +\int_{\Omega}\delta\mathbf{v}\cdot\rho\left(\left(\frac{\xi\mathbf{I}}{\Delta t}+\mathbf{L}\right)\cdot\Delta\mathbf{v}+\grad\Delta\mathbf{v}\cdot\mathbf{v}\right)\,dv\\
 & -\int_{\Omega}\left(\frac{\delta J}{J}\grad J+\grad\delta J\right)\cdot\Delta\mathbf{v}\,dv
\end{aligned}
\label{eq:Wint-linearization-v}
\end{equation}

\end_inset

where we have introduced the fourth-order tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 representing the tangent of the viscous stress with respect to the rate
 of deformation, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{\tau}=\frac{\partial\boldsymbol{\tau}}{\partial\mathbf{D}}\,.\label{eq:stress-tangent-D}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 exhibits minor symmetries because of the symmetries of 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

; in Cartesian components, we have 
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}=\mathcal{C}_{jikl}^{\tau}$
\end_inset

 and 
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}=\mathcal{C}_{ijlk}^{\tau}$
\end_inset

.
 In general, 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 does not exhibit major symmetry (
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}\ne\mathcal{C}_{klij}^{\tau}$
\end_inset

), though the common constitutive relations adopted in fluid mechanics produce
 such symmetry as shown below.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta J$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta J\right] & =\int_{b}\Delta J\,\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{v}\,dv-\int_{\Omega}\delta\mathbf{v}\cdot\Delta J\frac{\rho}{J}\mathbf{a}\,dv\\
 & +\int_{\Omega}\delta\mathbf{v}\cdot\left(p^{\prime}\grad\Delta J+\Delta J\,p^{\prime\prime}\grad J\right)\,dv\\
 & -\int_{\Omega}\frac{\delta J}{J}\left(\left(\frac{\xi}{\Delta t}-\frac{\dot{J}}{J}\right)\Delta J+\grad\Delta J\cdot\mathbf{v}\right)\,dv
\end{aligned}
\label{eq:Wint-linearization-J}
\end{equation}

\end_inset

where we have used 
\begin_inset Formula $DJ\left[\Delta J\right]=\Delta J$
\end_inset

; 
\begin_inset Formula $p^{\prime}$
\end_inset

 and 
\begin_inset Formula $p^{\prime\prime}$
\end_inset

 respectively represent the first and second derivatives of 
\begin_inset Formula $p\left(J\right)$
\end_inset

.
 We have also defined 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}$
\end_inset

 as the tangent of the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 with respect to 
\begin_inset Formula $J$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{J}^{\prime}=\frac{\partial\boldsymbol{\tau}}{\partial J}\,.\label{eq:stress-tangent-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work, when 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

, 
\begin_inset Formula $\mathbf{b}$
\end_inset

 and 
\begin_inset Formula $v_{n}$
\end_inset

 are prescribed, these linearizations simplify to
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta\mathbf{v}\right]=0\,,\label{eq:Wext-linearization-v}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta J\right]=-\int_{b}\delta\mathbf{v}\cdot\Delta J\,\frac{\rho}{J}\mathbf{b}\,dv\,.\label{eq:Wext-linearization-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We may define the fluid dilatation 
\begin_inset Formula $e=J-1$
\end_inset

 as an alternative essential variable, since initial and boundary conditions
 
\begin_inset Formula $e=0$
\end_inset

 are more convenient to handle in a numerical scheme than 
\begin_inset Formula $J=1$
\end_inset

.
 It follows that 
\begin_inset Formula $\grad J=\grad e$
\end_inset

 and 
\begin_inset Formula $\partial J/\partial t=\partial e/\partial t$
\end_inset

.
 Therefore the changes to the above equations are minimal, simply requiring
 the substitution 
\begin_inset Formula $J=1+e$
\end_inset

 and 
\begin_inset Formula $\Delta J=\Delta e$
\end_inset

.
 Steady-state analyses may be obtained by setting the terms involving 
\begin_inset Formula $\Delta t^{-1}$
\end_inset

 to zero in eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-a"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-J"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-v"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

.
\end_layout

\begin_layout Subsection
Spatial Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Spatial-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The velocity 
\begin_inset Formula $\mathbf{v}\left(\mathbf{x},t\right)$
\end_inset

 and Jacobian 
\begin_inset Formula $J\left(\mathbf{x},t\right)$
\end_inset

 are spatially interpolated over the domain 
\begin_inset Formula $\Omega$
\end_inset

 using the same interpolation functions 
\begin_inset Formula $N_{a}\left(\mathbf{x}\right)$
\end_inset

, with 
\begin_inset Formula $a=1$
\end_inset

 to 
\begin_inset Formula $n$
\end_inset

 where 
\begin_inset Formula $n$
\end_inset

 is the number of nodes in an element),
\begin_inset Formula 
\begin{equation}
\mathbf{v}\left(\mathbf{x},t\right)=\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)\mathbf{v}_{a}\,,\quad J\left(\mathbf{x},t\right)=\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)J_{a}\,.\label{eq:v-J-interpolation}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{v}_{a}$
\end_inset

 and 
\begin_inset Formula $J_{a}$
\end_inset

 are nodal values of 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 that evolve with time.
 In contrast to classical mixed formulations for incompressible flow 
\begin_inset CommandInset citation
LatexCommand cite
key "Reddy01"

\end_inset

, which solve for the pressure 
\begin_inset Formula $p$
\end_inset

 using 
\begin_inset Formula $\divg\mathbf{v}=0$
\end_inset

 instead of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

, equal order interpolation is acceptable in this formulation since the
 governing equations for 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 involve spatial derivatives of both variables (
\begin_inset Formula $\grad\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\grad J$
\end_inset

).
 The expressions of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:v-J-interpolation"

\end_inset

 may be used to evaluate 
\begin_inset Formula $\mathbf{L}$
\end_inset

, 
\begin_inset Formula $\divg\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\mathbf{a}$
\end_inset

, 
\begin_inset Formula $\grad J$
\end_inset

, 
\begin_inset Formula $\dot{J}$
\end_inset

, etc.
 Similar interpolations are used for virtual increments 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\delta J$
\end_inset

, as well as real increments 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\Delta J$
\end_inset

.
\end_layout

\begin_layout Standard
When substituted into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-internal"

\end_inset

, we find that the discretized form of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 may be written as
\begin_inset Formula 
\begin{equation}
\delta W_{int}=\sum_{a}\delta\mathbf{v}_{a}\cdot\left(\mathbf{f}_{a}^{\sigma}+\mathbf{f}_{a}^{\rho}\right)+f_{a}^{J}\delta J_{a}\,,\label{eq:discretized-Wint}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\sigma} & =\int_{\Omega}\left(\boldsymbol{\tau}\cdot\grad N_{a}+N_{a}\grad p\right)\,dv\,,\\
\mathbf{f}_{a}^{\rho} & =\int_{\Omega}N_{a}\rho\mathbf{a}\,dv\,,\\
f_{a}^{J} & =\int_{\Omega}-\left(N_{a}\frac{\dot{J}}{J}+\grad N_{a}\cdot\mathbf{v}\right)\,dv\,.
\end{aligned}
\label{eq:discretized-internal-forces}
\end{equation}

\end_inset

Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{int}\left[\Delta\mathbf{v}\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-v"

\end_inset

 becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{v}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\left(\mathbf{K}_{ab}^{vv}+\mathbf{M}_{ab}^{vv}\right)\cdot\Delta\mathbf{v}_{b}\\
 & +\sum_{a}\delta J_{a}\sum_{b}\mathbf{k}_{ab}^{Jv}\cdot\Delta\mathbf{v}_{b}\,,
\end{aligned}
\label{eq:discretized-DWint-v}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{vv} & =\int_{\Omega}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{v}\cdot\grad N_{b}\,dv\,,\\
\mathbf{M}_{ab}^{vv} & =\int_{\Omega}N_{a}\rho\left(N_{b}\left(\frac{\xi}{\Delta t}\mathbf{I}+\grad\mathbf{v}\right)+\left(\grad N_{b}\cdot\mathbf{v}\right)\mathbf{I}\right)\,dv\,,\\
\mathbf{k}_{ab}^{Jv} & =\int_{\Omega}-\left(\frac{N_{a}}{J}\grad J+\grad N_{a}\right)N_{b}\,dv\,,
\end{aligned}
\label{eq:discretized-stiffness-v}
\end{equation}

\end_inset

whereas that of 
\begin_inset Formula $D\delta W_{int}\left[\Delta J\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

 becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta J\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\left(\mathbf{k}_{ab}^{vJ}+\mathbf{m}_{ab}^{vJ}\right)\,\Delta J_{b}\\
 & +\sum_{a}\delta J_{a}\sum_{b}k_{ab}^{JJ}\,\Delta J_{b}
\end{aligned}
\label{eq:discretized-DWint-J}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{vJ} & =\int_{\Omega}\left[N_{b}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}+N_{a}\left(p^{\prime}\grad N_{b}+N_{b}p^{\prime\prime}\grad J\right)\right]\,dv\,,\\
\mathbf{m}_{ab}^{vJ} & =\int_{\Omega}-N_{a}N_{b}\frac{\rho}{J}\mathbf{a}\,dv\,,\\
k_{ab}^{JJ} & =\int_{\Omega}-\frac{N_{a}}{J}\left(\left(\frac{\xi}{\Delta t}-\frac{\dot{J}}{J}\right)N_{b}+\grad N_{b}\cdot\mathbf{v}\right)\,dv\,.
\end{aligned}
\label{eq:discretized-stiffness-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-external"

\end_inset

, its discretized form is
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\sum_{a}\delta\mathbf{v}_{a}\cdot\left(\mathbf{f}_{a}^{\text{t}}+\mathbf{f}_{a}^{\text{b}}\right)+\delta J_{a}f_{a}^{v}\,,\label{eq:discretized-Wext}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\text{t}} & =\int_{\partial\Omega}N_{a}\mathbf{t}^{\tau}\,da\,,\\
\mathbf{f}_{a}^{\text{b}} & =\int_{\Omega}N_{a}\rho\mathbf{b}\,dv\,,\\
f_{a}^{v} & =\int_{\Omega}-N_{a}v_{n}\,da\,.
\end{aligned}
\label{eq:discretized-external-forces}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $D\left(\delta W_{ext}\right)\left[\Delta J\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wext-linearization-J"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta J\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{\text{b}}\,\Delta J_{b}\,,\label{eq:discretized-DWext-J}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{\text{b}}=\int_{\Omega}-N_{a}N_{b}\frac{\rho}{J}\mathbf{b}\,dv\,.\label{eq:discretized-stiffness-ext}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Special Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Special-Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Subsubsection
Backflow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Backflow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
For arterial blood flow, backflow stabilization has been proposed previously
 to deal with truncated domains where the entire artery is not modeled explicitl
y 
\begin_inset CommandInset citation
LatexCommand cite
key "Bazilevs09,Esmaily-Moghadam11"

\end_inset

; for these types of problems, letting 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

 or prescribing a constant pressure at the outflow boundary may not prevent
 flow reversals that compromise convergence of an analysis.
 Instead, these authors proposed a velocity-dependent traction boundary
 condition, 
\begin_inset Formula $\mathbf{t}=\beta\rho\left(\mathbf{v}\otimes\mathbf{v}\right)\cdot\mathbf{n}$
\end_inset

 with a tensile normal component, that counters the backflow (only when
 
\begin_inset Formula $v_{n}<0$
\end_inset

).
 Here, 
\begin_inset Formula $\beta$
\end_inset

 is a non-dimensional user-defined parameter; a value of 
\begin_inset Formula $\beta=0$
\end_inset

 turns off this feature, while a value of 
\begin_inset Formula $\beta=1$
\end_inset

 generally shows good numerical performance.
 We adapt this previously proposed formulation by letting the normal component
 of the viscous traction be given by 
\begin_inset Formula 
\begin{equation}
t_{n}^{\tau}=\begin{cases}
\beta\rho_{r}v_{n}^{2} & v_{n}<0\\
0 & v_{n}\ge0
\end{cases}\,.\label{eq:BFS-normal-traction}
\end{equation}

\end_inset

The choice of 
\begin_inset Formula $\rho_{r}$
\end_inset

 in lieu of 
\begin_inset Formula $\rho$
\end_inset

 is for convenience, to avoid the dependence of 
\begin_inset Formula $\rho$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

 (which is negligible for nearly incompressible flow).
 Then, the contribution of this traction to the virtual external work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{v}\cdot t_{n}^{\tau}\mathbf{n}\,da\,.\label{eq:BFSckflow-virtual-work}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 in the velocity is given by
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{K}_{n}\cdot\Delta\mathbf{v}\,da\,,\label{eq:BFS-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{n}=\begin{cases}
2\beta\rho_{r}v_{n}\left(\mathbf{n}\otimes\mathbf{n}\right) & v_{n}<0\\
\mathbf{0} & v_{n}\ge0
\end{cases}\,.\label{eq:BFS-stiffness}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{n}\,,\quad\mathbf{f}_{a}^{n}=\int_{\partial\Omega}N_{a}t_{n}^{\tau}\mathbf{n}\,da\,,\label{eq:BFS-discretized-work}
\end{equation}

\end_inset

whereas the discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{n}\cdot\Delta\mathbf{v}_{b}\,,\quad\mathbf{K}_{ab}^{n}=\int_{\partial\Omega}N_{a}N_{b}\mathbf{K}_{n}\,da\,.\label{eq:BFS-discretized-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
A (viscous) tangential traction is implemented as a separate flow stabilization
 method in the next section, applicable to inlet or outlet surfaces, without
 a conditional requirement based on the sign of 
\begin_inset Formula $v_{n}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Tangential Flow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Tangential-Flow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
For certain outlet conditions, using the natural boundary condition 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\mathbf{0}$
\end_inset

 may lead to flow instabilities.
 It is possible to minimize these effects by prescribing a tangential viscous
 traction onto the boundary surface, which opposes this tangential flow.
 Optionally, this condition may be combined with the backflow stabilization
 described above.
\end_layout

\begin_layout Standard
Similar to the previous section, we introduce a non-dimensional parameter
 
\begin_inset Formula $\beta$
\end_inset

, with the tangential traction given by 
\begin_inset Formula 
\begin{equation}
\mathbf{t}_{t}^{\tau}=-\beta\rho_{r}\left|\mathbf{v}_{t}\right|\mathbf{v}_{t}\,.\label{eq:tangential-stabilization}
\end{equation}

\end_inset

This form shows that 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}$
\end_inset

 opposes tangential flow.
 The external virtual work for this traction is
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{t}_{t}^{\tau}\,da\,.\label{eq:TS-external-work}
\end{equation}

\end_inset

Its linearization along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{K}_{t}\cdot\Delta\mathbf{v}\,da\,,\label{eq:TS-linearization}
\end{equation}

\end_inset

where it can be shown that
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{t}=-\beta\rho_{r}\left|\mathbf{v}_{t}\right|\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}+\frac{\mathbf{v}_{t}}{\left|\mathbf{v}_{t}\right|}\otimes\frac{\mathbf{v}_{t}}{\left|\mathbf{v}_{t}\right|}\right)\,.\label{eq:TS-stiffness}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{\tau}\,,\quad\mathbf{f}_{a}^{\tau}=\int_{\partial\Omega}N_{a}\mathbf{t}_{t}^{\tau}\,da\,.\label{eq:TS-discretized-work}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{t}\cdot\Delta\mathbf{v}_{b}\,,\quad\mathbf{K}_{ab}^{t}=\int_{\partial\Omega}N_{a}N_{b}\mathbf{K}_{t}\,da\,.\label{eq:TS-discretized-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Flow Resistance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Flow-Resistance"

\end_inset


\end_layout

\begin_layout Standard
Flow resistance is typically implemented when modeling arterial flow, where
 the finite element domain only describes a portion of an arterial network
 
\begin_inset CommandInset citation
LatexCommand cite
key "Vignon-Clementel06"

\end_inset

.
 A flow resistance may be imposed on downstream boundaries to simulate the
 resistance produced by the vascular network with its branches and bifurcations.
 The resistance is equivalent to a mean pressure which is proportional to
 the volumetric flow rate 
\begin_inset Formula $Q$
\end_inset

,
\begin_inset Formula 
\[
p=RQ\,,\quad Q=\int_{\partial\Omega}v_{n}\,da\,,
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is the resistance.
 Using the pressure-dilatation relation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ideal-fluid"

\end_inset

, equivalent to 
\begin_inset Formula $p=-K\cdot e$
\end_inset

, this pressure may be prescribed as an essential boundary condition on
 the dilatation 
\begin_inset Formula $e$
\end_inset

.
\end_layout

\begin_layout Section
Newton-Raphson Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Newton-Raphson-Method"

\end_inset


\end_layout

\begin_layout Standard
The Newton-Raphson method (also known as 
\begin_inset Quotes eld
\end_inset

Newton's method
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Full Newton method
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

the Newton method
\begin_inset Quotes erd
\end_inset

) is the basis for solving the nonlinear finite element equations.
 This section will describe the 
\emph on
Full Newton method
\emph default
 and the Broyden-Fletcher-Goldfarb-Shanno (BFGS) method 
\begin_inset CommandInset citation
LatexCommand citep
key "Matthies79"

\end_inset

.
 The latter variation is actually a 
\emph on
quasi-Newton method
\emph default
.
 It is important since it provides several advantages over the full Newton
 method and it is this method that is implemented in FEBio 
\begin_inset CommandInset citation
LatexCommand citep
key "Matthies79"

\end_inset

.
\end_layout

\begin_layout Subsection
Full Newton Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Full-Newton-Method"

\end_inset


\end_layout

\begin_layout Standard
The Newton-Raphson equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq173"

\end_inset

 can be written in terms of the discretized equilibrium equations that were
 derived in the previous section as follows: 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{v}^{T}\cdot\mathbf{K}\cdot\mathbf{u}=-\delta\mathbf{v}^{T}\cdot\mathbf{R}.\label{eq355}
\end{equation}

\end_inset

Since the virtual velocities 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

are arbitrary, a discretized Newton-Raphson scheme can be formulated as
 follows: 
\begin_inset Formula 
\begin{equation}
\begin{array}{cc}
\mathbf{K}\left(\mathbf{x}_{k}\right)\cdot\mathbf{u}=-\mathbf{R}\left(\mathbf{x}_{k}\right); & \mathbf{x}_{k+1}=\mathbf{x}_{k}+\mathbf{u}\end{array}.\label{eq356}
\end{equation}

\end_inset

This is the basis of the Newton-Raphson method.
 For each iteration 
\begin_inset Formula $k$
\end_inset

, both the stiffness matrix and the residual vector are re-evaluated and
 a displacement increment 
\series bold
u 
\series default
is calculated by pre-multiplying both sides of the above equation by 
\begin_inset Formula $\mathbf{K}^{-1}$
\end_inset

.
 This procedure is repeated until some convergence criteria are satisfied.
\end_layout

\begin_layout Standard
The formation of the stiffness matrix and, especially, calculation of its
 inverse, are computationally expensive.
 Quasi-Newton methods do not require the reevaluation of the stiffness matrix
 for every iteration.
 Instead, a quick update is calculated.
 One particular method that has been quite successful in the field of computatio
nal solid mechanics is the BFGS method, which is described in the next section.
\end_layout

\begin_layout Subsection
BFGS Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:BFGS-Method"

\end_inset


\end_layout

\begin_layout Standard
The BFGS method updates the stiffness matrix (or rather its inverse) to
 provide an approximation to the exact matrix.
 A displacement increment is defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{k}=\mathbf{x}_{k}-\mathbf{x}_{k-1}\,,\label{eq357}
\end{equation}

\end_inset

and an increment in the residual is defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{G}_{k}=\mathbf{R}_{k-1}-\mathbf{R}_{k}\,.\label{eq358}
\end{equation}

\end_inset

The updated matrix 
\begin_inset Formula $\mathbf{K}_{k}$
\end_inset

 should satisfy the quasi-Newton equation: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{k}\mathbf{d}_{k}=\mathbf{G}_{k}\,.\label{eq359}
\end{equation}

\end_inset

In order to calculate this update, as displacement increment is first calculated
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}=\mathbf{K}_{k-1}^{-1}\mathbf{R}_{k-1}\,.\label{eq360}
\end{equation}

\end_inset

This displacement vector defines a 
\begin_inset Quotes eld
\end_inset

direction
\begin_inset Quotes erd
\end_inset

 for the actual displacement increment.
 A line search (see next section) can now be applied to determine the optimal
 displacement increment: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{k}=\mathbf{x}_{k-1}+s\mathbf{u}\,,\label{eq361}
\end{equation}

\end_inset

where 
\begin_inset Formula $s$
\end_inset

is determined from the line search.
 With the updated position calculated, 
\begin_inset Formula $\mathbf{R}_{k}$
\end_inset

can be evaluated.
 Also, using equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq357"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq358"

\end_inset

, 
\begin_inset Formula $\mathbf{d}_{k}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}_{k}$
\end_inset

 can be evaluted.
 The stiffness update can now be expressed as 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{k}^{-1}=\mathbf{A}_{k}^{T}\mathbf{K}_{k-1}^{-1}\mathbf{A}_{k}\,,\label{eq362}
\end{equation}

\end_inset

where the matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is an 
\begin_inset Formula $n\times n$
\end_inset

 matrix of the simple form: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{k}=\mathbf{1}+\mathbf{v}_{k}\mathbf{w}_{k}^{T}\,.\label{eq363}
\end{equation}

\end_inset

The vectors 
\series bold

\begin_inset Formula $\mathbf{v}$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $\mathbf{w}$
\end_inset


\series default
 are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{v}_{k}=-\left(\frac{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}{\mathbf{d}_{k}^{T}\mathbf{K}_{k-1}\mathbf{d}_{k}}\right)^{1/2}\mathbf{K}_{k-1}\mathbf{d}_{k}-\mathbf{G}_{k}\,,\label{eq364}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{w}_{k}=\frac{\mathbf{d}_{k}}{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}\,.\label{eq365}
\end{equation}

\end_inset

The vector 
\begin_inset Formula $\mathbf{K}_{k-1}\mathbf{d}_{k}$
\end_inset

 is equal to 
\begin_inset Formula $s\mathbf{R}_{k-1}$
\end_inset

 and has already been calculated.
\end_layout

\begin_layout Standard
To avoid numerically dangerous updates, the condition number 
\begin_inset Formula $c$
\end_inset

 of the updating matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is calculated:
\begin_inset Formula 
\begin{equation}
c=\left(\frac{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}{\mathbf{d}_{k}^{T}\mathbf{K}_{k-1}\mathbf{d}_{k}}\right)^{1/2}\,.\label{eq365b}
\end{equation}

\end_inset

The update is not performed when this number exceeds a preset tolerance.
\end_layout

\begin_layout Standard
Considering the actual computations involved, it should be noted that using
 the matrix updates defined above, the calculation of the search direction
 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq360"

\end_inset

 can be rewritten as, 
\begin_inset Formula 
\begin{equation}
\mathbf{u}=\left(\mathbf{1}+\mathbf{w}_{k-1}\mathbf{v}_{k-1}^{T}\right)\cdots\left(\mathbf{1}+\mathbf{w}_{1}\mathbf{v}_{1}^{T}\right)\mathbf{K}_{0}^{-1}\left(\mathbf{1}+\mathbf{v}_{1}\mathbf{w}_{1}^{T}\right)\cdots\left(\mathbf{1}+\mathbf{v}_{k-1}\mathbf{w}_{k-1}^{T}\right)\mathbf{R}_{k-1}\,.\label{eq366}
\end{equation}

\end_inset

Hence, the search direction can be computed without explicitly calculating
 the updated matrices or performing any additional costly matrix factorizations
 as required in the full Newton-Raphson method.
\end_layout

\begin_layout Subsection
Line Search Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Line-Search-Method"

\end_inset


\end_layout

\begin_layout Standard
A powerful technique often used to improve the convergence rate of Newton
 based methods is the 
\emph on
line search method
\emph default
.
 In this method, the direction of the displacement vector 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset

 
\series default
is considered as optimal, but the magnitude is controlled by a parameter
 
\begin_inset Formula $s$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{k+1}=\mathbf{x}_{k}+s\mathbf{u}\,.\label{eq367}
\end{equation}

\end_inset

The value of 
\begin_inset Formula $s$
\end_inset

is usually chosen so that the total potential energy 
\begin_inset Formula $W\left(s\right)=W\left(\mathbf{x}_{k}+s\mathbf{u}\right)$
\end_inset

at the end of the iteration is minimized in the direction of 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset


\series default
.
 This is equivalent to the requirement that the residual force 
\begin_inset Formula $\mathbf{R}\left(\mathbf{x}_{k}+s\mathbf{u}\right)$
\end_inset

at the end of the iteration is orthogonal to 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset


\series default
: 
\begin_inset Formula 
\begin{equation}
R\left(s\right)=\mathbf{u}^{T}\mathbf{R}\left(\mathbf{x}_{k}+s\mathbf{u}\right)=0\,.\label{eq368}
\end{equation}

\end_inset

However, in practice it is sufficient to obtain a value of 
\begin_inset Formula $s$
\end_inset

such that, 
\begin_inset Formula 
\begin{equation}
\left|R\left(s\right)\right|<\rho\left|R\left(0\right)\right|\,,\label{eq369}
\end{equation}

\end_inset

where typically a value of 
\begin_inset Formula $\rho=0.9$
\end_inset

 is used.
 Under normal conditions the value 
\begin_inset Formula $s=1$
\end_inset

 automatically satisfies equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq369"

\end_inset

 and therefore few extra operations are involved.
 However, when this is not the case, a more suitable value for 
\begin_inset Formula $s$
\end_inset

needs to be obtained.
 For this reason it is convenient to approximate 
\begin_inset Formula $R\left(s\right)$
\end_inset

as a quadratic in 
\begin_inset Formula $s$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
R\left(s\right)\approx\left(1-s\right)R\left(0\right)+R\left(1\right)s^{2}=0\,,\label{eq370}
\end{equation}

\end_inset

which yields a value for 
\begin_inset Formula $s$
\end_inset

as 
\begin_inset Formula 
\begin{equation}
s=\frac{r}{2}\pm\sqrt{\left(\frac{r}{2}\right)^{2}-r}\,,\quad r=\frac{R\left(0\right)}{R\left(1\right)}\,.\label{eq371}
\end{equation}

\end_inset

If 
\begin_inset Formula $r<0$
\end_inset

, the square root is positive and a first improved value for 
\begin_inset Formula $s$
\end_inset

is obtained: 
\begin_inset Formula 
\begin{equation}
s_{1}=\frac{r}{2}+\sqrt{\left(\frac{r}{2}\right)^{2}-r}\,.\label{eq372}
\end{equation}

\end_inset

If 
\begin_inset Formula $r>0$
\end_inset

 the 
\begin_inset Formula $s$
\end_inset

can be obtained by using the value that minimizes the quadratic function,
 that is, 
\begin_inset Formula $s_{1}=r/2$
\end_inset

.
 This procedure is now repeated with 
\begin_inset Formula $R\left(1\right)$
\end_inset

 replaced by 
\begin_inset Formula $R\left(s_{1}\right)$
\end_inset

 until equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq369"

\end_inset

 is satisfied.
\end_layout

\begin_layout Section
Generalized 
\begin_inset Formula $\alpha-$
\end_inset

Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Generalized-Alpha-Method"

\end_inset


\end_layout

\begin_layout Standard
The generalized 
\begin_inset Formula $\alpha-$
\end_inset

method is used for temporal discretization of governing equations in fluid
 mechanics.
 For this method we combine the degrees of freedom into 
\begin_inset Formula $\mathbf{Y}_{n}=\left\{ \mathbf{v},J\right\} _{n}$
\end_inset

, where the subscript 
\begin_inset Formula $n$
\end_inset

 denotes time 
\begin_inset Formula $t_{n}$
\end_inset

; similarly, we let 
\begin_inset Formula $\dot{\mathbf{Y}}_{n}=\left\{ \frac{\partial\mathbf{v}}{\partial t},\frac{\partial J}{\partial t}\right\} _{n}$
\end_inset

.
 According to this method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"

\end_inset

, the virtual work is evaluated at 
\begin_inset Formula $\delta W\left(\dot{\mathbf{Y}}_{n+\alpha_{m}},\mathbf{Y}_{n+\alpha_{f}}\right)$
\end_inset

, where 
\begin_inset Formula $t_{n+\alpha}=t_{n}+\alpha\Delta t$
\end_inset

 and 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

.
 The parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from a single parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 using
\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{1}{2}\frac{3-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas}
\end{equation}

\end_inset

where 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

.
 This parameter is the spectral radius for an infinite time step, which
 controls the amount of damping of high frequencies; a value of zero produces
 the greatest amount of damping, anihilating the highest frequency in one
 step, whereas a value of one preserves the highest frequency.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W$
\end_inset

 reported in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Discretization-Linearization"

\end_inset

 is effectively performed along 
\begin_inset Formula $\Delta\mathbf{Y}_{n+\alpha_{f}}$
\end_inset

 so that the solution to 
\begin_inset Formula $\delta W=0$
\end_inset

 produces 
\begin_inset Formula $\mathbf{Y}_{n+\alpha_{f}}$
\end_inset

.
 The parameter 
\begin_inset Formula $\xi$
\end_inset

 used in eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-a"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-J"

\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\xi=\frac{\alpha_{m}}{\gamma\alpha_{f}}\,,\quad\gamma=\frac{1}{2}+\alpha_{m}-\alpha_{f}\,.\label{eq:ga-ksi-gamma}
\end{equation}

\end_inset

In this scheme, 
\begin_inset Formula $\dot{\mathbf{Y}}_{n+\alpha_{m}}$
\end_inset

 is evaluated from
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{Y}}_{n+\alpha_{m}}=\left(1-\frac{\alpha_{m}}{\gamma}\right)\dot{\mathbf{Y}}_{n}+\frac{\xi}{\Delta t}\left(\mathbf{Y}_{n+\alpha_{f}}-\mathbf{Y}_{n}\right)\,.\label{eq:ga-Ydot-evaluation}
\end{equation}

\end_inset

Given the solution 
\begin_inset Formula $\left(\dot{\mathbf{Y}}_{n+\alpha_{m}},\mathbf{Y}_{n+\alpha_{f}}\right)$
\end_inset

, the solution at 
\begin_inset Formula $t_{n+1}$
\end_inset

 is evaluated from
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{Y}_{n+1} & =\mathbf{Y}_{n}+\frac{\mathbf{Y}_{n+\alpha_{f}}-\mathbf{Y}_{n}}{\alpha_{f}}\,,\\
\dot{\mathbf{Y}}_{n+1} & =\dot{\mathbf{Y}}_{n}+\frac{\dot{\mathbf{Y}}_{n+\alpha_{m}}-\dot{\mathbf{Y}}_{n}}{\alpha_{m}}\,.
\end{aligned}
\label{eq:ga-Y-updates}
\end{equation}

\end_inset

Four different options are presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"

\end_inset

 for initializing 
\begin_inset Formula $\mathbf{Y}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\dot{\mathbf{Y}}_{n+1}$
\end_inset

 at the beginning of time step 
\begin_inset Formula $t_{n+1}$
\end_inset

; the first three of these have been implemented in FEBio.
 For steady flows these authors recommend disregarding 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 and setting 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\gamma=1$
\end_inset

 to recover the backward Euler scheme.
\end_layout

\begin_layout Chapter
Element Library
\begin_inset CommandInset label
LatexCommand label
name "chap:Element-Library"

\end_inset


\end_layout

\begin_layout Standard
FEBio provides several element types for finite element discretization.
 This chapter describes these elements in more detail.
\end_layout

\begin_layout Section
Solid Elements
\begin_inset CommandInset label
LatexCommand label
name "sec:Solid-elements"

\end_inset


\end_layout

\begin_layout Standard
The 3D solid elements available in FEBio are 
\emph on
isoparametric elements
\emph default
.
 All of the solid elements are formulated in a global Cartesian coordinate
 system.
 For all these elements, a local coordinate system (so-called 
\emph on
isoparametric coordinates
\emph default
) is defined as well.
 The global position vector 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
 can be written as a function of the isoparametric coordinates in the following
 sense: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(r,s,t\right)=\sum\limits _{i=1}^{n}N_{i}\left(r,s,t\right)\mathbf{x}_{i}.\label{eq373}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $n$
\end_inset

 is the number of nodes, 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 are the isoparametric coordinates, 
\begin_inset Formula $N_{i}$
\end_inset

 are the element shape functions and 
\begin_inset Formula $\mathbf{x}_{i}$
\end_inset

 are the spatial coordinates of the element nodes.
 The same parametric interpolation is used for the interpolation of other
 scalar and vector quantities.
\end_layout

\begin_layout Standard
All elements in FEBio are integrated numerically.
 This implies that integrals over the volume of the element 
\begin_inset Formula $v^{e}$
\end_inset

 are approximated by a sum: 
\begin_inset Formula 
\begin{equation}
\int\limits _{v^{e}}f\left(\mathbf{x}\right)\,dv=\int\limits _{\Square^{e}}f\left({\mathbf{r}}\right)J(\mathbf{r})d\Square\,\cong\sum\limits _{i=1}^{m}f\left(\mathbf{r}_{i}\right)J_{i}w_{i}\,.\label{eq374}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\Square$
\end_inset

 is the biunit cube, 
\begin_inset Formula $m$
\end_inset

 is the number of integration points, 
\begin_inset Formula $\mathbf{r}_{i}$
\end_inset

are the location of the integration points in isoparametric coordinates,
 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the transformation 
\begin_inset Formula $\mathbf{x}=\mathbf{x}\left(r,s,t\right)$
\end_inset

, and 
\begin_inset Formula $w_{i}$
\end_inset

 is a weight associated with the integration point.
 The integration is performed over the element's volume in the natural coordinat
e system.
\end_layout

\begin_layout Standard
Most fully integrated solid elements are unsuitable for the analysis of
 (nearly-) incompressible material behavior.
 To deal with this type of deformation, a three-field element implementation
 is available in FEBio 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"

\end_inset

.
\end_layout

\begin_layout Subsection
Hexahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Hexahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
FEBio implements an 8-node trilinear hexahedral element.
 This element is also known as a 
\emph on
brick 
\emph default
element.
 The shape functions for these elements are defined in function of the isoparame
tric coordinates 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t,$
\end_inset

 and are given below.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =\frac{1}{8}\left(1-r\right)\left(1-s\right)\left(1-t\right)\\
N_{2} & =\frac{1}{8}\left(1+r\right)\left(1-s\right)\left(1-t\right)\\
N_{3} & =\frac{1}{8}\left(1+r\right)\left(1+s\right)\left(1-t\right)\\
N_{4} & =\frac{1}{8}\left(1-r\right)\left(1+s\right)\left(1-t\right)\\
N_{5} & =\frac{1}{8}\left(1-r\right)\left(1-s\right)\left(1+t\right)\\
N_{6} & =\frac{1}{8}\left(1+r\right)\left(1-s\right)\left(1+t\right)\\
N_{7} & =\frac{1}{8}\left(1+r\right)\left(1+s\right)\left(1+t\right)\\
N_{8} & =\frac{1}{8}\left(1-r\right)\left(1+s\right)\left(1+t\right)
\end{aligned}
\,.\label{eq375}
\end{equation}

\end_inset

The following integration rule is implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Pentahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Pentahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
Pentahedral elements (also knows as 
\begin_inset Quotes eld
\end_inset

wedge
\begin_inset Quotes erd
\end_inset

 elements) consist of six nodes and five faces.
 Their shape functions are defined in function of the isoparametric coordinates
 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 and are given as follows.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =\frac{1}{2}\left(1-r-s\right)\left(1-t\right)\\
N_{2} & =\frac{1}{2}r\left(1-t\right)\\
N_{3} & =\frac{1}{2}s\left(1-t\right)\\
N_{4} & =\frac{1}{2}\left(1-r-s\right)\left(1+t\right)\\
N_{5} & =\frac{1}{2}r\left(1+t\right)\\
N_{6} & =\frac{1}{2}s\left(1+t\right)
\end{aligned}
\,.\label{eq376}
\end{equation}

\end_inset

The following integration rule is implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
6-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Tetrahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tetrahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
Linear 4-node tetrahedral elements are also available in FEBio.
 Their shape functions are defined in function of the isoparametric coordinates
 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =1-r-s-t\\
N_{2} & =r\\
N_{3} & =s\\
N_{4} & =t
\end{aligned}
\,.\label{eq377}
\end{equation}

\end_inset

The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigSolidElementsTM.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Different solid element types that are available in FEBio
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Quadratic Tetrahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quadratic-Tetrahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
FEBio implements a 10-node quadratic tetrahedral element.
 It has four corner nodes and six nodes located at the midpoint of the edges.
 The shape functions in terms area coordinates are given below.
 The area coordinates relate to the isoparametric coordinates as follows.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}t_{1} & =1-r-s-t\\
t_{2} & =r\\
t_{3} & =s\\
t_{4} & =t
\end{aligned}
\,.\label{eq378}
\end{equation}

\end_inset

The shape functions follow.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}H_{i} & =t_{i}\left(2t_{i}-1\right),\,i=1\cdots4\\
H_{5} & =4t_{1}t_{2}\\
H_{6} & =4t_{2}t_{3}\\
H_{7} & =4t_{3}t_{1}\\
H_{8} & =4t_{1}t_{4}\\
H_{9} & =4t_{2}t_{4}\\
H_{10} & =4t_{3}t_{4}
\end{aligned}
\,.\label{eq379}
\end{equation}

\end_inset

The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
11-point Gauss-Lobatto rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.088888889 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
FEBio also implements a 15-node quadratic tetrahedral element.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigQuadraticTetrahedralElements.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Quadratic tetrahedral elements available in FEBio.
 Left, a 10-node quadratic tet.
 Right, a 15-node quadratic tet.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\series default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 Note that weights sum up to one and not to the volume of the tet in the
 natural coordinate system (i.e.
 1/6).
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
11-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.01315555556 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
15-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.030283678097089 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Section
Shell Elements
\begin_inset CommandInset label
LatexCommand label
name "sec:Shell-Elements"

\end_inset


\end_layout

\begin_layout Standard
Historically, shells have been formulated using two different approaches
 
\begin_inset CommandInset citation
LatexCommand citep
key "Hughes80"

\end_inset

.
 The difference between these approaches lies in the way the rotational
 degrees of freedom are defined.
 In the first approach, the rotational degrees of freedom are defined as
 angles.
 In addition, the plane stress condition needs to be enforced to take thickness
 variations into account.
 This approach is very useful for infinitesimal strains, but becomes very
 difficult to pursue in finite deformation due to the fact that finite rotations
 do not commute.
 Another disadvantage of this approach is that it requires a modification
 to the material formulation to enforce the plane stress condition.
 For complex materials this modification is very difficult or even impossible
 to obtain.
\end_layout

\begin_layout Standard
The alternative approach is to use an 
\emph on
extensible director 
\emph default
to describe the rotational degrees of freedom.
 With this approach it is not necessary to enforce the plane-stress condition
 and the full 3D constitutive relations can be employed.
 This approach is adapted in FEBio as described here.
\end_layout

\begin_layout Standard
The shell formulation implemented in FEBio is still a work in progress.
 The goal is to implement an extensible director formulation with strain
 enhancements to deal with the well-known locking effect in incompressible
 and bending problems 
\begin_inset CommandInset citation
LatexCommand citep
key "Betsch96"

\end_inset

.
 With the current state of the implementation, it is advised to use quadratic
 elements in such problems.
\end_layout

\begin_layout Standard
Starting with FEBio 2.6, two shell formulations have become available: The
 original formulation, where nodes are located at the mid-surface through
 the thickness of the shell, and a new formulation where nodes are located
 on the front face of the shell.
 The original formulation uses nodal displacements and directors as degrees
 of freedom; the new formulation uses front and back face nodal displacements.
 The new formulation is designed to properly accommodate shells attached
 to the surface of a solid element, or shells sandwiched between two solid
 elements, with minimal alterations to the rest of the code.
 The original formulation does not strictly enforce continuity of all the
 relevant degrees of freedom in those situations.
 However, this original formulation is maintained in the code for backward
 compatibility.
\end_layout

\begin_layout Subsection
Shell with mid-surface nodal displacements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shell-formulation-standalone"

\end_inset


\end_layout

\begin_layout Standard
We create a shell formulation by reducing a solid element interpolation
 which is linear along the parametric coordinate 
\begin_inset Formula $\xi_{3}$
\end_inset

.
 We start with the general interpolation for a solid element, 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{i}\right)\mathbf{x}_{a}\,,\label{eq380}
\end{equation}

\end_inset

where 
\begin_inset Formula $i=1,2,3$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 is the number of nodes, and specialize it to the case of a shell as 
\begin_inset Formula 
\begin{equation}
N_{a}\left(\xi_{i}\right)=\begin{cases}
\frac{1-\xi_{3}}{2}M_{a}\left(\xi_{\alpha}\right) & 1\leqslant a\leqslant m\\
\frac{1+\xi_{3}}{2}M_{a}\left(\xi_{\alpha}\right) & m+1\leqslant a\leqslant n
\end{cases}\,,\label{eq381}
\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha=1,2$
\end_inset

, 
\begin_inset Formula $m=n/2$
\end_inset

 is the number of shell element nodes, and 
\begin_inset Formula $M_{a}\left(\xi_{\alpha}\right)$
\end_inset

 are the interpolation functions within the mid-shell surface.
 The description of the mid-shell surface is thus given by 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{x}}\left(\xi_{\alpha}\right)=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{1},\xi_{2},0\right)\mathbf{x}_{a}\equiv\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{\hat{x}}_{b}\,,\label{eq382}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{x}}_{b}=\frac{1}{2}\left(\mathbf{x}_{b}+\mathbf{x}_{b+m}\right)\label{eq383}
\end{equation}

\end_inset

are the nodal positions for the mid-shell surface.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementsTM.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Example of shell elements with four mid-surface nodal positions 
\begin_inset Formula $\mathbf{\hat{x}}_{b}$
\end_inset

 and directors 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 (
\begin_inset Formula $b=1-4)$
\end_inset

, reduced from a solid element.
 
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
We also define the director across the shell surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{d}\left(\xi_{\alpha}\right)=\mathbf{x}\left(\xi_{1},\xi_{2},1\right)-\mathbf{x}\left(\xi_{1},\xi_{2},-1\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{d}_{b}\,,\label{eq384}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{b}=\mathbf{x}_{b+m}-\mathbf{x}_{b},\quad b=1-m\label{eq385}
\end{equation}

\end_inset

are the nodal directors.
 Note that the magnitude of the nodal director represents the shell thickness,
 
\begin_inset Formula $h\left(\xi_{\alpha}\right)=\left\Vert \mathbf{d}\left(\xi_{\alpha}\right)\right\Vert $
\end_inset

 and the shell thicknesses at the nodes are 
\begin_inset Formula $h_{b}=\left\Vert \mathbf{d}_{b}\right\Vert $
\end_inset

.
 With these definitions we find that the interpolation across the parametric
 space of the shell element is 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\mathbf{\hat{x}}\left(\xi_{\alpha}\right)+\frac{1}{2}\xi_{3}\mathbf{d}\left(\xi_{\alpha}\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\left(\mathbf{\hat{x}}_{b}+\frac{1}{2}\xi_{3}\mathbf{d}_{b}\right)\,.\label{eq386}
\end{equation}

\end_inset

From this relation we can obtain the covariant basis vectors as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{\alpha}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{\alpha}}=\sum\limits _{b=1}^{m}\frac{\partial M_{b}}{\partial\xi_{\alpha}}\left(\mathbf{\hat{x}}_{b}+\frac{1}{2}\xi_{3}\mathbf{d}_{b}\right)\\
\mathbf{g}_{3}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{3}}=\frac{1}{2}\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{d}_{b}
\end{aligned}
\,,\label{eq387}
\end{equation}

\end_inset

from which we may evaluate the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}^{j}$
\end_inset

 using the identity 
\begin_inset Formula $\mathbf{g}_{i}\cdot\mathbf{g}^{j}=\delta_{i}^{j}$
\end_inset

.
 Then, the gradients of the shape functions are given by 
\begin_inset Formula 
\begin{equation}
\grad M_{b}=\frac{\partial M_{b}}{\partial\xi_{\alpha}}\mathbf{g}^{\alpha},\quad\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)=\frac{1}{2}\left(\xi_{3}\grad M_{b}+M_{b}\mathbf{g}^{3}\right)\,.\label{eq388}
\end{equation}

\end_inset

It follows from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq386"

\end_inset

 that the virtual displacement is 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{u}\left(\xi_{i}\right)=\sum\limits _{a=1}^{m}M_{a}\left(\xi_{\alpha}\right)\left(\delta\mathbf{\hat{u}}_{a}+\frac{1}{2}\xi_{3}\delta\mathbf{d}_{a}\right)\,,\label{eq389}
\end{equation}

\end_inset

and the incremental displacement is 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}\left(\xi_{i}\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\left(\Delta\mathbf{\hat{u}}_{b}+\frac{1}{2}\xi_{3}\Delta\mathbf{d}_{b}\right)\,.\label{eq390}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In FEBio, for historical reasons, the nodal director 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 is currently called 
\emph on
rotation
\emph default
.
 This is a misnomer and users should treat this 
\emph on
rotation
\emph default
 as the vector 
\begin_inset Formula $\mathbf{d}_{a}$
\end_inset

 whose components have units of length.
 Thus, fixing or prescribing 
\emph on
rotation
\emph default
 components in the input file effectively places these constraints on the
 components of the nodal director; similarly, requesting 
\emph on
rotation
\emph default
 in the output files will produce the components of the director.
\end_layout

\begin_layout Standard
When this type of shell is connected face-to-face with a solid element,
 the nodes located at 
\begin_inset Formula $\mathbf{\hat{x}}_{b}$
\end_inset

 automatically share their displacement degrees of freedom 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 with the corresponding nodes from the face of the solid element.
 However, no continuity is enforced between the directors 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 and the solid element deformation.
 One consequence of this condition is that a shell sandwiched between two
 solid elements will not detect out-of-plane shear and normal stresses transmitt
ed by the solid element(s).
 Another consequence is that bending of the solid element(s) will not produce
 a bending moment in the shell.
 Therefore, these shell elements are best used as shell-only structures.
\end_layout

\begin_layout Subsubsection
Elastic Shell
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elastic-Shell"

\end_inset


\end_layout

\begin_layout Standard
For an elastic shell, the internal virtual work becomes 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}^{e}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}:\grad\delta\mathbf{u}\,dv=\sum\limits _{a=1}^{n}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{d}
\end{array}\right]\,,\label{eq391}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{f}_{a}^{u}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}\cdot\grad M_{a}\,dv,\quad\mathbf{f}_{a}^{d}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\,dv\,.\label{eq392}
\end{equation}

\end_inset

The linearization of the internal virtual work is 
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
D\left(\delta W_{\text{int}}^{e}\right)\left[\Delta\mathbf{u}\right]=\int\limits _{\Omega^{e}}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv\\
+\int\limits _{\Omega^{e}}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv
\end{array}\,.\label{eq393}
\end{equation}

\end_inset

The first of these integrals may be discretized as 
\begin_inset Formula 
\begin{equation}
\int\limits _{\Omega^{e}}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv=\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{ud}\\
\mathbf{K}_{ab}^{du} & \mathbf{K}_{ab}^{dd}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{\hat{u}}_{b}\\
\Delta\mathbf{d}_{b}
\end{array}\right]\,,\label{eq394}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int\limits _{\Omega^{e}}\left(\grad M_{a}\cdot\boldsymbol{\sigma}\cdot\grad M_{b}\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{ud} & =\int\limits _{\Omega^{e}}\left(\grad M_{a}\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{du} & =\int\limits _{\Omega^{e}}\left(\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad M_{b}\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{dd} & =\int\limits _{\Omega^{e}}\left(\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\right)\mathbf{I}\,dv
\end{aligned}
\,.\label{eq395}
\end{equation}

\end_inset

The second integral in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq393"

\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\int\limits _{\Omega^{e}}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv=\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{ud}\\
\mathbf{K}_{ab}^{du} & \mathbf{K}_{ab}^{dd}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{\hat{u}}_{b}\\
\Delta\mathbf{d}_{b}
\end{array}\right]\,,\label{eq396}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int\limits _{\Omega^{e}}\grad M_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad M_{b}\,dv\\
\mathbf{K}_{ab}^{ud} & =\int\limits _{\Omega^{e}}\grad M_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{du} & =\int\limits _{\Omega^{e}}\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad M_{b}\,dv\\
\mathbf{K}_{ab}^{dd} & =\int\limits _{\Omega^{e}}\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\,dv
\end{aligned}
\,.\label{eq397}
\end{equation}

\end_inset

Similar expressions may be derived for the external work and inertia forces.
\end_layout

\begin_layout Standard
In FEBio a 3-point Gaussian quadrature rule is used for the through-the-thicknes
s integration.
 FEBio currently supports four- and eight-node quadrilateral and three-
 and six-node triangular shell elements.
\end_layout

\begin_layout Subsubsection
Quadrilateral shells
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quadrilateral-shells"

\end_inset


\end_layout

\begin_layout Standard
For four-node quadrilateral shells, the shape functions are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =\frac{1}{4}\left(1-r\right)\left(1-s\right)\\
M_{2} & =\frac{1}{4}\left(1+r\right)\left(1-s\right)\\
M_{3} & =\frac{1}{4}\left(1+r\right)\left(1+s\right)\\
M_{4} & =\frac{1}{4}\left(1-r\right)\left(1+s\right)
\end{aligned}
\,.\label{eq398}
\end{equation}

\end_inset

For eight-node quadrilateral shells the shape functions are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =\frac{1}{4}\left(1-r\right)\left(1-s\right)-\frac{1}{2}\left(M_{8}+M_{5}\right) & M_{5} & =\frac{1}{2}\left(1-r^{2}\right)\left(1-s\right)\\
M_{2} & =\frac{1}{4}\left(1+r\right)\left(1-s\right)-\frac{1}{2}\left(M_{5}+M_{6}\right) & M_{6} & =\frac{1}{2}\left(1-s^{2}\right)\left(1+r\right)\\
M_{3} & =\frac{1}{4}\left(1+r\right)\left(1+s\right)-\frac{1}{2}\left(M_{6}+M_{7}\right) & M_{7} & =\frac{1}{2}\left(1-r^{2}\right)\left(1+s\right)\\
M_{4} & =\frac{1}{4}\left(1-r\right)\left(1+s\right)-\frac{1}{2}\left(M_{7}+M_{8}\right) & M_{8} & =\frac{1}{2}\left(1-s^{2}\right)\left(1-r\right)
\end{aligned}
\,.\label{eq399}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Triangular shells
\begin_inset CommandInset label
LatexCommand label
name "subsec:Triangular-shells"

\end_inset


\end_layout

\begin_layout Standard
For three-node triangular shell elements, the shape functions are given
 by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =1-r-s\\
M_{2} & =r\\
M_{3} & =s
\end{aligned}
\,.\label{eq400}
\end{equation}

\end_inset

For six-node triangular shell elements they are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =r_{1}\left(2r_{1}-1\right) & M_{4} & =4r_{1}r_{2}\\
M_{2} & =r_{2}\left(2r_{2}-1\right) & M_{5} & =4r_{2}r_{3}\\
M_{3} & =r_{3}\left(2r_{3}-1\right) & M_{6} & =4r_{3}r_{1}\\
r_{1} & =1-r-s & r_{2} & =r & r_{3} & =s
\end{aligned}
\,.\label{eq401}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementTypesTM.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Different shell elements available in FEBio.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Shells with front and back face nodal displacements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shells-front-back"

\end_inset


\end_layout

\begin_layout Standard
We create a shell formulation by reducing a 3D element interpolation which
 is linear along 
\begin_inset Formula $\xi_{3}$
\end_inset

.
 The nodal positions at the back of the shell (
\begin_inset Formula $\xi_{3}=-1$
\end_inset

) are denoted by 
\begin_inset Formula $\mathbf{y}_{a}$
\end_inset

 and those on the front of the shell (
\begin_inset Formula $\xi_{3}=+1$
\end_inset

) are denoted by 
\begin_inset Formula $\mathbf{x}_{a}$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\sum_{a}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\frac{1+\xi_{3}}{2}\mathbf{x}_{a}+\frac{1-\xi_{3}}{2}\mathbf{y}_{a}\right)=\sum_{a}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\mathbf{x}_{a}-\frac{1-\xi_{3}}{2}\mathbf{d}_{a}\right)\label{eq:solid-element-interpolation}
\end{equation}

\end_inset

The vector from 
\begin_inset Formula $\mathbf{y}_{a}$
\end_inset

 to 
\begin_inset Formula $\mathbf{x}_{a}$
\end_inset

 is the director, 
\begin_inset Formula $\mathbf{d}_{a}$
\end_inset

,
\begin_inset Formula 
\[
\mathbf{d}_{a}=\mathbf{x}_{a}-\mathbf{y}_{a}
\]

\end_inset

From this relation we can get the shell covariant basis vectors,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{\alpha}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{\alpha}}=\sum_{a}\frac{\partial M_{a}}{\partial\xi_{\alpha}}\left(\frac{1+\xi_{3}}{2}\mathbf{x}_{a}+\frac{1-\xi_{3}}{2}\mathbf{y}_{a}\right)=\sum_{a}\frac{\partial M_{a}}{\partial\xi_{\alpha}}\left(\mathbf{x}_{a}-\frac{1-\xi_{3}}{2}\mathbf{d}_{a}\right)\\
\mathbf{g}_{3}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{3}}=\sum_{a}\frac{1}{2}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\mathbf{x}_{a}-\mathbf{y}_{a}\right)=\sum_{a}\frac{1}{2}M_{a}\left(\xi_{1},\xi_{2}\right)\mathbf{d}_{a}
\end{aligned}
\label{eq:shell-covariant-basis}
\end{equation}

\end_inset

from which we may evaluate the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}^{i}$
\end_inset

.
 Let the front-face and back-face displacements be denoted by 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula $\mathbf{x}_{a}=\mathbf{X}_{a}+\mathbf{u}_{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}_{a}=\mathbf{Y}_{a}+\mathbf{w}_{a}$
\end_inset

, where 
\begin_inset Formula $\mathbf{X}_{a}$
\end_inset

 represents the shell nodal positions in the reference configuration, provided
 as nodal coordinates in the input file, and 
\begin_inset Formula $\mathbf{Y}_{a}=\mathbf{X}_{a}-\mathbf{D}_{a}$
\end_inset

 is evaluated from the user-defined referential shell thickness, and the
 surface surface normals evaluated at each node.
 If the shell surface is not planar in the reference configuration, users
 must be careful to select shell thicknesses that don't produce inverted
 elements (negative Jacobians) as a result of this extrapolation.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementsFB.pdf
	lyxscale 45
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Example of shell element with front-face nodal positions 
\begin_inset Formula $\mathbf{x}_{b}$
\end_inset

 and back-face nodal positions 
\begin_inset Formula $\mathbf{y}_{b}$
\end_inset

 (
\begin_inset Formula $b=1-4)$
\end_inset

, reduced from a solid element.
 
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
It follows that the virtual displacement is
\begin_inset Formula 
\begin{equation}
\delta\mathbf{u}\left(\xi_{i}\right)=\sum_{a}M_{a}\left(\frac{1+\xi_{3}}{2}\delta\mathbf{u}_{a}+\frac{1-\xi_{3}}{2}\delta\mathbf{w}_{a}\right)\,,\label{eq:shell-virtual-velocity}
\end{equation}

\end_inset

and the incremental displacement is
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}\left(\xi_{i}\right)=\sum_{b}M_{b}\left(\frac{1+\xi_{3}}{2}\Delta\mathbf{u}_{b}+\frac{1-\xi_{3}}{2}\Delta\mathbf{w}_{b}\right)\,,\label{eq:shell-incremental-displacement}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
\grad\delta\mathbf{u}=\sum_{a}\delta\mathbf{u}_{a}\otimes\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)+\delta\mathbf{w}_{a}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\,,\label{eq:gradient-virtual-velocity}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\grad\Delta\mathbf{u}=\sum_{b}\Delta\mathbf{u}_{b}\otimes\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)+\Delta\mathbf{w}_{b}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\label{eq:gradient-incremental-displacement}
\end{equation}

\end_inset

Note that
\begin_inset Formula 
\begin{equation}
\grad M_{b}=\frac{\partial M_{b}}{\partial\xi_{\alpha}}\mathbf{g}^{\alpha}\,,\label{eq:shell-shape-gradient-M}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)=\frac{1}{2}\left(\left(1+\xi_{3}\right)\grad M_{b}+M_{b}\mathbf{g}^{3}\right)\label{eq:shell-shape-gradient-Mu}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)=\frac{1}{2}\left(\left(1-\xi_{3}\right)\grad M_{b}-M_{b}\mathbf{g}^{3}\right)\label{eq:shell-shape-gradient-Md}
\end{equation}

\end_inset

To evaluate the deformation gradient in this shell element, we use
\begin_inset Formula 
\[
\mathbf{F}=\Grad\mathbf{x}=\sum_{b}\mathbf{u}_{b}\otimes\Grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)+\mathbf{w}_{b}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
For this formulation, when a shell element is connected face-to-face with
 a solid element, the nodal displacements of the solid element face are
 set to coincide with the back-face nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 of the shell.
 When a user prescribes displacement components on that shared face, they
 apply to the front-face displacements 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

.
 Similarly, prescribed pressures and contact pressures act on the shell
 front face.
\end_layout

\begin_layout Standard
When a shell element is sandwiched between two solid elements, the nodal
 displacements of the solid element facing the shell back face are set to
 coincide with the shell back-face nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

, whereas the nodal displacements of the solid element facing the shell
 front face are set to coincide with the shell front-face nodal displacements
 
\begin_inset Formula $\mathbf{u}_{a}$
\end_inset

.
 If the shell thickness exceeds the thickness of the solid element connected
 to its back face, results become unpredictable.
\end_layout

\begin_layout Subsubsection
Elastic Shell
\end_layout

\begin_layout Standard
For an elastic solid, the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{v}\boldsymbol{\sigma}:\grad\delta\mathbf{u}\,dv\\
 & =\sum_{a}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}
\end{array}\right]
\end{aligned}
\,,\label{eq:virtual-work-internal}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u} & =\int_{v}\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\,dv\\
\mathbf{f}_{a}^{w} & =\int_{v}\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\,dv
\end{aligned}
\,.\label{eq:shell-internal-force}
\end{equation}

\end_inset

For the external work of body forces,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext} & =\int_{v}\delta\mathbf{u}\cdot\rho\mathbf{b}\,dv\\
 & =\sum_{a=1}^{m}\delta\mathbf{u}_{a}\cdot\mathbf{f}_{a}^{u}+\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}
\end{aligned}
\,,\label{eq:virtual-work-external}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u} & =\int_{v}\frac{1+\xi_{3}}{2}M_{a}\rho\mathbf{b}\,dv\\
\mathbf{f}_{a}^{w} & =\int_{v}\frac{1-\xi_{3}}{2}M_{a}\rho\mathbf{b}\,dv
\end{aligned}
\,.\label{eq:shell-external-force}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linearization of the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{u}\right] & =\int_{v}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv\\
 & +\int_{v}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv
\end{aligned}
\,.\label{eq:linearized-internal-work}
\end{equation}

\end_inset

So
\begin_inset Formula 
\begin{equation}
\int_{v}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv=\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]\,,\label{eq:discretized-geometric-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{v}\left(\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{uw} & =\int_{v}\left(\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{wu} & =\int_{v}\left(\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{ww} & =\int_{v}\left(\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv
\end{aligned}
\,.\label{eq:shell-geometric-stiffness}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\int_{v}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv=\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]\,,\label{eq:discretized-material-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{v}\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{uw} & =\int_{v}\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{wu} & =\int_{v}\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{ww} & =\int_{v}\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\,dv
\end{aligned}
\,.\label{eq:shell-material-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linearization of the external work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{ext}\right) & =\sum_{a=1}^{m}\sum_{b=1}^{m}\int_{v}\left(\frac{1+\xi_{3}}{2}M_{a}\delta\mathbf{u}_{a}+\frac{1-\xi_{3}}{2}M_{a}\delta\mathbf{w}_{a}\right)\cdot\rho\grad\mathbf{b}\cdot\left(\frac{1+\xi_{3}}{2}\Delta\mathbf{u}_{b}+\frac{1-\xi_{3}}{2}M_{b}\Delta\mathbf{w}_{b}\right)\,dv\\
 & =\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]
\end{aligned}
\,,\label{eq:linearized-external-work}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)^{2}M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{uw} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)\left(\frac{1-\xi_{3}}{2}\right)M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{wu} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)\left(\frac{1-\xi_{3}}{2}\right)M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{ww} & =\int_{V}\left(\frac{1-\xi_{3}}{2}\right)^{2}M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV
\end{aligned}
\,.\label{eq:shell-external-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
External work of surface forces
\end_layout

\begin_layout Standard
We assume that surface forces are applied on the shell front face (
\begin_inset Formula $\xi_{3}=+1$
\end_inset

).
 Therefore, the external work of surface forces has the form
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\int_{\partial v}\delta\mathbf{u}\left(\xi_{1},\xi_{2},+1\right)\cdot\mathbf{t}\,da=\sum_{a}\delta\mathbf{u}_{a}\cdot\int_{\partial v}M_{a}\left(\xi_{1},\xi_{2}\right)\mathbf{t}\,da\label{eq:fbs-ext-work}
\end{equation}

\end_inset

In other words, the treatment of surface forces on a shell becomes identical
 to the treatment of surface forces on the face of a solid.
 No special treatment is needed.
\end_layout

\begin_layout Subsubsection
Shell on top of solid element
\end_layout

\begin_layout Standard
When a shell is coincident with the face of a solid element, we assume that
 the face of the solid element coincides with the back face (
\begin_inset Formula $\xi_{3}=-1$
\end_inset

) of the shell element.
 This means that the solid element nodal displacements 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 on that face coincide with the shell nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

.
 Therefore, when we use UnpackLM for those solid elements, we should reassign
 the DOF ID's of the 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements to those of the 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 displacements stored in that same node.
\end_layout

\begin_layout Subsubsection
Shell sandwiched between solid elements
\end_layout

\begin_layout Standard
When a shell is sandwiched between two solid elements, we reassign the DOF
 ID's of the the solid 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements facing the back of the shell to those of the shell 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 displacements stored in that same node.
 The DOF ID's of solid 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements facing the front of the shell remain unchanged; they will
 coincide with those of the corresponding solid element nodes.
\end_layout

\begin_layout Subsubsection
Rigid-Shell Interface
\end_layout

\begin_layout Standard
When the node of a deformable shell belongs to a rigid body, we need to
 substitute the nodal degrees of freedom with the rigid body degrees of
 freedom.
 The positions of the shell front face and back face nodes are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{x}_{b} & =\mathbf{r}+\boldsymbol{\Lambda}\cdot\left(\mathbf{X}_{b}-\mathbf{R}\right)\equiv\mathbf{r}+\mathbf{a}_{b}\\
\mathbf{y}_{b} & =\mathbf{r}+\boldsymbol{\Lambda}\cdot\left(\mathbf{Y}_{b}-\mathbf{R}\right)\equiv\mathbf{r}+\mathbf{b}_{b}
\end{aligned}
\,,\label{eq:fbs-rigid-shell}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}$
\end_inset

 is the current position of the rigid body center of mass and 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is its initial position; 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 is the rotation tensor for the rigid body.
 We assume that 
\begin_inset Formula $\mathbf{x}_{b}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}_{b}$
\end_inset

 are connected to the same rigid body.
 From these relations it follows that virtual displacements are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{u}_{a} & =\delta\mathbf{r}-\hat{\mathbf{a}}_{a}\cdot\delta\boldsymbol{\theta}\\
\delta\mathbf{w}_{b} & =\delta\mathbf{r}-\hat{\mathbf{b}}_{a}\cdot\delta\boldsymbol{\theta}
\end{aligned}
\,,\label{eq:fbs-rsi-virtual}
\end{equation}

\end_inset

and incremental displacements are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\mathbf{u}_{b} & =\Delta\mathbf{r}-\hat{\mathbf{a}}_{b}\cdot\Delta\boldsymbol{\theta}\\
\Delta\mathbf{w}_{b} & =\Delta\mathbf{r}-\hat{\mathbf{b}}_{b}\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\,,\label{eq:fbs-rsi-incremental}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{a}}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{a}$
\end_inset

, such that 
\begin_inset Formula $\hat{\mathbf{a}}\cdot\mathbf{v}=\mathbf{a}\times\mathbf{v}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{v}$
\end_inset

.
 When nodes are flexible (when they do not belong to any rigid body), the
 virtual work has the general form
\begin_inset Formula 
\begin{equation}
\delta W=\sum_{a=1}^{m}\delta\mathbf{u}_{a}\cdot\mathbf{f}_{a}^{u}+\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}+\delta p_{a}\,f_{a}^{p}=\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]\,,\label{eq:fbs-rsi-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 denotes any additional degree-of-freedom at that node.
 If node 
\begin_inset Formula $a$
\end_inset

 is rigid we get
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]=\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\left[\begin{array}{ccc}
\mathbf{I} & \mathbf{I} & \mathbf{0}\\
\hat{\mathbf{a}}_{a} & \hat{\mathbf{b}}_{a} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & 1
\end{array}\right]\,.\label{eq:fbs-rsi-a-rigid}
\end{equation}

\end_inset

If node 
\begin_inset Formula $b$
\end_inset

 is rigid we get
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]=\left[\begin{array}{ccc}
\mathbf{I} & -\hat{\mathbf{a}}_{b} & \mathbf{0}\\
\mathbf{I} & -\hat{\mathbf{b}}_{b} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & 1
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]\,.\label{eq:fbs-rsi-b-rigid}
\end{equation}

\end_inset

When node 
\begin_inset Formula $a$
\end_inset

 belongs to a rigid body, the expression for 
\begin_inset Formula $\delta W$
\end_inset

 must be substituted with
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]\\
 & =\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\omega} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}+\mathbf{f}_{a}^{w}\\
\hat{\mathbf{a}}_{a}^{n+\alpha}\cdot\mathbf{f}_{a}^{u}+\hat{\mathbf{b}}_{a}^{n+\alpha}\cdot\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-work-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Similarly, the linearized virtual work has the general form
\begin_inset Formula 
\begin{equation}
D\delta W=\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw} & \mathbf{k}_{ab}^{up}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww} & \mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu} & \mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]\,.\label{eq:fbs-rsi-D-work}
\end{equation}

\end_inset

When node 
\begin_inset Formula $a$
\end_inset

 is rigid but node 
\begin_inset Formula $b$
\end_inset

 is not,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww} & \mathbf{k}_{ab}^{up}+\mathbf{k}_{ab}^{wp}\\
\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uu}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{wu} & \hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uw}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{ww} & \hat{\mathbf{a}}_{a}\cdot\mathbf{k}_{ab}^{up}+\hat{\mathbf{b}}_{a}\cdot\mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu} & \mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\\
 & \times\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-2}
\end{equation}

\end_inset

If nodes 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 are both rigid,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww} & \left(\begin{aligned}-\left(\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu}\right)\cdot\hat{\mathbf{a}}_{b}\\
-\left(\mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww}\right)\cdot\hat{\mathbf{b}}_{b}
\end{aligned}
\right) & \mathbf{k}_{ab}^{up}+\mathbf{k}_{ab}^{wp}\\
\left(\begin{aligned}\hat{\mathbf{a}}_{a}\cdot\left(\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{uw}\right)\\
+\hat{\mathbf{b}}_{a}\cdot\left(\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{ww}\right)
\end{aligned}
\right) & \left(\begin{aligned}-\left(\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uu}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{wu}\right)\cdot\hat{\mathbf{a}}_{b}\\
-\left(\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uw}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{ww}\right)\cdot\hat{\mathbf{b}}_{b}
\end{aligned}
\right) & \hat{\mathbf{a}}_{a}\cdot\mathbf{k}_{ab}^{up}+\hat{\mathbf{b}}_{a}\cdot\mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu}+\mathbf{k}_{ab}^{pw} & \hat{\mathbf{a}}_{b}\cdot\mathbf{k}_{ab}^{pu}+\hat{\mathbf{b}}_{b}\cdot\mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\\
 & \times\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-3}
\end{equation}

\end_inset

If node 
\begin_inset Formula $a$
\end_inset

 is not rigid and node 
\begin_inset Formula $b$
\end_inset

 is rigid,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu} & -\mathbf{K}_{ab}^{uu}\cdot\hat{\mathbf{a}}_{b}-\mathbf{K}_{ab}^{uw}\cdot\hat{\mathbf{b}}_{b} & \mathbf{k}_{ab}^{up}\\
\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{ww} & -\mathbf{K}_{ab}^{wu}\cdot\hat{\mathbf{a}}_{b}-\mathbf{K}_{ab}^{ww}\cdot\hat{\mathbf{b}}_{b} & \mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu}+\mathbf{k}_{ab}^{pw} & \hat{\mathbf{a}}_{b}\cdot\mathbf{k}_{ab}^{pu}+\hat{\mathbf{b}}_{b}\cdot\mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-4}
\end{equation}

\end_inset


\end_layout

\begin_layout Chapter
Constitutive Models
\begin_inset CommandInset label
LatexCommand label
name "chap:Constitutive-Models"

\end_inset


\end_layout

\begin_layout Standard
This chapter describes the theoretical background behind the constitutive
 models that are available in FEBio.
 Most materials are derived from a hyperelastic strain-energy function.
 Please consult Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hyperelasticity"

\end_inset

 for more background information on this class of materials.
\end_layout

\begin_layout Section
Linear Elasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Linear-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
In the theory of linear elasticity the Cauchy stress tensor is a linear
 function of the small strain tensor 
\begin_inset Formula $\boldsymbol{\varepsilon}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,.\label{eq402}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order elasticity tensor that contains the material properties.
 In the most general case this tensor has 21 independent parameters.
 However, in the presence of material symmetry the number of independent
 parameters is greatly reduced.
 For example, in the case of isotropic linear elasticity only two independent
 parameters remain.
 In this case, the elasticity tensor is given by 
\begin_inset Formula $\boldsymbol{\mathcal{C}}=\lambda\mathbf{I}\otimes\mathbf{I}+2\mu\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}$
\end_inset

, or equivalently, 
\begin_inset Formula 
\begin{equation}
\mathcal{C}_{ijkl}=\lambda\delta_{ij}\delta_{kl}+\mu\left(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk}\right)\,.\label{eq403}
\end{equation}

\end_inset

The material coefficients 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are known as the Lamé parameters.
 Using this equation, the stress-strain relationship can be written as 
\begin_inset Formula 
\begin{equation}
\sigma_{ij}=\lambda\varepsilon_{kk}\delta_{ij}+2\mu\varepsilon_{ij}\,.\label{eq404}
\end{equation}

\end_inset

If the stress and strain are represented inVoigt notation, the constitutive
 equation can be rewritten in matrix form as 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
\sigma_{11}\\
\sigma_{22}\\
\sigma_{33}\\
\sigma_{12}\\
\sigma_{23}\\
\sigma_{13}
\end{array}\right]=\left[\begin{array}{cccccc}
\lambda+2\mu & \lambda & \lambda & 0 & 0 & 0\\
\lambda & \lambda+2\mu & \lambda & 0 & 0 & 0\\
\lambda & \lambda & \lambda+2\mu & 0 & 0 & 0\\
0 & 0 & 0 & \mu & 0 & 0\\
0 & 0 & 0 & 0 & \mu & 0\\
0 & 0 & 0 & 0 & 0 & \mu
\end{array}\right]\left[\begin{array}{c}
\varepsilon_{11}\\
\varepsilon_{22}\\
\varepsilon_{33}\\
\gamma_{12}\\
\gamma_{23}\\
\gamma_{13}
\end{array}\right]\,.\label{eq405}
\end{equation}

\end_inset

The shear strain measures 
\begin_inset Formula $\gamma_{ij}=2\varepsilon_{ij}$
\end_inset

 are called the 
\emph on
engineering strains
\emph default
.
\end_layout

\begin_layout Standard
The following table relates the Lamé parameters to the more familiar Young's
 modulus 
\begin_inset Formula $E$
\end_inset

 and Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 or to the bulk modulus 
\begin_inset Formula $K$
\end_inset

 and shear modulus 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda,\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $K,G$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
E=\frac{\mu}{\lambda+\mu}\left(2\mu+3\lambda\right)\\
\nu=\frac{\lambda}{2\left(\lambda+\mu\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
E=\frac{9KG}{3K+G}\\
\nu=\frac{3K-2G}{6K+2G}
\end{array}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda,\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
\lambda=\frac{\nu E}{\left(1+\nu\right)\left(1-2\nu\right)}\\
\mu=\frac{E}{2\left(1+\nu\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
\lambda=K-\frac{2}{3}G\\
\mu=G
\end{array}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $K,G$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
K=\frac{E}{3\left(1-2v\right)}\\
G=\frac{E}{2\left(1+v\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
K=\lambda+\frac{2}{3}\mu\\
G=\mu
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The theoretical range of the Young's modulus and Poisson's ratio for an
 isotropic material have the ranges 
\begin_inset Formula 
\begin{equation}
0<E<\infty\,,\label{eq406}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
-1\leqslant\nu<0.5\,.\label{eq407}
\end{equation}

\end_inset

Materials with Poisson's ratio (close to) 0.5 are known as (nearly-) incompressib
le materials.
 For these materials, the bulk modulus approaches infinity.
 Most materials have a positive Poisson's ratio.
 However there do exist some materials with a negative ratio.
 These materials are known as 
\emph on
auxetic
\emph default
 materials and they have the remarkable property that they expand under
 tension.
\end_layout

\begin_layout Standard
The linear stress-strain relationship can also be derived from a strain-energy
 function such as in the case of hyperelastic materials.
 In this case the linear strain-energy is given by 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\boldsymbol{\varepsilon}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,.\label{eq408}
\end{equation}

\end_inset

The stress is then similarly derived from 
\begin_inset Formula $\boldsymbol{\sigma}=\frac{\partial W}{\partial\boldsymbol{\mathbf{\varepsilon}}}$
\end_inset

.
 In the case of isotropic elasticity, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq408"

\end_inset

 can be simplified: 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\lambda\left(\tr\boldsymbol{\mathbf{\varepsilon}}\right)^{2}+\mu\boldsymbol{\mathbf{\varepsilon}}:\boldsymbol{\mathbf{\varepsilon}}\,.\label{eq409}
\end{equation}

\end_inset

The Cauchy stress is now given in tensor form by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\lambda\left(\tr\boldsymbol{\varepsilon}\right)\mathbf{I}+2\mu\boldsymbol{\varepsilon}\,.\label{eq410}
\end{equation}

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Compressible Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Compressible-materials"

\end_inset

 
\end_layout

\begin_layout Subsection
Isotropic Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
The linear elastic material model as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Elasticity"

\end_inset

 is only valid for small strains and small rotations.
 A first modification to this model to the range of nonlinear deformations
 is given by the St.
 Venant-Kirchhoff model 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

, which in FEBio is referred to as 
\emph on
isotropic elasticity
\emph default
.
 This model is objective for large strains and rotations.
 For the isotropic case it can be derived from the following hyperelastic
 strain-energy function: 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\lambda\left(\tr\mathbf{E}\right)^{2}+\mu\mathbf{E}:\mathbf{E}\,.\label{eq411}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress can be derived from this: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\frac{\partial W}{\partial\mathbf{E}}=\lambda\left(\tr\mathbf{E}\right)\mathbf{I}+2\mu\mathbf{E}\,.\label{eq412}
\end{equation}

\end_inset

Note that these equations are similar to the corresponding equations in
 the linear elastic case, except that the small strain tensor is replaced
 by the Green-Lagrange elasticity tensor 
\series bold

\begin_inset Formula $\mathbf{E}$
\end_inset


\series default
.
 The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\lambda\mathbf{I}\otimes\mathbf{I}+2\mu\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\,.\label{eq413}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response can be somewhat strange if not completely
 unrealistic.
 For example, it can be shown that under uni-axial tension the stress becomes
 infinite and the volume tends to zero for finite strains.
 Therefore, for large strains it is highly recommended to avoid this material
 and instead use one of the other non-linear material models described below.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{J}\left(\lambda\tr\mathbf{E}-\mu\right)\mathbf{b}+\frac{\mu}{J}\mathbf{b}^{2}\,,\label{eq414}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tr\mathbf{E}=\left(\tr\mathbf{b}-3\right)/2$
\end_inset

 , whereas the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{\lambda}{J}\mathbf{b}\otimes\mathbf{b}+\frac{2}{J}\mu\mathbf{b}\,\overline{\underline{\otimes}}\,\mathbf{b}\,.\label{eq415}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Orthotropic Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthotropic-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
An extension of the St.
 Venant-Kirchhoff model 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

 to orthotropic symmetry is provided in FEBio, referred to as 
\emph on
orthotropic elasticity
\emph default
.
 This model is objective for large strains and rotations.
 It can be derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\begin{equation}
W=\sum\limits _{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{0}:\mathbf{E}^{2}+\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\,,\label{eq416}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}^{0}=\mathbf{a}_{a}^{0}\otimes\mathbf{a}_{a}^{0}$
\end_inset

 is the structural tensor corresponding to one of the three mutually orthogonal
 planes of symmetry whose unit outward normal is 
\begin_inset Formula $\mathbf{a}_{a}^{0}$
\end_inset

 (
\begin_inset Formula $\mathbf{a}_{a}^{0}\cdot\mathbf{a}_{b}^{0}=\delta_{ab}$
\end_inset

).
 The material constants are the three shear moduli 
\begin_inset Formula $\mu_{a}$
\end_inset

 and six moduli 
\begin_inset Formula $\lambda_{ab}$
\end_inset

, where 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab}$
\end_inset

.
 They may be related to the Young's moduli 
\begin_inset Formula $E_{a}$
\end_inset

, shear moduli 
\begin_inset Formula $G_{ab}$
\end_inset

 and Poisson's ratios 
\begin_inset Formula $\nu_{ab}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\begin{array}{l}
\left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \left(\mu_{1}+\mu_{2}\right)/2 & 0 & 0\\
0 & 0 & 0 & 0 & \left(\mu_{2}+\mu_{3}\right)/2 & 0\\
0 & 0 & 0 & 0 & 0 & \left(\mu_{3}+\mu_{1}\right)/2
\end{array}\right]^{-1}=\\
\left[\begin{array}{cccccc}
1/E_{1} & -\nu_{12}/E_{1} & -\nu_{13}/E_{1} & 0 & 0 & 0\\
-\nu_{21}/E_{2} & 1/E_{2} & -\nu_{23}/E_{2} & 0 & 0 & 0\\
-\nu_{31}/E_{3} & -\nu_{32}/E_{3} & 1/E_{3} & 0 & 0 & 0\\
0 & 0 & 0 & 1/G_{12} & 0 & 0\\
0 & 0 & 0 & 0 & 1/G_{23} & 0\\
0 & 0 & 0 & 0 & 0 & 1/G_{31}
\end{array}\right]\,.
\end{array}\label{eq417}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress can be derived from this strain energy
 density function: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =\frac{\partial W}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\cdot\mathbf{E}+\mathbf{E}\cdot\mathbf{A}_{a}^{0}\right)\\
 & +\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left[\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{b}^{0}+\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\mathbf{A}_{a}^{0}\right]\,.
\end{aligned}
\label{eq418}
\end{equation}

\end_inset

Note that these equations are similar to the corresponding equations in
 the linear orthotropic elastic case, except that the small strain tensor
 is replaced by the Green-Lagrange elasticity tensor 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\,\overline{\underline{\otimes}}\,\mathbf{I}+\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{A}_{a}^{0}\right)+\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{b}^{0}+\mathbf{A}_{b}^{0}\otimes\mathbf{A}_{a}^{0}\right)\,.\label{eq419}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response can be somewhat strange if not completely
 unrealistic.
 For example, it can be shown that under uni-axial tension the stress becomes
 infinite and the volume tends to zero for finite strains.
 Therefore, for large strains it is highly recommended to avoid this material
 and instead use one of the other non-linear material models described below.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\sigma} & =\sum\limits _{a=1}^{3}\frac{\mu_{a}}{2J}\left(\mathbf{A}_{a}\cdot\left(\mathbf{b}-\mathbf{I}\right)+\left(\mathbf{b}-\mathbf{I}\right)\cdot\mathbf{A}_{a}\right)\\
 & +\frac{1}{2}\sum\limits _{b=1}^{3}\frac{\lambda_{ab}}{2J}\left[\left(\mathbf{A}_{a}:\mathbf{I}-1\right)\mathbf{A}_{b}+\left(\mathbf{A}_{b}:\mathbf{I}-1\right)\mathbf{A}_{a}\right]\,,
\end{aligned}
\label{eq420}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}=\mathbf{F}\cdot\mathbf{A}_{a}^{0}\cdot\mathbf{F}^{T}$
\end_inset

 and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\sum\limits _{a=1}^{3}\frac{\mu_{a}}{J}\left(\mathbf{A}_{a}\,\overline{\underline{\otimes}}\,\mathbf{b}+\mathbf{b}\,\overline{\underline{\otimes}}\,\mathbf{A}_{a}\right)+\frac{1}{2}\sum\limits _{b=1}^{3}\frac{\lambda_{ab}}{J}\left({\mathbf{A}_{a}\otimes\mathbf{A}_{b}+\mathbf{A}_{b}\otimes\mathbf{A}_{a}}\right)\,.\label{eq421}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Neo-Hookean Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Neo-Hookean-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This is a compressible neo-Hookean material.
 It is derived from the following hyperelastic strain energy function 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
W=\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln J+\frac{\lambda}{2}\left(\ln J\right)^{2}\,.\label{eq422}
\end{equation}

\end_inset

The parameters 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 are the Lamé parameters from linear elasticity.
 This model reduces to the isotropic linear elastic model for small strains
 and rotations.
\end_layout

\begin_layout Standard
The Cauchy stress is given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{\mu}{J}\left(\mathbf{b}-\mathbf{I}\right)+\frac{\lambda}{J}\left(\ln J\right)\mathbf{I}\,,\label{eq423}
\end{equation}

\end_inset

and the spatial elasticity tensor is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{\lambda}{J}\mathbf{I}\otimes\mathbf{I}+\frac{2}{J}\left(\mu-\lambda\ln J\right)\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\,.\label{eq424}
\end{equation}

\end_inset

The neo-Hookean material is an extension of Hooke's law for the case of
 large deformations.
 It is useable for certain plastics and rubber-like substances.
 A generalization of this model is the Mooney-Rivlin material, which is
 often used to describe the elastic response of biological tissue.
\end_layout

\begin_layout Standard
In FEBio this constitutive model uses a standard displacement-based element
 formulation and a "coupled" strain energy, so care must be taken when modeling
 materials with nearly-incompressible material behavior to avoid element
 locking.
\end_layout

\begin_layout Subsection
Ogden Unconstrained
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
The Ogden unconstrained material is defined using the following hyperelastic
 strain energy function: 
\begin_inset Formula 
\begin{equation}
W\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)=\frac{1}{2}c_{p}\left(J-1\right)^{2}+\sum\limits _{k=1}^{N}\frac{c_{k}}{m_{k}^{2}}\left(\lambda_{1}^{m_{k}}+\lambda_{2}^{m_{k}}+\lambda_{3}^{m_{k}}-3-m_{k}\ln J\right)\,.\label{eq425}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\lambda_{i}$
\end_inset

 are the principal stretches and 
\begin_inset Formula $c_{p}$
\end_inset

, 
\begin_inset Formula $c_{k}$
\end_inset

 and 
\begin_inset Formula $m_{k}$
\end_inset

 are material parameters.
\end_layout

\begin_layout Standard
The Cauchy stress tensor for this material may be obtained using the general
 formula for isotropic elasticity in principal directions given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq74"

\end_inset

, with 
\begin_inset Formula 
\begin{equation}
\sigma_{i}=c_{p}\left(J-1\right)+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left(\lambda_{i}^{m_{k}}-1\right)\,.\label{eq426}
\end{equation}

\end_inset

Similarly, the spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\sum\limits _{i=1}^{3}\left(c_{p}+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left[\left(m_{k}-2\right)\lambda_{i}^{m_{k}}+2\right]\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}c_{p}\left(2J-1\right)\left(\mathbf{a}_{i}\otimes\mathbf{a}_{j}+\mathbf{a}_{j}\otimes\mathbf{a}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{\lambda_{j}^{2}\sigma_{i}-\lambda_{i}^{2}\sigma_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{a}_{i}\,\overline{\underline{\otimes}}\,\mathbf{a}_{j}+\mathbf{a}_{j}\,\overline{\underline{\otimes}}\,\mathbf{a}_{i}\right)\,,
\end{aligned}
\label{eq427}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}_{i}=\mathbf{n}_{i}\otimes\mathbf{n}_{i}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{b}$
\end_inset

.
 In the limit when eigenvalues coincide, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\lambda_{j}\to\lambda_{i}}2\frac{\sigma_{i}\lambda_{j}^{2}-\sigma_{j}\lambda_{i}^{2}}{\lambda_{i}^{2}-\lambda_{j}^{2}}=2c_{p}\left(1-J\right)+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left[2+\left(m_{k}-2\right)\lambda_{i}^{m_{k}}\right]\,.\label{eq428}
\end{equation}

\end_inset

In the reference configuration the elasticity tensor reduces to 
\begin_inset Formula 
\begin{equation}
\left.\boldsymbol{\mathcal{C}}\right|_{\mathbf{b}=\mathbf{I}}=c_{p}\mathbf{I}\otimes\mathbf{I}+\left(\sum\limits _{k=1}^{N}c_{k}\right)\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\,,\label{eq429}
\end{equation}

\end_inset

which has the form of Hooke's law for infinitesimal isotropic elasticity
 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Elasticity"

\end_inset

), with equivalent Lamé coefficients 
\begin_inset Formula $c_{p}\equiv\lambda$
\end_inset

 and 
\begin_inset Formula $2\mu\equiv\sum\nolimits _{k=1}^{N}c_{k}$
\end_inset

.
\end_layout

\begin_layout Subsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow"

\end_inset


\end_layout

\begin_layout Standard
The coupled hyperelastic strain-energy function for this material is given
 by 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\Psi\left(I_{1},I_{2},J\right)=\frac{1}{2}c\left(e^{Q}-1\right)\,,\label{eq430}
\end{equation}

\end_inset

where 
\begin_inset Formula $I_{1}$
\end_inset

and 
\begin_inset Formula $I_{2}$
\end_inset

are the first and second invariants of the right Cauchy-Green tensor and
 
\begin_inset Formula $J$
\end_inset

the jacobian of the deformation.
 Furthermore, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Q & =\frac{\beta}{\lambda+2\mu}\left[\left(2\mu-\lambda\right)\left(I_{1}-3\right)+\lambda\left(I_{2}-3\right)-\left(\lambda+2\mu\right)\ln J^{2}\right]\,,\\
c & =\frac{\lambda+2\mu}{2\beta}\,,
\end{aligned}
\label{eq431}
\end{equation}

\end_inset

and 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are the Lamé parameters.
 The corresponding Cauchy stress tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{2J}e^{Q}\left(\left[2\mu+\lambda\left(I_{1}-1\right)\right]\mathbf{b}-\lambda\mathbf{b}^{2}-\left(\lambda+2\mu\right)\mathbf{I}\right)\,,\label{eq432}
\end{equation}

\end_inset

and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{4\beta}{\lambda+2\mu}Je^{-Q}\boldsymbol{\sigma}\otimes\boldsymbol{\sigma}+J^{-1}e^{Q}\left[\lambda\left(\mathbf{b}\otimes\mathbf{b}-\mathbf{b}\,\overline{\underline{\otimes}}\,\mathbf{b}\right)+\left(\lambda+2\mu\right)\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right]\,.\label{eq433}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Conewise Linear Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Conewise-Linear-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
Curnier et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"

\end_inset

 formulated a model for describing bimodular elastic solids exhibiting orthotrop
ic material symmetry.
 This can be derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\begin{equation}
W=\sum\limits _{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{0}:\mathbf{E}^{2}+\frac{1}{2}\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)+\sum\limits _{b=1,\,b\ne a}^{3}\frac{1}{2}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\,,\label{eq434}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}^{0}=\mathbf{a}_{a}^{0}\otimes\mathbf{a}_{a}^{0}$
\end_inset

 is the structural tensor corresponding to one of the three mutually orthogonal
 planes of symmetry whose unit outward normal is 
\begin_inset Formula $\mathbf{a}_{a}^{0}$
\end_inset

 (
\begin_inset Formula $\mathbf{a}_{a}^{0}\cdot\mathbf{a}_{b}^{0}=\delta_{ab})$
\end_inset

.
 The bimodular response is described by 
\begin_inset Formula 
\begin{equation}
\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]=\begin{cases}
\lambda_{+aa} & \mathbf{A}_{a}^{0}:\mathbf{E}\geqslant0\\
\lambda_{-aa} & \mathbf{A}_{a}^{0}:\mathbf{E}<0
\end{cases}\,.\label{eq435}
\end{equation}

\end_inset

The material constants are the three shear moduli 
\begin_inset Formula $\mu_{a}$
\end_inset

, three tensile moduli 
\begin_inset Formula $\lambda_{+aa}$
\end_inset

, three compressive moduli 
\begin_inset Formula $\lambda_{-aa}$
\end_inset

, and three moduli 
\begin_inset Formula $\lambda_{ab}$
\end_inset

 (
\begin_inset Formula $b\ne a)$
\end_inset

, where 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab}$
\end_inset

.
 The second Piola-Kirchhoff stress can be derived from this strain energy
 density function: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =\frac{\partial W}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\cdot\mathbf{E}+\mathbf{E}\cdot\mathbf{A}_{a}^{0}\right)\\
 & +\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{a}^{0}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{b}^{0}\,.
\end{aligned}
\label{eq436}
\end{equation}

\end_inset

The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\,\overline{\underline{\otimes}}\,\mathbf{I}+\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{A}_{a}^{0}\right)\\
 & +\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{a}^{0}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{b}^{0}
\end{aligned}
\,.\label{eq437}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response may be unrealistic.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\sigma} & =J^{-1}\left(\sum\limits _{a=1}^{3}\frac{\mu_{a}}{2}\left(\mathbf{A}_{a}\cdot\left(\mathbf{b}-\mathbf{I}\right)+\left(\mathbf{b}-\mathbf{I}\right)\cdot\mathbf{A}_{a}\right)\right.\\
 & \left.+\lambda_{aa}\left[K_{a}\right]K_{a}\mathbf{A}_{a}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}K_{a}\mathbf{A}_{b}\right)\,,
\end{aligned}
\label{eq438}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}=\mathbf{F}\cdot\mathbf{A}_{a}^{0}\cdot\mathbf{F}^{T}$
\end_inset

 and 
\begin_inset Formula $K_{a}=\frac{1}{2}\left({\mathbf{A}_{a}:\mathbf{I}-1}\right)$
\end_inset

.
 The spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=J^{-1}\left(\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}\,\overline{\underline{\otimes}}\,\mathbf{b}+\mathbf{b}\,\overline{\underline{\otimes}}\,\mathbf{A}_{a}\right)+\lambda_{aa}\left[K_{a}\right]\mathbf{A}_{a}\otimes\mathbf{A}_{a}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\mathbf{A}_{a}\otimes\mathbf{A}_{b}\right)\,.\label{eq439}
\end{equation}

\end_inset

In the special case of cubic symmetry the number of material constants reduces
 to four, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{+11} & =\lambda_{+22}=\lambda_{+33}\equiv\lambda_{+1}\\
\lambda_{-11} & =\lambda_{-22}=\lambda_{-33}\equiv\lambda_{-1}\\
\lambda_{12} & =\lambda_{23}=\lambda_{31}\equiv\lambda_{2}\\
\mu_{1} & =\mu_{2}=\mu_{3}\equiv\mu
\end{aligned}
\,.\label{eq440}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Donnan-Equilibrium-Swelling-1"

\end_inset


\end_layout

\begin_layout Standard
The swelling pressure is described by the equations for ideal Donnan equilibrium
, assuming that the material is porous, with a charged solid matrix, and
 the external bathing environment consists of a salt solution of monovalent
 counter-ions.
 Since osmotic swelling must be resisted by a solid material, this material
 is not stable on its own.
 It must be combined with an elastic material that resists the swelling.
\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the Donnan equilibrium
 response 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09a"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-\pi\,\mathbf{I}\,,\label{eq441}
\end{equation}

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure, given by 
\begin_inset Formula 
\begin{equation}
\pi=R\theta\left(\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right),\label{eq442}
\end{equation}

\end_inset


\begin_inset Formula $\bar{c}^{*}$
\end_inset

 is the bath osmolarity (twice the concentration) and 
\begin_inset Formula $c^{F}$
\end_inset

 is the fixed charge density in the current configuration, related to the
 reference configuration via, 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}c_{0}^{F}\,,\label{eq443}
\end{equation}

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant and 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 may be negative or positive.
 The gel porosity 
\begin_inset Formula $\varphi_{0}^{w}$
\end_inset

 is unitless and must be in the range 
\begin_inset Formula $0<\varphi_{0}^{w}<1$
\end_inset

.
 The corresponding spatial elasticity tensor is 
\begin_inset CommandInset citation
LatexCommand citep
key "Azeloglu08"

\end_inset

 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\frac{R\theta J\left(c^{F}\right)^{2}}{\left(J-1+\varphi_{0}^{w}\right)\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}}\mathbf{I}\otimes\mathbf{I}\\
 & +R\theta\left[\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right]\left(2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}-\mathbf{I}\otimes\mathbf{I}\right)\,.
\end{aligned}
\label{eq444}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Perfect Osmometer Equilibrium Osmotic Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perfect-Osmometer-Equilibrium"

\end_inset


\end_layout

\begin_layout Standard
The swelling pressure is described by the equations for a perfect osmometer,
 assuming that the material is porous, containing an interstitial solution
 whose solutes cannot be exchanged with the external bathing environment.
 Similarly, solutes in the external bathing solution cannot be exchanged
 with the interstitial fluid of the porous material.
 Therefore, osmotic pressurization occurs when there is an imbalance between
 the interstitial and bathing solution osmolarities.
 Since osmotic swelling must be resisted by a solid matrix, this material
 is not stable on its own.
 It must be combined with an elastic material that resists the swelling.
\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the perfect osmometer
 equilibrium response 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian06"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-\pi\,\mathbf{I}\,,\label{eq445}
\end{equation}

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure, given by 
\begin_inset Formula 
\begin{equation}
\pi=R\theta\left(\bar{c}-\bar{c}^{\ast}\right)\,.\label{eq446}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant and 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset

 is the external bath osmolarity and 
\begin_inset Formula $\bar{c}$
\end_inset

 is the interstitial fluid osmolarity in the current configuration, related
 to the reference configuration osmolarity 
\begin_inset Formula $\bar{c}_{0}$
\end_inset

 via, 
\begin_inset Formula 
\begin{equation}
\bar{c}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}\bar{c}_{0}\,.\label{eq447}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Though this material is porous, this is not a full-fledged poroelastic material.
 The behavior described by this material is strictly valid only after the
 transient response of interstitial fluid and solute fluxes has subsided.
 The corresponding spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=R\theta\left[\frac{J\,\bar{c}}{J-1+\varphi_{0}^{w}}\mathbf{I}\otimes\mathbf{I}+\left(\bar{c}-\bar{c}^{\ast}\right)\left(2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}-\mathbf{I}\otimes\mathbf{I}\right)\right]\,.\label{eq448}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Large Poisson's Ratio Ligament
\begin_inset CommandInset label
LatexCommand label
name "subsec:Large-Poisson-Ratio-Lig"

\end_inset


\end_layout

\begin_layout Standard
This material captures the transversely isotropic behavior of tendon and
 ligaments while enforcing a large Poisson's ratio.
 The material utilizes a three part strain energy equation: 
\begin_inset Formula 
\[
W=W_{\text{fiber}}+W_{\text{matrix}}+W_{\text{vol}}\,,
\]

\end_inset

where: 
\begin_inset Formula 
\[
\begin{aligned}W_{\text{fiber}} & =\frac{1}{2}\frac{c_{1}}{c_{2}}\left(e^{c_{2}\left(\lambda-1\right)^{2}-1}\right)\,,\\
W_{\text{matrix}} & =\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln\left(\sqrt{I_{3}}\right)\,,\\
W_{\text{vol}} & =\frac{\kappa}{2}\left(\ln\left(\frac{I_{5}-I_{1}I_{4}+I_{2}}{I_{4}^{2(m-v_{0})}e^{-4m\left(\lambda-1\right)}}\right)\right)^{2}\,.
\end{aligned}
\]

\end_inset

The transversely isotropic strain energy 
\begin_inset Formula $W_{\text{fiber}}$
\end_inset

 takes into account the behavior of the collagen fibers.
 The isotropic strain energy 
\begin_inset Formula $W_{\text{matrix}}$
\end_inset

 takes into account the mechanical contribution of the extrafibrillar matrix
 and provides the majority of support when loaded transverse to the fiber
 direction.
 The variables 
\begin_inset Formula $c_{\mathrm{1}}$
\end_inset

, 
\begin_inset Formula $c_{2}$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are material parameters controlling the stress-strain response of the material.
\end_layout

\begin_layout Standard
The volumetric strain energy 
\begin_inset Formula $W_{\text{vol}}$
\end_inset

 acts as a penalty term which enforces a Poisson's ratio based on user selection
 of the parameters 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $v_{\mathrm{0}}$
\end_inset

.
 The variable 
\begin_inset Formula $\kappa$
\end_inset

 acts as a penalty parameter.
 Raising 
\begin_inset Formula $\kappa$
\end_inset

 will cause the prescribed Poisson's ratio to be enforced.
 The Poisson's ratio in question is given by the following function: 
\begin_inset Formula 
\[
v_{\text{apparent}}=-\frac{\lambda^{m-v_{0}}e^{-m\left(\lambda-1\right)}-1}{\lambda-1}\,.
\]

\end_inset


\end_layout

\begin_layout Section
Nearly-Incompressible Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Nearly-Incompressible-Materials"

\end_inset

 
\end_layout

\begin_layout Subsection
Mooney-Rivlin Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mooney-Rivlin-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This material model is a hyperelastic Mooney-Rivlin type with uncoupled
 deviatoric and volumetric behavior.
 The uncoupled strain energy W is given by: 
\begin_inset Formula 
\begin{equation}
W=c_{1}\left(\tilde{I}_{1}-3\right)+c_{2}\left(\tilde{I}_{2}-3\right)+\frac{1}{2}K\left(\ln J\right)^{2}\,.\label{eq449}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $c_{1}$
\end_inset

 and 
\begin_inset Formula $c_{2}$
\end_inset

 are the Mooney-Rivlin material coefficients, 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the invariants of the deviatoric part of the right Cauchy-Green deformation
 tensor, 
\begin_inset Formula $\mathbf{\tilde{C}}=\mathbf{\tilde{F}}^{T}\cdot\mathbf{\tilde{F}}$
\end_inset

, where 
\begin_inset Formula $\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}$
\end_inset

, 
\series bold
\emph on

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
\emph default
 is the deformation gradient and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the Jacobian of the deformation.
 When 
\begin_inset Formula $c_{2}=0$
\end_inset

, this model reduces to an uncoupled version of the incompressible neo-Hookean
 constitutive model.
\end_layout

\begin_layout Standard
The Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\frac{2}{J}\left[\left(c_{1}+c_{2}\tilde{I}_{1}\right)\mathbf{\tilde{b}}-c_{2}\mathbf{\tilde{b}}^{2}-\frac{1}{3}\left(c_{1}\tilde{I}_{1}+2c_{2}\tilde{I}_{2}\right)\mathbf{I}\right]\,.\label{eq450}
\end{equation}

\end_inset

The spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=p\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-\frac{2}{3}\left(\dev\boldsymbol{\sigma}\otimes\mathbf{I}+\mathbf{I}\otimes\dev\boldsymbol{\sigma}\right)+\boldsymbol{\mathcal{C}}_{w}\,,\label{eq451}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}}_{w} & =\frac{4}{3J}\left(c_{1}\tilde{I}_{1}+2c_{2}\tilde{I}_{2}\right)\left(\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}-\frac{1}{3}\mathbf{I}\otimes\mathbf{I}\right)+\frac{4c_{2}}{J}\left(\mathbf{\tilde{b}}\otimes\mathbf{\tilde{b}}-\mathbf{\tilde{b}}\,\overline{\underline{\otimes}}\,\mathbf{\tilde{b}}\right)\\
 & -\frac{4c_{2}}{3J}\left[\left(\tilde{I}_{1}\mathbf{\tilde{b}}-\mathbf{\tilde{b}}^{2}\right)\otimes\mathbf{I}+\mathbf{I}\otimes\left(\tilde{I}_{1}\mathbf{\tilde{b}}-\mathbf{\tilde{b}}^{2}\right)\right]+\frac{8c_{2}\tilde{I}_{2}}{9J}\mathbf{I}\otimes\mathbf{I}\,.
\end{aligned}
\label{eq452}
\end{equation}

\end_inset

This material model uses a three-field element formulation, interpolating
 displacements as linear field variables and pressure and volume ratio as
 piecewise constant in each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"

\end_inset

.
\end_layout

\begin_layout Subsection
Ogden Hyperelastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden-Hyperelastic"

\end_inset


\end_layout

\begin_layout Standard
The Ogden material is defined using the following hyperelastic strain energy
 function: 
\begin_inset Formula 
\begin{equation}
W\left(\lambda_{1},\lambda_{2},\lambda_{3},J\right)=\sum\limits _{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\tilde{\lambda}_{1}^{m_{i}}+\tilde{\lambda}_{2}^{m_{i}}+\tilde{\lambda}_{3}^{m_{i}}-3\right)+U\left(J\right)\,.\label{eq453}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\tilde{\lambda}_{i}$
\end_inset

 are the deviatoric principal stretches and 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{i}$
\end_inset

 are material parameters.
 The term 
\begin_inset Formula $U\left(J\right)$
\end_inset

 is the volumetric component and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient.
\end_layout

\begin_layout Standard
Note that the neo-Hookean and Mooney-Rivlin models can also be obtained
 from the general Ogden strain energy function using special choices for
 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Veronda-Westmann Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Veronda-Westmann-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This model is similar to the Mooney-Rivlin model in that it also uses an
 uncoupled strain energy.
 However, in this case the strain energy is given by an exponential form:
 
\begin_inset Formula 
\begin{equation}
W=C_{1}\left[e^{\left(C_{2}\left(\tilde{I}_{1}-3\right)\right)}-1\right]-\frac{C_{1}C_{2}}{2}\left(\tilde{I}_{2}-3\right)+U\left(J\right)\,.\label{eq454}
\end{equation}

\end_inset

The dilatational term 
\begin_inset Formula $U$
\end_inset

 is identical to the Mooney-Rivlin model.
\end_layout

\begin_layout Standard
The Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is found from 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\dev\tilde{\boldsymbol{\sigma}}\,,\label{eq455}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\frac{2}{J}\left[\left(W_{1}+I_{1}W_{2}\right)\tilde{\mathbf{b}}-W_{2}\tilde{\mathbf{b}}^{2}\right]\,.\label{eq456}
\end{equation}

\end_inset

The strain energy derivatives are given by 
\begin_inset Formula 
\begin{equation}
W_{1}=C_{1}C_{2}e^{C_{2}\left(I_{1}-3\right)}\,,\label{eq457}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
W_{2}=-\frac{C_{1}C_{2}}{2}\,.\label{eq458}
\end{equation}

\end_inset

This material model was the result from the research of the elastic response
 of skin tissue 
\begin_inset CommandInset citation
LatexCommand citep
key "Veronda70"

\end_inset

.
\end_layout

\begin_layout Subsection
Arruda-Boyce Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Arruda-Boyce-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
Arruda and Boyce proposed a model for the deformation of rubber materials
 
\begin_inset CommandInset citation
LatexCommand citep
key "Arruda93"

\end_inset

.
 Their main motivation was to develop a model that accurately captures the
 behavior of rubbers in different loading scenarios and that can be described
 with a limited number of physically motivated parameters.
 Their model is based on the Langevin chain statistics, which models a rubber
 chain segment between chemical crosslinks as a number 
\begin_inset Formula $N$
\end_inset

 of rigid links of equal length 
\begin_inset Formula $l$
\end_inset

.
 The parameter 
\begin_inset Formula $N$
\end_inset

 is related to the locking stretch 
\begin_inset Formula $\lambda_{L}$
\end_inset

, the stretch at which the chains reach their full extended state, 
\begin_inset Formula $\lambda_{L}=\sqrt{N}$
\end_inset

.
\end_layout

\begin_layout Standard
Their proposed strain-energy is a truncated Taylor series of the inverse
 Langevin function.
 A formulation that retains the first five terms of this function takes
 on the following form: 
\begin_inset Formula 
\begin{equation}
\tilde{W}=\mu\sum\limits _{i=1}^{5}\frac{\alpha_{i}}{N^{i-1}}\left(\tilde{I}_{1}^{i}-3^{i}\right)+U\left(J\right)\,,\label{eq459}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is a shear-modulus like parameter and the coefficients 
\begin_inset Formula $\alpha_{i}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\alpha_{1}=\frac{1}{2}\,,\quad\alpha_{2}=\frac{1}{20}\,,\quad\alpha_{3}=\frac{11}{1050}\,,\quad\alpha_{4}=\frac{19}{7000}\,,\quad\alpha_{5}=\frac{519}{673750}\,.\label{eq460}
\end{equation}

\end_inset

The Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\frac{2}{J}\dev\left(W_{1}\mathbf{\tilde{b}}\right)=p\mathbf{I}+\frac{2W_{1}}{J}\left(\mathbf{\tilde{b}}-\frac{1}{3}\tilde{I}_{1}\mathbf{I}\right)\,,\label{eq461}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
W_{1}=\frac{\partial\tilde{W}}{\partial\tilde{I}_{1}}=\mu\sum\limits _{i=1}^{5}\alpha_{i}i\left(\frac{\tilde{I}_{1}}{N}\right)^{i-1}\,.\label{eq462}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Transversely Isotropic Hyperelastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Hyperelas-1"

\end_inset


\end_layout

\begin_layout Standard
This constitutive model can be used to represent a material that has a single
 preferred fiber direction and was developed for application to biological
 soft tissues 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96,Puso98,Quapp98"

\end_inset

.
 It can be used to model tissues such as tendons, ligaments and muscle.
 The elastic response of the tissue is assumed to arise from the resistance
 of the fiber family and an isotropic matrix.
 It is assumed that the strain energy function can be written as follows:
 
\begin_inset Formula 
\begin{equation}
W=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+F_{2}\left(\tilde{\lambda}\right)+\frac{K}{2}\left[\ln\left(J\right)\right]^{2}\,.\label{eq463}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the first and second invariants of the deviatoric version of the right
 Cauchy Green deformation tensor 
\begin_inset Formula $\mathbf{\tilde{C}}$
\end_inset

 and 
\begin_inset Formula $\tilde{\lambda}$
\end_inset

 is the deviatoric part of the stretch along the fiber direction (
\begin_inset Formula $\tilde{\lambda}^{2}=\mathbf{A}\cdot\mathbf{\tilde{C}}\cdot\mathbf{A}$
\end_inset

, where 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is the initial fiber direction).
 The function 
\begin_inset Formula $F_{1}$
\end_inset

 represents the material response of the isotropic ground substance matrix,
 while 
\begin_inset Formula $F_{2}$
\end_inset

represents the contribution from the fiber family.
 The strain energy of the fiber family is as follows: 
\begin_inset Formula 
\begin{equation}
\tilde{\lambda}\frac{\partial F_{2}}{\partial\tilde{\lambda}}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\tilde{\lambda}-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}+C_{6}\tilde{\lambda} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.\label{eq464}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\lambda_{m}$
\end_inset

 is the stretch at which the fibers are straightened, 
\begin_inset Formula $C_{3}$
\end_inset

 scales the exponential stresses, 
\begin_inset Formula $C_{4}$
\end_inset

 is the rate of uncrimping of the fibers, and 
\begin_inset Formula $C_{5}$
\end_inset

 is the modulus of the straightened fibers.
 
\begin_inset Formula $C_{6}$
\end_inset

 is determined from the requirement that the stress is continuous at 
\begin_inset Formula $\lambda_{m}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
C_{6}=\frac{1}{\lambda_{m}}\left[C_{3}\left(e^{C_{4}\left(\lambda_{m}-1\right)}-1\right)-C_{5}\right]\,.\label{eq464b}
\end{equation}

\end_inset

It also follows that
\begin_inset Formula 
\begin{equation}
F_{2}\left(\tilde{\lambda}\right)=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{-C_{4}}\left[\Ei\left(C_{4}\tilde{\lambda}\right)-\Ei\left(C_{4}\right)\right]-\ln\tilde{\lambda}\right) & 1<\tilde{\lambda}<\lambda_{m}\\
\left(C_{5}+\frac{C_{6}}{2}\tilde{\lambda}\right)\tilde{\lambda}+C_{7} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,,\label{eq464c}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
C_{7}=C_{3}\left(e^{-C_{4}}\left[\Ei\left(C_{4}\lambda_{m}\right)-\Ei\left(C_{4}\right)\right]-\ln\lambda_{m}\right)-\left(C_{5}+\frac{C_{6}}{2}\lambda_{m}\right)\lambda_{m}\,.\label{eq464d}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This material model uses a three-field element formulation, interpolating
 displacements as linear field variables and pressure and volume ratio as
 piecewise constant on each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"

\end_inset

.
\end_layout

\begin_layout Subsection
Ellipsoidal Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ellipsoidal-Fiber-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This constitutive model describes a material that is composed of an ellipsoidal
 continuous fiber distribution in an uncoupled formulation.
 The deviatoric part of the stress is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09a,Ateshian07a,Lanir83"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\boldsymbol{\sigma}}_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,,\label{eq465}
\end{equation}

\end_inset

and the corresponding elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\boldsymbol{\mathcal{C}}}_{n}\left(\mathbf{n}\right)\sin\phi\,d\phi\,d\theta\,.\label{eq466}
\end{equation}

\end_inset


\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\mathbf{F}$
\end_inset

, 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction (in the reference configuration),
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

, 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}$
\end_inset

 and 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber stress is determined from a fiber strain energy function in the
 usual manner: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}_{n}\left(\mathbf{n}\right)=2J^{-1}\tilde{I}_{n}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq467}
\end{equation}

\end_inset

whereas the fiber elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}_{n}\left(\mathbf{n}\right)=4J^{-1}\tilde{I}_{n}^{2}\frac{\partial^{2}\tilde{\Psi}}{\partial\tilde{I}_{n}^{2}}\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\,,\label{eq468}
\end{equation}

\end_inset

where in this material 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}\left(\mathbf{n},\tilde{I}_{n}\right)=\xi\left(\mathbf{n}\right)\left(\tilde{I}_{n}-1\right)^{\beta\left(\mathbf{n}\right)}\,.\label{eq469}
\end{equation}

\end_inset

The materials parameters 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\xi$
\end_inset

 are determined from: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\,,\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}\,.
\end{aligned}
\label{eq470}
\end{equation}

\end_inset

Since fibers can only sustain tension, this material is not stable on its
 own.
 It must be combined with a material that acts as the ground matrix.
 The total stress is then given by the sum of the fiber stress and the ground
 matrix stress: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{m}+\tilde{\boldsymbol{\sigma}}_{f}\,.\label{eq471}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Fiber with Exponential Power law
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Exponential-Power"

\end_inset


\end_layout

\begin_layout Standard
This material model describes a constitutive model for fibers, where a single
 fiber family follows an exponential power law strain energy function.
 The deviatoric part of the Cauchy stress is given by: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=2J^{-1}H\left(\tilde{I}_{n}-1\right)\tilde{I}_{n}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq472}
\end{equation}

\end_inset

and the corresponding spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=4J^{-1}H\left(\tilde{I}_{n}-1\right)\tilde{I}_{n}^{2}\frac{\partial^{2}\tilde{\Psi}}{\partial\tilde{I}_{n}^{2}}\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\,,\label{eq473}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch, 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the fiber orientation in the reference configuration, 
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3}\,,\label{eq474}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}$
\end_inset

 and 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber strain energy density is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(\tilde{I}_{n}-1\right)^{\beta}\right]-1\right)\,,\label{eq475}
\end{equation}

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

, 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
\end_layout

\begin_layout Standard
Note: In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

, this expression produces a power law, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\alpha\to0}\tilde{\Psi}=\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta}\,.\label{eq476}
\end{equation}

\end_inset

Note: When 
\begin_inset Formula $\beta>2$
\end_inset

, the fiber modulus is zero at the strain origin (
\begin_inset Formula $\tilde{I}_{n}=1)$
\end_inset

.
 Therefore, use 
\begin_inset Formula $\beta>2$
\end_inset

when a smooth transition in the stress is desired from compression to tension.
\end_layout

\begin_layout Subsection
Fung Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fung-Orthotropic"

\end_inset


\end_layout

\begin_layout Standard
The hyperelastic strain energy function for a Fung Orthotropic material
 is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung93,Fung79"

\end_inset

 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}=\frac{1}{2}c\left(e^{\tilde{Q}}-1\right)+U\left(J\right)\,,\label{eq477}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{Q}=c^{-1}\sum\limits _{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{\tilde{E}}^{2}+\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{\tilde{E}}\right)\left(\mathbf{M}_{b}:\mathbf{\tilde{E}}\right)\right]\,.\label{eq478}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{\tilde{E}}=\frac{1}{2}\left(\mathbf{\tilde{C}}-\mathbf{I}\right)$
\end_inset

 and 
\begin_inset Formula $\mathbf{M}_{a}=\mathbf{A}_{a}\otimes\mathbf{A}_{a}$
\end_inset

, where 
\begin_inset Formula $\mathbf{A}_{a}$
\end_inset

 are orthonormal vectors that define the initial direction of material axes.
 The orthotropic Lamé coefficients should be chosen such that the stiffness
 matrix, 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]\label{eq479}
\end{equation}

\end_inset

is positive definite.
\end_layout

\begin_layout Subsection
Tension-Compression Nonlinear Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:TC-Nonlinear-Orthotropic"

\end_inset


\end_layout

\begin_layout Standard
This material model is based on the following uncoupled hyperelastic strain
 energy function 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07c"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\lambda_{1},\lambda_{2},\lambda_{3}\right)=\tilde{\Psi}_{\text{iso}}\left(\mathbf{\tilde{C}}\right)+\sum\limits _{i=1}^{3}\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)+U\left(J\right)\,.\label{eq480}
\end{equation}

\end_inset

The isotropic strain energy 
\begin_inset Formula $\tilde{\Psi}_{\text{iso}}$
\end_inset

 and the dilatational energy 
\begin_inset Formula $U$
\end_inset

 are the same as for the Mooney-Rivlin material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin-Hyperelasticity"

\end_inset

).
 The tension-compression term is defined as follows: 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)=\begin{cases}
\xi_{i}\left(\tilde{\lambda}_{i}-1\right)^{\beta_{i}} & \tilde{\lambda}_{i}>1\\
0 & \tilde{\lambda}_{i}\leqslant1
\end{cases}\,,\xi_{i}\geqslant0\quad\mbox{(no sum over }i\text{).}\label{eq481}
\end{equation}

\end_inset

The 
\begin_inset Formula $\tilde{\lambda}_{i}$
\end_inset

 parameters are the deviatoric fiber stretches of the local material fibers,
 
\begin_inset Formula 
\begin{equation}
\tilde{\lambda}_{i}=\left(\mathbf{A}_{i}\cdot\mathbf{\tilde{C}}\cdot\mathbf{A}_{i}\right)^{1/2}\,.\label{eq482}
\end{equation}

\end_inset

The local material fibers are defined (in the reference frame) as an orthonormal
 set of vectors 
\begin_inset Formula $\mathbf{A}_{i}$
\end_inset

.
 The corresponding deviatoric part of the Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=J^{-1}\sum\limits _{i=1}^{3}\frac{1}{\tilde{\lambda}_{i}}\frac{\partial\tilde{\Psi}}{\partial\tilde{\lambda}_{i}}\mathbf{a}_{i}\otimes\mathbf{a}_{i}\,,\label{eq483}
\end{equation}

\end_inset

and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=J^{-1}\sum\limits _{i=1}^{3}\frac{1}{\tilde{\lambda}_{i}}\frac{\partial}{\partial\tilde{\lambda}_{i}}\left(\frac{1}{\tilde{\lambda}_{i}}\frac{\partial\tilde{\Psi}}{\partial\tilde{\lambda}_{i}}\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\otimes\mathbf{a}_{i}\otimes\mathbf{a}_{i}\,,\label{eq484}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}_{i}=\mathbf{\tilde{F}}\cdot\mathbf{A}_{i}$
\end_inset

.
\end_layout

\begin_layout Section
Viscoelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Viscoelasticity"

\end_inset


\end_layout

\begin_layout Standard
For a viscoelastic material the second Piola Kirchhoff stress can be written
 as follows 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso98"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}\left(t\right)=\int\limits _{-\infty}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}}{ds}\,ds\,,\label{eq485}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the elastic stress and 
\begin_inset Formula $G(t)$
\end_inset

 is the relaxation function.
 Here we consider the special case where the relaxation function is given
 by 
\begin_inset Formula 
\begin{equation}
G\left(t\right)=\gamma_{0}+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right)\,.\label{eq486}
\end{equation}

\end_inset

With this function chosen for the relaxation function, we can write the
 total stress as 
\begin_inset Formula 
\begin{equation}
\mathbf{S}\left(t\right)=\int\limits _{-\infty}^{t}\left(\gamma_{0}+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(\left(-t+s\right)/\tau_{i}\right)\frac{d\mathbf{S}^{e}}{ds}\right)\,ds\,.\label{eq487}
\end{equation}

\end_inset

Introducing the internal variables, 
\begin_inset Formula 
\begin{equation}
\mathbf{H}^{\left(i\right)}\left(t\right)=\int\limits _{-\infty}^{t}\exp\left[-\left(t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\,,\label{eq488}
\end{equation}

\end_inset

we can rewrite 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq487"

\end_inset

 as follows, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}\left(t\right)=\gamma_{0}\mathbf{S}^{e}\left(t\right)+\sum\limits _{i=1}^{N}\gamma_{i}\mathbf{H}^{\left(i\right)}\left(t\right)\,.\label{eq489}
\end{equation}

\end_inset

In FEBio, 
\begin_inset Formula $\gamma_{0}=1$
\end_inset

, so 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the long-term elastic response of the material.
\end_layout

\begin_layout Standard
The question now remains how to evaluate the internal variables.
 From equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq488"

\end_inset

 it appears that we have to integrate over the entire time domain.
 However, we can find a recurrence relationship that will allow us to evaluate
 the internal variables at a time 
\begin_inset Formula $t+\Delta t$
\end_inset

 given the values at time 
\begin_inset Formula $t$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{H}^{\left(i\right)}\left(t+\Delta t\right) & =\int\limits _{-\infty}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\\
 & =\exp\left(-\Delta t/\tau_{i}\right)\int\limits _{-\infty}^{t}\exp\left[-\left(t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds+\int\limits _{t}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\\
 & =\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}^{\left(i\right)}\left(t\right)+\int\limits _{t}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\,.
\end{aligned}
\label{eq490}
\end{equation}

\end_inset

The last term can now be simplified using the midpoint rule to approximate
 the derivate.
 In that case we find the recurrence relation: 
\begin_inset Formula 
\begin{equation}
\mathbf{H}^{\left(i\right)}\left(t+\Delta t\right)=\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}^{\left(i\right)}\left(t\right)+\frac{1-\exp\left(-\Delta t/\tau_{i}\right)}{\Delta t/\tau_{i}}\left(\mathbf{S}^{e}\left(t+\Delta t\right)-\mathbf{S}^{e}\left(t\right)\right)\,.\label{eq491}
\end{equation}

\end_inset

The following procedure can now be applied to calculate the new stress.
 Given 
\begin_inset Formula $\mathbf{S}_{n}^{e}$
\end_inset

 and 
\begin_inset Formula $\mathbf{H}_{n}^{\left(i\right)}$
\end_inset

 corresponding to time 
\begin_inset Formula $t$
\end_inset

, find 
\begin_inset Formula $\mathbf{S}_{n+1}^{e}$
\end_inset

 and 
\begin_inset Formula $\mathbf{H}_{n+1}^{\left(i\right)}$
\end_inset

 corresponding to time 
\begin_inset Formula $t+\Delta t$
\end_inset

:
\end_layout

\begin_layout Enumerate
calculate elastic stress: 
\begin_inset Formula 
\[
\mathbf{S}_{n+1}^{e}=\frac{\partial W^{e}}{\partial\mathbf{C}_{n+1}}\,,
\]

\end_inset

 
\end_layout

\begin_layout Enumerate
evaluate internal variables: 
\begin_inset Formula 
\[
\mathbf{H}_{n+1}^{i}=\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}_{n}^{i}+\frac{1-\exp\left(-\Delta t/\tau_{i}\right)}{\Delta t/\tau_{i}}\left(\mathbf{S}_{n+1}^{e}-\mathbf{S}_{n}^{e}\right)\,,
\]

\end_inset

 
\end_layout

\begin_layout Enumerate
find the total stress: 
\begin_inset Formula 
\[
\mathbf{S}_{n+1}=\gamma_{0}\mathbf{S}_{n+1}^{e}+\sum\limits _{i=1}^{N}\gamma_{i}\mathbf{H}_{n+1}^{i}\,.
\]

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Viscoelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Viscoelasticity"

\end_inset


\end_layout

\begin_layout Standard
Reactive viscoelasticity models a material as a mixture of strong bonds,
 which are permanent, and weak bonds, which break and reform in response
 to loading 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian15"

\end_inset

.
 Strong bonds produce the equilibrium elastic response, whereas weak bonds
 produce the transient viscous response.
 Strong bonds are in a stress-free state when in their reference configuration
 
\begin_inset Formula $\mathbf{X}$
\end_inset

.
 Their deformation gradient is defined as usual, 
\begin_inset Formula $\mathbf{F}\left(\mathbf{X},t\right)=\partial\boldsymbol{\chi}\left(\mathbf{X},t\right)/\partial\mathbf{X}$
\end_inset

.
 When weak bonds break in response to loading at some time 
\begin_inset Formula $u$
\end_inset

, they reform instantaneously in a stress-free configuration 
\begin_inset Formula $\mathbf{X}^{u}$
\end_inset

 that coincides with the current configuration at time 
\begin_inset Formula $u$
\end_inset

, thus, 
\begin_inset Formula $\mathbf{X}^{u}=\boldsymbol{\chi}\left(\mathbf{X},u\right)$
\end_inset

.
 Therefore, a reaction transforms intact loaded bonds into reformed unloaded
 bonds.
 Weak bonds that reform at time 
\begin_inset Formula $u$
\end_inset

 may be called 
\begin_inset Formula $u-$
\end_inset

generation bonds.
 The deformation gradient of 
\begin_inset Formula $u-$
\end_inset

generation weak bonds relative to their reference configuration 
\begin_inset Formula $\mathbf{X}^{u}$
\end_inset

 is denoted by 
\begin_inset Formula $\mathbf{F}^{u}\left(\mathbf{X},t\right)$
\end_inset

, which may be evaluated from the chain rule, 
\begin_inset Formula 
\begin{equation}
\mathbf{F}\left(\mathbf{X},t\right)=\mathbf{F}^{u}\left(\mathbf{X},t\right)\cdot\mathbf{F}\left(\mathbf{X},u\right)\,.\label{eq492}
\end{equation}

\end_inset

The strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 in a reactive viscoelastic material is given by 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\sum\limits _{u}w^{u}\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)\,,\label{eq493}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{r}^{e}$
\end_inset

 is the strain energy density of strong bonds and 
\begin_inset Formula $\Psi_{0}^{b}$
\end_inset

 is the strain energy density of weak bonds, when they all belong to the
 same generation.
 In this expression, 
\begin_inset Formula $w^{u}\left(\mathbf{X},t\right)$
\end_inset

 is the mass fraction of 
\begin_inset Formula $u-$
\end_inset

generation weak bonds, which evolves over time as described below.
 The summation is taken over all generations 
\begin_inset Formula $u$
\end_inset

 that were created prior to the current time 
\begin_inset Formula $t$
\end_inset

.
 The Cauchy stress 
\begin_inset Formula $\sigma$
\end_inset

 in a reactive viscoelastic material is similarly given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}\left(\mathbf{F}\right)=\boldsymbol{\sigma}^{e}\left(\mathbf{F}\right)+\sum\limits _{u}w^{u}\boldsymbol{\sigma}^{b}\left(\mathbf{F}^{u}\right)\,,\label{eq494}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma^{e}$
\end_inset

 is the stress in the strong bonds and 
\begin_inset Formula $\sigma^{b}$
\end_inset

 is the stress in the weak bonds.
 These stresses are related to the respective strain energy densities of
 strong and weak bonds according to 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{e}\left(\mathbf{F}\right)=\frac{1}{J}\frac{\partial\Psi_{r}^{e}\left(\mathbf{F}\right)}{\partial\mathbf{F}}\cdot\mathbf{F}^{T},\quad\boldsymbol{\sigma}^{b}\left(\mathbf{F}^{u}\right)=\frac{1}{J}\frac{\partial\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)}{\partial\mathbf{F}^{u}}\cdot\left(\mathbf{F}^{u}\right)^{T}\,.\label{eq495}
\end{equation}

\end_inset

The mass fractions 
\begin_inset Formula $w^{u}\left(\mathbf{X},t\right)$
\end_inset

 are obtained by solving the equation of mass balance for reactive constrained
 mixtures, 
\begin_inset Formula 
\begin{equation}
\frac{\partial w^{u}}{\partial t}=\hat{w}^{u}\left(\mathbf{F},w^{\gamma}\right)\,,\label{eq496}
\end{equation}

\end_inset

where the mass fraction supply 
\begin_inset Formula $\hat{w}^{u}$
\end_inset

 must be specified as a constitutive function of the deformation gradient
 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and the mass fractions 
\begin_inset Formula $w^{\gamma}$
\end_inset

 from all generations.
 Since mass must be conserved over all generations, it follows that 
\begin_inset Formula 
\begin{equation}
\sum\limits _{u}\hat{w}^{u}=0,\quad\sum\limits _{u}w^{u}=1\,.\label{eq497}
\end{equation}

\end_inset

Any number of valid solutions may exist for 
\begin_inset Formula $w^{u}$
\end_inset

, based on constitutive assumptions for 
\begin_inset Formula $\hat{w}^{u}$
\end_inset

.
 For example, for 
\begin_inset Formula $u-$
\end_inset

generation bonds reforming in an unloaded state during the time interval
 
\begin_inset Formula $u\leqslant t<v$
\end_inset

, and subsequently breaking in response to loading at 
\begin_inset Formula $t=v$
\end_inset

, Type I bond kinetics provides a solution of the form 
\begin_inset Formula 
\begin{equation}
w^{u}\left(\mathbf{X},t\right)=\begin{cases}
0 & t<u\\
f^{u}\left(\mathbf{X},t\right) & u\leqslant t<v\\
f^{u}\left(\mathbf{X},v\right)g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right) & v\leqslant t
\end{cases}\,,\label{eq498}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
f^{u}\left(\mathbf{X},t\right)=1-\sum\limits _{\gamma<u}w^{\gamma}\left(\mathbf{X},t\right)\,,\label{eq499}
\end{equation}

\end_inset

and 
\begin_inset Formula $g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 is a reduced relaxation function which may assume any number of valid forms.
 (A reduced relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

 satisfies 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

 and 
\begin_inset Formula $g\left(t\to\infty\right)=0$
\end_inset

, and decreases monotonically with 
\begin_inset Formula $t$
\end_inset

.) In particular, 
\begin_inset Formula $g$
\end_inset

 may depend on the strain at time 
\begin_inset Formula $v$
\end_inset

 relative to the reference configuration of the 
\begin_inset Formula $u-$
\end_inset

generation.
 In the recursive expression of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq498"

\end_inset

, the earliest generation 
\begin_inset Formula $u=-\infty$
\end_inset

, which is initially at rest, produces 
\begin_inset Formula $w^{u}\left(t\right)=1$
\end_inset

 for 
\begin_inset Formula $t<v$
\end_inset

 and 
\begin_inset Formula $w^{u}\left(t\right)=g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 for 
\begin_inset Formula $t\geqslant v$
\end_inset

; this latter expression seeds the recursion for subsequent generations.
 Therefore, providing a functional form for 
\begin_inset Formula $g$
\end_inset

 suffices to produce the solution for all bond generations 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard
For Type II bond kinetics, the solution for the mass fractions is given
 by 
\begin_inset Formula 
\begin{equation}
w^{u}\left(t\right)=\begin{cases}
0 & t<u\\
1-g\left(t-u\right) & u\leqslant t<v\\
g\left(t-v\right)-g\left(t-u\right) & v\leqslant t
\end{cases}\,.\label{eq500}
\end{equation}

\end_inset

For this type of bond kinetics, the reduced relaxation function 
\begin_inset Formula $g$
\end_inset

 cannot depend on the magnitude of the strain, because strain-dependence
 might violate the constraint 
\begin_inset Formula $0\leqslant w^{u}\leqslant1$
\end_inset

.
\end_layout

\begin_layout Standard
For all bond kinetics, it is also possible to constrain the occurrence of
 the breaking-and-reforming reaction to specific forms of the strain.
 For example, the reaction may be allowed to proceed only in the case of
 dilatational strain, or only in the case of distortional strain.
\end_layout

\begin_layout Standard
The finite element implementation of reactive viscoelasticity stores the
 value of 
\begin_inset Formula $\mathbf{F}^{-1}\left(\mathbf{X},u\right)$
\end_inset

 every time that a bond-breaking deformation is detected; this value can
 be used to evaluate 
\begin_inset Formula $\mathbf{F}^{u}\left(\mathbf{X},t\right)$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq492"

\end_inset

.
 It also stores 
\begin_inset Formula $w^{u}\left(\mathbf{X},v\right)=f^{u}\left(\mathbf{X},v\right)$
\end_inset

, where 
\begin_inset Formula $v$
\end_inset

 is the time step immediately following 
\begin_inset Formula $u$
\end_inset

, which is then used for evaluating 
\begin_inset Formula $w^{u}$
\end_inset

 for subsequent time steps 
\begin_inset Formula $t>v$
\end_inset

 when using Type I bond kinetics, using the expressions of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq498"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq499"

\end_inset

.
 These measures are then used to evaluate the stress from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq494"

\end_inset

, with the summation taken over the time steps that correspond to bond-reforming
 generations.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Hydraulic Permeability
\begin_inset CommandInset label
LatexCommand label
name "sec:Hydraulic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
Hydraulic permeability is a material function needed for biphasic and biphasic-s
olute materials.
\end_layout

\begin_layout Subsection
Constant Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is isotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k\,\mathbf{I}\,.\label{eq501}
\end{equation}

\end_inset

For this material model, 
\begin_inset Formula $k$
\end_inset

 is constant.
 Generally, this assumption is only reasonable when strains are small.
\end_layout

\begin_layout Subsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow-permeability"

\end_inset


\end_layout

\begin_layout Standard
This isotropic material is similar to the constant isotropic permeability
 material described above, except that it uses a strain-dependent permeability
 tensor 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k\left(J\right)\mathbf{I}\,,\label{eq502}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
k\left(J\right)=k_{0}\left(\frac{J-\varphi_{0}}{1-\varphi_{0}}\right)^{\alpha}e^{\frac{1}{2}M\left(J^{2}-1\right)}\,.\label{eq503}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Referentially Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Permeabi"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that accommodates
 strain-induced anisotropy 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=\left(k_{0r}\mathbf{I}+\frac{k_{1r}}{J^{2}}\mathbf{b}+\frac{k_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2}\,,\label{eq504}
\end{equation}

\end_inset

Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is isotropic and given by 
\begin_inset Formula $\mathbf{k}=\left(k_{0r}+k_{1r}+k_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Orthotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Permea"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that is orthotropic
 in the reference configuration, and accommodates strain-induced anisotropy
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k_{0}\mathbf{I}+\sum\limits _{a=1}^{3}k_{1}^{a}\mathbf{m}_{a}+k_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,\label{eq505}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & k_{0}=k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\,,\\
 & k_{1}^{a}=\frac{k_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\,,\\
 & k_{2}^{a}=\frac{k_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}\,.
\end{aligned}
\quad a=1,2,3\label{eq506}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensors representing the spatial structural tensors describing
 the orthogonal planes of symmetry, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,\label{eq507}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Transversely Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-TISO-permeability"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that is transversely
 isotropic in the reference configuration, and accommodates strain-induced
 anisotropy 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{0}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\mathbf{I}\\
 & +\left(\frac{k_{1r}^{T}}{J^{2}}\left(\mathbf{b}-\mathbf{m}\right)+\frac{k_{2r}^{T}}{2J^{4}}\left[2\mathbf{b}^{2}-\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right]\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{T}}e^{M_{T}\left(J^{2}-1\right)/2}\\
 & +\left(\frac{1}{J^{2}}k_{1r}^{A}\mathbf{m}+\frac{1}{2J^{4}}k_{2r}^{A}\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{A}}e^{M_{A}\left(J^{2}-1\right)/2}\,,
\end{aligned}
\label{eq508}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{m}$
\end_inset

 is a second order tensor representing the spatial structural tensor describing
 the axial direction, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}=\mathbf{F}\cdot\left(\mathbf{V}\otimes\mathbf{V}\right)\cdot\mathbf{F}^{T}\,,\label{eq509}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is a unit vector along the axial direction.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=\left(k_{0r}+k_{1r}^{T}+k_{2r}^{T}\right)\mathbf{I}+\left(k_{1r}^{A}-k_{1r}^{T}+k_{2r}^{A}-k_{2r}^{T}\right)\left(\mathbf{V}\otimes\mathbf{V}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Solute Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "sec:Solute-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
Diffusivity materials provide a constitutive relation for the solute diffusivity
 in a biphasic-solute material.
 In general, the diffusivity tensor 
\begin_inset Formula $\mathbf{d}$
\end_inset

 may be a function of strain and solute concentration.
\end_layout

\begin_layout Subsection
Constant Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is isotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=d\,\mathbf{I}\,.\label{eq510}
\end{equation}

\end_inset

For this material model, 
\begin_inset Formula $d$
\end_inset

 is constant.
 This assumption is only true when strains are small.
 Note that the user must specify 
\begin_inset Formula $d\leqslant d_{0}$
\end_inset

, where 
\begin_inset Formula $d_{0}$
\end_inset

 is the solute diffusivity in free solution, since a solute cannot diffuse
 through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Subsection
Constant Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Orthotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is orthotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\sum\limits _{a=1}^{3}d^{a}\mathbf{V}_{a}\otimes\mathbf{V}_{a}\,,\label{eq511}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 For this material model, the 
\begin_inset Formula $d^{a}$
\end_inset

 are constant.
 Therefore this model should be used only when strains are small.
 Note that the user must specify 
\begin_inset Formula $d^{a}\leqslant d_{0}$
\end_inset

, where 
\begin_inset Formula $d_{0}$
\end_inset

 is the solute diffusivity in free solution, since a solute cannot diffuse
 through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Subsection
Referentially Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Diffusiv"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that is isotropic
 in the reference configuration and accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left(d_{0r}\mathbf{I}+\frac{d_{1r}}{J^{2}}\mathbf{b}+\frac{d_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2},\label{eq512}
\end{equation}

\end_inset

where 
\begin_inset Formula $J$
\end_inset

 is the jacobian of the deformation, i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient, and 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 Note that the diffusivity in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is isotropic and given by 
\begin_inset Formula $\mathbf{d}=\left(d_{0r}+d_{1r}+d_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Diffus"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that is orthotropic
 in the reference configuration and accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=d_{0}\mathbf{I}+\sum\limits _{a=1}^{3}d_{1}^{a}\mathbf{m}_{a}+d_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,\label{eq513}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}d_{0} & =d_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\,,\\
d_{1}^{a} & =\frac{d_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\,,\\
d_{2}^{a} & =\frac{d_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}\,.
\end{aligned}
\quad a=1,2,3\label{eq514}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation, i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where
\series bold
 
\series default

\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensor representing the spatial structural tensors describing
 the orthogonal planes of symmetry, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3\,,\label{eq515}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Solute Solubility
\begin_inset CommandInset label
LatexCommand label
name "sec:Solute-Solubility"

\end_inset


\end_layout

\begin_layout Standard
Solubility constitutive equations provide a relation for 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 as a function of solid matrix strain and effective solute concentrations.
\end_layout

\begin_layout Subsection
Constant Solubility
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Solubility"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 is constant.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Osmotic Coefficient
\begin_inset CommandInset label
LatexCommand label
name "sec:Osmotic-Coefficient"

\end_inset


\end_layout

\begin_layout Standard
Osmotic coefficient constitutive equations provide a relation for 
\begin_inset Formula $\Phi$
\end_inset

 as a function of solid matrix strain and effective solute concentrations.
\end_layout

\begin_layout Subsection
Constant Osmotic Coefficient
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Osmotic-Coefficient"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $\Phi$
\end_inset

 is constant.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Active Contraction Model
\begin_inset CommandInset label
LatexCommand label
name "sec:Active-Contraction-Model"

\end_inset


\end_layout

\begin_layout Standard
A time varying 
\begin_inset Quotes eld
\end_inset

elastance
\begin_inset Quotes erd
\end_inset

 active contraction model 
\begin_inset CommandInset citation
LatexCommand citep
key "Guccione91"

\end_inset

 was added to the transversely isotropic materials.
 When active contraction is activated, the total Cauchy stress 
\begin_inset Formula $\mathbf{\sigma}$
\end_inset

is defined as the sum of the active stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}^{a}=T^{a}\mathbf{a}\otimes\mathbf{a}$
\end_inset

 and the passive stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}^{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\boldsymbol{\sigma}^{p}+\boldsymbol{\sigma}^{a},\label{eq516}
\end{equation}

\end_inset

where 
\series bold
\emph on
a
\series default
\emph default
 is the deformed fiber vector (unit length), defined as 
\begin_inset Formula $\lambda\mathbf{a}=\mathbf{F}\cdot\mathbf{a}$
\end_inset

.
 The time varying elastance model is a modification of the standard Hill
 equation that scales the standard equation by an activation curve 
\begin_inset Formula $C\left(t\right)$
\end_inset

.
 The active fiber stress 
\begin_inset Formula $T^{a}$
\end_inset

 is defined as: 
\begin_inset Formula 
\begin{equation}
T^{a}=T_{\max}\frac{Ca_{0}^{2}}{Ca_{0}^{2}+ECa_{50}^{2}}C\left(t\right),\label{eq517}
\end{equation}

\end_inset

where 
\begin_inset Formula $T_{max}=135.7\,\text{kPa}$
\end_inset

 is the isometric tension under maximal activation at the peak intracellular
 calcium concentration of
\emph on
 
\begin_inset Formula $\text{Ca}_{0}=4.35\,\mu\text{M}$
\end_inset


\emph default
.
 The length dependent calcium sensitivity is governed by the following equation:
 
\begin_inset Formula 
\begin{equation}
ECa_{50}=\frac{\left(\text{Ca}_{0}\right)_{\max}}{\sqrt{\exp\left[B(l-l_{0})\right]-1}}\,,\label{eq518}
\end{equation}

\end_inset

where 
\begin_inset Formula $\left(\text{Ca}_{0}\right)_{\max}=4.35\,\mu\text{M}$
\end_inset

 is the maximum peak intracellular calcium concentration, 
\begin_inset Formula $B=4.75\,\mu\text{m}^{-1}$
\end_inset

 governs the shape of the peak isometric tension-sarcomere length relation,
 
\begin_inset Formula $l_{0}=1.58\,\mu\text{m}$
\end_inset

 is the sarcomere length at which no active tension develops, and 
\begin_inset Formula $l$
\end_inset

 is the sarcomere length which is the product of the fiber stretch 
\begin_inset Formula $\lambda$
\end_inset

 and the sarcomere unloaded length 
\begin_inset Formula $l_{r}=2.04\,\mu\text{m}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Prescribed Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "sec:Prescribed-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
Prescribed active contraction models allow the user to directly specify
 the time history of the active contractile stress.
\end_layout

\begin_layout Subsection
Uniaxial Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uniaxial-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
For this model, the active stress is acting along a prescribed direction
 given by the unit vector 
\begin_inset Formula $\mathbf{a}_{r}$
\end_inset

 in the reference configuration.
 The 
\begin_inset Formula $2^{\text{nd}}$
\end_inset

 Piola-Kirchhoff stress is 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\mathbf{a}_{r}\otimes\mathbf{a}_{r}\,,\label{eq519}
\end{equation}

\end_inset

and the Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\mathbf{a}\otimes\mathbf{a}\,,\label{eq520}
\end{equation}

\end_inset

where 
\begin_inset Formula $T^{a}$
\end_inset

 is the prescribed contractile stress and 
\begin_inset Formula $\mathbf{a}=\mathbf{F}\cdot\mathbf{a}_{r}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{S}^{a}$
\end_inset

 is not a function of deformation, the material and spatial tangents are
 both zero.
\end_layout

\begin_layout Subsection
Transversely Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:TISO-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
In this case, the active stress is isotropic in a plane transverse to the
 direction 
\begin_inset Formula $\mathbf{a}_{r}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\left(\mathbf{I}-\mathbf{a}_{r}\otimes\mathbf{a}_{r}\right)\,,\label{eq521}
\end{equation}

\end_inset

and the corresponding Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\left(\mathbf{B}-\mathbf{a}\otimes\mathbf{a}\right)\,,\label{eq522}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 The material and spatial tangents are zero.
\end_layout

\begin_layout Subsection
Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
An isotropic active contractile stress is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\mathbf{I}\label{eq523}
\end{equation}

\end_inset

and the corresponding Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\mathbf{B}\,.\label{eq524}
\end{equation}

\end_inset

The material and spatial tangents are zero.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Chemical Reaction Production Rate
\begin_inset CommandInset label
LatexCommand label
name "sec:CR-Production-Rate"

\end_inset


\end_layout

\begin_layout Standard
Production rate constitutive equations provide a relation for 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 as a function of solid matrix strain, solute concentrations, and the concentrat
ions of solid-bound molecular species.
\end_layout

\begin_layout Subsection
Mass Action Forward
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Forward"

\end_inset


\end_layout

\begin_layout Standard
According to the law of mass action for forward reactions, 
\begin_inset Formula 
\begin{equation}
\hat{\zeta}=k\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\,.\label{eq525}
\end{equation}

\end_inset

A constitutive relation for the specific reaction rate 
\begin_inset Formula $k\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 must also be provided.
\end_layout

\begin_layout Subsection
Mass Action Reversible
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Reversible"

\end_inset


\end_layout

\begin_layout Standard
According to the law of mass action for reversible reactions, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\zeta}_{F} & =k_{F}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\\
\hat{\zeta}_{R} & =k_{R}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{P}^{\alpha}}\\
\hat{\zeta} & =\hat{\zeta}_{F}-\hat{\zeta}_{R}=\hat{\zeta}_{F}\left[1-K_{c}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu^{\alpha}}\right]\,,
\end{aligned}
\label{eq526}
\end{equation}

\end_inset

where 
\begin_inset Formula $K_{c}=k_{R}/k_{F}$
\end_inset

 is a function that reduces to the equilibrium constant of the reversible
 reaction at chemical equilibrium (when 
\begin_inset Formula $\hat{\zeta}=0)$
\end_inset

.
 Constitutive relations for the specific forward and reverse reaction rates,
 
\begin_inset Formula $k_{F}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 and 
\begin_inset Formula $k_{R}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 respectively, must also be provided.
\end_layout

\begin_layout Subsection
Michaelis-Menten
\begin_inset CommandInset label
LatexCommand label
name "subsec:Michaelis-Menten"

\end_inset


\end_layout

\begin_layout Standard
Michaelis-Menten is a model for enzyme kinetics as represented by the reactions
 
\begin_inset Formula 
\begin{equation}
\mathcal{E}^{e}+\mathcal{E}^{s}\rightleftharpoons\mathcal{E}^{es}\to\mathcal{E}^{e}+\mathcal{E}^{p}\,,\label{eq527}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{E}^{e}$
\end_inset

 is the enzyme, 
\begin_inset Formula $\mathcal{E}^{s}$
\end_inset

 is the substrate, 
\begin_inset Formula $\mathcal{E}^{es}$
\end_inset

 is the enzyme-substrate complex, and 
\begin_inset Formula $\mathcal{E}^{p}$
\end_inset

 is the product.
 The molar mass supply 
\begin_inset Formula $\hat{c}^{p}$
\end_inset

 producing 
\begin_inset Formula $\mathcal{E}^{p}$
\end_inset

 is related to the concentration of the substrate 
\begin_inset Formula $\mathcal{E}^{s}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\hat{c}^{p}=\frac{V_{max}c^{s}}{K_{m}+c^{s}}\,,\label{eq528}
\end{equation}

\end_inset

where 
\begin_inset Formula $V_{max}$
\end_inset

 is the maximum rate achieved by the system, at maximum (saturating) substrate
 concentrations.
 
\begin_inset Formula $K_{m}$
\end_inset

 is the substrate concentration at which the reaction rate is half of 
\begin_inset Formula $V_{max}$
\end_inset

.
\end_layout

\begin_layout Standard
This relation may be derived by applying the law of mass action to the two
 reactions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq527"

\end_inset

.
 under the simplifying assumption that the reversible reaction between the
 enzyme and substrate reaches steady state much faster than the subsequent
 forward reaction forming the product.
 If the first and second reactions are denoted by subscripts 1 and 2, respective
ly, the law of mass action for the first (reversible) and second (forwar)
 reaction produces 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\zeta}_{1} & =k_{F1}c^{e}c^{s}-k_{R1}c^{es},\quad\hat{\zeta}_{2}=k_{F2}c^{es}\,,\\
\hat{c}^{s} & =-\hat{\zeta}_{1},\quad\hat{c}^{p}=\hat{\zeta}_{2},\quad\hat{c}^{es}=\hat{\zeta}_{1}-\hat{\zeta}_{2}\,.
\end{aligned}
\label{eq529}
\end{equation}

\end_inset

The total enzyme concentration remains constant at 
\begin_inset Formula $c_{0}^{e}=c^{e}+c^{es}$
\end_inset

, so that
\begin_inset Formula $\hat{\zeta}_{1}=k_{F1}c_{0}^{e}c^{s}-\left(k_{F1}c^{s}+k_{R1}\right)c^{es}$
\end_inset

.
 Assuming that the first reaction equilibrates much faster than the second
 is equivalent to letting 
\begin_inset Formula $\hat{\zeta}_{1}\approx0$
\end_inset

, in which case 
\begin_inset Formula 
\begin{equation}
c^{es}\approx\frac{c_{0}^{e}c^{s}}{c^{s}+K_{m}}\,,\label{eq530}
\end{equation}

\end_inset

where 
\begin_inset Formula $K_{m}=k_{R1}/k_{F1}$
\end_inset

.
 Then, 
\begin_inset Formula 
\[
\hat{\zeta}_{2}=\frac{V_{\max}c^{s}}{c^{s}+K_{m}}\,,
\]

\end_inset

where 
\begin_inset Formula $V_{\max}=k_{F2}c_{0}^{e}$
\end_inset

 represents the maximum value of 
\begin_inset Formula $\hat{\zeta}_{2}$
\end_inset

, when 
\begin_inset Formula $K_{m}\ll c^{s}$
\end_inset

.
 In practice, choosing 
\begin_inset Formula $k_{F1}\gg k_{F2}$
\end_inset

 can produce the desired effect.
\end_layout

\begin_layout Section
Specific Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "sec:Specific-Reaction-Rate"

\end_inset


\end_layout

\begin_layout Standard
Specific reaction rate constitutive equations provide a relation for 
\begin_inset Formula $k$
\end_inset

 as a function of solid matrix strain and the concentrations of solid-bound
 molecular species.
\end_layout

\begin_layout Subsection
Constant Specific Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Specific-Reaction"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $k$
\end_inset

 is constant.
\end_layout

\begin_layout Subsection
Huiskes Remodeling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Huiskes-Remodeling"

\end_inset


\end_layout

\begin_layout Standard
For this material, the specific reaction rate depends on the deviation of
 the specific strain energy from a threshold value, 
\begin_inset Formula 
\begin{equation}
k\left(\mathbf{F},\rho_{r}^{s}\right)=\frac{B}{\left(J-\varphi_{r}^{s}\right)M^{s}}\left(\frac{\Psi_{r}}{\rho_{r}^{s}}-\psi_{0}\right)\,,,\label{eq531}
\end{equation}

\end_inset

where 
\begin_inset Formula $B$
\end_inset

 is a constant, 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is the strain energy density of the solid, 
\begin_inset Formula $\rho_{r}^{s}$
\end_inset

 is the referential mass density of the solid, 
\begin_inset Formula $\psi_{0}$
\end_inset

 is the threshold value for the specific strain energy.
 In this relation, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is evaluated from the solid deformation and 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is evaluated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq156"

\end_inset

.
\end_layout

\begin_layout Section
Viscous Fluids
\end_layout

\begin_layout Standard
The most common family of constitutive relations employed for viscous fluids,
 including Newtonian fluids, is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}\left(J,\mathbf{D}\right)=\left(\kappa-\frac{2}{3}\mu\right)\left(\tr\mathbf{D}\right)\,\mathbf{I}+2\mu\,\mathbf{D}\,,\label{eq:viscous-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are, respectively, the dynamic shear and bulk viscosity coefficients (both
 positive), which may generally depend on 
\begin_inset Formula $J$
\end_inset

 and, for non-Newtonian fluids, on invariants of 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
 In practice, most constitutive models for non-Newtonian viscous fluids
 only use a dependence on 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

, since it is the only non-zero invariant in viscometric flows 
\begin_inset CommandInset citation
LatexCommand cite
key "Reddy08"

\end_inset

.
 In this case, substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress-tangent-D"

\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}}^{\tau} & =\left(\kappa-\frac{2}{3}\mu\right)\mathbf{I}\otimes\mathbf{I}+\frac{2}{\dot{\gamma}}\left(\frac{\partial\kappa}{\partial\dot{\gamma}}-\frac{2}{3}\frac{\partial\mu}{\partial\dot{\gamma}}\right)\left(\tr\mathbf{D}\right)\mathbf{I}\otimes\mathbf{D}\\
 & +2\left(\frac{2}{\dot{\gamma}}\frac{\partial\mu}{\partial\dot{\gamma}}\mathbf{D}\otimes\mathbf{D}+\mu\,\mathbf{I}\,\underline{\overline{\otimes}}\,\mathbf{I}\right)\,.
\end{aligned}
\label{eq:viscous-tangent-D}
\end{equation}

\end_inset

The term containing 
\begin_inset Formula $\mathbf{I}\otimes\mathbf{D}$
\end_inset

 is the only one that does not exhibit major symmetry.
 In Newtonian fluids, 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are independent of 
\begin_inset Formula $\mathbf{D}$
\end_inset

; in incompressible fluids they are independent of 
\begin_inset Formula $J$
\end_inset

 (since 
\begin_inset Formula $J=1$
\end_inset

 remains constant and 
\begin_inset Formula $\tr\mathbf{D}=0$
\end_inset

).
 Thus, for both of these cases the term containing 
\begin_inset Formula $\mathbf{I}\otimes\mathbf{D}$
\end_inset

 drops out and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 exhibits major symmetry.
\end_layout

\begin_layout Standard
Similarly, using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

, the tangent 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress-tangent-J"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{J}^{\prime}=\left(\frac{\partial\kappa}{\partial J}-\frac{2}{3}\frac{\partial\mu}{\partial J}\right)\left(\tr\mathbf{D}\right)\,\mathbf{I}+2\frac{\partial\mu}{\partial J}\,\mathbf{D}\,.\label{eq:viscous-tangent-J}
\end{equation}

\end_inset

Explicit forms for the dependence of 
\begin_inset Formula $\mu$
\end_inset

 or 
\begin_inset Formula $\kappa$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

 are not illustrated here, since viscosity generally shows negligible dependence
 on pressure (thus 
\begin_inset Formula $J$
\end_inset

) over typical ranges of pressures in fluids, hence 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}\approx\mathbf{0}$
\end_inset

 in most analyses.
\end_layout

\begin_layout Standard
Many fluid mechanics textbooks employ Stoke's condition (
\begin_inset Formula $\kappa=0$
\end_inset

) for the purpose of equating the elastic pressure 
\begin_inset Formula $p$
\end_inset

 with the mean normal stress 
\begin_inset Formula $-\frac{1}{3}\tr\boldsymbol{\sigma}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Panton06"

\end_inset

; in FEBio, 
\begin_inset Formula $\kappa$
\end_inset

 is kept as a user-defined material property, which may be set to zero if
 desired.
 A common example of a non-Newtonian fluid is the Carreau model, where 
\begin_inset Formula $\boldsymbol{\tau}=2\mu\left(\dot{\gamma}\right)\mathbf{D}$
\end_inset

, which is a special case of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

, with 
\begin_inset Formula $\kappa=2\mu/3$
\end_inset

 and
\begin_inset Formula 
\begin{equation}
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\left(1+\left(\lambda\dot{\gamma}\right)^{2}\right)^{\left(n-1\right)/2}\,,\label{eq:Carreau-model-viscosity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda$
\end_inset

 is a time constant, 
\begin_inset Formula $n$
\end_inset

 is a parameter governing the power-law response, 
\begin_inset Formula $\mu_{0}$
\end_inset

 is the viscosity when 
\begin_inset Formula $\dot{\gamma}=0$
\end_inset

 and 
\begin_inset Formula $\mu_{\infty}$
\end_inset

 is the viscosity as 
\begin_inset Formula $\dot{\gamma}\to\infty$
\end_inset

.
 Other common models of non-Newtonian viscous fluids are summarized in 
\begin_inset CommandInset citation
LatexCommand cite
key "Cho91"

\end_inset

, though it should be noted that some of these models produce infinite values
 when evaluating 
\begin_inset Formula $\dot{\gamma}^{-1}\partial\mu/\partial\dot{\gamma}$
\end_inset

 as 
\begin_inset Formula $\dot{\gamma}\to0$
\end_inset

, which is problematic in the evaluation of 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-tangent-D"

\end_inset

.
\end_layout

\begin_layout Standard
For nearly incompressible fluids, a simple constitutive relation may be
 adopted for the pressure,
\begin_inset Formula 
\begin{equation}
p\left(J\right)=K\left(1-J\right)\,,\label{eq:ideal-fluid}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the bulk modulus of the fluid in the limit when 
\begin_inset Formula $J=1$
\end_inset

.
 It follows that 
\begin_inset Formula $p^{\prime}\left(J\right)=-K$
\end_inset

 and 
\begin_inset Formula $p^{\prime\prime}\left(J\right)=0$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

.
 This constitutive relation is adopted for nearly-incompressible CFD analyses
 in FEBio, though alternative formulations may be easily implemented.
\end_layout

\begin_layout Chapter
Contact and Coupling
\begin_inset CommandInset label
LatexCommand label
name "chap:Contact-and-Coupling"

\end_inset


\end_layout

\begin_layout Standard
FEBio allows the user to connect the different parts of the model in various
 ways.
 Deformable parts can be connected to rigid bodies.
 Deformable objects can be brought in contact with each other.
 Rigid bodies can be connected with rigid joints.
 This chapter describes the different ways to couple parts together.
\end_layout

\begin_layout Section
Rigid-Deformable Coupling
\begin_inset CommandInset label
LatexCommand label
name "sec:Rigid-Deformable-Coupling"

\end_inset


\end_layout

\begin_layout Standard
In FEBio deformable bodies can be coupled with rigid bodies.
 The coupling requires a modification of the global stiffness matrix and
 residual vector.
 Additionally, degrees of freedom need to be introduced for the rigid bodies
 
\begin_inset CommandInset citation
LatexCommand citep
key "Maker95"

\end_inset

.
 This section describes the coupling between rigid and deformable bodies.
\end_layout

\begin_layout Subsection
Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Deformable-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
The position vector 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
 of a finite element node may be denoted as, 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{X}+\mathbf{u}\,,\label{eq532}
\end{equation}

\end_inset

where 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 is the initial position of the node and 
\series bold
u
\series default
 the displacement vector.
 If this node is connected to a rigid body the position can alternatively
 be written as, 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{r}+\mathbf{a}\,,\label{eq533}
\end{equation}

\end_inset

where 
\series bold

\begin_inset Formula $\mathbf{r}$
\end_inset


\series default
 is the current position of the center of mass of the rigid body and 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 is the relative position of the node to the center of mass.
 The vector 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 may be written in terms of its initial value 
\begin_inset Formula $\mathbf{a}_{0}$
\end_inset

 in the undeformed state and a rotation matrix, 
\begin_inset Formula 
\begin{equation}
\mathbf{a}=\mathbf{Qa}_{0}\,.\label{eq534}
\end{equation}

\end_inset

In an incremental displacement formulation equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq533"

\end_inset

 must be linearized: 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}=\Delta\mathbf{r}+\Delta\mathbf{Qa}_{0}\,,\label{eq535}
\end{equation}

\end_inset

where the linearization of the rotation matrix can be expressed in a more
 convenient form, 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{Q}=\mathbf{\hat{a}}\Delta\boldsymbol{\theta}\,.\label{eq536}
\end{equation}

\end_inset

Here is
\begin_inset Formula $\Delta\boldsymbol{\theta}^{T}=\left[\Delta\theta_{1},\Delta\theta_{2},\Delta\theta_{3}\right]$
\end_inset

 and the matrix 
\begin_inset Formula $\mathbf{\hat{a}}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{a}}=\left[\begin{array}{ccc}
0 & a_{3} & -a_{2}\\
-a_{3} & 0 & a_{1}\\
a_{2} & -a_{1} & 0
\end{array}\right]\,.\label{eq537}
\end{equation}

\end_inset

For a model containing both deformable and rigid nodes the nodal degrees
 of freedom may be grouped, and the above expressions used to obtain a condensed
 set of unknowns: 
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
\Delta\mathbf{u}^{D}\\
\Delta\mathbf{u}^{R}
\end{array}\right\} =\left[\begin{array}{ccc}
\mathbf{I} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{I} & \mathbf{\hat{a}}
\end{array}\right]\left\{ \begin{array}{c}
\Delta\mathbf{u}^{D}\\
\Delta\mathbf{r}\\
\Delta\mathbf{\boldsymbol{\theta}}
\end{array}\right\} =\mathbf{A}\Delta\mathbf{\tilde{u}}\,.\label{eq538}
\end{equation}

\end_inset

Substituting this into the discrete form of the principle of virtual work
 yields expressions for the condensed finite element stiffness matrix and
 residual vector for the coupled rigid-deformable system: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{\tilde{K}}\Delta\mathbf{\tilde{u}} & =-\mathbf{\tilde{R}}\,, & \mathbf{\tilde{K}} & =\mathbf{A}^{T}\mathbf{KA}\,, & \mathbf{\tilde{R}} & =\mathbf{A}^{T}\mathbf{R}\end{aligned}
\,.\label{eq539}
\end{equation}

\end_inset

Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq539"

\end_inset

 is now solved for the incremental update vector 
\begin_inset Formula $\Delta\mathbf{\tilde{u}}$
\end_inset

.
 The nodal positions of the deformable nodes can now be updated in the usual
 way,
\begin_inset Formula 
\begin{equation}
\mathbf{u}_{n+1}^{D,k+1}=\mathbf{u}_{n+1}^{D,k}+\Delta\mathbf{u}^{D}\,.\label{eq540}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $k$
\end_inset

 is the iteration index of the Newon-Raphson iterations.
 The center of mass of the rigid body can now also be updated in a similar
 way, 
\begin_inset Formula 
\begin{equation}
\mathbf{r}_{n+1}^{k+1}=\mathbf{r}_{n+1}^{k}+\Delta\mathbf{r}\,.\label{eq541}
\end{equation}

\end_inset

To update the rotational degrees of freedom we employ quaternion algebra.
 The orientation of the rigid body at time 
\begin_inset Formula $n+1$
\end_inset

 is represented by the (unit) quaternion 
\begin_inset Formula $\mathbf{q}_{n+1}=\left(w_{n+1},\mathbf{x}_{n+1}\right)$
\end_inset

.
 The rotational update vector 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 can be written as a quaternion as follows,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\mathbf{q} & =\left(\cos\alpha,\frac{1}{2\alpha}\sin\alpha\Delta\boldsymbol{\theta}\right)\\
\alpha & =\frac{1}{2}\left(\Delta\theta_{1}^{2}+\Delta\theta_{2}^{2}+\Delta\theta_{3}^{2}\right)^{1/2}
\end{aligned}
\,.\label{eq542}
\end{equation}

\end_inset

The updated orientation quaternion is then given by the quaternion product,
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{q}}_{n+1}^{k+1}=\Delta\mathbf{q}\cdot\mathbf{q}_{n+1}^{k}\,.\label{eq543}
\end{equation}

\end_inset

Finally, we must ensure that the updated quaternion is a unit quaternion.
 To accomplish this we normalize the quaternion.
 
\begin_inset Formula 
\begin{equation}
\mathbf{q}=\mathbf{\tilde{q}}/\left\Vert \mathbf{\tilde{q}}\right\Vert \,.\label{eq544}
\end{equation}

\end_inset

Normalizing the quaternion guarantees that it represents a proper rotation.
\end_layout

\begin_layout Subsection
A single rigid body
\begin_inset CommandInset label
LatexCommand label
name "subsec:Single-rigid-body"

\end_inset


\end_layout

\begin_layout Standard
The global system of equations can now be written as follows (for a single
 rigid body coupled to a deformable body), 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\mathbf{K}^{D} & \mathbf{K}^{DR}\\
\left(\mathbf{K}^{DR}\right)^{T} & \mathbf{K}^{R}
\end{array}\right]\left\{ \begin{array}{c}
\Delta\mathbf{u}^{D}\\
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}
\end{array}\right\} =-\left\{ \begin{array}{c}
\mathbf{R}^{D}\\
\mathbf{F}^{R}\\
\mathbf{M}^{R}
\end{array}\right\} \,.\label{eq545}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{F}^{R}$
\end_inset

 is formed by adding all the residual vectors of all interface nodes that
 connect the deformable body to the rigid body, 
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{R}=\sum\limits _{i}\mathbf{R}_{i}^{D}\,,\label{eq546}
\end{equation}

\end_inset

where 
\begin_inset Formula $i$
\end_inset

 sums over all interface nodes, and 
\begin_inset Formula 
\begin{equation}
\mathbf{M}^{R}=\sum\limits _{i}\mathbf{\hat{a}}_{i}\mathbf{R}_{i}^{D}\,.\label{eq547}
\end{equation}

\end_inset

It is recognized that 
\begin_inset Formula $\mathbf{F}^{R}$
\end_inset

 is simply the total residual force that is applied to the rigid body and
 
\begin_inset Formula $\mathbf{M}^{R}$
\end_inset

 is the total residual torque.
\end_layout

\begin_layout Standard
Constructing the stiffness matrix is accomplished in a similar manner.
 Assume 
\begin_inset Formula $n$
\end_inset

 nodes per element, then the normal element stiffness matrix (in absence
 of rigid nodes) is given by, 
\begin_inset Formula 
\begin{equation}
\mathbf{k}^{(e)}=\left[\begin{array}{ccc}
\mathbf{k}_{11} & \cdots & \mathbf{k}_{1n}\\
\vdots & \ddots & \vdots\\
\mathbf{k}_{n1} & \cdots & \mathbf{k}_{nn}
\end{array}\right]\,,\label{eq548}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{k}_{ij}$
\end_inset

 is the nodal stiffness matrix connecting node 
\begin_inset Formula $i$
\end_inset

to node 
\begin_inset Formula $j$
\end_inset

.
 These nodal stiffness matrices are now assembled into the global stiffness
 matrix.
 If node 
\begin_inset Formula $i$
\end_inset

and 
\begin_inset Formula $j$
\end_inset

 are neither interface nodes their nodal stiffness matrix is assembled into
 
\begin_inset Formula $\mathbf{K}^{D}$
\end_inset

 in the usual manner, 
\begin_inset Formula 
\begin{equation}
\mathbf{K}^{D}=\sum\limits _{e}\mathbf{k}_{ij}^{(e)}\,,\label{eq549}
\end{equation}

\end_inset

where the sum now has to interpreted as the finite element assembly operator.
\end_layout

\begin_layout Standard
If node 
\begin_inset Formula $j$
\end_inset

 is an interface node, than the nodal stiffness matrix gets assembled in
 the 
\begin_inset Formula $\mathbf{K}^{DR}$
\end_inset

matrix: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}^{DR}=\sum\limits _{e}\left[\begin{array}{cc}
\mathbf{k}_{ij}^{(e)} & \mathbf{k}_{ij}^{(e)}\mathbf{\hat{a}}_{j}\end{array}\right]\,.\label{eq550}
\end{equation}

\end_inset

If both nodes belong to the rigid body than the nodal element matrix gets
 assembled in 
\begin_inset Formula $\mathbf{K}^{R}$
\end_inset

as follows, 
\begin_inset Formula 
\begin{equation}
\mathbf{K}^{R}=\sum\limits _{e}\left[\begin{array}{cc}
\mathbf{k}_{ij}^{(e)} & \mathbf{k}_{ij}^{(e)}\mathbf{\hat{a}}_{j}\\
\mathbf{\hat{a}}_{i}^{T}\mathbf{k}_{ij}^{(e)T} & \mathbf{\hat{a}}_{i}^{T}\mathbf{k}_{ij}^{(e)}\mathbf{\hat{a}}_{j}
\end{array}\right]\,.\label{eq551}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Multiple Rigid Bodies
\begin_inset CommandInset label
LatexCommand label
name "subsec:Multiple-Rigid-Bodies"

\end_inset


\end_layout

\begin_layout Standard
The previous results can easily be extended if there are multiple rigid
 bodies.
 The following section presents the approach for two rigid bodies, but the
 results can easily be generalized to 
\begin_inset Formula $N$
\end_inset

 rigid bodies.
\end_layout

\begin_layout Standard
For two rigid bodies, the global system of equations takes the following
 form, 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccc}
\mathbf{K}^{D} & \mathbf{K}_{1}^{DR} & \mathbf{K}_{2}^{DR}\\
\left(\mathbf{K}_{1}^{DR}\right)^{T} & \mathbf{K}_{11}^{R} & \mathbf{K}_{12}^{R}\\
\left(\mathbf{K}_{2}^{DR}\right)^{T} & \mathbf{K}_{21}^{R} & \mathbf{K}_{22}^{R}
\end{array}\right]\left\{ \begin{array}{c}
\Delta\mathbf{u}^{D}\\
\Delta\mathbf{r}_{1}\\
\Delta\boldsymbol{\theta}_{1}\\
\Delta\mathbf{r}_{2}\\
\Delta\boldsymbol{\theta}_{2}
\end{array}\right\} =-\left\{ \begin{array}{c}
\mathbf{R}^{R}\\
\mathbf{F}_{1}\\
\mathbf{M}_{1}\\
\mathbf{F}_{2}\\
\mathbf{M}_{2}
\end{array}\right\} \,.\label{eq552}
\end{equation}

\end_inset

Care must be taken to assemble the nodal stiffness matrix in the correct
 global sub-matrix.
 If node 
\begin_inset Formula $i$
\end_inset

 is not an interface node and node 
\begin_inset Formula $j$
\end_inset

 is connected to rigid body 1, then their nodal stiffness matrix goes into
 
\begin_inset Formula $\mathbf{K}_{1}^{DR}$
\end_inset

.
 If, however, node 
\begin_inset Formula $j$
\end_inset

 is attached to rigid body 2 then their nodal stiffness matrix goes into
 
\begin_inset Formula $\mathbf{K}_{2}^{DR}$
\end_inset

.
 If node 
\begin_inset Formula $i$
\end_inset

 is connected to rigid body 1 and node 
\begin_inset Formula $j$
\end_inset

 is connected to rigid body 2, then their nodal stiffness matrix goes into
 
\begin_inset Formula $\mathbf{K}_{12}^{R}$
\end_inset

, and so on.
 Note that it is assumed here that a node may only connect to a single rigid
 body.
\end_layout

\begin_layout Section
Rigid Joints
\begin_inset CommandInset label
LatexCommand label
name "sec:Rigid-Joints"

\end_inset


\end_layout

\begin_layout Standard
A rigid joint is a location in space where two rigid bodies connect.
 The joint enforces a constraint on the system.
 This constraint can be written as, 
\begin_inset Formula 
\begin{equation}
\mathbf{c}\left(\mathbf{Y}^{c}\right)=\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{Y}^{c}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{Y}^{c}\right)=\mathbf{0}\,.\label{eq553}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{Y}^{c}$
\end_inset

 is the location of the joint in the reference configuration and 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2$
\end_inset

) is the deformation map of rigid body 
\begin_inset Formula $i$
\end_inset

.
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq553"

\end_inset

 is a constraint equation that will be added to the total balance of virtual
 work.
 
\begin_inset Formula 
\begin{equation}
G\left(\boldsymbol{\varphi},\mathbf{w}\right)=\sum\limits _{i=1}^{2}G^{\text{int},\text{ext}}\left(\boldsymbol{\varphi}^{\left(i\right)},\mathbf{w}^{\left(i\right)}\right)-\underbrace{\sum\limits _{i=1}^{2}\mathbf{w}^{\left(i\right)}\left(\mathbf{Y}^{c}\right)\cdot\mathbf{T}^{\left(i\right)}}_{G^{c}}=0\,.\label{eq554}
\end{equation}

\end_inset

Here, the 
\begin_inset Formula $\mathbf{T}^{\left(i\right)}$
\end_inset

's are the forces that will prevent the rigid bodies to separate at the
 joint position and 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}=\delta\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

.
 First we note that due to the third law of Newton 
\begin_inset Formula $\mathbf{T}^{\left(1\right)}=-\mathbf{T}^{\left(2\right)}$
\end_inset

, so that we can write the constraint term as, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=-\mathbf{T}^{\left(1\right)}\cdot\left(\mathbf{w}^{\left(1\right)}-\mathbf{w}^{\left(2\right)}\right)\left(\mathbf{Y}^{c}\right)\,.\label{eq555}
\end{equation}

\end_inset

Note that we can also write this as, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=-\mathbf{T}^{\left(1\right)}\cdot\delta\mathbf{c}\,.\label{eq556}
\end{equation}

\end_inset

The constraint forces are determined by the augmented Lagrangian method
 and are given by, 
\begin_inset Formula 
\begin{equation}
\mathbf{T}=\boldsymbol{\lambda}+\varepsilon_{c}\mathbf{c}\,,\label{eq557}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is the Lagrange multiplier and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 is a user-defined penalty factor.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq556"

\end_inset

 is given by, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right) & =-\Delta\left(\varepsilon_{c}\mathbf{c}\cdot\delta\mathbf{c}\right)\\
 & =-\varepsilon_{c}\Delta\mathbf{c}\cdot\delta\mathbf{c}
\end{aligned}
\,.\label{eq558}
\end{equation}

\end_inset

Using the rigid body assumption, the quantity 
\begin_inset Formula $\Delta\mathbf{c}$
\end_inset

 can be written as follows, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\mathbf{c} & =\Delta\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{Y}^{c}\right)-\Delta\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{Y}^{c}\right)\\
 & =\Delta\mathbf{r}_{1}+\mathbf{\hat{y}}_{1}^{c}\Delta\boldsymbol{\theta}_{1}-\Delta\mathbf{r}_{2}-\mathbf{\hat{y}}_{2}^{c}\Delta\boldsymbol{\theta}_{2}
\end{aligned}
\,.\label{eq559}
\end{equation}

\end_inset

And similarly for 
\begin_inset Formula $\delta\mathbf{c}$
\end_inset

.
 If we now introduce the vectors, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\boldsymbol{\Phi} & =\left[\begin{array}{c}
\delta\mathbf{r}_{1}\\
\delta\boldsymbol{\theta}_{1}\\
\delta\mathbf{r}_{2}\\
\delta\boldsymbol{\mathbf{\theta}}_{2}
\end{array}\right] & \mathbf{N} & =\left[\begin{array}{c}
\mathbf{T}\\
\mathbf{\hat{y}}_{1}^{T}\mathbf{T}\\
-\mathbf{T}\\
-\mathbf{\hat{y}}_{2}^{T}\mathbf{T}
\end{array}\right]\,\end{aligned}
.\label{eq560}
\end{equation}

\end_inset

Then we can write the constraint work as, 
\begin_inset Formula 
\begin{equation}
G^{c}=-\delta\boldsymbol{\Phi}^{T}\mathbf{N}\,.\label{eq561}
\end{equation}

\end_inset

And the stiffness contribution as, 
\begin_inset Formula 
\begin{equation}
\Delta G^{c}=-\delta\boldsymbol{\Phi}^{T}\mathbf{K}^{c}\Delta\boldsymbol{\Phi}\,.\label{eq562}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{K}^{c}=\varepsilon_{c}\left[\begin{array}{cccc}
\mathbf{I} & \mathbf{\hat{y}}_{1} & -\mathbf{I} & -\mathbf{\hat{y}}_{2}\\
\mathbf{\hat{y}}_{1}^{T} & \mathbf{\hat{y}}_{1}^{T}\mathbf{y}_{1} & -\mathbf{y}_{1}^{T} & -\mathbf{y}_{1}^{T}\mathbf{y}_{2}\\
-\mathbf{I} & -\mathbf{y}_{1} & \mathbf{I} & \mathbf{y}_{2}\\
-\mathbf{y}_{2}^{T} & -\mathbf{y}_{2}^{T}\mathbf{y}_{1} & \mathbf{y}_{2}^{T} & \mathbf{y}_{2}^{T}\mathbf{y}_{2}
\end{array}\right]\,.\label{eq563}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Sliding Interfaces
\begin_inset CommandInset label
LatexCommand label
name "sec:Sliding-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
This section summarizes the theoretical developments of the two body contact
 problem.
 After introducing some notation and terminology, the contact integral is
 presented, which contains the contribution to the virtual work equation
 from the contact tractions.
 Since the nonlinear contact problem is solved using a Newton based iterative
 method, the contact integral is linearized.
 Next, anticipating a finite element implementation, the contact integral
 and its linearization are discretized using a standard finite element approach.
 Finally the augmented Lagrangian method for enforcing the contact constraints
 is described.
\end_layout

\begin_layout Subsection
Contact Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sliding-Contact-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
For the most part the notation of this section follows 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen02"

\end_inset

, with a few simplifications here and there since the implementation in
 FEBio is currently for quasi-static, frictionless, two body contact problem.
\end_layout

\begin_layout Standard
The volume occupied by body 
\begin_inset Formula $i$
\end_inset

 in the reference configuration is denoted by 
\begin_inset Formula $\Omega^{\left(i\right)}\subset\mathbb{R}^{3}$
\end_inset

where 
\begin_inset Formula $i=1,2$
\end_inset

.
 The boundary of body 
\begin_inset Formula $i$
\end_inset

 is denoted by 
\begin_inset Formula $\Gamma^{\left(i\right)}$
\end_inset

 and is divided into three regions 
\begin_inset Formula $\Gamma^{\left(i\right)}=\Gamma_{\sigma}^{\left(i\right)}\cup\Gamma_{u}^{\left(i\right)}\cup\Gamma_{c}^{\left(i\right)}$
\end_inset

, where 
\begin_inset Formula $\Gamma_{\sigma}^{\left(i\right)}$
\end_inset

 is the boundary where tractions are applied, 
\begin_inset Formula $\Gamma_{u}^{\left(i\right)}$
\end_inset

 the boundary where the solution is prescribed and 
\begin_inset Formula $\Gamma_{c}^{\left(i\right)}$
\end_inset

 the part of the boundary that will be in contact with the other body.
 It is assumed that 
\begin_inset Formula $\Gamma_{\sigma}^{\left(i\right)}\cap\Gamma_{u}^{\left(i\right)}\cap\Gamma_{c}^{\left(i\right)}=\emptyset$
\end_inset

.
\end_layout

\begin_layout Standard
The deformation of body 
\begin_inset Formula $i$
\end_inset

 is defined by 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

.
 The boundary of the deformed body 
\begin_inset Formula $i$
\end_inset

, that is the boundary of 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}\left(\Omega^{\left(i\right)}\right)$
\end_inset

 is denoted by 
\begin_inset Formula $\gamma^{\left(i\right)}=\gamma_{\sigma}^{\left(i\right)}\cup\gamma_{u}^{\left(i\right)}\cup\gamma_{c}^{\left(i\right)}$
\end_inset

 where 
\begin_inset Formula $\gamma_{\sigma}^{\left(i\right)}=\boldsymbol{\varphi}^{\left(i\right)}\left(\Gamma_{\sigma}^{\left(i\right)}\right)$
\end_inset

 is the boundary in the current configuration where the tractions are applied
 and similar definitions for 
\begin_inset Formula $\gamma_{u}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma_{c}^{\left(i\right)}$
\end_inset

.
 See the figure below for a graphical illustration of the defined regions.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigTwoBodyContactProblem.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
The two-body contact problem.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Points in body 1 are denoted by 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 in the reference configuration and 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
 in the current configuration.
 For body 2 these points are denoted by 
\series bold

\begin_inset Formula $\mathbf{Y}$
\end_inset


\series default
 and 
\series bold

\begin_inset Formula $\mathbf{y}$
\end_inset


\series default
.
 To define contact, the location where the two bodies are in contact with
 each other must be established.
 If body 1 is the 
\emph on
slave body
\emph default
 and body 2 is the 
\emph on
master body
\emph default
, then for a given point 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 on the slave reference contact surface there is a point 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

 on the master contact surface that is in some sense closest to point 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
.
 This closest point is defined in a closest point projection sense: 
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{Y}}\left(\mathbf{X}\right)=\arg\min\limits _{\mathbf{Y}\in\Gamma_{c}^{\left(2\right)}}\left\Vert \boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{Y}\right)\right\Vert \,.\label{eq564}
\end{equation}

\end_inset

With the definition of 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

 established the 
\emph on
gap function
\emph default
 can be defined, which is a measure for the distance between 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset

 
\series default
and 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
g\left(\mathbf{X}\right)=-\boldsymbol{\nu}\cdot\left(\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right)\,,\label{eq565}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

 is the local surface normal of surface 
\begin_inset Formula $\gamma_{c}^{\left(2\right)}$
\end_inset

 evaluated at 
\begin_inset Formula $\mathbf{\bar{y}}=\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)$
\end_inset

.
 Note that 
\begin_inset Formula $g>0$
\end_inset

 when 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset

 
\series default
has penetrated body 2, so that the constraint condition to be satisfied
 at all time is 
\begin_inset Formula $g\leqslant0$
\end_inset

.
\end_layout

\begin_layout Subsection
Weak Form of Two Body Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:Weak-Form-Two-Body"

\end_inset


\end_layout

\begin_layout Standard
The balance of linear momentum can be written for each of the two bodies
 in the reference configuration, 
\begin_inset Formula 
\begin{equation}
G^{\left(i\right)}\left(\boldsymbol{\varphi}^{\left(i\right)},\mathbf{w}^{\left(i\right)}\right)=\int\limits _{\Omega^{\left(i\right)}}\Grad\mathbf{w}^{\left(i\right)}:\mathbf{P}^{\left(i\right)}\,d\Omega-\int\limits _{\Omega^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{F}^{\left(i\right)}\,d\Omega-\int\limits _{\Gamma_{s}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma-\int\limits _{\Gamma_{c}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma=0\,,\label{eq566}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}$
\end_inset

 is a weighting function and 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset


\series default
 is the 
\begin_inset Formula $1^{\text{st}}$
\end_inset

 Piola-Kirchhoff stress tensor.
 The last term corresponds to the virtual work of the contact tractions
 on body 
\begin_inset Formula $i$
\end_inset

.
 For notational convenience, the notations 
\begin_inset Formula $\varphi$
\end_inset

and 
\begin_inset Formula $w$
\end_inset

 are introduced to denote the collection of the respective mappings 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}$
\end_inset

 (for 
\begin_inset Formula $i=$
\end_inset

1,2).
 In other words, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\varphi & :\bar{\Omega}^{\left(1\right)}\cup\bar{\Omega}^{\left(2\right)}\to\mathbb{R}^{3}\,,\\
w & :\bar{\Omega}^{\left(1\right)}\cup\bar{\Omega}^{\left(2\right)}\to\mathbb{R}^{3}\,.
\end{aligned}
\label{eq567}
\end{equation}

\end_inset

The variational principle for the two body system is the sum of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq566"

\end_inset

 for body 1 and 2 and can be expressed as, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}G\left(\boldsymbol{\varphi},\mathbf{w}\right) & :=\sum\limits _{i=1}^{2}G^{\left(i\right)}\left(\boldsymbol{\varphi}^{\left(i\right)},\mathbf{w}^{\left(i\right)}\right)\\
 & =\underbrace{\sum\limits _{i=1}^{2}\left\{ \int\limits _{\Omega^{\left(i\right)}}\Grad\mathbf{w}^{\left(i\right)}:\mathbf{P}^{\left(i\right)}\,d\Omega-\int\limits _{\Omega^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{F}^{\left(i\right)}\,d\Omega-\int\limits _{\Gamma_{s}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma\right\} }_{G^{\text{int},\text{ext}}\left(\boldsymbol{\varphi},\mathbf{w}\right)}\\
 & \underbrace{-\sum\limits _{i=1}^{2}\int\limits _{\Gamma_{c}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma}_{G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)}\,.
\end{aligned}
\label{eq568}
\end{equation}

\end_inset

Or in short, 
\begin_inset Formula 
\begin{equation}
G\left(\boldsymbol{\varphi},\mathbf{w}\right)=G^{\text{int},\text{ext}}\left(\boldsymbol{\varphi},\mathbf{w}\right)+G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\,.\label{eq569}
\end{equation}

\end_inset

Note that the minus sign is included in the definition of the contact integral
 
\begin_inset Formula $G^{c}$
\end_inset

.
 The contact integral can be written as an integration over the contact
 surface of body 1 by balancing linear momentum across the contact surface:
 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)d\Gamma^{\left(2\right)}=-\mathbf{t}^{\left(1\right)}\left(\mathbf{x}\right)\,d\Gamma^{\left(1\right)}\,.\label{eq570}
\end{equation}

\end_inset

The contact integral can now be rewritten over the contact surface of body
 1: 
\begin_inset Formula 
\begin{equation}
G^{c}=-\int\limits _{\Gamma_{c}^{\left(1\right)}}\mathbf{t}^{\left(1\right)}\left(\mathbf{x}\right)\cdot\left[\mathbf{w}^{\left(1\right)}\left(\mathbf{x}\right)-\mathbf{w}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)\right]\,d\Gamma\,.\label{eq571}
\end{equation}

\end_inset

In the case of frictionless contact, the contact traction is taken as perpendicu
lar to surface 2 and therefore can be written as, 
\begin_inset Formula $\mathbf{t}^{\left(1\right)}=t_{N}\boldsymbol{\nu}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

 is the (outward) surface normal and 
\begin_inset Formula $t_{N}$
\end_inset

 is to be determined from the solution strategy.
 For example in a Lagrange multiplier method the 
\begin_inset Formula $t_{N}$
\end_inset

's would be the Lagrange multipliers.
\end_layout

\begin_layout Standard
By noting that the variation of the gap function is given by 
\begin_inset Formula 
\begin{equation}
\delta g=-\boldsymbol{\nu}\cdot\left(\mathbf{w}^{\left(1\right)}\left(\mathbf{x}\right)-\mathbf{w}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)\right)\,,\label{eq572}
\end{equation}

\end_inset

equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq571"

\end_inset

 can be simplified as, 
\begin_inset Formula 
\begin{equation}
G^{c}=\int\limits _{\Gamma_{c}^{\left(1\right)}}t_{N}\delta g\,d\Gamma\,.\label{eq573}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Linearization-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
In a Newton-Raphson implementation the contact integral must be linearized
 with respect to the current configuration: 
\begin_inset Formula 
\begin{equation}
\Delta G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\int\limits _{\Gamma_{c}^{\left(1\right)}}\Delta\left(t_{N}\delta g\right)\,d\Gamma\,.\label{eq574}
\end{equation}

\end_inset

Examining the normal contact term first, the directional derivative of 
\begin_inset Formula $t_{N}$
\end_inset

 is given (for the case of the penalty regularization) by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta t_{N} & =\Delta\left\{ \varepsilon_{N}\left\langle g\right\rangle \right\} \\
 & =H\left(g\right)\varepsilon_{N}\Delta g
\end{aligned}
\,,\label{eq575}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 is the penalty factor and 
\begin_inset Formula $H\left(g\right)$
\end_inset

 is the Heaviside function.
 The quantity 
\begin_inset Formula $\Delta\left(\delta g\right)$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\left(\delta g\right) & =g\left[\boldsymbol{\nu}\cdot\delta\varphi_{,\gamma}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)+\kappa_{\alpha\gamma}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\delta\bar{\xi}_{\alpha}\right]m^{\gamma\beta}\\
 & \left[\boldsymbol{\nu}\cdot\Delta\varphi_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)+\kappa_{\alpha\beta}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\Delta\bar{\xi}^{\alpha}\right]\\
 & +\delta\bar{\xi}^{\beta}\boldsymbol{\nu}\cdot\left[\Delta\varphi_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right]+\Delta\bar{\xi}^{\beta}\boldsymbol{\nu}\cdot\left[\delta\boldsymbol{\varphi}_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right]\\
 & +\kappa_{\alpha\beta}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\delta\bar{\xi}^{\beta}\Delta\bar{\xi}^{\alpha}\,.
\end{aligned}
\label{eq576}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discretization-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
The contact integral, which is repeated here, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\int\limits _{\Gamma^{\left(1\right)}}t_{N}\delta g\,d\Gamma\,,\label{eq577}
\end{equation}

\end_inset

will now be discretized using a standard finite element procedure.
 First it is noted that the integration can be written as a sum over the
 surface element areas: 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\sum\limits _{e=1}^{N_{sel}}\int\limits _{\Gamma^{\left(1\right)e}}t_{N}\delta g\,d\Gamma\,,\label{eq578}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{sel}$
\end_inset

 is the number of surface elements.
 The integration can be approximated using a quadrature rule, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\cong\sum\limits _{e=1}^{N_{sel}}\left\{ \sum\limits _{i=1}^{N_{int}^{e}}w^{i}j\left(\boldsymbol{\xi}_{i}\right)t_{N}\left(\boldsymbol{\xi}_{i}\right)\delta g\left(\boldsymbol{\xi}_{i}\right)\right\} \,,\label{eq579}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{int}^{e}$
\end_inset

 are the number of integration points for element 
\begin_inset Formula $e$
\end_inset

.
 It is now assumed that the integration points coincide with the element's
 nodes (e.g.
 for a quadrilateral surface element we have 
\begin_inset Formula $\boldsymbol{\xi}_{1}=\left(-1,-1\right)$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\xi}_{2}=\left(1,-1\right)$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\xi}_{3}=\left(1,1\right)$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\xi}_{4}=\left(-1,1\right))$
\end_inset

.
 With this quadrature rule, we have 
\begin_inset Formula 
\begin{equation}
\begin{aligned}w^{\left(1\right)}\left(\boldsymbol{\xi}_{i}\right) & =\mathbf{c}_{i}^{\left(1\right)}\\
w^{\left(2\right)}\left(\bar{\boldsymbol{\xi}}_{i}\right) & =\sum\limits _{j=1}^{n}N_{j}\left(\bar{\boldsymbol{\xi}}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}
\end{aligned}
\,,\label{eq580}
\end{equation}

\end_inset

so that, 
\begin_inset Formula 
\begin{equation}
\delta g\left(\boldsymbol{\xi}_{i}\right)=-\boldsymbol{\nu}\cdot\left(\mathbf{c}_{i}^{\left(1\right)}-\sum\limits _{j=1}^{n}N_{j}^{\left(2\right)}\left(\bar{\boldsymbol{\xi}}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\right)\,.\label{eq581}
\end{equation}

\end_inset

If the following vectors are defined, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\boldsymbol{\Phi}^{T} & =\left[\begin{array}{cccc}
\mathbf{c}_{i}^{\left(1\right)} & \mathbf{c}_{1}^{\left(2\right)} & \cdots & \mathbf{c}_{n}^{\left(2\right)}\end{array}\right]\\
\mathbf{N}^{T} & =\left[\begin{array}{cccc}
\boldsymbol{\nu} & -\boldsymbol{\nu}N_{1}^{\left(2\right)} & \cdots & -\boldsymbol{\nu}N_{n}^{\left(2\right)}\end{array}\right]
\end{aligned}
\,,\label{eq582}
\end{equation}

\end_inset

equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq579"

\end_inset

 can then be rewritten as follows, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\cong\sum\limits _{e=1}^{N_{sel}}\left\{ \sum\limits _{i=1}^{N_{int}^{e}}w^{i}j\left(\boldsymbol{\xi}_{i}\right)t_{N}\left(\boldsymbol{\xi}_{i}\right)\delta\boldsymbol{\Phi}^{T}\mathbf{N}^{T}\right\} \,.\label{eq583}
\end{equation}

\end_inset

The specific form for 
\begin_inset Formula $t_{N}$
\end_inset

will depend on the method employed for enforcing the contact constraint.
\end_layout

\begin_layout Subsection
Discretization of the Contact Stiffness
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discretization-Contact-Stiffness"

\end_inset


\end_layout

\begin_layout Standard
A similar procedure can now be used to calculate the discretized contact
 stiffness matrix.
 The linearization of the contact integral is repeated here: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right) & =\sum\limits _{e=1}^{N_{sel}}\int\limits _{\Gamma^{\left(1\right)e}}\Delta\left(t_{N}\delta g\right)\,d\Gamma\\
 & =\sum\limits _{e=1}^{N_{sel}}\sum\limits _{i=1}^{N_{int}^{e}}w_{i}j\left(\boldsymbol{\xi}_{i}\right)\Delta\left(t_{N}\delta g\right)\left(\boldsymbol{\xi}_{i}\right)
\end{aligned}
\,.\label{eq584}
\end{equation}

\end_inset

Using matrix notation we can rewrite equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq584"

\end_inset

 as, 
\begin_inset Formula 
\begin{equation}
\Delta W^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\sum\limits _{e=1}^{N_{sel}}\sum\limits _{i}^{N_{int}^{e}}w_{i}j\left(\mathbf{\xi}_{i}\right)\delta\boldsymbol{\Phi}\cdot\mathbf{k}^{c}\Delta\boldsymbol{\Phi}\,,\label{eq585}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\boldsymbol{\Phi}$
\end_inset

 is as above and 
\begin_inset Formula $\Delta\boldsymbol{\Phi}$
\end_inset

 similar to 
\begin_inset Formula $\delta\boldsymbol{\Phi}$
\end_inset

 with 
\begin_inset Formula $\delta$
\end_inset

 replaced with 
\begin_inset Formula $\Delta$
\end_inset

, and 
\begin_inset Formula $\mathbf{k}^{c}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}^{c} & =\varepsilon_{N}H\left(\lambda_{N}^{k}+\varepsilon_{N}g\right)\mathbf{NN}^{T}+t_{N}\left\{ g\left[m^{11}\mathbf{\bar{N}}_{1}\mathbf{\bar{N}}_{1}^{T}\right.\right.\\
 & +m^{12}\left(\mathbf{\bar{N}}_{1}\mathbf{\bar{N}}_{2}^{T}+\mathbf{\bar{N}}_{2}\mathbf{\bar{N}}_{1}^{T}\right)+\left.m^{22}\mathbf{\bar{N}}_{2}\mathbf{\bar{N}}_{2}^{T}\right]-\mathbf{D}_{1}\mathbf{N}_{1}^{T}\\
 & -\mathbf{D}_{2}\mathbf{N}_{2}^{T}-\mathbf{N}_{1}\mathbf{D}_{1}^{T}-\mathbf{N}_{2}\mathbf{D}_{2}^{T}+\left.\kappa_{12}\left(\mathbf{D}_{1}\mathbf{D}_{2}^{T}+\mathbf{D}_{2}\mathbf{D}_{1}^{T}\right)\right\} 
\end{aligned}
\,,\label{eq586}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}= & \left[\begin{array}{c}
\boldsymbol{\nu}\\
-N_{1}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}\\
\vdots\\
-N_{4}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}
\end{array}\right]\,, & \mathbf{T}_{\alpha} & =\left[\begin{array}{c}
\boldsymbol{\tau}_{\alpha}\\
-N_{1}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\tau}_{\alpha}\\
\vdots\\
-N_{4}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\tau}_{\alpha}
\end{array}\right]\,, & \mathbf{N}_{\alpha} & =\left[\begin{array}{c}
\mathbf{0}\\
-N_{1,\alpha}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}\\
\vdots\\
-N_{4,\alpha}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}
\end{array}\right]\,.\end{aligned}
\label{eq587}
\end{equation}

\end_inset

The following vectors are also defined which depend on the vectors of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq587"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{D}_{1} & =\frac{1}{\det\mathbf{A}}\left[A_{22}\left(\mathbf{T}_{1}+g\mathbf{N}_{1}\right)-A_{12}\left(\mathbf{T}_{2}+g\mathbf{N}_{2}\right)\right]\\
\mathbf{D}_{2} & =\frac{1}{\det\mathbf{A}}\left[A_{11}\left(\mathbf{T}_{2}+g\mathbf{N}_{2}\right)-A_{12}\left(\mathbf{T}_{1}+g\mathbf{N}_{1}\right)\right]\\
\mathbf{\bar{N}}_{1} & =\mathbf{N}_{1}-\kappa_{12}\mathbf{D}_{2}\\
\mathbf{\bar{N}}_{2} & =\mathbf{N}_{2}-\kappa_{12}\mathbf{D}_{1}
\end{aligned}
\,,\label{eq588}
\end{equation}

\end_inset

where the matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is defined as, 
\begin_inset Formula 
\begin{equation}
A_{ij}=m_{ij}+g\kappa_{ij}\,.\label{eq589}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $m_{ij}=\boldsymbol{\tau}_{i}\cdot\boldsymbol{\tau}_{j}$
\end_inset

 is the surface metric tensor and 
\begin_inset Formula $\kappa_{ij}=\boldsymbol{\nu}\cdot\boldsymbol{\varphi}_{t,ij}^{\left(2\right)}\left(\mathbf{\bar{Y}}\right)$
\end_inset

 denotes the components of the surface curvature at 
\begin_inset Formula $\bar{\boldsymbol{\xi}}$
\end_inset

.
\end_layout

\begin_layout Subsection
Augmented Lagrangian Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Augmented-Lagrangian-Method"

\end_inset


\end_layout

\begin_layout Standard
The augmented Lagrangian method is used in FEBio to enforce the contact
 constraints to a user-specified tolerance.
 This implies that the normal contact tractions are given by, 
\begin_inset Formula 
\begin{equation}
t_{N}=\left\langle \lambda_{N}+\varepsilon_{N}g\right\rangle \,.\label{eq590}
\end{equation}

\end_inset

Note that this assumption is consistent with the approach that was used
 in establishing the discretization of the linearization of the contact
 integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq586"

\end_inset

.
 In 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq590"

\end_inset

 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 is a penalty factor that is chosen arbitrarily.
\end_layout

\begin_layout Standard
The Newton-Raphson iterative method is now used to solve the nonlinear contact
 problem where Uzawa's method (REF) is employed to calculate the Lagrange
 multipliers 
\begin_inset Formula $\lambda_{N}$
\end_inset

.
 This implies that the Lagrange multipliers are kept fixed during the Newton-Rap
hson iterations.
 After convergence the multipliers are updated and a new NR procedure is
 started.
 This procedure can be summarized by the following four steps.
\end_layout

\begin_layout Enumerate

\series bold
Initialize 
\series default
the augmented Lagrangian iteration counter 
\begin_inset Formula $k$
\end_inset

, and the initial guesses for the multipliers: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{N_{n+1}}^{\left(0\right)} & =\lambda_{N_{n}}\,,\\
k & =0\,.
\end{aligned}
\label{eq591}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Solve
\series default
 for 
\begin_inset Formula $\mathbf{d}_{n+1}^{\left(k\right)}$
\end_inset

, the solution vector corresponding to the fixed 
\begin_inset Formula $k$
\end_inset

th iterate for the multipliers, 
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{int}\left(\mathbf{d}_{n+1}^{\left(k\right)}\right)+\mathbf{F}^{c}\left(\mathbf{d}_{n+1}^{\left(k\right)}\right)=\mathbf{F}_{n+1}^{ext}\,,\label{eq592}
\end{equation}

\end_inset

where the contact tractions used to compute 
\begin_inset Formula $\mathbf{F}^{c}$
\end_inset

, the contact force, are governed by 
\begin_inset Formula 
\begin{equation}
t_{N_{n+1}}^{\left(k\right)}=\left\langle \lambda_{N_{n+1}}^{\left(k\right)}+\varepsilon_{N}g_{n+1}^{k}\right\rangle \,.\label{eq593}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Update
\series default
 the Lagrange multipliers and iteration counters: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{N_{n+1}}^{\left(k+1\right)} & =\left\langle \lambda_{N_{n+1}}^{\left(k\right)}+\varepsilon_{N}g_{n+1}^{\left(k\right)}\right\rangle \,,\\
k & =k+1\,.
\end{aligned}
\label{eq594}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Return
\series default
 to the solution phase.
 
\end_layout

\begin_layout Standard
Steps 2-4 of the above algorithm are generally repeated until all contact
 constraints are satisfied to a user-specified tolerance or little change
 in the solution vector from augmentation to augmentation is noted.
\end_layout

\begin_layout Subsection
Automatic Penalty Calculation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Automatic-Penalty-Calculation"

\end_inset


\end_layout

\begin_layout Standard
The determination of the penalty factor 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 can be a difficult task, since a good value may depend on both material
 parameters and geometrical factors.
 In FEBio the value of this penalty factor can be determined automatically.
 In this case FEBio will calculate a penalty factor for each facet using
 the following formula.
 
\begin_inset Formula 
\begin{equation}
\varepsilon_{i}=\frac{f_{SI}E_{i}A_{i}^{2}}{V_{i}}\,.\label{eq595}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $E_{i}$
\end_inset

 is the effective Young's modulus along the facet normal, 
\begin_inset Formula $A_{i}$
\end_inset

 the surface area of the facet, 
\begin_inset Formula $V_{i}$
\end_inset

 the volume of the element to which this facet belongs and 
\begin_inset Formula $f_{SI}$
\end_inset

 a user defined scale factor.
 The parameter 
\begin_inset Formula $E_{i}$
\end_inset

 is evaluated from the elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 and the facet unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\frac{1}{E_{i}}=\left(\mathbf{n}\otimes\mathbf{n}\right):\boldsymbol{\mathcal{C}}^{-1}:\left(\mathbf{n}\otimes\mathbf{n}\right)\,,\label{eq596}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{-1}$
\end_inset

 is the compliance tensor.
\end_layout

\begin_layout Subsection
Alternative Formulations
\begin_inset CommandInset label
LatexCommand label
name "subsec:Alternative-Formulations"

\end_inset


\end_layout

\begin_layout Subsubsection
Facet-To-Facet Sliding
\end_layout

\begin_layout Standard
As of FEBio version 1.2, two alternative formulations for sliding contact
 are available.
 The first method, which is referred to as the 
\emph on
facet-to-facet sliding
\emph default
, is very similar to the formulation described above.
 It only differs in that it uses a Gaussian quadrature rule instead of nodal
 integration.
 Because of the more accurate integration rule, it was noted that this method
 in many situations was more stable and resulted in better convergence.
\end_layout

\begin_layout Subsubsection
Sliding-Tension-Compression
\end_layout

\begin_layout Standard
The second alternative differs more significantly from the method described
 above.
 It also begins with the definition of a single contact integral over the
 slave surface.
 
\begin_inset Formula 
\begin{equation}
G_{c}=-\int\limits _{\gamma^{\left(1\right)}}\mathbf{t}_{c}\cdot\left(\delta\boldsymbol{\varphi}^{\left(1\right)}-\delta\bar{\boldsymbol{\varphi}}^{\left(2\right)}\right)\,da\,.\label{eq597}
\end{equation}

\end_inset

But a different derivation is followed to obtain the linearization of this
 contact integral.
 The main reason for this difference is a subtly alternative definition
 for the gap function.
 In this method, it is defined as follows.
 
\begin_inset Formula 
\begin{equation}
g\left(\mathbf{X}\right)=\boldsymbol{\nu}^{\left(1\right)}\cdot\left(\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right)\,,\label{eq598}
\end{equation}

\end_inset

where, 
\begin_inset Formula $\boldsymbol{\nu}^{\left(1\right)}$
\end_inset

 is the normal of the slave surface (opposed to the master normal as used
 in the derivation above).
 In this case, the point 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

 is no longer the closest point projection of 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset

 
\series default
onto the master surface, but instead is the normal projection along 
\begin_inset Formula $\boldsymbol{\nu}^{\left(1\right)}$
\end_inset

.
 The linearization of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq598"

\end_inset

 now becomes, 
\begin_inset Formula 
\begin{equation}
\delta g=\boldsymbol{\nu}^{\left(1\right)}\cdot\left(\delta\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\delta\bar{\boldsymbol{\varphi}}^{\left(2\right)}\left(\mathbf{X}\right)-\boldsymbol{\tau}_{i}^{\left(2\right)}\delta\xi_{i}\right)\,,\label{eq599}
\end{equation}

\end_inset

where, 
\begin_inset Formula $\boldsymbol{\tau}_{i}^{\left(2\right)}=\frac{\partial\bar{\boldsymbol{\varphi}}^{\left(2\right)}}{\partial\eta_{i}}$
\end_inset

 are the tangent vectors to the master surface at 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

.
 Note that since 
\begin_inset Formula $\boldsymbol{\nu}^{\left(1\right)}$
\end_inset

 is normal to the slave surface, equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq599"

\end_inset

 does not reduce to equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq572"

\end_inset

.
\end_layout

\begin_layout Standard
In one assumes frictionless contact, the contact traction can be written
 as follows, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}_{c}=t_{n}\boldsymbol{\nu}^{\left(1\right)}=t_{n}\frac{\boldsymbol{\tau}_{1}^{\left(1\right)}\times\boldsymbol{\tau}_{2}^{\left(1\right)}}{\left\Vert \boldsymbol{\tau}_{1}^{\left(1\right)}\times\boldsymbol{\tau}_{2}^{\left(1\right)}\right\Vert }\,,\label{eq600}
\end{equation}

\end_inset

where, 
\begin_inset Formula $\boldsymbol{\tau}_{i}^{\left(1\right)}$
\end_inset

are the tangent vectors to 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

evaluated at 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
.
 Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq600"

\end_inset

 we can rewrite the contact integral as follows.
 
\begin_inset Formula 
\begin{equation}
G_{c}=-\int\limits _{\xi^{\left(1\right)}}t_{n}\left(\delta\boldsymbol{\varphi}^{\left(1\right)}-\delta\bar{\boldsymbol{\varphi}}^{\left(2\right)}\right)\cdot\left(\boldsymbol{\tau}_{1}^{\left(1\right)}\times\boldsymbol{\tau}_{2}^{\left(1\right)}\right)\,d\xi\,,\label{eq601}
\end{equation}

\end_inset

where we assumed that the integration domain can be mapped to a 2D parametric
 domain, 
\begin_inset Formula $\mathbf{x}=\mathbf{x}\left(\xi_{\alpha}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq601"

\end_inset

 now proceeds in the usual fashion.
 Omitting the details, it can be shown that the linearization of the contact
 integral results in, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}DG_{c} & =\int\limits _{\xi^{\left(1\right)}}\varepsilon\boldsymbol{\nu}^{\left(1\right)}\cdot\left(\mathbf{u}_{2}-\mathbf{u}_{1}+\bar{\boldsymbol{\tau}}_{\alpha}^{\left(2\right)}\Delta\bar{\xi}_{\left(2\right)}^{\alpha}\right)\left(\delta\boldsymbol{\varphi}_{1}-\delta\bar{\boldsymbol{\varphi}}_{2}\right)\cdot\left(\boldsymbol{\tau}_{1}^{\left(1\right)}\times\boldsymbol{\tau}_{2}^{\left(1\right)}\right)\,d\xi\\
 & -\int\limits _{\xi^{\left(1\right)}}t_{n}\frac{\partial\mathbf{u}_{1}}{\partial\xi_{\alpha}}\left(\left(\mathbf{u}_{1}-\mathbf{u}_{2}\right)\cdot a^{\alpha\beta}\boldsymbol{\tau}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\boldsymbol{\nu}^{\left(1\right)}\cdot\frac{\partial\mathbf{u}_{1}}{\partial\xi_{\beta}}\right)\,d\xi\\
 & +\int\limits _{\xi^{\left(1\right)}}t_{n}\left(\delta\boldsymbol{\varphi}_{1}-\delta\bar{\boldsymbol{\varphi}}_{2}\right)\cdot\left(\frac{\partial\mathbf{u}_{1}}{\partial\xi_{1}}\times\boldsymbol{\tau}_{2}^{\left(1\right)}+\boldsymbol{\tau}_{1}^{\left(1\right)}\times\frac{\partial\mathbf{u}_{1}}{\partial\xi_{2}}\right)\,d\xi\,,
\end{aligned}
\label{eq602}
\end{equation}

\end_inset

where, 
\begin_inset Formula $a_{\alpha\beta}=\boldsymbol{\tau}_{\alpha}^{\left(1\right)}\times\boldsymbol{\tau}_{\beta}^{\left(2\right)}$
\end_inset

 and 
\begin_inset Formula $a^{\alpha\beta}=\left(a^{-1}\right)_{\alpha\beta}$
\end_inset

.
\end_layout

\begin_layout Standard
The discretization of the contact integral and its linearization now proceeds
 as usual.
 We will not derive the details, but it is important to point out that the
 resulting stiffness matrix for this particular contact formulation is not
 symmetric.
 Although this method has shown to give good results, especially in large
 compression problems, it was desirable to derive a symmetric version as
 well.
 Because of this, a slightly different formulation was also developed that
 does reduce to a symmetric stiffness matrix although this symmetric version
 did not seem to perform as well as the non-symmetric one.
\end_layout

\begin_layout Section
Biphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

 for a review of biphasic materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"

\end_inset

 for additional details on biphasic contact.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

 and solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\,.
\end{aligned}
\label{eq603}
\end{equation}

\end_inset

In the current implementation, only frictionless contact is taken into considera
tion, so that the contact traction has only a normal component, 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}=t_{n}\mathbf{n}^{\left(i\right)}$
\end_inset

.
 To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq604}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq605}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)t_{n}\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\,,
\end{aligned}
\label{eq606}
\end{equation}

\end_inset

and the linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta p^{\left(i\right)}\right].\label{eq607}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The gap function 
\begin_inset Formula $g$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(2\right)}=\mathbf{x}^{\left(1\right)}+g\mathbf{n}^{\left(1\right)},\quad g=\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\cdot\mathbf{n}^{\left(1\right)}\,.\label{eq608}
\end{equation}

\end_inset

The linearization of variables associated with motion, pressure, and concentrati
on, is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)} & =\Delta\mathbf{u}^{\left(1\right)}\,, & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\\
Dp^{\left(1\right)} & =\Delta p^{\left(1\right)}\,, & Dp^{\left(2\right)} & =\Delta p^{\left(2\right)}+\frac{\partial p^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0}\,, & D\mathbf{v}^{\left(2\right)} & =\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta p^{\left(1\right)} & \mbox{=0}\,, & D\delta p^{\left(2\right)} & =\frac{\partial\delta p^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}
\end{aligned}
\label{eq609}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\Delta\eta_{\left(2\right)}^{\alpha}=\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\cdot a^{\alpha\beta}\mathbf{g}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\mathbf{n}^{\left(1\right)}\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\beta}}\,,\label{eq610}
\end{equation}

\end_inset

with 
\begin_inset Formula $a^{\alpha\beta}=\left(A_{\alpha\beta}\right)^{-1}$
\end_inset

 and 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\mathbf{g}_{\beta}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the normal component of the contact traction be described by the penalty
 function, 
\begin_inset Formula 
\begin{equation}
t_{n}=\begin{cases}
\varepsilon_{n}g & g<0\\
0 & g\ge0
\end{cases}\,,\label{eq611}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $t_{n}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
\begin{cases}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(p^{\left(1\right)}-p^{\left(2\right)}\right) & t_{n}<0\\
p^{\left(i\right)}=0 & t_{n}=0
\end{cases}\,,\label{eq612}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $w_{n}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dt_{n} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\right)\cdot\mathbf{n}^{\left(1\right)}\,,\\
Dw_{n} & =\varepsilon_{p}\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}-\frac{\partial p^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)\,.
\end{aligned}
\label{eq613}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}t_{n}\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\cdot\left(\mathbf{n}^{\left(2\right)}\otimes\mathbf{g}_{\left(2\right)}^{\alpha}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq614}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}\left[\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\frac{\partial p^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+w_{n}\frac{\partial\delta p^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq615}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Contact-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{n}^{\left(1\right)}+w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\right]\,.\label{eq616}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)}\,, & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)}\,, & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta p^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta p_{a}^{\left(1\right)}\,, & \delta p^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta p_{b}^{\left(2\right)}\\
\Delta p^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta p_{c}^{\left(1\right)}\,, & \Delta p^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta p_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq617}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta p_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}
\end{array}\right]\right)\,,
\end{aligned}
\label{eq618}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}t_{n}\mathbf{n}^{\left(1\right)} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}t_{n}\mathbf{n}^{\left(1\right)}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}
\end{aligned}
\,.\label{eq619}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0}\\
\mathbf{g}_{ac}^{\left(1,1\right)} & g_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0}\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & g_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta p_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & g_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & g_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq620}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{A}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{N}^{\left(1\right)}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{c}^{\left(1\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)-t_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq621}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{p}N_{c}^{\left(1\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{p}^{\left(1\right)}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}+w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+w_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq622}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
g_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
g_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
g_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq623}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{\left(1\right)} & =\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\\
\mathbf{A}_{c}^{\left(1\right)} & =\frac{1}{J_{\eta}^{\left(1\right)}}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\mathbf{g}_{2}^{\left(1\right)}-\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\mathbf{g}_{1}^{\left(1\right)}\right\} \\
\mathbf{M}_{b}^{\left(2\right)} & =\mathbf{n}^{\left(2\right)}\otimes\mathbf{m}_{b}^{\left(2\right)}\\
\mathbf{m}_{b}^{\left(2\right)} & =\frac{\partial N_{b}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\\
\mathbf{p}^{\left(1\right)} & =\frac{\partial p^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}
\end{aligned}
\,.\label{eq624}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Biphasic-Solute Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Solute-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

 for a review of biphasic-solute materials.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)j_{n}^{\left(1\right)}\,da^{\left(1\right)}\,.
\end{aligned}
\label{eq625}
\end{equation}

\end_inset

In the current implementation, only frictionless contact is taken into considera
tion, so that the contact traction has only a normal component, 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}=t_{n}\mathbf{n}^{\left(i\right)}$
\end_inset

.
 To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq626}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}.\label{eq627}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)t_{n}\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)j_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\;,
\end{aligned}
\label{eq628}
\end{equation}

\end_inset

and the linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{c}^{\left(i\right)}\right]\,.\label{eq629}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The gap function 
\begin_inset Formula $g$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(2\right)}=\mathbf{x}^{\left(1\right)}+g\mathbf{n}^{\left(1\right)},\quad g=\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\cdot\mathbf{n}^{\left(1\right)}\,.\label{eq630}
\end{equation}

\end_inset

The linearization of variables associated with motion, pressure, and concentrati
on, is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)} & =\Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{p}^{\left(1\right)} & =\Delta\tilde{p}^{\left(1\right)} & D\tilde{p}^{\left(2\right)} & =\Delta\tilde{p}^{\left(2\right)}+\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{c}^{\left(1\right)} & =\Delta\tilde{c}^{\left(1\right)} & D\tilde{c}^{\left(2\right)} & =\Delta\tilde{c}^{\left(2\right)}+\frac{\partial\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\mathbf{v}^{\left(2\right)} & =\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{p}^{\left(1\right)} & =0 & D\delta\tilde{p}^{\left(2\right)} & =\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{c}^{\left(1\right)} & =0 & D\delta\tilde{c}^{\left(2\right)} & =\frac{\partial\delta\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}
\end{aligned}
\,,\label{eq631}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\Delta\eta_{\left(2\right)}^{\alpha}=\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\cdot a^{\alpha\beta}\mathbf{g}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\mathbf{n}^{\left(1\right)}\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\beta}}\,,\label{eq632}
\end{equation}

\end_inset

with 
\begin_inset Formula $a^{\alpha\beta}=\left(A_{\alpha\beta}\right)^{-1}$
\end_inset

 and 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\mathbf{g}_{\beta}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the normal component of the contact traction be described by the penalty
 function, 
\begin_inset Formula 
\begin{equation}
t_{n}=\begin{cases}
\varepsilon_{n}g & g<0\\
0 & g\geqslant0
\end{cases}\,,\label{eq633}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $t_{n}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
\begin{cases}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{p}^{\left(i\right)}=\tilde{p}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq634}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{cases}
j_{n}=\varepsilon_{c}\chi=\varepsilon_{c}\left(\tilde{c}^{\left(1\right)}-\tilde{c}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{c}^{\left(i\right)}=\tilde{c}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq635}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 are penalty factors associated with 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dt_{n} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\right)\cdot\mathbf{n}^{\left(1\right)}\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}-\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)\\
Dj_{n} & =\varepsilon_{c}\left(\Delta\tilde{c}^{\left(1\right)}-\Delta\tilde{c}^{\left(2\right)}-\frac{\partial\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)
\end{aligned}
\,.\label{eq636}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}t_{n}\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\cdot\left(\mathbf{n}^{\left(2\right)}\otimes\mathbf{g}_{\left(2\right)}^{\alpha}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq637}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}\left[\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+w_{n}\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq638}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\left(\Delta\tilde{c}^{\left(1\right)}-\Delta\tilde{c}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}\left[\varepsilon_{c}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\frac{\partial\tilde{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+j_{n}\frac{\partial\delta\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq639}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{n}^{\left(1\right)}+w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)+j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\right]\,.\label{eq640}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{p}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\left(1\right)} & \delta\tilde{c}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\left(2\right)}\\
\Delta\tilde{c}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\left(1\right)} & \Delta\tilde{c}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq641}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta\tilde{p}_{b,k}^{\left(1\right)} & \delta\tilde{c}_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}\\
j_{b,k}^{\left(1\right)}
\end{array}\right]\right)\,,
\end{aligned}
\label{eq642}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}t_{n}\mathbf{n}^{\left(1\right)} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}t_{n}\mathbf{n}^{\left(1\right)}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}\\
j_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}j_{n} & j_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}j_{n}
\end{aligned}
\,.\label{eq643}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{ac}^{\left(1,1\right)} & g_{ac}^{\left(1,1\right)} & 0\\
\mathbf{h}_{ac}^{\left(1,1\right)} & 0 & h_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & g_{ad,k}^{\left(1,2\right)} & 0\\
\mathbf{h}_{ad,k}^{\left(1,2\right)} & 0 & h_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{bc,k}^{\left({2,1}\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & g_{bc,k}^{\left(2,1\right)} & 0\\
\mathbf{h}_{bc,k}^{\left(2,1\right)} & 0 & h_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & g_{bd,k}^{\left(2,2\right)} & 0\\
\mathbf{h}_{bd,k}^{\left(2,2\right)} & 0 & h_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq644}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{A}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{N}^{\left(1\right)}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{c}^{\left(1\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)-t_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq645}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{p}N_{c}^{\left(1\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{p}^{\left(1\right)}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}+w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+w_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq646}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
g_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
g_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
g_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq647}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{h}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{c}N_{c}^{\left(1\right)}\mathbf{q}^{\left(1\right)}-j_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{h}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{q}^{\left(1\right)}\\
\mathbf{h}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{c}N_{b}^{\left(2\right)}\mathbf{q}^{\left(1\right)}+j_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+j_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{h}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{c}N_{b}^{\left(2\right)}\mathbf{q}^{\left(1\right)}-j_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq648}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}h_{ac}^{\left(1,1\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
h_{ad,k}^{\left(1,2\right)} & =\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
h_{bc,k}^{\left(2,1\right)} & =\varepsilon_{c}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
h_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{c}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq649}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{\left(1\right)} & =\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\\
\mathbf{A}_{c}^{\left(1\right)} & =\frac{1}{J_{\eta}^{\left(1\right)}}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\mathbf{g}_{2}^{\left(1\right)}-\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\mathbf{g}_{1}^{\left(1\right)}\right\} \\
\mathbf{M}_{b}^{\left(2\right)} & =\mathbf{n}^{\left(2\right)}\otimes\mathbf{m}_{b}^{\left(2\right)}\\
\mathbf{m}_{b}^{\left(2\right)} & =\frac{\partial N_{b}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\\
\mathbf{p}^{\left(1\right)} & =\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}\\
\mathbf{q}^{\left(1\right)} & =\frac{\partial\tilde{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}
\end{aligned}
\,.\label{eq650}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Multiphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Multiphasic-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"

\end_inset

 for a review of multiphasic materials.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\alpha\left(i\right)}$
\end_inset

 for solute 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\sum\limits _{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\,da^{\left(1\right)}
\end{aligned}
\,.\label{eq651}
\end{equation}

\end_inset

In the current implementation, only frictionless contact is taken into considera
tion, so that the contact traction has only a normal component, 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}=t_{n}\mathbf{n}^{\left(i\right)}$
\end_inset

.
 To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq652}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}.\label{eq653}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)t_{n}\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\sum\limits _{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq654}
\end{equation}

\end_inset

and the linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+\sum\limits _{\alpha}D\delta G_{c}\left[\Delta\tilde{c}^{\alpha\left(i\right)}\right]\,.\label{eq655}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The gap function 
\begin_inset Formula $g$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(2\right)}=\mathbf{x}^{\left(1\right)}+g\mathbf{n}^{\left(1\right)},\quad g=\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\cdot\mathbf{n}^{\left(1\right)}\,.\label{eq656}
\end{equation}

\end_inset

The linearization of variables associated with motion, pressure, and concentrati
on, is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)}= & \Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{p}^{\left(1\right)}= & \Delta\tilde{p}^{\left(1\right)} & D\tilde{p}^{\left(2\right)} & =\Delta\tilde{p}^{\left(2\right)}+\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{c}^{\gamma\left(1\right)}= & \Delta\tilde{c}^{\gamma\left(1\right)} & D\tilde{c}^{\gamma\left(2\right)} & =\Delta\tilde{c}^{\gamma\left(2\right)}+\frac{\partial\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\mathbf{v}^{\left(2\right)} & =\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{p}^{\left(1\right)} & =0 & D\delta\tilde{p}^{\left(2\right)} & =\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{c}^{\gamma\left(1\right)} & =0 & D\delta\tilde{c}^{\gamma\left(2\right)} & =\frac{\partial\delta\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}
\end{aligned}
\,,\label{eq657}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\Delta\eta_{\left(2\right)}^{\alpha}=\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\cdot a^{\alpha\beta}\mathbf{g}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\mathbf{n}^{\left(1\right)}\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\beta}}\,,\label{eq658}
\end{equation}

\end_inset

with 
\begin_inset Formula $a^{\alpha\beta}=\left(A_{\alpha\beta}\right)^{-1}$
\end_inset

 and 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\mathbf{g}_{\beta}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the normal component of the contact traction be described by the penalty
 function, 
\begin_inset Formula 
\begin{equation}
t_{n}=\begin{cases}
\varepsilon_{n}g & g<0\\
0 & g\geqslant0
\end{cases}\,,\label{eq659}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $t_{n}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
\begin{cases}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{p}^{\left(i\right)}=\tilde{p}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq660}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{cases}
j_{n}^{\alpha}=\varepsilon_{c}\chi^{\alpha}=\varepsilon_{c}\left(\tilde{c}^{\alpha\left(1\right)}-\tilde{c}^{\alpha\left(2\right)}\right) & t_{n}<0\\
\tilde{c}^{\alpha\left(i\right)}=\tilde{c}^{\alpha\ast} & t_{n}=0
\end{cases}\,,\label{eq661}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 are penalty factors associated with 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $j_{n}^{\alpha}\equiv j_{n}^{\alpha\left(1\right)}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dt_{n} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\right)\cdot\mathbf{n}^{\left(1\right)}\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}-\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)\\
Dj_{n}^{\gamma} & =\varepsilon_{c}\left(\Delta\tilde{c}^{\gamma\left(1\right)}-\Delta\tilde{c}^{\gamma\left(2\right)}-\frac{\partial\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)
\end{aligned}
\,.\label{eq662}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}t_{n}\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\cdot\left(\mathbf{n}^{\left(2\right)}\otimes\mathbf{g}_{\left(2\right)}^{\alpha}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq665}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}\left[\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+w_{n}\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq666}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\left(\Delta\tilde{c}^{\gamma\left(1\right)}-\Delta\tilde{c}^{\gamma\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\frac{\partial\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}j_{n}^{\gamma}\frac{\partial\delta\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\label{eq667}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{n}^{\left(1\right)}+w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)+\sum\limits _{\gamma}j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\right]\,.\label{eq668}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{p}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\gamma\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\gamma\left(1\right)} & \delta\tilde{c}^{\gamma\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\gamma\left(2\right)}\\
\Delta\tilde{c}^{\gamma\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\gamma\left(1\right)} & \Delta\tilde{c}^{\gamma\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\gamma\left(2\right)}
\end{aligned}
\,.\label{eq669}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{a}^{\alpha\left(1\right)}\\
j_{a}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\sum\limits _{b=1}^{m^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b}^{\left(2\right)} & \delta\tilde{p}_{b}^{\left(2\right)} & \delta\tilde{c}_{b}^{\alpha\left(2\right)} & \delta\tilde{c}_{b}^{\beta\left(2\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(2\right)}\\
w_{b,k}^{\left(2\right)}\\
j_{b,k}^{\alpha\left(2\right)}\\
j_{b,k}^{\beta\left(2\right)}
\end{array}\right]\right)\,,
\end{aligned}
\label{eq670}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =t_{n}N_{a}^{\left(1\right)}\mathbf{n}^{\left(1\right)} & \mathbf{f}_{b,k}^{\left(2\right)} & =-t_{n}N_{b}^{\left(2\right)}\mathbf{n}^{\left(1\right)}\\
w_{a}^{\left(1\right)} & =w_{n}N_{a}^{\left(1\right)} & w_{b,k}^{\left(2\right)} & =-w_{n}N_{b}^{\left(2\right)}\\
j_{a}^{\gamma\left(1\right)} & =j_{n}^{\gamma}N_{a}^{\left(1\right)} & j_{b,k}^{\gamma\left(2\right)} & =-j_{n}^{\gamma}N_{b}^{\left(2\right)}
\end{aligned}
\,.\label{eq671}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\right.\\
 & \left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & 0 & 0 & 0\\
\mathbf{g}_{ac}^{\left(1,1\right)} & g_{ac}^{\left(1,1\right)} & 0 & 0\\
\mathbf{h}_{ac}^{\alpha\left(1,1\right)} & 0 & h_{ac}^{\alpha\alpha\left(1,1\right)} & 0\\
\mathbf{h}_{ac}^{\beta\left(1,1\right)} & 0 & 0 & h_{ac}^{\beta\beta\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & 0 & 0 & 0\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & g_{ad,k}^{\left(1,2\right)} & 0 & 0\\
\mathbf{h}_{ad,k}^{\alpha\left(1,2\right)} & 0 & h_{ad,k}^{\alpha\alpha\left(1,2\right)} & 0\\
\mathbf{h}_{ad,k}^{\beta\left(1,2\right)} & 0 & 0 & h_{ad,k}^{\beta\beta\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(2\right)} & \delta\tilde{c}_{b,k}^{\beta\left(2\right)}\end{array}\right]\cdot\\
 & \left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & 0 & 0 & 0\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & g_{bc,k}^{\left(2,1\right)} & 0 & 0\\
\mathbf{h}_{bc,k}^{\alpha\left(2,1\right)} & 0 & h_{bc,k}^{\alpha\alpha\left(2,1\right)} & 0\\
\mathbf{h}_{bc,k}^{\beta\left(2,1\right)} & 0 & 0 & h_{bc,k}^{\beta\beta\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & 0 & 0 & 0\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & g_{bd,k}^{\left(2,2\right)} & 0 & 0\\
\mathbf{h}_{bd,k}^{\alpha\left(2,2\right)} & 0 & h_{bd,k}^{\alpha\alpha\left(2,2\right)} & 0\\
\mathbf{h}_{bd,k}^{\beta\left(2,2\right)} & 0 & 0 & h_{bd,k}^{\beta\beta\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq672}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{A}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{N}^{\left(1\right)}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{c}^{\left(1\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)-t_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq673}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{p}N_{c}^{\left(1\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{p}^{\left(1\right)}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}+w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+w_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq674}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)} & g_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
g_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)} & g_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq675}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{h}_{ac}^{\gamma\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(N_{c}^{\left(1\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}-\mathbf{A}_{c}^{\left(1\right)}\cdot j_{n}^{\gamma}\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{h}_{ad,k}^{\gamma\left(1,2\right)} & =-N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}\\
\mathbf{h}_{bc,k}^{\gamma\left(2,1\right)} & =N_{b}^{\left(2\right)}\left(-N_{c}^{\left(1\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}+\mathbf{A}_{c}^{\left(1\right)}\cdot j_{n}^{\gamma}\mathbf{n}^{\left(1\right)}\right)+N_{c}^{\left(1\right)}j_{n}^{\gamma}\mathbf{m}_{b}^{\left(2\right)}\\
\mathbf{h}_{bd,k}^{\gamma\left(2,2\right)} & =N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}-N_{d}^{\left(2\right)}j_{n}^{\gamma}\mathbf{m}_{b}^{\left(2\right)}
\end{aligned}
\,,\label{eq676}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}h_{ac}^{\gamma\gamma\left(1,1\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
h_{ad,k}^{\gamma\gamma\left(1,2\right)} & =\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
h_{bc,k}^{\gamma\gamma\left(2,1\right)} & =\varepsilon_{c}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
h_{bd,k}^{\gamma\gamma\left(2,2\right)} & =-\varepsilon_{c}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq677}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{\left(1\right)} & =\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)} & \mathbf{A}_{c}^{\left(1\right)} & =\frac{1}{J_{\eta}^{\left(1\right)}}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\mathbf{g}_{2}^{\left(1\right)}-\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\mathbf{g}_{1}^{\left(1\right)}\right\} \\
\mathbf{M}_{b}^{\left(2\right)} & =\mathbf{n}^{\left(2\right)}\otimes\mathbf{m}_{b}^{\left(2\right)} & \mathbf{m}_{b}^{\left(2\right)} & =\frac{\partial N_{b}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\\
\mathbf{p}^{\left(1\right)} & =\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha} & \mathbf{q}^{\gamma\left(1\right)} & =\frac{\partial\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}
\end{aligned}
\,.\label{eq678}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Contact"

\end_inset


\end_layout

\begin_layout Standard
In some situations it is useful to connect two non-conforming meshes together.
 This can be done by defining a tied contact interface.
 In FEBio, the tied contact works very similar to the sliding contact interface.
 We need to define a slave surface and a master surface, where it is assumed
 that the slave surface nodes will be tied to the master surface faces.
\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
Just as in sliding contact, we need to define a gap function that measures
 the distance between the slave and master surface.
 In order to do that, we first define the projection of a slave node to
 the master surface.
 
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{Y}}\left(\mathbf{X}\right)=\arg\min\limits _{\mathbf{Y}\in\Gamma^{\left(2\right)}}\left\Vert \mathbf{X}-\mathbf{Y}\right\Vert \,.\label{eq679}
\end{equation}

\end_inset

This definition is similar to that of the sliding interface, except that
 now the projection is done in the material reference frame.
 This implies that the projection only needs to be calculated once, at the
 beginning of the analysis.
 We can now proceed to the definition of the gap function.
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}\left(\mathbf{X}\right)=\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\,.\label{eq680}
\end{equation}

\end_inset

An important observation is that the gap function is now a vector quantity
 since the gap needs to be closed in all direction, not just the normal
 direction as is the case in sliding contact.
\end_layout

\begin_layout Subsection
Tied Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
With the definition of the gap function at hand (equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq680"

\end_inset

), we can define the contribution to the virtual work equation from the
 tied contact reaction forces.
 
\begin_inset Formula 
\begin{equation}
W_{t}=\int\limits _{\Gamma_{c}}\mathbf{T}\cdot\delta\mathbf{g}\,d\Gamma\,.\label{eq681}
\end{equation}

\end_inset

Here, 
\series bold

\begin_inset Formula $\mathbf{T}$
\end_inset

 
\series default
is the reaction force that enforces the constraint 
\begin_inset Formula $\mathbf{g}\left(\mathbf{X}\right)=0$
\end_inset

.
 Since we anticipate the use of an augmented Lagrangian formalism, we can
 write this reaction force as follows,
\begin_inset Formula 
\begin{equation}
\mathbf{T}=\boldsymbol{\lambda}+\varepsilon\mathbf{g}\,.\label{eq682}
\end{equation}

\end_inset

The vector quantity 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is the Lagrangian multiplier and 
\begin_inset Formula $\varepsilon$
\end_inset

 is a penalty factor.
\end_layout

\begin_layout Subsection
Linearization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Linearization"

\end_inset


\end_layout

\begin_layout Standard
Since equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq681"

\end_inset

 is nonlinear we need to calculate the linearization.
 For tied contact, this is simply given by the following equation.
 
\begin_inset Formula 
\begin{equation}
\Delta W_{t}=\int\limits _{\Gamma_{c}}\varepsilon\Delta\mathbf{g}\cdot\delta\mathbf{g}\,d\Gamma\,.\label{eq683}
\end{equation}

\end_inset

Where 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{g}=\mathbf{w}^{\left(1\right)}-\mathbf{w}^{\left(2\right)}\label{eq684}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{g}=\Delta\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\Delta\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\,.\label{eq685}
\end{equation}

\end_inset

We also introduced the notation 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}=\delta\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

.
\end_layout

\begin_layout Standard
The discretization of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq683"

\end_inset

 will lead to a contribution to the stiffness matrix.
 Notice that due to symmetry between 
\begin_inset Formula $\delta\mathbf{g}$
\end_inset

 and
\begin_inset Formula $\Delta\mathbf{g}$
\end_inset

 this matrix will be symmetric.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq681"

\end_inset

 can be discretized as follows.
 First, we split the integration over all the slave surface elements.
 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\int\limits _{\Gamma_{c}^{\left(e\right)}}\mathbf{T}\cdot\delta\mathbf{g}\,d\Gamma^{\left(e\right)}\,.\label{eq686}
\end{equation}

\end_inset

The integration can be approximated by a quadrature rule, 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\mathbf{T}\left(\xi_{i}\right)\cdot\delta\mathbf{g}\left(\xi_{i}\right)\,.\label{eq687}
\end{equation}

\end_inset

If we use a nodally integrated elements, we have 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}^{\left(1\right)}\left(\xi_{i}\right) & =\mathbf{c}_{i}^{\left(1\right)}\,,\\
\mathbf{w}^{\left(2\right)}\left(\xi_{i}\right) & =\sum\limits _{j}N_{j}\left(\bar{\xi}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\,,
\end{aligned}
\label{eq688}
\end{equation}

\end_inset

so that, 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{g}\left(\xi_{i}\right)=\mathbf{c}_{i}^{\left(1\right)}-\sum\limits _{j}N_{j}\left(\bar{\xi}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\,.\label{eq689}
\end{equation}

\end_inset

We can now write the contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq686"

\end_inset

 in its final form, 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\left(\mathbf{N}\left(\xi_{i}\right)\mathbf{T}\left(\xi_{i}\right)\right)\cdot\delta\boldsymbol{\Phi}\,,\label{eq690}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\Phi}^{T}\left(\xi_{i}\right)=\left[\begin{array}{ccccc}
\mathbf{c}_{i}^{\left(1\right)} & \mathbf{c}_{1}^{\left(2\right)} & \mathbf{c}_{2}^{\left(2\right)} & \cdots & \mathbf{c}_{n}^{\left(2\right)}\end{array}\right]\,,\label{eq691}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{N}\left(\xi_{i}\right)=\left[\begin{array}{cccc}
\mathbf{I} & -\mathbf{N}_{1} & \cdots & -\mathbf{N}_{n}\end{array}\right]\,,\label{eq692}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{N}_{i}=\left[\begin{array}{ccc}
N_{i} & 0 & 0\\
0 & N_{i} & 0\\
0 & 0 & N_{i}
\end{array}\right]\,.\label{eq693}
\end{equation}

\end_inset

For the linearized tied contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq683"

\end_inset

, a similar discretization procedure leads to, 
\begin_inset Formula 
\begin{equation}
\Delta W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\Delta\boldsymbol{\Phi}\cdot\mathbf{K}_{c}\delta\boldsymbol{\Phi}\,,\label{eq694}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{c}=\varepsilon\mathbf{N}^{T}\mathbf{N}\,.\label{eq695}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Biphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Biphasic-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

 for a review of biphasic materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"

\end_inset

 for additional details on biphasic contact.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

 and solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}^{\left(1\right)}da^{\left(1\right)}\,.
\end{aligned}
\label{eq696}
\end{equation}

\end_inset

To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}\equiv\mathbf{t}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta p^{\left(i\right)}\right]\,.\label{eq700}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\,.\label{eq701}
\end{equation}

\end_inset

The premise of a tied interface is that the parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once, in the reference configuration, by shooting a ray from
 the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 It follows from this premise that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)} & =\Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}\\
Dp^{\left(1\right)} & =\Delta p^{\left(1\right)} & Dp^{\left(2\right)} & =\Delta p^{\left(2\right)}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\delta\mathbf{v}^{\left(2\right)} & =\mathbf{0}\\
D\delta p^{\left(1\right)} & =0 & D\delta p^{\left(2\right)} & =0
\end{aligned}
\,.\label{eq702}
\end{equation}

\end_inset

If 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are not initially conforming, continuity of fluid pressure and normal flux
 will only be enforced within the contact interface; unlike the sliding
 biphasic contact interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Contact"

\end_inset

), free-draining conditions are not set automatically on regions of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 where a solution for 
\begin_inset Formula $\mathbf{g}$
\end_inset

 was not found.
 Therefore, these regions naturally enforce zero fluid flux (impermeable
 boundary), unless an explicit boundary condition on the pressure 
\begin_inset Formula $p$
\end_inset

 is prescribed over those regions.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the tied contact traction be described by the penalty function, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\varepsilon_{n}\mathbf{g}\,,\label{eq703}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(p^{\left(1\right)}-p^{\left(2\right)}\right)\,,\label{eq704}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $w_{n}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}\right)\,,\\
Dw_{n} & =\varepsilon_{p}\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}\right)\,.
\end{aligned}
\label{eq705}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\right)=\\
 & \left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\varepsilon_{n}J_{\eta}^{\left(1\right)}\mathbf{I}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\otimes\left[\left(\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}-\left(\mathbf{g}_{2}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\right]
\end{aligned}
\,,\label{eq706}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}+w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\right]\,.\label{eq708}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta p^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta p_{a}^{\left(1\right)} & \delta p^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta p_{b}^{\left(2\right)}\\
\Delta p^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta p_{c}^{\left(1\right)} & \Delta p^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta p_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq709}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta p_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq710}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}
\end{aligned}
\,.\label{eq711}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0}\\
\mathbf{k}_{ac}^{\left(1,1\right)} & k_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta p_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & k_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq712}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{I}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\mathbf{I}
\end{aligned}
\,,\label{eq713}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}
\end{aligned}
\,,\label{eq714}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq715}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{c}^{\left(1\right)}=\frac{1}{J_{\eta}^{\left(1\right)}}\mathbf{n}^{\left(1\right)}\times\left(\mathbf{g}_{2}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)\,.\label{eq716}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Multiphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Multiphasic-Contact"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"

\end_inset

 for a review of multiphasic materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian12"

\end_inset

 for additional details on contact interfaces involving solutes.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\alpha\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\sum_{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\,da^{\left(1\right)}\,.
\end{aligned}
\label{eq696-1}
\end{equation}

\end_inset

Note that the summation in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq696-1"

\end_inset

 is performed only over solutes that are present on both sides of the contact
 interface.
 No special treatment is needed for solutes that only belong to one side,
 since the natural boundary condition for these solutes enforces zero normal
 flux across the contact interface.
\end_layout

\begin_layout Standard
To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698-1}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\sum_{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}\equiv\mathbf{t}^{\left(1\right)}$
\end_inset

, 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $j_{n}^{\alpha}\equiv j_{n}^{\alpha\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+\sum_{\alpha}D\delta G_{c}\left[\Delta\tilde{c}^{\alpha\left(i\right)}\right]\,.\label{eq700-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-MP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\,.\label{eq701-1}
\end{equation}

\end_inset

The premise of a tied interface is that the parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once, in the reference configuration, by shooting a ray from
 the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 It follows from this premise that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(i\right)} & =\Delta\mathbf{u}^{\left(i\right)} & D\delta\mathbf{v}^{\left(i\right)} & =\mathbf{0}\\
D\tilde{p}^{\left(i\right)} & =\Delta\tilde{p}^{\left(i\right)} & D\delta\tilde{p}^{\left(i\right)} & =0\\
D\tilde{c}^{\alpha\left(i\right)} & =\Delta\tilde{c}^{\alpha\left(i\right)} & D\delta\tilde{c}^{\alpha\left(i\right)} & =0
\end{aligned}
\quad i=1,2\,.\label{eq702-1}
\end{equation}

\end_inset

If 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are not initially conforming, continuity of effective fluid pressure and
 solute concentration, as well as normal fluid and solute fluxes, will only
 be enforced within the contact interface; unlike the sliding multiphasic
 contact interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multiphasic-Contact"

\end_inset

), ambient conditions are not set automatically on regions of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 where a solution for 
\begin_inset Formula $\mathbf{g}$
\end_inset

 was not found.
 Therefore, these regions naturally enforce zero fluid and solute flux (impermea
ble boundary), unless an explicit boundary condition on the effective pressure
 
\begin_inset Formula $\tilde{p}$
\end_inset

 or solute concentrations 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 are prescribed over those regions.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-MP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the tied contact traction be described by the penalty function, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\varepsilon_{n}\mathbf{g}\,,\label{eq703-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right)\,,\label{eq704-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $w_{n}$
\end_inset

, and
\begin_inset Formula 
\begin{equation}
j_{n}^{\alpha}=\varepsilon_{c}\chi^{\alpha}=\varepsilon_{c}^{\alpha}\left(\tilde{c}^{\alpha\left(1\right)}-\tilde{c}^{\alpha\left(2\right)}\right)\,,\label{eq704-1b}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{c}^{\alpha}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $j_{n}^{\alpha}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}\right)\,,\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\,,\\
Dj_{n}^{\alpha} & =\varepsilon_{c}^{\alpha}\left(\Delta\tilde{c}^{\alpha\left(1\right)}-\Delta\tilde{c}^{\alpha\left(2\right)}\right)\,.
\end{aligned}
\label{eq705-1}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\right)=\\
 & \left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\varepsilon_{n}J_{\eta}^{\left(1\right)}\mathbf{I}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\otimes\left[\left(\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}-\left(\mathbf{g}_{2}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\right]
\end{aligned}
\,,\label{eq706-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\varepsilon_{c}^{\alpha}\left(\Delta\tilde{c}^{\alpha\left(1\right)}-\Delta\tilde{c}^{\alpha\left(2\right)}\right)\\
 & +j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707-1b}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization-1"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}+w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)+\sum_{\alpha}j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\right]\,.\label{eq708-1}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta p^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\alpha\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta c^{\alpha\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\alpha\left(2\right)}\\
\Delta\tilde{c}^{\alpha\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\alpha\left(1\right)} & \Delta\tilde{c}^{\alpha\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\alpha\left(2\right)}
\end{aligned}
\,.\label{eq709-1}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}^{\alpha\left(1\right)} & \delta\tilde{c}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{n}^{\alpha\left(1\right)}\\
j_{n}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta\tilde{p}_{b,k}^{\left(1\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(1\right)} & \delta\tilde{c}_{b,k}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}\\
j_{b,k}^{\alpha\left(1\right)}\\
j_{b,k}^{\beta\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq710-1}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}\\
j_{a}^{\gamma\left(1\right)} & =N_{a}^{\left(1\right)}j_{n}^{\gamma} & j_{b,k}^{\gamma\left(2\right)} & =-N_{b}^{\left(2\right)}j_{n}^{\gamma}
\end{aligned}
\,.\label{eq711-1}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ac}^{\left(1,1\right)} & k_{ac}^{\left(1,1\right)} & 0 & 0\\
\mathbf{k}_{ac}^{\alpha\left(1,1\right)} & 0 & k_{ac}^{\alpha\alpha\left(1,1\right)} & 0\\
\mathbf{k}_{ac}^{\beta\left(1,1\right)} & 0 & 0 & k_{ac}^{\beta\beta\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)} & 0 & 0\\
\mathbf{0} & 0 & k_{ad,k}^{\alpha\alpha\left(1,2\right)} & 0\\
\mathbf{0} & 0 & 0 & k_{ad,k}^{\beta\beta\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(2\right)} & \delta\tilde{c}_{b,k}^{\beta\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & k_{bc,k}^{\left(2,1\right)} & 0 & 0\\
\mathbf{k}_{bc,k}^{\alpha\left(2,1\right)} & 0 & k_{bc,k}^{\alpha\alpha\left(2,1\right)} & 0\\
\mathbf{k}_{bc,k}^{\beta\left(2,1\right)} & 0 & 0 & k_{bc,k}^{\beta\beta\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)} & 0 & 0\\
\mathbf{0} & 0 & k_{bd,k}^{\alpha\alpha\left(2,2\right)} & 0\\
\mathbf{0} & 0 & 0 & k_{bd,k}^{\beta\beta\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq712-1}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{I}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\mathbf{I}
\end{aligned}
\,,\label{eq713-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{ac}^{\alpha\left(1,1\right)} & =N_{a}^{\left(1\right)}j_{n}^{\alpha}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\alpha\left(2,1\right)} & =-N_{b}^{\left(2\right)}j_{n}^{\alpha}\mathbf{a}_{c}^{\left(1\right)}
\end{aligned}
\,,\label{eq714-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq715-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\gamma\gamma\left(1,1\right)} & =-\varepsilon_{c}^{\gamma}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\gamma\gamma\left(1,2\right)} & =\varepsilon_{c}^{\gamma}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\gamma\gamma\left(2,1\right)} & =\varepsilon_{c}^{\gamma}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\gamma\gamma\left(2,2\right)} & =-\varepsilon_{c}^{\gamma}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\label{eq715-1b}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{c}^{\left(1\right)}=\frac{1}{J_{\eta}^{\left(1\right)}}\mathbf{n}^{\left(1\right)}\times\left(\mathbf{g}_{2}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)\,.\label{eq716-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Fluid Interface
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Fluid-Interface"

\end_inset

 
\end_layout

\begin_layout Standard
A tied fluid interface may be used to enforces continuity of viscous shear
 traction and normal fluid velocity at the interface between dissimilar
 meshes.
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Fluid-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluid-Mechanics"

\end_inset

 for a review of fluid materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"

\end_inset

 for additional details on the FEBio fluid solver.
 The tied fluid interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the viscous traction and normal fluid
 velocity, the external virtual work resulting from tractions 
\begin_inset Formula $\mathbf{t}^{\tau\left(i\right)}$
\end_inset

 and normal velocities 
\begin_inset Formula $v_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the tied interface integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau\left(1\right)}da^{\left(1\right)}\\
 & -\int_{\gamma^{\left(1\right)}}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}^{\left(1\right)}da^{\left(1\right)}\,.
\end{aligned}
\label{eq696-2}
\end{equation}

\end_inset

To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698-2}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & -\int_{\gamma^{\left(1\right)}}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}^{\tau}\equiv\mathbf{t}^{\tau\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $v_{n}\equiv v_{n}^{\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{v}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta J^{\left(i\right)}\right]\,.\label{eq700-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Fluid-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The premise of a tied interface is that the parametric coordinates of coincident
 points 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once by shooting a ray from the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the difference between tangential velocities across the interface
, is defined by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{v}_{t}^{\left(2\right)}-\mathbf{v}_{t}^{\left(1\right)}\,,\label{TFI-vt-gap}
\end{equation}

\end_inset

where the tangential velocity is evaluate from
\begin_inset Formula 
\begin{equation}
\mathbf{v}_{t}^{\left(i\right)}=\left(\mathbf{I}-\mathbf{n}^{\left(i\right)}\otimes\mathbf{n}^{\left(i\right)}\right)\cdot\mathbf{v}^{\left(i\right)}\,.\label{eq:TFI-vt}
\end{equation}

\end_inset

We may similarly define the scalar gap function 
\begin_inset Formula $\pi$
\end_inset

, representing the difference between fluid pressures across the interface,
\begin_inset Formula 
\begin{equation}
\pi=K\left(J^{\left(2\right)}-J^{\left(1\right)}\right)=K\left(e^{\left(2\right)}-e^{\left(1\right)}\right)\,,\label{eq:TFI-e-gap}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the fluid bulk modulus.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Penalty-Method-1"

\end_inset


\end_layout

\begin_layout Standard
Let the tied interface viscous traction be described by the penalty function,
 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{\tau}=\varepsilon_{t}\mathbf{g}\,,\label{eq:TFI-t-penalty}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{t}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

.
 The penalty factor 
\begin_inset Formula $\varepsilon_{t}$
\end_inset

 is expressed in units of viscosity per length.
 Therefore, in an auto-penalty scheme, it may be scaled to the ratio of
 fluid viscosity to element thickness.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
v_{n}=\varepsilon_{n}\pi=K\varepsilon_{n}\left(J^{\left(2\right)}-J^{\left(1\right)}\right)\,,\label{eq:TFI-v-penalty}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $v_{n}$
\end_inset

.
 Note that 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 has units of length per viscosity.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t}^{\tau} & =\varepsilon_{t}\left(\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)\cdot\Delta\mathbf{v}^{\left(2\right)}-\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\Delta\mathbf{v}^{\left(1\right)}\right)\,,\\
Dv_{n} & =K\varepsilon_{n}\left(\Delta J^{\left(2\right)}-\Delta J^{\left(1\right)}\right)\,.
\end{aligned}
\label{eq:TFI-penalty-linearization}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}\right)=\\
 & \varepsilon_{t}J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\Delta\mathbf{v}^{\left(1\right)}-\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)\cdot\Delta\mathbf{v}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq:TFI-G-linearization-v}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(v_{n}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=-\varepsilon_{n}KJ_{\eta}^{\left(1\right)}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)\left(\Delta J^{\left(1\right)}-\Delta J^{\left(2\right)}\right)\,,\label{eq:TFI-G-linearization-e}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization-2"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}-\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}\right]\,.\label{eq:TFI-discrete-1}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{v}_{c}^{\left(1\right)} & \Delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\delta J^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta J_{a}^{\left(1\right)} & \delta J^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta J_{b}^{\left(2\right)}\\
\Delta J^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta J_{c}^{\left(1\right)} & \Delta J^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta J_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq:TFI-discrete-2}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta J_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
v_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta J_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
v_{b,k}^{\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq:TFI-discrete-3}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t}^{\tau} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}^{\tau}\\
w_{a}^{\left(1\right)} & =-N_{a}^{\left(1\right)}v_{n} & w_{b,k}^{\left(2\right)} & =N_{b}^{\left(2\right)}v_{n}
\end{aligned}
\,.\label{eq:TFI-discrete-4}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta J_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0}\\
\mathbf{0} & k_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{c}^{\left(1\right)}\\
\Delta J_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\Delta J_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta J_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0}\\
\mathbf{0} & k_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{c}^{\left(1\right)}\\
\Delta J_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\Delta J_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq:TFI-discrete-5}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =\varepsilon_{t}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{t}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-\varepsilon_{t}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{t}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq:TFI-discrete-6}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-K\varepsilon_{n}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =K\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =K\varepsilon_{n}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-K\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq:TFI-discrete-7}
\end{equation}

\end_inset


\end_layout

\begin_layout Chapter
Dynamics
\begin_inset CommandInset label
LatexCommand label
name "chap:Dynamics"

\end_inset


\end_layout

\begin_layout Standard
FEBio can perform a nonlinear dynamic analysis by iteratively solving the
 following nonlinear semi-discrete finite element equations 
\begin_inset CommandInset citation
LatexCommand citep
key "Bathe82"

\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \mathbf{M\ddot{d}}_{n+1}^{k}+\mathbf{K}\Delta\mathbf{d}^{k}=\mathbf{T}_{n+1}^{k}-\mathbf{F}_{n+1}\\
 & \mathbf{d}_{n+1}^{k}=\mathbf{d}_{n+1}^{k-1}+\Delta\mathbf{d}^{k}
\end{aligned}
\,.\label{eq717}
\end{equation}

\end_inset

Here, 
\series bold

\begin_inset Formula $\mathbf{M}$
\end_inset


\series default
 is the mass matrix, 
\series bold

\begin_inset Formula $\mathbf{K}$
\end_inset


\series default
 the stiffness matrix, 
\series bold

\begin_inset Formula $\mathbf{T}$
\end_inset


\series default
 the internal force (stress) vector and 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
 the externally applied loads.
 The upperscript index 
\begin_inset Formula $k$
\end_inset

 refers to the iteration number, the subscript 
\begin_inset Formula $n$
\end_inset

refers to the time increment.
 The trapezoidal (or midpoint) rule is used to perform the time integration.
 This results in the following approximations for the displacement and velocity
 updates.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{d}_{n+1} & =\mathbf{d}_{n}+\frac{h}{2}\left(\mathbf{\dot{d}}_{n}+\mathbf{\dot{d}}_{n+1}\right)\\
\mathbf{\dot{d}}_{n+1} & =\mathbf{\dot{d}}_{n}+\frac{h}{2}\left(\mathbf{\ddot{d}}_{n}+\mathbf{\ddot{d}}_{n+1}\right)
\end{aligned}
\,.\label{eq718}
\end{equation}

\end_inset

Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq718"

\end_inset

 we can solve for 
\begin_inset Formula $\mathbf{\ddot{d}}_{n+1}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{\ddot{d}}_{n+1}^{k}=\frac{4}{h^{2}}\left(\mathbf{d}_{n+1}^{k-1}-\mathbf{d}_{n}+\Delta\mathbf{d}^{k}\right)-\frac{4}{h}\mathbf{\dot{d}}_{n}-\mathbf{\ddot{d}}_{n}\,.\label{eq719}
\end{equation}

\end_inset

Substituting this into equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq717"

\end_inset

 results in the following linear system of equations.
 
\begin_inset Formula 
\begin{equation}
\left(\frac{4}{h^{2}}\mathbf{M}+\mathbf{K}\right)\Delta\mathbf{d}^{k}=\mathbf{T}_{n+1}^{k}-\mathbf{F}_{n+1}-\mathbf{M}\left(\frac{4}{h^{2}}\left(\mathbf{d}_{n+1}^{k-1}-\mathbf{d}_{n}\right)-\frac{4}{h}\mathbf{\dot{d}}_{n}-\mathbf{\ddot{d}}_{n}\right)\,.\label{eq720}
\end{equation}

\end_inset

Solving this equation for 
\begin_inset Formula $\Delta\mathbf{d}^{k}$
\end_inset

 and using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq717"

\end_inset

 gives the new displacement vector 
\begin_inset Formula $\mathbf{d}_{n+1}^{k}$
\end_inset

 .
 The acceleration vector 
\begin_inset Formula $\mathbf{\ddot{d}}_{n+1}^{k}$
\end_inset

 can then be found from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq719"

\end_inset

 and the velocity vector 
\begin_inset Formula $\mathbf{\dot{d}}_{n+1}^{k}$
\end_inset

 from
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq719"

\end_inset

.
 This algorithm is repeated until convergence is reached.
\end_layout

\begin_layout Section
Elastodynamics
\end_layout

\begin_layout Subsection
Governing Equations
\end_layout

\begin_layout Standard
The linear momentum balance for elastodynamics is 
\begin_inset Formula 
\begin{equation}
\rho\mathbf{a}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,\label{eq:edy-solid-momentum}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the density, 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the acceleration, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress, and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the body force per mass.
 The angular momentum balance is satisfied by letting 
\begin_inset Formula $\boldsymbol{\sigma}^{T}=\boldsymbol{\sigma}$
\end_inset

.
 The integrated form of the mass balance equations yields
\begin_inset Formula 
\begin{equation}
\rho=\frac{\rho_{r}}{J}\,,\label{eq:edy-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the density in the reference configuration and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 The acceleration is given by the material time derivative of the velocity
 
\begin_inset Formula $\mathbf{v}$
\end_inset

, evaluated either in a spatial or a material frame,
\begin_inset Formula 
\begin{equation}
\mathbf{a}=\dot{\mathbf{v}}\label{eq:edy-acceleration}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Virtual Work
\end_layout

\begin_layout Standard
The virtual work for the domain 
\begin_inset Formula $b$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\delta W=\int_{b}\delta\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)\,dv\,,\label{eq:edy-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity.
 Using the divergence theorem, this virtual work may be expressed as the
 difference 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

 between external virtual work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 and internal virtual work 
\begin_inset Formula $\delta W_{int}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}\,dv+\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{a}\,dv\,,\\
\delta W_{ext} & =\int_{\partial b}\delta\mathbf{v}\cdot\mathbf{t}\,da+\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv\,,
\end{aligned}
\label{eq:edy-int-ext-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 is the traction on the boundary 
\begin_inset Formula $\partial b$
\end_inset

.
\end_layout

\begin_layout Subsection
Time Integration
\end_layout

\begin_layout Standard
In the generalized 
\begin_inset Formula $\alpha-$
\end_inset

method, we evaluate displacements and velocities at the intermediate time
 
\begin_inset Formula $t_{n+\alpha_{f}}=t_{n}+\alpha_{f}\left(t_{n+1}-t_{n}\right)$
\end_inset

, where 
\begin_inset Formula $\alpha_{f}$
\end_inset

 is a user-defined parameter (
\begin_inset Formula $0<\alpha_{f}\le1$
\end_inset

), such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\chi}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\boldsymbol{\chi}_{n}+\alpha_{f}\boldsymbol{\chi}_{n+1}\,,\\
\mathbf{u}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{u}_{n}+\alpha_{f}\mathbf{u}_{n+1}\,,\\
\mathbf{v}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{v}_{n}+\alpha_{f}\mathbf{v}_{n+1}\,,
\end{aligned}
\label{eq:edy-motion-interpolation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

 is the motion and 
\begin_inset Formula $\mathbf{u}$
\end_inset

 is the displacement.
 In particular, it follows that the deformation gradient and its determinant
 are given at the intermediate time by
\begin_inset Formula 
\begin{equation}
\mathbf{F}_{n+\alpha_{f}}=\frac{\partial\boldsymbol{\chi}_{n+\alpha_{f}}}{\partial\mathbf{X}}=\left(1-\alpha_{f}\right)\mathbf{F}_{n}+\alpha_{f}\mathbf{F}_{n+1}\,,\label{eq:edy-mp-defgrad}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
J_{n+\alpha_{f}}=\det\mathbf{F}_{n+\alpha_{f}}\,.\label{eq:edy-mp-detJ}
\end{equation}

\end_inset

The material time derivative of 
\begin_inset Formula $J_{n+\alpha_{f}}$
\end_inset

, and the velocity gradient 
\begin_inset Formula $\mathbf{L}_{n+\alpha_{f}}$
\end_inset

 are normally evaluated as
\begin_inset Formula 
\begin{equation}
\dot{J}_{n+\alpha_{f}}=J_{n+\alpha_{f}}\mathbf{F}_{n+\alpha_{f}}^{-T}:\Grad\mathbf{v}_{n+\alpha_{f}}\,,\label{eq:edy-Jdot-exact}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathbf{L}_{n+\alpha_{f}}=\Grad\mathbf{v}_{n+\alpha_{f}}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}\,.\label{eq:edy-L-exact}
\end{equation}

\end_inset

In practice however, we get better numerical results when using
\begin_inset Formula 
\begin{equation}
\dot{J}_{n+\alpha_{f}}=\frac{J_{n+1}-J_{n}}{\Delta t}\,,\label{eq:edy-Jdot-approx}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathbf{L}_{n+\alpha_{f}}=\frac{\mathbf{F}_{n+1}-\mathbf{F}_{n}}{\Delta t}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}\,.\label{eq:edy-L-approx}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
According to the generalized
\begin_inset Formula $-\alpha$
\end_inset

 method, we evaluate the velocity derivative at a different intermediate
 time 
\begin_inset Formula $t_{n+\alpha_{m}}=t_{n}+\alpha_{m}\left(t_{n+1}-t_{n}\right)$
\end_inset

, such that
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{v}}_{n+\alpha_{m}}=\left(1-\alpha_{m}\right)\dot{\mathbf{v}}_{n}+\alpha_{m}\dot{\mathbf{v}}_{n+1}\,.\label{eq:edy-vdot-interpolation}
\end{equation}

\end_inset

Since elastodynamics represent a second-order system of equations in time,
 the parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from a single parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 using 
\begin_inset CommandInset citation
LatexCommand citep
key "Bazilevs08"

\end_inset


\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{2-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas-2-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

.
 This parameter is the spectral radius for an infinite time step, which
 controls the amount of damping of high frequencies; a value of zero produces
 the greatest amount of damping, anihilating the highest frequency in one
 step, whereas a value of one preserves the highest frequency.
\end_layout

\begin_layout Standard
To complete the integration scheme 
\begin_inset CommandInset citation
LatexCommand citep
key "Jansen00"

\end_inset

, we evaluate
\begin_inset Formula 
\begin{equation}
\begin{aligned}\beta & =\frac{1}{4}\left(1+\alpha_{m}-\alpha_{f}\right)^{2}\\
\gamma & =\frac{1}{2}+\alpha_{m}-\alpha_{f}
\end{aligned}
\,,\label{eq:edy-Newmark}
\end{equation}

\end_inset

then we use
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{v}_{n+1} & =\mathbf{v}_{n}+\Delta t\left[\left(1-\gamma\right)\dot{\mathbf{v}}_{n}+\gamma\dot{\mathbf{v}}_{n+1}\right]\\
\mathbf{u}_{n+1} & =\mathbf{u}_{n}+\Delta t\mathbf{v}_{n}+\frac{\Delta t^{2}}{2}\left[\left(1-2\beta\right)\dot{\mathbf{v}}_{n}+2\beta\dot{\mathbf{v}}_{n+1}\right]\\
\dot{\mathbf{v}}_{n+1} & =\frac{1}{\beta\Delta t}\left(\frac{\mathbf{u}_{n+1}-\mathbf{u}_{n}}{\Delta t}-\mathbf{v}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\dot{\mathbf{v}}_{n}
\end{aligned}
\,.\label{eq:edy-current-time}
\end{equation}

\end_inset

At the start of each time step, we initialize the variables as follows:
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{u}_{n+1} & =\mathbf{u}_{n}\\
\dot{\mathbf{v}}_{n+1} & =\left(1-\frac{1}{2\beta}\right)\dot{\mathbf{v}}_{n}-\frac{1}{\beta\Delta t}\mathbf{v}_{n}\\
\mathbf{v}_{n+1} & =\left(1-\frac{\gamma}{\beta}\right)\mathbf{v}_{n}+\Delta t\left(1-\frac{\gamma}{2\beta}\right)\dot{\mathbf{v}}_{n}
\end{aligned}
\,.\label{eq:edy-initializations}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization
\end_layout

\begin_layout Standard
The solution of the nonlinear equation 
\begin_inset Formula $\delta W=0$
\end_inset

 is obtained by linearizing this relation as
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]\approx0\,,\label{eq:edy-linearized-virtual-work}
\end{equation}

\end_inset

where the operator 
\begin_inset Formula $D\delta W\left[\cdot\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $\delta W$
\end_inset

 at 
\begin_inset Formula $\mathbf{u}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 of 
\begin_inset Formula $\mathbf{u}_{n+1}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"

\end_inset

.
 According to the generalized
\begin_inset Formula $-\alpha$
\end_inset

 method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"

\end_inset

, the virtual work is evaluated using intermediate time step values, at
 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

 for all parameters except 
\begin_inset Formula $\dot{\mathbf{v}}$
\end_inset

, which is evaluated at 
\begin_inset Formula $t_{n+\alpha_{m}}$
\end_inset

.
 It follows from these definitions that the linearizations of critical variables
 are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{u}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Delta\mathbf{u}\\
D\mathbf{F}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Grad\Delta\mathbf{u}\\
DJ\left[\Delta\mathbf{u}\right] & =\alpha_{f}J\left(\divg\Delta\mathbf{u}\right)\\
D\dot{J}\left[\Delta\mathbf{u}\right] & =D\left(J\mathbf{F}^{-T}:\Grad\mathbf{v}\right)\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}J\left[\left(\divg\mathbf{v}+\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)-\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}\right]\\
D\mathbf{v}\left[\Delta\mathbf{u}\right] & =\frac{\alpha_{f}\gamma}{\beta\Delta t}\Delta\mathbf{u}\\
D\dot{\mathbf{v}}\left[\Delta\mathbf{u}\right] & =\frac{\alpha_{m}}{\beta\Delta t^{2}}\Delta\mathbf{u}
\end{aligned}
\,.\label{eq:edy-linearizations}
\end{equation}

\end_inset

To linearize the virtual work, we need to express the integrals appearing
 in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 and 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 over the material frame of the finite element solid domain.
\end_layout

\begin_layout Subsubsection
Internal Work
\end_layout

\begin_layout Standard
The first term in the internal work becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}\,dv & =\int_{B}\mathbf{F}\cdot\mathbf{S}:\Grad\delta\mathbf{v}\,dV\end{aligned}
\,,\label{eq:work-material-1-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}=J\cdot\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}$
\end_inset

 is the second Piola-Kirchhoff stress for the solid material.
 In general, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 (and thus, 
\begin_inset Formula $\mathbf{S}$
\end_inset

) is only a function of the solid strain, such as the right Cauchy-Green
 tensor 
\begin_inset Formula $\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}$
\end_inset

 or the Green-Lagrange strain 
\begin_inset Formula $\mathbf{E}=\left(\mathbf{C}-\mathbf{I}\right)/2$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
D\mathbf{E}\left[\Delta\mathbf{u}\right]=\frac{\alpha_{f}}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)\,.\label{eq:edy-E-linearization}
\end{equation}

\end_inset

Therefore, following the standard approach in solid mechanics, the linearization
 of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{S}\left[\Delta\mathbf{u}\right] & =\frac{\partial\mathbf{S}}{\partial\mathbf{E}}:D\mathbf{E}\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}:\frac{1}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right):\Delta\boldsymbol{\varepsilon}
\end{aligned}
\,,\label{eq:edy-solid-stress-linearization}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbb{C}}$
\end_inset

 is the material elasticity tensor.
 Now, the linearization of the first term in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\mathbf{F}\cdot\mathbf{S}:\Grad\delta\mathbf{v}\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{v}\alpha_{f}\left(\grad\delta\mathbf{v}:\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}+\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}:\grad\Delta\mathbf{u}\right)\,dv
\end{aligned}
}\,.\label{eq:edy-Dint-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor.
 Similarly, the second term in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{v}\cdot\rho_{r}\mathbf{a}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\delta\mathbf{v}\cdot\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho\Delta\mathbf{u}\,dv}\,.\label{eq:edy-Dint-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
External Work
\end_layout

\begin_layout Standard
The linearization of the body force term is
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}\delta\mathbf{v}\cdot\rho_{r}\mathbf{b}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\delta\mathbf{v}\cdot\alpha_{f}\rho\grad\mathbf{b}\cdot\Delta\mathbf{u}\,dv\,.\label{eq:edy-Dext}
\end{equation}

\end_inset

The linearization of the traction force term is
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(\int_{\Gamma_{\eta}}\delta\mathbf{v}\cdot\mathbf{t}\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{\Gamma_{\eta}}\alpha_{f}\delta\mathbf{v}\cdot\left(\mathbf{t}\otimes\mathbf{n}\right)\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\,d\eta^{1}d\eta^{2}\\
 & +\int_{\Gamma_{\eta}}\delta\mathbf{v}\cdot D\mathbf{t}\left[\Delta\mathbf{u}\right]\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}
\end{aligned}
\,.\label{eq:edy-Dext-final}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $D\mathbf{t}\left[\Delta\mathbf{u}\right]$
\end_inset

 depends on the nature of the surface traction.
 For a prescribed traction we have 
\begin_inset Formula $D\mathbf{t}\left[\Delta\mathbf{u}\right]=\mathbf{0}$
\end_inset

.
 A contact analysis needs more elaborate derivations (not yet implemented
 as of FEBio 2.7).
 In the above expression we used
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\left[\Delta\mathbf{u}\right] & =\mathbf{n}\cdot D\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}\mathbf{n}\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)
\end{aligned}
\label{eq:edy-Dext-DA}
\end{equation}

\end_inset

where the unit outward normal is evaluated as
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq:edy-unit-normal}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization
\end_layout

\begin_layout Standard
We use the following interpolations:
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum_{a}N_{a}\delta\mathbf{v}_{a} & \Delta\mathbf{u} & =\sum_{b}N_{b}\Delta\mathbf{u}_{b}\\
\grad\delta\mathbf{v} & =\sum_{a}\delta\mathbf{v}_{a}\otimes\grad N_{a} & \grad\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\otimes\grad N_{b}\\
\divg\delta\mathbf{v} & =\sum_{a}\delta\mathbf{v}_{a}\cdot\grad N_{a} & \divg\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\cdot\grad N_{b}
\end{aligned}
\,,\label{eq:interpolations-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}\left(\eta^{1},\eta^{2},\eta^{3}\right)$
\end_inset

 are shape functions of the element parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2},\eta^{3}\right)$
\end_inset

.
 Note that the 
\begin_inset Formula $\grad\equiv\frac{\partial}{\partial\mathbf{x}}$
\end_inset

 operator should be evaluated at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

, using 
\begin_inset Formula $\mathbf{x}_{n+\alpha_{f}}$
\end_inset

.
 For example, in the case of a scalar function 
\begin_inset Formula $f$
\end_inset

,
\begin_inset Formula 
\[
\begin{aligned}\grad f & =\frac{\partial f}{\partial\mathbf{x}_{n+\alpha_{f}}}=\frac{\partial f}{\partial\eta^{i}}\mathbf{g}_{n+\alpha_{f}}^{i}\\
\mathbf{g}_{n+\alpha_{f}}^{i} & =\frac{\partial\eta^{i}}{\partial\mathbf{x}_{n+\alpha_{f}}}
\end{aligned}
\,,
\]

\end_inset

where the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}_{n+\alpha_{f}}^{i}$
\end_inset

 may be evaluated from the covariant basis vectors
\begin_inset Formula 
\[
\mathbf{g}_{i}^{n+\alpha_{f}}=\frac{\partial\mathbf{x}_{n+\alpha_{f}}}{\partial\eta^{i}}=\left(1-\alpha_{f}\right)\frac{\partial\mathbf{x}_{n}}{\partial\eta^{i}}+\alpha_{f}\frac{\partial\mathbf{x}_{n+1}}{\partial\eta^{i}}
\]

\end_inset

using 
\begin_inset Formula $\mathbf{g}_{i}^{n+\alpha_{f}}\cdot\mathbf{g}_{n+\alpha_{f}}^{j}=\delta_{i}^{j}$
\end_inset

.
\end_layout

\begin_layout Standard
The discretization of the internal work produces
\begin_inset Formula 
\begin{equation}
\delta W_{int}=\sum_{a}\delta\mathbf{v}_{a}\cdot\int_{b}\left(\mathbf{f}_{a}^{u}+\mathbf{f}_{a}^{\rho}\right)\,dv\,,\label{eq:edy-discretized-internal-work}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{f}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\\
\mathbf{f}_{a}^{\rho} & =N_{a}\rho\mathbf{a}
\end{aligned}
}\,.\label{eq:edy-discretized-residuals}
\end{equation}

\end_inset

The discretization of the stress and elasticity terms in the internal work
 is
\begin_inset Formula 
\[
\begin{aligned} & \int_{v}\alpha_{f}\left(\grad\delta\mathbf{v}:\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}+\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}:\grad\Delta\mathbf{u}\right)\,dv\\
 & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\int_{v}\mathbf{K}_{ab}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\,,
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}=\alpha_{f}\left(\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}+\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}\right)}\,.\label{eq:edy-Wint-Kab}
\end{equation}

\end_inset

The discretization of the mass term in the internal work is
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}\cdot\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho\Delta\mathbf{u}\,dv=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\int_{b}\mathbf{M}_{ab}\,dv\cdot\Delta\mathbf{u}_{b}\,,
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{M}_{ab}=\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho N_{a}N_{b}\mathbf{I}}\,.\label{eq:edy-Wint-Mab}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work of body forces,
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv=\sum_{a}\delta\mathbf{v}_{a}\cdot\int_{b}\mathbf{f}_{a}^{\mathbf{b}}\,dv
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}_{a}^{\mathbf{b}}=N_{a}\rho^{s}\mathbf{b}}\,,\label{eq:edy-Wext-fb}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}^{s}\cdot\alpha_{f}\rho^{s}\grad\mathbf{b}\cdot\Delta\mathbf{u}\,dv=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{\mathbf{b}}\,dv\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{\mathbf{b}}=\alpha_{f}N_{a}N_{b}\rho^{s}\grad\mathbf{b}}\,.\label{eq:edy-Wext-Kb}
\end{equation}

\end_inset

For prescribed tractions,
\begin_inset Formula 
\[
\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}^{s}\,da=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\int_{\Gamma_{\eta}}\mathbf{f}_{a}^{t}\,d\eta^{1}d\eta^{2}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}_{a}^{t}=N_{a}\mathbf{t}^{s}\,\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\label{eq:edy-Wext-ft}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned} & \int_{\Gamma_{\eta}}\alpha_{f}\delta\mathbf{v}^{s}\cdot\left(\mathbf{t}^{s}\otimes\mathbf{n}\right)\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\,d\eta^{1}d\eta^{2}\\
 & =\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{\Gamma_{\eta}}\mathbf{K}_{ab}^{t}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{t}=\alpha_{f}N_{a}\left(\mathbf{t}^{s}\otimes\mathbf{n}\right)\cdot\left(\frac{\partial N_{b}}{\partial\eta^{2}}\hat{\mathbf{g}}_{1}-\frac{\partial N_{b}}{\partial\eta^{1}}\hat{\mathbf{g}}_{2}\right)}\,,\label{eq:edy-Wext-Kt}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{g}}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{g}$
\end_inset

.
\end_layout

\begin_layout Subsection
Energy-Momentum Conservation Scheme
\end_layout

\begin_layout Standard
The time discretization scheme may be selected in a manner that enforces
 linear and angular momentum, and energy conservation over consecutive time
 steps 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

, when boundary conditions and external loads are time-independent.
 Based on the prior literature 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo92a,Gonzalez00,Puso02"

\end_inset

, this momentum and energy conservation may be achieved by using the midpoint
 rule (
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

, leading to 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\frac{1}{2}$
\end_inset

), and evaluating the virtual work at 
\begin_inset Formula $t_{n+\frac{1}{2}}$
\end_inset

.
 However, since the virtual work strictly enforces momentum balance only,
 there is no guarantee that energy conservation will be satisfied as a result
 of time discretization.
 Therefore, we need to enforce a specific scheme to satisfy energy balance.
\end_layout

\begin_layout Subsubsection
Energy Balance
\end_layout

\begin_layout Standard
For an elastic solid, in the absence of heat exchanges (i.e., in elastodynamics),
 the equation of energy balance reduces
\begin_inset Formula 
\begin{equation}
\rho\dot{\varepsilon}=\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the specific internal energy and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 is the rate of deformation tensor.
 Recall that 
\begin_inset Formula $\varepsilon=\psi+\theta\eta$
\end_inset

, where 
\begin_inset Formula $\psi$
\end_inset

 is the specific free energy, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature and 
\begin_inset Formula $\eta$
\end_inset

 is the specific entropy.
 Since 
\begin_inset Formula $\eta=0$
\end_inset

 in elasticity (due to the temperature remaining constant), the above energy
 balance may be combined with the mass balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-mass-balance"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\rho\dot{\psi}=\frac{\rho_{r}}{J}\dot{\psi}=\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-r1}
\end{equation}

\end_inset

or
\begin_inset Formula 
\begin{equation}
\dot{\Psi}_{r}=J\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-r2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{r}=\rho_{r}\psi$
\end_inset

 is the free energy density (per volume of the material in the reference
 configuration).
\end_layout

\begin_layout Standard
In our time integration scheme, to satisfy energy balance, this equation
 needs to be evaluated at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\left(\dot{\Psi}_{r}\right)_{n+\alpha_{f}}=J_{n+\alpha_{f}}\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\,.\label{eq:edy-mp-energy}
\end{equation}

\end_inset

However, the solution for 
\begin_inset Formula $\boldsymbol{\sigma}_{n+\alpha_{f}}\equiv\boldsymbol{\sigma}\left(\mathbf{F}_{n+\alpha_{f}}\right)$
\end_inset

 obtained from the momentum balance may not necessarity satisfy this equation.
 Thus, to satisfy energy balance over consecutive time steps, we want to
 evaluate an effective stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}$
\end_inset

 such that
\begin_inset Formula 
\begin{equation}
J_{n+\alpha_{f}}\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}=\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{\Delta t}\,.\label{eq:edy-energy-discretized}
\end{equation}

\end_inset

To find a solution for 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}$
\end_inset

, we follow the procedure of Gonzalez 
\begin_inset CommandInset citation
LatexCommand citep
key "Gonzalez00"

\end_inset

 and let
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}+f\mathbf{D}_{n+\alpha_{f}}\,,\label{eq:edy-eff-stress-model}
\end{equation}

\end_inset

where 
\begin_inset Formula $f$
\end_inset

 is some scalar function to be determined.
 Substituting this relation, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-eff-stress-model"

\end_inset

, into the previous equation, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-energy-discretized"

\end_inset

, produces
\begin_inset Formula 
\begin{equation}
f=\left(\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{J_{n+\alpha_{f}}^{s}\Delta t}-\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\right)\frac{1}{\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}}\,.\label{eq:edy-eff-stress-f}
\end{equation}

\end_inset

Hence, the equation for an effective stress needed to satisfy energy balance
 between consecutive time steps is
\begin_inset Formula 
\begin{equation}
\boxed{\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}+\left(\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{J_{n+\alpha_{f}}\Delta t}-\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\right)\frac{\mathbf{D}_{n+\alpha_{f}}}{\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}}}\,.\label{eq:edy-eff-stress-final}
\end{equation}

\end_inset

In the limit when 
\begin_inset Formula $\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}=0$
\end_inset

, we use 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}$
\end_inset

.
 Recall that this scheme produces conservation of linear and angular momentum
 and total energy only with 
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

, or equivalently, 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\frac{1}{2}$
\end_inset

, 
\begin_inset Formula $\beta=\frac{1}{2}$
\end_inset

 and 
\begin_inset Formula $\gamma=1$
\end_inset

.
 Therefore, this effective stress calculation is only applied when the user
 employs 
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

.
\end_layout

\begin_layout Section
Rigid Body Dynamics
\end_layout

\begin_layout Subsection
Rigid Body Rotation
\end_layout

\begin_layout Standard
Conventionally, the rigid body rotation tensor 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 corresponding to a rotation of angle 
\begin_inset Formula $\chi$
\end_inset

 about the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

 may be expressed in terms of the vector 
\begin_inset Formula $\boldsymbol{\chi}=\chi\mathbf{n}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\cos\chi\,\mathbf{I}-\sin\chi\,\boldsymbol{\mathcal{E}}\cdot\mathbf{n}+\left(1-\cos\chi\right)\mathbf{n}\otimes\mathbf{n}\label{eq:rbr-rotation-tensor}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{E}}$
\end_inset

 is the third-order permutation pseudo-tensor with Cartesian components
 
\begin_inset Formula $\varepsilon_{ijk}$
\end_inset

.
 Making use of the trigonometric identity,
\begin_inset Formula 
\begin{equation}
\cos\chi=1-2\sin^{2}\frac{1}{2}\chi\,,\label{eq:rbr-identity-1}
\end{equation}

\end_inset

this expression may be rearranged as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\mathbf{I}-\frac{\sin\chi}{\chi}\,\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}+\frac{2}{\chi^{2}}\sin^{2}\frac{1}{2}\chi\left(\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\right)^{2}\,,\label{eq:rbr-rotation-tensor-alt-1}
\end{equation}

\end_inset

where we have made use of the identity
\begin_inset Formula 
\begin{equation}
\left(\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\right)^{2}=\boldsymbol{\chi}\otimes\boldsymbol{\chi}-\chi^{2}\mathbf{I}\,.\label{eq:rbr-identity-2}
\end{equation}

\end_inset

Letting
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\chi}}=-\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\label{eq:rbr-antisymmetric-tensor}
\end{equation}

\end_inset

represent the antisymmetric tensor with axial vector 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)$
\end_inset

 may now be represented as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)\equiv\exp\left[\hat{\boldsymbol{\chi}}\right]=\mathbf{I}+\frac{\sin\chi}{\chi}\hat{\boldsymbol{\chi}}+\frac{2}{\chi^{2}}\sin^{2}\frac{1}{2}\chi\,\hat{\boldsymbol{\chi}}^{2}\,,\label{eq:rbr-rotation-tensor-alt-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\exp\left[\hat{\boldsymbol{\chi}}\right]$
\end_inset

 is known as the
\emph on
 exponential map
\emph default
.
 Thus, the exponential map provides the rotation tensor for a rotation 
\begin_inset Formula $\chi$
\end_inset

 about the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 Note that 
\begin_inset Formula $\boldsymbol{\Lambda}\cdot\boldsymbol{\chi}=\boldsymbol{\chi}$
\end_inset

, since 
\begin_inset Formula $\hat{\boldsymbol{\chi}}\cdot\boldsymbol{\chi}=\boldsymbol{\chi}\times\boldsymbol{\chi}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 be any orthogonal transformation, then
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{Q}\cdot\exp\left[\hat{\boldsymbol{\chi}}\right]\cdot\mathbf{Q}^{T} & =\mathbf{I}+\frac{\sin\chi}{\chi}\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}+\frac{2}{\chi^{2}}\sin^{2}\frac{1}{2}\chi\left(\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}\right)^{2}\\
 & =\exp\left[\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}\right]\equiv\exp\left[\hat{\boldsymbol{\theta}}\right]
\end{aligned}
\label{eq:rbr-orthogonal-transformation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\boldsymbol{\theta}}=\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}$
\end_inset

 and its corresponding axial vector is 
\begin_inset Formula $\boldsymbol{\theta}=\mathbf{Q}\cdot\boldsymbol{\chi}$
\end_inset

, implying that 
\begin_inset Formula $\theta=\chi$
\end_inset

.
 This property of the exponential map is used in the next derivation.
\end_layout

\begin_layout Standard
Consider a vector 
\begin_inset Formula $\mathbf{Z}$
\end_inset

 in the reference configuration of a rigid body.
 Upon rigid body rotation, this vector is currently at
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}\,.\label{eq:rbr-rotation-t}
\end{equation}

\end_inset

The corresponding axial vector of 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is 
\begin_inset Formula $\boldsymbol{\chi}\left(t\right)$
\end_inset

.
 At a subsequent time 
\begin_inset Formula $t^{\prime}$
\end_inset

, we would similarly have 
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t^{\prime}\right)=\boldsymbol{\Lambda}\left(t^{\prime}\right)\cdot\mathbf{Z}=\exp\left[\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}\,,\label{eq:rbr-orthogonal-rotation-t-prime}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the incremental (finite) rotation from 
\begin_inset Formula $t$
\end_inset

 to 
\begin_inset Formula $t^{\prime}$
\end_inset

.
 Alternatively, we may choose to write
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t^{\prime}\right)=\boldsymbol{\Lambda}\left(t^{\prime}\right)\cdot\mathbf{Z}=\boldsymbol{\Lambda}\left(t\right)\cdot\exp\left[\hat{\boldsymbol{\Theta}}\right]\cdot\mathbf{Z}\,,\label{eq:rbr-incremental-finite-rotation}
\end{equation}

\end_inset

such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\Lambda}\left(t^{\prime}\right) & =\exp\left[\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\left(t\right)\\
 & =\boldsymbol{\Lambda}\left(t\right)\cdot\exp\left[\hat{\boldsymbol{\Theta}}\right]
\end{aligned}
\,,\label{eq:rbr-material-spatial-increments}
\end{equation}

\end_inset

implying that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\exp\left[\hat{\boldsymbol{\theta}}\right] & =\exp\left[\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\boldsymbol{\Theta}}\cdot\boldsymbol{\Lambda}^{T}\left(t\right)\right]\\
\boldsymbol{\theta} & =\boldsymbol{\Lambda}\left(t\right)\cdot\boldsymbol{\Theta}
\end{aligned}
\,.\label{eq:rbr-material-spatial-redux}
\end{equation}

\end_inset

Note from these relations that 
\begin_inset Formula $\theta=\Theta$
\end_inset

.
 Thus, 
\begin_inset Formula $\boldsymbol{\Theta}$
\end_inset

 is the material representation of the incremental rotation from 
\begin_inset Formula $t$
\end_inset

 to 
\begin_inset Formula $t^{\prime}$
\end_inset

, while 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the corresponding spatial representation.
\end_layout

\begin_layout Subsection
Cayley Transform
\end_layout

\begin_layout Standard
An alternative to the exponential map is the Cayley transform,
\begin_inset Formula 
\[
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\cay\left[\hat{\boldsymbol{\chi}}\right]=\mathbf{I}+\frac{2}{1+\left(\frac{1}{2}\chi\right)^{2}}\left(\frac{1}{2}\hat{\boldsymbol{\chi}}+\frac{1}{4}\hat{\boldsymbol{\chi}}^{2}\right)
\]

\end_inset

which is a second order approximation to the exponential map.
 This formula is a correction to that appearing in 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"

\end_inset

 (which has 
\begin_inset Formula $\frac{1}{2}\chi^{2}$
\end_inset

 in the denominator).
 Comparing this expression to the exponential map,
\begin_inset Formula 
\[
\exp\left[\hat{\boldsymbol{\theta}}\right]=\mathbf{I}+\frac{\sin\theta}{\theta}\hat{\boldsymbol{\theta}}+\frac{2}{\theta^{2}}\sin^{2}\frac{1}{2}\theta\,\hat{\boldsymbol{\theta}}^{2}
\]

\end_inset

we find that
\begin_inset Formula 
\[
\boldsymbol{\chi}=2\tan\frac{\theta}{2}\,\mathbf{n}
\]

\end_inset


\end_layout

\begin_layout Standard
It can be verified that 
\begin_inset Formula $\boldsymbol{\Lambda}\cdot\boldsymbol{\Lambda}^{T}=\mathbf{I}$
\end_inset

.
 In this case,
\begin_inset Formula 
\[
\boldsymbol{\Lambda}_{\varepsilon}=\cay\left[\varepsilon\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}
\]

\end_inset

and the linearization of 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 along the increment 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is obtained from
\begin_inset Formula 
\[
\begin{aligned}D\boldsymbol{\Lambda}\left[\boldsymbol{\theta}\right] & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}\cay\left[\varepsilon\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\\
 & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}\left(\mathbf{I}+\frac{2}{1+\frac{1}{4}\varepsilon^{2}\theta^{2}}\left(\frac{1}{2}\varepsilon\hat{\boldsymbol{\theta}}+\frac{1}{4}\varepsilon^{2}\hat{\boldsymbol{\theta}}^{2}\right)\right)\cdot\boldsymbol{\Lambda}\\
 & =\hat{\boldsymbol{\theta}}\cdot\boldsymbol{\Lambda}
\end{aligned}
\]

\end_inset

producing the same result as for the exponential map.
 Similarly,
\begin_inset Formula 
\[
D\boldsymbol{\Lambda}\left[\boldsymbol{\Theta}\right]=\boldsymbol{\Lambda}\cdot\hat{\boldsymbol{\Theta}}
\]

\end_inset

A special property of the Cayley transform emerges as follows.
 If 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the angular increment from 
\begin_inset Formula $t_{n}$
\end_inset

 to 
\begin_inset Formula $t_{n+1}$
\end_inset

, it can be shown that
\begin_inset Formula 
\[
\boldsymbol{\theta}\times\frac{1}{2}\left(\mathbf{z}_{n+1}+\mathbf{z}_{n}\right)=\mathbf{z}_{n+1}-\mathbf{z}_{n}\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
General Rigid Body Motion
\end_layout

\begin_layout Standard
If the point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is connected to a rigid body, its motion is given by
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{r}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}=\mathbf{r}\left(t\right)+\mathbf{z}\left(t\right)\label{eq:rbm-position}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}\left(t\right)$
\end_inset

 is the position of the rigid body center of mass and 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is the body's rotation tensor, which satisfies 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t_{0}\right)=\mathbf{I}$
\end_inset

 at the initial time 
\begin_inset Formula $t_{0}$
\end_inset

; here, 
\begin_inset Formula $\mathbf{z}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}$
\end_inset

 is the distance of the point from the body's center of mass, and 
\begin_inset Formula $\mathbf{X}=\mathbf{r}\left(t_{0}\right)+\mathbf{Z}$
\end_inset

 is the initial position.
 The velocity of that point is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{x}} & =\dot{\mathbf{r}}\left(t\right)+\dot{\boldsymbol{\Lambda}}\left(t\right)\cdot\mathbf{Z}\end{aligned}
\,,\label{eq:rbm-velocity}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\dot{\boldsymbol{\Lambda}}\left(t\right)=\hat{\boldsymbol{\omega}}\left(t\right)\cdot\boldsymbol{\Lambda}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\mathbf{W}}\left(t\right)\,.\label{eq:rbm-lambda-dot}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\hat{\boldsymbol{\omega}}$
\end_inset

 is an antisymmetric tensor with axial vector 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

 which represents the spatial angular velocity vector; similarly, 
\begin_inset Formula $\hat{\mathbf{W}}$
\end_inset

 is an antisymmetric tensor with axial vector 
\begin_inset Formula $\mathbf{W}$
\end_inset

 (the material angular velocity), such that 
\begin_inset Formula $\boldsymbol{\omega}=\boldsymbol{\Lambda}\cdot\mathbf{W}$
\end_inset

 and
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\omega}}=\boldsymbol{\Lambda}\cdot\hat{\mathbf{W}}\cdot\boldsymbol{\Lambda}^{T}\,.\label{eq:rbm-material-spatial-angular-velocity}
\end{equation}

\end_inset

We may now rewrite
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{x}} & =\dot{\mathbf{r}}\left(t\right)+\hat{\boldsymbol{\omega}}\left(t\right)\cdot\mathbf{z}\left(t\right)\\
 & =\dot{\mathbf{r}}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\mathbf{W}}\left(t\right)\cdot\mathbf{Z}
\end{aligned}
\,,\label{eq:rbm-rigid-point-velocity}
\end{equation}

\end_inset

so that the acceleration of the point is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\ddot{\mathbf{x}} & =\ddot{\mathbf{r}}\left(t\right)+\left(\hat{\boldsymbol{\alpha}}\left(t\right)+\hat{\boldsymbol{\omega}}^{2}\left(t\right)\right)\cdot\mathbf{z}\\
 & =\ddot{\mathbf{r}}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\left(\hat{\mathbf{A}}\left(t\right)+\hat{\mathbf{W}}^{2}\left(t\right)\right)\cdot\mathbf{Z}
\end{aligned}
\,,\label{eq:rbm-rigid-point-acceleration}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\alpha}=\dot{\boldsymbol{\omega}}=\boldsymbol{\Lambda}\cdot\mathbf{A}$
\end_inset

 is the spatial angular acceleration vector, 
\begin_inset Formula $\mathbf{A}=\dot{\mathbf{W}}$
\end_inset

 is the material angular acceleration vector.
 As shown below, the time discretization is performed in the material frame.
\end_layout

\begin_layout Subsection
Rigid Body Momentum
\end_layout

\begin_layout Standard
For a rigid body, the conservation of linear momentum is given by
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\left(m\dot{\mathbf{r}}\right)=\dot{\mathbf{p}}=\mathbf{f}^{ext}\left(t\right)\label{eq:rbm-linear-momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $m$
\end_inset

 is the mass of the rigid body, 
\begin_inset Formula $\dot{\mathbf{r}}$
\end_inset

 is the velocity of the center of mass, 
\begin_inset Formula $\mathbf{p}=m\dot{\mathbf{r}}$
\end_inset

 is the linear momentum, and 
\begin_inset Formula $\mathbf{f}^{ext}\left(t\right)$
\end_inset

 represents the sum of external forces acting on the body.
 Here, 
\begin_inset Formula $m$
\end_inset

 is constant for a rigid body.
 There are typically four contributions to 
\begin_inset Formula $\mathbf{f}^{ext}\left(t\right)$
\end_inset

: Body forces 
\begin_inset Formula $\mathbf{f}_{b}^{ext}\left(t\right)=m\mathbf{b}\left(t\right)$
\end_inset

 (where 
\begin_inset Formula $\mathbf{b}$
\end_inset

 represents the body force per mass, such as gravitational acceleration),
 other user-prescribed forces 
\begin_inset Formula $\mathbf{f}_{p}^{ext}\left(t\right)$
\end_inset

 (which act at the center of mass), forces 
\begin_inset Formula $\mathbf{f}_{c}^{ext}\left(t\right)$
\end_inset

 produced by rigid body connectors (such as revolute and prismatic joints,
 or contact forces), and forces 
\begin_inset Formula $\mathbf{f}_{f}^{ext}\left(t\right)$
\end_inset

 produced by rigid-flexible connections (where deformable materials interface
 with the rigid body), in which case 
\begin_inset Formula $\mathbf{f}_{f}^{ext}$
\end_inset

 is evaluated from the traction 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 over that interface, with 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 representing the stress in the deformable material.
\end_layout

\begin_layout Standard
The conservation of angular momentum is similarly given by
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\left(\mathbf{J}\cdot\boldsymbol{\omega}\right)=\dot{\mathbf{h}}=\boldsymbol{\omega}\times\mathbf{h}+\mathbf{J}\cdot\boldsymbol{\alpha}=\mathbf{m}^{ext}\left(t\right)\label{eq:rbm-angular-momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{J}$
\end_inset

 is the rigid body mass moment of inertia about its center of mass, 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

 is its angular velocity, 
\begin_inset Formula $\mathbf{h}=\mathbf{J}\cdot\boldsymbol{\omega}$
\end_inset

 is its angular momentum, 
\begin_inset Formula $\boldsymbol{\alpha}=\dot{\boldsymbol{\omega}}$
\end_inset

 is the rigid body angular acceleration, and 
\begin_inset Formula $\mathbf{m}^{ext}\left(t\right)$
\end_inset

 is the sum of moments acting on the rigid body.
 External moments include contributions from user-prescribed moments/torques
 
\begin_inset Formula $\mathbf{m}_{p}^{ext}\left(t\right)$
\end_inset

, from rigid body connectors, 
\begin_inset Formula $\mathbf{m}_{c}^{ext}\left(t\right)=\mathbf{z}_{c}\left(t\right)\times\mathbf{f}_{c}^{ext}\left(t\right)$
\end_inset

 where 
\begin_inset Formula $\mathbf{z}_{c}\left(t\right)$
\end_inset

 is the connector insertion relative to the rigid body center of mass, and
 rigid-flexible interfaces, 
\begin_inset Formula $\mathbf{m}_{f}^{ext}\left(t\right)=\mathbf{z}_{f}\left(t\right)\times\mathbf{f}_{f}^{ext}\left(t\right)$
\end_inset

 where 
\begin_inset Formula $\mathbf{z}_{f}\left(t\right)$
\end_inset

 is the position of the interface point relative to the rigid body center
 of mass.
 Since body forces 
\begin_inset Formula $\mathbf{f}_{b}^{ext}$
\end_inset

 and user-prescribed forces 
\begin_inset Formula $\mathbf{f}_{p}^{ext}$
\end_inset

 act at the center of mass, they do not contribute to 
\begin_inset Formula $\mathbf{m}^{ext}\left(t\right)$
\end_inset

.
 Note that
\begin_inset Formula 
\begin{equation}
\mathbf{J}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{J}_{r}\cdot\boldsymbol{\Lambda}^{T}\left(t\right)\,,\label{eq:rbm-moi-rotation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{J}_{r}$
\end_inset

 is the moment of inertia in the reference configuration and 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is the rotation tensor representing the orientation of the rigid body at
 time 
\begin_inset Formula $t$
\end_inset

, with 
\begin_inset Formula $\boldsymbol{\Lambda}=\mathbf{I}$
\end_inset

 in the reference configuration.
 
\end_layout

\begin_layout Standard
The virtual work statement is given by
\begin_inset Formula 
\begin{equation}
\delta W=\delta\mathbf{r}\cdot\left(\mathbf{f}^{ext}\left(t\right)-\dot{\mathbf{p}}\right)+\delta\boldsymbol{\theta}\cdot\left(\mathbf{m}^{ext}\left(t\right)-\dot{\mathbf{h}}\right)\,,\label{eq:rbm-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{r}$
\end_inset

 is the virtual displacement of the center of mass and 
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

 is the virtual rotation of the rigid body.
 
\end_layout

\begin_layout Subsection
Time Discretization (Standard)
\end_layout

\begin_layout Standard
According to Simo and Wong 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91a"

\end_inset

, to solve numerically for 
\begin_inset Formula $\delta W=0$
\end_inset

 over the time domain, we start from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbm-virtual-work"

\end_inset

 and integrate this expression with respect to time using the midpoint rule,
 thus producing
\begin_inset Formula 
\[
\delta\mathbf{r}\cdot\left(\mathbf{f}_{n+\frac{1}{2}}^{ext}-\frac{m}{\Delta t}\left(\dot{\mathbf{r}}_{n+1}-\dot{\mathbf{r}}_{n}\right)\right)+\delta\boldsymbol{\theta}\cdot\left(\mathbf{m}_{n+\frac{1}{2}}^{ext}-\frac{1}{\Delta t}\left(\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}-\mathbf{J}_{n}\cdot\boldsymbol{\omega}_{n}\right)\right)=0\,,
\]

\end_inset

or equivalently,
\begin_inset Formula 
\[
\left[\begin{array}{cc}
\delta\mathbf{r} & \delta\boldsymbol{\theta}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{n+\frac{1}{2}}^{ext}-\frac{m}{\Delta t}\left(\dot{\mathbf{r}}_{n+1}-\dot{\mathbf{r}}_{n}\right)\\
\mathbf{m}_{n+\frac{1}{2}}^{ext}-\frac{1}{\Delta t}\left(\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}-\mathbf{J}_{n}\cdot\boldsymbol{\omega}_{n}\right)
\end{array}\right]=0\,.
\]

\end_inset

In these expressions, the external forces and moments at the midpoint are
 evaluate from
\begin_inset Formula 
\[
\mathbf{f}_{n+\frac{1}{2}}^{ext}=\frac{1}{2}\left(\mathbf{f}_{n+1}^{ext}+\mathbf{f}_{n}^{ext}\right)\,,\quad\mathbf{m}_{n+\frac{1}{2}}^{ext}=\frac{1}{2}\left(\mathbf{m}_{n+1}^{ext}+\mathbf{m}_{n}^{ext}\right)\,.
\]

\end_inset

Thus, the residual vector is given by
\begin_inset Formula 
\[
\left[\mathbf{R}\left(t_{n+1}\right)\right]=\left[\begin{array}{c}
\mathbf{f}_{n+\frac{1}{2}}^{ext}\\
\mathbf{m}_{n+\frac{1}{2}}^{ext}
\end{array}\right]-\left[\begin{array}{c}
\dot{\mathbf{p}}_{n+1}\\
\dot{\mathbf{h}}_{n+1}
\end{array}\right]
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{p}}_{n+1} & =m\frac{\dot{\mathbf{r}}_{n+1}-\dot{\mathbf{r}}_{n}}{\Delta t}\\
\dot{\mathbf{h}}_{n+1} & =\frac{\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}-\mathbf{J}_{n}\cdot\boldsymbol{\omega}_{n}}{\Delta t}
\end{aligned}
\,.
\]

\end_inset

According to the midpoint rule,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{r}}_{n+1} & =\dot{\mathbf{r}}_{n}+\Delta t\,\ddot{\mathbf{r}}_{n+1}\\
\ddot{\mathbf{r}}_{n+1} & =\frac{2}{\Delta t^{2}}\left(\mathbf{r}_{n+1}-\mathbf{r}_{n}\right)-\frac{2}{\Delta t}\dot{\mathbf{r}}_{n}
\end{aligned}
\,,
\]

\end_inset

and more generally,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{n+1} & =\mathbf{r}_{n}+\Delta t\,\dot{\mathbf{r}}_{n}+\Delta t^{2}\left[\left(\frac{1}{2}-\beta\right)\ddot{\mathbf{r}}_{n}+\beta\ddot{\mathbf{r}}_{n+1}\right]\\
\dot{\mathbf{r}}_{n+1} & =\dot{\mathbf{r}}_{n}+\Delta t\left[\left(1-\gamma\right)\ddot{\mathbf{r}}_{n}+\gamma\ddot{\mathbf{r}}_{n+1}\right]\\
\ddot{\mathbf{r}}_{n+1} & =\frac{1}{\beta}\left(\frac{1}{\Delta t}\left[\frac{1}{\Delta t}\left(\mathbf{r}_{n+1}-\mathbf{r}_{n}\right)-\dot{\mathbf{r}}_{n}\right]-\left(\frac{1}{2}-\beta\right)\ddot{\mathbf{r}}_{n}\right)
\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{r}\left(t\right)$
\end_inset

 is the position and 
\begin_inset Formula $\ddot{\mathbf{r}}\left(t\right)$
\end_inset

 is the acceleration of the rigid body center of mass, such that 
\begin_inset Formula $\mathbf{r}_{n+1}=\mathbf{r}\left(t_{n+1}\right)$
\end_inset

 and 
\begin_inset Formula $\ddot{\mathbf{r}}_{n+1}=\ddot{\mathbf{r}}\left(t_{n+1}\right)$
\end_inset

.
 However, for the angular position, velocity and acceleration, the temporal
 discretization must be done in the rigid body (material) frame.
 Thus, for the midpoint rule,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{W}_{n+1} & =\frac{2}{\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}\\
\mathbf{A}_{n+1} & =\frac{2}{\Delta t^{2}}\boldsymbol{\Theta}-\frac{2}{\Delta t}\mathbf{W}_{n}
\end{aligned}
\,,
\]

\end_inset

and more generally,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{W}_{n+1} & =\frac{\gamma}{\beta\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\mathbf{W}_{n}+\frac{\Delta t}{2}\mathbf{A}_{n}\right)\\
\mathbf{A}_{n+1} & =\frac{1}{\gamma\Delta t}\left(\mathbf{W}_{n+1}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{\gamma}\right)\mathbf{A}_{n}\\
 & =\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\mathbf{A}_{n}
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $\boldsymbol{\theta}=\boldsymbol{\Lambda}\cdot\boldsymbol{\Theta}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\omega}=\boldsymbol{\Lambda}\cdot\mathbf{W}$
\end_inset

, and 
\begin_inset Formula $\boldsymbol{\alpha}=\dot{\boldsymbol{\omega}}=\boldsymbol{\Lambda}\cdot\mathbf{A}$
\end_inset

.
 Here, 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the spatial rotational increment from 
\begin_inset Formula $t_{n}$
\end_inset

 to 
\begin_inset Formula $t_{n+1}$
\end_inset

, while 
\begin_inset Formula $\boldsymbol{\Theta}$
\end_inset

 is the corresponding material increment, thus 
\begin_inset Formula $\boldsymbol{\theta}=\boldsymbol{\Lambda}_{n}\cdot\boldsymbol{\Theta}$
\end_inset

.
 For the remaining terms, 
\begin_inset Formula $\boldsymbol{\omega}_{n}=\boldsymbol{\Lambda}_{n}\cdot\mathbf{W}_{n}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\omega}_{n+1}=\boldsymbol{\Lambda}_{n+1}\cdot\mathbf{W}_{n+1}$
\end_inset

, and 
\begin_inset Formula $\boldsymbol{\alpha}_{n+1}=\boldsymbol{\Lambda}_{n+1}\cdot\mathbf{A}_{n+1}$
\end_inset

.
 The relation between 
\begin_inset Formula $\boldsymbol{\Lambda}_{n}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Lambda}_{n+1}$
\end_inset

 is
\begin_inset Formula 
\[
\boldsymbol{\Lambda}_{n+1}=\rot\left[\boldsymbol{\theta}\right]\cdot\boldsymbol{\Lambda}_{n}=\boldsymbol{\Lambda}_{n}\cdot\rot\left[\boldsymbol{\Theta}\right]
\]

\end_inset

where 
\begin_inset Formula $\rot\left[\cdot\right]$
\end_inset

 may represents either the exponential map or the Cayley transform.
 According to Puso 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"

\end_inset

, the Cayley transform must be used to enforce conservation of momentum
 and energy in a midpoint rule discretization scheme, whenever the rigid
 body is connected to a deformable body, or whenever two rigid bodies are
 connected by a joint.
 It follows from the midpoint rule that
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\omega}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{2}{\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}\right)\\
\boldsymbol{\alpha}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{2}{\Delta t^{2}}\boldsymbol{\theta}-\frac{2}{\Delta t}\boldsymbol{\omega}_{n}\right)
\end{aligned}
\,,
\]

\end_inset

and more generally,
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\omega}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{\gamma}{\beta\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\boldsymbol{\omega}_{n}+\frac{\Delta t}{2}\boldsymbol{\alpha}_{n}\right)\right)\\
\boldsymbol{\alpha}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\boldsymbol{\alpha}_{n}\right)
\end{aligned}
\,.
\]

\end_inset


\end_layout

\begin_layout Standard
The nonlinear system 
\begin_inset Formula $\mathbf{R}\left(t_{n+1}\right)=\mathbf{0}$
\end_inset

 is solved using a Newton scheme that requires linearizing 
\begin_inset Formula $\mathbf{R}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

.
 Thus,
\begin_inset Formula 
\[
\mathbf{R}\left(t_{n+1}\right)+D\mathbf{R}\left(t_{n+1}\right)\left[\Delta\mathbf{r}\right]+D\mathbf{R}\left(t_{n+1}\right)\left[\Delta\boldsymbol{\theta}\right]\approx\mathbf{0}\,.
\]

\end_inset

The increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 are evaluated at 
\begin_inset Formula $t_{n+1}$
\end_inset

 and the iterative Newton scheme requires updates of the form
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{n+1}^{j+1} & =\mathbf{r}_{n+1}^{j}+\Delta\mathbf{r}\\
\cay\left[\boldsymbol{\theta}^{j+1}\right] & =\cay\left[\Delta\boldsymbol{\theta}\right]\cdot\cay\left[\boldsymbol{\theta}^{j}\right]
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $j$
\end_inset

 represents the Newton iteration.
 At each Newton iteration, the current value of 
\begin_inset Formula $\cay\left[\boldsymbol{\theta}^{j+1}\right]$
\end_inset

 is used to perform the update
\begin_inset Formula 
\[
\boldsymbol{\Lambda}_{n+1}^{j+1}=\cay\left[\boldsymbol{\theta}^{j+1}\right]\cdot\boldsymbol{\Lambda}_{n}\,,
\]

\end_inset

until convergence is achieved.
\end_layout

\begin_layout Standard
Using the exponential map, the rotation tensor 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 may alternatively be represented by the vector 
\begin_inset Formula $\boldsymbol{\xi}\left(t\right)$
\end_inset

 where
\begin_inset Formula 
\[
\boldsymbol{\Lambda}=\exp\left[\boldsymbol{\xi}\right]\,.
\]

\end_inset

Thus, 
\begin_inset Formula $\boldsymbol{\Lambda}_{n}=\exp\left[\boldsymbol{\xi}_{n}\right]$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Lambda}_{n+1}=\exp\left[\boldsymbol{\xi}_{n+1}\right]$
\end_inset

.
 In practice, 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

 is stored as a quaternion to facilitate the multiplication of rotation
 tensors.
 Similarly, it is convenient to store 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 in quaternions, recognizing that
\begin_inset Formula 
\[
\cay\left[\theta\mathbf{n}\right]=\exp\left[\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}\right]\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit vector along 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\theta=\left\Vert \boldsymbol{\theta}\right\Vert $
\end_inset

.
 Thus, it is 
\begin_inset Formula $\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}$
\end_inset

 which is stored in the quaternion, instead of 
\begin_inset Formula $\theta\mathbf{n}$
\end_inset

.
\end_layout

\begin_layout Standard
In the linearization of 
\begin_inset Formula $\mathbf{R}\left(t_{n+1}\right)$
\end_inset

, the contributions from the rate of change of linear momentum 
\begin_inset Formula $\dot{\mathbf{p}}_{n+1}$
\end_inset

 reduce to
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{p}}_{n+1}\left[\Delta\mathbf{r}\right] & =m\,D\left(\ddot{\mathbf{r}}_{n+1}\right)\left[\Delta\mathbf{r}\right]=\frac{2}{\Delta t^{2}}m\Delta\mathbf{r}\\
D\dot{\mathbf{p}}_{n+1}\left[\Delta\boldsymbol{\theta}\right] & =\mathbf{0}
\end{aligned}
\,.
\]

\end_inset

To evaluate the contributions from the rate of change of angular momentum
 
\begin_inset Formula $\dot{\mathbf{h}}_{n+1}$
\end_inset

, it is first necessary to transform the variables to the material frame,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{h}}_{n+1} & =\frac{1}{\Delta t}\left(\boldsymbol{\Lambda}_{n+1}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}-\boldsymbol{\Lambda}_{n}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n}\right)\\
 & =\frac{1}{\Delta t}\boldsymbol{\Lambda}_{n}\cdot\left(\cay\left[\boldsymbol{\Theta}\right]\cdot\mathbf{J}_{r}\cdot\left(\frac{2}{\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}\right)-\mathbf{J}_{r}\cdot\mathbf{W}_{n}\right)
\end{aligned}
\,.
\]

\end_inset

It follows that
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+1}\left[\Delta\mathbf{r}\right]=\mathbf{0}\,.
\]

\end_inset

Now, we first perform the linearization along an increment 
\begin_inset Formula $\Delta\boldsymbol{\Theta}$
\end_inset

 in the material frame,
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{h}}_{n+1}\left[\Delta\boldsymbol{\Theta}\right] & =\frac{1}{\Delta t}\boldsymbol{\Lambda}_{n}\cdot\left(D\left(\cay\left[\boldsymbol{\Theta}\right]\right)\left[\Delta\boldsymbol{\Theta}\right]\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\frac{2}{\Delta t}\cay\left[\boldsymbol{\Theta}\right]\cdot\mathbf{J}_{r}\cdot D\boldsymbol{\Theta}\left[\Delta\boldsymbol{\Theta}\right]\right)\\
 & =\frac{1}{\Delta t}\boldsymbol{\Lambda}_{n+1}\cdot\left(\frac{2}{\Delta t}\mathbf{J}_{r}\cdot\mathbf{T}\left(\boldsymbol{\Theta}\right)-\widehat{\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}}\right)\cdot\Delta\boldsymbol{\Theta}
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{y}}\equiv-\boldsymbol{\mathcal{E}}\cdot\mathbf{y}$
\end_inset

 is the skew-symmetric tensor with axial vector 
\begin_inset Formula $\mathbf{y}$
\end_inset

 and
\begin_inset Formula 
\[
\mathbf{T}\left(\boldsymbol{\Theta}\right)=\mathbf{I}+\frac{1}{2}\hat{\boldsymbol{\Theta}}+\frac{1}{4}\boldsymbol{\Theta}\otimes\boldsymbol{\Theta}\,.
\]

\end_inset

Then, we return to the spatial frame, recognizing that 
\begin_inset Formula $\Delta\boldsymbol{\theta}=\boldsymbol{\Lambda}_{n+1}\cdot\Delta\boldsymbol{\Theta}$
\end_inset

 (since 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 is an increment taken at 
\begin_inset Formula $t_{n+1}$
\end_inset

, from Newton iterations 
\begin_inset Formula $j$
\end_inset

 to 
\begin_inset Formula $j+1$
\end_inset

),
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{h}}_{n+1}\left[\Delta\boldsymbol{\Theta}\right] & =\frac{1}{\Delta t}\left(\frac{2}{\Delta t}\mathbf{J}_{n+1}\cdot\mathbf{T}\left(\boldsymbol{\theta}\right)-\widehat{\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}}\right)\cdot\Delta\boldsymbol{\theta}\end{aligned}
\,,
\]

\end_inset

where we have used the identities
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\Lambda}_{n+1}\cdot\mathbf{T}\left(\boldsymbol{\Theta}\right)\cdot\boldsymbol{\Lambda}_{n+1}^{T} & =\mathbf{T}\left(\boldsymbol{\Lambda}_{n+1}\cdot\boldsymbol{\Theta}\right)=\mathbf{T}\left(\cay\left[\boldsymbol{\theta}\right]\cdot\boldsymbol{\theta}\right)=\mathbf{T}\left(\boldsymbol{\theta}\right)\\
\boldsymbol{\Lambda}_{n+1}\cdot\hat{\mathbf{y}}\cdot\boldsymbol{\Lambda}_{n+1}^{T} & =\widehat{\boldsymbol{\Lambda}_{n+1}\cdot\mathbf{y}}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
Consider that the moments 
\begin_inset Formula $\mathbf{m}_{n+\frac{1}{2}}^{ext}$
\end_inset

 about the rigid body center of mass are produced by the forces 
\begin_inset Formula $\mathbf{f}_{n+\frac{1}{2}}^{ext}$
\end_inset

 according to
\begin_inset Formula 
\[
\mathbf{m}_{n+\frac{1}{2}}^{ext}=\mathbf{z}_{n+\frac{1}{2}}\times\mathbf{f}_{n+\frac{1}{2}}^{ext}=\hat{\mathbf{z}}_{n+\frac{1}{2}}\cdot\mathbf{f}_{n+\frac{1}{2}}^{ext}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{z}_{n+\frac{1}{2}}$
\end_inset

 is the moment arm at 
\begin_inset Formula $t_{n+\frac{1}{2}}$
\end_inset

.
 According to Puso 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"

\end_inset

,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{z}_{n+\frac{1}{2}} & =\frac{1}{2}\left(\mathbf{z}_{n+1}+\mathbf{z}_{n}\right)\\
 & =\frac{1}{2}\left(\boldsymbol{\Lambda}_{n+1}+\boldsymbol{\Lambda}_{n}\right)\cdot\mathbf{Z}
\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{Z}$
\end_inset

 is the moment arm in the reference configuration.
 Note that
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{z}_{n+\frac{1}{2}}\left[\Delta\mathbf{r}\right] & =\mathbf{0}\\
D\mathbf{z}_{n+\frac{1}{2}}\left[\Delta\boldsymbol{\theta}\right] & =\frac{1}{2}D\boldsymbol{\Lambda}_{n+1}\left[\Delta\boldsymbol{\theta}\right]\cdot\mathbf{Z}=-\frac{1}{2}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\]

\end_inset

Thus,
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\mathbf{r}\right]\\
D\mathbf{m}_{n+\frac{1}{2}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\mathbf{r}\right]\\
\mathbf{z}_{n+\frac{1}{2}}\times D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]
\]

\end_inset

and
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
D\mathbf{m}_{n+\frac{1}{2}}^{ext}\left[\Delta\boldsymbol{\theta}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
\mathbf{z}_{n+\frac{1}{2}}\times D\mathbf{f}_{n+\frac{1}{2}}^{ext}\left[\Delta\boldsymbol{\theta}\right]-\left(\frac{1}{2}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}\right)\times\mathbf{f}_{n+\frac{1}{2}}^{ext}
\end{array}\right]\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
Time Discretization (Generalized-
\begin_inset Formula $\alpha$
\end_inset

)
\end_layout

\begin_layout Standard
In the generalized-
\begin_inset Formula $\alpha$
\end_inset

 method, we evaluate forces and moments at time 
\begin_inset Formula $t_{n+\alpha_{f}}=\left(1-\alpha_{f}\right)t_{n}+\alpha_{f}t_{n+1}$
\end_inset

 and the time rate of change of linear and angular momenta at time 
\begin_inset Formula $t_{n+\alpha_{m}}=\left(1-\alpha_{m}\right)t_{n}+\alpha_{m}t_{n+1}$
\end_inset

, where 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 may be evaluated from the spectral radius for an infinite time step, 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"

\end_inset

).
 For second-order systems these parameters may be evaluated from 
\begin_inset CommandInset citation
LatexCommand citep
key "Bazilevs2008"

\end_inset


\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{2-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas-2nd}
\end{equation}

\end_inset

Accordingly, to solve numerically for 
\begin_inset Formula $\delta W=0$
\end_inset

 over the time domain, we express 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbm-virtual-work"

\end_inset

 in the discretized time domain as
\begin_inset Formula 
\[
\delta\mathbf{r}\cdot\left(\mathbf{f}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{p}}_{n+\alpha_{m}}\right)+\delta\boldsymbol{\theta}\cdot\left(\mathbf{m}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{h}}_{n+\alpha_{m}}\right)=0\,,
\]

\end_inset

or equivalently,
\begin_inset Formula 
\[
\left[\begin{array}{cc}
\delta\mathbf{r} & \delta\boldsymbol{\theta}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{p}}_{n+\alpha_{m}}\\
\mathbf{m}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{h}}_{n+\alpha_{m}}
\end{array}\right]=0\,,
\]

\end_inset

Thus, the residual vector is given by
\begin_inset Formula 
\[
\left[\mathbf{R}\right]=\left[\begin{array}{c}
\mathbf{f}_{n+\alpha_{f}}^{ext}\\
\mathbf{m}_{n+\alpha_{f}}^{ext}
\end{array}\right]-\left[\begin{array}{c}
\dot{\mathbf{p}}_{n+\alpha_{m}}\\
\dot{\mathbf{h}}_{n+\alpha_{m}}
\end{array}\right]
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{p}}_{n+\alpha_{m}} & =\left(1-\alpha_{m}\right)\dot{\mathbf{p}}_{n}+\alpha_{m}\dot{\mathbf{p}}_{n+1}\\
\dot{\mathbf{h}}_{n+\alpha_{m}} & =\left(1-\alpha_{m}\right)\dot{\mathbf{h}}_{n}+\alpha_{m}\dot{\mathbf{h}}_{n+1}
\end{aligned}
\,.
\]

\end_inset


\end_layout

\begin_layout Standard
According to the Newmark integration scheme,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{p}}_{n+1} & =\frac{\mathbf{p}_{n+1}-\mathbf{p}_{n}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{\mathbf{p}}_{n}\\
\dot{\mathbf{h}}_{n+1} & =\frac{\mathbf{h}_{n+1}-\mathbf{h}_{n}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{\mathbf{h}}_{n}
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{p}_{n+1}=m\dot{\mathbf{r}}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{h}_{n+1}=\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}$
\end_inset

.
 Moreover,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{n+1} & =\mathbf{r}_{n}+\Delta t\,\dot{\mathbf{r}}_{n}+\Delta t^{2}\left[\left(\frac{1}{2}-\beta\right)\ddot{\mathbf{r}}_{n}+\beta\ddot{\mathbf{r}}_{n+1}\right]\\
\dot{\mathbf{r}}_{n+1} & =\dot{\mathbf{r}}_{n}+\Delta t\left[\left(1-\gamma\right)\ddot{\mathbf{r}}_{n}+\gamma\ddot{\mathbf{r}}_{n+1}\right]\\
\ddot{\mathbf{r}}_{n+1} & =\frac{1}{\beta}\left(\frac{1}{\Delta t}\left[\frac{1}{\Delta t}\left(\mathbf{r}_{n+1}-\mathbf{r}_{n}\right)-\dot{\mathbf{r}}_{n}\right]-\left(\frac{1}{2}-\beta\right)\ddot{\mathbf{r}}_{n}\right)
\end{aligned}
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\omega}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{\gamma}{\beta\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\boldsymbol{\omega}_{n}+\frac{\Delta t}{2}\boldsymbol{\alpha}_{n}\right)\right)\\
\boldsymbol{\alpha}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\boldsymbol{\alpha}_{n}\right)
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the spatial rotational increment from 
\begin_inset Formula $t_{n}$
\end_inset

 to 
\begin_inset Formula $t_{n+1}$
\end_inset

.
\end_layout

\begin_layout Standard
The nonlinear system 
\begin_inset Formula $\mathbf{R}=\mathbf{0}$
\end_inset

 is solved using a Newton scheme that requires linearizing 
\begin_inset Formula $\mathbf{R}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

.
 Thus,
\begin_inset Formula 
\[
\mathbf{R}+D\mathbf{R}\left[\Delta\mathbf{r}\right]+D\mathbf{R}\left[\Delta\boldsymbol{\theta}\right]\approx\mathbf{0}\,.
\]

\end_inset

The increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 are evaluated at 
\begin_inset Formula $t_{n+1}$
\end_inset

 and the iterative Newton scheme requires updates of the form
\begin_inset Formula 
\[
\begin{aligned}\mathbf{r}_{n+1}^{j+1} & =\mathbf{r}_{n+1}^{j}+\Delta\mathbf{r}\\
\cay\left[\boldsymbol{\theta}^{j+1}\right] & =\cay\left[\Delta\boldsymbol{\theta}\right]\cdot\cay\left[\boldsymbol{\theta}^{j}\right]
\end{aligned}
\,,
\]

\end_inset

where 
\begin_inset Formula $j$
\end_inset

 represents the Newton iteration.
 At each Newton iteration, the current value of 
\begin_inset Formula $\cay\left[\boldsymbol{\theta}^{j+1}\right]$
\end_inset

 is used to perform the update
\begin_inset Formula 
\[
\boldsymbol{\Lambda}_{n+1}^{j+1}=\cay\left[\boldsymbol{\theta}^{j+1}\right]\cdot\boldsymbol{\Lambda}_{n}\,,
\]

\end_inset

until convergence is achieved.
\end_layout

\begin_layout Standard
Using the exponential map, the rotation tensor 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 may alternatively be represented by the vector 
\begin_inset Formula $\boldsymbol{\xi}\left(t\right)$
\end_inset

 where
\begin_inset Formula 
\[
\boldsymbol{\Lambda}=\exp\left[\boldsymbol{\xi}\right]\,.
\]

\end_inset

Thus, 
\begin_inset Formula $\boldsymbol{\Lambda}_{n}=\exp\left[\boldsymbol{\xi}_{n}\right]$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Lambda}_{n+1}=\exp\left[\boldsymbol{\xi}_{n+1}\right]$
\end_inset

.
 In practice, 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

 is stored as a quaternion to facilitate the multiplication of rotation
 tensors.
 Similarly, it is convenient to store 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 in quaternions, recognizing that
\begin_inset Formula 
\[
\cay\left[\theta\mathbf{n}\right]=\exp\left[\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}\right]\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit vector along 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\theta=\left\Vert \boldsymbol{\theta}\right\Vert $
\end_inset

.
 Thus, it is 
\begin_inset Formula $\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}$
\end_inset

 which is stored in the quaternion, instead of 
\begin_inset Formula $\theta\mathbf{n}$
\end_inset

.
\end_layout

\begin_layout Standard
In the linearization of 
\begin_inset Formula $\mathbf{R}$
\end_inset

, the contributions from the rate of change of linear momentum 
\begin_inset Formula $\dot{\mathbf{p}}_{n+\alpha_{m}}$
\end_inset

 reduce to
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{p}}_{n+\alpha_{m}}\left[\Delta\mathbf{r}\right] & =\alpha_{m}\dot{\mathbf{p}}_{n+1}\left[\Delta\mathbf{r}\right]=\alpha_{m}m\,D\left(\ddot{\mathbf{r}}_{n+1}\right)\left[\Delta\mathbf{r}\right]=\frac{\alpha_{m}}{\beta\Delta t^{2}}m\Delta\mathbf{r}\\
D\dot{\mathbf{p}}_{n+\alpha_{m}}\left[\Delta\boldsymbol{\theta}\right] & =\mathbf{0}
\end{aligned}
\,.
\]

\end_inset

To evaluate the contributions from the rate of change of angular momentum
 
\begin_inset Formula $\dot{\mathbf{h}}_{n+\alpha_{m}}$
\end_inset

, we start from 
\begin_inset Formula $D\dot{\mathbf{h}}_{n+\alpha_{m}}=\alpha_{m}D\dot{\mathbf{h}}_{n+1}$
\end_inset

.
 Then, it becomes necessary to transform the variables to the material frame,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{h}}_{n+1} & =\boldsymbol{\omega}_{n+1}\times\mathbf{h}_{n+1}+\mathbf{J}_{n+1}\cdot\boldsymbol{\alpha}_{n+1}\\
 & =\boldsymbol{\Lambda}_{n}\cdot\cay\left[\boldsymbol{\Theta}\right]\cdot\left(\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\mathbf{J}_{r}\cdot\mathbf{A}_{n+1}\right)
\end{aligned}
\,.
\]

\end_inset

It follows that
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+1}\left[\Delta\mathbf{r}\right]=\mathbf{0}\,.
\]

\end_inset

Now, we first perform the linearization along an increment 
\begin_inset Formula $\Delta\boldsymbol{\Theta}$
\end_inset

 in the material frame,
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{h}}_{n+1}\left[\Delta\boldsymbol{\Theta}\right] & =D\boldsymbol{\Lambda}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]\cdot\left(\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\mathbf{J}_{r}\cdot\mathbf{A}_{n+1}\right)\\
 & +\boldsymbol{\Lambda}_{n+1}\cdot\left(D\hat{\mathbf{W}}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot D\mathbf{W}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]+\mathbf{J}_{r}\cdot D\mathbf{A}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]\right)\\
 & =\boldsymbol{\Lambda}_{n+1}\cdot\widehat{\Delta\boldsymbol{\Theta}}\cdot\left(\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\mathbf{J}_{r}\cdot\mathbf{A}_{n+1}\right)\\
 & +\boldsymbol{\Lambda}_{n+1}\cdot\left(\frac{\gamma}{\beta\Delta t}\widehat{\Delta\boldsymbol{\Theta}}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\frac{\gamma}{\beta\Delta t}\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot\Delta\boldsymbol{\Theta}+\frac{1}{\beta\Delta t^{2}}\mathbf{J}_{r}\cdot\Delta\boldsymbol{\Theta}\right)\\
 & =\left(\frac{\gamma}{\beta\Delta t}\left(\hat{\boldsymbol{\omega}}_{n+1}\cdot\mathbf{J}_{n+1}-\hat{\mathbf{h}}_{n+1}\right)+\frac{1}{\beta\Delta t^{2}}\mathbf{J}_{n+1}-\widehat{\dot{\mathbf{h}}_{n+1}}\right)\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\]

\end_inset

where we used
\begin_inset Formula 
\[
D\left(\cay\left[\boldsymbol{\Theta}\right]\right)\left[\Delta\boldsymbol{\Theta}\right]=\cay\left[\boldsymbol{\Theta}\right]\cdot\widehat{\Delta\boldsymbol{\Theta}}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\mathbf{W}_{n+1} & =\frac{\gamma}{\beta\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\mathbf{W}_{n}+\frac{\Delta t}{2}\mathbf{A}_{n}\right)\\
\mathbf{A}_{n+1} & =\frac{1}{\gamma\Delta t}\left(\mathbf{W}_{n+1}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{\gamma}\right)\mathbf{A}_{n}\\
 & =\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\mathbf{A}_{n}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
Consider that the moments 
\begin_inset Formula $\mathbf{m}_{n+\alpha_{f}}^{ext}$
\end_inset

 about the rigid body center of mass are produced by the forces 
\begin_inset Formula $\mathbf{f}_{n+\alpha_{f}}^{ext}$
\end_inset

 according to
\begin_inset Formula 
\[
\mathbf{m}_{n+\alpha_{f}}^{ext}=\mathbf{z}_{n+\alpha_{f}}\times\mathbf{f}_{n+\alpha_{f}}^{ext}=\hat{\mathbf{z}}_{n+\alpha_{f}}\cdot\mathbf{f}_{n+\alpha_{f}}^{ext}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{z}_{n+\alpha_{f}}$
\end_inset

 is the moment arm at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{z}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{z}_{n}+\alpha_{f}\mathbf{z}_{n+1}\\
 & =\left[\left(1-\alpha_{f}\right)\boldsymbol{\Lambda}_{n}+\alpha_{f}\boldsymbol{\Lambda}_{n+1}\right]\cdot\mathbf{Z}\\
 & \equiv\boldsymbol{\Lambda}_{n+\alpha_{f}}\cdot\mathbf{Z}
\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{Z}$
\end_inset

 is the moment arm in the reference configuration.
 Note that
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{z}_{n+\alpha_{f}}\left[\Delta\mathbf{r}\right] & =\mathbf{0}\\
D\mathbf{z}_{n+\alpha_{f}}\left[\Delta\boldsymbol{\theta}\right] & =\alpha_{f}D\boldsymbol{\Lambda}_{n+1}\left[\Delta\boldsymbol{\theta}\right]\cdot\mathbf{Z}=-\alpha_{f}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\]

\end_inset

Thus,
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]\\
D\mathbf{m}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]\\
\mathbf{z}_{n+\alpha_{f}}\times D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]
\]

\end_inset

and
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
D\mathbf{m}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
\mathbf{z}_{n+\alpha_{f}}\times D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]-\left(\alpha_{f}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}\right)\times\mathbf{f}_{n+\alpha_{f}}^{ext}
\end{array}\right]\,.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "FEBio3"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
