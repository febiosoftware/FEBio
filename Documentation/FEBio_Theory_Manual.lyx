#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass extbook
\begin_preamble
\usepackage{hyperref}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "helvet" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family sfdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 2
\use_package esint 2
\use_package mathdots 2
\use_package mathtools 2
\use_package mhchem 2
\use_package stackrel 2
\use_package stmaryrd 2
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type numerical
\biblio_style plainnat
\biblio_options sort&compress
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Dev}{\operatorname{Dev}}
{\text{Dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\dev}{\operatorname{dev}}
{\text{dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\grad}{\operatorname{grad}}
{\text{grad}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Grad}{\operatorname{Grad}}
{\text{Grad}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\divg}{\operatorname{div}}
{\text{div}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Ei}{\operatorname{Ei}}
{\text{Ei}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\text{tr}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Divg}{\operatorname{Div}}
{\text{Div}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\cay}{\operatorname{cay}}
{\text{cay}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\rot}{\operatorname{rot}}
{\text{rot}}
\end_inset


\end_layout

\begin_layout Title
\begin_inset Graphics
	filename Figures/FigFEBioTitle.png
	width 4.88in

\end_inset


\series bold

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\series default
Theory Manual Version 4.5 
\end_layout

\begin_layout Date
Last Updated: January 16, 2024
\end_layout

\begin_layout Paragraph*
Contributors
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Steve Maas (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:steve.maas@utah.edu}{steve.maas@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Michael Herron (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:michael.herron@utah.edu}{michael.herron@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Jeffrey Weiss (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:jeff.weiss@utah.edu}{jeff.weiss@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Gerard Ateshian (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:ateshian@columbia.edu}{ateshian@columbia.edu}
\end_layout

\end_inset

)
\end_layout

\begin_layout Paragraph*
Contact address
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Musculoskeletal Research Laboratories, University of Utah
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

72 S.
 Central Campus Drive, Room 2646
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Salt Lake City, Utah
\end_layout

\begin_layout Paragraph*
Website
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
MRL: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://mrl.sci.utah.edu}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

FEBio: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://febio.org}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Forum
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{https://forums.febio.org/index.php}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Acknowledgments
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Development of the FEBio project is supported in part by a grant from the
 U.S.
 National Institutes of Health (R01GM083925).
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename Figures/NIHlogo.png
	lyxscale 25
	height 0.75in

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:introduction"

\end_inset

 
\end_layout

\begin_layout Section
Overview of FEBio
\begin_inset CommandInset label
LatexCommand label
name "sec:overview"

\end_inset


\end_layout

\begin_layout Standard
FEBio is an implicit, nonlinear finite element solver that is specifically
 designed for applications in biomechanics.
 It offers analyses, constitutive models and boundary conditions that are
 relevant for this particular field.
 This section describes briefly the available features of FEBio.
 A more detailed overview of features can be found in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio User's Manual}}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
FEBio supports two analysis types, namely 
\emph on
quasi-static
\emph default
 and 
\emph on
quasi-static poroelastic
\emph default
.
 In a 
\emph on
quasi-static
\emph default
 analysis the (quasi-) static response of the system is sought; inertial
 terms are ignored.
 In a 
\emph on
quasi-static poroelastic
\emph default
 analysis a coupled solid-fluid problem is solved.
 The latter analysis type is useful for modeling tissues that have high
 water content and the explicit modeling of fluid movement relative to the
 solid phase is important.
\end_layout

\begin_layout Standard
Several nonlinear constitutive models are available to allow the user to
 model the often complicated biological tissue behavior.
 Several isotropic constitutive models are supported such as Neo-Hookean,
 Mooney-Rivlin, Veronda-Westmann, Arruda-Boyce and Ogden.
 These models have a nonlinear stress-strain response.
 In addition to the isotropic models, there are several anisotropic models
 available.
 These materials show anisotropic behavior in at least one preferred direction
 and are useful for modeling biological tissues such as tendons, muscles
 and other tissues that contain fibers.
 FEBio also contains a 
\emph on
rigid body 
\emph default
material model, which can be used to model rigid structures whose deformation
 is negligible compared to the deformable geometry.
\end_layout

\begin_layout Standard
Biological tissues can interact in very complicated ways.
 Therefore FEBio supports a wide range of boundary conditions to model these
 interactions.
 These include prescribed displacements, nodal forces, and pressure forces.
 Deformable models can also be connected to rigid bodies so that the user
 can model prescribed rotations and torques.
 Rigid bodies can be connected with rigid joints.
 Even more complicated interactions can be modeled using FEBio's contact
 interfaces.
 The user can choose between different types of contact interfaces, such
 as sliding interfaces, tied interfaces and rigid wall interfaces.
 A sliding interface is defined between two surfaces that are allowed to
 separate and slide across each other but are not allowed to penetrate.
 The rigid wall interface is also similar to the sliding interface, except
 that one of the contacting surfaces is a movable rigid wall.
 As of version 1.2, there is an implementation of a sliding interface that
 allows for fluid flow crossing the contact interface.
 The tied interface is similar to the sliding interface, but in this case,
 the surfaces are not allowed to slide or separate.
 In addition, the user may specify a body force which can be used to model
 the effects of gravity or base acceleration.
\end_layout

\begin_layout Section
About this document
\begin_inset CommandInset label
LatexCommand label
name "sec:about-this-document"

\end_inset


\end_layout

\begin_layout Standard
This document is a part of a set of three manuals that accompany FEBio:
 the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio User's Manual}}
\end_layout

\end_inset

, describing how to use FEBio, the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Developer's 
\end_layout

\begin_layout Plain Layout

Manual}}
\end_layout

\end_inset

 for users who wish to modify or add features to the code, and this manual,
 which describes the theory behind most of the FEBio algorithms.
\end_layout

\begin_layout Standard
The purpose of this manual is to provide theoretical background on many
 of the algorithms that are implemented in FEBio.
 In this way the user can develop a better understanding of how the program
 works and how it can be used to create well defined biomechanical simulations.
 The authors have tried to be as detailed as possible to make the text coherent
 and comprehensible, but due to the complexity of some of the topics, some
 descriptions only skim the surface.
 Many of the theoretical ideas discussed in this manual can and have filled
 entire bookshelves.
 The explanations contained herein should be sufficient to give the reader
 a basic understanding of the theoretical developments.
 References to textbooks and the primary literature are provided for further
 reading.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:continuum-mechanics"

\end_inset

 starts with a brief overview of some of the important concepts in continuum
 mechanics.
 Readers who are already familiar with this field can skip this chapter,
 although the material may be useful to get familiar with the notation and
 terminology used in this manual.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Nonlinear-FE-Method"

\end_inset

 describes the nonlinear finite element method.
 It also explains the Newton-Raphson method, which is the basis for most
 implementations of the nonlinear finite element method.
 A more specialized version of this algorithm, the BFGS method, is described
 as well since it is used in FEBio.
\end_layout

\begin_layout Standard
In Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Element-Library"

\end_inset

 the different element types that are available in FEBio are described in
 detail.
 FEBio currently supports 3D solid elements, such as the linear hexahedral,
 pentahedral and tetrahedral elements, as well as quadrilateral and triangular
 shell elements.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Constitutive-Models"

\end_inset

 contains a detailed description of the material models in FEBio.
 Most of these models are based on hyperelasticity, which is introduced
 in chapter 2.
 Several transversely isotropic materials are described as well.
 This also discusses the biphasic material and its implementation in FEBio.
\end_layout

\begin_layout Standard
Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Contact-and-Coupling"

\end_inset

 describes the basics of the theory of contact and coupling.
 In FEBio the user can connect the different parts of the geometry in a
 variety of ways.
 There are rigid interfaces where a deformable model is attached to a rigid
 model, rigid joints where two or more rigid bodies connect, and sliding
 interfaces where two surfaces are allowed to separate and slide across
 each other but are not allowed to penetrate.
 The various contact and coupling algorithms are discussed as well together
 with their implementation in FEBio.
\end_layout

\begin_layout Chapter
Continuum Mechanics
\begin_inset CommandInset label
LatexCommand label
name "chap:continuum-mechanics"

\end_inset


\end_layout

\begin_layout Standard
This chapter contains an overview of some of the important concepts from
 continuum mechanics and establishes some of the notation and terminology
 that will be used in the rest of this document.
 The section begins by introducing the important concepts of deformation,
 stress and strain.
 Next the concept of hyperelasticity is discussed.
 Finally the concept of virtual work is discussed.
 This concept will be used later to derive the nonlinear finite element
 equations.
 For a more thorough introduction to the mathematics needed for continuum
 mechanics, the user can consult 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
\end_layout

\begin_layout Section
Vectors and Tensors
\begin_inset CommandInset label
LatexCommand label
name "sec:vectors-and-tensors"

\end_inset


\end_layout

\begin_layout Standard
It is assumed that the reader is familiar with the concepts of vectors and
 tensors.
 This section summarizes the notation and some useful relations that will
 be used throughout the manual.
\end_layout

\begin_layout Standard
Vectors are denoted by small, bold letters, e.g.
 
\series bold
v
\series default
.
 Their components will be denoted by 
\begin_inset space \quad{}
\end_inset


\begin_inset Formula $v_{i}$
\end_inset

, where, unless otherwise stated, Latin under scripts such as 
\begin_inset Formula $i$
\end_inset

or 
\begin_inset Formula $I$
\end_inset

will range from 1 to 3.
 In matrix form a vector will be represented as a column vector and its
 transpose as a row vector: 
\begin_inset Formula 
\begin{equation}
\begin{array}{cc}
\mathbf{v}=\left(\begin{array}{c}
v_{1}\\
v_{2}\\
v_{3}
\end{array}\right),\quad & \mathbf{v}^{T}=\left(\begin{array}{ccc}
v_{1}, & v_{2}, & v_{3}\end{array}\right)\end{array}.\label{eq1}
\end{equation}

\end_inset

The following products are defined between vectors.
 Assume 
\series bold
u
\series default
, 
\series bold
v
\series default
 are vectors.
 Also note that the Einstein summation convention is used throughout this
 manual 
\begin_inset CommandInset citation
LatexCommand citep
key "Lai10"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The 
\emph on
dot 
\emph default
or 
\emph on
scalar product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}\cdot\mathbf{v}=u_{i}v_{i}\,.\label{eq2}
\end{equation}

\end_inset

The 
\emph on
cross product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}\times\mathbf{v}=\left[\begin{array}{c}
u_{2}v_{3}-u_{3}v_{2}\\
u_{3}v_{1}-u_{1}v_{3}\\
u_{1}v_{2}-u_{2}v_{1}
\end{array}\right]\,.\label{eq3}
\end{equation}

\end_inset

The 
\emph on
vector
\emph default
 
\emph on
outer product
\emph default
: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{u}\otimes\mathbf{v}\right)_{ij}=u_{i}v_{j}\,.\label{eq4}
\end{equation}

\end_inset

Note that vectors are also known as first order tensors.
 Scalars are known as zero order tensors.
 The outer product, defined by equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq4"

\end_inset

, is a second order tensor.
\end_layout

\begin_layout Standard
Second order tensors are denoted by bold, capital letters, e.g.
 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
.
 Some exceptions will be made to remain consistent with the literature.
 For instance, the Cauchy stress tensor is denoted by 
\begin_inset Formula $\mathbf{\boldsymbol{\sigma}}$
\end_inset

.
 However, the nature of the objects will always be clear from the context.
 The following operations on tensors are defined.
 Assume 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset

 
\series default
are second-order tensors.
\end_layout

\begin_layout Standard
The 
\emph on
double contraction
\emph default
 or 
\emph on
tensor inner product
\emph default
 is defined as: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}:\mathbf{B}=A_{ij}B_{ij}\,.\label{eq5}
\end{equation}

\end_inset

The 
\emph on
trace
\emph default
 is defined as: 
\begin_inset Formula 
\begin{equation}
\tr\mathbf{A}=\mathbf{I}:\mathbf{A}=A_{ii}\,.\label{eq6}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the second order identity tensor with components 
\begin_inset Formula $\delta_{ij}$
\end_inset

.
\end_layout

\begin_layout Standard
In general the components of tensors will change under a change of coordinate
 system.
 Nevertheless, certain intrinsic quantities associated with them will remain
 invariant under such a transformation.
 The scalar product between two vectors is such an example.
 The double contraction between two second-order tensors is another example.
 The following set of invariants for second-order tensors is commonly used:
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}I_{1} & =\tr\mathbf{A},\\
I_{2} & =\frac{1}{2}\left(\left(\tr\mathbf{A}\right)^{2}-\tr\mathbf{A}^{2}\right)\\
I_{3} & =\det\mathbf{A}.
\end{aligned}
\,.\label{eq7}
\end{equation}

\end_inset

A tensor 
\series bold

\begin_inset Formula $\mathbf{S}$
\end_inset

 
\series default
is called symmetric if it is equal to its transpose: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\mathbf{S}^{T}\,.\label{eq8}
\end{equation}

\end_inset

A tensor 
\series bold

\begin_inset Formula $\mathbf{W}$
\end_inset

 
\series default
is called anti-symmetric if it is equal to the negative of its transpose:
 
\begin_inset Formula 
\begin{equation}
\mathbf{W}=-\mathbf{W}^{T}\,.\label{eq9}
\end{equation}

\end_inset

Any second order tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
can be written as the sum of a symmetric tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset


\series bold
 
\series default
and an anti-symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{W}$
\end_inset


\series default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}=\mathbf{S}+\mathbf{W},\label{eq10}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\frac{1}{2}\left(\mathbf{A}+\mathbf{A}^{T}\right),\mbox{\thinspace and\thinspace}\mathbf{W}=\frac{1}{2}\left(\mathbf{A}-\mathbf{A}^{T}\right).\label{eq11}
\end{equation}

\end_inset

Also note that for any tensor 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset

 
\series default
the following holds: 
\begin_inset Formula 
\begin{equation}
\mathbf{B}:\mathbf{A}=\mathbf{B}:\mathbf{S}\,,\quad\mathbf{B}:\mathbf{W}=\mathbf{0}\,.\label{eq12}
\end{equation}

\end_inset

With any anti-symmetric tensor a dual vector 
\series bold

\begin_inset Formula $\mathbf{w}$
\end_inset

 
\series default
can be associated such that, 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{w}}\cdot\mathbf{u}=\mathbf{w}\times\mathbf{u}\,,\label{eq13}
\end{equation}

\end_inset

where the second order tensor 
\begin_inset Formula $\mathbf{\hat{w}}$
\end_inset

 is defined as, 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{w}}=\left[\begin{array}{ccc}
0 & -w_{3} & w_{2}\\
w_{3} & 0 & -w_{1}\\
-w_{2} & w_{1} & 0
\end{array}\right]\,.\label{eq14}
\end{equation}

\end_inset

A second order 
\series bold

\begin_inset Formula $\mathbf{Q}$
\end_inset

 
\series default
tensor is called 
\emph on
orthogonal 
\emph default
if 
\begin_inset Formula $\mathbf{Q}^{-1}=\mathbf{Q}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
In the implementation of the FE method it is often convenient to write symmetric
 second-order tensors using 
\emph on
Voigt notation
\emph default
.
 In this notation the components of a 2
\begin_inset Formula $^{\mathrm{nd}}$
\end_inset

 order symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset

 
\series default
are arranged as a column vector: 
\begin_inset Formula 
\begin{equation}
\left[\mathbf{A}\right]=\left[\begin{array}{c}
A_{11}\\
A_{22}\\
A_{33}\\
A_{12}\\
A_{23}\\
A_{13}
\end{array}\right]\,.\label{eq15}
\end{equation}

\end_inset

Higher order tensors will be denoted by bold, capital, script symbols, e.g.
 
\begin_inset Formula $\boldsymbol{\mathcal{A}}$
\end_inset

.
 An example of a third-order tensor is the 
\emph on
permutation tensor 
\emph default

\begin_inset Formula $\mathcal{E}_{ijk}$
\end_inset

, whose components are 1 for an even permutation of 
\begin_inset Formula $\left(1,2,3\right)$
\end_inset

, -1 for an odd permutation of 
\begin_inset Formula $\left(1,2,3\right)$
\end_inset

 and zero otherwise.
 The permutation symbol is useful for expressing the cross-product of two
 vectors in index notation: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{u}\times\mathbf{v}\right)_{i}=\mathcal{E}_{ijk}u_{j}v_{k}\,.\label{eq16}
\end{equation}

\end_inset

An example of a fourth-order tensor is the elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 which, in linear elasticity theory, relates the small strain tensor 
\begin_inset Formula $\mathbf{\boldsymbol{\varepsilon}}$
\end_inset

 and the Cauchy stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}=\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}$
\end_inset

.
\end_layout

\begin_layout Standard
Higher order tensors can be constructed from second order tensors in a similar
 way as second order tensors can be constructed from vectors.
 If 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{B}$
\end_inset

 are second order tensors, then the following fourth order tensors can be
 defind by requiring that the following must hold for any second order tensor
 
\begin_inset Formula $\mathbf{X}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\otimes\mathbf{B}\right):\mathbf{X}=\left(\mathbf{B}:\mathbf{X}\right)\mathbf{A}\,,\label{eq17}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\oslash\mathbf{B}\right):\mathbf{X}=\mathbf{A}\cdot\mathbf{X}\cdot\mathbf{B}^{T}\,,\label{eq18}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\obslash\mathbf{B}\right):\mathbf{X}=\mathbf{A}\cdot\mathbf{X}^{T}\cdot\mathbf{B}^{T}\,,\label{eq19}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\odot\mathbf{B}\right):\mathbf{X}=\frac{1}{2}\left(\mathbf{A}\cdot\mathbf{X}\cdot\mathbf{B}^{T}+\mathbf{A}\cdot\mathbf{X}^{T}\cdot\mathbf{B}^{T}\right)\,.\label{eq20}
\end{equation}

\end_inset

The Cartesian component forms of the operators 
\begin_inset Formula $\otimes$
\end_inset

, 
\begin_inset Formula $\oslash$
\end_inset

, 
\begin_inset Formula $\obslash$
\end_inset

 and 
\begin_inset Formula $\odot$
\end_inset

 are defined as follows: 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\otimes\mathbf{B}\right)_{ijkl}=\mathbf{A}_{ij}\mathbf{B}_{kl}\,,\label{eq21}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\oslash\mathbf{B}\right)_{ijkl}=\mathbf{A}_{ik}\mathbf{B}_{jl}\,,\label{eq22}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\obslash\mathbf{B}\right)_{ijkl}=A_{il}B_{jk}\,,\label{eq23}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left(\mathbf{A}\odot\mathbf{B}\right)_{ijkl}=\frac{1}{2}\left(A_{ik}B_{jl}+A_{il}B_{jk}\right)\,.\label{eq24}
\end{equation}

\end_inset

The fourth order identity tensors are defined as: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{A} & =\underline{\mathcal{I}}:\mathbf{A}\,,\\
\mathbf{A}^{T} & =\overline{\mathcal{I}}:\mathbf{A}\,,
\end{aligned}
\label{eq25}
\end{equation}

\end_inset

where 
\begin_inset Formula $\underline{\mathcal{I}}=\mathbf{I}\oslash\mathbf{I}$
\end_inset

 and 
\begin_inset Formula $\overline{\boldsymbol{\mathcal{I}}}=\mathbf{I}\obslash\mathbf{I}$
\end_inset

.
 The components are given by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathcal{\underline{I}}_{ijkl} & =\delta_{ik}\delta_{jl}\,,\\
\overline{\mathcal{I}}_{ijkl} & =\delta_{il}\delta_{jk}\,.
\end{aligned}
\label{eq26}
\end{equation}

\end_inset

We may also define 
\begin_inset Formula $\boldsymbol{\mathcal{I}}=\frac{1}{2}\left(\underline{\boldsymbol{\mathcal{I}}}+\overline{\boldsymbol{\mathcal{I}}}\right)$
\end_inset

, such that 
\begin_inset Formula $\boldsymbol{\mathcal{I}}:\mathbf{A}=\frac{1}{2}\left(\mathbf{A}+\mathbf{A}^{T}\right)$
\end_inset

 returns the symmetric part of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
 In the special case when 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is symmetric it follows that 
\begin_inset Formula $\underline{\mathcal{I}}:\mathbf{A}=\boldsymbol{\mathcal{I}}:\mathbf{A}=\mathbf{A}$
\end_inset

.
\end_layout

\begin_layout Section
The Directional Derivative
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Directional-Derivative"

\end_inset


\end_layout

\begin_layout Standard
In later sections the nonlinear finite element method will be formulated.
 Anticipating an iterative solution method to solve the nonlinear equations,
 it will be necessary to linearize the quantities involved.
 This linearization process will utilize a construction called the 
\emph on
directional derivative 
\emph default

\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The directional derivative of a function 
\begin_inset Formula $f\left(\mathbf{x}\right)$
\end_inset

 is defined as follows: 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}f\left(\mathbf{x}+\varepsilon\mathbf{u}\right)\,.\label{eq27}
\end{equation}

\end_inset

The quantity 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset

 
\series default
may be a scalar, a vector or even a vector of unknown functions.
 For instance, consider a scalar function 
\begin_inset Formula $f\left(\mathbf{x}\right)$
\end_inset

, where 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset

 
\series default
is the position vector in 
\begin_inset Formula $\mathbb{R}^{3}$
\end_inset

.
 In this case the directional derivative is given by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Df\left(\mathbf{x}\right)\left[\mathbf{u}\right] & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}f\left(\mathbf{x}+\varepsilon\mathbf{u}\right)\\
 & =\frac{\partial f}{\partial x_{i}}u_{i}\\
 & =\nabla f\cdot\mathbf{u}\,.
\end{aligned}
\label{eq28}
\end{equation}

\end_inset

Here, the symbol 
\begin_inset Formula $\nabla$
\end_inset

(
\begin_inset Quotes eld
\end_inset

nabla
\begin_inset Quotes erd
\end_inset

) depicts the gradient operator.
\end_layout

\begin_layout Standard
The linearization of a function implies that it is approximated by a linear
 function.
 Using the directional derivative, a function 
\begin_inset Formula $f$
\end_inset

 can be linearized as follows: 
\begin_inset Formula 
\begin{equation}
f\left(\mathbf{x}+\mathbf{u}\right)\cong f\left(\mathbf{x}\right)+Df\left(\mathbf{x}\right)\left[\mathbf{u}\right].\label{eq29}
\end{equation}

\end_inset

The directional derivative obeys the usual properties for derivatives.
\end_layout

\begin_layout Enumerate

\emph on
sum rule
\emph default
: If 
\begin_inset Formula $f=f_{1}+f_{2}$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=Df_{1}\left(\mathbf{x}\right)\left[\mathbf{u}\right]+Df_{2}\left(\mathbf{x}\right)\left[\mathbf{u}\right]\,.\label{eq30}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\emph on
product rule
\emph default
: If 
\begin_inset Formula $f=f_{1}\cdot f_{2}$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=f_{1}\left(\mathbf{x}\right)\cdot Df_{2}\left(\mathbf{x}\right)\left[\mathbf{u}\right]+f_{2}\cdot Df_{1}\left(\mathbf{x}\right)\left[\mathbf{u}\right]\,.\label{eq31}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\emph on
chain rule
\emph default
: If 
\begin_inset Formula $f=g\left(h\left(\mathbf{x}\right)\right)$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
Df\left(\mathbf{x}\right)\left[\mathbf{u}\right]=Dg\left(h\left(\mathbf{x}\right)\right)\left[Dh\left(\mathbf{x}\right)\left[\mathbf{u}\right]\right]\,.\label{eq32}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Cauchy Stress
\begin_inset CommandInset label
LatexCommand label
name "sec:Cauchy-Stress"

\end_inset


\end_layout

\begin_layout Standard
Let the plane with unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 bisect a loaded material body, such that 
\begin_inset Formula $\mathbf{n}$
\end_inset

 represents the outward normal (pointing away from the material) to one
 of the two halves.
 The traction vector 
\begin_inset Formula $\mathbf{t}$
\end_inset

 at any point 
\begin_inset Formula $P$
\end_inset

 on this cross-section represents the limit of the reaction force 
\begin_inset Formula $\Delta\mathbf{f}_{n}$
\end_inset

 acting over an elemental area 
\begin_inset Formula $\Delta A_{n}$
\end_inset

 in the neighborhood of 
\begin_inset Formula $P$
\end_inset

, as 
\begin_inset Formula $\Delta A_{n}\to0$
\end_inset

.
 For a non-polar medium, it is assumed that the reaction moment 
\begin_inset Formula $\Delta\mathbf{m}_{n}$
\end_inset

 acting over 
\begin_inset Formula $\Delta A_{n}$
\end_inset

 at 
\begin_inset Formula $P$
\end_inset

 vanishes as 
\begin_inset Formula $\Delta A_{n}\to0$
\end_inset

.
 Since there can be an infinite number of planes passing through the point
 
\begin_inset Formula $P$
\end_inset

, it follows that 
\begin_inset Formula $\mathbf{t}$
\end_inset

 may assume an infinity of values for each different 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 Therefore, we define a unique tensorial measure 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 at 
\begin_inset Formula $P$
\end_inset

, which returns the traction 
\begin_inset Formula $\mathbf{t}$
\end_inset

 for any unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}.\label{eq:traction-stress-relation}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the 
\emph on
Cauchy stress tensor
\emph default
 at any point 
\begin_inset Formula $P$
\end_inset

 inside the material body.
 The Cauchy stress tensor, a spatial tensor, is the actual physical stress,
 since the corresponding traction vector is the force in the deformed configurat
ion, per unit deformed area.
\end_layout

\begin_layout Section
Axioms of Conservation
\begin_inset CommandInset label
LatexCommand label
name "sec:Axioms-of-Conservation"

\end_inset


\end_layout

\begin_layout Standard
The governing equations of continuum mechanics are given by the axioms of
 conservation of mass, linear and angular momentum, and energy.
 These axioms produce differential equations that need to be solved for
 the material response.
 However, on their own, these equations are insufficient to solve for all
 the unknowns in an analysis, therefore we must also provide equations of
 state that describe the behavior of specific classes of materials, such
 as elastic solids, viscoelastic solids, viscous fluids, etc.
 These equations of state are formulated as constitutive models, which may
 not be chosen arbitrarily: they must be constrained by the axiom of entropy
 inequality.
 In this section, we summarize all the axioms of conservation for a pure
 substance, as well as the axiom of entropy inequality.
\end_layout

\begin_layout Subsection
Axiom of Mass Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:Axiom-Mass-Balance"

\end_inset


\end_layout

\begin_layout Standard
The axiom of mass balance simply states that mass is conserved, or equivalently,
 its time rate of change is zero.
 Normally, we formulate this axiom in a volumetric domain (such as a fixed
 control volume with permeable boundary, a material region with impermeable
 boundary, or a material region with permeable boundary), then convert it
 to its differential form.
 In a spatial (Eulerian) frame, the differential statement of the axiom
 of mass balance takes the form
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho}{\partial t}+\divg\left(\rho\mathbf{v}\right)=0\,,\label{eq:axiom-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the mass density of the matter and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 is its velocity vector.
 Since 
\begin_inset Formula $\divg\left(\rho\mathbf{v}\right)=\grad\rho\cdot\mathbf{v}+\rho\divg\mathbf{v}$
\end_inset

, we may also write this relation in the form
\begin_inset Formula 
\begin{equation}
\frac{D\rho}{Dt}+\rho\divg\mathbf{v}=0\,,\label{eq:mass-balance-redux}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\frac{D\rho}{Dt}=\frac{\partial\rho}{\partial t}+\grad\rho\cdot\mathbf{v}\label{eq:material-derivative-density}
\end{equation}

\end_inset

is the 
\emph on
material time derivative
\emph default
 of the mass density 
\emph on
in the spatial frame
\emph default
.
\end_layout

\begin_layout Subsection
Axioms of Momentum Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:Axiom-Linear-Momentum"

\end_inset


\end_layout

\begin_layout Standard
The axioms of linear and angular momentum balance are also known as Newton's
 second law of motion.
 The axiom of linear momentum balance states that the time rate of change
 of linear momentum is equal to the sum of all surface and body forces.
 The differential statement of the axiom of mass balance in a spatial frame
 is given by
\begin_inset Formula 
\begin{equation}
\rho\frac{D\mathbf{v}}{Dt}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,\label{eq:axiom-linear-momentum}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress tensor in the material, and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the specific body force vector (body force per mass), which is typically
 prescribed.
 Note that 
\begin_inset Formula $D\mathbf{v}/Dt$
\end_inset

 is the acceleration of the matter at every point in the continuum, as evaluated
 in the spatial frame.
\end_layout

\begin_layout Standard
The axiom of angular momentum balance states that the time rate of change
 of angular momentum is equal to the sum of all surface and body moments.
 The angular momentum represents the moment of the linear momentum about
 a fixed point (such as the origin) in an inertial frame.
 In a 
\emph on
non-polar medium
\emph default
, we assume that moments are only produces by surface and body forces.
 In that case, the axiom of angular momentum balance is satisfied by the
 linear momentum balance 
\emph on
and
\emph default
 by letting the Cauchy stress be symmetric,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{T}=\boldsymbol{\sigma}\,.\label{eq:axiom-angular-momentum}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Axiom of Energy Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:Axiom-Energy-Balance"

\end_inset


\end_layout

\begin_layout Standard
The axiom of energy balance is also known as the first law of thermodynamics.
 The time rate of change of internal and kinetic energy is balanced by the
 rate of work done by body and surface forces, the rate of heat flow into
 the medium, and rate of heat supply from external sources.
 Its differential statement takes the form
\begin_inset Formula 
\begin{equation}
\rho\frac{D\varepsilon}{Dt}=\boldsymbol{\sigma}:\mathbf{L}-\divg\mathbf{q}+\rho r\,,\label{eq:axiom-energy-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the specific internal energy (internal energy per mass), 
\begin_inset Formula $\mathbf{L}=\grad\mathbf{v}$
\end_inset

 is the velocity gradient, 
\begin_inset Formula $\mathbf{q}$
\end_inset

 is the heat flux in the medium (units of power per area), and 
\begin_inset Formula $r$
\end_inset

 is the heat supply per unit mass from external sources that are not modeled
 explicitly (such as microwave heating in a framework that does not model
 microwave radiation explicitly, or Joule heating in electrical conductors,
 in a framework that does not model frictional interactions between electrons
 and atomic nuclei explicitly).
\end_layout

\begin_layout Standard
For non-polar media, since the Cauchy stress is symmetric according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:axiom-angular-momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it follows that 
\begin_inset Formula $\boldsymbol{\sigma}:\mathbf{L}=\boldsymbol{\sigma}:\mathbf{D}$
\end_inset

, where 
\begin_inset Formula $\mathbf{D}=\frac{1}{2}\left(\mathbf{L}+\mathbf{L}^{T}\right)$
\end_inset

 is the symmetric part of the velocity gradient, also known as the 
\emph on
rate of deformation tensor
\emph default
.
\end_layout

\begin_layout Subsection
Axiom of Entropy Inequality
\begin_inset CommandInset label
LatexCommand label
name "subsec:Axiom-Entropy-Inequality"

\end_inset


\end_layout

\begin_layout Standard
The axioms of conservation presented above have introduced several functions
 of state that describe the behavior of specific materials, such as the
 Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

, the specific internal energy 
\begin_inset Formula $\varepsilon$
\end_inset

, and the heat flux 
\begin_inset Formula $\mathbf{q}$
\end_inset

.
 These axioms of conservation have a total of ten scalar unknowns (six compoment
s of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

, three components of 
\begin_inset Formula $\mathbf{q}$
\end_inset

, and 
\begin_inset Formula $\varepsilon$
\end_inset

), whereas the equations have five scalar components (three components of
 the vectorial linear momentum balance, and one component for each of the
 scalar mass and energy balance equations).
 Therefore, there are too few equations to solve for all the unknowns.
 Consequently, constitutive models must be provided for these functions
 of state, which depend on a user-specified set of state variables (such
 as strain for elastic solids, rate of deformation for viscous fluids, temperatu
re for heat transfer, etc.).
\end_layout

\begin_layout Standard
Constitutive relations must be formulated in a manner that does not violate
 the axiom of entropy inequality, also known as the second law of thermodynamics.
 The second law of thermodynamics stipulates that the time rate of change
 of entropy in a medium is greater than the rate of entropy supply into
 the medium by various sources of heat.
 In a spatial frame, the differential statement of the axiom of entropy
 inequality is given by
\begin_inset Formula 
\begin{equation}
\rho\frac{D\eta}{Dt}+\divg\frac{\mathbf{q}}{\theta}-\rho\frac{r}{\theta}\geqslant0\,,\label{eq:axiom-entropy-inequality}
\end{equation}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is the specific entropy (entropy per unit mass) of the matter.
 Entropy is a measure of disorder in a medium.
 It represents another function of state.
\end_layout

\begin_layout Standard
Since Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:axiom-entropy-inequality"
plural "false"
caps "false"
noprefix "false"

\end_inset

 does not include all of the functions of state, we may combine it with
 the energy balance to recover 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\varepsilon$
\end_inset

 in the entropy inequality.
 This may be achived by multiplying the entropy inequality in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:axiom-entropy-inequality"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by the absolute temperature 
\begin_inset Formula $\theta$
\end_inset

 (recalling that 
\begin_inset Formula $\theta$
\end_inset

 is always positive) and adding it to the energy balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:axiom-energy-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce
\begin_inset Formula 
\[
-\rho\left(\frac{D\varepsilon}{Dt}-\theta\frac{D\eta}{Dt}\right)+\boldsymbol{\sigma}:\mathbf{D}-\frac{1}{\theta}\mathbf{q}\cdot\grad\theta\geqslant0\,.
\]

\end_inset

The term in parentheses may be rearranged as
\begin_inset Formula 
\[
\frac{D\varepsilon}{Dt}-\theta\frac{D\eta}{Dt}=\frac{D}{Dt}\left(\varepsilon-\theta\eta\right)+\eta\frac{D\theta}{Dt}\,.
\]

\end_inset

We now introduce the specific Helmholtz free energy, 
\begin_inset Formula $\psi$
\end_inset

, which relates the specific internal energy and entropy according to 
\begin_inset Formula 
\begin{equation}
\psi=\varepsilon-\theta\eta\,.\label{eq:specific-free-energy}
\end{equation}

\end_inset

We may say that the free energy is the part of the internal energy which
 is available to produce useful work.
 Substituting this expression above produces the form of the Clausius-Duhem
 inequality that involves all the independent functions of state appearing
 in these axioms, (
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

), 
\begin_inset Formula 
\begin{equation}
-\rho\left(\dot{\psi}+\eta\dot{\theta}\right)+\boldsymbol{\sigma}:\mathbf{D}-\frac{1}{\theta}\mathbf{q}\cdot\grad\theta\geqslant0\,,\label{eq:Clausius-Duhem-inequality}
\end{equation}

\end_inset

where we have substituted 
\begin_inset Formula $D\left(\cdot\right)/Dt$
\end_inset

 with the 
\begin_inset Formula $\left(\dot{}\right)$
\end_inset

 operator, for notational simplicity.
\end_layout

\begin_layout Standard
It is important to understant that all functions of state are non-observable
 properties of matter: No instruments exist to measure the complete state
 of stress inside a material, nor the heat flux, the internal energy, or
 the entropy.
 However, we can formulate constitutive models that relate these functions
 of state to observable state variables, then calculate their value for
 a specific state.
 Observable state variables are all based on measurements of space (length,
 area and volume) and time.
 For example, we can measure (observe) displacement, velocity and acceleration
 of matter at various spatial locations, from which we can calculate their
 spatial gradients and treat these as observable state variables.
 From measurements of length in calibrated materials, we can derive measurements
 of force (using a load cell) and temperature (using a thermometer).
\end_layout

\begin_layout Standard
To better understand the choice of state variables relevant to mechanics,
 we proceed to describe the kinematics of a continuum in the next section.
\end_layout

\begin_layout Section
Kinematics of the Continuum
\begin_inset CommandInset label
LatexCommand label
name "sec:Kinematics-of-Continuum"

\end_inset


\end_layout

\begin_layout Subsection
Motion and Path Lines
\end_layout

\begin_layout Standard
At any instant of time 
\begin_inset Formula $t$
\end_inset

, the 
\emph on
motion
\emph default
 of a material particle 
\begin_inset Formula $P$
\end_inset

 in the continuum is given by the function
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigKinematicsContinuum.pdf
	lyxscale 25
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Kinematics of the continuum.
\begin_inset CommandInset label
LatexCommand label
name "fig15"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{x}=\boldsymbol{\chi}\left(\mathbf{X},t\right)\label{eq:motion-chi}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is the reference position, at some reference time 
\begin_inset Formula $t_{0}$
\end_inset

, of the material particle 
\begin_inset Formula $P$
\end_inset

 currently located at the spatial location 
\begin_inset Formula $\mathbf{x}$
\end_inset

.
 This motion describes the 
\emph on
path line
\emph default
 of the particle that starts at 
\begin_inset Formula $\mathbf{X}$
\end_inset

 at 
\begin_inset Formula $t=t_{0}$
\end_inset

 and passes through 
\begin_inset Formula $\mathbf{x}$
\end_inset

 at time 
\begin_inset Formula $t$
\end_inset

.
 At a subsequent time 
\begin_inset Formula $t^{\prime}$
\end_inset

, the material particle passing through 
\begin_inset Formula $\mathbf{x}$
\end_inset

 would have originated at a different location 
\begin_inset Formula $\mathbf{X}^{\prime}$
\end_inset

 at 
\begin_inset Formula $t_{0}$
\end_inset

, so that 
\begin_inset Formula $\mathbf{x}=\boldsymbol{\chi}\left(\mathbf{X}^{\prime},t^{\prime}\right)=\boldsymbol{\chi}\left(\mathbf{X},t\right)$
\end_inset

.
 The material particle 
\begin_inset Formula $P$
\end_inset

 is uniquely identified by its position 
\begin_inset Formula $\mathbf{X}$
\end_inset

 in the reference configuration.
 Therefore, any function 
\begin_inset Formula $f$
\end_inset

 associated with each material point 
\begin_inset Formula $\mathbf{X}$
\end_inset

, such as density, temperature, velocity, etc., may be expressed as 
\begin_inset Formula $f=\hat{f}\left(\mathbf{X},t\right)$
\end_inset

 in the 
\emph on
material
\emph default
 (or 
\emph on
Lagrangian
\emph default
) frame.
 Alternatively, the same function may be expressed in terms of the spatial
 position 
\begin_inset Formula $\mathbf{x}$
\end_inset

 through which the material particle originating at 
\begin_inset Formula $\mathbf{X}$
\end_inset

 passes at time 
\begin_inset Formula $t$
\end_inset

.
 In that case, 
\begin_inset Formula $f=\tilde{f}\left(\mathbf{x},t\right)$
\end_inset

 expresses this function in the 
\emph on
spatial
\emph default
 (or 
\emph on
Eulerian
\emph default
) frame.
 Importantly, since the function 
\begin_inset Formula $f$
\end_inset

 is associated with the material, its time rate of change as the material
 moves is called the 
\emph on
material time derivative
\emph default
 of 
\begin_inset Formula $f$
\end_inset

.
 The material time derivative of 
\begin_inset Formula $f$
\end_inset

 in the material frame is given by
\begin_inset Formula 
\begin{equation}
\dot{f}=\frac{\partial\hat{f}\left(\mathbf{X},t\right)}{\partial t}\,.\label{eq:material-deriv-material}
\end{equation}

\end_inset

Therefore, the velocity 
\begin_inset Formula $\mathbf{v}\left(\mathbf{X},t\right)$
\end_inset

 of the particle 
\begin_inset Formula $P$
\end_inset

 is defined in the material frame as the material time derivative 
\begin_inset Formula $\dot{\boldsymbol{\chi}}\left(\mathbf{X},t\right)$
\end_inset

 of the motion,
\begin_inset Formula 
\begin{equation}
\mathbf{v}\left(\mathbf{X},t\right)=\frac{\partial\boldsymbol{\chi}\left(\mathbf{X},t\right)}{\partial t}\,.\label{eq75}
\end{equation}

\end_inset

The material time derivative of 
\begin_inset Formula $f$
\end_inset

 in the spatial frame may be evaluated by using the chain rule on 
\begin_inset Formula $f=\tilde{f}\left(\mathbf{x},t\right)\equiv f\left(\boldsymbol{\chi}\left(\mathbf{X},t\right),t\right)$
\end_inset

, thus
\begin_inset Formula 
\[
\dot{f}=\frac{\partial\tilde{f}\left(\boldsymbol{\chi},t\right)}{\partial t}+\frac{\partial\tilde{f}\left(\boldsymbol{\chi},t\right)}{\partial\boldsymbol{\chi}}\cdot\frac{\partial\boldsymbol{\chi}}{\partial t}\,.
\]

\end_inset

Using Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq75"

\end_inset

 and recognizing that 
\begin_inset Formula $\partial\tilde{f}/\partial\boldsymbol{\chi}\equiv\partial\tilde{f}/\partial\mathbf{x}=\grad\tilde{f}$
\end_inset

, this expression may be rewritten as
\begin_inset Formula 
\begin{equation}
\dot{f}=\frac{\partial\tilde{f}}{\partial t}+\grad\tilde{f}\cdot\mathbf{v}\equiv\frac{D\tilde{f}\left(\mathbf{x},t\right)}{Dt}\,.\label{eq77}
\end{equation}

\end_inset

We used the operator 
\begin_inset Formula $D\left(\cdot\right)/Dt$
\end_inset

 to emphasize that this expression represents the material time derivative
 of 
\begin_inset Formula $f$
\end_inset

 in the spatial frame.
\end_layout

\begin_layout Standard
For a given particle 
\begin_inset Formula $P$
\end_inset

, the actual value of the function 
\begin_inset Formula $f$
\end_inset

 must be the same in the material and spatial frames, thus 
\begin_inset Formula $f=\hat{f}\left(\mathbf{X},t\right)=\tilde{f}\left(\mathbf{x},t\right)$
\end_inset

.
 Similarly, its material time derivative must have the same value in either
 frame, 
\begin_inset Formula $\dot{f}=\frac{\partial\hat{f}}{\partial t}=\frac{D\tilde{f}}{Dt}$
\end_inset

.
 For notational convenience, we drop the caret and tilde symbols and assume
 from the context that 
\begin_inset Formula $f\left(\mathbf{X},t\right)\equiv\hat{f}\left(\mathbf{X},t\right)$
\end_inset

 and 
\begin_inset Formula $f\left(\mathbf{x},t\right)\equiv\tilde{f}\left(\mathbf{x},t\right)$
\end_inset

.
\end_layout

\begin_layout Subsection
Deformation Gradient
\end_layout

\begin_layout Standard
For a continuum, the increment in motion between the neigboring points 
\begin_inset Formula $\mathbf{X}$
\end_inset

 and 
\begin_inset Formula $\mathbf{X}+d\mathbf{X}$
\end_inset

 at a given time 
\begin_inset Formula $t$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
d\mathbf{x}=\boldsymbol{\chi}\left(\mathbf{X}+d\mathbf{X},t\right)-\boldsymbol{\chi}\left(\mathbf{X},t\right)=\left(\Grad\boldsymbol{\chi}\right)\cdot d\mathbf{X}\,.\label{eq:motion-gradient}
\end{equation}

\end_inset

Since the differentiation of 
\begin_inset Formula $\boldsymbol{\chi}\left(\mathbf{X},t\right)$
\end_inset

 is performed with respect to 
\begin_inset Formula $\mathbf{X}$
\end_inset

, we denote this gradient as 
\begin_inset Formula $\Grad\equiv\partial\left(\cdot\right)/\partial\mathbf{X}$
\end_inset

.
 In particular,
\begin_inset Formula 
\begin{equation}
\mathbf{F}\equiv\frac{\partial\boldsymbol{\chi}}{\partial\mathbf{X}}=\Grad\boldsymbol{\chi}\label{eq:deformation-gradient}
\end{equation}

\end_inset

is known as the 
\emph on
deformation gradient
\emph default
.
 It follows from this relationship that a material element 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 of solid constituent deforms into the material element 
\begin_inset Formula $d\mathbf{x}$
\end_inset

 at the current time 
\begin_inset Formula $t$
\end_inset

 such that 
\begin_inset Formula $d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The length of the element, 
\begin_inset Formula $ds$
\end_inset

, is given by 
\begin_inset Formula 
\begin{equation}
ds^{2}=d\mathbf{x}\cdot d\mathbf{x}=\left(\mathbf{F}\cdot d\mathbf{X}\right)\cdot\left(\mathbf{F}\cdot d\mathbf{X}\right)=d\mathbf{X}\cdot\left(\mathbf{F}^{T}\cdot\mathbf{F}\right)\cdot d\mathbf{X}\equiv d\mathbf{X}\cdot\mathbf{C}\cdot d\mathbf{X}\label{eq82}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}\label{eq83}
\end{equation}

\end_inset

 is the 
\shape italic
right Cauchy-Green deformation tensor
\shape default
.
 Note that 
\begin_inset Formula $\mathbf{C}^{T}=\left(\mathbf{F}^{T}\cdot\mathbf{F}\right)^{T}=\mathbf{F}^{T}\cdot\mathbf{F}=\mathbf{C}$
\end_inset

, thus 
\begin_inset Formula $\mathbf{C}$
\end_inset

 is symmetric.
 
\end_layout

\begin_layout Standard
Let the material element 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 be of length 
\begin_inset Formula $dS$
\end_inset

 and directed along the unit normal 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

, 
\begin_inset Formula $d\mathbf{X}=dS\mathbf{n}_{r}$
\end_inset

.
 Upon deformation, we have 
\begin_inset Formula $d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}=dS\mathbf{F}\cdot\mathbf{n}_{r}$
\end_inset

 and the length of the element in this deformed configuration is given by
 
\begin_inset Formula $ds$
\end_inset

 where 
\begin_inset Formula 
\begin{equation}
ds^{2}=d\mathbf{x}\cdot d\mathbf{x}=\left(dS\mathbf{F}\cdot\mathbf{n}_{r}\right)\cdot\left(dS\mathbf{F}\cdot\mathbf{n}_{r}\right)=dS^{2}\mathbf{n}_{r}\cdot\left(\mathbf{F}^{T}\cdot\mathbf{F}\right)\cdot\mathbf{n}_{r}=dS^{2}\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}\label{eq84}
\end{equation}

\end_inset

 The length of the element in the current configuration relative to its
 length in the reference configuration is given by 
\begin_inset Formula 
\begin{equation}
\frac{ds}{dS}=\sqrt{\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}}\equiv\lambda_{n}\label{eq85}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{n}$
\end_inset

 is the relative change in length of the material element 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 which is oriented along 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 
\begin_inset Formula $\lambda_{n}$
\end_inset

 is known as the 
\shape italic
stretch ratio
\shape default
 along 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 Note that 
\begin_inset Formula $\lambda_{n}^{2}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}$
\end_inset

 is the normal component of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 along 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

.
 If we let 
\begin_inset Formula $d\mathbf{x}=ds\,\mathbf{n}$
\end_inset

, it follows from 
\begin_inset Formula $d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}$
\end_inset

 that 
\begin_inset Formula 
\begin{equation}
\lambda_{n}\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}\label{eq85a}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now consider two material elements 
\begin_inset Formula $d\mathbf{X}_{m}=dS_{m}\mathbf{m}_{r}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{X}_{n}=dS_{n}\mathbf{n}_{r}$
\end_inset

.
 They each transform according to 
\begin_inset Formula $d\mathbf{x}_{m}=\mathbf{F}\cdot d\mathbf{X}_{m}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{x}_{n}=\mathbf{F}\cdot d\mathbf{X}_{n}$
\end_inset

 and their dot product produces
\begin_inset Formula 
\begin{equation}
d\mathbf{x}_{m}\cdot d\mathbf{x}_{n}=\left(\mathbf{F}\cdot d\mathbf{X}_{m}\right)\cdot\left(\mathbf{F}\cdot d\mathbf{X}_{n}\right)=d\mathbf{X}_{n}\cdot\mathbf{C}\cdot d\mathbf{X}_{m}\label{eq85b}
\end{equation}

\end_inset

or equivalently,
\begin_inset Formula 
\begin{equation}
\lambda_{m}\lambda_{n}\mathbf{m}\cdot\mathbf{n}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{m}_{r}\,,\quad\lambda_{m}=\frac{ds_{m}}{dS_{m}},\,\lambda_{n}=\frac{ds_{n}}{dS_{n}}\label{eq85c}
\end{equation}

\end_inset

where 
\begin_inset Formula $d\mathbf{x}_{m}=ds_{m}\mathbf{m}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{x}_{n}=ds_{n}\mathbf{n}$
\end_inset

.
 Note that we may write 
\begin_inset Formula $\mathbf{m}\cdot\mathbf{n}=\cos\theta=\sin\gamma$
\end_inset

, where 
\begin_inset Formula $\theta$
\end_inset

 is the angle between 
\begin_inset Formula $d\mathbf{x}_{m}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{x}_{n}$
\end_inset

 and 
\begin_inset Formula $\gamma=\frac{\pi}{2}-\theta$
\end_inset

 is its complementary angle (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig17"

\end_inset

), so that
\begin_inset Formula 
\begin{equation}
\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{m}_{r}=\lambda_{m}\lambda_{n}\sin\gamma\,.\label{eq85d}
\end{equation}

\end_inset

Now consider the case where 
\begin_inset Formula $\mathbf{m}_{r}\cdot\mathbf{n}_{r}=0$
\end_inset

, i.e., the material elements 
\begin_inset Formula $d\mathbf{X}_{m}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{X}_{n}$
\end_inset

 are orthogonal, so that 
\begin_inset Formula $\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{m}_{r}=C_{mn}$
\end_inset

 where 
\begin_inset Formula $C_{mn}$
\end_inset

 is a shear component of 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 It follows from this result that 
\begin_inset Formula $C_{mn}$
\end_inset

 represents a combined measure of the change in angle between 
\begin_inset Formula $\mathbf{m}_{r}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

, as well as the stretching of elements 
\begin_inset Formula $d\mathbf{X}_{m}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{X}_{n}$
\end_inset

.
 The angle 
\begin_inset Formula $\gamma$
\end_inset

, which represents the change in angle between initially orthogonal line
 elements along 
\begin_inset Formula $\mathbf{m}_{r}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

, is called the 
\emph on
engineering shear strain
\emph default
.
 In particular, in the range of small strains and rotations, 
\begin_inset Formula $\lambda_{m}\approx1$
\end_inset

, 
\begin_inset Formula $\lambda_{n}\approx1$
\end_inset

 and 
\begin_inset Formula $\sin\gamma\approx\gamma$
\end_inset

, so that 
\begin_inset Formula $C_{mn}\approx\gamma$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigShearStrain.pdf
	lyxscale 25
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Change of angle between filaments.
\begin_inset CommandInset label
LatexCommand label
name "fig17"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
According to the 
\emph on
polar decomposition theorem
\emph default
, the deformation gradient may be decomposed uniquely into
\begin_inset Formula 
\begin{equation}
\mathbf{F}=\mathbf{R}\cdot\mathbf{U}=\mathbf{V}\cdot\mathbf{R}\label{eq:polar-decomposition-RU}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is a proper orthogonal transformation (a rotation, with 
\begin_inset Formula $\det\mathbf{R}=+1$
\end_inset

), 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is a symmetric tensor called the 
\emph on
right
\emph default
 (or 
\emph on
material
\emph default
) 
\emph on
stretch tensor
\emph default
, and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is a symmetric tensor called the 
\emph on
left stretch tensor
\emph default
.
 It follows from this decomposition that 
\begin_inset Formula $d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}=\mathbf{R}\cdot\left(\mathbf{U}\cdot d\mathbf{X}\right)$
\end_inset

 may be viewed as a stretching of 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 by 
\begin_inset Formula $\mathbf{U}$
\end_inset

 followed by a rotation by 
\begin_inset Formula $\mathbf{R}$
\end_inset

, whereas 
\begin_inset Formula $d\mathbf{x}=\mathbf{V}\cdot\left(\mathbf{R}\cdot d\mathbf{X}\right)$
\end_inset

 is the rotation of 
\begin_inset Formula $d\mathbf{X}$
\end_inset

, followed by stretching by 
\begin_inset Formula $\mathbf{V}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}=\mathbf{U}^{2}$
\end_inset

, it follows that the eigenvalues of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 are the square of the eigenvalues of 
\begin_inset Formula $\mathbf{U}$
\end_inset

.
 Thus, these eigenvalues provide a measure of the stretch, not a measure
 of the rotation.
 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}$
\end_inset

 also share the same eigenvectors.
 Thus, if 
\begin_inset Formula $\mathbf{C}$
\end_inset

 is given by its spectral representation,
\begin_inset Formula 
\begin{equation}
\mathbf{C}=\lambda_{1}^{2}\mathbf{u}_{1}\otimes\mathbf{u}_{1}+\lambda_{2}^{2}\mathbf{u}_{2}\otimes\mathbf{u}_{2}+\lambda_{3}^{2}\mathbf{u}_{3}\otimes\mathbf{u}_{3}\label{eq:85-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{u}_{i}$
\end_inset

's are its eigenvectors, then 
\begin_inset Formula $\mathbf{U}$
\end_inset

 may be evaluated from
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\lambda_{1}\mathbf{u}_{1}\otimes\mathbf{u}_{1}+\lambda_{2}\mathbf{u}_{2}\otimes\mathbf{u}_{2}+\lambda_{3}\mathbf{u}_{3}\otimes\mathbf{u}_{3}\label{eq:85-3}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{R}=\mathbf{F}\cdot\mathbf{U}^{-1}$
\end_inset

, where 
\begin_inset Formula $\mathbf{U}^{-1}=\lambda_{1}^{-1}\mathbf{u}_{1}\otimes\mathbf{u}_{1}+\lambda_{2}^{-1}\mathbf{u}_{2}\otimes\mathbf{u}_{2}+\lambda_{3}^{-1}\mathbf{u}_{3}\otimes\mathbf{u}_{3}$
\end_inset

.
\end_layout

\begin_layout Standard
The motion can also be conveniently represented in terms of a 
\shape italic
displacement
\shape default
 function 
\begin_inset Formula $\mathbf{u}$
\end_inset

 in a material frame of reference such that 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{X}+\mathbf{u}\left(\mathbf{X},t\right)\label{eq78}
\end{equation}

\end_inset

 Then the deformation gradient for this motion is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{F}=\frac{\partial\mathbf{x}}{\partial\mathbf{X}}=\Grad\mathbf{x}=\mathbf{I}+\Grad\mathbf{u}\label{eq81}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{array}{cl}
\mathbf{C} & =\mathbf{F}^{T}\cdot\mathbf{F}=\left(\mathbf{I}+\Grad\mathbf{u}\right)^{T}\cdot\left(\mathbf{I}+\Grad\mathbf{u}\right)\\
 & =\mathbf{I}+\Grad\mathbf{u}+\Grad^{T}\mathbf{u}+\left(\Grad^{T}\mathbf{u}\right)\cdot\left(\Grad\mathbf{u}\right)
\end{array}\label{eq83-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, we can also define the 
\shape italic
Lagrangian strain tensor
\shape default
 
\begin_inset Formula $\mathbf{E}$
\end_inset

 (also known as the 
\emph on
Green-Lagrange
\emph default
 strain) from the above relation such that 
\begin_inset Formula $\mathbf{C}=\mathbf{I}+2\mathbf{E}$
\end_inset

, or 
\begin_inset Formula 
\begin{equation}
\mathbf{E}=\frac{1}{2}\left(\mathbf{C}-\mathbf{I}\right)=\frac{1}{2}\left[\Grad\mathbf{u}+\Grad^{T}\mathbf{u}+\left(\Grad^{T}\mathbf{u}\right)\cdot\left(\Grad\mathbf{u}\right)\right]\label{eq:E-C-relation}
\end{equation}

\end_inset

In the case of rigid body motion (translation and/or rotation, 
\begin_inset Formula $\mathbf{C}=\mathbf{I}$
\end_inset

), the Lagrangian strain tensor is equal to the null tensor.
 Just as in the case of the stress tensor, the strain tensors 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}$
\end_inset

 also have strain invariants, principal normal strains and principal directions
 of normal strain, maximum shear strains and directions of maximum shear
 strain.
 If 
\begin_inset Formula $\lambda^{2}$
\end_inset

 is an eigenvalue of 
\begin_inset Formula $\mathbf{C}$
\end_inset

, and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 is its associated eigenvector, then 
\begin_inset Formula $\mathbf{v}$
\end_inset

 is also an eigenvector of 
\begin_inset Formula $\mathbf{E}$
\end_inset

 since 
\begin_inset Formula 
\begin{equation}
\mathbf{E}\cdot\mathbf{v}=\frac{1}{2}\left(\mathbf{C}-\mathbf{I}\right)\cdot\mathbf{v}=\frac{1}{2}\left(\mathbf{C}\cdot\mathbf{v}-\mathbf{v}\right)=\frac{1}{2}\left(\lambda^{2}-1\right)\mathbf{v}\label{eq84-1}
\end{equation}

\end_inset

Therefore the corresponding eigenvalue of 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is 
\begin_inset Formula $\left(\lambda^{2}-1\right)/2$
\end_inset

, which also established the relation between the normal components of 
\begin_inset Formula $\mathbf{E}$
\end_inset

 and 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 The shear components of 
\begin_inset Formula $\mathbf{E}$
\end_inset

 may be related to those of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 according to
\begin_inset Formula 
\[
E_{mn}=\mathbf{m}\cdot\mathbf{E}\cdot\mathbf{n}=\frac{1}{2}\mathbf{m}\cdot\mathbf{C}\cdot\mathbf{n}=\frac{1}{2}C_{mn}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{m}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}$
\end_inset

 are orthogonal unit vectors.
 Therefore, the interpretation of 
\begin_inset Formula $E_{mn}$
\end_inset

 is similar to that of 
\begin_inset Formula $C_{mn}$
\end_inset

, with a factor of 
\begin_inset Formula $1/2$
\end_inset

.
\end_layout

\begin_layout Standard
In the limit of small displacement gradients (small strains and rotations,
 
\begin_inset Formula $\left\Vert \Grad\mathbf{u}\right\Vert \ll1$
\end_inset

), the expression for the Lagrangian strain tensor in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:E-C-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to the 
\emph on
infinitesimal strain tensor
\emph default
,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\varepsilon}=\frac{1}{2}\left(\grad\mathbf{u}+\grad^{T}\mathbf{u}\right)\,.\label{eq46}
\end{equation}

\end_inset

Note that this strain tensor is also the linearization of the Lagrangian
 strain tensor, 
\begin_inset Formula 
\begin{equation}
D\mathbf{E}\left[\mathbf{u}\right]=\mathbf{F}^{T}\cdot\boldsymbol{\varepsilon}\cdot\mathbf{F}\,.\label{eq47}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Rate of Deformation
\begin_inset CommandInset label
LatexCommand label
name "sec:Rate-of-Deformation"

\end_inset


\end_layout

\begin_layout Standard
The material time derivative of the deformation gradient may be denoted
 by 
\begin_inset Formula $\dot{\mathbf{F}}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{F}=\Grad\boldsymbol{\chi}$
\end_inset

, it follows that 
\begin_inset Formula $\dot{\mathbf{F}}=\Grad\dot{\boldsymbol{\chi}}=\Grad\mathbf{v}$
\end_inset

.
 Using the chain rule,
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{F}}=\frac{\partial\mathbf{v}}{\partial\mathbf{X}}=\frac{\partial\mathbf{v}}{\partial\mathbf{x}}\cdot\frac{\partial\mathbf{x}}{\partial\mathbf{X}}=\grad\mathbf{v}\cdot\mathbf{F}\label{eq85e}
\end{equation}

\end_inset

or simply
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{F}}=\mathbf{L}\cdot\mathbf{F}\label{eq85f}
\end{equation}

\end_inset

Differentiating 
\begin_inset Formula $\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}$
\end_inset

 with respect to time, and making use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq85e"

\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\mbox{\dot{\mathbf{C}}}=\dot{\mathbf{F}}^{T}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\dot{\mathbf{F}}=\mathbf{F}^{T}\cdot\left(\mathbf{L}^{T}+\mathbf{L}\right)\cdot\mathbf{F}\label{eq85g}
\end{equation}

\end_inset

 or equivalently,
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{C}}=2\mathbf{F}^{T}\cdot\mathbf{D}\cdot\mathbf{F}\label{eq85h}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{D}$
\end_inset

 is the rate of deformation tensor.
 This result may now be used in the time differentiation of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq85d"

\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{n}_{r}\cdot\dot{\mathbf{C}}\cdot\mathbf{m}_{r}=\left(\dot{\lambda}_{m}\lambda_{n}+\lambda_{m}\dot{\lambda}_{n}\right)\sin\gamma+\lambda_{m}\lambda_{n}\dot{\gamma}\cos\gamma\label{eq85i}
\end{equation}

\end_inset

where the left-hand-side reduces to 
\begin_inset Formula $\mathbf{n}_{r}\cdot\dot{\mathbf{C}}\cdot\mathbf{m}_{r}=2\left(\mathbf{F}\cdot\mathbf{m}_{r}\right)\cdot\mathbf{D}\cdot\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)=2\lambda_{m}\lambda_{n}\mathbf{m}\cdot\mathbf{D}\cdot\mathbf{n}$
\end_inset

.
 Substituting this result above produces
\begin_inset Formula 
\begin{equation}
\mathbf{m}\cdot\mathbf{D}\cdot\mathbf{n}=\frac{1}{2}\left(\frac{\dot{\lambda}_{m}}{\lambda_{m}}+\frac{\dot{\lambda}_{n}}{\lambda_{n}}\right)\sin\gamma+\frac{\dot{\gamma}}{2}\cos\gamma\label{eq85j}
\end{equation}

\end_inset

We now consider two cases: When 
\begin_inset Formula $\mathbf{m}=\mathbf{n}$
\end_inset

, it follows that 
\begin_inset Formula $\gamma=\pi/2$
\end_inset

, so that 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq85j"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
D_{nn}\equiv\mathbf{n}\cdot\mathbf{D}\cdot\mathbf{n}=\frac{\dot{\lambda}_{n}}{\lambda_{n}}\,.\label{eq:D-normal}
\end{equation}

\end_inset

In other words, the normal component of the rate of deformation tensor along
 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the rate of stretch per stretch of a differential line element along
 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $\mathbf{m}\cdot\mathbf{n}=0$
\end_inset

, it follows that 
\begin_inset Formula $\gamma=0$
\end_inset

, so that 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq85j"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
D_{mn}\equiv\mathbf{m}\cdot\mathbf{D}\cdot\mathbf{n}=\frac{\dot{\gamma}}{2}\,.\label{eq:D-shear}
\end{equation}

\end_inset

Thus, the shear component of 
\begin_inset Formula $\mathbf{D}$
\end_inset

 in the plane containing 
\begin_inset Formula $\mathbf{m}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is equal to half the rate at which the angle between those line elements
 changes with the deformation.
 The quantity 
\begin_inset Formula $\dot{\gamma}$
\end_inset

 is called the 
\emph on
engineering shear rate
\emph default
, or simply the 
\emph on
shear rate
\emph default
.
\end_layout

\begin_layout Standard
Finally, we note from eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:E-C-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq85h"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that the material time derivative of the Lagrangian strain is related to
 the rate of deformation via
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{E}}=\mathbf{F}^{T}\cdot\mathbf{D}\cdot\mathbf{F}\,.\label{eq:Edot-D-relation}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Volume Deformation
\begin_inset CommandInset label
LatexCommand label
name "sec:Volume-Deformation"

\end_inset


\end_layout

\begin_layout Standard
Let us show that the deformation of a volume of material 
\begin_inset Formula $dV_{r}$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
dV=J\,dV_{r},\quad J=\det\mathbf{F}=\left(\det\mathbf{C}\right)^{1/2}\label{eq87}
\end{equation}

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigReferentialVolume.pdf
	lyxscale 25
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Elemental volume.
\begin_inset CommandInset label
LatexCommand label
name "fig:Elemental-volume"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\det\mathbf{C}=\det\left(\mathbf{F}^{T}\cdot\mathbf{F}\right)=\det\mathbf{F}^{T}\det\mathbf{F}=\left(\det\mathbf{F}\right)^{2}$
\end_inset

, thus 
\begin_inset Formula $\det\mathbf{F}=\left(\det\mathbf{C}\right)^{1/2}$
\end_inset

, which proves the second equation above.
 To prove the first equation, let us define three non-collinear material
 elements in the undeformed reference state, 
\begin_inset Formula $d\mathbf{X}_{1}$
\end_inset

, 
\begin_inset Formula $d\mathbf{X}_{2}$
\end_inset

, and 
\begin_inset Formula $d\mathbf{X}_{3}$
\end_inset

.
 The elemental volume defined by these three elements has the magnitude
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
dV_{r}=\left(d\mathbf{X}_{1}\times d\mathbf{X}_{2}\right)\cdot d\mathbf{X}_{3}\tag{a}
\]

\end_inset

 in the reference state, and the magnitude 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
dV=\left(d\mathbf{x}_{1}\times d\mathbf{x}_{2}\right)\cdot d\mathbf{x}_{3}=\left(\mathbf{F}\cdot d\mathbf{X}_{1}\times\mathbf{F}\cdot d\mathbf{X}_{2}\right)\cdot\mathbf{F}\cdot d\mathbf{X}_{3}\tag{b}
\]

\end_inset

in the deformed state.
 Let the elements 
\begin_inset Formula $d\mathbf{X}_{1}$
\end_inset

, 
\begin_inset Formula $d\mathbf{X}_{2}$
\end_inset

, and 
\begin_inset Formula $d\mathbf{X}_{3}$
\end_inset

 be aligned with the orthogonal coordinate axes such that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d\mathbf{X}_{1}=dS_{1}\mathbf{e}_{1}\quad d\mathbf{X}_{2}=dS_{2}\mathbf{e}_{2}\quad d\mathbf{X}_{3}=dS_{3}\mathbf{e}_{3}\tag{c}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{e}_{i}\cdot\mathbf{e}_{j}=\delta_{ij}$
\end_inset

, then we find from (a) that 
\begin_inset Formula $dV_{r}=dS_{1}dS_{2}dS_{3}$
\end_inset

.
 From (b) we get that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
dV=\left(\mathbf{F}\cdot\mathbf{e}_{1}\times\mathbf{F}\cdot\mathbf{e}_{2}\right)\cdot\mathbf{F}\cdot\mathbf{e}_{3}\,dS_{1}dS_{2}dS_{3}=\det\mathbf{F}\,dV_{r}\tag{d}
\]

\end_inset

according to the definition of the determinant given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsubsec:determinant"

\end_inset

.
\end_layout

\begin_layout Standard
In a compressible material, the density will change with changes in volume.
 If an elemental volume of mass 
\begin_inset Formula $dm$
\end_inset

 occupies a volume 
\begin_inset Formula $dV_{r}$
\end_inset

 in some 
\emph on
reference configuration
\emph default
, then the density in the current configuration is given by 
\begin_inset Formula 
\begin{equation}
\rho=\frac{dm}{dV}=\frac{dm}{dV_{r}}\frac{dV_{r}}{dV}=\frac{\rho_{r}}{J}\label{eq88}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\rho_{r}$
\end_inset

 represents the density of the material in the reference configuration,
 which is a constant.
 The result of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq88"

\end_inset

 is the solution to the axiom of mass balance.
 To prove that point, we use the kinematic identity
\begin_inset Formula 
\begin{equation}
\frac{\partial J}{\partial\mathbf{F}}=J\mathbf{F}^{-T}\label{eq89-1}
\end{equation}

\end_inset

to express the material time derivative of 
\begin_inset Formula $J$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\dot{J}=\frac{\partial J}{\partial\mathbf{F}}:\dot{\mathbf{F}}\label{eq90-1}
\end{equation}

\end_inset

Recalling that 
\begin_inset Formula $\dot{\mathbf{F}}=\mathbf{L}\cdot\mathbf{F}$
\end_inset

, it follows that
\begin_inset Formula 
\begin{equation}
\dot{J}=J\mathbf{F}^{-T}:\mathbf{L}\cdot\mathbf{F}=J\mathbf{I}:\mathbf{L}=J\tr\mathbf{L}=J\divg\mathbf{v}\label{eq91-1}
\end{equation}

\end_inset

 or
\begin_inset Formula 
\begin{equation}
\divg\mathbf{v}=\frac{\dot{J}}{J}\label{eq92-1}
\end{equation}

\end_inset

Now, the axiom of mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as
\begin_inset Formula 
\begin{equation}
\frac{D\rho}{Dt}+\rho\divg\mathbf{v}=\dot{\rho}+\frac{\rho}{J}\dot{J}=0\label{eq93}
\end{equation}

\end_inset

Multiplying this equation across by 
\begin_inset Formula $J$
\end_inset

, we find that the resulting expression is equivalent to
\begin_inset Formula 
\begin{equation}
\frac{D\left(\rho J\right)}{Dt}=0\label{eq93b}
\end{equation}

\end_inset

Integrating this expression produces 
\begin_inset Formula $\rho J=\rho_{r}$
\end_inset

, where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the value of 
\begin_inset Formula $\rho$
\end_inset

 when 
\begin_inset Formula $J=1$
\end_inset

.
 This result reproduces 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq88"

\end_inset

.
\end_layout

\begin_layout Standard
Finally, since we know that 
\begin_inset Formula $\mathbf{F}=\mathbf{R}\cdot\mathbf{U}$
\end_inset

 according to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:polar-decomposition-RU"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it follows that
\begin_inset Formula 
\[
J=\det\mathbf{F}=\left(\det\mathbf{R}\right)\left(\det\mathbf{U}\right)=\det\mathbf{U}=\lambda_{1}\lambda_{2}\lambda_{3}\,,
\]

\end_inset

where 
\begin_inset Formula $\lambda_{i}$
\end_inset

 are the principal stretches of 
\begin_inset Formula $\mathbf{U}$
\end_inset

.
\end_layout

\begin_layout Subsection
Area Deformation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Area-Deformation"

\end_inset


\end_layout

\begin_layout Standard
In general, we can express the position of a material point 
\begin_inset Formula $\mathbf{X}$
\end_inset

 as a function of parametric coordinates 
\begin_inset Formula $\eta^{i}$
\end_inset

 (i=1,2,3), thus 
\begin_inset Formula $\mathbf{X}=\mathbf{X}\left(\eta^{i}\right)$
\end_inset

.
 Then, a line element in the reference configuration is given by
\begin_inset Formula 
\begin{equation}
d\mathbf{X}=\frac{\partial\mathbf{X}}{\partial\eta^{i}}d\eta^{i}\equiv\mathbf{G}_{i}d\eta^{i}\,,\label{eq:covariant-basis-material}
\end{equation}

\end_inset

where we use the implicit (Einstein) summation convention of indicial notation.
 Here, the vectors 
\begin_inset Formula $\mathbf{G}_{i}$
\end_inset

 are called the covariant basis vectors of 
\begin_inset Formula $\mathbf{X}\left(\eta^{i}\right)$
\end_inset

, in the material frame.
 We may also express the motion in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:motion-chi"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as a function of the same parametric coordinates, such that the corresponding
 line element in the spatial frame is
\begin_inset Formula 
\begin{equation}
d\mathbf{x}=\frac{\partial\boldsymbol{\chi}}{\partial\eta^{i}}d\eta^{i}\equiv\mathbf{g}_{i}d\eta^{i}\,,\label{eq:covariant-basis-spatial}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{g}_{i}$
\end_inset

's represent the covariant basis vector at 
\begin_inset Formula $\mathbf{x}=\boldsymbol{\chi}\left(\mathbf{X},t\right)$
\end_inset

 in the spatial frame.
 Since 
\begin_inset Formula $d\mathbf{x}$
\end_inset

 is related to 
\begin_inset Formula $d\mathbf{X}$
\end_inset

 by the deformation gradient as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:motion-gradient"
plural "false"
caps "false"
noprefix "false"

\end_inset

, or 
\begin_inset Formula $d\mathbf{x}=\mathbf{F}\cdot d\mathbf{X}$
\end_inset

, it can be shown that the deformation gradient is given by
\begin_inset Formula 
\begin{equation}
\mathbf{F}=\mathbf{g}_{i}\otimes\mathbf{G}^{i}\,,\label{eq:defgrad-cov-cont}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{G}^{i}$
\end_inset

's represent the contravariant basis vector of 
\begin_inset Formula $\mathbf{X}\left(\eta^{i}\right)$
\end_inset

, in the material frame.
 Covariant and contravariant basis vectors satisfy 
\begin_inset Formula $\mathbf{G}_{i}\cdot\mathbf{G}^{j}=\mathbf{G}^{i}\cdot\mathbf{G}_{j}=\delta_{j}^{i}$
\end_inset

, where 
\begin_inset Formula $\delta_{j}^{i}$
\end_inset

 is the Kronecker delta.
 The same is true in the spatial frame.
 The expression for 
\begin_inset Formula $\mathbf{F}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:defgrad-cov-cont"
plural "false"
caps "false"
noprefix "false"

\end_inset

 emphasizes that 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is a 
\emph on
two-point tensor
\emph default
: It has one leg in the material frame (
\begin_inset Formula $\mathbf{G}^{i}$
\end_inset

) and the other in the spatial frame (
\begin_inset Formula $\mathbf{g}_{i}$
\end_inset

).
 It follows from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:defgrad-cov-cont"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that covariant basis vectors in the material and spatial frames are related
 by 
\begin_inset Formula 
\begin{equation}
\mathbf{F}\cdot\mathbf{G}_{j}=\mathbf{g}_{j}\,.\label{eq:cov-basis-xformation}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Now consider that an elemental volume 
\begin_inset Formula $dV_{r}$
\end_inset

 in the reference configuration can be evaluated from
\begin_inset Formula 
\[
dV_{r}=\left(\mathbf{G}_{1}d\eta^{1}\times\mathbf{G}_{2}d\eta^{2}\right)\cdot\mathbf{G}_{3}d\eta^{3}\equiv d\mathbf{A}\cdot\mathbf{G}_{3}d\eta^{3}\,,
\]

\end_inset

where 
\begin_inset Formula $d\mathbf{A}$
\end_inset

 is the vectorial representation of the elemental directed area 
\begin_inset Formula $\mathbf{G}_{1}d\eta^{1}\times\mathbf{G}_{2}d\eta^{2}$
\end_inset

.
 Similarly, the elemental volume 
\begin_inset Formula $dV$
\end_inset

 in the current configuration is given by
\begin_inset Formula 
\[
dV=\left(\mathbf{g}_{1}d\eta^{1}\times\mathbf{g}_{2}d\eta^{2}\right)\cdot\mathbf{g}_{3}d\eta^{3}\equiv d\mathbf{a}\cdot\mathbf{g}_{3}d\eta^{3}\,.
\]

\end_inset

Using eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq87"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cov-basis-xformation"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we may rewrite this expression as
\begin_inset Formula 
\[
dV=d\mathbf{a}\cdot\mathbf{F}\cdot\mathbf{G}_{3}d\eta^{3}=JdV_{r}=Jd\mathbf{A}\cdot\mathbf{G}_{3}d\eta^{3}\,.
\]

\end_inset

From this general expression, we can find the relation between 
\begin_inset Formula $d\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{A}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
d\mathbf{a}=J\mathbf{F}^{-T}\cdot d\mathbf{A}\,,\label{eq:Nanson-formula}
\end{equation}

\end_inset

which is known as Nanson's formula 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "false"

\end_inset

.
 It relates the change in surface area, and the reorientation of the surface
 normal, between the referential area 
\begin_inset Formula $d\mathbf{A}$
\end_inset

 and its corresponding area 
\begin_inset Formula $d\mathbf{a}$
\end_inset

 in the current configuration.
\end_layout

\begin_layout Standard
Using the general expression for the deformation gradient in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:defgrad-cov-cont"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it follows that the right Cauchy-Green tensor is given by
\begin_inset Formula 
\[
\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}=g_{ij}\mathbf{G}^{i}\otimes\mathbf{G}^{j}
\]

\end_inset

where 
\begin_inset Formula $g_{ij}=\mathbf{g}_{i}\cdot\mathbf{g}_{j}$
\end_inset

 is called the covariant metric tensor in the spatial frame.
\end_layout

\begin_layout Section
Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Hyperelasticity"

\end_inset


\end_layout

\begin_layout Subsection
Constitutive Restrictions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constitutive-Restrictions"

\end_inset


\end_layout

\begin_layout Standard
Now, we need to make constitutive assumptions on the dependent variables
 which appears in Clausius-Duhem inequality, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Clausius-Duhem-inequality"
plural "false"
caps "false"
noprefix "false"

\end_inset

, namely, 
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

.
 These functions could depend on a number of 
\emph on
state variables
\emph default
, such as strain, rate of deformation, temperature, temperature gradient,
 etc.
 For example, the pressure in a gas is generally assumed to depend on temperatur
e and density, so it would follow that 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 for a gas should exhibit the same dependencies.
 
\end_layout

\begin_layout Standard
For solid materials we have found that that the mass density is dependent
 on the strain (eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq88"

\end_inset

, 
\begin_inset Formula $\rho=\rho_{r}\left(\det\mathbf{C}\right)^{-1/2}=\rho_{r}/J$
\end_inset

, where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is a constant); so long as a dependence on the strain is provided, an explicit
 dependency on mass density is not required.
\end_layout

\begin_layout Standard
For the purpose of modeling elastic solids under isothermal conditions,
 we would like to restrict our constitutive models to be independent of
 the temperature or its gradient.
 For an elastic solid, the rate of load application does not have an effect;
 therefore, there should be no dependency on the rate of deformation 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
 Furthermore, for an elastic solid, upon removal of the loading, deformations
 should disappear completely.
 This implies that there should be no dependence on the history (or path)
 of loading, only on the current state of loading.
\end_layout

\begin_layout Standard
Given these restrictions, we assume that the non-observable functions of
 state 
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 depend only on the observable solid matrix strain, such as 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 Based on the principle of equipresence, all functions of state depend only
 on 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 In particular, since 
\begin_inset Formula $\psi$
\end_inset

 is the only function of state which is differentiated with respect to time
 in the Clausius-Duhem inequality, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Clausius-Duhem-inequality"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we express it explicitly as
\begin_inset Formula 
\begin{equation}
\psi=\psi\left(\mathbf{E}\right)\,.\label{eq95-1}
\end{equation}

\end_inset

Given this dependence, we can use the chain rule of differentiation to get
 
\begin_inset Formula 
\begin{equation}
\dot{\psi}=\frac{d\psi}{d\mathbf{E}}:\dot{\mathbf{E}}=\frac{d\psi}{d\mathbf{E}}:\mathbf{F}^{T}\cdot\mathbf{D}\cdot\mathbf{F}\label{eq96-1}
\end{equation}

\end_inset

where we have made use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Edot-D-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Making use of the identity 
\begin_inset Formula 
\begin{equation}
\frac{d\psi}{d\mathbf{E}}:\mathbf{F}^{T}\cdot\mathbf{D}\cdot\mathbf{F}=\mathbf{F}\cdot\frac{d\psi}{d\mathbf{E}}\cdot\mathbf{F}^{T}:\mathbf{D}\label{eq100-1}
\end{equation}

\end_inset

 we find that the entropy inequality reduces to 
\begin_inset Formula 
\begin{equation}
-\rho\eta\dot{\theta}-\frac{1}{\theta}\mathbf{q}\cdot\grad\theta+\left(\boldsymbol{\sigma}-\rho\mathbf{F}\cdot\frac{d\psi}{d\mathbf{E}}\cdot\mathbf{F}^{T}\right):\mathbf{D}\geqslant0\label{eq101-1}
\end{equation}

\end_inset

This inequality must hold for arbitrary processes, i.e., for arbitrary changes
 in 
\begin_inset Formula $\mathbf{D}$
\end_inset

, 
\begin_inset Formula $\dot{\theta}$
\end_inset

 and 
\begin_inset Formula $\grad\theta$
\end_inset

 (all of which are independent, observable variables of state), under our
 self-imposed constraint that 
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\eta$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 only depend on the state variable 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 For example, since the temperature 
\begin_inset Formula $\theta$
\end_inset

 in the leftmost term of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq101-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may either increase or decrease at various times in any process, the sign
 of 
\begin_inset Formula $\dot{\theta}$
\end_inset

 may be variably positive or negative.
 However, the sign of the product 
\begin_inset Formula $-\rho\eta\dot{\theta}$
\end_inset

 may not be set strictly positive since 
\begin_inset Formula $\rho\eta$
\end_inset

 does not depend on 
\begin_inset Formula $\dot{\theta}$
\end_inset

.
 The same argument applies to the remaining terms in the entropy inequality,
 each of which may vary independently of other terms.
 Therefore, the only way that the entropy inequality may be satisfied for
 arbitrary processes, given our choice of state variables, is to have each
 term be independently equal to zero.
 Thus, the entropy inequality requires that 
\begin_inset Formula 
\begin{equation}
\eta=0\label{eq102-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\rho\mathbf{F}\cdot\frac{d\psi}{d\mathbf{E}}\cdot\mathbf{F}^{T}\label{eq103-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}=\mathbf{0}\label{eq105-1}
\end{equation}

\end_inset

Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq102-1"

\end_inset

 shows that the entropy must be zero for our choice of state variable, whereas
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103-1"

\end_inset

 is the fundamental constraint we seek for formulating constitutive relations
 in elasticity problems.
 The constraint of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq105-1"

\end_inset

 implies that isothermal processes must be adiabatic, as there cannot be
 heat flow in such problems.
\end_layout

\begin_layout Standard
Let the Helmholtz free energy per unit 
\shape italic
reference
\shape default
 volume (
\shape italic
energy density
\shape default
) be denoted by 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{E}\right)\equiv\rho_{r}\psi\left(\mathbf{E}\right)\label{eq106-1}
\end{equation}

\end_inset

 Then, using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq88"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and recalling that 
\begin_inset Formula $\rho_{r}$
\end_inset

 is constant, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=J^{-1}\mathbf{F}\cdot\frac{d\Psi_{r}}{d\mathbf{E}}\cdot\mathbf{F}^{T}\,.\label{eq:hyperelastic-stress-E}
\end{equation}

\end_inset

This formula represents the constraint imposed by the second law of thermodynami
cs on the formulation of a constitutive relation for an elastic solid.
 For historical reasons, this formula is described as the 
\emph on
hyperelasticity
\emph default
 constraint.
 The method described for obtaining this formula was first proposed by Coleman
 and Noll in 1963 
\begin_inset CommandInset citation
LatexCommand citep
key "Coleman63"
literal "false"

\end_inset

.
 Prior to that formulation, other constitutive relations had been proposed
 for elastic solids (such as hypoelasticity), though it is now believed
 that the only thermodynamically valid formulation is the one given here.
 
\end_layout

\begin_layout Standard
In hyperelasticity theory, since the free energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 only depends on the strain, we may also call it the 
\emph on
strain energy density
\emph default
.
 A common alternative symbol for the strain energy density is 
\begin_inset Formula $W\left(\mathbf{E}\right)$
\end_inset

.
 Since it is common to include multiple state variables in a general formulation
 of 
\begin_inset Formula $\Psi_{r}$
\end_inset

 for a material, the derivative 
\begin_inset Formula $d\Psi_{r}/d\mathbf{E}$
\end_inset

 appearing in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is often written as a partial derivative, 
\begin_inset Formula $\partial\Psi_{r}/\partial\mathbf{E}$
\end_inset

.
 It is also common to use 
\begin_inset Formula $\mathbf{C}$
\end_inset

 instead of 
\begin_inset Formula $\mathbf{E}$
\end_inset

 as a suitable alternative measure of strain under finite deformation and
 rotation.
 In that case, based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:E-C-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 takes the form
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=2J^{-1}\mathbf{F}\cdot\frac{\partial\Psi_{r}}{\partial\mathbf{C}}\cdot\mathbf{F}^{T}\,.\label{eq:hyperelastic-stress-C}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Other Stress Tensors
\begin_inset CommandInset label
LatexCommand label
name "subsec:Other-Stress-Tensors"

\end_inset


\end_layout

\begin_layout Standard
The reaction force 
\begin_inset Formula $\mathbf{f}$
\end_inset

 exerted on a surface 
\begin_inset Formula $S$
\end_inset

 whose outward normal is 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is given by
\begin_inset Formula 
\[
\mathbf{f}=\int_{S}\mathbf{t}\,da=\int_{S}\boldsymbol{\sigma}\cdot\mathbf{n}\,da
\]

\end_inset

where 
\begin_inset Formula $da$
\end_inset

 is an elemental area of 
\begin_inset Formula $S$
\end_inset

 in the current configuration.
 Here, we used the relation between the traction vector 
\begin_inset Formula $\mathbf{t}$
\end_inset

 and the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

, given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:traction-stress-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Note that the directed area 
\begin_inset Formula $d\mathbf{a}=\mathbf{n}\,da$
\end_inset

 in this integral may be related to 
\begin_inset Formula $d\mathbf{A}$
\end_inset

 in the reference configuration, using Nanson's formula in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Nanson-formula"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce
\begin_inset Formula 
\[
\mathbf{f}=\int_{S_{r}}\boldsymbol{\sigma}\cdot J\mathbf{F}^{-T}\cdot d\mathbf{A}=\int_{S_{r}}J\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\cdot\mathbf{n}_{r}\,dA\,.
\]

\end_inset

Here, 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the unit outward normal on 
\begin_inset Formula $S_{r}$
\end_inset

 in the reference configuration.
 Equating these two forms of 
\begin_inset Formula $\mathbf{f}$
\end_inset

 and using the divergence theorem produces
\begin_inset Formula 
\[
\mathbf{f}=\int_{V}\divg\boldsymbol{\sigma}\,dV=\int_{V_{r}}\Divg\left(J\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\right)dV_{r}\,,
\]

\end_inset

where the divergence operator in the material frame is denoted by 
\begin_inset Formula $\Divg\left(\cdot\right)$
\end_inset

.
 The expression in the argument of this divergence operator is known as
 the 
\emph on
first Piola-Kirchhoff stress tensor,
\emph default
 
\begin_inset Formula 
\begin{equation}
\mathbf{P}=J\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,.\label{eq50}
\end{equation}

\end_inset

Note that 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset


\series default
, like 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
, is not symmetric.
 Also, like 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
, 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset

 
\series default
is known as a 
\emph on
two-point
\emph default
 tensor, meaning it is neither a material nor a spatial tensor.
 This is demonstrated more easily by expressing 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 in terms of its contravariant components 
\begin_inset Formula $\sigma^{ij}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sigma^{ij}\mathbf{g}_{i}\otimes\mathbf{g}_{j}\label{eq:Cauchy-cov-cont}
\end{equation}

\end_inset

and noting that 
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{-1}=\mathbf{G}_{i}\otimes\mathbf{g}^{i}\label{eq:Finv-cov-cont}
\end{equation}

\end_inset

so that the component form of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq50"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to
\begin_inset Formula 
\[
\mathbf{P}=J\sigma^{ij}\left(\mathbf{g}_{i}\otimes\mathbf{g}_{j}\right)\cdot\left(\mathbf{g}^{k}\otimes\mathbf{G}_{k}\right)=J\sigma^{ij}\mathbf{g}_{i}\otimes\mathbf{G}_{j}\,,
\]

\end_inset

confirming that it is a two-point tensor.
\end_layout

\begin_layout Standard
Two other stress measures are often used in continuum mechanics.
 Examining eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hyperelastic-stress-E"
plural "false"
caps "false"
noprefix "false"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hyperelastic-stress-C"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we may define the 
\emph on
second Piola-Kirchhoff (PK2) stress tensor
\emph default
 as 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=J\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,,\label{eq51}
\end{equation}

\end_inset

where, for a hyperelastic material,
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\frac{\partial\Psi_{r}}{\partial\mathbf{E}}=2\frac{\partial\Psi_{r}}{\partial\mathbf{C}}\,.\label{eq:PK2-hyperelasticity}
\end{equation}

\end_inset

Substituting the component form of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Cauchy-cov-cont"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq51"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Finv-cov-cont"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we find that
\begin_inset Formula 
\begin{equation}
\mathbf{S}=J\sigma^{ij}\mathbf{G}_{i}\otimes\mathbf{G}_{j}\,,\label{eq:PK2-cov-cont}
\end{equation}

\end_inset

showing that 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is a material tensor.
 This component form suggests that may also define the 
\emph on
Kirchhoff stress tensor
\emph default
 as the spatial version of 
\begin_inset Formula $\mathbf{S}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}=J\boldsymbol{\sigma}=J\sigma^{ij}\mathbf{g}_{i}\otimes\mathbf{g}_{j}\,.\label{eq49}
\end{equation}

\end_inset

Since 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is symmetric, it follows that 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is symmetric.
\end_layout

\begin_layout Standard
The inverse relations for these various stresses are are 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbf{\sigma}}=\frac{1}{J}\boldsymbol{\tau}\,,\quad\boldsymbol{\sigma}=\frac{1}{J}\mathbf{P}\cdot\mathbf{F}^{T}\,,\quad\boldsymbol{\sigma}=\frac{1}{J}\mathbf{F}\cdot\mathbf{S}\cdot\mathbf{F}^{T}\,.\label{eq52}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Directional Derivative of the Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Stress-Directional-Derivative"

\end_inset


\end_layout

\begin_layout Standard
The directional derivative of the 2
\begin_inset Formula $^{\mathrm{nd}}$
\end_inset

 PK stress tensor needs to be calculated for the linearization of the finite
 element equations.
 For a hyperelastic material, as expressed in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:PK2-hyperelasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

, a linear relationship between the directional derivative of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 and the linearized strain 
\begin_inset Formula $D\mathbf{E}\left[\mathbf{u}\right]$
\end_inset

 can be obtained: 
\begin_inset Formula 
\begin{equation}
D\mathbf{S}\left[\mathbf{u}\right]=\boldsymbol{\mathbb{C}}:D\mathbf{E}\left[\mathbf{u}\right]\,.\label{eq54}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\mathbb{C}}$
\end_inset

 is a fourth-order tensor known as the 
\emph on
material elasticity tensor
\emph default
.
 Its Cartesian components and tensorial definition are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbb{C}_{IJKL} & =\frac{\partial S_{IJ}}{\partial E_{KL}}=\frac{4\partial^{2}\Psi_{r}}{\partial C_{IJ}\partial C_{KL}}\\
\boldsymbol{\mathbb{C}} & =\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\frac{4\partial^{2}\Psi_{r}}{\partial\mathbf{C}\partial\mathbf{C}}
\end{aligned}
\,.\label{eq55}
\end{equation}

\end_inset

The spatial equivalent – the 
\emph on
spatial elasticity tensor 
\emph default

\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 – can be obtained from 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathcal{C}_{ijkl} & =\frac{1}{J}F_{iI}F_{jJ}F_{kK}F_{lL}\mathbb{C}_{IJKL}\\
\boldsymbol{\mathcal{C}} & =\frac{1}{J}\left(\mathbf{F}\oslash\mathbf{F}\right):\boldsymbol{\mathbb{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right)
\end{aligned}
.\label{eq56}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Isotropic Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:isotropic-hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
The hyperelastic constitutive equations discussed so far are unrestricted
 in their application.
 Isotropic material symmetry is defined by requiring the constitutive behavior
 to be independent of any material axes.
 Consequently, 
\begin_inset Formula $\Psi_{r}$
\end_inset

 must only be a function of the invariants of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
 (or 
\begin_inset Formula $\mathbf{E}$
\end_inset

), 
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\Psi_{r}\left(I_{1},I_{2},I_{3}\right)\,,\label{eq:isotropic-SED}
\end{equation}

\end_inset

where the invariants of 
\begin_inset Formula $\mathbf{C}$
\end_inset


\series bold
 
\series default
are defined here as, 
\begin_inset Formula 
\begin{equation}
I_{1}=\tr\mathbf{C}=\mathbf{I}:\mathbf{C},\,I_{2}=\frac{1}{2}\left[\left(\tr\mathbf{C}\right)^{2}-\tr\mathbf{C}^{2}\right],\,I_{3}=\det\mathbf{C}=J^{2}\,.\label{eq:C-invariants}
\end{equation}

\end_inset

As a result of the isotropic restriction, the second Piola-Kirchhoff stress
 tensor can be written as, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\frac{\partial\Psi}{\partial\mathbf{C}}=2\frac{\partial\Psi}{\partial I_{1}}\frac{\partial I_{1}}{\partial\mathbf{C}}+2\frac{\partial\Psi}{\partial I_{2}}\frac{\partial I_{2}}{\partial\mathbf{C}}+2\frac{\partial\Psi}{\partial I_{3}}\frac{\partial I_{3}}{\partial\mathbf{C}}\,.\label{eq:PK2-isotropic}
\end{equation}

\end_inset

The second order tensors formed by the derivatives of the invariants with
 respect to 
\begin_inset Formula $\mathbf{C}$
\end_inset

 can be evaluated as 
\begin_inset Formula 
\begin{equation}
\frac{\partial I_{1}}{\partial\mathbf{C}}=\mathbf{I}\,,\,\frac{\partial I_{2}}{\partial\mathbf{C}}=I_{1}\mathbf{I}-\mathbf{C}\,,\,\frac{\partial I_{3}}{\partial\mathbf{C}}=I_{3}\mathbf{C}^{-1}\,.\label{eq:C-invariant-deriv}
\end{equation}

\end_inset

Introducing expressions 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:C-invariant-deriv"

\end_inset

 into equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:PK2-isotropic"

\end_inset

 enables the second Piola-Kirchhoff stress to be evaluated as, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\left(\Psi_{1}+I_{1}\Psi_{2}+I_{2}\Psi_{3})\right)\mathbf{I}-2\left(\Psi_{2}+I_{1}\Psi_{3}\right)\mathbf{C}+\Psi_{3}\mathbf{C}^{2}\,,\label{eq:PK2-isotropic-final}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{1}=\partial\Psi/\partial I_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}=\partial\Psi/\partial I_{2}$
\end_inset

, and 
\begin_inset Formula $\Psi_{3}=\partial\Psi/\partial I_{3}$
\end_inset

.
\end_layout

\begin_layout Standard
The Cauchy stresses can now be obtained from the second Piola-Kirchhoff
 stresses by using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq52"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=J^{-1}\left(2\left(\Psi_{1}+I_{1}\Psi_{2}+I_{2}\Psi_{3})\right)\mathbf{b}-2\left(\Psi_{2}+I_{1}\Psi_{3}\right)\mathbf{b}^{2}+\Psi_{3}\mathbf{b}^{3}\right)\,,\label{eq:Cauchy-isotropic}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}\,.\label{eq:left-Cauchy-Green}
\end{equation}

\end_inset

is the 
\emph on
left Cauchy-Green tensor
\emph default
.
 Note that in this equation 
\begin_inset Formula $\Psi_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}$
\end_inset

, and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 still involve derivatives with respect to the invariants of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
.
 However, since the invariants of 
\series bold

\begin_inset Formula $\mathbf{b}$
\end_inset


\series default
 are identical to those of 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
, the quantities
\begin_inset Formula $\Psi_{1}$
\end_inset

, 
\begin_inset Formula $\Psi_{2}$
\end_inset

 and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 may also be considered to be the derivatives with respect to the invariants
 of 
\series bold

\begin_inset Formula $\mathbf{b}$
\end_inset


\series default
.
\end_layout

\begin_layout Subsection
Isotropic Elasticity in Principal Directions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Elasticity-Principal"

\end_inset


\end_layout

\begin_layout Standard
For isotropic materials, the principal directions of the strain and stress
 tensors are the same.
 Let the eigenvalues of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 be denoted by 
\begin_inset Formula $\lambda_{i}^{2}$
\end_inset

 (
\begin_inset Formula $i=1,2,3)$
\end_inset

, then the strain energy density may be given as a function of these eigenvalues
, 
\begin_inset Formula $\Psi\left(\lambda_{1}^{2},\lambda_{2}^{2},\lambda_{3}^{2}\right)$
\end_inset

.
 To derive the expression for the stress, recognize that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\lambda_{i}^{2}}{\partial\mathbf{C}}=\mathbf{N}_{i}\otimes\mathbf{N}_{i}\equiv\mathbf{A}_{i}\,,\label{eq68}
\end{equation}

\end_inset

where the 
\begin_inset Formula $\mathbf{N}_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 It follows that the second Piola-Kirchhoff stress may be represented as
 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\sum\limits _{i=1}^{3}S_{i}\mathbf{A}_{i}\,,\label{eq69}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
S_{i}=2\frac{\partial\Psi}{\partial\lambda_{i}^{2}}\,.\label{eq70}
\end{equation}

\end_inset

To evaluate the material elasticity tensor, recognize that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{A}_{i}}{\partial\mathbf{C}}=\frac{1}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{A}_{i}\odot\mathbf{A}_{j}+\mathbf{A}_{j}\odot\mathbf{A}_{i}\right)+\frac{1}{\lambda_{i}^{2}-\lambda_{k}^{2}}\left(\mathbf{A}_{i}\odot\mathbf{A}_{k}+\mathbf{A}_{k}\odot\mathbf{A}_{i}\right)\,,\label{eq71}
\end{equation}

\end_inset

where 
\begin_inset Formula $i,j,k$
\end_inset

 form a permutation over 
\begin_inset Formula $1,2,3$
\end_inset

.
 Then it can be shown that the material elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathbb{C}} & =\sum\limits _{i=1}^{3}4\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{i}^{2}}\mathbf{A}_{i}\otimes\mathbf{A}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}4\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{j}^{2}}\left(\mathbf{A}_{i}\otimes\mathbf{A}_{j}+\mathbf{A}_{j}\otimes\mathbf{A}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{S_{i}-S_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{A}_{i}\odot\mathbf{A}_{j}+\mathbf{A}_{j}\odot\mathbf{A}_{i}\right)
\end{aligned}
\,.\label{eq72}
\end{equation}

\end_inset

When eigenvalues coincide, L'Hospital's rule may be used to evalue the coefficie
nt in the last term, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\lambda_{j}^{2}\to\lambda_{i}^{2}}2\frac{S_{i}-S_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}=4\left(\frac{\partial^{2}\Psi}{\partial\lambda_{j}^{2}\partial\lambda_{j}^{2}}-\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}\partial\lambda_{j}^{2}}\right)\,.\label{eq73}
\end{equation}

\end_inset

The double summations in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq72"

\end_inset

 are arranged such that the summands represent fourth-order tensors with
 major and minor symmetries.
\end_layout

\begin_layout Standard
In the spatial frame, the Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum\limits _{i=1}^{3}\sigma_{i}\mathbf{a}_{i}\,,\label{eq:IEPD-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{i}=\mathbf{n}_{i}\otimes\mathbf{n}_{i}\,,\label{eq:IEPD-tensor-basis}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{n}_{i}=\left(\mathbf{F}\cdot\mathbf{N}_{i}\right)/\lambda_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{b}$
\end_inset

.
 The principal normal stresses are 
\begin_inset Formula 
\begin{equation}
\sigma_{i}=\frac{\lambda_{i}}{J}\frac{\partial\Psi}{\partial\lambda_{i}}\,.\label{eq:IEPD-principal-stress}
\end{equation}

\end_inset

The spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\sum\limits _{i=1}^{3}\left(J^{-1}\lambda_{i}^{2}\frac{\partial^{2}\Psi}{\partial\lambda_{i}^{2}}-\sigma_{i}\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}J^{-1}\lambda_{i}\lambda_{j}\frac{\partial^{2}\Psi}{\partial\lambda_{i}\partial\lambda_{j}}\left(\mathbf{a}_{i}\otimes\mathbf{a}_{j}+\mathbf{a}_{j}\otimes\mathbf{a}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{\lambda_{j}^{2}\sigma_{i}-\lambda_{i}^{2}\sigma_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{a}_{i}\odot\mathbf{a}_{j}+\mathbf{a}_{j}\odot\mathbf{a}_{i}\right)
\end{aligned}
\,.\label{eq:IEPD-elasticity}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Transversely Isotropic Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Hyperelas"

\end_inset


\end_layout

\begin_layout Standard
Transverse isotropy can be introduced by adding a vector field representing
 the material preferred direction explicitly into the strain energy 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"
literal "true"

\end_inset

.
 We require that the strain energy depends on a unit vector field 
\begin_inset Formula $\mathbf{A}$
\end_inset

, which describes the local fiber direction in the undeformed configuration.
 When the material undergoes deformation, the vector 
\begin_inset Formula $\mathbf{A}\left(\mathbf{X}\right)$
\end_inset

 may be described by a unit vector field 
\begin_inset Formula $\mathbf{a}\left(\boldsymbol{\varphi}\left(\mathbf{X}\right)\right)$
\end_inset

.
 In general, the fibers will also undergo length change.
 The fiber stretch, 
\begin_inset Formula $\lambda$
\end_inset

, can be determined in terms of the deformation gradient and the fiber direction
 in the undeformed configuration, 
\begin_inset Formula 
\begin{equation}
\lambda\mathbf{a}=\mathbf{F}\cdot\mathbf{A}\,.\label{eq95}
\end{equation}

\end_inset

Also, since 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is a unit vector, 
\begin_inset Formula 
\begin{equation}
\lambda^{2}=\mathbf{A}\cdot\mathbf{C}\cdot\mathbf{A}\,.\label{eq96}
\end{equation}

\end_inset

The strain energy function for a transversely isotropic material, 
\begin_inset Formula $\Psi\left(\mathbf{C},\mathbf{A},\mathbf{X}\right)$
\end_inset

 is an isotropic function of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}\otimes\mathbf{A}$
\end_inset

.
 It can be shown 
\begin_inset CommandInset citation
LatexCommand citep
key "Spencer84"
literal "true"

\end_inset

 that the following set of invariants are sufficient to describe the material
 fully: 
\begin_inset Formula 
\begin{equation}
I_{1}=\tr\mathbf{C}\,,\quad I_{2}=\frac{1}{2}\left[\left(\tr\mathbf{C}\right)^{2}-\tr\mathbf{C}^{2}\right]\,,\quad I_{3}=\det C=J^{2}\,,\label{eq97}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
I_{4}=\mathbf{A}\cdot\mathbf{C}\cdot\mathbf{A}\,,\quad I_{5}=\mathbf{A}\cdot\mathbf{C}^{2}\cdot\mathbf{A}\,.\label{eq98}
\end{equation}

\end_inset

The strain energy function can be written in terms of these invariants such
 that 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\mathbf{A},\mathbf{X}\right)=\Psi\left(I_{1}\left(\mathbf{C}\right),I_{2}\left(\mathbf{C}\right),I_{3}\left(\mathbf{C}\right),I_{4}\left(\mathbf{C},\mathbf{A}\right),I_{5}\left(\mathbf{C},\mathbf{A}\right)\right)\,.\label{eq99}
\end{equation}

\end_inset

The second Piola-Kirchhoff can now be obtained in the standard manner: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=2\frac{\partial\Psi}{\partial\mathbf{C}}=2\sum\limits _{i=1}^{5}\frac{\partial\Psi}{\partial I_{i}}\frac{\partial I_{i}}{\partial\mathbf{C}}\,.\label{eq100}
\end{equation}

\end_inset

In the transversely isotropic constitutive models described in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Constitutive-Models"

\end_inset

 it is further assumed that the strain energy function can be split into
 the following terms: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\mathbf{A}\right)=\Psi_{1}\left(I_{1},I_{2},I_{3}\right)+\Psi_{2}\left(I_{4}\right)+\Psi_{3}\left(I_{1},I_{2},I_{3}I_{4}\right)\,.\label{eq101}
\end{equation}

\end_inset

The strain energy function 
\begin_inset Formula $\Psi_{1}$
\end_inset

 represents the material response of the isotropic ground substance matrix,
 
\begin_inset Formula $\Psi_{2}$
\end_inset

 represents the contribution from the fiber family (e.g.
 collagen), and 
\begin_inset Formula $\Psi_{3}$
\end_inset

 is the contribution from interactions between the fibers and matrix.
 The form 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq101"

\end_inset

 generalizes many constitutive equations that have been successfully used
 in the past to describe biological soft tissues e.g.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Horowitz88,Humphrey90,Humphrey87"
literal "true"

\end_inset

.
 While this relation represents a large simplification when compared to
 the general case, it also embodies almost all of the material behavior
 that one would expect from transversely isotropic, large deformation matrix-fib
er composites.
\end_layout

\begin_layout Subsection
Incompressibility
\begin_inset CommandInset label
LatexCommand label
name "subsec:Incompressibility"

\end_inset


\end_layout

\begin_layout Standard
A material is incompressible when its mass density remains constant, 
\begin_inset Formula $\rho=\rho_{r}$
\end_inset

, or equivalently according to eq.
\begin_inset CommandInset ref
LatexCommand ref
reference "eq87"
plural "false"
caps "false"
noprefix "false"

\end_inset

, its relative volume satisfies
\begin_inset Formula 
\begin{equation}
J=1\label{eq:incompressibility-constraint}
\end{equation}

\end_inset

everywhere throughout the material.
 No real material is truly incompressible, since true incompressibility
 implies that the speed of sound in that medium is infinite, which is not
 physically possible.
 Thus, one should view this assumption as an idealization of the behavior
 of real materials.
 We may replace eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:incompressibility-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with the equivalent form 
\begin_inset Formula $\dot{J}=0$
\end_inset

, and make use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq91-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the form
\begin_inset Formula 
\begin{equation}
\divg\mathbf{v}=\mathbf{I}:\mathbf{D}=0\,,\label{eq:incompressibility-redux}
\end{equation}

\end_inset

where we recognized that the divergence of the velocity is equal to the
 trace of the velocity gradient 
\begin_inset Formula $\mathbf{L}$
\end_inset

, hence, the trace of its symmetric part 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $J=\left(\det\mathbf{C}\right)^{1/2}$
\end_inset

, the incompressibility constraint of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:incompressibility-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

 implies that the symmetric strain tensor 
\begin_inset Formula $\mathbf{E}=\frac{1}{2}\left(\mathbf{C}-\mathbf{I}\right)$
\end_inset

 used as a state variable in the derivation of the hyperelasticity relation
 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Constitutive-Restrictions"
plural "false"
caps "false"
noprefix "false"

\end_inset

) does not truly have six independent components.
 Therefore, we cannot claim that 
\begin_inset Formula $\mathbf{E}$
\end_inset

 can vary arbitrarily when enforcing the entropy inequality.
 Instead, we introduce the incompressbility constraint of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:incompressibility-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into the Clausius-Duhem inequality, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Clausius-Duhem-inequality"
plural "false"
caps "false"
noprefix "false"

\end_inset

, using the method of Lagrange multipliers,
\begin_inset Formula 
\[
-\rho\left(\dot{\psi}+\eta\dot{\theta}\right)+\left(\boldsymbol{\sigma}+\lambda\mathbf{I}\right):\mathbf{D}-\frac{1}{\theta}\mathbf{q}\cdot\grad\theta\geqslant0\,,
\]

\end_inset

where 
\begin_inset Formula $\lambda$
\end_inset

 is the Lagrange multiplier.
 Now, we may proceed with the constitutive assumption that 
\begin_inset Formula $\psi=\psi\left(\mathbf{E}\right)$
\end_inset

, as done in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Constitutive-Restrictions"
plural "false"
caps "false"
noprefix "false"

\end_inset

, until we conclude that the stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is constrained to have the form
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+2J^{-1}\mathbf{F}\cdot\frac{\partial\Psi_{r}}{\partial\mathbf{C}}\cdot\mathbf{F}^{T}\,,\quad p\equiv-\lambda\,.\label{eq:Cauchy-hyperelastic-incomp}
\end{equation}

\end_inset

This expression shows that the incompressibility constraint requires us
 to have a parameter 
\begin_inset Formula $p$
\end_inset

 (a pressure) that accounts for that part of the strain energy density that
 would normally be stored in the material as a result of volumetric strain.
 Analytically, we would solve for this additional scalar parameter 
\begin_inset Formula $p$
\end_inset

 using the constraint of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:incompressibility-constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Finally, substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Cauchy-hyperelastic-incomp"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq51"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the PK2 stress in an incompressible material takes the form
\begin_inset Formula 
\begin{equation}
\mathbf{S}=Jp\mathbf{C}^{-1}+2\frac{\partial\Psi_{r}}{\partial\mathbf{C}}\,.\label{eq:PK2-hyperelastic-incomp}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Nearly-Incompressible Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Nearly-Incompressible-Hyperelast"

\end_inset


\end_layout

\begin_layout Standard
When dealing with incompressible and nearly incompressible materials, it
 proves useful to separate the volumetric and the deviatoric (distortional)
 components of the deformation gradient 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Such a separation must ensure that the deviatoric part of the deformation
 gradient, namely 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

, does not produce any change in volume.
 Noting that the determinant of the deformation gradient gives the volume
 ratio, the determinant of 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

 must therefore satisfy, 
\begin_inset Formula 
\begin{equation}
\det\mathbf{\tilde{F}}=1\,.\label{eq38}
\end{equation}

\end_inset

This condition can be achieved by choosing 
\begin_inset Formula $\mathbf{\tilde{F}}$
\end_inset

 as, 
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}\,.\label{eq39}
\end{equation}

\end_inset

The right Cauchy-Green tensor can also be split into volumetric and deviatoric
 components.
 With the use of,
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq39"

\end_inset

 the deviatoric right Cauchy-Green tensor is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{C}}=\tilde{\mathbf{F}}^{T}\cdot\tilde{\mathbf{F}}=J^{-2/3}\mathbf{C}\,.\label{eq43-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The process of defining constitutive equations in the case of nearly incompressi
ble hyperelasticity is simplified by uncoupling the strain energy density
 
\begin_inset Formula $\Psi_{r}\left(\mathbf{C}\right)$
\end_inset

 into a volumetric energy component 
\begin_inset Formula $U\left(J\right)$
\end_inset

 and a distortional component 
\begin_inset Formula $\tilde{\Psi}\left(\mathbf{C}\right)$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C}\right)=\tilde{\Psi}\left(\mathbf{C}\right)+U\left(J\right)\,.\label{eq:UC-SED}
\end{equation}

\end_inset

The second Piola-Kirchhoff tensor for a material defined by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-SED"

\end_inset

 is obtained in the standard manner with the help of equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:PK2-isotropic"

\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =2\frac{\partial\Psi}{\partial\mathbf{C}}\\
 & =2\frac{\partial\tilde{\Psi}}{\partial\mathbf{C}}+2\frac{dU}{dJ}\frac{\partial J}{\partial C}\\
 & =2\frac{\partial\tilde{\Psi}}{\partial\mathbf{C}}+pJ\mathbf{C}^{-1}
\end{aligned}
\,,\label{eq:UC-PK2-redux}
\end{equation}

\end_inset

where the pressure 
\begin_inset Formula $p$
\end_inset

 is defined as 
\begin_inset Formula 
\begin{equation}
p=\frac{dU}{dJ}\,.\label{eq:UC-p}
\end{equation}

\end_inset

An example for 
\begin_inset Formula $U$
\end_inset

 that will be used later in the definition of the constitutive models is
 
\begin_inset Formula 
\begin{equation}
U\left(J\right)=\frac{1}{2}\kappa\left(\ln J\right)^{2}\,.\label{eq:UC-U-exa}
\end{equation}

\end_inset

The parameter 
\begin_inset Formula $\kappa$
\end_inset

 will be used later as a penalty factor that will enforce the (nearly-)
 incompressible constraint.
 However, 
\begin_inset Formula $\kappa$
\end_inset

 can represent a true material coefficient, namely the bulk modulus, for
 a compressible material that happens to have a hyperelastic strain energy
 function in the form of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-SED"

\end_inset

.
 In the case where the dilatational energy is given by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-U-exa"

\end_inset

, the pressure is 
\begin_inset Formula 
\begin{equation}
p=\kappa\frac{\ln J}{J}\,.\label{eq:UC-p-exa}
\end{equation}

\end_inset

Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-PK2-redux"

\end_inset

 can be further developed by applying the chain rule to the first term:
 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=pJ\mathbf{C}^{-1}+J^{-2/3}\dev\tilde{\mathbf{S}}\,,\label{eq:UC-PK2-redux2}
\end{equation}

\end_inset

where the 
\emph on
fictitious second Piola-Kirchoff 
\emph default
tensor 
\begin_inset CommandInset citation
LatexCommand citep
key "Holzapfel00"
literal "true"

\end_inset

 is defined by, 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{S}}=2\frac{\partial\tilde{\Psi}}{\partial\tilde{\mathbf{C}}}\,,\label{eq:UC-PK2-tilde}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Dev$
\end_inset

 is the deviator operator in the reference frame: 
\begin_inset Formula 
\begin{equation}
\Dev\left(\cdot\right)=\left(\cdot\right)-\frac{1}{3}\left(\left(\cdot\right):\mathbf{C}\right)\mathbf{C}^{-1}.\label{eq:UC-Dev}
\end{equation}

\end_inset

The Cauchy stress can then be obtained from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq52"

\end_inset


\begin_inset Formula $_{\mathrm{3}}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\dev\tilde{\boldsymbol{\sigma}}\,,\label{eq:UC-Cauchy-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\frac{2}{J}\mathbf{\tilde{F}}\cdot\frac{\partial\tilde{\Psi}}{\partial\mathbf{\tilde{C}}}\cdot\mathbf{\tilde{F}}^{T}\,,\label{eq:UC-Cauchy-stress-tilde}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\dev\left(\cdot\right)=\left(\cdot\right)-\frac{1}{3}\left(\left(\cdot\right):\mathbf{I}\right)\mathbf{I}\label{eq:UC-dev}
\end{equation}

\end_inset

is the deviator operator in the spatial frame.
\end_layout

\begin_layout Standard
The following expression will be useful in the following development.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{d\tilde{C}_{IJ}}{dC_{KL}} & =J^{-2/3}\left(\frac{1}{2}\left(\delta_{IK}\delta_{JL}+\delta_{IL}\delta_{JK}\right)-\frac{1}{3}\tilde{C}_{IJ}\tilde{C}_{KL}^{-1}\right)\\
\frac{\partial\tilde{\mathbf{C}}}{\partial\mathbf{C}} & =J^{-2/3}\left(\mathbf{I}\odot\mathbf{I}-\frac{1}{3}\tilde{\mathbf{C}}\otimes\tilde{\mathbf{C}}^{-1}\right)
\end{aligned}
\,.\label{eq89}
\end{equation}

\end_inset

Notice that the contraction with a symmetric tensor 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 results in, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{d\tilde{C}_{IJ}}{dC_{KL}}A_{IJ} & =J^{-2/3}\Dev A_{KL}\\
\mathbf{A}:\frac{\partial\tilde{\mathbf{C}}}{\partial\mathbf{C}} & =J^{-2/3}\Dev\mathbf{A}
\end{aligned}
\,.\label{eq90}
\end{equation}

\end_inset

The elasticity tensor, defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq55"

\end_inset

, takes on the following form.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbb{C}_{IJKL} & =\left(J^{2}\frac{dp}{dJ}+Jp\right)C_{IJ}^{-1}C_{KL}^{-1}-2pJ\mathcal{I}_{IJKL}\\
 & -\frac{2}{3}J^{-2/3}\left(\Dev\tilde{S}_{IJ}C_{KL}^{-1}+C_{IJ}^{-1}\Dev\tilde{S}_{KL}\right)\\
 & +\frac{2}{3}\tilde{S}_{RS}\tilde{C}_{RS}\left(\mathcal{I}_{IJKL}-\frac{1}{3}C_{KL}^{-1}C_{IJ}^{-1}\right)+J^{-4/3}\hat{\mathbb{C}}_{IJKL}\\
\boldsymbol{\mathbb{C}} & =\left(J^{2}\frac{dp}{dJ}+Jp\right)\mathbf{C}^{-1}\otimes\mathbf{C}^{-1}-2pJ\boldsymbol{\mathcal{I}}\\
 & -\frac{2}{3}J^{-2/3}\left(\Dev\tilde{\mathbf{S}}\otimes\mathbf{C}^{-1}+\mathbf{C}^{-1}\otimes\Dev\tilde{\mathbf{S}}\right)\\
 & +\frac{2}{3}\left(\tilde{\mathbf{S}}:\tilde{\mathbf{C}}\right)\left(\boldsymbol{\mathcal{I}}-\frac{1}{3}\mathbf{C}^{-1}\otimes\mathbf{C}^{-1}\right)+J^{-4/3}\hat{\boldsymbol{\mathbb{C}}}
\end{aligned}
\,,\label{eq91}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\mathcal{\mathbb{C}}}_{IJKL} & =\tilde{\mathcal{\mathbb{C}}}_{IJKL}-\frac{1}{3}\left(\tilde{\mathcal{\mathbb{C}}}_{IJRS}\tilde{C}_{RS}\tilde{C}_{KL}^{-1}+\tilde{\mathcal{\mathbb{C}}}_{RSKL}\tilde{C}_{RS}\tilde{C}_{IJ}^{-1}\right)+\frac{1}{9}\tilde{C}_{IJ}^{-1}\tilde{C}_{RS}\tilde{\mathbb{C}}_{RSMN}\tilde{C}_{MN}\tilde{C}_{KL}^{-1}\\
\hat{\mathcal{\boldsymbol{\mathbb{C}}}} & =\tilde{\mathcal{\boldsymbol{\mathbb{C}}}}-\frac{1}{3}\left(\tilde{\mathcal{\boldsymbol{\mathbb{C}}}}:\tilde{\mathbf{C}}\otimes\tilde{\mathbf{C}}^{-1}+\tilde{\mathbf{C}}^{-1}\otimes\tilde{\mathbf{C}}:\tilde{\boldsymbol{\mathcal{\mathbb{C}}}}\right)+\frac{1}{9}\tilde{\mathbf{C}}^{-1}\otimes\tilde{\mathbf{C}}:\tilde{\boldsymbol{\mathbb{C}}}:\tilde{\mathbf{C}}\otimes\tilde{\mathbf{C}}^{-1}
\end{aligned}
\,.\label{eq92}
\end{equation}

\end_inset

The spatial elasticity tensor follows from
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\left(J\frac{dp}{dJ}+p\right)\mathbf{I}\otimes\mathbf{I}-2p\mathbf{I}\odot\mathbf{I}\\
 & -\frac{2}{3}\left(\dev\tilde{\boldsymbol{\sigma}}\otimes\mathbf{I}+\mathbf{I}\otimes\dev\tilde{\boldsymbol{\sigma}}\right)\\
 & +\frac{2}{3}\left(\tilde{\boldsymbol{\sigma}}:\mathbf{I}\right)\left(\mathbf{I}\odot\mathbf{I}-\frac{1}{3}\mathbf{I}\otimes\mathbf{I}\right)+\hat{\mathcal{\boldsymbol{C}}}
\end{aligned}
\,,\label{eq:UC-spatial-elasticity}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\mathcal{C}}_{ijkl} & =\frac{1}{J}\tilde{F}_{iI}\tilde{F}_{jJ}\tilde{F}_{kK}\tilde{F}_{lL}\hat{\mathcal{\mathbb{C}}}_{IJKL}\\
\hat{\boldsymbol{\mathcal{C}}} & =\frac{1}{J}\left(\tilde{\mathbf{F}}\oslash\tilde{\mathbf{F}}\right):\hat{\boldsymbol{\mathbb{C}}}:\left(\tilde{\mathbf{F}}^{T}\oslash\tilde{\mathbf{F}}^{T}\right)\\
 & =\tilde{\boldsymbol{\mathcal{C}}}-\frac{1}{3}\left(\mathbf{I}\otimes\mathbf{I}:\tilde{\boldsymbol{\mathcal{C}}}+\tilde{\boldsymbol{\mathcal{C}}}:\mathbf{I}\otimes\mathbf{I}\right)+\frac{1}{9}\left(\mathbf{I}:\tilde{\boldsymbol{\mathcal{C}}}:\mathbf{I}\right)\mathbf{I}\otimes\mathbf{I}
\end{aligned}
\,.\label{eq:UC-spatial-elasticity-hat}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Tension-Bearing Fiber Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tension-Bearing-Fiber-Materials"

\end_inset


\end_layout

\begin_layout Standard
In biomechanics we often find it convenient to model fibrous or fibrillar
 materials using one-dimensional fibers that can only sustain tension.
 Typically, such fibers are represented with a strain energy density function
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{C}\right)=H\left(I_{n}-1\right)\Psi_{n}\left(I_{n}\right)\,,\quad I_{n}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}\label{eq:fiber-model}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the unit vector along the fiber in its reference configuration, and
 
\begin_inset Formula $I_{n}$
\end_inset

 is the square of the stretch ratio along the fiber.
 The Heaviside unit step function 
\begin_inset Formula $H\left(I_{n}-1\right)$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fiber-model"
plural "false"
caps "false"
noprefix "false"

\end_inset

 ensures that the fiber contributes strain energy only when it is under
 tension (
\begin_inset Formula $I_{n}>1$
\end_inset

); thus, the constitutive model 
\begin_inset Formula $\Psi_{n}\left(I_{n}\right)$
\end_inset

 for the tensile response of the fiber must reduce to zero when 
\begin_inset Formula $I_{n}=1$
\end_inset

.
\end_layout

\begin_layout Standard
Using the hyperelasticity relations presented above, the Cauchy stress in
 this fiber material can be evaluated as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=H\left(I_{n}-1\right)2J^{-1}\frac{d\Psi_{n}}{dI_{n}}\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\otimes\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\,,\label{eq:fiber-stress}
\end{equation}

\end_inset

and the spatial elasticity tensor is
\begin_inset Formula 
\begin{equation}
\mathcal{C}=4J^{-1}\frac{d^{2}\Psi_{n}}{dI_{n}^{2}}\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\otimes\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\otimes\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\otimes\left(\mathbf{F}\cdot\mathbf{n}_{r}\right)\,.\label{eq:fiber-elasticity}
\end{equation}

\end_inset

If we denote the unit vector along the fiber in the current configuration
 as 
\begin_inset Formula $\mathbf{n}\equiv I_{n}^{-1/2}\mathbf{F}\cdot\mathbf{n}_{r}$
\end_inset

, the above expressions may be rewritten as 
\begin_inset Formula $\boldsymbol{\sigma}=H\left(I_{n}-1\right)2J^{-1}I_{n}\Psi_{n}^{\prime}\left(I_{n}\right)\mathbf{n}\otimes\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $\mathcal{C}=4J^{-1}I_{n}^{2}\Psi_{n}^{\prime\prime}\left(I_{n}\right)\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}$
\end_inset

.
 As explained in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07a"
literal "false"

\end_inset

, these fiber models must be combined with a ground matrix in order to produce
 a stable material response.
 In FEBio this can be done by using a constrained mixture of solid constituents
 (for example, see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Simple-Solid-Mixtures"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
In the classical fiber mechanics literature it was suggested that uncoupled
 fiber formulations could also be implemented, whereby 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{C}\right)=H\left(\tilde{I}_{n}-1\right)\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)+U\left(J\right)\,,\quad\tilde{I}_{n}=\mathbf{n}_{r}\cdot\tilde{\mathbf{C}}\cdot\mathbf{n}_{r}\,,\label{eq:fiber-model-UC}
\end{equation}

\end_inset

and the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-Cauchy-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=H\left(\tilde{I}_{n}-1\right)2J^{-1}\frac{d\tilde{\Psi}_{n}}{d\tilde{I}_{n}}\left(\tilde{\mathbf{F}}\cdot\mathbf{n}_{r}\right)\otimes\left(\tilde{\mathbf{F}}\cdot\mathbf{n}_{r}\right)\,.\label{eq:fiber-stress-UC}
\end{equation}

\end_inset

Uncoupled fiber formulations of this kind are available in FEBio.
 More recently however, several studies have demonstrated that using 
\begin_inset Formula $H\left(\tilde{I}_{n}-1\right)$
\end_inset

 to detect whether a fiber is in tension or compression is non-physical,
 since 
\begin_inset Formula $\tilde{I}_{n}\ne I_{n}$
\end_inset

 and 
\begin_inset Formula $I_{n}$
\end_inset

 is the sole true measure of the tensile stretch in the fiber 
\begin_inset CommandInset citation
LatexCommand citep
key "Sansour08,Helfenstein10,Gultekin19"
literal "false"

\end_inset

.
 Therefore, uncoupled fiber formulations have fallen out of favor, even
 though FEBio still allows users to employ these for historical reasons.
 It is now recommended to use the standard (unconstrained) fiber models,
 also available in FEBio, with the formulation given in Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fiber-model"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fiber-elasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

, even when the ground matrix uses an uncoupled formulation.
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic Material
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Material"

\end_inset


\end_layout

\begin_layout Standard
Biphasic materials may be used to model deformable porous media.
 A biphasic material represents a mixture of a porous permeable solid and
 an interstitial fluid.
 Each constituent is intrinsically incompressible, but the mixture may change
 volume as interstitial fluid is exchanged with the pore space of the solid.
 Biphasic materials require the explicit modeling of fluid that permeates
 the solid.
 The biphasic material model is useful to simulate materials that show flow-depe
ndent viscoelastic behavior resulting from the frictional interactions of
 the fluid and solid.
 Several biological materials such as cartilage can be described more accurately
 this way.
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
Consider a mixture consisting of a solid constituent and a fluid constituent.
 Both constituents are considered to be intrinsically incompressible, but
 the mixture can change volume when fluid enters or leaves the porous solid
 matrix 
\begin_inset CommandInset citation
LatexCommand citep
key "Bowen80,Mow80"
literal "true"

\end_inset

.
 According to the kinematics of the continuum 
\begin_inset CommandInset citation
LatexCommand citep
key "Truesdell60"
literal "true"

\end_inset

, each constituent 
\begin_inset Formula $\alpha$
\end_inset

 of a mixture (
\begin_inset Formula $\alpha=s$
\end_inset

 for the solid and 
\begin_inset Formula $\alpha=w$
\end_inset

 for the fluid) has a separate motion 
\begin_inset Formula $\boldsymbol{\chi}^{\alpha}\left(\mathbf{X}^{\alpha},t\right)$
\end_inset

 which places particles of each mixture constituent, originally located
 at 
\begin_inset Formula $\mathbf{X}^{\alpha}$
\end_inset

, in the current configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\boldsymbol{\chi}^{\alpha}\left(\mathbf{X}^{\alpha},t\right)\,.\label{eq102}
\end{equation}

\end_inset

For the purpose of finite element analyses, the motion of the solid matrix,
 
\begin_inset Formula $\alpha=s$
\end_inset

, is of particular interest.
\end_layout

\begin_layout Standard
The governing equations that enter into the statement of virtual work are
 the conservation of linear momentum and the conservation of mass, for the
 mixture as a whole.
 Under quasi-static conditions, the conservation of momentum reduces to
 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}+\rho\mathbf{b}=\mathbf{0}\,,\label{eq103}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma$
\end_inset

 is the Cauchy stress for the mixture, 
\begin_inset Formula $\rho$
\end_inset

 is the mixture density and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the external mixture body force per mass.
 Since the mixture is porous, this stress may also be written as 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,,\label{eq104}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure and 
\begin_inset Formula $\sigma^{e}$
\end_inset

 is the effective or extra stress, resulting from the deformation of the
 solid matrix.
 Conservation of mass for the mixture requires that 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\label{eq105}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{v}^{s}=\partial\boldsymbol{\chi}^{s}/\partial t$
\end_inset

 is the solid matrix velocity and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is the flux of the fluid relative to the solid matrix.
 Let the solid matrix displacement be denoted by 
\begin_inset Formula $\mathbf{u}$
\end_inset

, then 
\begin_inset Formula $\mathbf{v}^{s}=\mathbf{\dot{u}}$
\end_inset

.
\end_layout

\begin_layout Standard
To relate the relative fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 to the fluid pressure and solid deformation, it is necessary to employ
 the equation of conservation of linear momentum for the fluid, 
\begin_inset Formula 
\begin{equation}
-\varphi^{w}\grad p+\rho^{w}\mathbf{b}^{w}+\mathbf{\hat{p}}_{d}^{w}=\mathbf{0}\,,\label{eq106}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi^{w}$
\end_inset

 is the solid matrix porosity, 
\begin_inset Formula $\rho^{w}=\varphi^{w}\rho_{T}^{w}$
\end_inset

 is the apparent fluid density and 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true fluid density, 
\begin_inset Formula $\mathbf{b}^{w}$
\end_inset

 is the external body force per mass acting on the fluid, and 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}$
\end_inset

 is the momentum exchange between the solid and fluid constituents, typically
 representing the frictional interaction between these constituents.
 This equation neglects the viscous stress of the fluid in comparison to
 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}$
\end_inset

.
 The most common constitutive relation is 
\begin_inset Formula $\mathbf{\hat{p}}_{d}^{w}=-\varphi^{w}\mathbf{k}^{-1}\cdot\mathbf{w}$
\end_inset

, where the second order, symmetric tensor 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability of the mixture.
 When combined with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq106"

\end_inset

, it produces 
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\mathbf{k}\cdot\left(\grad p-\rho_{T}^{w}\mathbf{b}^{w}\right)\,,\label{eq107}
\end{equation}

\end_inset

which is equivalent to Darcy's law.
 In general, 
\begin_inset Formula $\mathbf{k}$
\end_inset

 may be a function of the deformation.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic-Solute Material
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Solute-Material"

\end_inset


\end_layout

\begin_layout Standard
A biphasic-solute material is an extension of the biphasic material model
 that also includes transport and mechano-chemical effects of a neutral
 solute.
 Transport of a solute in a porous medium includes diffusion, resulting
 from gradients in the solute concentration, and convection of the solute
 by the solvent, as a result of fluid pressure gradients.
 Mechano-chemical effects describe phenomena such as osmotic pressurization
 and swelling.
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
The governing equations adopted in this finite element implementation of
 neutral solute transport in deformable porous media are based on the framework
 of mixture theory 
\begin_inset CommandInset citation
LatexCommand citep
key "Truesdell60,Bowen76"
literal "true"

\end_inset

.
 A single solute is considered in this presentation for notational simplicity,
 though the extension of equations to multiple solutes is straightforward.
 Various forms of the governing equations have been presented in the prior
 literature 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03,Ateshian06"
literal "true"

\end_inset

, though a presentation that incorporates all the desired features of this
 implementation has not been reported previously and is thus detailed here.
\end_layout

\begin_layout Standard
The fundamental modeling assumptions adopted in this treatment are quasi-static
 conditions for momentum balance (negligible effects of inertia), intrinsic
 incompressibility of all constituents (invariant true densities), isothermal
 conditions, negligible volume fraction of solute relative to the solid
 and solvent, and negligible effects of solute and solvent viscosities (friction
 within constituents) relative to frictional interactions between constituents.
 These assumptions are often made in studies of biological tissues and cells.
 External body forces and chemical reactions are not considered.
\end_layout

\begin_layout Standard
The three constituents of the mixture are the porous-permeable solid matrix
 (
\begin_inset Formula $\alpha=s)$
\end_inset

, the solvent (
\begin_inset Formula $\alpha=w)$
\end_inset

, and the solute (
\begin_inset Formula $\alpha=u)$
\end_inset

.
 The motion of the solid matrix is described by the displacement vector
 
\begin_inset Formula $\mathbf{u}$
\end_inset

, the pressure of the interstitial fluid (solvent
\begin_inset Formula $+$
\end_inset

solute) is 
\begin_inset Formula $p$
\end_inset

, and the solute concentration (on a solution-volume basis) is 
\begin_inset Formula $c$
\end_inset

.
 The total (or mixture) stress may be described by the Cauchy stress tensor
 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}$
\end_inset

, where 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the identity tensor and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress arising from the strain in the porous solid matrix.
 Because it is porous, the solid matrix is compressible since the volume
 of pores changes as interstitial fluid enters or leaves the matrix.
 Under the conditions outlined above, the balance of linear momentum for
 the mixture reduces to 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}=-\grad p+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,.\label{eq108}
\end{equation}

\end_inset

Similarly, the equations of balance of linear momentum for the solvent and
 solute are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\rho^{w}\grad\tilde{\mu}^{w}+\mathbf{f}^{ws}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{w}\right)+\mathbf{f}^{wu}\cdot\left(\mathbf{v}^{u}-\mathbf{v}^{w}\right) & =\mathbf{0}\,,\\
-\rho^{u}\grad\tilde{\mu}^{u}+\mathbf{f}^{us}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{u}\right)+\mathbf{f}^{uw}\cdot\left(\mathbf{v}^{w}-\mathbf{v}^{u}\right) & =\mathbf{0}\,,
\end{aligned}
\label{eq109}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho^{\alpha}$
\end_inset

 is the apparent density (mass of 
\begin_inset Formula $\alpha$
\end_inset

 per volume of the mixture), 
\begin_inset Formula $\tilde{\mu}^{\alpha}$
\end_inset

 is the mechano-chemical potential and 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the velocity of constituent 
\begin_inset Formula $\alpha$
\end_inset

.
 
\begin_inset Formula $\mathbf{f}^{\alpha\beta}$
\end_inset

 is the diffusive drag tensor between constituents 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 representing momentum exchange via frictional interactions, which satisfies
 
\begin_inset Formula $\mathbf{f}^{\beta\alpha}=\mathbf{f}^{\alpha\beta}$
\end_inset

.
 An important feature of these relations is the incorporation of momentum
 exchange term between the solute and solid matrix, 
\begin_inset Formula $\mathbf{f}^{us}\cdot\left(\mathbf{v}^{s}-\mathbf{v}^{u}\right)$
\end_inset

, which is often neglected in other treatments but plays an important role
 for describing solid-solute interactions 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03,Albro08,Albro10"
literal "true"

\end_inset

.
 These momentum equations show that the driving force for the transport
 of solvent or solute is the gradient in its mechano-chemical potential,
 which is resisted by frictional interactions with other constituents.
\end_layout

\begin_layout Standard
The mechano-chemical potential is the sum of the mechanical and chemical
 potentials.
 The chemical potential 
\begin_inset Formula $\mu^{\alpha}$
\end_inset

 of 
\begin_inset Formula $\alpha$
\end_inset

 represents the rate at which the mixture free energy changes with increasing
 mass of 
\begin_inset Formula $\alpha$
\end_inset

.
 The mechanical potential represents the rate at which the mixture free
 energy density changes with increasing volumetric strain of 
\begin_inset Formula $\alpha$
\end_inset

.
 In a mixture of intrinsically incompressible constituents, where the volumetric
 strain is idealized to be zero, this potential is given by 
\begin_inset Formula $\left(p-p_{0}\right)/\rho_{T}^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 is the true density of 
\begin_inset Formula $\alpha$
\end_inset

 (mass of 
\begin_inset Formula $\alpha$
\end_inset

 per volume of 
\begin_inset Formula $\alpha)$
\end_inset

, which is invariant for incompressible constituents, and 
\begin_inset Formula $p_{0}$
\end_inset

 is some arbitrarily set reference pressure (e.g., ambient pressure).
\end_layout

\begin_layout Standard
From classical physical chemistry, the general form of a constitutive relation
 for the chemical potential is 
\begin_inset Formula $\mu^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\left(R\theta/M^{\alpha}\right)\ln a^{\alpha}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95"
literal "true"

\end_inset

, where 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the molecular weight (invariant) and 
\begin_inset Formula $a^{\alpha}$
\end_inset

 is the activity of constituent 
\begin_inset Formula $\alpha$
\end_inset

 (a non-dimensional quantity); 
\begin_inset Formula $\mu_{0}^{\alpha}\left(\theta\right)$
\end_inset

 is the chemical potential at some arbitrary reference state, at a given
 temperature.
 For solutes, physical chemistry treatments let 
\begin_inset Formula $a^{u}=\gamma c/c_{0}$
\end_inset

, where 
\begin_inset Formula $c_{0}$
\end_inset

 is the solute concentration in some standard reference state (an invariant,
 typically 
\begin_inset Formula $c_{0}=1\,\mbox{M})$
\end_inset

, and 
\begin_inset Formula $\gamma$
\end_inset

 is the non-dimensional activity coefficient, which generally depends on
 the current state (e.g., concentration) but reduces to unity under the assumption
 of ideal physico-chemical behavior 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95"
literal "true"

\end_inset

.
 Since this representation is strictly valid for free solutions only, whereas
 solutes may be partially excluded from some of the interstitial space of
 a porous solid matrix, Mauck et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03"
literal "true"

\end_inset

 extended this representation of the solute activity to let 
\begin_inset Formula $a^{u}=\gamma c/\kappa c_{0}$
\end_inset

, where the solubility 
\begin_inset Formula $\kappa$
\end_inset

 represents the fraction of the pore space which is accessible to the solute
 (
\begin_inset Formula $0<\kappa\leqslant1)$
\end_inset

.
 In this extended form, it becomes clear that even under ideal behavior
 (
\begin_inset Formula $\gamma=1)$
\end_inset

, the solute activity may be affected by the solubility.
 Indeed, for neutral solutes, the solubility also represents the partition
 coefficient of the solute between the tissue and external bath 
\begin_inset CommandInset citation
LatexCommand citep
key "Laurent63,Ogston61"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
When accounting for the fact that the solute volume fraction is negligible
 compared to the solvent volume fraction 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95,Ateshian07b"
literal "true"

\end_inset

, the general expressions for 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{u}$
\end_inset

 take the form 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\mu}^{w} & =\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-p_{0}-R\theta\,\Phi\,c\right)\,,\\
\tilde{\mu}^{u} & =\mu_{0}^{u}\left(\theta\right)+\frac{R\theta}{M}\ln\frac{\gamma c}{\kappa c_{0}}\,,
\end{aligned}
\label{eq110}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Phi$
\end_inset

 is the osmotic coefficient (a non-dimensional function of the state), which
 deviates from unity under non-ideal physico-chemical behavior.
 Therefore, a complete description of the physico-chemical state of solvent
 and solute requires constitutive relations for 
\begin_inset Formula $\Phi$
\end_inset

 and the effective solubility 
\begin_inset Formula $\tilde{\kappa}=\kappa/\gamma$
\end_inset

, which should generally depend on the solid matrix strain and the solute
 concentration.
\end_layout

\begin_layout Standard
It is also necessary to satisfy the balance of mass for each of the constituents.
 In the absence of chemical reactions, the statement of balance of mass
 for constituent 
\begin_inset Formula $\alpha$
\end_inset

 reduces to 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=0\,.\label{eq111}
\end{equation}

\end_inset

The apparent density may be related to the true density via 
\begin_inset Formula $\rho^{\alpha}=\varphi^{\alpha}\rho_{T}^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\varphi^{\alpha}$
\end_inset

 is the volume fraction of 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture.
 Due to mixture saturation (no voids), the volume fractions add up to unity.
 Since the volume fraction of solute is considered negligible (
\begin_inset Formula $\varphi^{u}\ll\varphi^{s},\varphi^{w})$
\end_inset

, it follows that 
\begin_inset Formula $\sum\nolimits _{\alpha}\varphi^{\alpha}\approx\varphi^{s}+\varphi^{w}=1$
\end_inset

.
 Since 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 of an incompressible constituent is invariant in space and time, these
 relations may be combined to produce the mixture balance of mass relation,
 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0,\label{eq112}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

 is the volumetric flux of solvent relative to the solid.
 The balance of mass for the solute may also be written as 
\begin_inset Formula 
\begin{equation}
\frac{\partial\left(\varphi^{w}c\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}c\,\mathbf{v}^{s}\right)=0\,,\label{eq113}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{j}=\varphi^{w}c\left(\mathbf{v}^{u}-\mathbf{v}^{s}\right)$
\end_inset

 is the molar flux of solute relative to the solid.
 This mass balance relation is obtained by recognizing that the solute apparent
 density (mass per mixture volume) is related to its concentration (moles
 per solution volume) via 
\begin_inset Formula $\rho^{u}=\left(1-\varphi^{s}\right)Mc\approx\varphi^{w}Mc$
\end_inset

.
 Finally, it can be shown via standard arguments that the mass balance for
 the solid matrix reduces to 
\begin_inset Formula 
\begin{equation}
\varphi^{s}=\frac{\varphi_{r}^{s}}{J}\,,\label{eq114}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the solid volume fraction in the reference state, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}=\mathbf{I}+\grad\mathbf{u}$
\end_inset

 is the deformation gradient of the solid matrix.
\end_layout

\begin_layout Standard
Inverting the momentum balance equations in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq109"

\end_inset

, it is now possible to relate the solvent and solute fluxes to the driving
 forces according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\tilde{\mathbf{k}}\cdot\left(\rho_{T}^{w}\grad\tilde{\mu}^{w}+Mc\frac{\mathbf{d}}{d_{0}}\grad\tilde{\mu}^{u}\right)\,,\\
\mathbf{j} & =\mathbf{d}\cdot\left(-\frac{M}{R\theta}\varphi^{w}c\grad\tilde{\mu}^{u}+\frac{c}{d_{0}}\mathbf{w}\right)\,,
\end{aligned}
\label{eq115}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{d}$
\end_inset

 is the solute diffusivity tensor in the mixture (solid
\begin_inset Formula $+$
\end_inset

solution), 
\begin_inset Formula $d_{0}$
\end_inset

 is its (isotropic) diffusivity in free solution; 
\begin_inset Formula $\mathbf{\tilde{k}}$
\end_inset

 is the hydraulic permeability tensor of the solution (solvent
\begin_inset Formula $+$
\end_inset

solute) through the porous solid matrix, which depends explicitly on concentrati
on according to 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta c}{\varphi^{w}d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1},\label{eq116}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{k}$
\end_inset

 represents the hydraulic permeability tensor of the solvent through the
 solid matrix.
 The permeability and diffusivity tensors are related to the diffusive drag
 tensors appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq109"

\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k} & =\left(\varphi^{w}\right)^{2}\left(\mathbf{f}^{ws}\right)^{-1}\,,\\
\mathbf{d}_{0} & =R\theta\varphi^{w}c\left(\mathbf{f}^{uw}\right)^{-1}\equiv d_{0}\mathbf{I}\,,\\
\mathbf{d} & =R\theta\varphi^{w}c\left(\mathbf{f}^{us}+\mathbf{f}^{uw}\right)^{-1}\,,
\end{aligned}
\label{eq117}
\end{equation}

\end_inset

though these explicit relationships are not needed here since 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

 and 
\begin_inset Formula $d_{0}$
\end_inset

 may be directly specified in a particular analysis.
 Since the axiom of entropy inequality requires that the tensors 
\begin_inset Formula $\mathbf{f}^{\alpha\beta}$
\end_inset

 be positive semi-definite (see appendix of 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

), it follows that 
\begin_inset Formula $d_{0}$
\end_inset

 must be greater than or equal to the largest eigenvalue of 
\begin_inset Formula $\mathbf{d}$
\end_inset

.
 Constitutive relations are needed for these transport properties, which
 relate them to the solid matrix strain and solute concentration.
 Note that the relations in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq117"

\end_inset

 represent generalizations of Darcy's law for fluid permeation through porous
 media, and Fick's law for solute diffusion in porous media or free solution.
\end_layout

\begin_layout Subsection
Continuous Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-continuous-variables"

\end_inset


\end_layout

\begin_layout Standard
In principle, the objective of the finite element analysis is to solve for
 the three unknowns, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

, using the partial differential equations that enforce mixture momentum
 balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq108"

\end_inset

, mixture mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq112"

\end_inset

, and solute mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq113"

\end_inset

.
 The remaining solvent and solute momentum balances in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq115"

\end_inset

, and solid mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq114"

\end_inset

, have been reduced to relations that may be substituted into the three
 partial differential equations as needed.
 Solving these equations requires the application of suitable boundary condition
s that are consistent with mass, momentum and energy balances across boundary
 surfaces or interfaces.
 When defining boundaries or interfaces on the solid matrix (the conventional
 approach in solid mechanics), whose outward unit normal is 
\begin_inset Formula $\mathbf{n}$
\end_inset

, mass and momentum balance relations demonstrate that the mixture traction
 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 and normal flux components 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}=\mathbf{j}\cdot\mathbf{n}$
\end_inset

 must be continuous across the interface 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07b,Eringen65"
literal "true"

\end_inset

.
 Therefore, 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

 may be prescribed as boundary conditions.
\end_layout

\begin_layout Standard
Combining momentum and energy balances across an interface also demonstrates
 that 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{u}$
\end_inset

 must be continuous 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07b,Katzir-Katchalsky65"
literal "true"

\end_inset

, implying that these mechano-chemical potentials may be prescribed as boundary
 conditions.
 However, because of the arbitrariness of the reference states 
\begin_inset Formula $\mu_{0}^{w}$
\end_inset

, 
\begin_inset Formula $\mu_{0}^{u}$
\end_inset

, 
\begin_inset Formula $p_{0}$
\end_inset

 and 
\begin_inset Formula $c_{0}$
\end_inset

, and the ill-conditioning of the logarithm function in the limit of small
 solute concentration, the mechano-chemical potentials do not represent
 practical choices for primary variables in a finite element implementation.
 An examination of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq110"

\end_inset

 also shows that continuity of these potentials across an interface does
 not imply continuity of the fluid pressure 
\begin_inset Formula $p$
\end_inset

 or solute concentration 
\begin_inset Formula $c$
\end_inset

.
 Therefore, pressure and concentration are also unsuitable as nodal variables
 in a finite element analysis and they must be replaced by alternative choices.
 Based on the similar reasoning presented by Sun et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Sun99"
literal "true"

\end_inset

, an examination of the expressions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq110"

\end_inset

 shows that continuity may be enforced by using 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\,\Phi\,c\,,\\
\tilde{c} & =\frac{c}{\tilde{\kappa}}\,,
\end{aligned}
\label{eq118}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the effective fluid pressure and 
\begin_inset Formula $\tilde{c}$
\end_inset

 is the effective solute concentration in the mixture.
 Note that 
\begin_inset Formula $\tilde{p}$
\end_inset

 represents that part of the fluid pressure which does not result from osmotic
 effects (since the term 
\begin_inset Formula $R\theta\,\Phi\,c$
\end_inset

 may be viewed as the osmotic pressure contribution to 
\begin_inset Formula $p)$
\end_inset

, and 
\begin_inset Formula $\tilde{c}$
\end_inset

 is a straightforward measure of the solute activity, since 
\begin_inset Formula $a^{u}=\tilde{c}/c_{0}$
\end_inset

.
 Therefore these alternative variables have clear physical meanings.
\end_layout

\begin_layout Standard
Since the unknowns are now given by 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, the governing partial differential equations may be rewritten in the form
 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \grad\left(\tilde{p}+R\theta\,\Phi\,\tilde{\kappa}\tilde{c}\right)+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,,\\
 & \divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\\
 & \frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)=0\,,
\end{aligned}
\label{eq119}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\tilde{\mathbf{k}}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\,,\\
\mathbf{j} & =\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\,,\\
\tilde{\mathbf{k}} & =\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1}\,.
\end{aligned}
\label{eq120}
\end{equation}

\end_inset

Constitutive equations are needed to relate 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

, 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

, 
\begin_inset Formula $d_{0}$
\end_inset

, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 to the solid matrix strain and effective solute concentration.
\end_layout

\begin_layout Section
Triphasic and Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Triphasic-Multiphasic-Materials"

\end_inset


\end_layout

\begin_layout Standard
Multiphasic materials represent an extension of the biphasic-solute material,
 where the mixture may contain a multitude of solutes.
 These solutes may be either electrically charged (ionized) or neutral.
 Similarly, the solid matrix may either carry electrical charge (a fixed
 charge density) or be neutral.
 A triphasic material is a special case of a multiphasic material, having
 two solutes that carry opposite charges.
 Triphasic and multiphasic materials may be used to model porous deformable
 biological tissues whose solid matrix may be charged and whose interstitial
 fluid may contain any number of charged or neutral solutes.
 When mixture constituents are electrically charged, the response of the
 tissue to various loading conditions may encompass a range of mechano-electroch
emical phenomena, including permeation, diffusion, osmosis, streaming potentials
 and streaming currents.
 To better understand multiphasic materials, the reader is encouraged to
 review the descriptions of biphasic (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

) and biphasic-solute materials (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

).
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-governing-equations"

\end_inset


\end_layout

\begin_layout Standard
In multiphasic materials the solvent is assumed to be neutral, whereas the
 solid and solutes may carry charge.
 The mixture is isothermal and all constituents are considered to be intrinsical
ly incompressible.
 Since the viscosity of the fluid constituents (solvent and solutes) is
 considered negligible relative to the frictional interactions among constituent
s, the stress tensor 
\begin_inset Formula $\sigma$
\end_inset

 for the mixture includes only a contribution from the fluid pressure 
\begin_inset Formula $p$
\end_inset

 and the stress 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 in the solid, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,.\label{eq121}
\end{equation}

\end_inset

The mechano-chemical potential of the solvent is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-p_{0}-R\theta\Phi\sum\limits _{\alpha}c^{\alpha}\right)\,,\label{eq122}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{0}^{w}\left(\theta\right)$
\end_inset

 is the solvent chemical potential in the solvent standard state, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true density of the solvent (which is invariant since the solvent
 is assumed intrinsically incompressible), 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure, 
\begin_inset Formula $p_{0}$
\end_inset

 is the corresponding pressure in the standard state, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant, 
\begin_inset Formula $\Phi$
\end_inset

 is the non-dimensional osmotic coefficient, and 
\begin_inset Formula $c^{\alpha}$
\end_inset

 is the solution volume-based concentration of solute 
\begin_inset Formula $\alpha$
\end_inset

.
 The summation is taken over all solutes in the mixture.
 The mechano-electrochemical potential of each solute is similarly given
 by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\left(\frac{z^{\alpha}F_{c}}{R\theta}\left(\psi-\psi_{0}\right)+\ln\frac{\gamma^{\alpha}c^{\alpha}}{\kappa^{\alpha}c_{0}^{\alpha}}\right),\label{eq123}
\end{equation}

\end_inset

where 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the molar mass of the solute, 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 is its activity coefficient, 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 is its solubility, 
\begin_inset Formula $z^{\alpha}$
\end_inset

 is its charge number, and 
\begin_inset Formula $c_{0}^{\alpha}$
\end_inset

 is its concentration in the solute standard state; 
\begin_inset Formula $F_{c}$
\end_inset

 is Faraday's constant, 
\begin_inset Formula $\psi$
\end_inset

 is the electrical potential of the mixture, and 
\begin_inset Formula $\psi_{0}$
\end_inset

 is the corresponding potential in the standard state.
\end_layout

\begin_layout Standard
In these relations, 
\begin_inset Formula $\Phi$
\end_inset

 and 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 are functions of state that describe the deviation of the mixture from
 ideal physico-chemical behavior; 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 represents the fraction of the pore volume which may be occupied by solute
 
\begin_inset Formula $\alpha$
\end_inset

.
 The standard state represents an arbitrary set of reference conditions
 for the physico-chemical state of each constituent.
 Therefore, the values of 
\begin_inset Formula $\mu_{0}^{w}\left(\theta\right)$
\end_inset

, 
\begin_inset Formula $p_{0}$
\end_inset

, 
\begin_inset Formula $\psi_{0}$
\end_inset

, 
\begin_inset Formula $\mu_{0}^{\alpha}\left(\theta\right)$
\end_inset

, and 
\begin_inset Formula $c_{0}^{\alpha}$
\end_inset

, remain invariant over the entire domain of definition of an analysis.
 Since 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 appear together as a ratio, they may be combined into a single material
 function, 
\begin_inset Formula $\hat{\kappa}^{\alpha}=\kappa^{\alpha}/\gamma^{\alpha}$
\end_inset

, called the effective solubility.
\end_layout

\begin_layout Standard
In multiphasic mixtures, it is also assumed that electroneutrality is satisfied
 at every point in the continuum.
 Therefore, the net electrical charge summed over all constituents must
 reduce to zero, and no net charge accumulation may occur at any time.
 Denoting the fixed charge density of the solid by 
\begin_inset Formula $c^{F}$
\end_inset

 (moles of equivalent charge per solution volume), and recognizing that
 the solvent is always considered neutral, the electroneutrality condition
 may be written as 
\begin_inset Formula 
\begin{equation}
c^{F}+\sum\limits _{\alpha}z^{\alpha}c^{\alpha}=0\,.\label{eq124}
\end{equation}

\end_inset

This condition represents a constraint on a mixture of charged constituents.
 If none of the constituents are charged (
\begin_inset Formula $c^{F}=0$
\end_inset

 and 
\begin_inset Formula $z^{\alpha}=0$
\end_inset

 for all 
\begin_inset Formula $\alpha)$
\end_inset

, the constraint disappears.
\end_layout

\begin_layout Standard
Each constituent of the mixture must satisfy the axiom of mass balance.
 In the absence of chemical reactions involving constituent 
\begin_inset Formula $\alpha$
\end_inset

, its mass balance equation is 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=0\,,\label{eq125}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho^{\alpha}$
\end_inset

 is the apparent density and 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the velocity of that constituent.
 For solutes, the apparent density is related to the concentration according
 to 
\begin_inset Formula $\rho^{\alpha}=\left(1-\varphi^{s}\right)M^{\alpha}c^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\varphi^{s}$
\end_inset

 is the volume fraction of the solid.
 When the solute volume fractions are negligible, it follows that 
\begin_inset Formula $1-\varphi^{s}\approx\varphi^{w}$
\end_inset

, where 
\begin_inset Formula $\varphi^{w}$
\end_inset

 is the solvent volume fraction.
 The molar flux of the solute relative to the solid is given by 
\begin_inset Formula $\mathbf{j}^{\alpha}=\varphi^{w}c^{\alpha}\left(\mathbf{v}^{\alpha}-\mathbf{v}^{s}\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{\alpha}$
\end_inset

 is the solute velocity.
 Using these relations, the mass balance relation for the solute may be
 rewritten as 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}c^{\alpha}\right)+\divg\mathbf{j}^{\alpha}=0\,,\label{eq126}
\end{equation}

\end_inset

where 
\begin_inset Formula $D^{s}\left(\cdot\right)/Dt$
\end_inset

 represents the material time derivative in the spatial frame, following
 the solid; 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid.
 This form of the mass balance for the solute is convenient for a finite
 element formulation where the mesh is defined on the solid matrix.
\end_layout

\begin_layout Standard
The volume flux of solvent relative to the solid is given by 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}^{w}$
\end_inset

 is the solvent velocity.
 When solute volume fractions are negligible, the mass balance equation
 for the mixture reduces to 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,.\label{eq126b}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, the mass balance for the solid may be reduced to the form 
\begin_inset Formula $D^{s}\left(J\varphi^{s}\right)/Dt=0$
\end_inset

, which may be integrated to produce the algebraic relation 
\begin_inset Formula $\varphi^{s}=\varphi_{r}^{s}/J$
\end_inset

, where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the solid volume fraction in the stress-free reference state of the
 solid.
\end_layout

\begin_layout Standard
Differentiating the electroneutrality condition in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

 using the material time derivative following the solid, and substituting
 the mass balance relations into the resulting expressions, produces a constrain
t on the solute fluxes: 
\begin_inset Formula 
\begin{equation}
\divg\sum\limits _{\alpha\ne s,w}z^{\alpha}\mathbf{j}^{\alpha}=0\,.\label{eq127}
\end{equation}

\end_inset

Recognizing that 
\begin_inset Formula $\mathbf{I}_{e}=F_{c}\sum\nolimits _{\alpha\ne s,w}z^{\alpha}\mathbf{j}^{\alpha}$
\end_inset

 is the current density in the mixture, with 
\begin_inset Formula $F_{c}$
\end_inset

 representing Faraday's constant, the relation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq127"

\end_inset

 reduces to one of the Maxwell's equation, 
\begin_inset Formula $\divg\mathbf{I}_{e}=0$
\end_inset

, in the special case when there can be no charge accumulation (electroneutralit
y).
\end_layout

\begin_layout Standard
As described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-continuous-variables"

\end_inset

, the fluid pressure 
\begin_inset Formula $p$
\end_inset

 and solute concentrations 
\begin_inset Formula $c^{\alpha}$
\end_inset

 are not continuous across boundaries of a mixture, whereas 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mu}^{\alpha}$
\end_inset

's for the solutes do satisfy continuity.
 Therefore, in a finite element implementation, the following continuous
 variables are used as nodal degrees of freedom: 
\begin_inset Formula 
\begin{equation}
\tilde{p}=p-R\theta\Phi\sum\limits _{\alpha\ne s,w}c^{\alpha}\,,\label{eq128}
\end{equation}

\end_inset

which represents the effective fluid pressure, and 
\begin_inset Formula 
\begin{equation}
\tilde{c}^{\alpha}=c^{\alpha}/\tilde{\kappa}^{\alpha}\,,\label{eq129}
\end{equation}

\end_inset

which represents the effective solute concentration.
 In the last expression, 
\begin_inset Formula $\tilde{\kappa}^{\alpha}$
\end_inset

 is the partition coefficient of the solute, which is related to the effective
 solubility and electric potential according to 
\begin_inset Formula 
\begin{equation}
\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\exp\left(-\frac{z^{\alpha}F_{c}\psi}{R\theta}\right)\,.\label{eq130}
\end{equation}

\end_inset

Physically, since 
\begin_inset Formula $R\theta\,\Phi\sum\nolimits _{\alpha\ne s,w}c^{\alpha}$
\end_inset

 is the osmotic (chemical) contribution to the fluid pressure, 
\begin_inset Formula $\tilde{p}$
\end_inset

 may be interpreted as that part of the total (mechano-chemical) fluid pressure
 which does not result from osmotic effects; thus, it is the mechanical
 contribution to 
\begin_inset Formula $p$
\end_inset

.
 Similarly, the effective solute concentration 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 represents the true contribution of the molar solute content to its electrochem
ical potential.
\end_layout

\begin_layout Standard
When using these variables instead of mechano-electrochemical potentials,
 the momentum equations for the solvent and solutes may be inverted to produce
 the following flux relations: 
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\tilde{\mathbf{k}}\cdot\left(\mbox{grad}\tilde{p}+R\theta\sum\limits _{\beta\ne s,w}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\mbox{grad}\tilde{c}^{\beta}\right)\,,\label{eq131}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\alpha}=\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\mbox{grad}\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\right)\,,\label{eq132}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\sum\limits _{\alpha\ne s,w}\frac{c^{\alpha}}{d_{0}^{\alpha}}\left(\mathbf{I}-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\right)\right]^{-1}\label{eq133}
\end{equation}

\end_inset

is the effective hydraulic permeability of the solution (solvent
\begin_inset Formula $+$
\end_inset

solutes) in the mixture.
 The momentum equation for the mixture is 
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}=\mathbf{0}\,.\label{eq134}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Constrained Reactive Mixture of Solids
\begin_inset CommandInset label
LatexCommand label
name "sec:Mixture-of-Solids"

\end_inset


\end_layout

\begin_layout Standard
A solid material may consist of a heterogeneous mixture of various solid
 constituents that are constrained to move together.
 In this section we describe fundamental considerations for such constrained
 mixtures.
\end_layout

\begin_layout Subsection
Mixture Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mixture-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
Consider a constrained mixture of multiple solid constituents 
\begin_inset Formula $\sigma$
\end_inset

.
 The motion of each constituent is given by 
\begin_inset Formula $\boldsymbol{\chi}^{\sigma}\left(\mathbf{X}^{\sigma},t\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

 denotes a material point in the reference configuration of that constituent.
 At the current time 
\begin_inset Formula $t$
\end_inset

, various constituents 
\begin_inset Formula $\sigma$
\end_inset

 which occupy an elemental region with a spatial position 
\begin_inset Formula $\mathbf{x}$
\end_inset

 may have originated from distinct referential positions 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

.
 We often label a convenient constituent as the 
\shape italic
master constituent
\shape default
 
\begin_inset Formula $s$
\end_inset

 (e.g., the oldest constituent in a reactive mixture with evolving composition)
 and call the reference configuration 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

 the 
\shape italic
master reference configuration
\shape default
.
 All the referential mass densities and mass density supplies (see below)
 are evaluated relative to the master reference configuration 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

.
 The kinematics of each constituent 
\begin_inset Formula $\sigma$
\end_inset

 may be related to the kinematics of the master constituent 
\begin_inset Formula $s$
\end_inset

 through
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\boldsymbol{\chi}^{s}\left(\mathbf{X}^{s},t\right)=\boldsymbol{\chi}^{\sigma}\left(\mathbf{X}^{\sigma},t\right)\,.\label{eq:general-mixture-kinematics}
\end{equation}

\end_inset

Taking the material time derivative of this relation in the material frame
 and recognizing that this relation must hold for all 
\begin_inset Formula $t$
\end_inset

 in the case of a constrained mixture establishes that all constituents
 share the same velocity 
\begin_inset Formula $\mathbf{v}^{\sigma}=\mathbf{v}^{s}$
\end_inset

.
 However, as detailed previously 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10,Nims17"
literal "false"

\end_inset

, constituents may have distinct deformation gradients 
\begin_inset Formula $\mathbf{F}^{\sigma}=\partial\boldsymbol{\chi}^{\sigma}/\partial\mathbf{X}^{\sigma}$
\end_inset

.
 When a reaction converts a reactant 
\begin_inset Formula $\sigma=a$
\end_inset

 into a product 
\begin_inset Formula $\sigma=b$
\end_inset

, these constituents may have distinct reference configurations.
 The deformation gradient of the master constituent 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

, which also serves as the total deformation gradient, may be related to
 the 
\shape italic
relative deformation gradient
\shape default
 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 of constituent 
\begin_inset Formula $\sigma$
\end_inset

 by applying the chain rule to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mixture-kinematics"
plural "false"
caps "false"
noprefix "false"

\end_inset

, producing
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{s}\left(\mathbf{X}^{s},t\right)=\frac{\partial\boldsymbol{\chi}^{s}\left(\mathbf{X}^{s},t\right)}{\partial\mathbf{X}^{\sigma}}\cdot\frac{\partial\mathbf{X}^{\sigma}\left(\mathbf{X}^{s}\right)}{\partial\mathbf{X}^{s}}=\mathbf{F}^{\sigma}\left(\mathbf{X}^{s},t\right)\cdot\mathbf{F}^{\sigma s}\left(\mathbf{X}^{s}\right)\,.\label{eq:general-total-def-grad}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\mathbf{F}^{\sigma s}\left(\mathbf{X}^{s}\right)$
\end_inset

 is the deformation gradient of 
\begin_inset Formula $\sigma$
\end_inset

 relative to 
\begin_inset Formula $s$
\end_inset

, which must be 
\emph on
postulated by constitutive assumption
\emph default
.
 The relationship between 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

 is time-invariant; consequently, 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 is a time-invariant spatial mapping.
 It follows that only one deformation gradient represents an independent
 state variable in a constrained mixture framework, whereas all others are
 related to it via eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

; any of the 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

's may be selected, based on convenience.
 In eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 the spatio-temporal arguments have been written explicitly for clarity.
 These dependencies are implied in the forthcoming sections and henceforth
 those arguments may be selectively suppressed.
 Taking the determinant of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 produces a relation between the volume ratios 
\begin_inset Formula $J^{\sigma}=\det\mathbf{F}^{\sigma}$
\end_inset

 and 
\begin_inset Formula $J^{s}=\det\mathbf{F}^{s}$
\end_inset

 ,
\begin_inset Formula 
\begin{equation}
J^{s}=J^{\sigma}J^{\sigma s}\,,\label{eq:general-jacobian-relation}
\end{equation}

\end_inset

where 
\begin_inset Formula $J^{\sigma s}=\det\mathbf{F}^{\sigma s}$
\end_inset

.
\end_layout

\begin_layout Subsection
Mixture Composition
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mixture-Composition"

\end_inset


\end_layout

\begin_layout Standard
Each constituent 
\begin_inset Formula $\sigma$
\end_inset

 has an 
\shape italic
apparent mass density
\shape default
 
\begin_inset Formula $\rho^{\sigma}$
\end_inset

 which may evolve due to deformation, or due to reactive processes which
 alter the mixture composition.
 Following 
\begin_inset CommandInset citation
LatexCommand citep
key "Bowen69,Ateshian07"
literal "false"

\end_inset

, we define the 
\shape italic
referential apparent mass density
\shape default
 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 of each constituent as
\begin_inset Formula 
\begin{equation}
\rho_{r}^{\sigma}=J^{s}\rho^{\sigma}\,.\label{eq:general-referential-mass-density}
\end{equation}

\end_inset

Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-referential-mass-density"
plural "false"
caps "false"
noprefix "false"

\end_inset

 expresses the mass of constituent 
\begin_inset Formula $\sigma$
\end_inset

 per referential volume of the master constituent 
\begin_inset Formula $s$
\end_inset

; thus 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 may only evolve if the mass content changes via reactions, making it a
 suitable state variable for tracking composition in a reactive framework.
 The axiom of mass balance for each constituent 
\begin_inset Formula $\sigma$
\end_inset

 may be written as
\begin_inset Formula 
\begin{equation}
\dot{\rho}_{r}^{\sigma}=\hat{\rho}_{r}^{\sigma}\,,\label{eq:mass-balance-alpha-1}
\end{equation}

\end_inset

where the dot operator represents the material time derivative and 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 is the 
\shape italic
referential mass supply density
\shape default
 for constituent 
\begin_inset Formula $\sigma$
\end_inset

, representing the rate at which mass (per referential volume) is added
 to 
\begin_inset Formula $\sigma$
\end_inset

 due to reactions with all other mixture constituents 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10,Nims17"
literal "false"

\end_inset

.
 A constitutive relation must be provided for 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 for various types of reactions.
 The mixture referential mass density 
\begin_inset Formula $\rho_{r}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\rho_{r}=\sum_{\sigma}\rho_{r}^{\sigma}\,.\label{eq:general-mass-balance}
\end{equation}

\end_inset

This summation is carried out over all constituents.
 When a constrained mixture of solid constituents represents a closed system,
 
\begin_inset Formula $\rho_{r}$
\end_inset

 remains constant over time.
 Taking the material time derivative of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mass-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-alpha-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows that the referential mass density supplies must satisfy
\begin_inset Formula 
\begin{equation}
\sum_{\sigma}\hat{\rho}_{r}^{\sigma}=0\,.\label{eq:mass-balance-constraint}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Mixture Free Energy and Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mixture-Free-Energy"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
referential free energy density
\shape default
 of the mixture is obtained as
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\rho_{r}\psi=\sum_{\sigma}\rho_{r}^{\sigma}\psi^{\sigma}\,,\label{eq:general-free-energy}
\end{equation}

\end_inset

where 
\begin_inset Formula $\psi^{\sigma}$
\end_inset

 is the 
\shape italic
specific free energy
\shape default
 of constituent 
\begin_inset Formula $\sigma$
\end_inset

 and 
\begin_inset Formula $\psi$
\end_inset

 is the specific free energy of the mixture.
 An important function of state which arises later in our treatment is the
 
\shape italic
chemical potential
\shape default
 of constituent 
\begin_inset Formula $\sigma$
\end_inset

, given by
\begin_inset Formula 
\begin{equation}
\mu^{\sigma}=\frac{\partial\Psi_{r}}{\partial\rho_{r}^{\sigma}}\,.\label{eq:general-chemical-potential}
\end{equation}

\end_inset

The mixture Cauchy stress is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{J^{s}}\frac{\partial\Psi_{r}}{\partial\mathbf{F}^{s}}\cdot\left(\mathbf{F}^{s}\right)^{T}=\frac{2}{J^{s}}\mathbf{F}^{s}\cdot\frac{\partial\Psi_{r}}{\partial\mathbf{C}^{s}}\cdot\left(\mathbf{F}^{s}\right)^{T}\,,\label{eq:general-mixture-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{C}^{s}=\mathbf{F}^{s}\cdot\left(\mathbf{F}^{s}\right)^{T}$
\end_inset

 is the right Cauchy-Green tensor.
 The spatial elasticity tensor may be evaluated from
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{4}{J^{s}}\left(\mathbf{F}^{s}\oslash\mathbf{F}^{s}\right):\frac{\partial^{2}\Psi_{r}}{\partial\mathbf{C}^{s}\partial\mathbf{C}^{s}}:\left(\left(\mathbf{F}^{s}\right)^{T}\oslash\left(\mathbf{F}^{s}\right)^{T}\right)\,.\label{eq:general-mixture-elasticity}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In reactive frameworks where 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 evolves according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-alpha-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it may be convenient to define the mass fraction
\begin_inset Formula 
\begin{equation}
w^{\sigma}=\frac{\rho_{r}^{\sigma}}{\rho_{r}}\,,\label{eq:mass-fraction}
\end{equation}

\end_inset

in which case we may rewrite eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-free-energy"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as 
\begin_inset Formula $\Psi_{r}=\sum_{\sigma}w^{\sigma}\Psi_{r}^{\sigma}$
\end_inset

 where 
\begin_inset Formula $\Psi_{r}^{\sigma}\equiv\rho_{r}\psi^{\sigma}$
\end_inset

 is the referential strain energy density of solid 
\begin_inset Formula $\sigma$
\end_inset

 under the assumption that it is the sole mixture constituent, normalized
 by the referential volume of the master constituent 
\begin_inset Formula $s$
\end_inset

.
 Based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mass-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 the mass fractions satisfy 
\begin_inset Formula $\sum_{\sigma}w^{\sigma}=1$
\end_inset

.
 In this case, when 
\begin_inset Formula $\mathbf{X}^{\sigma}\ne\mathbf{X}^{s}$
\end_inset

 and 
\begin_inset Formula $\psi^{\sigma}$
\end_inset

 is most conveniently expressed as a function of 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

, we may use eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to evaluate 
\begin_inset Formula $\partial\mathbf{F}^{s}/\partial\mathbf{F}^{\sigma}=\mathbf{I}\oslash\left(\mathbf{F}^{\sigma s}\right)^{-T}$
\end_inset

 and calculate the mixture stress using the alternative form
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{J^{s}}\sum_{\sigma}w^{\sigma}\frac{\partial\Psi_{r}^{\sigma}}{\partial\mathbf{F}^{\sigma}}\cdot\left(\mathbf{F}^{\sigma}\right)^{T}\,.\label{eq:general-mixture-stress-redux}
\end{equation}

\end_inset

This expression shows that the mixture stress may evolve not only due to
 temporal changes in the state of strain but also due to reactive changes
 in the mass fractions 
\begin_inset Formula $w^{\sigma}$
\end_inset

.
\end_layout

\begin_layout Standard
In FEBio the referential strain energy density for any solid mixture constituent
 
\begin_inset Formula $\sigma$
\end_inset

 is evaluated from the same library of constitutive models used in single-consti
tuent solids.
 In this library the calculation of the referential strain energy density
 is based on the assumption that the reference configuration corresponds
 to the configuration when the deformation gradient passed to those functions
 is equal to the identity tensor.
 Thus, passing 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

 to those functions returns the correct 
\begin_inset Formula $\Psi_{r}^{\sigma}$
\end_inset

.
 However, when passing 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 as an argument to those functions, the referential volume is based on the
 configuration 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

.
 Let the referential free energy density returned by FEBio for an argument
 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 be denoted by 
\begin_inset Formula $\Psi_{0}^{\sigma}$
\end_inset

.
 We may similarly denote the corresponding Cauchy stress and spatial elasticity
 tensors by 
\begin_inset Formula $\boldsymbol{\sigma}_{0}^{\sigma}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}_{0}^{\sigma}$
\end_inset

.
 Here, the subscript 
\begin_inset Formula $0$
\end_inset

 has two meanings: First it emphasizes that the corresponding function is
 evaluated using 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 for the mixture constituent 
\begin_inset Formula $\sigma$
\end_inset

; second it emphasizes that the calculation returns the corresponding measure
 under the assumption that the mixture consists entirely of that constituent,
 so that its multiplication by the scale factor 
\begin_inset Formula $w^{\sigma}$
\end_inset

 returns the actual contribution of that measure to the entire mixture.
 Based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-jacobian-relation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we find that 
\begin_inset Formula $\Psi_{r}^{\sigma}=J^{\sigma s}\Psi_{0}^{\sigma}$
\end_inset

 so that the mixture free energy density may be evaluated from
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\sum_{\sigma}w^{\sigma}J^{\sigma s}\Psi_{0}^{\sigma}\left(\mathbf{F}^{\sigma}\right)\,,\label{eq:febio-mixture-sed}
\end{equation}

\end_inset

whereas the mixture Cauchy stress and spatial elasticity are given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum_{\sigma}w^{\sigma}\boldsymbol{\sigma}_{0}^{\sigma}\,,\quad\boldsymbol{\mathcal{C}}=\sum_{\sigma}w^{\sigma}\boldsymbol{\mathcal{C}}_{0}^{\sigma}\,,\label{eq:febio-mixture-stress}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{0}^{\sigma}=\frac{1}{J^{\sigma}}\frac{\partial\Psi_{0}^{\sigma}}{\partial\mathbf{F}^{\sigma}}\cdot\left(\mathbf{F}^{\sigma}\right)^{T}=\frac{1}{J^{s}}\frac{\partial\Psi_{r}^{\sigma}}{\partial\mathbf{F}^{\sigma}}\cdot\left(\mathbf{F}^{\sigma}\right)^{T}\label{eq:febio-stress-function}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}_{0}^{\sigma}=\frac{4}{J^{\sigma}}\left(\mathbf{F}^{\sigma}\oslash\mathbf{F}^{\sigma}\right):\frac{\partial^{2}\Psi_{0}^{\sigma}}{\partial\mathbf{C}^{\sigma}\partial\mathbf{C}^{\sigma}}:\left(\left(\mathbf{F}^{\sigma}\right)^{T}\oslash\left(\mathbf{F}^{\sigma}\right)^{T}\right)\,.\label{eq:febio-elasticity-function}
\end{equation}

\end_inset

These relations show that the Cauchy stress and spatial elasticity tensor
 of constituent 
\begin_inset Formula $\sigma$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be evaluated using existing FEBio functions without needing to adjust
 for the choice of reference configuration 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

 or 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

, as evidenced by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-stress-function"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the case of the stress.
 However the referential strain energy density needs to be properly scaled
 by 
\begin_inset Formula $J^{\sigma s}$
\end_inset

 as shown in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-mixture-sed"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The calculation of the 2nd Piola-Kirchhoff stress 
\begin_inset Formula $\mathbf{S}$
\end_inset

 for each generation 
\begin_inset Formula $\sigma$
\end_inset

 is more elaborate.
 When using the master reference configuration 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

, this stress is given by
\begin_inset Formula 
\[
\mathbf{S}^{\sigma}\left(\mathbf{F}^{s}\right)=2\frac{\partial\Psi_{r}^{\sigma}\left(\mathbf{F}^{s}\right)}{\partial\mathbf{C}^{s}}\,.
\]

\end_inset

When using the reference configuration 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

, the stress is evaluated from a similar relation
\begin_inset Formula 
\[
\mathbf{S}_{0}^{\sigma}\left(\mathbf{F}^{\sigma}\right)=2\frac{\partial\Psi_{0}^{\sigma}\left(\mathbf{F}^{\sigma}\right)}{\partial\mathbf{C}^{\sigma}}\,.
\]

\end_inset

It can be shown that these stresses are related according to
\begin_inset Formula 
\[
\mathbf{S}^{\sigma}\left(\mathbf{F}^{s}\right)=J^{\sigma s}\left(\mathbf{F}^{\sigma s}\right)^{-1}\cdot\mathbf{S}_{0}^{\sigma}\left(\mathbf{F}^{\sigma}\right)\cdot\left(\mathbf{F}^{\sigma s}\right)^{-T}\,.
\]

\end_inset

FEBio does not use this calculation for solid mixtures, as all internal
 calculations employ the Cauchy stress.
\end_layout

\begin_layout Subsection
Frame Indifference
\begin_inset CommandInset label
LatexCommand label
name "subsec:Frame-Indifference"

\end_inset


\end_layout

\begin_layout Standard
To maintain frame indifference for constrained mixtures we must satisfy
 
\begin_inset Formula $\boldsymbol{\sigma}\left(\mathbf{Q}\cdot\mathbf{F}^{s}\right)=\mathbf{Q}\cdot\boldsymbol{\sigma}\left(\mathbf{F}^{s}\right)\cdot\mathbf{Q}^{T}$
\end_inset

, where 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is an orthogonal transformation that maintains the symmetry group of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian22a"
literal "false"

\end_inset

.
 Here, we abbreviated the list of state variables for 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 to just 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

, for notational simplicity.
 This frame indifference is automatically satisfied for 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 based on the hyperelasticity relation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and the invariance of 
\begin_inset Formula $\psi$
\end_inset

 to 
\begin_inset Formula $\mathbf{Q}$
\end_inset

.
 By the same argument, 
\begin_inset Formula $\boldsymbol{\sigma}_{0}^{\sigma}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-stress-function"
plural "false"
caps "false"
noprefix "false"

\end_inset

 satisfies 
\begin_inset Formula $\boldsymbol{\sigma}_{0}^{\sigma}\left(\mathbf{Q}\cdot\mathbf{F}^{\sigma}\right)=\mathbf{Q}\cdot\boldsymbol{\sigma}_{0}^{\sigma}\left(\mathbf{F}^{\sigma}\right)\cdot\mathbf{Q}^{T}$
\end_inset

 for transformations that maintain the symmetry group of 
\begin_inset Formula $\psi^{\sigma}$
\end_inset

.
 Since the symmetry transformations 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 of 
\begin_inset Formula $\psi$
\end_inset

 must also belong to the symmetry groups of all 
\begin_inset Formula $\psi^{\sigma}$
\end_inset

, we need to ensure that 
\begin_inset Formula $\mathbf{F}^{s*}=\mathbf{Q}\cdot\mathbf{F}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}^{\sigma*}=\mathbf{Q}\cdot\mathbf{F}^{\sigma}$
\end_inset

 also satisfy the kinematic constraint of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for those transformations 
\begin_inset Formula $\mathbf{Q}$
\end_inset

, namely 
\begin_inset Formula $\mathbf{F}^{s*}=\mathbf{F}^{\sigma*}\cdot\mathbf{F}^{\sigma s}$
\end_inset

.
 This can be achieved if and only if 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 is invariant under a change of frame.
 It follows from this argument that the right Cauchy-Green tensors are invariant
, 
\begin_inset Formula $\mathbf{C}^{s*}=\left(\mathbf{F}^{s*}\right)^{T}\cdot\mathbf{F}^{s*}=\left(\mathbf{F}^{s}\right)^{T}\cdot\mathbf{F}^{s}=\mathbf{C}^{s}$
\end_inset

 and similarly 
\begin_inset Formula $\mathbf{C}^{\sigma*}=\mathbf{C}^{\sigma}$
\end_inset

, while also satisfying 
\begin_inset Formula $\mathbf{C}^{s*}=\mathbf{C}^{s}=\left(\mathbf{F}^{\sigma s}\right)^{T}\cdot\mathbf{C}^{\sigma}\cdot\mathbf{F}^{\sigma s}$
\end_inset

.
 Right stretch tensors 
\begin_inset Formula $\mathbf{U}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}^{\sigma}$
\end_inset

 are also invariant.
\end_layout

\begin_layout Subsection
Simple Solid Mixtures
\begin_inset CommandInset label
LatexCommand label
name "subsec:Simple-Solid-Mixtures"

\end_inset


\end_layout

\begin_layout Standard
In the simplest type of non-reactive constrained mixtures of solids all
 constituents 
\begin_inset Formula $\sigma$
\end_inset

 share the same reference configuration 
\begin_inset Formula $\mathbf{X}^{\sigma}=\mathbf{X}^{s}$
\end_inset

, in which case 
\begin_inset Formula $\mathbf{F}^{\sigma}=\mathbf{F}^{s}$
\end_inset

 and 
\begin_inset Formula $J^{\sigma s}=1$
\end_inset

.
 For this type of mixture where 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 does not evolve, it is convenient to set 
\begin_inset Formula $w^{\sigma}=1$
\end_inset

 for all 
\begin_inset Formula $\sigma$
\end_inset

 and scale the material properties of 
\begin_inset Formula $\Psi_{r}^{\sigma}$
\end_inset

 to properly reflect the contribution of each constituent 
\begin_inset Formula $\sigma$
\end_inset

 to the mixture.
 Thus, the relation of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum_{\sigma}\boldsymbol{\sigma}_{0}^{\sigma}\,.\label{eq:simple-mixture-stress}
\end{equation}

\end_inset

This type of non-reactive mixture of solids is represented in FEBio using
 the material 
\begin_inset Quotes eld
\end_inset


\emph on
solid mixture
\emph default

\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
When each constituent of a solid mixture is modeled using an uncoupled formulati
on to enforce nearly isochoric responses, the strain energy density of this
 type of mixture is given by
\begin_inset Formula 
\begin{equation}
\Psi_{r}=U\left(J\right)+\sum\limits _{\sigma}\tilde{\Psi}_{r}^{\sigma}\left(\mathbf{\tilde{F}}^{s},\rho_{r}^{\sigma}\right)\,,\label{eq140}
\end{equation}

\end_inset

where 
\begin_inset Formula $U\left(J\right)$
\end_inset

 is the volumetric energy component, 
\begin_inset Formula $\tilde{\Psi}_{r}=\sum\nolimits _{\sigma}\tilde{\Psi}_{r}^{\sigma}$
\end_inset

 is the distortional energy component, and 
\begin_inset Formula $\mathbf{\tilde{F}}^{s}$
\end_inset

 is the distortional part of the deformation gradient, as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Nearly-Incompressible-Hyperelast"

\end_inset

.
 This type of non-reactive mixture of uncoupled solids is represented in
 FEBio using the material 
\begin_inset Quotes eld
\end_inset


\emph on
uncoupled solid mixture
\emph default

\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Subsection
Multigenerational Interstitial Growth
\begin_inset CommandInset label
LatexCommand label
name "subsec:Multigen-Interstitial-Growth"

\end_inset


\end_layout

\begin_layout Standard
Multigenerational interstitial growth mechanics may be modeled using a reactive
 mixture of constrained solids as described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10a"
literal "false"

\end_inset

.
 In this framework it is assumed that a porous solid matrix may gain mass
 via interstitial growth, such that the porosity of the solid decreases
 with increasing solid mass content.
 The history of growth is discretized temporally into generations 
\begin_inset Formula $\sigma$
\end_inset

 such that the mass added in the time interval 
\begin_inset Formula $t^{\sigma}\le t<t^{\sigma+1}$
\end_inset

 has a reference configuration 
\begin_inset Formula $\mathbf{X}^{\sigma}$
\end_inset

.
 This model assumes that each generation 
\begin_inset Formula $\sigma$
\end_inset

 gets deposited into the existing mixture in a stress-free state.
 This can be achieved by adopting the constitutive assumption that 
\begin_inset Formula $\mathbf{X}^{\sigma}=\boldsymbol{\chi}^{s}\left(\mathbf{X}^{s},t^{\sigma}\right)$
\end_inset

.
 In other words, the reference configuration of generation 
\begin_inset Formula $\sigma$
\end_inset

 is the current configuration of the solid mixture at time 
\begin_inset Formula $t^{\sigma}$
\end_inset

.
 An alternative form of this constitutive model, which satisfies frame-indiffere
nce, is that 
\begin_inset Formula $\mathbf{F}^{\sigma}\left(\mathbf{X}^{s},t^{\sigma}\right)=\mathbf{R}^{s}\left(\mathbf{X}^{s},t^{\sigma}\right)$
\end_inset

 at the time the new generation 
\begin_inset Formula $\sigma$
\end_inset

 is being deposited, where 
\begin_inset Formula $\mathbf{R}^{s}$
\end_inset

 is the rotation tensor in the polar decomposition of 
\begin_inset Formula $\mathbf{F}^{s}=\mathbf{R}^{s}\cdot\mathbf{U}^{s}$
\end_inset

.
 Equivalently, 
\begin_inset Formula $\mathbf{F}^{\sigma s}\left(\mathbf{X}^{s}\right)=\mathbf{U}^{s}\left(\mathbf{X}^{s},t^{\sigma}\right)$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Since 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 is a right-stretch tensor, it satisfies frame indifference.
\end_layout

\begin_layout Standard
The underlying assumption of multigenerational growth is that 
\begin_inset Formula $\mathbf{U}^{s}\left(\mathbf{X}^{s},t^{\sigma}\right)$
\end_inset

 evolves for each generation 
\begin_inset Formula $\sigma$
\end_inset

 either due to load-induced deformations or deformations produced by swelling
 processes, such as cell growth or Donnan swelling.
\end_layout

\begin_layout Standard
This type of multigenerational growth material is implemented in FEBio as
 
\begin_inset Quotes eld
\end_inset


\emph on
multigeneration
\emph default

\begin_inset Quotes erd
\end_inset

 for mixtures of elastic solids, and as 
\begin_inset Quotes eld
\end_inset


\emph on
multiphasic-multigeneration
\emph default

\begin_inset Quotes erd
\end_inset

 for reactive multiphasic mixtures whose solid constituent is a multigenerationa
l growth material.
 In this type of material the user needs to prescribe the generation birth
 times 
\begin_inset Formula $t^{\sigma}$
\end_inset

 and the properties of the material of each generation 
\begin_inset Formula $\sigma$
\end_inset

.
 The code automatically prescribes 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 based on the constitutive model given above, for each generation 
\begin_inset Formula $\sigma$
\end_inset

.
 For example, one may use a material model whose response depends on the
 evolving composition 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 of that generation.
 The composition 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 may evolve either due to chemical reactions modeled in a multiphasic framework,
 or by associating a user-defined load curve with 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

.
 Thus, the material properties (and the stress response) of generation 
\begin_inset Formula $\sigma$
\end_inset

 need not remain constant over the generation time interval 
\begin_inset Formula $t^{\sigma}\le t<t^{\sigma+1}$
\end_inset

, even though 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 remains constant during that generation.
 
\end_layout

\begin_layout Standard
When the growth process is negative (
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}<0$
\end_inset

), it implies that the solid constituent 
\begin_inset Formula $\sigma$
\end_inset

 is losing mass (solid resorption); this loss of mass terminates when 
\begin_inset Formula $\rho_{r}^{\sigma}=0$
\end_inset

.
 A material model that depends on 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 may exhibit evolving material properties during this resorption process
 until that generation produces zero stress when 
\begin_inset Formula $\rho_{r}^{\sigma}=0$
\end_inset

.
\end_layout

\begin_layout Standard
As a result of these evolving growth processes, this multigeneration mixture
 may exhibit residual stresses.
\end_layout

\begin_layout Subsection
Prescribed Pre-Stretch
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Deposition-Stretch"

\end_inset


\end_layout

\begin_layout Standard
An alternative approach to multigenerational growth is to prescribe 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 as a user-defined function.
 For isotropic stretching we may define
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{\sigma s}=\lambda^{\sigma s}\mathbf{I}\,,\label{eq:prescribed-defgrad-isotropic}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda^{\sigma s}>0$
\end_inset

 is the stretch ratio.
 A value greater than unity causes swelling whereas a value less than unity
 causes contraction; 
\begin_inset Formula $\lambda^{\sigma s}=1$
\end_inset

 produces 
\begin_inset Formula $\mathbf{F}^{\sigma s}=\mathbf{I}$
\end_inset

, which recovers the simple solid mixture described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Simple-Solid-Mixtures"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In FEBio a load curve may be associated with 
\begin_inset Formula $\lambda^{\sigma s}$
\end_inset

 to ramp up the prescribed deposition stretch.
\end_layout

\begin_layout Standard
For orthotropic stretching we define mutually orthogonal symmetry planes
 with unit normals 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

 (
\begin_inset Formula $i=1,2,3$
\end_inset

 and 
\begin_inset Formula $\mathbf{a}_{i}\cdot\mathbf{a}_{j}=\delta_{ij}$
\end_inset

).
 Then,
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{\sigma s}=\sum_{i=1}^{3}\lambda_{i}^{\sigma s}\mathbf{a}_{i}\otimes\mathbf{a}_{i}\,,\label{eq:prescribed-defgrad-orthotropic}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{i}^{\sigma s}$
\end_inset

 is the stretch ratio for the prescribed stretch along 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

; in general, 
\begin_inset Formula $\lambda_{1}^{\sigma s}\ne\lambda_{2}^{\sigma s}\ne\lambda_{3}^{\sigma s}$
\end_inset

, though this model can be specialized to transversely isotropic stretch
 by setting two of these stretch ratios equal to each other.
\end_layout

\begin_layout Standard
At lower symmetries the constitutive model for 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 must necessarily combine stretch and rotation.
 For monoclinic materials, deformations may be prescribed along three unit
 vectors 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

 that satisfy 
\begin_inset Formula $\mathbf{a}_{1}\cdot\mathbf{a}_{2}=0$
\end_inset

, 
\begin_inset Formula $\mathbf{a}_{1}\cdot\mathbf{a}_{3}=0$
\end_inset

, and 
\begin_inset Formula $\mathbf{a}_{2}\cdot\mathbf{a}_{3}\ne0$
\end_inset

, such that 
\begin_inset Formula $\mathbf{a}_{1}$
\end_inset

 defines the single plane of symmetry.
 In this case,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{F}^{\sigma s} & =\lambda_{1}^{\sigma s}\mathbf{a}_{1}\otimes\mathbf{a}_{1}+\frac{\lambda_{2}^{\sigma s}}{1-\alpha_{23}^{2}}\mathbf{a}_{2}\otimes\left(\mathbf{a}_{2}-\alpha_{23}\mathbf{a}_{3}\right)\\
 & +\frac{\lambda_{3}^{\sigma s}}{1-\alpha_{23}^{2}}\mathbf{a}_{3}\otimes\left(\mathbf{a}_{3}-\alpha_{23}\mathbf{a}_{2}\right)
\end{aligned}
\,,\label{eq:prescribed-defgrad-monoclinic}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{i}^{\sigma s}$
\end_inset

 is the stretch along 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

 and 
\begin_inset Formula $\alpha_{23}=\mathbf{a}_{2}\cdot\mathbf{a}_{3}$
\end_inset

.
 Under general conditions (i.e., when 
\begin_inset Formula $\lambda_{1}^{\sigma s}\ne\lambda_{2}^{\sigma s}\ne\lambda_{3}^{\sigma s}$
\end_inset

 and 
\begin_inset Formula $\alpha_{23}\ne0$
\end_inset

), the polar decomposition theorem shows that this deformation gradient
 is not a pure stretch, as it also involves a rotation.
\end_layout

\begin_layout Standard
The deformation gradient for expansion of a triclinic material may be similarly
 constructed by finding 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{F}^{\sigma s}\cdot\mathbf{a}_{i}=\lambda_{i}^{\sigma s}\mathbf{a}_{i}$
\end_inset

 (no sum) for non-orthogonal and non-collinear unit vectors 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{F}^{\sigma s} & =\frac{\lambda_{1}^{\sigma s}}{d}\mathbf{a}_{1}\otimes\left(\left(1-\alpha_{23}^{2}\right)\mathbf{a}_{1}-\left(\alpha_{12}-\alpha_{13}\alpha_{23}\right)\mathbf{a}_{2}-\left(\alpha_{13}-\alpha_{12}\alpha_{23}\right)\mathbf{a}_{3}\right)\\
 & +\frac{\lambda_{2}^{\sigma s}}{d}\mathbf{a}_{2}\otimes\left(-\left(\alpha_{12}-\alpha_{13}\alpha_{23}\right)\mathbf{a}_{1}+\left(1-\alpha_{13}^{2}\right)\mathbf{a}_{2}-\left(\alpha_{23}-\alpha_{12}\alpha_{13}\right)\mathbf{a}_{3}\right)\\
 & +\frac{\lambda_{3}^{\sigma s}}{d}\mathbf{a}_{3}\otimes\left(-\left(\alpha_{13}-\alpha_{12}\alpha_{23}\right)\mathbf{a}_{1}-\left(\alpha_{23}-\alpha_{12}\alpha_{13}\right)\mathbf{a}_{2}+\left(1-\alpha_{12}^{2}\right)\mathbf{a}_{3}\right)
\end{aligned}
\label{eq:prescribed-defgrad-triclinic}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
d=1-\alpha_{12}^{2}-\alpha_{13}^{2}-\alpha_{23}^{2}+2\alpha_{23}\alpha_{13}\alpha_{12}\label{eq:triclinic-defgrad-denominator}
\end{equation}

\end_inset

and 
\begin_inset Formula $\alpha_{ij}=\mathbf{a}_{i}\cdot\mathbf{a}_{j}$
\end_inset

 is the cosine of the angle between 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

 and 
\begin_inset Formula $\mathbf{a}_{j}$
\end_inset

.
 All of these constitutive models for 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 satisy frame indifference since they depend on material vectors 
\begin_inset Formula $\mathbf{a}_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
This type of elastic solid with prescribed pre-stretch is modeled in FEBio
 using the materials 
\begin_inset Quotes eld
\end_inset


\emph on
prestretch elastic
\emph default

\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset


\emph on
prestretch uncoupled elastic
\emph default

\begin_inset Quotes erd
\end_inset

.
 In the uncoupled version each solid constituent in the mixture has a deformatio
n gradient 
\begin_inset Formula $\mathbf{F}^{\sigma}$
\end_inset

 which produces nearly isochoric responses (
\begin_inset Formula $J^{\sigma}=1$
\end_inset

), whereas no constraint is placed on the volumetric strain of the pre-stretch
 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "sec:Equilibrium-swelling"

\end_inset


\end_layout

\begin_layout Standard
When the interstitial fluid of a porous medium contains one or more solutes,
 an osmotic pressure may be produced in the fluid if the osmolarity of the
 interstitial fluid is non-uniform, or if it is different from that of the
 external bathing solution surrounding the porous medium.
 In general, since the osmolarity of the interstitial fluid may vary over
 time in transient problems, the analysis of such swelling effects may be
 addressed using, for example, the biphasic-solute material model described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

.
 However, if we are only interested in the steady-state response for such
 types of materials, when solvent and solute fluxes have subsided, the analysis
 may be simplified considerably.
\end_layout

\begin_layout Standard
The Cauchy stress tensor for a mixture of a porous solid and interstitial
 fluid is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}\,,\label{eq141}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is he fluid pressure and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress in the solid matrix resulting from solid strain.
 When steady-state conditions are achieved, the fluid pressure 
\begin_inset Formula $p$
\end_inset

 results exclusively from osmotic effects and ambient conditions (i.e., it
 does not depend on the loading history).
 Thus, in analogy to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq118"

\end_inset

, 
\begin_inset Formula $p=\tilde{p}+R\theta\Phi c$
\end_inset

 where 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the mechanical pressure resulting from ambient conditions and 
\begin_inset Formula $R\theta\Phi c$
\end_inset

 is the osmotic pressure resulting from the osmolarity 
\begin_inset Formula $c$
\end_inset

 of the solution.
\end_layout

\begin_layout Standard
The osmotic pressure 
\begin_inset Formula $p$
\end_inset

 may produce swelling of the solid matrix, which is opposed by the solid
 matrix stress.
 This becomes more apparent when considering, for example, the case of a
 traction-free body.
 The traction is given by 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit outward normal to the boundary.
 When 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

, the relation of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq141"

\end_inset

 produces 
\begin_inset Formula $p=\mathbf{n}\cdot\boldsymbol{\sigma}^{e}\cdot\mathbf{n}$
\end_inset

, clearly showing that the osmotic pressure 
\begin_inset Formula $p$
\end_inset

 is balanced by the swelling solid matrix.
\end_layout

\begin_layout Standard
The interstitial osmolarity (number of moles of solute per volume of interstitia
l fluid) may be related to the solute and solid content according to 
\begin_inset Formula 
\begin{equation}
c=\frac{c_{r}}{J-\varphi_{r}^{s}}\,,\label{eq142}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{r}$
\end_inset

 is the number of moles of solute per volume of the mixture in the reference
 configuration, 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the volume fraction of the solid in the reference configuration, and
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the volume ratio of the porous solid matrix.
 Neither 
\begin_inset Formula $c_{r}$
\end_inset

 nor 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 depend on the solid matrix deformation, thus eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

 provides the explicit dependence of 
\begin_inset Formula $c$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

.
 This relation shows that the osmolarity of the interstitial fluid is dependent
 on the relative change in volume of the solid matrix with deformation.
 Effectively, under equilibrium swelling conditions, the term 
\begin_inset Formula $-p\mathbf{I}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq141"

\end_inset

 represents an elastic stress and may be treated in this manner when analyzing
 equilibrium swelling conditions.
\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $p$
\end_inset

 also depends on the osmotic coefficient, if we assume that 
\begin_inset Formula $\Phi$
\end_inset

 depends on the solid strain at most via a dependence on 
\begin_inset Formula $J$
\end_inset

, we may thus state generically that 
\begin_inset Formula $p=p\left(J\right)$
\end_inset

 under equilibrium swelling.
 It follows that the elasticity tensor for 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=-\left(p+J\frac{dp}{dJ}\right)\mathbf{I}\otimes\mathbf{I}+2p\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}+\boldsymbol{\mathcal{C}}^{e}\,,\label{eq143}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the elasticity tensor of 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

.
\end_layout

\begin_layout Subsection
Perfect Osmometer
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perfect-osmometer"

\end_inset


\end_layout

\begin_layout Standard
Consider a porous medium with an interstitial fluid that consists of a solvent
 and one or more solutes, whose boundary is permeable to the solvent but
 not to the solutes (e.g., a biological cell).
 Since solutes are trapped within such a medium, 
\begin_inset Formula $c_{r}$
\end_inset

 is a constant in this type of problem.
 Since the boundary is permeable to the solvent, 
\begin_inset Formula $\tilde{p}$
\end_inset

 must be continuous across the boundary.
 Assuming ideal physicochemical conditions, 
\begin_inset Formula $\Phi=1$
\end_inset

, and zero ambient pressure, this continuity requirement implies that 
\begin_inset Formula $p=R\theta\left(c-c^{\ast}\right)$
\end_inset

, where 
\begin_inset Formula $c^{\ast}$
\end_inset

is the osmolarity of the external environment.
 Using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

, it follows that 
\begin_inset Formula 
\begin{equation}
p=R\theta\left(\frac{c_{r}}{J-\varphi_{r}^{s}}-c^{\ast}\right)\,.\label{eq144}
\end{equation}

\end_inset

The reference configuration (the stress-free configuration of the solid)
 is achieved when 
\begin_inset Formula $J=1$
\end_inset

 and 
\begin_inset Formula $p=0$
\end_inset

, from which it follows that 
\begin_inset Formula $c_{r}=\left(1-\varphi_{r}^{s}\right)c_{0}^{\ast}$
\end_inset

, where 
\begin_inset Formula $c_{0}^{\ast}$
\end_inset

 is the value of 
\begin_inset Formula $c^{\ast}$
\end_inset

 in the reference state.
 Therefore eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq144"

\end_inset

 may also be written as 
\begin_inset Formula 
\begin{equation}
p=R\theta c^{\ast}\left(\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}\frac{c_{0}^{\ast}}{c^{\ast}}-1\right)\,,\label{eq145}
\end{equation}

\end_inset

and this expression may be substituted into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq143"

\end_inset

 to evaluate the corresponding elasticity tensor.
\end_layout

\begin_layout Standard
A perfect osmometer is a porous material whose interstitial fluid behaves
 ideally and whose solid matrix exhibits negligible resistance to swelling
 (
\begin_inset Formula $\boldsymbol{\sigma}^{e}\approx\mathbf{0})$
\end_inset

.
 In that case 
\begin_inset Formula $p=0$
\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq145"

\end_inset

 may be rearranged to yield 
\begin_inset Formula 
\begin{equation}
J=\left(1-\varphi_{r}^{s}\right)\frac{c_{0}^{\ast}}{c^{\ast}}+\varphi_{r}^{s}.\label{eq146}
\end{equation}

\end_inset

This equation is known as the Boyle-van't Hoff relation for a perfect osmometer.
 It predicts that variations in the relative volume of such as medium with
 changes in external osmolarity 
\begin_inset Formula $c^{\ast}$
\end_inset

 is an affine function of 
\begin_inset Formula $c_{0}^{\ast}/c^{\ast}$
\end_inset

, with the intercept at the origin representing the solid volume fraction
 and the slope representing the fluid volume fraction, in the reference
 configuration.
\end_layout

\begin_layout Standard
FEBio implements the relation of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq145"

\end_inset

 for the purpose of modeling equilibrium swelling even when solid matrix
 stresses are not negligible.
 The name 
\begin_inset Quotes eld
\end_inset

perfect osmometer
\begin_inset Quotes erd
\end_inset

 is adopted for this model because it reproduces the Boyle-van't Hoff response
 in the special case when 
\begin_inset Formula $\boldsymbol{\sigma}^{e}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Subsection
Cell Growth
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cell-Growth"

\end_inset


\end_layout

\begin_layout Standard
The growth of cells requires the active uptake of soluble mass to provide
 the building blocks for various intracellular structures, such as the cytoskele
ton or chromosomes, and growth contributes to the osmolarity of the intracellula
r space.
 The resulting mechano-chemical gradient drives solvent into the cell as
 well, contributing to its volumetric growth.
\end_layout

\begin_layout Standard
Cell growth may be modeled using the 
\begin_inset Quotes eld
\end_inset

perfect osmometer
\begin_inset Quotes erd
\end_inset

 framework by simply increasing the mass of the intracellular solid matrix
 and membrane-impermeant solute.
 This is achieved by using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq144"

\end_inset

 to model the osmotic pressure and allowing the parameters 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 (normally constant) to increase over time as a result of growth.
 Since cell growth is often accompanied by cell division, and since daughter
 cells typically achieve the same solid and solute content as their parent,
 it may be convenient to assume that 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 increase proportionally, though this is not an obligatory relationship.
 To ensure that the initial configuration is a stress-free reference configurati
on, let 
\begin_inset Formula $c_{r}=\left(1-\varphi_{r}^{s}\right)c^{\ast}$
\end_inset

 in the initial state prior to growth.
\end_layout

\begin_layout Subsection
Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Donnan-Equilibrium-Swelling"

\end_inset


\end_layout

\begin_layout Standard
Consider a porous medium whose solid matrix holds a fixed electrical charge
 and whose interstitial fluid consists of a solvent and two monovalent counter-i
ons (such as Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}})$
\end_inset

.
 The boundaries of the medium are permeable to the solvent and ions.
 The fixed charge density is denoted by 
\begin_inset Formula $c^{F}$
\end_inset

; it is a measure of the number of fixed charges per volume of the interstitial
 fluid in the current configuration.
 This charge density may be either negative or positive, thereby producing
 an imbalance in the concentration of anions and cations in the interstitial
 fluid.
 To determine the osmolarity of the interstitial fluid, it is necessary
 to equate the mechano-chemical potential of the solvent and the mechano-electro
chemical potential of the ions between the porous medium and its surrounding
 bath.
 When assuming ideal physicochemical behavior, the interstitial osmolarity
 (resulting from the interstitial ions) is given by 
\begin_inset Formula 
\begin{equation}
c=\sqrt{\left(c^{F}\right)^{2}+\left(2c^{\ast}\right)^{2}}\,,\label{eq147}
\end{equation}

\end_inset

where 
\begin_inset Formula $c^{\ast}$
\end_inset

 is the salt concentration in the bath.
 Alternatively, we note that the osmolarity of the bath is 
\begin_inset Formula $\bar{c}^{\ast}=2c^{\ast}$
\end_inset

.
 Though this expression may be equated with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

, the resulting value of 
\begin_inset Formula $c_{r}$
\end_inset

 is not constant in this case, since ions may transport into or out of the
 pore space; therefore that relation is not useful here.
\end_layout

\begin_layout Standard
However, since the number of charges fixed to the solid matrix is invariant,
 we may manipulate eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq142"

\end_inset

 to produce a relation between the fixed charge density in the current configura
tion, 
\begin_inset Formula $c^{F}$
\end_inset

, and the corresponding value in the reference configuration,
\begin_inset Formula $c_{r}^{F}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\,.\label{eq148}
\end{equation}

\end_inset

Now the osmotic pressure resulting from the difference in osmolarity between
 the porous medium and its surrounding bath is given by 
\begin_inset Formula 
\begin{equation}
p=R\theta\left(\sqrt{\left(\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right)\,.\label{eq149}
\end{equation}

\end_inset

This expression may be substituted into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq143"

\end_inset

 to evaluate the corresponding elasticity tensor.
\end_layout

\begin_layout Standard
When the osmotic pressure results from an imbalance in osmolarity produced
 by a fixed charge density, it is called a Donnan osmotic pressure.
 The analysis associated with this relation is called Donnan equilibrium.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "sec:Chemical-Reactions"

\end_inset


\end_layout

\begin_layout Standard
Chemical reactions may be incorportated into a multiphasic mixture by adding
 a mass supply term to the equation of mass balance, 
\begin_inset Formula 
\begin{equation}
\frac{\partial\rho^{\alpha}}{\partial t}+\divg\left(\rho^{\alpha}\mathbf{v}^{\alpha}\right)=\hat{\rho}^{\alpha}\,,\label{eq150}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\hat{\rho}^{\alpha}$
\end_inset

 is the volume density of mass supply to 
\begin_inset Formula $\alpha$
\end_inset

 resulting from chemical reactions with all other mixture constitutents.
 Since mass must be conserved over all constituents, mass supply terms are
 constrained by 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\hat{\rho}^{\alpha}=0\,.\label{eq151}
\end{equation}

\end_inset

In a mixture containing a solid constituent (denoted by 
\begin_inset Formula $\alpha=s$
\end_inset

 ), it is conveniemt to define the mixture domain (and thus the finite element
 mesh) on the solid and evaluate mass fluxes of constituents relative to
 the solid, 
\begin_inset Formula 
\begin{equation}
\mathbf{m}^{\alpha}=\rho^{\alpha}\left(\mathbf{v}^{\alpha}-\mathbf{v}^{s}\right)\,.\label{eq152}
\end{equation}

\end_inset

Substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq152"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq150"

\end_inset

, the differential form of the mass balance may be rewritten as 
\begin_inset Formula 
\begin{equation}
\frac{D^{s}\rho_{r}^{\alpha}}{Dt}+J\divg\mathbf{m}^{\alpha}=\hat{\rho}_{r}^{\alpha}\,,\label{eq153}
\end{equation}

\end_inset

Where 
\begin_inset Formula $D^{s}\left(\cdot\right)/Dt$
\end_inset

 represents the material time derivative in the spatial frame, following
 the solid, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid matrix; 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 is the apparent density and 
\begin_inset Formula $\hat{\rho}_{r}^{\alpha}$
\end_inset

 is the volume density of mass supply to 
\begin_inset Formula $\alpha$
\end_inset

 normalized to the mixture volume in the reference configuration, 
\begin_inset Formula 
\begin{equation}
\rho_{r}^{\alpha}=J\rho^{\alpha},\quad\hat{\rho}_{r}^{\alpha}=J\hat{\rho}^{\alpha}.\label{eq154}
\end{equation}

\end_inset

Since 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 is the mass of 
\begin_inset Formula $\alpha$
\end_inset

 in the current configuration per volume of the mixture in the reference
 configuration (an invariant quantity), this parameter represents a direct
 measure of the mass content of 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture, which may thus be used as a state variable in a framework
 that accounts for chemical reactions.
 A distinction is now made between solid and solute species in the mixture,
 since they are often treated differential in an analysis.
\end_layout

\begin_layout Subsection
Solid Matrix and Solid-Bound Molecular Constituents
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-Matrix-SBM"

\end_inset


\end_layout

\begin_layout Standard
For constituents constrained to move with the solid (denoted generically
 by 
\begin_inset Formula $\alpha=\sigma$
\end_inset

 and satisfying 
\begin_inset Formula $\mathbf{v}^{s}=\mathbf{v}^{\sigma}$
\end_inset

 , 
\begin_inset Formula $\forall\sigma)$
\end_inset

, the statement of mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

 reduces to the special form 
\begin_inset Formula 
\begin{equation}
D^{s}\rho_{r}^{\sigma}/Dt=\hat{\rho}_{r}^{\sigma}\,.\label{eq155}
\end{equation}

\end_inset

This representation makes it easy to see that alterations in 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 can occur only as a result of chemical reactions (such as synthesis, degradatio
n, or binding).
 In contrast, as seen in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

, alterations in 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 for solutes or solvent (
\begin_inset Formula $\alpha\ne\sigma)$
\end_inset

 may also occur as a result of mass transport into or out of the pore space
 of the solid matrix.
 Therefore, 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 is the natural choice of state variable for describing the content of solid
 constituents in a reactive mixture.
\end_layout

\begin_layout Standard
When multiple solid species are present, the net solid mass content may
 be given by 
\begin_inset Formula $\rho_{r}^{s}=\sum\limits _{\sigma}\rho_{r}^{\sigma}$
\end_inset

 whereas the net mass supply of solid is 
\begin_inset Formula $\hat{\rho}_{r}^{s}=\sum\limits _{\sigma}\hat{\rho}_{r}^{\sigma}$
\end_inset

 such that 
\begin_inset Formula $D^{s}\rho_{r}^{s}/Dt=\hat{\rho}_{r}^{s}$
\end_inset

.
 The referential solid volume fraction, 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

, may be evaluated from 
\begin_inset Formula 
\begin{equation}
\varphi_{r}^{s}=\varphi_{0}^{s}+\sum\limits _{\sigma}\rho_{r}^{\sigma}/\rho_{T}^{\sigma},\label{eq:referential-solid-volume-fraction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{T}^{\sigma}$
\end_inset

 is the true density of solid constituent 
\begin_inset Formula $\sigma$
\end_inset

 (mass of 
\begin_inset Formula $\sigma$
\end_inset

 per volume of 
\begin_inset Formula $\sigma$
\end_inset

) and 
\begin_inset Formula $\varphi_{0}^{s}$
\end_inset

 is the referential solid volume fraction of solid constituents not explicitly
 modeled by solid-bound molecules (a user-defined parameter).
 According to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq154"

\end_inset

, it follows that the solid volume fraction in the current configuration
 is given by 
\begin_inset Formula $\varphi^{s}=\varphi_{r}^{s}/J$
\end_inset

.
 Note that 
\begin_inset Formula $0\leqslant\varphi^{s}\leqslant1$
\end_inset

 under all circumstances, while 
\begin_inset Formula $0\leqslant\varphi_{r}^{s}\leqslant J$
\end_inset

, implying that 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 may exceed unity when solid growth occurs.
 In this study, it is assumed that all mixture constituents are intrinsically
 incompressible, implying that their true density is invariant.
\end_layout

\begin_layout Standard
At the start of an analysis, the formula of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:referential-solid-volume-fraction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 takes the form
\begin_inset Formula 
\begin{equation}
\varphi_{r}^{s}\left(0\right)=\varphi_{0}^{s}+\sum\limits _{\sigma}\rho_{r}^{\sigma}\left(0\right)/\rho_{T}^{\sigma}\label{eq:initial-referential-solid-fraction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}^{\sigma}\left(0\right)$
\end_inset

 represents the initial apparent mass densities of solid constituents.
 This initial value of 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 must satisfy 
\begin_inset Formula $0\le\varphi_{r}^{s}\left(0\right)\le1$
\end_inset

, since 
\begin_inset Formula $J=1$
\end_inset

 at the start of an analysis.
\end_layout

\begin_layout Standard
The various constituents of the porous solid matrix of a multiphasic mixture
 may be electrically charged.
 The charge density in the current configuration, normalized by the mixture
 volume in the current configuration, is given by 
\begin_inset Formula 
\begin{equation}
\check{c}^{F}=\frac{z^{F}dn^{F}+\sum_{\sigma}z^{\sigma}dn^{\sigma}}{dV}\,,\label{eq:FCD-mixture-volume}
\end{equation}

\end_inset

where 
\begin_inset Formula $z^{F}$
\end_inset

 is the charge number (equivalent charge per mole) and 
\begin_inset Formula $dn^{F}$
\end_inset

 is the elemental number of moles associated with fixed charges present
 in the initial volume fraction 
\begin_inset Formula $\varphi_{0}^{s}$
\end_inset

 of the solid matrix.
 Similarly, 
\begin_inset Formula $z^{\sigma}$
\end_inset

 is the charge number of evolving solid constituent 
\begin_inset Formula $\sigma$
\end_inset

.
 By convention however, the fixed charge density 
\begin_inset Formula $c^{F}$
\end_inset

 of a multiphasic material is normalized by the fluid volume of the mixture,
 thus it can be shown that
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{\check{c}^{F}}{1-\varphi^{s}}=\frac{1}{J-\varphi_{r}^{s}}\left(\frac{z^{F}dn^{F}}{dV_{r}}+\sum_{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\right)\,.\label{eq:FCD-fluid-volume}
\end{equation}

\end_inset

In particular, in the reference configuration this formula produces
\begin_inset Formula 
\begin{equation}
c^{F}\left(0\right)=\frac{1}{1-\varphi_{r}^{s}\left(0\right)}\left(\frac{z^{F}dn^{F}\left(0\right)}{dV_{r}}+\sum_{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}\left(0\right)}{M^{\sigma}}\right)\,.\label{eq:FCD-initial-time}
\end{equation}

\end_inset

We define the first term on the right-hand-side of this equation as the
 initial value of the user-specified fixed charge density 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 (which is not associated with solid species 
\begin_inset Formula $\sigma$
\end_inset

),
\begin_inset Formula 
\begin{equation}
c_{0}^{F}\equiv\frac{1}{1-\varphi_{r}^{s}\left(0\right)}\frac{z^{F}dn^{F}\left(0\right)}{dV_{r}}\,.\label{eq:user-specified-cF0}
\end{equation}

\end_inset

Therefore, in the current configuration, we may rewrite
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}\left(0\right)}{J-\varphi_{r}^{s}}c_{0}^{F}+\frac{1}{J-\varphi_{r}^{s}}\sum_{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\,.\label{eq158}
\end{equation}

\end_inset

where the user-specified 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 may optionally be associated with a load curve representing the scale factor
 
\begin_inset Formula $dn^{F}/dn^{F}\left(0\right)$
\end_inset

, in case the user would like to allow 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 to evolve.
 By analogy, we may now define the referential fixed-charge density 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 of the mixture as
\begin_inset Formula 
\begin{equation}
c_{r}^{F}\equiv\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}\left(0\right)}c^{F}=c_{0}^{F}+\frac{1}{1-\varphi_{r}^{s}\left(0\right)}\sum_{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\label{eq157}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 may evolve with time, but it represents the number of fixed equivalent
 charges in the current configuration, per fluid volume in the reference
 configuration.
 Hence we may also write
\begin_inset Formula 
\[
c^{F}=\frac{1-\varphi_{r}^{s}\left(0\right)}{J-\varphi_{r}^{s}}c_{r}^{F}\,.
\]

\end_inset


\end_layout

\begin_layout Standard
The molar concentration of a solid-bound molecular constituent, which may
 be needed in a reactive process involving solutes, is given by
\begin_inset Formula 
\begin{equation}
c^{\sigma}=\frac{1}{J-\varphi_{r}^{s}}\frac{\rho_{r}^{\sigma}}{M^{\sigma}}\,.\label{eq:sbm-molar-concentration}
\end{equation}

\end_inset

An alternative to using solid-bound molecules is to define solutes 
\begin_inset Formula $\sigma$
\end_inset

 whose diffusivity 
\begin_inset Formula $\mathbf{d}^{\sigma}$
\end_inset

 in the mixture is set to 
\begin_inset Formula $\mathbf{0}$
\end_inset

 (however, the free diffusivity 
\begin_inset Formula $d_{0}^{\sigma}$
\end_inset

 should not be set to zero, to prevent a division by zero; its exact value
 is not important, thus let 
\begin_inset Formula $d_{0}^{\sigma}=1$
\end_inset

).
 Then, FEBio treats these solutes as equivalent to solid-bound molecules:
 (1) Their concentration does not contribute to the osmolarity of the interstiti
al fluid; (2) their concentration contributes to the fixed charge density
 
\begin_inset Formula $c^{F}$
\end_inset

 in the current configuration; (3) these solutes do not contribute to the
 effective hydraulic permeability 
\begin_inset Formula $\tilde{\mathbf{k}}$
\end_inset

 of the porous multiphasic mixture; (4) these solutes can be involved in
 chemical reactions; (5) while their initial effective concentration may
 be prescribed, it must not contribute to the prescribed initial effective
 fluid pressure, and the user should not prescribe any boundary conditions
 on the effective concentration of these solutes.
 Using these 'solid-bound' solutes increases the number of degrees of freedom
 in an FEBio analysis; however, unlike solid-bound molecules, the solution
 for the effective concentration of these solutes remains as accurate as
 all other degrees of freedom in an analysis.
\end_layout

\begin_layout Standard
To evaluate the contribution of these solutes to the referential solid volume
 fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and to chemical reactions, we use eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:sbm-molar-concentration"
plural "false"
caps "false"
noprefix "false"

\end_inset

 above and substitute it into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:referential-solid-volume-fraction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce
\begin_inset Formula 
\[
\varphi_{r}^{s}=\varphi_{0}^{s}+\left(J-\varphi_{r}^{s}\right)\sum\limits _{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}
\]

\end_inset

which can be solved for 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 using the concentrations 
\begin_inset Formula $c^{\sigma}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\varphi_{r}^{s}=\frac{\varphi_{0}^{s}+J\sum\limits _{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}}{1+\sum\limits _{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}}\,.\label{eq:phirs-solutes-as-SBMs}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Solutes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solutes"

\end_inset


\end_layout

\begin_layout Standard
Solutes are denoted generically by 
\begin_inset Formula $\alpha=\iota$
\end_inset

.
 In chemistry solute content is often represented in units of molar concentratio
n (moles per fluid volume).
 It follows that solute molar concentration 
\begin_inset Formula $c^{\iota}$
\end_inset

 and molar supply 
\begin_inset Formula $\hat{c}^{\iota}$
\end_inset

 are related to 
\begin_inset Formula $\rho^{\iota}$
\end_inset

 and 
\begin_inset Formula $\hat{\rho}^{\iota}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
c^{\iota}=\frac{\rho^{\iota}}{\left(1-\varphi^{s}\right)M^{\iota}},\quad\hat{c}^{\iota}=\frac{\hat{\rho}^{\iota}}{\left(1-\varphi^{s}\right)M^{\iota}}\,.\label{eq159}
\end{equation}

\end_inset

The molar flux of constituent 
\begin_inset Formula $\iota$
\end_inset

 relative to the solid is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)c^{\iota}\left(\mathbf{v}^{\iota}-\mathbf{v}^{s}\right)\,,\label{eq160}
\end{equation}

\end_inset

where it may be noted that 
\begin_inset Formula $\mathbf{m}^{\iota}=M^{\iota}\mathbf{j}^{\iota}$
\end_inset

.
 Combining these relations with Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq153"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq154"

\end_inset

 produces the desired form of the mass balance for the solutes, 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\mbox{div}\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\hat{c}^{\iota}\,.\label{eq161}
\end{equation}

\end_inset

This form is suitable for implementation in a finite element analysis where
 the mesh is defined on the solid matrix.
\end_layout

\begin_layout Subsection
Mixture with Negligible Solute Volume Fraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Negligible-Solute-Fraction"

\end_inset


\end_layout

\begin_layout Standard
The volume fraction of each constituent is given by 
\begin_inset Formula $\varphi^{\alpha}=\rho^{\alpha}/\rho_{T}^{\alpha}$
\end_inset

.
 In a saturated mixture these volume fractions satisfy 
\begin_inset Formula $\sum\limits _{\alpha}\varphi^{\alpha}=1$
\end_inset

.
 Substituting 
\begin_inset Formula $\rho^{\alpha}=\varphi^{\alpha}\rho_{T}^{\alpha}$
\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq150"

\end_inset

, dividing across by 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 (invariant for intrinsically incompressible constituents), and taking the
 sum of the resulting expression over all constituents produces 
\begin_inset Formula 
\begin{equation}
\divg\left(\sum\limits _{\alpha}\varphi^{\alpha}\mathbf{v}^{\alpha}\right)=\sum\limits _{\alpha}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq162}
\end{equation}

\end_inset

This mass balance relation for the mixture expresses the fact that the mixture
 volume will change as a result of chemical reactions where the true density
 of products is different from that of reactants.
 Indeed, assuming that 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

 is the same for all 
\begin_inset Formula $\alpha$
\end_inset

 would nullify the right-hand-side of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq162"

\end_inset

 based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq151"

\end_inset

.
 We now adopt the assumption that solutes occupy a negligible volume fraction
 of the mixture (
\begin_inset Formula $\varphi^{\iota}\ll1)$
\end_inset

, from which it follows that 
\begin_inset Formula $\varphi^{s}+\varphi^{w}\approx1$
\end_inset

 and 
\begin_inset Formula $\sum\limits _{\alpha}\varphi^{\alpha}\mathbf{v}^{\alpha}\approx\mathbf{v}^{s}+\mathbf{w}$
\end_inset

, where 
\begin_inset Formula $\mathbf{w}=\varphi^{w}\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)$
\end_inset

 is the volumetrix flux of solvent relative to the solid.
 Thus, the mixture mass balance may be reduced to 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\sum\limits _{\alpha}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq163}
\end{equation}

\end_inset

In the special case of the solvent (
\begin_inset Formula $\alpha=w$
\end_inset

), FEBio uses a solvent supply, 
\begin_inset Formula $\hat{\varphi}^{w}=\hat{\rho}^{w}/\hat{\rho}_{T}^{w}$
\end_inset

, which may be incorporated in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq163"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}+\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.\label{eq163b}
\end{equation}

\end_inset

From the mass balance equation for the solvent we have
\begin_inset Formula 
\[
\begin{aligned}\hat{\varphi}^{w} & =\frac{D^{s}\varphi^{w}}{Dt}+\grad\varphi^{w}\cdot\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)+\varphi^{w}\divg\mathbf{v}^{w}\end{aligned}
\]

\end_inset

so that the mixture mass balance takes the form
\begin_inset Formula 
\[
\begin{aligned}\divg\left(\mathbf{v}^{s}+\mathbf{w}\right) & =\frac{D^{s}\varphi^{w}}{Dt}+\grad\varphi^{w}\cdot\left(\mathbf{v}^{w}-\mathbf{v}^{s}\right)+\varphi^{w}\divg\mathbf{v}^{w}+\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,\end{aligned}
\]

\end_inset

Using 
\begin_inset Formula $\varphi^{w}+\varphi^{s}=1$
\end_inset

 this relation further simplifies to
\begin_inset Formula 
\[
\varphi^{s}\divg\mathbf{v}^{s}+\frac{D^{s}\varphi^{s}}{Dt}=\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.
\]

\end_inset

Now we use the kinematic relation 
\begin_inset Formula $\divg\mathbf{v}^{s}=\frac{1}{J}\frac{D^{s}J}{Dt}$
\end_inset

 to reduce this equation further to
\begin_inset Formula 
\[
\frac{D^{s}\left(J\varphi^{s}\right)}{Dt}=J\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}\,.
\]

\end_inset

But recall that
\begin_inset Formula 
\[
J\varphi^{s}=\varphi_{r}^{s}
\]

\end_inset

thus the mixture mass balance now simplifies to
\begin_inset Formula 
\[
\frac{1}{J}\frac{D^{s}\varphi_{r}^{s}}{Dt}=\sum\limits _{\alpha\ne w}\frac{\hat{\rho}^{\alpha}}{\rho_{T}^{\alpha}}
\]

\end_inset

Since
\begin_inset Formula 
\[
\hat{\rho}^{\alpha}=\left(1-\varphi^{s}\right)M^{\alpha}\hat{c}^{\alpha}
\]

\end_inset

it follows that
\begin_inset Formula 
\[
\frac{D^{s}\varphi_{r}^{s}}{Dt}=J\left(1-\varphi^{s}\right)\sum\limits _{\alpha\ne w}\frac{M^{\alpha}\hat{c}^{\alpha}}{\rho_{T}^{\alpha}}
\]

\end_inset

Another way of presenting these results is to restate the mixture mass balance
 as
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}_{0}^{w}+\frac{1}{J}\frac{D^{s}\varphi_{r}^{s}}{Dt}\label{eq:mixture-mass-reactive}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\varphi}_{0}^{w}$
\end_inset

 is the solvent supply from user-specified sources (not from the chemical
 reactions).
\end_layout

\begin_layout Subsection
Chemical Kinetics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Chemical-Kinetics"

\end_inset


\end_layout

\begin_layout Standard
Productions rates are described by constitutive relations which are functions
 of the state variables.
 In a biological mixture under isothermal conditions, the minimum set of
 state variables needed to describe reactive mixtures that include a solid
 matrix are: the (uniform) temperature 
\begin_inset Formula $\theta$
\end_inset

, the solid matrix deformation gradient 
\begin_inset Formula $\mathbf{F}$
\end_inset

 (or related strain measures), and the molar content 
\begin_inset Formula $c^{\alpha}$
\end_inset

 of the various constituents.
 This set differs from the classical treatment of chemical kinetics in fluid
 mixtures by the inclusion of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and the subset of constituents bound to the solid matrix.
 To maintain a consistent notation in this section, solid-bound molecular
 species are described by their molar concentrations and molar supplies
 which may be related to their referential mass density and referential
 mass supply according to 
\begin_inset Formula 
\begin{equation}
c^{\sigma}=\frac{\rho_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}},\quad\hat{c}^{\sigma}=\frac{\hat{\rho}_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}}\,.\label{eq164}
\end{equation}

\end_inset

Consider a general chemical reaction, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\to\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha}\,,\label{eq165}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

 is the chemical species representing constituent 
\begin_inset Formula $\alpha$
\end_inset

; 
\begin_inset Formula $\nu_{R}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\nu_{P}^{\alpha}$
\end_inset

 represent stoichiometric coefficients of the reactants and products, respective
ly.
 Since the molar supply of reactants and products is constrained by stoichiometr
y, it follows that all molar supplies 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 in a specific chemical reaction may be related to a production rate 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\hat{c}^{\alpha}=\nu^{\alpha}\hat{\zeta}\,,\label{eq166}
\end{equation}

\end_inset

where 
\begin_inset Formula $\nu^{\alpha}$
\end_inset

 represents the net stoichiometric coefficient for 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\nu^{\alpha}=\nu_{P}^{\alpha}-\nu_{R}^{\alpha}\,.\label{eq167}
\end{equation}

\end_inset

Thus, formulating constitutive relations for 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 is equivalent to providing a single relation for 
\begin_inset Formula $\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)$
\end_inset

.
 When the chemical reaction is reversible, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\rightleftharpoons\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha}\,,\label{eq168}
\end{equation}

\end_inset

the relations of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq167"

\end_inset

 still apply but the form of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 would be different.
\end_layout

\begin_layout Standard
Using the relations of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq159"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq164"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

, it follows in general that 
\begin_inset Formula $\hat{\rho}^{\alpha}=\left(1-\varphi^{s}\right)M^{\alpha}\nu^{\alpha}\hat{\zeta}$
\end_inset

, so that the constraint of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq151"

\end_inset

 is equivalent to enforcing stoichiometry, namely, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{\alpha}\nu^{\alpha}M^{\alpha}=0\,.\label{eq169}
\end{equation}

\end_inset

Thus, properly balancing a chemical reaction satisfies this constraint.
\end_layout

\begin_layout Standard
The mixture mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq163b"

\end_inset

 may now be rewritten as 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}^{w}\right)=\hat{\varphi}_{0}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\,,\label{eq170}
\end{equation}

\end_inset

where 
\begin_inset Formula $\overline{\mathcal{V}}=\sum\limits _{\alpha\ne w}\nu^{\alpha}\mathcal{V}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\mathcal{V}^{\alpha}=M^{\alpha}/\rho_{T}^{\alpha}$
\end_inset

 is the molar volume of 
\begin_inset Formula $\alpha$
\end_inset

.
 (Currently in FEBio, 
\begin_inset Formula $\hat{\varphi}_{0}^{w}$
\end_inset

 is specified independently of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

, because users may choose to neglect the contribution from 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq170"

\end_inset

; therefore, if one desires to model chemical reactions, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq165"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq168"

\end_inset

, that involve the solvent, it is necessary to explicitly provide a solvent
 supply function compatible with the above relations, namely 
\begin_inset Formula $\hat{\varphi}_{0}^{w}=\left(1-\varphi^{s}\right)\hat{\zeta}\nu^{w}\mathcal{V}^{w}$
\end_inset

.) Similarly, the solute mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq161"

\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\divg\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\nu^{\iota}\hat{\zeta}\,.\label{eq:solute-mass-balance}
\end{equation}

\end_inset

These mass balance equations reduce to those of non-reactive mixtures when
 
\begin_inset Formula $\hat{\zeta}=0$
\end_inset

.
\end_layout

\begin_layout Section
Fluid Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Fluid-Mechanics"

\end_inset


\end_layout

\begin_layout Subsection
Mass and Momentum Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Mass-Momentum"

\end_inset


\end_layout

\begin_layout Standard
In a spatial (Eulerian) frame, the momentum balance equation for a continuum
 is
\begin_inset Formula 
\begin{equation}
\rho\mathbf{a}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,\label{eq:momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the density, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress, 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the body force per mass, and 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the acceleration, given by the material time derivative of the velocity
 
\begin_inset Formula $\mathbf{v}$
\end_inset

 in the spatial frame,
\begin_inset Formula 
\begin{equation}
\mathbf{a}=\dot{\mathbf{v}}=\frac{\partial\mathbf{v}}{\partial t}+\mathbf{L}\cdot\mathbf{v}\,,\label{eq:acceleration}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{L}=\grad\mathbf{v}$
\end_inset

 is the spatial velocity gradient.
 The mass balance equation is
\begin_inset Formula 
\begin{equation}
\dot{\rho}+\rho\divg\mathbf{v}=0\,,\label{eq:mass-balance}
\end{equation}

\end_inset

where the material time derivative of the density in the spatial frame is
\begin_inset Formula 
\begin{equation}
\dot{\rho}=\frac{\partial\rho}{\partial t}+\grad\rho\cdot\mathbf{v}\,.\label{eq:density-material-derivative}
\end{equation}

\end_inset

Let 
\begin_inset Formula $\mathbf{F}$
\end_inset

 denote the deformation gradient (the gradient of the motion with respect
 to the material coordinate).
 The material time derivative of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is related to 
\begin_inset Formula $\mathbf{L}$
\end_inset

 via
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{F}}=\mathbf{L}\cdot\mathbf{F}\,.\label{eq:F-dot}
\end{equation}

\end_inset

Let 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 denote the Jacobian of the motion (the volume ratio, or ratio of current
 to referential volume, 
\begin_inset Formula $J>0$
\end_inset

); then, the dilatation (relative change in volume between current and reference
 configurations) is given by 
\begin_inset Formula $e=J-1$
\end_inset

.
 Using the chain rule, 
\begin_inset Formula $J$
\end_inset

's material time derivative is 
\begin_inset Formula $\dot{J}=J\mathbf{F}^{-T}:\dot{\mathbf{F}}$
\end_inset

 which, when combined with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:F-dot"

\end_inset

, produces a kinematic constraint between 
\begin_inset Formula $\dot{J}$
\end_inset

 and 
\begin_inset Formula $\divg\mathbf{v}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\dot{J}=J\,\divg\mathbf{v}\,.\label{eq:divv-kinematic-relation}
\end{equation}

\end_inset

Substituting this relation into the mass balance, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance"

\end_inset

, produces 
\begin_inset Formula $\dot{\overline{\rho J}}=0$
\end_inset

, which may be integrated directly to yield
\begin_inset Formula 
\begin{equation}
\rho=\rho_{r}/J\,,\label{eq:mass-balance-integrated}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the density in the reference configuration (when 
\begin_inset Formula $J=1$
\end_inset

).
 Since 
\begin_inset Formula $\rho_{r}$
\end_inset

 is obtained by integrating the above material time derivative of 
\begin_inset Formula $\rho J$
\end_inset

, it is an intrinsic material property that must be invariant in time and
 space.
 
\end_layout

\begin_layout Standard
The Cauchy stress is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\tau}\,,\label{eq:stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the identity tensor, 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress, 
\begin_inset Formula $p$
\end_inset

 is the pressure arising from the elastic response,
\begin_inset Formula 
\begin{equation}
p=-\frac{d\Psi_{r}\left(J\right)}{dJ}\,,\label{eq:elastic-pressure}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is the free energy density of the fluid (free energy per volume of the
 continuum in the reference configuration).
 The axiom of entropy inequality dictates that 
\begin_inset Formula $\Psi_{r}$
\end_inset

 cannot be a function of the rate of deformation 
\begin_inset Formula $\mathbf{D}=\left(\mathbf{L}+\mathbf{L}^{T}\right)/2$
\end_inset

.
 In contrast, the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is generally a function of 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
\end_layout

\begin_layout Standard
Boundary conditions may be derived by satisfying mass and momentum balance
 across a moving interface 
\begin_inset Formula $\Gamma$
\end_inset

.
 Let 
\begin_inset Formula $\Gamma$
\end_inset

 divide the material domain 
\begin_inset Formula $V$
\end_inset

 into subdomains 
\begin_inset Formula $V_{+}$
\end_inset

 and 
\begin_inset Formula $V_{-}$
\end_inset

 and let the outward normal to 
\begin_inset Formula $V_{+}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 be denoted by 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 The jump condition across 
\begin_inset Formula $\Gamma$
\end_inset

 derived from the axiom of mass balance requires that
\begin_inset Formula 
\begin{equation}
\left[\left[\rho\mathbf{u}_{\Gamma}\right]\right]\cdot\mathbf{n}=0\,,\label{eq:mass-jump}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{u}_{\Gamma}\equiv\mathbf{v}-\mathbf{v}_{\Gamma}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}_{\Gamma}$
\end_inset

 is the velocity of the interface 
\begin_inset Formula $\Gamma$
\end_inset

.
 Thus, 
\begin_inset Formula $\mathbf{u}_{\Gamma}$
\end_inset

 represents the velocity of the fluid relative to 
\begin_inset Formula $\Gamma$
\end_inset

.
 The double bracket notation denotes 
\begin_inset Formula $\left[\left[f\right]\right]=f_{+}-f_{-}$
\end_inset

, where 
\begin_inset Formula $f_{+}$
\end_inset

 and 
\begin_inset Formula $f_{-}$
\end_inset

 represent the value of 
\begin_inset Formula $f$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 in 
\begin_inset Formula $V_{+}$
\end_inset

 and 
\begin_inset Formula $V_{-}$
\end_inset

, respectively.
 This jump condition implies that the mass flux normal to 
\begin_inset Formula $\Gamma$
\end_inset

 must be continuous.
 In particular, if 
\begin_inset Formula $V_{+}$
\end_inset

 is a fluid domain and 
\begin_inset Formula $V_{-}$
\end_inset

 is a solid domain, and 
\begin_inset Formula $\Gamma$
\end_inset

 denotes the solid boundary (e.g., a wall), we use 
\begin_inset Formula $\rho_{+}=\rho$
\end_inset

, 
\begin_inset Formula $\mathbf{v}_{+}=\mathbf{v}$
\end_inset

 for the fluid, and 
\begin_inset Formula $\mathbf{v}_{-}=\mathbf{v}_{\Gamma}$
\end_inset

 for the solid, such that eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-jump"

\end_inset

 reduces to 
\begin_inset Formula $\rho\left(\mathbf{v}-\mathbf{v}_{\Gamma}\right)\cdot\mathbf{n}=0$
\end_inset

.
 The jump condition derived from the axiom of linear momentum balance similarly
 requires that
\begin_inset Formula 
\begin{equation}
\left[\left[\boldsymbol{\sigma}-\rho\mathbf{u}_{\Gamma}\otimes\mathbf{u}_{\Gamma}\right]\right]\cdot\mathbf{n}=\mathbf{0}\,.\label{eq:momentum-jump}
\end{equation}

\end_inset

This condition implies that the jump in the traction 
\begin_inset Formula $\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 across 
\begin_inset Formula $\Gamma$
\end_inset

 must be balanced by the jump in momentum flux normal to 
\begin_inset Formula $\Gamma$
\end_inset

.
 In addition to jump conditions dictated by axioms of conservation, viscous
 fluids require the satisfaction of the no-slip condition,
\begin_inset Formula 
\begin{equation}
\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\left[\left[\mathbf{u}_{\Gamma}\right]\right]=\mathbf{0}\,,\label{eq:no-slip-condition}
\end{equation}

\end_inset

which implies that the velocity component tangential to 
\begin_inset Formula $\Gamma$
\end_inset

 is continuous across that interface.
\end_layout

\begin_layout Standard
In our finite element treatment we use 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 as nodal variables, implying that our formulation automatically enforces
 continuity of these variables across element boundaries, thus 
\begin_inset Formula $\left[\left[\mathbf{v}\right]\right]=\left[\left[\mathbf{u}_{\Gamma}\right]\right]=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $\left[\left[J\right]\right]=0$
\end_inset

.
 Based on Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-integrated"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

, it follows that the density and elastic pressure are continuous across
 element boundaries in this formulation, 
\begin_inset Formula $\left[\left[\rho\right]\right]=0$
\end_inset

 and 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

.
 Thus, the mass jump in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-jump"

\end_inset

 is automatically satisfied, and the momentum jump in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:momentum-jump"

\end_inset

 reduces to 
\begin_inset Formula $\left[\left[\boldsymbol{\sigma}\right]\right]\cdot\mathbf{n}=\mathbf{0}$
\end_inset

, requiring continuity of the traction, or more specifically according to
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress"

\end_inset

, the continuity of the viscous traction 
\begin_inset Formula $\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

, since 
\begin_inset Formula $p$
\end_inset

 is automatically continuous.
\end_layout

\begin_layout Subsection
Energy Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Energy-Balance"

\end_inset


\end_layout

\begin_layout Standard
The energy balance for a continuum may be written in integral form over
 a control volume 
\begin_inset Formula $V$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{d}{dt}\int_{V}\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\,dV & =-\int_{S}\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\mathbf{v}\cdot\mathbf{n}\right)\,dS+\int_{S}\mathbf{t}\cdot\mathbf{v}\,dS+\int_{V}\rho\mathbf{b}\cdot\mathbf{v}\,dV\\
 & -\int_{S}\mathbf{q}\cdot\mathbf{n}\,dS+\int_{V}\rho r\,dV
\end{aligned}
\,,\label{eq:energy-balance-integral}
\end{equation}

\end_inset

where 
\begin_inset Formula $S$
\end_inset

 is the control surface bounding 
\begin_inset Formula $V$
\end_inset

, 
\begin_inset Formula $\varepsilon$
\end_inset

 is the specific internal energy, 
\begin_inset Formula $\mathbf{q}$
\end_inset

 is the heat flux across 
\begin_inset Formula $S$
\end_inset

, and 
\begin_inset Formula $r$
\end_inset

 is the heat supply per mass to the material in 
\begin_inset Formula $V$
\end_inset

 resulting from other sources.
 Bringing the time derivative inside the integral on the left-hand-side,
 and using the divergence theorem, this integral statement of the energy
 balance may be written as
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \int_{V}\left[\rho\left(\dot{\varepsilon}+\mathbf{v}\cdot\mathbf{a}\right)+\rho\left(\varepsilon+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\divg\mathbf{v}-\frac{\dot{J}}{J}\right)\right]\,dV\\
 & =\int_{V}\left[\boldsymbol{\sigma}:\mathbf{D}-\divg\mathbf{q}+\rho r+\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\mathbf{b}\right)\right]\,dV
\end{aligned}
\,.\label{eq:energy-integral-redux}
\end{equation}

\end_inset

This statement must be valid for arbitrary control volumes and arbitrary
 processes, from which we conventionally derive the differential form of
 the axioms of mass, momentum and energy balance.
\end_layout

\begin_layout Standard
For the specialized conditions of a viscous fluid at constant temperature
 assumed in our treatment, the only state variables for the functions of
 state 
\begin_inset Formula $\varepsilon$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 are 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 (i.e., the temperature is not a state variable since it is assumed constant).
 Under these conditions the entropy inequality shows that the specific entropy
 
\begin_inset Formula $\eta$
\end_inset

 and the heat flux 
\begin_inset Formula $\mathbf{q}$
\end_inset

 must be zero, and the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 must have the form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress"

\end_inset

 where 
\begin_inset Formula $p$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

 as a function of 
\begin_inset Formula $J$
\end_inset

 only, leaving the residual dissipation statement 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}\ge0$
\end_inset

 as a constraint that must be satisfied by constitutive relations for 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

.
 (For a Newtonian fluid, this constraint is satisfied when the viscosities
 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are positive.) From these thermodynamic restrictions we conclude that 
\begin_inset Formula $\varepsilon=\psi$
\end_inset

, where 
\begin_inset Formula $\psi$
\end_inset

 is the specific (Helmholtz) free energy, with 
\begin_inset Formula $\Psi_{r}=\rho_{r}\psi$
\end_inset

.
\end_layout

\begin_layout Standard
For the conditions adopted here (isothermal viscous fluid), the axiom of
 energy balance reduces to 
\begin_inset Formula $\rho\dot{\psi}=\boldsymbol{\sigma}:\mathbf{D}+\rho r$
\end_inset

; since 
\begin_inset Formula $\psi$
\end_inset

 is only a function of 
\begin_inset Formula $J$
\end_inset

, this expression may be further simplified using Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"

\end_inset

 to produce 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}+\rho r=0$
\end_inset

.
 In other words, isothermal conditions may be maintained only if heat dissipated
 by the viscous stress is emitted in the form of a heat supply density 
\begin_inset Formula $\rho r=-\boldsymbol{\tau}:\mathbf{D}$
\end_inset

 (heat leaving the system).
 Now, the integral form of the energy balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:energy-integral-redux"

\end_inset

 simplifies to
\begin_inset Formula 
\begin{equation}
\int_{V}\left[\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)+\rho\left(\psi+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)\left(\frac{\dot{J}}{J}-\divg\mathbf{v}\right)\right]\,dV=0\,.\label{eq:energy-isothermal-viscous}
\end{equation}

\end_inset

A comparison of this statement with the statement of virtual work, presented
 below in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual work"

\end_inset

, establishes a clear correspondence between the virtual velocity 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

, and between the virtual energy density 
\begin_inset Formula $\delta J$
\end_inset

 and 
\begin_inset Formula $\rho\left(\psi+\frac{1}{2}\mathbf{v}\cdot\mathbf{v}\right)$
\end_inset

, with the latter representing the sum of the internal (free) and kinetic
 energy densities.
\end_layout

\begin_layout Section
Fluid-Structure Interactions
\begin_inset CommandInset label
LatexCommand label
name "sec:Fluid-Structure-Interactions"

\end_inset


\end_layout

\begin_layout Standard
We model the fluid domain in an FSI analysis as a mixture of an isothermal
 compressible viscous fluid and a hyperelastic compressible solid, where
 the solid has zero apparent density, and negligible (but non-zero) elasticity
 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim19"
literal "false"

\end_inset

.
 In a mixture framework, all mixture constituents coexist at every point
 in the continuum.
 For our FSI implementation, the finite element mesh is defined on the solid
 material, and the negligible (but non-zero) elasticity of the solid is
 intended to regularize the mesh deformation.
 The fluid flows through this mesh, unimpeded by the solid.
 In particular, in this FSI model there is no frictional interaction between
 the fluid and solid materials inside the mixture domain (i.e., no Darcy-Brinkman
 type of friction), but the no-slip boundary condition may be prescribed
 on boundaries of the mixture domain, where applicable.
\end_layout

\begin_layout Subsection
FSI Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:FSI-Governing-Equations"

\end_inset


\end_layout

\begin_layout Standard
The momentum balance for the fluid is
\begin_inset Formula 
\begin{equation}
\rho^{f}\mathbf{a}^{f}=\divg\boldsymbol{\sigma}^{f}+\rho^{f}\mathbf{b}\,,\label{eq:fsi-fluid-momentum}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the external body force acting on the FSI domain, 
\begin_inset Formula $\mathbf{a}^{f}$
\end_inset

 is the fluid acceleration,
\begin_inset Formula 
\begin{equation}
\mathbf{a}^{f}=\frac{\partial\mathbf{v}^{f}}{\partial t}+\mathbf{L}^{f}\cdot\mathbf{v}^{f}\,,\label{eq:fsi-fluid-acceleration}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{L}^{f}=\grad\mathbf{v}^{f}$
\end_inset

 is the fluid velocity gradient.
 In principle, the same momentum equation may be used for the solid (substitutin
g 
\begin_inset Formula $f$
\end_inset

 with 
\begin_inset Formula $s$
\end_inset

); however, since we opted to let 
\begin_inset Formula $\rho^{s}=0$
\end_inset

 (no solid mass), the momentum balance for the solid simply reduces to
\begin_inset Formula 
\begin{equation}
\divg\boldsymbol{\sigma}^{s}=\mathbf{0}\,.\label{eq:fsi-solid-momentum}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We model the fluid as isothermal and compressible, consistent with our CFD
 implementation.
 Thus, the fluid stress may be separated into the elastic pressure 
\begin_inset Formula $p\left(J^{f}\right)$
\end_inset

, which only depends on the fluid volume ratio 
\begin_inset Formula $J^{f}$
\end_inset

, and the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}\left(J^{f},\mathbf{L}^{f}\right)$
\end_inset

, as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{f}=-p\mathbf{I}+\boldsymbol{\tau}\,.\label{eq:fsi-fluid-stress-split}
\end{equation}

\end_inset

Recall that there is no dependence on temperature in an isothermal formulation.
 As done in our previous study, we integrate the mass balance for the fluid
 to produce
\begin_inset Formula 
\begin{equation}
\rho^{f}=\frac{\rho_{r}^{f}}{J^{f}}\,,\label{eq:fsi-integrated-fluid-mass}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}^{f}$
\end_inset

 is the fluid density in the reference state (e.g., under ambient pressure)
 and 
\begin_inset Formula $J^{f}=\det\mathbf{F}^{f}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}^{f}$
\end_inset

 is the fluid deformation gradient.
 We also use the kinematic constraint
\begin_inset Formula 
\begin{equation}
\frac{\partial J^{f}}{\partial t}+\grad J^{f}\cdot\mathbf{v}^{f}=J^{f}\divg\mathbf{v}^{f}\,,\label{eq:fsi-fluid-kinematic constraint}
\end{equation}

\end_inset

to relate the fluid volume ratio 
\begin_inset Formula $J^{f}$
\end_inset

 to its velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

, in the spatial frame.
\end_layout

\begin_layout Standard
The mesh through which the fluid flows is defined on the solid component
 of the mixture.
 Therefore, we define the relative velocity between the fluid and solid
 as
\begin_inset Formula 
\begin{equation}
\mathbf{w}=\mathbf{v}^{f}-\mathbf{v}^{s}\,.\label{eq:fsi-fluid-relative-velocity}
\end{equation}

\end_inset

Since the solid has zero volume fraction, this expression is the same as
 the flux of fluid relative to the solid.
 We choose to define the nodal degrees of freedom in the mixture domain
 to be the relative fluid velocity 
\begin_inset Formula $\mathbf{w}$
\end_inset

, the fluid dilatation 
\begin_inset Formula $e^{f}=J^{f}-1$
\end_inset

, and the solid displacement 
\begin_inset Formula $\mathbf{u}^{s}$
\end_inset

, which is related to the solid velocity via 
\begin_inset Formula $\mathbf{v}^{s}=\dot{\mathbf{u}}^{s}$
\end_inset

, with the dot operator denoting the material time derivative following
 the solid.
 (For notational convenience, we will continue using 
\begin_inset Formula $J^{f}$
\end_inset

 in the equations below, instead of 
\begin_inset Formula $e^{f}$
\end_inset

).
 Now,
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{f}=\mathbf{w}+\mathbf{v}^{s}\,,\label{eq:fsi-fluid-velocity}
\end{equation}

\end_inset

from which it follows that the fluid velocity gradient is
\begin_inset Formula 
\begin{equation}
\mathbf{L}^{f}=\mathbf{L}^{w}+\mathbf{L}^{s}\,,\label{eq:fsi-fluid-velocity-gradient}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{L}^{w}=\grad\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{L}^{s}=\grad\mathbf{v}^{s}$
\end_inset

.
 The fluid acceleration may now be rewritten in terms of the FEA degrees
 of freedom as
\begin_inset Formula 
\begin{equation}
\mathbf{a}^{f}=\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}+\left(\mathbf{L}^{w}+\mathbf{L}^{s}\right)\cdot\mathbf{w}\,,\label{eq:fsi-fluid-acceleration-redux}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{v}}^{s} & =\frac{\partial\mathbf{v}^{s}}{\partial t}+\mathbf{L}^{s}\cdot\mathbf{v}^{s}\\
\dot{\mathbf{w}} & =\frac{\partial\mathbf{w}}{\partial t}+\mathbf{L}^{w}\cdot\mathbf{v}^{s}
\end{aligned}
\label{eq:fsi-vs-w-material-derivs}
\end{equation}

\end_inset

are the material time derivatives of the solid and relative fluid velocities,
 in the frame following the solid.
 We conveniently use this material time derivative (instead of the material
 time derivative following the fluid) since we define the mixture domain
 mesh on the solid.
\end_layout

\begin_layout Standard
Similarly, the kinematic constraint relating 
\begin_inset Formula $J^{f}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 may be rewritten as
\begin_inset Formula 
\begin{equation}
\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}=J^{f}\divg\left(\mathbf{w}+\mathbf{v}^{s}\right)\,,\label{eq:fsi-fluid-kinematic-redux}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\dot{J}^{f}=\frac{\partial J^{f}}{\partial t}+\grad J^{f}\cdot\mathbf{v}^{s}\,.\label{eq:fsi-dilatation-material-deriv}
\end{equation}

\end_inset

Finally, as done routinely in our studies of biphasic and multiphasic materials,
 we find it convenient to substitute the kinematic identity
\begin_inset Formula 
\begin{equation}
\divg\mathbf{v}^{s}=\frac{\dot{J}^{s}}{J^{s}}\,,\label{eq:fsi-solid-kinematic-constraint}
\end{equation}

\end_inset

where 
\begin_inset Formula $J^{s}=\det\mathbf{F}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}^{s}=\mathbf{I}+\Grad\mathbf{u}^{s}$
\end_inset

 is the solid deformation gradient.
 
\end_layout

\begin_layout Standard
In summary, the governing equations for the FSI mixture domain are
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \divg\boldsymbol{\sigma}^{s}=\mathbf{0}\\
 & \rho^{f}\mathbf{a}^{f}=\divg\boldsymbol{\sigma}^{f}+\rho^{f}\mathbf{b}\\
 & \frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)=\divg\mathbf{w}+\frac{\dot{J}^{s}}{J^{s}}
\end{aligned}
\label{eq:fsi-governing-equations}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}^{f}$
\end_inset

 is given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fsi-fluid-acceleration-redux"

\end_inset

 above.
\end_layout

\begin_layout Section
Hybrid Biphasic Material
\begin_inset CommandInset label
LatexCommand label
name "sec:Hybrid-Biphasic-Material"

\end_inset


\end_layout

\begin_layout Standard
In FEBio, the standard biphasic material consists of a mixture of intrinsically
 incompressible solid and fluid constituents, as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In this standard material, the solid and fluid dynamics are neglected,
 as well as the fluid viscosity.
 When a user wishes to consider these dynamics effects, as well as fluid
 viscosity, they may use a hybrid biphasic material, as described in this
 section.
 The complete theoretical framework for such materials can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim21a"
literal "false"

\end_inset

.
 A hybrid biphasic domain is a mixture of an isothermal compressible viscous
 fluid and a hyperelastic compressible porous solid whose solid skeleton
 is intrinsically incompressible.
 Unlike the fluid-FSI material, here the solid has non-negligible mass density
 and elasticity, and frictional interactions may occur between the fluid
 and solid constituents, modeled using a hydraulic permeability (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Hydraulic-Permeability"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 In FEBio, the hybrid biphasic material is called 
\begin_inset Quotes eld
\end_inset

biphasic-FSI
\begin_inset Quotes erd
\end_inset

, since it allows dynamic fluid-structure interactions between this material
 and a fluid-FSI material, or a solid material.
 Here, we may abbreviate 
\begin_inset Quotes eld
\end_inset

biphasic-FSI
\begin_inset Quotes erd
\end_inset

 as BFSI.
 For BFSI domains, as with standard biphasic domains, the finite element
 mesh is defined on the porous solid material.
 The viscous fluid flows through this mesh, experiencing frictional drag
 caused by the porous solid.
 When two BFSI domains are interfaced, or when a BFSI domain is interfaced
 with a fluid-FSI domain, the pseudo-no slip condition 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou89"
literal "false"

\end_inset

 is enforced automatically on those interfaces.
 When a BFSI domain interfaces with a solid domain, the no-slip boundary
 condition has to be prescribed explicitly on those interfaces, where applicable.
\end_layout

\begin_layout Subsection
BFSI Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:BFSI-Governing-Equations"

\end_inset


\end_layout

\begin_layout Standard
We model the BFSI domain as an unconstrained mixture of an isothermal, compressi
ble, and viscous fluid and an isothermal, deformable porous solid whose
 skeleton material is intrinsically incompressible.
 As usual in mixture theory, each constituent 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha=s,f$
\end_inset

 for solid and fluid, respectively) has its own apparent density 
\begin_inset Formula $\rho^{\alpha}=dm^{\alpha}/dV$
\end_inset

, which represents the ratio of the elemental mass 
\begin_inset Formula $dm^{\alpha}$
\end_inset

 of constituent 
\begin_inset Formula $\alpha$
\end_inset

 in the elemental mixture volume 
\begin_inset Formula $dV$
\end_inset

.
 This apparent density is related to the true density 
\begin_inset Formula $\rho_{T}^{\alpha}=dm^{\alpha}/dV^{\alpha}$
\end_inset

 (mass of 
\begin_inset Formula $\alpha$
\end_inset

 per volume of 
\begin_inset Formula $\alpha$
\end_inset

) via 
\begin_inset Formula $\rho^{\alpha}=\varphi^{\alpha}\rho_{T}^{\alpha}$
\end_inset

, where 
\begin_inset Formula $\varphi^{\alpha}=dV^{\alpha}/dV$
\end_inset

 is the volume fraction of 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture, satisfying 
\begin_inset Formula $\varphi^{s}+\varphi^{f}=1$
\end_inset

.
 Since the solid skeleton is intrinsically incompressible, 
\begin_inset Formula $\rho_{T}^{s}$
\end_inset

 is constant.
 The boundaries of a biphasic domain are defined on the porous solid matrix.
 The deformation gradient of the solid is denoted by 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

 and its determinant, 
\begin_inset Formula $J^{s}=\det\mathbf{F}^{s}=dV/dV_{r}$
\end_inset

, represents the ratio of the mixture elemental volumes in the current (
\begin_inset Formula $dV$
\end_inset

) and reference (
\begin_inset Formula $dV_{r}$
\end_inset

) configurations.
 Thus, since the solid skeleton is intrinsically incompressible, 
\begin_inset Formula $J^{s}$
\end_inset

 purely represents the compressibility of the pore volume as fluid enters
 or leaves the pore space, or as the compressible fluid within the pores
 changes in volume.
 The axiom of mass balance for the solid may be integrated in closed form
 to produce 
\begin_inset Formula $\rho^{s}=\rho_{r}^{s}/J^{s}$
\end_inset

, where 
\begin_inset Formula $\rho_{r}^{s}=dm^{s}/dV_{r}$
\end_inset

 is the solid apparent density in the mixture reference configuration.
 Therefore, we may define the referential solid volume fraction as 
\begin_inset Formula $\varphi_{r}^{s}=\rho_{r}^{s}/\rho_{T}^{s}$
\end_inset

.
 In the finite element analysis, 
\begin_inset Formula $\varphi_{r}^{s}=dV^{s}/dV_{r}$
\end_inset

 and 
\begin_inset Formula $\rho_{T}^{s}$
\end_inset

 are both specified by the user, then 
\begin_inset Formula $\rho_{r}^{s}$
\end_inset

, 
\begin_inset Formula $\rho^{s}$
\end_inset

, 
\begin_inset Formula $\varphi^{s}$
\end_inset

 and 
\begin_inset Formula $\varphi^{f}$
\end_inset

 are evaluated from the above relations, given a solution for 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

 (and thus, 
\begin_inset Formula $J^{s}$
\end_inset

).
 The solution for 
\begin_inset Formula $\mathbf{F}^{s}=\mathbf{I}+\Grad\mathbf{u}$
\end_inset

 is obtained by solving for the nodal solid displacement vector 
\begin_inset Formula $\mathbf{u}$
\end_inset

, where 
\begin_inset Formula $\Grad\left(\cdot\right)$
\end_inset

 represents the gradient operator in the material frame.
\end_layout

\begin_layout Standard
For the compressible fluid phase of a hybrid biphasic material, the true
 density 
\begin_inset Formula $\rho_{T}^{f}$
\end_inset

 varies with the intrinsic fluid volumetric strain, or dilatation, 
\begin_inset Formula $e^{f}=J^{f}-1$
\end_inset

, where 
\begin_inset Formula $J^{f}$
\end_inset

 is the volume ratio of the fluid in its current and reference configurations,
 
\begin_inset Formula $dm^{f}$
\end_inset

 is the element mass of fluid and 
\begin_inset Formula $dV^{f}$
\end_inset

 is the elemental volume of that fluid in the pores of the mixture, in the
 current configuration.
 It follows from this definition that
\begin_inset Formula 
\begin{equation}
J^{f}=\frac{dV^{f}}{dV_{r}^{f}}=\frac{dV^{f}}{dm^{f}}\frac{dm^{f}}{dV_{r}^{f}}=\frac{\rho_{Tr}^{f}}{\rho_{T}^{f}}\thinspace,\label{eq:bfsi-Jf}
\end{equation}

\end_inset

where 
\begin_inset Formula $dV_{r}^{f}$
\end_inset

 is the elemental volume of this same fluid (having the same elemental mass
 
\begin_inset Formula $dm^{f}$
\end_inset

) in the fluid's reference configuration.
 Thus, 
\begin_inset Formula $\rho_{Tr}^{f}=dm^{f}/dV_{r}^{f}$
\end_inset

 is a constant representing the true fluid density in its reference configuratio
n, which is specified by the user.
 Accordingly, 
\begin_inset Formula $J^{f}=1$
\end_inset

 in the limit when the fluid is idealized to be intrinsically incompressible.
 This definition of 
\begin_inset Formula $J^{f}$
\end_inset

 is consistent with that for a pure fluid, as shown in our earlier formulation
 of computational fluid dynamics 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2018"
literal "false"

\end_inset

.
 As shown above, 
\begin_inset Formula $\rho^{f}$
\end_inset

 may be evaluated as 
\begin_inset Formula $\varphi^{f}\rho_{T}^{f}$
\end_inset

, which now expands into an expression involving solid and fluid volume
 ratios,
\begin_inset Formula 
\begin{equation}
\rho^{f}=\left(1-\frac{\varphi_{r}^{s}}{J^{s}}\right)\frac{\rho_{Tr}^{f}}{J^{f}}\,.\label{eq:bfsi-rhof-Jf-Js}
\end{equation}

\end_inset

The limiting case when the fluid within the solid matrix pores has been
 completely squeezed out corresponds to 
\begin_inset Formula $\rho^{f}=0$
\end_inset

 (or 
\begin_inset Formula $dm^{f}=0$
\end_inset

).
 Based on the above relation, this is equivalent to having the entire mixture
 volume 
\begin_inset Formula $dV$
\end_inset

 reduce to the solid volume 
\begin_inset Formula $dV^{s}$
\end_inset

 in the current configuration, or equivalently 
\begin_inset Formula $J^{s}=\varphi_{r}^{s}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "false"

\end_inset

.
 In this limiting case, the mixture becomes an intrinsically incompressible
 solid and the finite element formulation presented in this study no longer
 applies.
\end_layout

\begin_layout Standard
We assume that 
\begin_inset Formula $\mathbf{F}^{s}=\mathbf{I}$
\end_inset

 (or equivalently, 
\begin_inset Formula $\mathbf{u}=\mathbf{0}$
\end_inset

) and 
\begin_inset Formula $e^{f}=0$
\end_inset

 at the start of a finite element analysis.
 The fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 is included as a nodal degree of freedom, implying that it is continuous
 across finite element boundaries.
 This assumption is verified below, when we review the jump conditions on
 axioms of mass, momentum and energy balance across interfaces.
\end_layout

\begin_layout Standard
Since the axiom of mass balance for the solid has already been solved in
 closed form, we only need to be concerned with the axiom of mass balance
 for the fluid, or alternatively, that of the mixture, which takes the form
\begin_inset Formula 
\begin{equation}
\frac{D^{f}J^{f}}{Dt}=\frac{J^{f}}{\varphi^{f}}\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\thinspace,\label{eq:bfsi-mix-mass-balance-f}
\end{equation}

\end_inset

 where 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

 is the solid velocity (the material time derivative of the solid displacement
 
\begin_inset Formula $\mathbf{u}$
\end_inset

), and
\begin_inset Formula 
\begin{equation}
\mathbf{w}=\varphi^{f}\left(\mathbf{v}^{f}-\mathbf{v}^{s}\right)\thinspace\label{eq:bfsi-fluid-flux}
\end{equation}

\end_inset

is the volumetric flux of the fluid relative to the solid , with 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 representing the fluid velocity.
 Here, 
\begin_inset Formula $D^{f}\left(\cdot\right)/Dt$
\end_inset

 is the material time derivative operator in the spatial frame, following
 the fluid motion.
 Since the finite element mesh is defined on the porous solid matrix of
 a biphasic mixture, and since the fluid flows relative to the solid, material
 time derivatives need to follow the solid motion in the finite element
 implementation.
 A similar scheme was used in our implementations of solute transport within
 deformable porous domains (Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
plural "false"
caps "false"
noprefix "false"

\end_inset

), to account for the motion of solutes relative to the porous solid matrix,
 as well as in our FSI formulation (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluid-Structure-Interactions"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2011,Ateshian2013,Shim2019"
literal "true"

\end_inset

.
 Thus, we substitute the following identity,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{D^{f}J^{f}}{Dt} & =\frac{\partial J^{f}}{\partial t}+\grad J^{f}\cdot\mathbf{v}^{f}\\
 & =\frac{D^{s}J^{f}}{Dt}+\grad J^{f}\cdot\left(\mathbf{v}^{f}-\mathbf{v}^{s}\right)
\end{aligned}
\,,\label{eq:bfsi-DfJf-DsJf}
\end{equation}

\end_inset

into the axiom of mixture mass balance in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-mix-mass-balance-f"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce the final form
\begin_inset Formula 
\begin{equation}
\dot{J}^{f}+\frac{1}{\varphi^{f}}\grad J^{f}\cdot\mathbf{w}=\frac{J^{f}}{\varphi^{f}}\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\,.\label{eq:bfsi-fluid-kin-constr}
\end{equation}

\end_inset

In this expression, the dot operator in 
\begin_inset Formula $\dot{J}^{f}$
\end_inset

 represents the material time derivative following the solid motion.
 In the solid material frame, this material time derivative reduces to the
 partial time derivative.
 Accordingly, we may now write 
\begin_inset Formula $\mathbf{v}^{s}=\dot{\mathbf{u}}$
\end_inset

.
 In the BFSI implementation, the fluid volumetric flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 relative to the solid is added to the list of nodal DOFs, giving us the
 complete set 
\begin_inset Formula $\left(\mathbf{u},\mathbf{w},e^{f}\right)$
\end_inset

.
 This choice implies that 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is continuous across finite element boundaries, as justified further below
 when we review jump conditions across interfaces.
\end_layout

\begin_layout Standard
Based on the constitutive assumptions of our hybrid biphasic formulation
 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim21a"
literal "false"

\end_inset

, the momentum balance equations for the fluid and solid constituents reduce
 to
\begin_inset Formula 
\begin{equation}
\rho^{f}\mathbf{a}^{f}=-\varphi^{f}\grad p+\divg\boldsymbol{\tau}^{f}+\rho^{f}\mathbf{b}^{f}-\varphi^{f}\mathbf{k}^{-1}\cdot\mathbf{w}\,,\label{eq:bfsi-fluid-momentum}
\end{equation}

\end_inset

 and
\begin_inset Formula 
\begin{equation}
\rho^{s}\mathbf{a}^{s}=-\varphi^{s}\grad p+\divg\boldsymbol{\sigma}^{e}+\rho^{s}\mathbf{b}^{s}+\varphi^{f}\mathbf{k}^{-1}\cdot\mathbf{w}\,,\label{eq:bfsi-solid-momentum}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}^{\alpha}=D^{\alpha}\mathbf{v}^{\alpha}/Dt$
\end_inset

 is the acceleration, 
\begin_inset Formula $\mathbf{b}^{\alpha}$
\end_inset

 is the body force per mass acting on constituent 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure, 
\begin_inset Formula $\boldsymbol{\tau}^{f}$
\end_inset

 is the apparent fluid viscous stress, and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the apparent solid elastic stress.
 These stress tensors are called apparent because their associated traction
 vectors represent a force acting on constituent 
\begin_inset Formula $\alpha$
\end_inset

 per elemental 
\emph on
mixture
\emph default
 area.
 Here, 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability tensor which regulates frictional drag between
 the fluid and solid constituents; setting 
\begin_inset Formula $\mathbf{k}^{-1}$
\end_inset

 to 
\begin_inset Formula $\mathbf{0}$
\end_inset

 implies that this frictional drag is non-existent.
 Since the fluid is compressible, its pressure must be given by a function
 of state.
 In the isothermal framework used here, this function only depends on 
\begin_inset Formula $e^{f}$
\end_inset

, and the form adopted in FEBio is
\begin_inset Formula 
\begin{equation}
p=-Ke^{f}\,,\label{eq:bfsi-pressure-state}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the fluid bulk modulus (a user-specified material property).
 In the limit when inertia and body forces are neglected (
\begin_inset Formula $\mathbf{a}^{f}=\mathbf{b}^{f}=\mathbf{0}$
\end_inset

), the fluid momentum balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

 produces the classical Darcy-Brinkman relation 
\begin_inset CommandInset citation
LatexCommand citep
key "Brinkman49"
literal "false"

\end_inset

.
 If the fluid viscous stress is also neglected (
\begin_inset Formula $\boldsymbol{\tau}^{f}=\mathbf{0}$
\end_inset

), we recover Darcy's law, 
\begin_inset Formula $\mathbf{w}=-\mathbf{k}\cdot\grad p$
\end_inset

.
\end_layout

\begin_layout Standard
Since the finite element implementation requires all material time derivatives
 to follow the motion of the solid, we recognize that 
\begin_inset Formula $\mathbf{a}^{s}=\ddot{\mathbf{u}}$
\end_inset

 and we evaluate the fluid acceleration as 
\begin_inset Formula $\mathbf{a}^{f}=\dot{\mathbf{v}}^{f}+\grad\mathbf{v}^{f}\cdot\left(\mathbf{v}^{f}-\mathbf{v}^{s}\right)$
\end_inset

.
 However, since 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 is not a nodal degree of freedom, we use eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-flux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to substitute
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{f}=\frac{1}{\varphi^{f}}\mathbf{w}+\mathbf{v}^{s}\label{eq:bfsi-fluid-velocity}
\end{equation}

\end_inset

into this expression.
 It follows that the fluid velocity gradient 
\begin_inset Formula $\mathbf{L}^{f}=\grad\mathbf{v}^{f}$
\end_inset

 may be evaluated as
\begin_inset Formula 
\begin{equation}
\mathbf{L}^{f}=\mathbf{L}^{s}+\frac{1}{\varphi^{f}}\left(\mathbf{L}^{w}-\frac{1}{\varphi^{f}}\mathbf{w}\otimes\grad\varphi^{f}\right)\,,\label{eq:bfsi-Lf}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{L}^{w}=\grad\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{L}^{s}=\grad\mathbf{v}^{s}$
\end_inset

.
 Now, the fluid acceleration takes the form
\begin_inset Formula 
\begin{equation}
\mathbf{a}^{f}=\frac{1}{\varphi^{f}}\left(\dot{\mathbf{w}}+\phi^{f}\ddot{\mathbf{u}}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}^{s}}{J^{s}}\mathbf{w}+\mathbf{L}^{f}\cdot\mathbf{w}\right)\,.\label{eq:bfsi-af}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
BFSI Continuous Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:BFSI-Continuous-Variables"

\end_inset


\end_layout

\begin_layout Standard
Jump conditions on the axioms of mass, momentum and energy balance are needed
 to determine which variables may be selected as nodal DOFs in the finite
 element implementation, and which tractions are naturally continuous across
 an interface.
 The full set of jump conditions for a hybrid biphasic material were derived
 in our recent study for the constitutive assumptions adopted in this formulatio
n 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim21a"
literal "false"

\end_inset

.
 Here, we summarize the salient results, which apply to an interface defined
 on the porous solid matrix of the hybrid biphasic domain, which includes
 the shared faces of adjoining biphasic elements.
 Thus, the velocity of the interface is given by the velocity 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

 of the solid constituent of the hybrid biphasic material.
 We employ the notation 
\begin_inset Formula $\left[\left[f\right]\right]=f_{+}-f_{-}$
\end_inset

 to denote the jump in the function 
\begin_inset Formula $f$
\end_inset

 across the interface 
\begin_inset Formula $\Gamma$
\end_inset

, with 
\begin_inset Formula $f_{+}$
\end_inset

 and 
\begin_inset Formula $f_{-}$
\end_inset

 denoting the values of 
\begin_inset Formula $f$
\end_inset

 on either side of 
\begin_inset Formula $\Gamma$
\end_inset

.
 The unit normal on 
\begin_inset Formula $\Gamma$
\end_inset

 is 
\series bold

\begin_inset Formula $\mathbf{n}$
\end_inset


\series default
, which points away from the 
\begin_inset Formula $+$
\end_inset

 side.
 A variable 
\begin_inset Formula $f$
\end_inset

 which is continuous across 
\begin_inset Formula $\Gamma$
\end_inset

 satisfies 
\begin_inset Formula $\left[\left[f\right]\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
Based on the jump condition on the axiom of mass balance, the normal component
 of the mass flux of the fluid relative to the solid is continuous across
 
\begin_inset Formula $\Gamma$
\end_inset

, 
\begin_inset Formula $\left[\left[\rho_{T}^{f}\mathbf{w}\right]\right]\cdot\mathbf{n}=0$
\end_inset

.
 Furthermore, a sufficient condition to satisfy the jump on the axiom of
 energy balance is to enforce continuity of the fluid specific free enthalpy
 (also known as the Gibbs function), 
\begin_inset Formula $\left[\left[\psi^{f}+p/\rho_{T}^{f}\right]\right]=0$
\end_inset

, where 
\begin_inset Formula $\psi^{f}$
\end_inset

 is the fluid specific free energy.
 This jump condition applies only when there is fluid on both sides of the
 interface 
\begin_inset Formula $\Gamma$
\end_inset

.
 In an isothermal framework the specific free enthalpy is a function of
 state that only depends on 
\begin_inset Formula $J^{f}$
\end_inset

, therefore this energy jump condition implies that 
\begin_inset Formula $J^{f}$
\end_inset

 must be continuous across 
\begin_inset Formula $\Gamma$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\left[\left[J^{f}\right]\right]=0\,,\label{eq:bfsi-Jf-jump}
\end{equation}

\end_inset

also implying that 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

.
 Given eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-Jf"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it follows that 
\begin_inset Formula $\left[\left[\rho_{T}^{f}\right]\right]=0$
\end_inset

 and the mass balance jump condition reduces to 
\begin_inset Formula $\left[\left[\mathbf{w}\right]\right]\cdot\mathbf{n}=0$
\end_inset

, implying that the relative fluid flux component normal to 
\begin_inset Formula $\Gamma$
\end_inset

 must be continuous.
 For the tangential component of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 we appeal to the analysis of Hou et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou1989"
literal "false"

\end_inset

, who showed that a valid pseudo-noslip condition requires this tangential
 component to be continuous.
 Combining these two jump conditions produces
\begin_inset Formula 
\begin{equation}
\left[\left[\mathbf{w}\right]\right]=0\,.\label{eq:bfsi-fluid-flux-jump}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The momentum jump condition requires that the mixture traction be continuous
 across 
\begin_inset Formula $\Gamma$
\end_inset

, thus 
\begin_inset Formula $\left[\left[-p\mathbf{I}+\boldsymbol{\sigma}^{e}+\boldsymbol{\tau}^{f}\right]\right]\cdot\mathbf{n}=\mathbf{0}$
\end_inset

.
 Since 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

 based on the energy jump, this mixture momentum jump condition reduces
 to
\begin_inset Formula 
\begin{equation}
\left[\left[\boldsymbol{\sigma}^{e}+\boldsymbol{\tau}^{f}\right]\right]\cdot\mathbf{n}=0\,.\label{eq:bfsi-mix-mtm-jump}
\end{equation}

\end_inset

Finally, another relation which is sufficient to satisfy the jump condition
 on the energy balance is the continuity of the true fluid traction (force
 acting on fluid per fluid area),
\begin_inset Formula 
\begin{equation}
\left[\left[\frac{\boldsymbol{\tau}^{f}}{\varphi^{f}}\right]\right]\cdot\mathbf{n}=0\,.\label{eq:bfsi-fluid-mtm-jump}
\end{equation}

\end_inset

This jump condition eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

, which also applies only if fluid is present on both sides of 
\begin_inset Formula $\Gamma$
\end_inset

, is interesting because it implies that the viscous stress (and thus, the
 viscosity) of a fluid flowing in a porous solid matrix scales with the
 porosity of that medium, such that 
\begin_inset Formula $\boldsymbol{\tau}^{f}=\phi^{f}\boldsymbol{\tau}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 would be the true fluid viscous stress.
 Thus, we can use FEBio's various constitutive relations for the viscous
 stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 of Newtonian or non-Newtonian fluids and adapt those models to a biphasic
 mixture where 
\begin_inset Formula $\boldsymbol{\tau}^{f}$
\end_inset

 is evaluated as 
\begin_inset Formula $\varphi^{f}\boldsymbol{\tau}$
\end_inset

.
 Accordingly, the contribution of 
\begin_inset Formula $\boldsymbol{\tau}^{f}$
\end_inset

 would properly reduce to zero in the limit as fluid content reduces to
 zero (
\begin_inset Formula $\varphi^{f}\to0$
\end_inset

), in which case the mixture momentum jump in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-mix-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 would reduce to 
\begin_inset Formula $\left[\left[-p\mathbf{I}+\boldsymbol{\sigma}^{e}\right]\right]\cdot\mathbf{n}=\left[\left[\boldsymbol{\sigma}^{e}\right]\right]\cdot\mathbf{n}=0$
\end_inset

, since 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $J^{f}$
\end_inset

 be nodal DOFs automatically enforces the jump conditions eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-Jf-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-flux-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

, acting as essential boundary conditions, along with the solid displacement
 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 Finally, subtracting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-mix-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we obtain the momentum jump condition for the solid constituent, 
\begin_inset Formula 
\begin{equation}
\left[\left[-\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}^{f}+\boldsymbol{\sigma}^{e}\right]\right]\cdot\mathbf{n}=0\,.\label{eq:bfsi-solid-mtm-jump}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
A BFSI domain may be reduced to a FSI domain by letting 
\begin_inset Formula $\varphi_{r}^{s}\to0$
\end_inset

 and 
\begin_inset Formula $\mathbf{k}^{-1}\to\mathbf{0}$
\end_inset

; the solid matrix would still be ascribed a material response but its stiffness
 would need to be negligible.
 The number of nodal DOFs would remain the same.
 The CFD domain is a special case of the FSI domain where the mesh displacement
 is uniformly 
\begin_inset Formula $\mathbf{u}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Standard
However, when the biphasic domain interfaces with a non-porous solid domain
 across 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

, the jump conditions eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-Jf-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on 
\begin_inset Formula $J^{f}$
\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-solid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on 
\begin_inset Formula $\boldsymbol{\tau}^{f}$
\end_inset

 don't apply.
 In that case, the jump condition eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-flux-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on the relative fluid volumetric flux should reduce to 
\begin_inset Formula $\mathbf{w}=\mathbf{0}$
\end_inset

 for the BFSI domain on 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

, although the user would have to enforce this no-slip condition explicitly
 by prescribing it as an essential boundary condition.
 The mixture momentum jump 
\begin_inset Formula $\left[\left[-p\mathbf{I}+\boldsymbol{\sigma}^{e}+\boldsymbol{\tau}^{f}\right]\right]\cdot\mathbf{n}=\mathbf{0}$
\end_inset

 implies that the mixture traction on the BFSI side of an interface with
 a solid is equal to the solid traction on the solid side.
 This jump condition would also need to be enforced explicitly.
\end_layout

\begin_layout Section
Fluid-Solutes Analyses
\begin_inset CommandInset label
LatexCommand label
name "sec:Fluid-Solutes-Analyses"

\end_inset


\end_layout

\begin_layout Standard
Fluid-solutes analyses combine solute transport with fluid mechanics.
 The fluid-solutes domain, denoted by 
\begin_inset Formula $\Omega^{f}$
\end_inset

, is a hybrid multiphasic domain without a deformable porous solid matrix
 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

.
 Like the CFD domain, the CFD-solutes domain is fixed in space, and the
 fluid flows within it and possibly across its boundaries.
 The boundaries 
\begin_inset Formula $\partial\Omega^{f}$
\end_inset

 of 
\begin_inset Formula $\Omega^{f}$
\end_inset

, and interfaces within this domain (such as faces of adjoining finite elements)
, are denoted generically by 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 In the current implementation, finite element domains that meet at these
 interfaces share common nodes and element faces, though it is possible
 to consider future extensions where tied interfaces are used to connect
 dissimilar meshes.
 The formulation and finite element implementation of this type of domain
 are presented below, using only salient governing equations simplified
 from the more general hybrid multiphasic theory presented in our recent
 study 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Governing Equations
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Solutes-Equations"

\end_inset


\end_layout

\begin_layout Standard
We model the domain 
\begin_inset Formula $\Omega^{f}$
\end_inset

 as a mixture of an isothermal, compressible, and viscous solvent which
 is electrically neutral, and isothermal, intrinsically incompressible,
 and dilute solute constituents which may be electrically charged.
 All solute accelerations are neglected, since they contribute insignificantly
 in comparison with diffusive forces, except in problems such as centrifugation,
 where they can be represented by an external inertial body force.
 Unlike the standard (Darcy flow through a porous-deformable) multiphasic
 domain 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2007,Ateshian13,Ateshian14"
literal "false"

\end_inset

, the fluid-solutes domain is fixed in space.
 We denote the mixture constituents using a superscripted 
\begin_inset Formula $\alpha$
\end_inset

, where 
\begin_inset Formula $\alpha=f,\iota$
\end_inset

 for solvent and solutes, respectively.
 The volume fraction 
\begin_inset Formula $\varphi^{\iota}$
\end_inset

 of each solute species 
\begin_inset Formula $\iota$
\end_inset

 is assumed to be negligible (
\begin_inset Formula $\varphi^{\iota}\ll1$
\end_inset

), therefore the volume fraction of the solvent is 
\begin_inset Formula $\varphi^{f}=dV^{f}/dV\approx1$
\end_inset

.
 The apparent density of each constituent 
\begin_inset Formula $\alpha$
\end_inset

 is 
\begin_inset Formula $\rho^{\alpha}=dm^{\alpha}/dV$
\end_inset

, which represents the ratio of the elemental mass 
\begin_inset Formula $dm^{\alpha}$
\end_inset

 of constituent 
\begin_inset Formula $\alpha$
\end_inset

 in the elemental fluid mixture volume.
 Under these assumptions, the true density of the solvent simplifies to
 
\begin_inset Formula $\rho_{T}^{f}=\rho^{f}$
\end_inset

 while the true density 
\begin_inset Formula $\rho_{T}^{\iota}$
\end_inset

 of each solute 
\begin_inset Formula $\iota$
\end_inset

 is constant due to its intrinsic incompressibility.
 Since the solvent is compressible, as was done in the fluid mechanics formulati
on 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"
literal "false"

\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluid-Mechanics"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the solvent volume ratio 
\begin_inset Formula $J^{f}$
\end_inset

 was employed as a kinematic state variable to represent the fluid volumetric
 strain,
\begin_inset Formula 
\begin{equation}
J^{f}=\frac{\rho_{r}^{f}}{\rho^{f}}\thinspace,\label{eq:Fluid-Dil-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}^{f}$
\end_inset

 is the referential solvent density (
\begin_inset Formula $\rho^{f}$
\end_inset

 in the reference configuration), which is a user-specified material constant.
 An alternative representation of fluid volumetric strain is the fluid dilatatio
n, 
\begin_inset Formula $e^{f}=J^{f}-1$
\end_inset

, which is used in the actual finite element code.
\end_layout

\begin_layout Standard
The axiom of mass balance for the mixture takes the form 
\begin_inset Formula 
\begin{equation}
\frac{D^{f}J^{f}}{Dt}=J^{f}\left(\divg\mathbf{v}^{f}-\sum_{\iota}\frac{\hat{\rho}^{\iota}}{\rho_{T}^{\iota}}\right)\thinspace,\label{eq:Mix-Mass-Bal-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 is the velocity of the fluid constituent and 
\begin_inset Formula $\hat{\rho}^{\iota}$
\end_inset

 is the mass density supply to 
\begin_inset Formula $\iota$
\end_inset

 due to reactions with all other solutes.
 It is assumed that reactions do not add or remove solvent mass (
\begin_inset Formula $\hat{\rho}^{f}=0$
\end_inset

).
 Here, 
\begin_inset Formula $D^{f}\left(\cdot\right)/Dt=\partial\left(\cdot\right)/\partial t+\grad\left(\cdot\right)\cdot\mathbf{v}^{f}$
\end_inset

 is the material time derivative operator in the spatial frame, following
 the fluid motion.
 The mixture mass balance reproduces the kinematic constraint between the
 fluid velocity and dilatation for the fluid mechanics formulation 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"
literal "false"

\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluid-Mechanics"
plural "false"
caps "false"
noprefix "false"

\end_inset

), with the addition of reactive mass supply terms.
 The axiom of mass balance for each solute takes the form 
\begin_inset Formula 
\begin{equation}
\hat{c}^{\iota}=\frac{\partial c^{\iota}}{\partial t}+\divg\left(c^{\iota}\mathbf{v}^{\iota}\right)=\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}+\divg\mathbf{j}^{\iota}\thinspace,\label{eq:Mass-Bal-Solute-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{c}^{\iota}=\hat{\rho}^{\iota}/M^{\iota}$
\end_inset

 is the molar concentration supply and 
\begin_inset Formula $c^{\iota}=\rho^{\iota}/M^{\iota}$
\end_inset

 is the molar concentration of solute 
\begin_inset Formula $\iota$
\end_inset

, and 
\begin_inset Formula $\mathbf{j}^{\iota}=c^{\iota}\left(\mathbf{v}^{\iota}-\mathbf{v}^{f}\right)$
\end_inset

 is the molar flux of solute 
\begin_inset Formula $\iota$
\end_inset

 relative to the solvent.
 As shown previously 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

, the molar solute flux may be evaluated from the solute momentum balance
 when inertia terms have been neglected, 
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\iota}=\tilde{\kappa}^{\iota}d_{0}^{\iota}\left(-\grad\tilde{c}^{\iota}+\frac{M^{\iota}}{R\theta}\tilde{c}^{\iota}\mathbf{b}^{\iota}\right)\thinspace,\label{eq:Solute-Flux-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{\kappa}^{\iota}$
\end_inset

 is the partition coefficient of solute 
\begin_inset Formula $\iota$
\end_inset

 relative to an ideal solution 
\begin_inset CommandInset citation
LatexCommand cite
key "Ogston1961,Laurent1964"
literal "false"

\end_inset

.
 It is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\kappa}^{\iota}=\frac{\kappa^{\iota}}{\gamma^{\iota}}\exp\left(-\frac{z^{\iota}F_{c}\psi}{R\theta}\right)\thinspace,\label{eq:Partition-Coeff-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\kappa^{\iota}$
\end_inset

 is the solubility of solute 
\begin_inset Formula $\iota$
\end_inset

 in the mixture, or the fraction of fluid volume accessible to the solute
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mauck03"
literal "false"

\end_inset

 (
\begin_inset Formula $\kappa^{\iota}=1$
\end_inset

 in a fluid mixture), and 
\begin_inset Formula $\gamma^{\iota}$
\end_inset

 is the activity coefficient of solute 
\begin_inset Formula $\iota$
\end_inset

.
 The ratio 
\begin_inset Formula $\kappa^{\iota}/\gamma^{\iota}$
\end_inset

 is a non-dimensional property that describes the deviation of the solute
 chemical potential from that of an ideal, dilute solution 
\begin_inset CommandInset citation
LatexCommand citep
key "Tinoco-Jr.95"
literal "false"

\end_inset

.
 We can represent this ratio as 
\begin_inset Formula $\hat{\kappa}^{\iota}\equiv\kappa^{\iota}/\gamma^{\iota}$
\end_inset

, and call it the effective solubility of 
\begin_inset Formula $\iota$
\end_inset

 in the solution 
\begin_inset CommandInset citation
LatexCommand cite
key "Ateshian2011"
literal "false"

\end_inset

.
 In 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Partition-Coeff-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $z^{\iota}$
\end_inset

 is the charge number of solute 
\begin_inset Formula $\iota$
\end_inset

, 
\begin_inset Formula $F_{c}$
\end_inset

 is Faraday's constant, 
\begin_inset Formula $\psi$
\end_inset

 is the electrical potential, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant, and 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature.
 In 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Solute-Flux-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $d_{0}^{\iota}$
\end_inset

 is the diffusivity of solute 
\begin_inset Formula $\iota$
\end_inset

 in the fluid, 
\begin_inset Formula $\mathbf{b}^{\iota}$
\end_inset

 is the body force per mass acting on solute 
\begin_inset Formula $\iota$
\end_inset

, and 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 is the effective concentration of solute 
\begin_inset Formula $\iota$
\end_inset

, such that 
\begin_inset Formula 
\begin{equation}
\tilde{c}^{\iota}=c^{\iota}/\tilde{\kappa}^{\iota}\,.\label{eq:effective-actual-concentration}
\end{equation}

\end_inset

The effective solute concentration represents an alternative form of the
 solute electrochemical potential, expressed in units of molar concentration
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07b,Ateshian13"
literal "false"

\end_inset

.
 The solute flux in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Solute-Flux-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 has contributions from diffusion (as represented by the term containing
 
\begin_inset Formula $\grad\tilde{c}^{\iota}$
\end_inset

), sedimentation (
\begin_inset Formula $\tilde{c}^{\iota}\mathbf{b}^{\iota}$
\end_inset

 when 
\begin_inset Formula $\mathbf{b}^{\iota}$
\end_inset

 is proportional to an inertial force), electrophoresis (
\begin_inset Formula $\tilde{c}^{\iota}\mathbf{b}^{\iota}$
\end_inset

 when 
\begin_inset Formula $\mathbf{b}^{\iota}$
\end_inset

 is proportional to the Lorentz force acting on charged solute 
\begin_inset Formula $\iota$
\end_inset

), and convection (
\begin_inset Formula $\tilde{c}^{\iota}\mathbf{v}^{f}$
\end_inset

).
\end_layout

\begin_layout Standard
The solute flux in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Solute-Flux-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may also be expressed in terms of its components,
\begin_inset Formula 
\begin{equation}
\mathbf{j}^{\iota}=\underbrace{-\tilde{\kappa}^{\iota}d_{0}^{\iota}\grad\tilde{c}^{\iota}}_{\mathbf{j}_{d}^{\iota}}+\underbrace{s^{\iota}c^{\iota}\mathbf{b}^{\iota}}_{\mathbf{j}_{b}^{\iota}}\label{eq:solute-flux-components}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
s^{\iota}\equiv d_{0}^{\iota}\frac{M^{\iota}}{R\theta}\label{eq:sedimentation-coeff}
\end{equation}

\end_inset

is the 
\emph on
sedimentation coefficient
\emph default
.
 In the expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:solute-flux-components"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset Formula $\mathbf{j}_{d}^{\iota}$
\end_inset

 represents the diffusive flux, and 
\begin_inset Formula $\mathbf{j}_{b}^{\iota}$
\end_inset

 is the sedimentation flux.
 Now the mass balance expression in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Bal-Solute-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be combined with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mix-Mass-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce
\begin_inset Formula 
\begin{equation}
\hat{c}^{\iota}-c^{\iota}\sum_{\gamma}\mathcal{V}^{\gamma}\hat{c}^{\gamma}=\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}+\divg\left(\mathbf{j}_{d}^{\iota}+\mathbf{j}_{b}^{\iota}\right)\label{eq:solute-mass-alt}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{V}^{\iota}\equiv\nicefrac{M^{\iota}}{\rho_{T}^{\iota}}$
\end_inset

 is the molar volume of solute 
\begin_inset Formula $\iota$
\end_inset

.
 Since we have neglected the volume fraction of solutes in the current mixture
 formulation, it follows that 
\begin_inset Formula $c^{\iota}\mathcal{V}^{\iota}\ll1$
\end_inset

.
 Thus, we may neglect the second term on the left-hand side of the above
 equation, as well as the related term on the right-hand side of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mix-Mass-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The fluid momentum balance is given by
\begin_inset Formula 
\begin{equation}
\rho^{f}\mathbf{a}^{f}=-\grad\tilde{p}+\divg\boldsymbol{\tau}+\rho^{f}\mathbf{b}^{f}+\sum_{\iota}\left(-R\theta\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}+M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)\thinspace,\label{eq:Fluid-Mtm-Bal-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}^{f}=D^{f}\mathbf{v}^{f}/Dt$
\end_inset

 is the fluid acceleration, 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the fluid viscous stress, 
\begin_inset Formula $\mathbf{b}^{f}$
\end_inset

 is the body force per mass acting on the fluid 
\begin_inset Formula $f$
\end_inset

, and 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the effective fluid pressure, related to the fluid pressure 
\begin_inset Formula $p$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
p=\tilde{p}+R\theta\Phi\sum_{\iota}c^{\iota}\thinspace.\label{eq:Total-fluid-p-CFDSol}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\Phi$
\end_inset

 is the osmotic coefficient, a non-dimensional property that describes the
 deviation of the osmotic pressure from the ideal behavior known as van't
 Hoff's law 
\begin_inset CommandInset citation
LatexCommand citep
key "McNaught97"
literal "false"

\end_inset

, and 
\begin_inset Formula $R\theta\Phi\sum_{\iota}c^{\iota}$
\end_inset

 is the osmotic or chemical contribution to the fluid pressure.
 Therefore, 
\begin_inset Formula $\tilde{p}$
\end_inset

, which is an alternative form of the solvent mechano-chemical potential,
 may be interpreted as the mechanical or hydraulic contribution to 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\begin_layout Standard
Previously, we showed that the effective pressure must only depend on the
 fluid volume ratio, such that 
\begin_inset Formula $\tilde{p}=\tilde{p}\left(J^{f}\right)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

.
 Based on mass, momentum and energy jump conditions for this type of mixture,
 it can also be shown that 
\begin_inset Formula $J^{f}$
\end_inset

 (or alternatively 
\begin_inset Formula $e^{f}$
\end_inset

) is continuous across interfaces 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, and thus may be used as a nodal degree of freedom (DOF).
 We may choose a constitutive relation valid for arbitrary (but strictly
 positive) values of 
\begin_inset Formula $J^{f}$
\end_inset

 
\begin_inset Formula 
\begin{equation}
\tilde{p}=K\left(\frac{1}{J^{f}}-1\right)\,,\label{eq:Eff-Pressure-CFDSol}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the solvent's bulk modulus (a user-specified material property).
\end_layout

\begin_layout Standard
The solute-dependent terms appearing on the right side of the solvent momentum
 balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are typically neglected in classical CFD-solutes formulations, but we included
 them here since they emerged naturally to describe the phenomena of osmosis
 (solvent flow due to solute diffusion or sedimentation), and electro-osmosis
 (solvent flow due to solute electrophoresis).
 To reproduce classical formulations, by default we turned off these terms
 (within the summation on the right-hand side of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

), and we added a user-defined flag (
\begin_inset Quotes eld
\end_inset

include osmosis
\begin_inset Quotes erd
\end_inset

) to optionally turn them back on.
 In addition, users can turn off osmotic pressure by setting the osmotic
 coefficient 
\begin_inset Formula $\Phi$
\end_inset

 to zero, in which case 
\begin_inset Formula $p=\tilde{p}$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Total-fluid-p-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Both of these approaches were investigated in the test problems described
 below.
\end_layout

\begin_layout Standard
As done in the standard multiphasic formulation (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
plural "false"
caps "false"
noprefix "false"

\end_inset

), we assumed there can be no electric charge accumulation in the mixture,
 so we enforce the electroneutrality condition
\begin_inset Formula 
\begin{equation}
\sum_{\iota}z^{\iota}c^{\iota}=0\,.\label{eq:Electroneutrality-CFDSol}
\end{equation}

\end_inset

Multiplying the mass balances from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Bal-Solute-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by 
\begin_inset Formula $z^{\iota}$
\end_inset

 and taking the sum over all the constituents, making use of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Electroneutrality-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and adopting the assumption that reactive processes maintain electroneutrality
 (
\begin_inset Formula $\sum_{\iota}z^{\iota}\nu^{\iota}=0$
\end_inset

 where 
\begin_inset Formula $\nu^{\alpha}$
\end_inset

 is the net stoichiometric coefficient of 
\begin_inset Formula $\alpha$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2014"
literal "false"

\end_inset

) produces the constraint
\begin_inset Formula 
\begin{equation}
0=\divg\sum_{\iota}z^{\iota}\mathbf{j}^{\iota}\,,\label{eq:Current-Density-Constraint}
\end{equation}

\end_inset

or equivalently 
\begin_inset Formula $\divg\mathbf{I}_{e}=0$
\end_inset

, where 
\begin_inset Formula $\mathbf{I}_{e}=F_{c}\sum_{\iota}z^{\iota}\mathbf{j}^{\iota}$
\end_inset

 is the electric current density.
\end_layout

\begin_layout Standard
In the CFD-solutes implementation the fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

, fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

, and effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 are the nodal degrees of freedom 
\begin_inset Formula $\left(\mathbf{v}^{f},e^{f},\tilde{c}^{\iota}\right)$
\end_inset

, as further addressed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Solutes-Jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 These choices imply that 
\begin_inset Formula $\mathbf{\mathbf{v}}^{f}$
\end_inset

, 
\begin_inset Formula $e^{f}$
\end_inset

, and 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 are continuous across finite element boundaries, as justified below when
 we review jump conditions across interfaces.
 Note that in the absence of solutes, the governing equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mix-Mass-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 simplify to the original CFD equations, with 
\begin_inset Formula $p=\tilde{p}$
\end_inset

.
 More information on calculating the supply terms 
\begin_inset Formula $\hat{c}^{\iota}$
\end_inset

 and 
\begin_inset Formula $\hat{\rho}^{\iota}$
\end_inset

 can be found in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Salt-Dissociation-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The electric potential 
\begin_inset Formula $\psi$
\end_inset

 can be determined as described in the previous standard multiphasic solver
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2013,Ateshian2014"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Jump Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Solutes-Jump"

\end_inset


\end_layout

\begin_layout Standard
Jump conditions on the axioms of mass, momentum and energy balance are needed
 to determine which variables may be selected as nodal degrees of freedom
 in the finite element implementation, and which tractions are naturally
 continuous across an interface.
 The jump conditions for the CFD-solutes material were determined from the
 jump conditions of the general hybrid multiphasic material 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

.
 Here, we summarize the relevant results, which apply to any interface 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 Here, since the domain is fixed in space, the interface 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 is stationary.
 We employ the notation 
\begin_inset Formula $\left[\left[f\right]\right]=f_{+}-f_{-}$
\end_inset

 to denote the jump in an arbitrary function 
\begin_inset Formula $f$
\end_inset

 across the interface 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, with 
\begin_inset Formula $f_{+}$
\end_inset

 and 
\begin_inset Formula $f_{-}$
\end_inset

 denoting the values of 
\begin_inset Formula $f$
\end_inset

 on either side of 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 The unit normal on 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 is 
\series bold

\begin_inset Formula $\mathbf{n}$
\end_inset


\series default
, which points away from the 
\begin_inset Formula $+$
\end_inset

 side.
 A variable 
\begin_inset Formula $f$
\end_inset

 which is continuous across 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 satisfies 
\begin_inset Formula $\left[\left[f\right]\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
Based on the jump condition on the axiom of mass balance for the fluid,
 the normal component of the mass flux of the fluid is continuous across
 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, 
\begin_inset Formula $\left[\left[\rho^{f}\mathbf{v}^{f}\right]\right]\cdot\mathbf{n}=0$
\end_inset

.
 Furthermore, a sufficient condition to satisfy the jump on the axiom of
 energy balance is to enforce continuity of the solvent specific free enthalpy
 (or Gibbs function), such that 
\begin_inset Formula $\left[\left[\psi^{f}+p/\rho_{T}^{f}\right]\right]=\left[\left[\mu^{f}\right]\right]=0$
\end_inset

, where 
\begin_inset Formula $\psi^{f}$
\end_inset

 is the fluid specific free energy.
 In the multiphasic mixture literature, the solvent specific free enthalpy
 
\begin_inset Formula $\mu^{f}$
\end_inset

 is also called the mechano-chemical potential 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian16"
literal "false"

\end_inset

.
 This jump condition applies only when there is solvent on both sides of
 the interface, such as across 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 In an isothermal framework, the solvent mechano-chemical potential is a
 function of state that only depends on 
\begin_inset Formula $J^{f}$
\end_inset

 such that 
\begin_inset Formula $\mu^{f}=\mu^{f}\left(J^{f}\right)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim22a"
literal "false"

\end_inset

.
 Therefore this energy jump condition implies that 
\begin_inset Formula $J^{f}$
\end_inset

 must be continuous across 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\left[\left[J^{f}\right]\right]=0\,,\label{eq:J-Jump-CFDSol}
\end{equation}

\end_inset

also implying that 
\begin_inset Formula $\left[\left[\tilde{p}\right]\right]=0$
\end_inset

.
 Given 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Dil-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it follows that 
\begin_inset Formula $\left[\left[\rho^{f}\right]\right]=0$
\end_inset

 and the fluid mass balance jump condition reduces to 
\begin_inset Formula $\left[\left[\mathbf{v}^{f}\right]\right]\cdot\mathbf{n}=0$
\end_inset

, implying that the fluid velocity component normal to 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 must be continuous.
 For the tangential component of 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 on 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 we use the no-slip condition for viscous fluids, which states that the
 velocity component tangential to 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 must be continuous across that interface, as is standard in CFD solvers.
 Combining these two jump conditions produces
\begin_inset Formula 
\begin{equation}
\left[\left[\mathbf{v}^{f}\right]\right]=0\,.\label{eq:Mass-Jump-Final-CFDSol}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
From the solute mass jump condition, we can show that the normal component
 of the molar solute flux is continuous across 
\begin_inset Formula $\Gamma^{f}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\left[\left[\mathbf{j}^{\iota}\right]\right]\cdot\mathbf{n}=0\,.\label{eq:Mass-Jump-Sol-CFDSol}
\end{equation}

\end_inset

The momentum jump condition requires that the mixture traction be continuous
 across 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, thus 
\begin_inset Formula $\left[\left[-p\mathbf{I}+\boldsymbol{\tau}\right]\right]\cdot\mathbf{n}=\mathbf{0}$
\end_inset

.
 Another relation which is thermodynamically sufficient to satisfy the jump
 condition on the energy balance is the continuity of the viscous fluid
 traction,
\begin_inset Formula 
\begin{equation}
\left[\left[\boldsymbol{\tau}\right]\right]\cdot\mathbf{n}=0\,.\label{eq:Fluid-Mtm-Jump-CFDSol}
\end{equation}

\end_inset

This jump condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, which also applies only if fluid is present on both sides of 
\begin_inset Formula $\Gamma$
\end_inset

, implies that 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
Finally, the last relation that is thermodynamically sufficient to satisfy
 the energy balance jump condition applies to the electrochemical potential
 for the solutes, where 
\begin_inset Formula $\left[\left[\tilde{\mu}^{\iota}\right]\right]=0$
\end_inset

.
 For a solute, the general constitutive relation for the electrochemical
 potential is 
\begin_inset Formula $\tilde{\mu}^{\iota}=\frac{R\theta}{M^{\iota}}\ln\frac{c^{\iota}}{\tilde{\kappa}^{\alpha}c_{0}^{\iota}}$
\end_inset

, and the jump can be simplified to 
\begin_inset Formula 
\begin{equation}
\left[\left[\tilde{c}^{\iota}\right]\right]=0\,.\label{eq:Conc-Jump-CFDSol}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Thus, letting 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

, 
\begin_inset Formula $e^{f}$
\end_inset

, and 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 be nodal degrees of freedom automatically enforces the jump conditions
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:J-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Jump-Final-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Conc-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, acting as essential boundary conditions.
 As stated earlier, the jump conditions are the same as the previous CFD
 formulation in the case of zero solute concentration (all 
\begin_inset Formula $\tilde{c}^{\iota}=0$
\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"
literal "false"

\end_inset

.
\end_layout

\begin_layout Chapter
The Nonlinear FE Method
\begin_inset CommandInset label
LatexCommand label
name "chap:Nonlinear-FE-Method"

\end_inset


\end_layout

\begin_layout Standard
This chapter discusses the basic principles of the nonlinear finite element
 method.
 The chapter begins with a short introduction to the weak formulation and
 the principle of virtual work.
 Next, the important concept of linearization is discussed and applied to
 the principle of virtual work.
 Finally the Newton-Raphson procedure and its application to the nonlinear
 finite element method are described.
\end_layout

\begin_layout Section
Weak formulation for Solid Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Solid-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
Generally, the finite element formulation is established in terms of a weak
 form of the differential equations under consideration.
 In the context of solid mechanics this implies the use of the virtual work
 equation: 
\begin_inset Formula 
\begin{equation}
\delta W=\int\limits _{v}\boldsymbol{\sigma}:\delta\mathbf{d}\,dv-\int\limits _{v}\mathbf{f}\cdot\delta\mathbf{v}\,dv-\int\limits _{\partial v}\mathbf{t}\cdot\delta\mathbf{v}\,da=0\,.\label{eq171}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is a virtual velocity and 
\begin_inset Formula $\delta\mathbf{d}$
\end_inset

 is the virtual rate of deformation tensor.
 This equation is known as the 
\emph on
spatial virtual work equation 
\emph default
since it is formulated using spatial quantities only.
 We can also define the 
\emph on
material virtual work equation 
\emph default
by expressing the principle of virtual work using only material quantities.
 
\begin_inset Formula 
\begin{equation}
\delta W=\int\limits _{V}\mathbf{S}:\delta\mathbf{\dot{E}}\,dV-\int\limits _{V}\mathbf{f}_{0}\cdot\delta\mathbf{v}\,dV-\int\limits _{\partial V}\mathbf{t}_{0}\cdot\delta\mathbf{v}\,dA=0\,.\label{eq172}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{f}_{0}=J\mathbf{f}$
\end_inset

 is the body force per unit undeformed volume and 
\begin_inset Formula $\mathbf{t}_{0}=\mathbf{t}\left(da/dA\right)$
\end_inset

 is the traction vector per unit initial area.
\end_layout

\begin_layout Subsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-linearization"

\end_inset


\end_layout

\begin_layout Standard
Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq171"

\end_inset

 is the starting point for the nonlinear finite element method.
 It is highly nonlinear and any method attempting to solve this equation,
 such as the Newton-Raphson method, necessarily has to be iterative.
\end_layout

\begin_layout Standard
To linearize the finite element equations, the directional derivative of
 the virtual work in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq171"

\end_inset

 must be calculated.
 In an iterative procedure, the quantity 
\begin_inset Formula $\boldsymbol{\phi}$
\end_inset

 will be approximated by a trial solution 
\begin_inset Formula $\boldsymbol{\phi}_{k}$
\end_inset

.
 Linearization of the virtual work equation around this trial solution gives
 
\begin_inset Formula 
\begin{equation}
\delta W\left(\boldsymbol{\phi}_{k},\delta\mathbf{v}\right)+D\delta W\left(\boldsymbol{\phi}_{k},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=0\,.\label{eq173}
\end{equation}

\end_inset

The directional derivative of the virtual work will eventually lead to the
 definition of the stiffness matrix.
 In order to proceed, it is convenient to split the virtual work into an
 internal and external virtual work component: 
\begin_inset Formula 
\begin{equation}
D\delta W\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=D\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]-D\delta W_{ext}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right],\label{eq174}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)=\int\limits _{v}\boldsymbol{\sigma}:\delta\mathbf{d}\,dv\,,\label{eq175}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\delta W_{ext}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)=\int\limits _{v}\mathbf{f}\cdot\delta\mathbf{v}\,dv+\int\limits _{\partial v}\mathbf{t}\cdot\delta\mathbf{v}\,da\,.\label{eq176}
\end{equation}

\end_inset

The result is listed here without details of the derivation – see 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

 for details.
 The linearization of the internal virtual work is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{int}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\int\limits _{v}\delta\mathbf{d}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,dv+\int\limits _{v}\boldsymbol{\sigma}:\left[\left(\nabla\mathbf{u}\right)^{T}\cdot\nabla\delta\mathbf{v}\right]\,dv\,.\label{eq177}
\end{equation}

\end_inset

Notice that this equation is symmetric in 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 This symmetry will, upon discretization, yield a symmetric tangent matrix.
\end_layout

\begin_layout Standard
The external virtual work has contributions from both body forces and surface
 tractions.
 The precise form of the linearized external virtual work depends on the
 form of these forces.
 For surface tractions, normal pressure forces may be represented in FEBio.
 The linearized external work for this type of traction is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{ext}^{p}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right] & =\frac{1}{2}\int\limits _{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\xi}\cdot\left[\left(\frac{\partial\mathbf{u}}{\partial\eta}\times\delta\mathbf{v}\right)+\left(\frac{\partial\delta\mathbf{v}}{\partial\eta}\times\mathbf{u}\right)\right]d\xi\,d\eta\\
 & -\frac{1}{2}\int\limits _{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\eta}\cdot\left[\left(\frac{\partial\mathbf{u}}{\partial\xi}\times\delta\mathbf{v}\right)+\left(\frac{\partial\delta\mathbf{v}}{\partial\xi}\times\mathbf{u}\right)\right]d\xi\,d\eta\,.
\end{aligned}
\label{eq178}
\end{equation}

\end_inset

Discretization of this equation will also lead to a symmetric component
 of the tangent matrix.
\end_layout

\begin_layout Standard
FEBio currently supports gravity as a body force, 
\begin_inset Formula $\mathbf{f}=\rho\mathbf{g}$
\end_inset

.
 Since this force is independent of the geometry, the contribution to the
 linearized external work is zero.
 Another type of body force implemented in FEBio is the centrifugal force.
 For a body rotating with a constant angular speed 
\begin_inset Formula $\omega$
\end_inset

, about an axis passing through the point 
\begin_inset Formula $\mathbf{c}$
\end_inset

 and directed along the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

, the body force is given by 
\begin_inset Formula $\mathbf{f}=\rho\omega^{2}\mathbf{r}$
\end_inset

, where 
\begin_inset Formula $\mathbf{r}$
\end_inset

 is the vector distance from a point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 to the axis of rotation, 
\begin_inset Formula 
\begin{equation}
\mathbf{r}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\left(\mathbf{x}-\mathbf{c}\right)\,.\label{eq179}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigCentrifugalBodyForce.png

\end_inset


\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The resulting linearized external work is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{ext}^{f}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\int\limits _{v}\rho\omega^{2}\delta\mathbf{v}\cdot\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{u}\,dv,\label{eq180}
\end{equation}

\end_inset

which produces a symmetric expression that will yield a symmetric matrix.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-discretization"

\end_inset


\end_layout

\begin_layout Standard
The basis of the finite element method is that the domain of the problem
 (that is, the volume of the object under consideration) is divided into
 smaller subunits, called 
\emph on
finite elements
\emph default
.
 In the case of 
\emph on
isoparametric elements 
\emph default
it is further assumed that each element has a local coordinate system, named
 the 
\emph on
natural coordinates
\emph default
, and the coordinates and shape of the element are discretized using the
 same functions.
 The discretization process is established by interpolating the geometry
 in terms of the coordinates 
\begin_inset Formula $\mathbf{X}_{a}$
\end_inset

 of the 
\emph on
nodes
\emph default
 that define the geometry of a finite element, and the 
\emph on
shape functions
\emph default
: 
\begin_inset Formula 
\begin{equation}
\mathbf{X}=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{1},\xi_{2},\xi_{3}\right)\mathbf{X}_{a}\,,\label{eq181}
\end{equation}

\end_inset

where 
\begin_inset Formula $n$
\end_inset

 is the number of nodes and 
\begin_inset Formula $\xi_{i}$
\end_inset

 are the natural coordinates.
 Similarly, the motion is described in terms of the current position 
\begin_inset Formula $\mathbf{x}_{a}\left(t\right)$
\end_inset

 of the 
\emph on
same
\emph default
 particles: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(t\right)=\sum\limits _{a=1}^{n}N_{a}\mathbf{x}_{a}\left(t\right)\,.\label{eq182}
\end{equation}

\end_inset

Quantities such as displacement, velocity and virtual velocity can be discretize
d in a similar way.
\end_layout

\begin_layout Standard
In deriving the discretized equilibrium equations, the integrations performed
 over the entire volume can be written as a sum of integrations constrained
 to the volume of an element.
 For this reason, the discretized equations are defined in terms of integrations
 over a particular element 
\begin_inset Formula $e$
\end_inset

.
 The discretized equilibrium equations for this particular element per node
 is given by 
\begin_inset Formula 
\begin{equation}
\delta W^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}\right)=\delta\mathbf{v}_{a}\cdot\left(\mathbf{T}_{a}^{\left(e\right)}-\mathbf{F}_{a}^{\left(e\right)}\right)\,,\label{eq183}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}T_{a}^{\left(e\right)} & =\int\limits _{v^{\left(e\right)}}\boldsymbol{\sigma}\cdot\nabla N_{a}\,dv\,,\\
F_{a}^{\left(e\right)} & =\int\limits _{v^{\left(e\right)}}N_{a}\mathbf{f}\,dv+\int\limits _{\partial v^{\left(e\right)}}N_{a}\mathbf{t}\,da\,.
\end{aligned}
\label{eq184}
\end{equation}

\end_inset

The linearization of the internal virtual work can be split into a 
\emph on
material
\emph default
 and an 
\emph on
initial stress
\emph default
 component 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right] & =\int\limits _{v^{\left(e\right)}}\delta\mathbf{d}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,dv+\int\limits _{v^{\left(e\right)}}\boldsymbol{\sigma}:\left[\left(\nabla\mathbf{u}\right)^{T}\cdot\nabla\delta\mathbf{v}\right]\,dv\\
 & =D\delta W_{c}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]+D\delta W_{\sigma}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]\,.
\end{aligned}
\label{eq185}
\end{equation}

\end_inset

The constitutive component can be discretized as follows: 
\begin_inset Formula 
\begin{equation}
D\delta W_{c}^{\left(e\right)}\left(\boldsymbol{\phi},\delta\mathbf{v}\right)\left[\mathbf{u}\right]=\delta\mathbf{v}_{a}\cdot\left(\int\limits _{v^{\left(e\right)}}\mathbf{B}_{a}^{T}\mathbf{D}\mathbf{B}_{b}\,dv\right)\mathbf{u}_{b}\,.\label{eq186}
\end{equation}

\end_inset

The term in parentheses defines the constitutive component of the tangent
 matrix relating node 
\begin_inset Formula $a$
\end_inset

to node 
\begin_inset Formula $b$
\end_inset

in element 
\begin_inset Formula $e$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{c,ab}^{\left(e\right)}=\int\limits _{v^{\left(e\right)}}\mathbf{B}_{a}^{T}\mathbf{DB}_{b}\,dv\,.\label{eq187}
\end{equation}

\end_inset

Here, the linear strain-displacement matrix 
\series bold

\begin_inset Formula $\mathbf{B}$
\end_inset


\series default
 relates the displacements to the small-strain tensor in Voigt Notation:
 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\varepsilon}=\sum\limits _{a=1}^{n}\mathbf{B}_{a}\mathbf{u}_{a}\,.\label{eq188}
\end{equation}

\end_inset

Or, written out completely, 
\begin_inset Formula 
\begin{equation}
\mathbf{B}_{a}=\left[\begin{array}{ccc}
\partial N_{a}/\partial x & 0 & 0\\
0 & \partial N_{a}/\partial y & 0\\
0 & 0 & \partial N_{a}/\partial z\\
\partial N_{a}/\partial y & \partial N_{a}/\partial x & 0\\
0 & \partial N_{a}/\partial z & \partial N_{a}/\partial y\\
\partial N_{a}/\partial z & 0 & \partial N_{a}/\partial z
\end{array}\right]\,.\label{eq189}
\end{equation}

\end_inset

The spatial constitutive matrix 
\series bold

\begin_inset Formula $\mathbf{D}$
\end_inset

 
\series default
is constructed from the components of the fourth-order tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 using the following table; 
\begin_inset Formula $D_{IJ}=\mathcal{C}_{ijkl}$
\end_inset

where
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
I/J
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
i/k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
j/l
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The initial stress component can be written as follows: 
\begin_inset Formula 
\begin{equation}
D\delta W_{\sigma}^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}\right)\left[N_{b}\mathbf{u}_{b}\right]=\int\limits _{v^{\left(e\right)}}\left(\nabla N_{a}\cdot\boldsymbol{\sigma}\cdot\nabla N_{b}\right)\mathbf{I}\,dv.\label{eq190}
\end{equation}

\end_inset

For the pressure component of the external virtual work, we find 
\begin_inset Formula 
\begin{equation}
D\delta W_{p}^{\left(e\right)}\left(\boldsymbol{\phi},N_{a}\delta\mathbf{v}_{a}\right)\left[N_{b}\mathbf{u}_{b}\right]=\delta\mathbf{v}_{a}\cdot\mathbf{K}_{p,ab}^{\left(e\right)}\cdot\mathbf{u}_{b}\,,\label{eq191}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{p,ab}^{\left(e\right)} & =\mathcal{E}\mathbf{k}_{p,ab}^{\left(e\right)},\\
\mathbf{k}_{p,ab}^{\left(e\right)} & =\frac{1}{2}\int_{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\xi}\left(\frac{\partial N_{a}}{\partial\eta}N_{b}-\frac{\partial N_{b}}{\partial\eta}N_{a}\right)d\xi\,d\eta\\
 & +\frac{1}{2}\int_{A_{\xi}}p\frac{\partial\mathbf{x}}{\partial\eta}\left(\frac{\partial N_{a}}{\partial\xi}N_{b}-\frac{\partial N_{b}}{\partial\xi}N_{a}\right)d\xi\,d\eta\,.
\end{aligned}
\label{eq192}
\end{equation}

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Weak formulation for biphasic materials
\begin_inset CommandInset label
LatexCommand label
name "sec:sec:Biphasic-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
A weak form of the statement conservation of linear momemtum for the quasi-stati
c case is obtained by using Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq103"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq105"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\delta W=\int_{b}\left[\delta\mathbf{v}^{s}\cdot\left(\divg\boldsymbol{\sigma}+\rho\mathbf{b}\right)+\delta p\,\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\right]dv=0\,,\label{eq193}
\end{equation}

\end_inset

where 
\begin_inset Formula $b$
\end_inset

 is the domain of interest defined on the solid matrix, 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

 is a virtual velocity of the solid and 
\begin_inset Formula $\delta p$
\end_inset

 is a virtual pressure of the fluid 
\begin_inset CommandInset citation
LatexCommand citep
key "Un06"
literal "true"

\end_inset

.
 
\begin_inset Formula $dv$
\end_inset

 is an elemental volume of 
\begin_inset Formula $b$
\end_inset

.
 Using the divergence theorem, this expression may be rearranged as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}\,da+\int_{\partial b}\delta p\,w_{n}\,da+\int_{b}\delta\mathbf{v}^{s}\cdot\rho\mathbf{b}\,dv\\
 & -\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}^{s}\,dv-\int_{b}\left(\mathbf{w}\cdot\grad\delta p-\delta p\,\divg\mathbf{v}^{s}\right)\,dv
\end{aligned}
\,,\label{eq194}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{d}^{s}=\left(\grad\delta\mathbf{v}^{s}+\grad^{T}\delta\mathbf{v}^{s}\right)/2$
\end_inset

 is the virtual rate of deformation tensor, 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 is the total traction on the surface 
\begin_inset Formula $\partial b$
\end_inset

, and 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 is the component of the fluid flux normal to 
\begin_inset Formula $\partial b$
\end_inset

, with 
\begin_inset Formula $\mathbf{n}$
\end_inset

 representing the unit outward normal to 
\begin_inset Formula $\partial b$
\end_inset

.
 
\begin_inset Formula $da$
\end_inset

 represents an elemental area of 
\begin_inset Formula $\partial b$
\end_inset

.
 In this type of problem, essential boundary conditions are prescribed for
 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

, and natural boundary conditions are prescribed for 
\begin_inset Formula $\mathbf{t}$
\end_inset

 and 
\begin_inset Formula $w_{n}$
\end_inset

.
 In the expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq194"

\end_inset

, 
\begin_inset Formula $\delta W\left(\boldsymbol{\chi}^{s},p,\delta\mathbf{v}^{s},\delta p\right)$
\end_inset

 represents the virtual work.
\end_layout

\begin_layout Subsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-linearization"

\end_inset


\end_layout

\begin_layout Standard
Since the system of equations in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq194"

\end_inset

 is highly nonlinear, its solution requires an iterative scheme such as
 Newton's method.
 This requires the linearization of 
\begin_inset Formula $\delta W$
\end_inset

 at some trial solution 
\begin_inset Formula $\left(\boldsymbol{\chi}_{k}^{s},p_{k}\right)$
\end_inset

, along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 in 
\begin_inset Formula $\boldsymbol{\chi}^{s}$
\end_inset

 and an increment 
\begin_inset Formula $\Delta p$
\end_inset

 in 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta p\right]=0,\label{eq195}
\end{equation}

\end_inset

where 
\begin_inset Formula $Df\left[\Delta q\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $f$
\end_inset

 along 
\begin_inset Formula $\Delta q$
\end_inset

.
 For convenience, the virtual work may be separated into its internal and
 external parts, 
\begin_inset Formula 
\begin{equation}
\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}},\label{eq196}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta W_{\mbox{int}}=\int_{b}\boldsymbol{\sigma}:\delta\mathbf{d}^{s}\,dv+\int_{b}\left(\mathbf{w}\cdot\grad\delta p-\delta p\,\frac{\dot{J}}{J}\right)\,dv,\label{eq197}
\end{equation}

\end_inset

where we have substituted 
\begin_inset Formula $\divg\mathbf{v}^{s}=\dot{J}/J$
\end_inset

, and 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}\,da+\int_{\partial b}\delta p\,w_{n}\,da+\int_{b}\delta\mathbf{v}^{s}\cdot\rho\mathbf{b}\,dv\,.\label{eq198}
\end{equation}

\end_inset

The evaluation of the directional derivatives can be performed following
 a standard approach 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 In particular, a backward difference scheme is used to evaluate 
\begin_inset Formula $\dot{J}\approx\left(J-J^{-\Delta t}\right)/\Delta t$
\end_inset

, where 
\begin_inset Formula $J^{-\Delta t}$
\end_inset

 is the value of 
\begin_inset Formula $J$
\end_inset

 at the previous time step.
 For the internal part of the virtual work, the directional derivative along
 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}\,dv+\int_{b}\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}^{s}\right)\,dv\\
 & -\int_{b}\frac{\delta p}{\Delta t}\divg\Delta\mathbf{u}\,dv\\
 & -\int_{b}\grad\delta p\cdot\left(\boldsymbol{\mathcal{K}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad p-\rho_{T}^{w}\mathbf{b}^{w}\right)\,dv\\
 & +\int_{b}\grad\delta p\cdot\mathbf{k}\cdot\rho_{T}^{w}\left(\grad^{T}\Delta\mathbf{u}\cdot\mathbf{b}^{w}+\grad\mathbf{b}^{w}\cdot\Delta\mathbf{u}\right)dv\,,
\end{aligned}
\label{eq199}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order spatial elasticity tensor for the mixture and 
\begin_inset Formula $\Delta\boldsymbol{\varepsilon}=\left(\grad\Delta\mathbf{u}+\grad^{T}\Delta\mathbf{u}\right)/2$
\end_inset

.
 Based on the relation of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq104"

\end_inset

, the spatial elasticity tensor may also be expanded as 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}+p\left(-\mathbf{I}\otimes\mathbf{I}+2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right),\label{eq200}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor for the solid matrix 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"
literal "true"

\end_inset

.
 It is related to the material elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathbb{C}}^{e}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):\boldsymbol{\mathbb{C}}^{e}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right),\label{eq201}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the solid matrix, 
\begin_inset Formula $\boldsymbol{\mathbb{C}}^{e}=\partial\mathbf{S}^{e}/\partial\mathbf{E}$
\end_inset

 where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is the Lagrangian strain tensor and 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the second Piola-Kirchhoff stress tensor, related to the Cauchy stress
 tensor via 
\begin_inset Formula $\boldsymbol{\sigma}^{e}=J^{-1}\mathbf{F}\cdot\mathbf{S}^{e}\cdot\mathbf{F}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
Similarly, 
\begin_inset Formula $\boldsymbol{\mathcal{K}}$
\end_inset

 is a fourth-order tensor that represents the spatial measure of the rate
 of change of permeability with strain.
 It is related to its material frame equivalent 
\begin_inset Formula $\boldsymbol{\mathbb{K}}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):\boldsymbol{\mathbb{K}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right),\label{eq202}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbb{K}}=\partial\mathbf{K}/\partial\mathbf{E}$
\end_inset

 and 
\begin_inset Formula $\mathbf{K}$
\end_inset

 is the permeability tensor in the material frame, such that 
\begin_inset Formula $\mathbf{k}=J^{-1}\mathbf{F}\cdot\mathbf{K}\cdot\mathbf{F}^{T}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{K}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}$
\end_inset

 are symmetric tensors, it follows that 
\begin_inset Formula $\boldsymbol{\mathcal{K}}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathbb{K}}$
\end_inset

 exhibit two minor symmetries (e.g., 
\begin_inset Formula $\mathcal{K}_{jikl}=\mathcal{K}_{ijkl}$
\end_inset

 and 
\begin_inset Formula $\mathcal{K}_{ijlk}=\mathcal{K}_{ijkl})$
\end_inset

.
 However, unlike the elasticity tensor, it is not necessary that these tensors
 exhibit major symmetry (e.g., 
\begin_inset Formula $\mathcal{K}_{klij}\ne\mathcal{K}_{ijkl}$
\end_inset

 in general).
\end_layout

\begin_layout Standard
The directional derivative of 
\begin_inset Formula $\delta W_{\mbox{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta p$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}\left[\Delta p\right]=-\int_{b}\grad\delta p\cdot\mathbf{k}\cdot\grad\Delta p\,dv-\int_{b}\Delta p\,\divg\delta\mathbf{v}^{s}\,dv\,.\label{eq203}
\end{equation}

\end_inset

Note that letting 
\begin_inset Formula $p=0$
\end_inset

 and 
\begin_inset Formula $\delta p=0$
\end_inset

 in the above equations recovers the virtual work relations for nonlinear
 elasticity of compressible solids.
 The resulting simplified equation emerging from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 is symmetric to interchanges of 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

, producing a symmetric stiffness matrix in the finite element formulation
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 However, the general relations of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq203"

\end_inset

 do not exhibit symmetry to interchanges of 
\begin_inset Formula $\left(\Delta\mathbf{u},\Delta p\right)$
\end_inset

 and 
\begin_inset Formula $\left(\delta\mathbf{v}^{s},\delta p\right)$
\end_inset

, implying that the finite element stiffness matrix for a solid-fluid mixture
 is not symmetric under general conditions.
\end_layout

\begin_layout Standard
The directional derivatives of the external virtual work 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 depend on the type of boundary conditions being considered.
 For a prescribed total normal traction 
\begin_inset Formula $t_{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{t}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot t_{n}\mathbf{n}\,da,\label{eq204}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{t}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot t_{n}\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{t}\left[\Delta p\right] & =0,
\end{aligned}
\label{eq205}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\alpha=1,2\label{eq206}
\end{equation}

\end_inset

are covariant basis (tangent) vectors on 
\begin_inset Formula $\partial b$
\end_inset

, such that 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq207}
\end{equation}

\end_inset

For a prescribed normal effective traction 
\begin_inset Formula $t_{n}^{e}$
\end_inset

, where 
\begin_inset Formula $\mathbf{t}=\left(-p+t_{n}^{e}\right)\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 is not prescribed, then 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{e}=\int_{\partial b}\delta\mathbf{v}^{s}\cdot\left(-p+t_{n}^{e}\right)\mathbf{n}\,da\,,\label{eq208}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{e}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot\left(-p+t_{n}^{e}\right)\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{e}\left[\Delta p\right] & =-\int_{\partial b}\delta\mathbf{v}^{s}\cdot\Delta p\,\mathbf{n}\,da\,.
\end{aligned}
\label{eq209}
\end{equation}

\end_inset

For a prescribed normal fluid flux 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}^{w}=\int_{\partial b}\delta p\,w_{n}\,da\,,\label{eq210}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{\text{ext}}^{w}\left[\Delta\mathbf{u}\right] & =\int_{\partial b}\delta p\,w_{n}\,\mathbf{n}\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\frac{da}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\\
D\delta W_{\text{ext}}^{w}\left[\Delta p\right] & =0\,.
\end{aligned}
\label{eq211}
\end{equation}

\end_inset

Finally, for a prescribed external body force, recognizing that 
\begin_inset Formula $\rho\mathbf{b}=\rho^{s}\mathbf{b}^{s}+\rho^{w}\mathbf{b}^{w}$
\end_inset

 and assuming that the body forces 
\begin_inset Formula $\mathbf{b}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}^{w}$
\end_inset

 do not depend on 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{\text{ext}}^{b}\right)\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\mathbf{v}^{s}\cdot\left[\left(\rho^{s}grad\mathbf{b}^{s}+\rho^{w}grad\mathbf{b}^{w}\right)\cdot\Delta\mathbf{u}+\left(\divg\Delta\mathbf{u}\right)\rho_{T}^{w}\mathbf{b}^{w}\right]\,dv\,,\\
D\left(\delta W_{\text{ext}}^{b}\right)\left[\Delta p\right] & =0\,.
\end{aligned}
\label{eq212}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
Finite element models of deformable porous media are known to exhibit oscillatio
ns in fluid pressure caused by relatively coarse meshes near free-draining
 boundaries, where a boundary layer in fluid pressure normally forms during
 the early time response to loading.
 These spurious oscillations typically occur when the mesh is not able to
 resolve this boundary layer.
 Stabilization methods serve as an alternative to mesh refinement, when
 the latter is not feasible or practical.
 In FEBio we have implemented a stabilization method based on the work of
 Aguilar et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Aguilar08"
literal "false"

\end_inset

.
 Basically, this method proposes that the fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 be evaluated from
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\mathbf{k}\cdot\grad\left(p+\tau\dot{p}\right)\label{eq:stab-fluid-flux}
\end{equation}

\end_inset

instead of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq107"
plural "false"
caps "false"
noprefix "false"

\end_inset

, where 
\begin_inset Formula $\tau$
\end_inset

 represents the stabilization parameter.
 A representative value for 
\begin_inset Formula $\tau$
\end_inset

 may be evaluated from
\begin_inset Formula 
\begin{equation}
\tau\approx\frac{h^{2}}{E\cdot k}\,,\label{eq:stab-tau}
\end{equation}

\end_inset

where 
\begin_inset Formula $h$
\end_inset

 is the element thickness on the free-draining boundary, 
\begin_inset Formula $E$
\end_inset

 is a representative measure of the solid matrix elastic modulus and 
\begin_inset Formula $k$
\end_inset

 is a representative measure of the hydraulic permeability tensor 
\begin_inset Formula $\mathbf{k}$
\end_inset

.
 The contribution of this form of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 to the virtual work expression in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq194"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G & =\int_{b}\mathbf{w}\cdot\grad\delta p\,dv\\
 & =-\int_{b}\grad\delta p\cdot\mathbf{k}\cdot\grad\left(p+\tau\dot{p}\right)\,dv
\end{aligned}
\,.\label{eq:stab-virtual-work}
\end{equation}

\end_inset

The linearizations of 
\begin_inset Formula $\delta G$
\end_inset

 are then given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\mathbf{u}\right] & =-\int_{b}\grad\delta p\cdot\left(\boldsymbol{\mathcal{K}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\grad\left(p+\tau\dot{p}\right)\,dv\\
D\delta G\left[\Delta p\right] & =-\int_{b}\left(1+\frac{\tau}{\Delta t}\right)\grad\delta p\cdot\mathbf{k}\cdot\grad\Delta p\,dv
\end{aligned}
\,.\label{eq:stab-linearization}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-discretization"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{s} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \delta p & =\sum\limits _{a=1}^{m}N_{a}\delta p_{a}\,,\\
\Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,, & \Delta p & =\sum\limits _{b=1}^{m}N_{b}\Delta p_{b}\,,
\end{aligned}
\label{eq213}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a},\delta p_{a},\Delta\mathbf{u}_{b}\mbox{\thinspace and\thinspace}\Delta p_{b}$
\end_inset

 respectively represent nodal values of 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

, 
\begin_inset Formula $\delta p$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\Delta p$
\end_inset

, and 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
 Then the discretized form of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq197"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}
\end{array}\right]\,,\label{eq214}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\mbox{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the spatial frame to the parametric
 space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\mathbf{r}_{a}^{u}=\boldsymbol{\sigma}\cdot\nabla N_{a}\,,\quad r_{a}^{p}=\mathbf{w}\cdot\nabla N_{a}-N_{a}\mbox{div}\mathbf{v}^{s}\,,\label{eq215}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\mbox{int}}$
\end_inset

 in Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq199"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq203"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta p_{b}
\end{array}\right]\,,\label{eq216}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\nabla N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\nabla N_{b}+\left(\nabla N_{a}\cdot\boldsymbol{\sigma}\cdot\nabla N_{b}\right)\mathbf{I}\\
 & -N_{a}\left[N_{b}\left(\rho^{s}\nabla\mathbf{b}^{s}+\rho^{w}\nabla\mathbf{b}^{w}\right)+\rho_{T}^{w}\mathbf{b}^{w}\otimes\nabla N_{b}\right]\,,\\
\mathbf{k}_{ab}^{up} & =-N_{b}\nabla N_{a}\,,\\
\mathbf{k}_{ab}^{pu} & =-\left(\nabla N_{a}\cdot\boldsymbol{\mathcal{K}}\cdot\nabla N_{b}\right)\cdot\left(\nabla p-\rho_{T}^{w}\mathbf{b}^{w}\right)-\frac{1}{\Delta t}N_{a}\cdot\nabla N_{b}\\
 & +\rho_{T}^{w}\left(\mathbf{b}^{w}\otimes\nabla N_{b}+N_{b}\nabla^{T}\mathbf{b}^{w}\right)\cdot\mathbf{k}\cdot\nabla N_{a}\,,\\
k_{ab}^{pp} & =-\nabla N_{a}\cdot\mathbf{k}\cdot\nabla N_{b},
\end{aligned}
\label{eq217}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 is a discrete increment in time.
 In a numerical implementation, it has been found that evaluating 
\begin_inset Formula $\divg\mathbf{v}^{s}$
\end_inset

 from 
\begin_inset Formula $\dot{J}/J$
\end_inset

, where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, yields more accurate solutions than evaluating it from the trace of 
\begin_inset Formula $\grad\mathbf{v}^{s}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07c"
literal "true"

\end_inset

.
 Contributions from the stabilization method presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "subsec:Biphasic-Stabilization"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be similarly evaluated.
\end_layout

\begin_layout Standard
For the various types of contributions to the external virtual work, a similar
 discretization produces 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}
\end{array}\right]\,,\label{eq218}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{v}_{a} & \delta p_{a}\end{array}\right]\cdot\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta p_{b}
\end{array}\right]\,,\label{eq219}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,.\label{eq220}
\end{equation}

\end_inset

In this case, 
\begin_inset Formula $m$
\end_inset

 represents the number of nodes on an element face.
 For a prescribed normal traction 
\begin_inset Formula $t_{n}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq204"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq205"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =t_{n}N_{a}\mathbf{n}\,, & r_{a}^{u} & =0\,,\\
\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\frac{1}{J_{\eta}}\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =\mathbf{0}\,, & k_{ab}^{pp} & =0\,,
\end{aligned}
\label{eq221}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \mathbf{v}\right\} =-\boldsymbol{\mathbf{\mathcal{E}}}\cdot\mathbf{v}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathbf{\mathcal{E}}}$
\end_inset

 is the third-order permutation pseudo-tensor.
 For a prescribed traction 
\begin_inset Formula $t_{n}^{e}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq208"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq209"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\left(-p+t_{n}^{e}\right)N_{a}\mathbf{n}\,, & r_{a}^{u} & =0\,,\\
\mathbf{K}_{ab}^{uu} & =\left(-p+t_{n}^{e}\right)N_{a}\frac{1}{J_{\eta}}\boldsymbol{\mathbf{\mathcal{A}}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =\mathbf{0}\,, & k_{ab}^{pp} & =0\,.
\end{aligned}
\label{eq222}
\end{equation}

\end_inset

For a prescribed normal fluid flux 
\begin_inset Formula $w_{n}$
\end_inset

 as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq210"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq211"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\mathbf{0}\,, & r_{a}^{u} & =w_{n}N_{a}\,,\\
\mathbf{K}_{ab}^{uu} & =\mathbf{0}\,, & \mathbf{k}_{ab}^{up} & =\mathbf{0}\,,\\
\mathbf{k}_{ab}^{pu} & =w_{n}N_{a}\frac{1}{J_{\eta}}\mathbf{n}\times\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\,, & k_{ab}^{pp} & =0\,.
\end{aligned}
\label{eq223}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Weak Formulation for Biphasic-Solute Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:BS-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral for this problem is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{b}\delta\mathbf{v}\cdot\divg\boldsymbol{\sigma}\,dv+\int_{b}\delta\tilde{p}\,\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)\,dv\\
 & +\int_{b}\delta\tilde{c}\left[\frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\mathbf{j}+\phi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)\right]\,dv\,,
\end{aligned}
\label{eq224}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity of the solid, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

 is the virtual effective fluid pressure, and 
\begin_inset Formula $\delta\tilde{c}$
\end_inset

 is the virtual molar energy of the solute.
 
\begin_inset Formula $b$
\end_inset

 represents the mixture domain in the spatial frame and 
\begin_inset Formula $dv$
\end_inset

 is an elemental mixture volume in 
\begin_inset Formula $b$
\end_inset

.
 In the last integral of 
\begin_inset Formula $\delta W$
\end_inset

, note that 
\begin_inset Formula 
\begin{equation}
\frac{\partial\left(\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}+\divg\left(\varphi^{w}\tilde{\kappa}\tilde{c}\,\mathbf{v}^{s}\right)=\frac{1}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\,,\label{eq225}
\end{equation}

\end_inset

where 
\begin_inset Formula $D^{s}f/Dt\equiv\partial f/\partial t+\mathbf{v}^{s}\cdot\grad f$
\end_inset

 is the material time derivative of a scalar function 
\begin_inset Formula $f$
\end_inset

 in the spatial frame, following the solid.
 Similarly, note that 
\begin_inset Formula $\divg\mathbf{v}^{s}=J^{-1}\left(D^{s}J/Dt\right)$
\end_inset

.
 Using the divergence theorem, the virtual work integral may be separated
 into internal and external contributions, 
\begin_inset Formula $\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}}$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{\text{int}} & =\int_{b}\boldsymbol{\sigma}:\delta\mathbf{d}^{s}\,dv+\int_{b}\left(\mathbf{w}\cdot\grad\delta\tilde{p}-\frac{\delta\tilde{p}}{J}\frac{D^{s}J}{Dt}\right)\,dv\\
 & +\int_{b}\left[\mathbf{j}\cdot\grad\delta\tilde{c}-\frac{\delta\tilde{c}}{J}\frac{D^{s}}{Dt}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\right]dv\,,\\
\delta W_{\text{ext}} & =\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\delta\tilde{c}\,j_{n}\right)\,da\,,
\end{aligned}
\label{eq226}
\end{equation}

\end_inset

with 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 being evaluated on the domain's boundary surface 
\begin_inset Formula $\partial b$
\end_inset

.
 In the first expression 
\begin_inset Formula $\delta\mathbf{d}^{s}=\left(\grad\delta\mathbf{v}+\grad^{T}\delta\mathbf{v}\right)/2$
\end_inset

 represents the virtual solid rate of deformation.
\end_layout

\begin_layout Standard
To solve this nonlinear system using an iterative Newton scheme, the virtual
 work must be linearized at trial solutions, along increments in 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta\tilde{p}\right]+D\delta W\left[\Delta\tilde{c}\right]\approx0\,,\label{eq227}
\end{equation}

\end_inset

where, for any function 
\begin_inset Formula $f\left(q\right)$
\end_inset

, 
\begin_inset Formula $Df\left[\Delta q\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $f$
\end_inset

 along 
\begin_inset Formula $\Delta q$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 To operate the directional derivative on the integrand of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

, it is first necessary to convert the integrals from the spatial to the
 material domain 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\int_{B}\mathbf{S}:\delta\mathbf{\dot{E}}\,dV+\int_{B}\left(\mathbf{W}\cdot\grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\,dV+\int_{B}\left[\mathbf{J}\cdot\grad\delta\tilde{c}-\delta\tilde{c}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\right]dV\,,\label{eq228}
\end{equation}

\end_inset

where 
\begin_inset Formula $B$
\end_inset

 represents the mixture domain in the material frame, 
\begin_inset Formula $dV$
\end_inset

 is an elemental mixture volume in 
\begin_inset Formula $B$
\end_inset

, and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =J\,\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}\,,\\
\delta\mathbf{\dot{E}} & =\mathbf{F}^{T}\cdot\delta\mathbf{d}^{s}\cdot\mathbf{F}\,,\\
\mathbf{W} & =J\,\mathbf{F}^{-1}\cdot\mathbf{w}\,,\\
\mathbf{J} & =J\,\mathbf{F}^{-1}\cdot\mathbf{j}\,.
\end{aligned}
\label{eq229}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset

, and material flux vectors 
\begin_inset Formula $\mathbf{W}$
\end_inset

 and 
\begin_inset Formula $\mathbf{J}$
\end_inset

, are respectively related to 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

, 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}$
\end_inset

 by the Piola transformations for tensors and vectors 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97,Marsden94"
literal "true"

\end_inset

.
 Substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq229"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{W} & =-\mathbf{\tilde{K}}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}J^{-1}\mathbf{C}\cdot\mathbf{D}\cdot\grad\tilde{c}\right)\,,\\
\mathbf{J} & =\tilde{\kappa}\mathbf{D}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}J^{-1}\mathbf{C}\cdot\mathbf{W}\right)\,,
\end{aligned}
\label{eq230}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\tilde{K}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 are the material representations of the permeability and diffusivity tensors,
 related to 
\begin_inset Formula $\mathbf{\tilde{k}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{d}$
\end_inset

 via the Piola transformation, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{\tilde{K}} & =J\,\mathbf{F}^{-1}\cdot\mathbf{\tilde{k}}\cdot\mathbf{F}^{-T}\,,\\
\mathbf{D} & =J\,\mathbf{F}^{-1}\cdot\mathbf{d}\cdot\mathbf{F}^{-T}\,.
\end{aligned}
\label{eq231}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 is rather involved and a summary of the resulting lengthy expressions is
 provided below.
 In consideration of the dearth of experimental data relating 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 to the complete state of solid matrix strain (such as 
\begin_inset Formula $\mathbf{C})$
\end_inset

, this implementation assumes that the dependence of these functions on
 the strain is restricted to a dependence on the volume ratio 
\begin_inset Formula $J=\left(\det\mathbf{C}\right)^{1/2}$
\end_inset

.
 Furthermore, it is assumed that the free solution diffusivity 
\begin_inset Formula $d_{0}$
\end_inset

 is independent of the strain.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 is described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

.
 Following the linearization procedure, the resulting expressions may be
 discretized by nodally interpolating 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

 over finite elements, producing a set of equations in matrix form, as described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

.
\end_layout

\begin_layout Standard
The formulation presented in this study is implemented in FEBio by introducing
 an additional module dedicated to solute transport in deformable porous
 media.
 Classes are implemented to describe material functions for 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

, 
\begin_inset Formula $\mathbf{k}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

 (and 
\begin_inset Formula $d_{0})$
\end_inset

, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

, which allow the formulation of any desired constitutive relation for these
 functions of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, along with corresponding derivatives of these functions with respect to
 
\begin_inset Formula $\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

.
 The implementation accepts essential boundary conditions on 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, or natural boundary conditions on 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

; initial conditions may also be specified for 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

.
 Analysis results for pressure and concentration may be displayed either
 as 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}$
\end_inset

, or as 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 by inverting the relations of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq118"

\end_inset

.
\end_layout

\begin_layout Subsection
Linearization of Internal Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-linearization"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq228"

\end_inset

 may be linearized term by term along increments in 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 using the general form 
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}F\,dV\right)\left[\Delta q\right]=\int_{B}DF\left[\Delta q\right]\,dV=\int_{b}f\,dv\,.\label{eq232}
\end{equation}

\end_inset

For notational simplicity, the integral sign is omitted and the linearization
 of each term is presented in the form 
\begin_inset Formula $DF\left[\Delta q\right]\,dV=f\,dv$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{S}:\delta\dot{\mathbf{E}}\right)\left[\Delta\mathbf{u}\right]\,dV=\left[\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}+\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}\right)\right]\,dv\,,\label{eq233}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor of the mixture, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}-\left(\tilde{p}+R\theta\,\Phi\tilde{\kappa}\tilde{c}\right)\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-R\theta\tilde{c}\,J\frac{\partial\left(\Phi\tilde{\kappa}\right)}{\partial J}\mathbf{I}\otimes\mathbf{I}\,,\label{eq234}
\end{equation}

\end_inset

and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor of the solid matrix, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{S}^{e}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq235}
\end{equation}

\end_inset

The linearization of the second term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{u}^{\prime}\,dv\,,\label{eq236}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{u}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\mathbf{u}\right]=-\left(\tilde{\boldsymbol{\mathcal{K}}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -\frac{R\theta}{d_{0}}\tilde{\mathbf{k}}\cdot\left(J^{2}\frac{\partial\left(J^{-1}\tilde{\kappa}\right)}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{I}+2\tilde{\kappa}\,\Delta\boldsymbol{\varepsilon}\right)\cdot\mathbf{d}\cdot\grad\tilde{c}-\tilde{\kappa}\frac{R\theta}{d_{0}}\tilde{\mathbf{k}}\cdot\left(\boldsymbol{\mathcal{D}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\grad\tilde{c}\,,
\end{aligned}
\label{eq237}
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\boldsymbol{\mathcal{K}}} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\tilde{\mathbf{K}}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,\\
\boldsymbol{\mathcal{D}} & =J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{D}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,,
\end{aligned}
\label{eq238}
\end{equation}

\end_inset

representing the spatial tangents, with respect to the strain, of the effective
 permeability and solute diffusivity, respectively.
 These fourth-order tensors exhibit minor symmetries but not major symmetry,
 as described recently 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

.
 Since 
\begin_inset Formula $\tilde{\mathbf{K}}$
\end_inset

 is given by substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset


\begin_inset Formula $_{3}$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq231"

\end_inset


\begin_inset Formula $_{1}$
\end_inset

, the evaluation of 
\begin_inset Formula $\tilde{\boldsymbol{\mathcal{K}}}$
\end_inset

 is rather involved and it can be shown that 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{K}}}=2\left(\tilde{\mathbf{k}}\otimes\mathbf{I}-2\tilde{\mathbf{k}}\,\underline{\otimes}\,\mathbf{I}\right)-\left(\tilde{\mathbf{k}}\,\overline{\underline{\otimes}}\,\tilde{\mathbf{k}}\right):\boldsymbol{\mathcal{G}}\,,\label{eq239}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{G}} & =2\left(\mathbf{k}^{-1}\otimes\mathbf{I}-2\mathbf{k}^{-1}\,\overline{\underline{\otimes}}\,\mathbf{I}\right)-\left(\mathbf{k}^{-1}\,\underline{\otimes}\,\mathbf{k}^{-1}\right):\boldsymbol{\mathcal{K}}\\
 & +\frac{R\theta\tilde{c}}{d_{0}}J\frac{\partial}{\partial J}\left(\frac{\tilde{\kappa}}{\varphi^{w}}\right)\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\otimes\mathbf{I}\\
 & +\frac{R\theta\tilde{c}}{d_{0}}\frac{\tilde{\kappa}}{\varphi^{w}}\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\,\underline{\otimes}\,\mathbf{I}-\frac{1}{d_{0}}\boldsymbol{\mathcal{D}}\right)
\end{aligned}
\label{eq240}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):2\frac{\partial\mathbf{K}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)\,.\label{eq241}
\end{equation}

\end_inset

The next term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 linearizes to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=-\delta\tilde{p}\frac{1}{\Delta t}\divg\Delta\mathbf{u}\,dv\,,\label{eq242}
\end{equation}

\end_inset

where we used a backward difference scheme to approximate the time derivative,
 
\begin_inset Formula 
\begin{equation}
\frac{\partial J}{\partial t}\approx\frac{1}{\Delta t}\left(J-J^{-\Delta t}\right)\,,\label{eq243}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 represents the time increment relative to the previous time point.
 The next term is given by 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{c}\cdot\mathbf{j}_{u}^{\prime}\,dv,\label{eq244}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{u}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\mathbf{u}\right]=\left(J\frac{\partial\tilde{\kappa}}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{d}+\tilde{\kappa}\boldsymbol{\mathcal{D}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\\
 & +\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\left(2\Delta\boldsymbol{\varepsilon}-\left(\divg\Delta\mathbf{u}\right)\mathbf{I}\right)\cdot\mathbf{w}\right)+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{u}^{\prime}
\end{aligned}
\,.\label{eq245}
\end{equation}

\end_inset

Using a backward difference scheme for the time derivative, the last term
 is 
\begin_inset Formula 
\begin{equation}
D\left(\delta\tilde{c}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=\frac{\delta\tilde{c}}{\Delta t}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\right)}{\partial J}\tilde{c}\divg\Delta\mathbf{u}\,dv\,.\label{eq246}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the various terms in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{p}\right]\,dV=-\Delta\tilde{p}\,\divg\delta\mathbf{v}\,dv\,,\label{eq247}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\grad\delta\tilde{p}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,,\label{eq248}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}-\delta\tilde{c}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\grad\delta\tilde{c}\cdot\mathbf{d}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,.\label{eq249}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{c}\right]\,dV=\Delta\tilde{c}\left(\boldsymbol{\sigma}_{c}^{\prime}:\delta\mathbf{d}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\divg\delta\mathbf{v}\right)\,dv\,,\label{eq250}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{S}^{e}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq251}
\end{equation}

\end_inset

represents the spatial tangent of the stress with respect to the effective
 concentration.
 The next term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\tilde{c}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{c}^{\prime}\,dv\,,\label{eq252}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{c}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\tilde{c}\right]=-\Delta\tilde{c}\,\tilde{\mathbf{k}}_{c}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\left[\Delta\tilde{c}\left(\frac{\partial}{\partial\tilde{c}}\left(\frac{\tilde{\kappa}}{d_{0}}\right)\mathbf{d}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}_{c}^{\prime}\right)\cdot\grad\tilde{c}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\Delta\tilde{c}\right]\,,
\end{aligned}
\label{eq253}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\tilde{\mathbf{K}}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq254}
\end{equation}

\end_inset

is the spatial tangent of the effective hydraulic permeability with respect
 to the effective concentration.
\end_layout

\begin_layout Standard
The next term reduces to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{c}\right]\,dV=0\,.\label{eq255}
\end{equation}

\end_inset

The following term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}\cdot\Grad\delta\tilde{c}\right)\left[\Delta\tilde{c}\right]\,dV=\grad\delta\tilde{c}\cdot\mathbf{j}_{c}^{\prime}\,dv\,,\label{eq256}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{c}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\tilde{c}\right]\\
 & =\Delta\tilde{c}\left(\frac{\partial\tilde{\kappa}}{\partial\tilde{c}}\mathbf{d}+\tilde{\kappa}\mathbf{d}_{c}^{\prime}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\\
 & -\varphi^{w}\tilde{\kappa}\mathbf{d}\cdot\grad\Delta\tilde{c}+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{c}^{\prime}\,,
\end{aligned}
\label{eq257}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{c}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{D}}{\partial\tilde{c}}\cdot\mathbf{F}^{T}\label{eq258}
\end{equation}

\end_inset

is the spatial tangent of the diffusivity with respect to the effective
 concentration.
\end_layout

\begin_layout Standard
The last term is 
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)}{\partial t}\delta\tilde{c}\right)\left[\Delta\tilde{c}\right]\,dV=\delta\tilde{c}\frac{\varphi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\Delta\tilde{c}\,dv\,,\label{eq259}
\end{equation}

\end_inset

where we similarly used a backward difference scheme to discretize the time
 derivative.
\end_layout

\begin_layout Subsection
Linearization of External Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-linearization-external"

\end_inset


\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 depends on whether natural boundary conditions are prescribed as area densities
 or total net values over an area.
 Thus, in the case when 
\begin_inset Formula $\mathbf{t}\,da$
\end_inset

 (net force), 
\begin_inset Formula $w_{n}da$
\end_inset

 (net volumetric flow rate), or 
\begin_inset Formula $j_{n}da$
\end_inset

 (net molar flow rate) are prescribed over the elemental area 
\begin_inset Formula $da$
\end_inset

, there is no variation in 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 and it follows that 
\begin_inset Formula $D\delta W_{\text{ext}}=0$
\end_inset

.
 Alternatively, in the case when 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 or 
\begin_inset Formula $j_{n}$
\end_inset

 are prescribed, the linearization may be performed by evaluating the integral
 in the parametric space of the boundary surface 
\begin_inset Formula $\partial b$
\end_inset

, with parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2}\right)$
\end_inset

.
 Accordingly, for a point 
\begin_inset Formula $\mathbf{x}\left(\eta^{1},\eta^{2}\right)$
\end_inset

 on 
\begin_inset Formula $\partial b$
\end_inset

, surface tangents (covariant basis vectors) are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\left(\alpha=1,2\right)\label{eq260}
\end{equation}

\end_inset

and the outward unit normal is 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq261}
\end{equation}

\end_inset

The elemental area on 
\begin_inset Formula $\partial b$
\end_inset

 is 
\begin_inset Formula $da=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}$
\end_inset

.
 Consequently, the external virtual work integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\delta\tilde{c}\,j_{n}\right)\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}\,.\label{eq262}
\end{equation}

\end_inset

The directional derivative of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 may then be applied directly to its integrand, since the parametric space
 is invariant 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
If we restrict traction boundary conditions to the special case of normal
 tractions, then 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

 where 
\begin_inset Formula $t_{n}$
\end_inset

 is the prescribed normal traction component.
 Then it can be shown that the linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{\text{ext}}\right)\left[\Delta\mathbf{u}\right]=\int_{\partial b}\left(t_{n}\delta\mathbf{v}+w_{n}\delta\tilde{p}\,\mathbf{n}+j_{n}\delta\tilde{c}\,\mathbf{n}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)d\eta^{1}d\eta^{2}\,.\label{eq263}
\end{equation}

\end_inset

The linearizations along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

 reduce to zero, 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{p}\right]=0$
\end_inset

 and 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{c}\right]=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-discretization"

\end_inset


\end_layout

\begin_layout Standard
To discretize the virtual work relations, let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,,\\
\delta\tilde{p} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{p}_{a}\,, & \Delta\tilde{p} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{p}_{b}\,,\\
\delta\tilde{c} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{c}_{a}\,, & \Delta\tilde{c} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{c}_{b}\,,
\end{aligned}
\label{eq264}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}_{a}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}_{a}$
\end_inset

 respectively represent the nodal values of 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

; 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
\end_layout

\begin_layout Standard
The discretized form of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}\\
r_{a}^{c}
\end{array}\right]\,,\label{eq265}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\text{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the current spatial configuration
 to the parametric space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\,,\\
r_{a}^{p} & =\mathbf{w}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial J}{\partial t}\,,\\
r_{a}^{c} & =\mathbf{j}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}\tilde{c}\right)\,,
\end{aligned}
\label{eq266}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

, 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{c}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 Since the parametric space is invariant, time derivatives are evaluated
 in a material frame.
 For example, the time derivative 
\begin_inset Formula $D^{s}J\left(\mathbf{x},t\right)/Dt$
\end_inset

 appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 becomes 
\begin_inset Formula $\partial J\left(\eta_{k},t\right)/\partial t$
\end_inset

 when evaluated at the parametric coordinates 
\begin_inset Formula $\eta_{k}=\left(\eta_{k}^{1},\eta_{k}^{2},\eta_{k}^{3}\right)$
\end_inset

 of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\text{int}}=D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{p}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{c}\right]$
\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up} & \mathbf{k}_{ab}^{uc}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp} & k_{ab}^{pc}\\
\mathbf{k}_{ab}^{cu} & k_{ab}^{cp} & k_{ab}^{cc}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}
\end{array}\right]\,,\label{eq267}
\end{equation}

\end_inset

where the terms in the first column are the discretized form of the linearizatio
n along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uu}=\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}+\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}\,,\label{eq268}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{pu}=\left(\mathbf{w}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{pu}\,,\label{eq269}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{cu}=\left(\mathbf{j}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{cu}\,,\label{eq270}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{u} & =J\frac{\partial\tilde{\kappa}}{\partial J}\left[\mathbf{d}\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)\right]\otimes\grad N_{b}+\tilde{\kappa}\left({-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}}\right)\cdot\mathbf{d}\cdot\grad N_{b}\\
 & +\tilde{\kappa}\left({-\varphi^{s}\left({\mathbf{d}\cdot\grad\tilde{c}}\right)\otimes\grad N_{b}+\frac{\tilde{c}}{d_{0}}\left[{2\left({\grad N_{b}\cdot\mathbf{w}}\right)\mathbf{d}-\left({\mathbf{d}\cdot\mathbf{w}}\right)\otimes\grad N_{b}}\right]}\right)+\tilde{\kappa}\frac{\tilde{c}}{d_{0}}\mathbf{d}\cdot\mathbf{w}_{b}^{u}\;,
\end{aligned}
\label{eq272}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{pu}=-\frac{1}{\Delta t}\grad N_{b},\label{eq273}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{cu}=\tilde{c}\frac{\partial\left({J\phi^{w}\tilde{\kappa}}\right)}{\partial J}\mathbf{q}_{b}^{pu}.\label{eq274}
\end{equation}

\end_inset

The terms in the second column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{up}=-N_{b}\grad N_{a},\label{eq275}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=-\grad N_{a}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b},\label{eq276}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{cp}=-\frac{\tilde{\kappa}\tilde{c}}{d_{0}}\grad N_{a}\cdot\mathbf{d}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}.\label{eq277}
\end{equation}

\end_inset

The terms in the third column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{c}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{uc}=N_{b}\left(\boldsymbol{\sigma}_{c}^{\prime}\cdot\grad N_{a}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\grad N_{a}\right)\,,\label{eq278}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pc}=\grad N_{a}\cdot\mathbf{w}_{b}^{c}\,,\label{eq279}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{cc}=\grad N_{a}\cdot\mathbf{j}_{b}^{c}+N_{a}q_{b}^{c}\,,\label{eq280}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{b}^{c} & =-N_{b}\tilde{\mathbf{k}}_{c}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad\tilde{c}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\left[N_{b}\left(\frac{\partial}{\partial\tilde{c}}\left(\frac{\tilde{\kappa}}{d_{0}}\right)\mathbf{d}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}_{c}^{\prime}\right)\cdot\grad\tilde{c}+\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\grad N_{b}\right]\,,
\end{aligned}
\label{eq281}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{j}_{b}^{c}=N_{b}\left(\frac{\partial\tilde{\kappa}}{\partial\tilde{c}}\mathbf{d}+\tilde{\kappa}\mathbf{d}_{c}^{\prime}\right)\cdot\left(-\varphi^{w}\grad\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)+\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\grad N_{b}+\frac{\tilde{c}}{d_{0}}\mathbf{w}_{b}^{c}\right)\,,\label{eq282}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
q_{b}^{c}=-N_{b}\frac{\phi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}\tilde{c}\right)}{\partial\tilde{c}}\,.\label{eq283}
\end{equation}

\end_inset

The discretization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
N_{a}t_{n}\mathbf{n}\\
N_{a}w_{n}\\
N_{a}j_{n}
\end{array}\right]\,,\label{eq284}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|$
\end_inset

.
 The summation is performed over all surface elements on which these boundary
 conditions are prescribed.
 The discretization of 
\begin_inset Formula $-D\delta W_{\text{ext}}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}\end{array}\right]\cdot\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ab}^{pu} & 0 & 0\\
\mathbf{k}_{ab}^{cu} & 0 & 0
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}
\end{array}\right]\,,\label{eq285}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,,\\
\mathbf{k}_{ab}^{pu} & =-w_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}\,,\\
\mathbf{k}_{ab}^{cu} & =-j_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}\,.
\end{aligned}
\label{eq286}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} $
\end_inset

 is the antisymmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 (such that 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} \cdot\mathbf{q}=\mathbf{v}\times\mathbf{q}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{q})$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Weak Formulation for Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:MP-weak-formulation"

\end_inset


\end_layout

\begin_layout Standard
The virtual work integral for a mixture of intrinsically incompressible
 constituents combines the balance of momentum for the mixture, the balance
 of mass for the mixture, and the balance of mass for each of the solutes.
 In addition, for charged mixtures, the condition of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq127"

\end_inset

 may be enforced as a penalty constraint on each solute mass balance equation:
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{b}\delta\mathbf{v}\cdot\mbox{div}\boldsymbol{\sigma}\,dv\\
 & +\int_{b}\delta\tilde{p}\,\mbox{div}\left(\mathbf{v}^{s}+\mathbf{w}\right)\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\delta\tilde{c}^{\alpha}\left[\frac{1}{J^{s}}\frac{D^{s}}{Dt}\left(J^{s}\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)+\mbox{div}\mathbf{j}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}\mbox{div}\mathbf{j}^{\beta}\right]\,dv\,,
\end{aligned}
\label{eq287}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity of the solid, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

 is the virtual effective fluid pressure, and 
\begin_inset Formula $\delta\tilde{c}^{\alpha}$
\end_inset

 is the virtual molar energy of solute 
\begin_inset Formula $\alpha$
\end_inset

.
 Here, 
\begin_inset Formula $b$
\end_inset

 represents the mixture domain in the spatial frame and 
\begin_inset Formula $dv$
\end_inset

 is an elemental volume in 
\begin_inset Formula $b$
\end_inset

.
 Applying the divergence theorem, 
\begin_inset Formula $\delta W$
\end_inset

 may be split into internal and external contributions to the virtual work,
 
\begin_inset Formula $\delta W=\delta W_{\text{ext}}-\delta W_{\text{int}}$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{\text{int}} & =\int_{b}\boldsymbol{\sigma}:\delta\mathbf{D}\,dv+\int_{b}\left(\mathbf{w}\cdot\mbox{grad}\delta\tilde{p}-\frac{\delta\tilde{p}}{J^{s}}\frac{D^{s}J^{s}}{Dt}\right)\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\left[\mathbf{j}^{\alpha}\cdot\mbox{grad}\delta\tilde{c}^{\alpha}-\frac{\delta\tilde{c}^{\alpha}}{J^{s}}\frac{D^{s}}{Dt}\left(J^{s}\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)\right]\,dv\\
 & +\sum\limits _{\alpha\ne s,w}\int_{b}\mbox{grad}\delta\tilde{c}^{\alpha}\cdot\sum\limits _{\beta\ne s,w}z^{\beta}\mathbf{j}^{\beta}\,dv\,,
\end{aligned}
\label{eq288}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left[\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\left(j_{n}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}j_{n}^{\beta}\right)\right]\,da\,.\label{eq289}
\end{equation}

\end_inset

In these expressions, 
\begin_inset Formula $\delta\mathbf{D}=\left(\mbox{grad}\delta\mathbf{v}+\mbox{grad}^{T}\delta\mathbf{v}\right)/2$
\end_inset

, 
\begin_inset Formula $\partial b$
\end_inset

 is the boundary of 
\begin_inset Formula $b$
\end_inset

, and 
\begin_inset Formula $da$
\end_inset

 is an elemental area on 
\begin_inset Formula $\partial b$
\end_inset

.
 In this finite element formulation, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 are used as nodal variables, and essential boundary conditions may be prescribe
d on these variables.
 Natural boundary conditions are prescribed to the mixture traction, 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

, normal fluid flux, 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

, and normal solute flux, 
\begin_inset Formula $j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the outward unit normal to 
\begin_inset Formula $\partial b$
\end_inset

.
 To solve the system 
\begin_inset Formula $\delta W=0$
\end_inset

 for nodal values of 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

, it is necessary to linearize these equations, as shown for example in
 Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:BS-linearization-external"

\end_inset

 for biphasic-solute materials.
 If the mixture is charged, it is also necessary to solve for the electric
 potential 
\begin_inset Formula $\psi$
\end_inset

 by solving the algebraic relation of the electroneutrality condition in
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

, which may be rewritten as 
\begin_inset Formula 
\begin{equation}
c^{F}+\sum\limits _{\beta\ne s,w}z^{\beta}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}=0\,.\label{eq290}
\end{equation}

\end_inset

In the special case of a triphasic mixture, where solutes consist of two
 counter-ions (
\begin_inset Formula $\alpha=+,-)$
\end_inset

, this equation may be solved in closed form to produce 
\begin_inset Formula 
\begin{equation}
\psi=\frac{1}{z^{\alpha}}\frac{R\theta}{F_{c}}\ln\left(\frac{2z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha}}{-c^{F}\pm\sqrt{\left(c^{F}\right)^{2}+4\left(z^{\alpha}\right)^{2}\left(\hat{\kappa}^{+}\tilde{c}^{+}\right)\left(\hat{\kappa}^{-}\tilde{c}^{-}\right)}}\right),\quad\alpha=+,-,\label{eq291}
\end{equation}

\end_inset

Only the positive root is valid in the argument of the logarithm function.
\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-du"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\mathbf{u}\right]\,dV=\left[\delta\mathbf{d}^{s}:\boldsymbol{\mathcal{C}}:\Delta\boldsymbol{\varepsilon}+\boldsymbol{\sigma}:\left(\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}\right)\right]\,dv\,,\label{eq292}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor of the mixture, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\boldsymbol{\mathcal{C}}^{e}-\left(\tilde{p}+R\theta\,\Phi\sum\limits _{\beta}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}\right)\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\odot\mathbf{I}\right)-R\theta\sum\limits _{\beta}\tilde{c}^{\beta}\,J\frac{\partial\left(\Phi\tilde{\kappa}^{\beta}\right)}{\partial J}\mathbf{I}\otimes\mathbf{I}\,,\label{eq293}
\end{equation}

\end_inset

and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{e}$
\end_inset

 is the spatial elasticity tensor of the solid matrix, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{e}=J^{-1}\left(\mathbf{F}\oslash\mathbf{F}\right):2\frac{\partial\mathbf{S}^{e}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right)\,.\label{eq294}
\end{equation}

\end_inset

The linearization of the second term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{u}^{\prime}\,dv\,,\label{eq295}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{u}^{\prime} & \equiv-\left(\tilde{\boldsymbol{\mathcal{K}}}:\Delta\boldsymbol{\varepsilon}\right)\cdot\left(\grad\tilde{p}+R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\right)\\
 & -\tilde{\mathbf{k}}\cdot R\theta\sum\limits _{\beta}\left(\left[J\frac{\partial}{\partial J}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)-\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right]\left(\divg\Delta\mathbf{u}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\left(2\Delta\boldsymbol{\varepsilon}\cdot\mathbf{d}^{\beta}+\boldsymbol{\mathcal{D}}^{\beta}:\Delta\boldsymbol{\varepsilon}\right)\right)\cdot\grad\tilde{c}^{\beta}
\end{aligned}
\label{eq296}
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\boldsymbol{\mathcal{K}}} & =J^{-1}\left(\mathbf{F}\oslash\mathbf{F}\right):2\frac{\partial\tilde{\mathbf{K}}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right)\,,\\
\boldsymbol{\mathcal{D}}^{\alpha} & =J^{-1}\left(\mathbf{F}\oslash\mathbf{F}\right):2\frac{\partial\mathbf{D}^{\alpha}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right)\,,
\end{aligned}
\label{eq297}
\end{equation}

\end_inset

representing the spatial tangents, with respect to the strain, of the effective
 permeability and solute diffusivity, respectively.
 These fourth-order tensors exhibit minor symmetries but not major symmetry,
 as described recently 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

.
 Since 
\begin_inset Formula $\tilde{\mathbf{K}}$
\end_inset

 is given by substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq120"

\end_inset


\begin_inset Formula $_{3}$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq231"

\end_inset


\begin_inset Formula $_{1}$
\end_inset

, the evaluation of 
\begin_inset Formula $\tilde{\boldsymbol{\mathcal{K}}}$
\end_inset

 is rather involved and it can be shown that 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{K}}}=\left(\tilde{\mathbf{k}}\oslash\tilde{\mathbf{k}}\right):\left[\left(\mathbf{k}^{-1}\oslash\mathbf{k}^{-1}\right):\boldsymbol{\mathcal{K}}+\boldsymbol{\mathcal{G}}\right]\,,\label{eq298}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=J^{-1}\left(\mathbf{F}\oslash\mathbf{F}\right):2\frac{\partial\mathbf{K}}{\partial\mathbf{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right)\,,\label{eq300}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{G}}=\frac{R\theta}{\varphi^{w}}\sum_{\alpha}\frac{\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\left(\begin{aligned}\left(\frac{1}{\varphi^{w}}-\frac{J}{\tilde{\kappa}^{\alpha}}\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J}\right)\left(\mathbf{I}-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\right)\otimes\mathbf{I}\\
+2\left(\mathbf{I}\odot\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}+\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\odot\mathbf{I}-\mathbf{I}\odot\mathbf{I}\right)\\
-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\otimes\mathbf{I}+\frac{\boldsymbol{\mathcal{D}}^{\alpha}}{d_{0}^{\alpha}}
\end{aligned}
\right)\,.\label{eq299}
\end{equation}

\end_inset

The next term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 linearizes to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=-\delta\tilde{p}\frac{1}{\Delta t}\divg\Delta\mathbf{u}\,dv\,,\label{eq301}
\end{equation}

\end_inset

where we used a backward difference scheme to approximate the time derivative,
 
\begin_inset Formula 
\begin{equation}
\frac{\partial J}{\partial t}\approx\frac{1}{\Delta t}\left(J-J^{-\Delta t}\right)\,,\label{eq302}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Delta t$
\end_inset

 represents the time increment relative to the previous time point.
 The next term is given by 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}\right)\left[\Delta\mathbf{u}\right]\,dV=\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{j}_{u}^{\alpha\prime}\,dv\,,\label{eq303}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{u}^{\alpha\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}\left[\Delta\mathbf{u}\right]=\left(J\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J}\left(\divg\Delta\mathbf{u}\right)\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\boldsymbol{\mathcal{D}}^{\alpha}:\Delta\boldsymbol{\varepsilon}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\grad\tilde{c}^{\alpha}+\left(2\Delta\boldsymbol{\varepsilon}-\left(\divg\Delta\mathbf{u}\right)\mathbf{I}\right)\cdot\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}_{u}^{\prime}\right)
\end{aligned}
\,.\label{eq304}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{g}^{\alpha}=-\varphi^{w}\grad\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\,.\label{eq305}
\end{equation}

\end_inset

Using a backward difference scheme for the time derivative, the last term
 is 
\begin_inset Formula 
\begin{equation}
D\left(\delta\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\right)\left[\Delta\mathbf{u}\right]\,dV=\frac{\delta\tilde{c}^{\alpha}}{\Delta t}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\right)}{\partial J}\tilde{c}^{\alpha}\divg\Delta\mathbf{u}\,dv\,.\label{eq306}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-dp"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the various terms in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{p}\right]\,dV=-\Delta\tilde{p}\,\divg\delta\mathbf{v}\,dv\,,\label{eq307}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}-\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\grad\delta\tilde{p}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,,\label{eq308}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}-\delta\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\right)\left[\Delta\tilde{p}\right]\,dV=-\frac{\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{d}^{\alpha}\cdot\tilde{\mathbf{k}}\cdot\grad\Delta\tilde{p}\,dv\,.\label{eq309}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-dc"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the first term in 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{S}:\delta\mathbf{\dot{E}}\right)\left[\Delta\tilde{c}^{\gamma}\right]dV=\Delta\tilde{c}^{\gamma}\left(\boldsymbol{\sigma}_{\gamma}^{\prime}:\delta\mathbf{d}-R\theta\frac{\partial\left(\Phi\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial\tilde{c}^{\gamma}}\divg\delta\mathbf{v}\right)\,dv\,,\label{eq310}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{\gamma}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{S}^{e}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T}\label{eq311}
\end{equation}

\end_inset

represents the spatial tangent of the stress with respect to the effective
 concentration.
 The next term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{W}\cdot\Grad\delta\tilde{p}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\grad\delta\tilde{p}\cdot\mathbf{w}_{\gamma}^{\prime}\,dv\,,\label{eq312}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{\gamma}^{\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{W}\left[\Delta\tilde{c}^{\gamma}\right]=-\tilde{\mathbf{k}}_{\gamma}^{\prime}\cdot\left(\grad\tilde{p}+R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\right)\Delta\tilde{c}^{\gamma}\\
 & -R\theta\tilde{\mathbf{k}}\cdot\frac{\tilde{\kappa}^{\gamma}}{d_{0}^{\gamma}}\mathbf{d}^{\gamma}\cdot\grad\Delta\tilde{c}^{\gamma}-\Delta\tilde{c}^{\gamma}R\theta\tilde{\mathbf{k}}\cdot\sum\limits _{\beta}\left(\frac{\partial}{\partial\tilde{c}^{\gamma}}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}_{\gamma}^{\beta\prime}\right)\cdot\grad\tilde{c}^{\beta}
\end{aligned}
\label{eq313}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}_{\gamma}^{\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\tilde{\mathbf{K}}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T},\quad\mathbf{d}_{\gamma}^{\beta\prime}=J^{-1}\mathbf{F}\cdot\frac{\partial\mathbf{d}^{\beta}}{\partial\tilde{c}^{\gamma}}\cdot\mathbf{F}^{T}\label{eq314}
\end{equation}

\end_inset

are the spatial tangents of the effective hydraulic permeability and solute
 diffusivity with respect to the effective concentration.
\end_layout

\begin_layout Standard
The next term reduces to 
\begin_inset Formula 
\begin{equation}
-D\left(\delta\tilde{p}\frac{\partial J}{\partial t}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=0\,.\label{eq315}
\end{equation}

\end_inset

The following term is 
\begin_inset Formula 
\begin{equation}
D\left(\mathbf{J}^{\alpha}\cdot\Grad\delta\tilde{c}^{\alpha}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\grad\delta\tilde{c}^{\alpha}\cdot\mathbf{j}_{\gamma}^{\alpha\prime}\,dv\,,\label{eq316}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{\gamma}^{\alpha\prime} & \equiv J^{-1}\mathbf{F}\cdot D\mathbf{J}^{\alpha}\left[\Delta\tilde{c}^{\gamma}\right]=\Delta\tilde{c}^{\gamma}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\mathbf{d}_{\gamma}^{\alpha\prime}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\delta_{\alpha\gamma}\grad\Delta\tilde{c}^{\gamma}+\frac{\Delta\tilde{c}^{\gamma}}{d_{0}^{\alpha}}\left(\delta_{\alpha\gamma}-\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\frac{\partial d_{0}^{\alpha}}{\partial\tilde{c}^{\gamma}}\right)\mathbf{w}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}_{\gamma}^{\prime}\right)\,.
\end{aligned}
\label{eq317}
\end{equation}

\end_inset

The last term is 
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial t}\delta\tilde{c}^{\alpha}\right)\left[\Delta\tilde{c}^{\gamma}\right]\,dV=\delta\tilde{c}^{\alpha}\frac{\varphi^{w}}{\Delta t}\frac{\partial\left(\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)}{\partial\tilde{c}^{\gamma}}\Delta\tilde{c}^{\gamma}\,dv\,,\label{eq318}
\end{equation}

\end_inset

where we similarly used a backward difference scheme to discretize the time
 derivative.
\end_layout

\begin_layout Subsection
Linearization of External Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-linearization-external"

\end_inset


\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq289"

\end_inset

 depends on whether natural boundary conditions are prescribed as area densities
 or total net values over an area.
 Thus, in the case when 
\begin_inset Formula $\mathbf{t}\,da$
\end_inset

 (net force), 
\begin_inset Formula $w_{n}da$
\end_inset

 (net volumetric flow rate), or 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}da$
\end_inset

 (net effective molar flow rate) are prescribed over the elemental area
 
\begin_inset Formula $da$
\end_inset

, there is no variation in 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 and it follows that 
\begin_inset Formula $D\delta W_{\text{ext}}=0$
\end_inset

.
 Alternatively, in the case when 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $w_{n}$
\end_inset

 or 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}$
\end_inset

 are prescribed, the linearization may be performed by evaluating the integral
 in the parametric space of the boundary surface 
\begin_inset Formula $\partial b$
\end_inset

, with parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2}\right)$
\end_inset

.
 Accordingly, for a point 
\begin_inset Formula $\mathbf{x}\left(\eta^{1},\eta^{2}\right)$
\end_inset

 on 
\begin_inset Formula $\partial b$
\end_inset

, surface tangents (covariant basis vectors) are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}},\quad\left(\alpha=1,2\right)\label{eq319}
\end{equation}

\end_inset

and the outward unit normal is 
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq320}
\end{equation}

\end_inset

The elemental area on 
\begin_inset Formula $\partial b$
\end_inset

 is 
\begin_inset Formula $da=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|d\eta^{1}d\eta^{2}$
\end_inset

.
 Consequently, the external virtual work integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\int_{\partial b}\left(\delta\mathbf{v}\cdot\mathbf{t}+\delta\tilde{p}\,w_{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\tilde{j}_{n}^{\alpha}\right)\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}\,,\label{eq321}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}+\sum\limits _{\beta\ne s,w}z^{\beta}j_{n}^{\beta}\,.\label{eq322}
\end{equation}

\end_inset

The directional derivative of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 may then be applied directly to its integrand, since the parametric space
 is invariant 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
If we restrict traction boundary conditions to the special case of normal
 tractions, then 
\begin_inset Formula $\mathbf{t}=t_{n}\mathbf{n}$
\end_inset

 where 
\begin_inset Formula $t_{n}$
\end_inset

 is the prescribed normal traction component.
 Then it can be shown that the linearization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 produces 
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{\text{ext}}\right)\left[\Delta\mathbf{u}\right]=\int_{\partial b}\left(t_{n}\delta\mathbf{v}+w_{n}\delta\tilde{p}\,\mathbf{n}+\sum\limits _{\alpha\ne s,w}\delta\tilde{c}^{\alpha}\tilde{j}_{n}^{\alpha}\,\mathbf{n}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)\,d\eta^{1}d\eta^{2}\,.\label{eq323}
\end{equation}

\end_inset

The linearizations along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

 reduce to zero, 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{p}\right]=0$
\end_inset

 and 
\begin_inset Formula $D\left(\delta W_{\text{ext}}\right)\left[\Delta\tilde{c}^{\gamma}\right]=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-discretization"

\end_inset


\end_layout

\begin_layout Standard
To discretize the virtual work relations, let 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum\limits _{a=1}^{m}N_{a}\delta\mathbf{v}_{a}\,, & \Delta\mathbf{u} & =\sum\limits _{b=1}^{m}N_{b}\Delta\mathbf{u}_{b}\,,\\
\delta\tilde{p} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{p}_{a}\,, & \Delta\tilde{p} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{p}_{b}\,,\\
\delta\tilde{c}^{\alpha} & =\sum\limits _{a=1}^{m}N_{a}\delta\tilde{c}_{a}^{\alpha}\,, & \Delta\tilde{c}^{\gamma} & =\sum\limits _{b=1}^{m}N_{b}\Delta\tilde{c}_{b}^{\gamma}\,,
\end{aligned}
\label{eq324}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 represents the interpolation functions over an element, 
\begin_inset Formula $\delta\mathbf{v}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}_{a}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}_{a}^{\alpha}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{a}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}_{a}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}_{a}^{\gamma}$
\end_inset

 respectively represent the nodal values of 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{p}$
\end_inset

, 
\begin_inset Formula $\delta\tilde{c}^{\alpha}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 and 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

; 
\begin_inset Formula $m$
\end_inset

 is the number of nodes in an element.
\end_layout

\begin_layout Standard
The discretized form of 
\begin_inset Formula $\delta W_{\text{int}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{r}_{a}^{u}\\
r_{a}^{p}\\
r_{a}^{\alpha}\\
r_{a}^{\beta}
\end{array}\right]\,,\label{eq325}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}$
\end_inset

 is the number of elements in 
\begin_inset Formula $b$
\end_inset

, 
\begin_inset Formula $n_{\text{int}}^{\left(e\right)}$
\end_inset

 is the number of integration points in the 
\begin_inset Formula $e-$
\end_inset

th element, 
\begin_inset Formula $W_{k}$
\end_inset

 is the quadrature weight associated with the 
\begin_inset Formula $k-$
\end_inset

th integration point, and 
\begin_inset Formula $J_{\eta}$
\end_inset

 is the Jacobian of the transformation from the current spatial configuration
 to the parametric space of the element.
 In the above expression, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\,,\\
r_{a}^{p} & =\mathbf{w}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial J}{\partial t}\,,\\
r_{a}^{\alpha} & =\mathbf{j}^{\alpha}\cdot\grad N_{a}-N_{a}\frac{1}{J}\frac{\partial}{\partial t}\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}\right)\,,
\end{aligned}
\label{eq326}
\end{equation}

\end_inset

and it is understood that 
\begin_inset Formula $J_{\eta}$
\end_inset

, 
\begin_inset Formula $\mathbf{r}_{a}^{u}$
\end_inset

, 
\begin_inset Formula $r_{a}^{p}$
\end_inset

 and 
\begin_inset Formula $r_{a}^{\alpha}$
\end_inset

 are evaluated at the parametric coordinates of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 Since the parametric space is invariant, time derivatives are evaluated
 in a material frame.
 For example, the time derivative 
\begin_inset Formula $D^{s}J\left(\mathbf{x},t\right)/Dt$
\end_inset

 appearing in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq226"

\end_inset

 becomes 
\begin_inset Formula $\partial J\left(\eta_{k},t\right)/\partial t$
\end_inset

 when evaluated at the parametric coordinates 
\begin_inset Formula $\eta_{k}=\left(\eta_{k}^{1},\eta_{k}^{2},\eta_{k}^{3}\right)$
\end_inset

 of the 
\begin_inset Formula $k-$
\end_inset

th integration point.
 All time derivatives are discretized using a backward difference scheme.
\end_layout

\begin_layout Standard
Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{\text{int}}=D\delta W_{\text{int}}\left[\Delta\mathbf{u}\right]+D\delta W_{\text{int}}\left[\Delta\tilde{p}\right]+\sum\nolimits _{\gamma}D\delta W_{\text{int}}\left[\Delta\tilde{c}^{\gamma}\right]$
\end_inset

 may be written as 
\begin_inset Formula 
\begin{equation}
D\delta W_{\text{int}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{cccc}
\mathbf{K}_{ab}^{uu} & \mathbf{k}_{ab}^{up} & \mathbf{k}_{ab}^{u\alpha} & \mathbf{k}_{ab}^{u\beta}\\
\mathbf{k}_{ab}^{pu} & k_{ab}^{pp} & k_{ab}^{p\alpha} & k_{ab}^{p\beta}\\
\mathbf{k}_{ab}^{\alpha u} & k_{ab}^{\alpha p} & k_{ab}^{\alpha\alpha} & k_{ab}^{\alpha\beta}\\
\mathbf{k}_{ab}^{\beta u} & k_{ab}^{\beta p} & k_{ab}^{\beta\alpha} & k_{ab}^{\beta\beta}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}^{\alpha}\\
\Delta\tilde{c}_{b}^{\beta}
\end{array}\right]\,,\label{eq327}
\end{equation}

\end_inset

where the terms in the first column are the discretized form of the linearizatio
n along 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uu}=\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}+\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}\,,\label{eq328}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{pu}=\left(\mathbf{w}_{b}^{u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{pu}\,,\label{eq329}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{\alpha u}=\left(\mathbf{j}_{b}^{\alpha u}+\sum\nolimits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta u}\right)^{T}\cdot\grad N_{a}+N_{a}\mathbf{q}_{b}^{\alpha u}\,,\label{eq330}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{b}^{u} & =\mathbf{g}^{p}\cdot\tilde{\boldsymbol{\mathcal{K}}}\cdot\grad N_{b}\\
 & -R\theta\sum_{\beta}\frac{1}{d_{0}^{\beta}}\left(J\frac{\partial\tilde{\kappa}^{\beta}}{\partial J}-\tilde{\kappa}^{\beta}\right)\tilde{\mathbf{k}}\cdot\mathbf{d}^{\beta}\cdot\left(\grad\tilde{c}^{\beta}\otimes\grad N_{b}\right)\\
 & -R\theta\sum_{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\left[\tilde{\mathbf{k}}\cdot\left(\grad N_{b}\otimes\grad\tilde{c}^{\beta}\right)\cdot\mathbf{d}^{\beta}+\left(\grad N_{b}\cdot\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\right)\tilde{\mathbf{k}}\right]\\
 & -R\theta\sum_{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\tilde{\mathbf{k}}\cdot\left(\grad\tilde{c}^{\beta}\cdot\boldsymbol{\mathcal{D}}^{\beta}\cdot\grad N_{b}\right)\,,
\end{aligned}
\label{eq330b}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{g}^{p}=-\grad\tilde{p}-R\theta\sum\limits _{\beta}\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}^{\beta}\cdot\grad\tilde{c}^{\beta}\,.\label{eq344}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{\alpha u} & =J\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J}\mathbf{d}^{\alpha}\cdot\left(\mathbf{g}^{\alpha}\otimes\grad N_{b}\right)+\tilde{\kappa}^{\alpha}\mathbf{g}^{\alpha}\cdot\boldsymbol{\mathcal{D}}^{\alpha}\cdot\grad N_{b}\\
 & +\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\left(\grad N_{b}\otimes\mathbf{w}-\mathbf{w}\otimes\grad N_{b}+\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}+\mathbf{w}_{b}^{u}\right)\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\\
 & -\varphi^{s}\tilde{\kappa}^{\alpha}\mathbf{d}^{\alpha}\cdot\grad\tilde{c}^{\alpha}\otimes\grad N_{b}\,,
\end{aligned}
\label{eq331}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{g}^{\alpha}=-\varphi^{w}\grad\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\,,\label{eq331b}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{pu}=-\frac{1}{\Delta t}\grad N_{b}\,,\label{eq332}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{q}_{b}^{\alpha u}=\tilde{c}^{\alpha}\frac{\partial\left(J\varphi^{w}\tilde{\kappa}^{\alpha}\right)}{\partial J}\mathbf{q}_{b}^{pu}\,.\label{eq333}
\end{equation}

\end_inset

The terms in the second column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{up}=-N_{b}\grad N_{a}\,,\label{eq334}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=-\grad N_{a}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}\,,\label{eq335}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{\alpha p}=\grad N_{a}\cdot\left(\mathbf{j}_{b}^{\alpha p}+\sum\limits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta p}\right)\,,\label{eq336}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{j}_{b}^{\alpha p}=-\frac{\tilde{\kappa}^{\alpha}\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\tilde{\mathbf{k}}\cdot\grad N_{b}\,.\label{eq337}
\end{equation}

\end_inset

The terms in the third column of the stiffness matrix in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq267"

\end_inset

 are the discretized form of the linearization along 
\begin_inset Formula $\Delta\tilde{c}^{\gamma}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{u\alpha}=N_{b}\left(\boldsymbol{\sigma}_{\alpha}^{\prime}-R\theta\left[\Phi\tilde{\kappa}^{\alpha}+\sum\limits _{\beta}\left(\frac{\partial\Phi}{\partial\tilde{c}^{\alpha}}\tilde{\kappa}^{\beta}+\Phi\frac{\partial\tilde{\kappa}^{\beta}}{\partial\tilde{c}^{\alpha}}\right)\tilde{c}^{\beta}\right]\mathbf{I}\right)\cdot\grad N_{a}\,,\label{eq338}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{p\alpha}=\grad N_{a}\cdot\mathbf{w}_{b}^{\alpha}\,,\label{eq339}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
k_{ab}^{\alpha\gamma}=\grad N_{a}\cdot\left(\mathbf{j}_{b}^{\alpha\gamma}+\sum\limits _{\beta}z^{\beta}\mathbf{j}_{b}^{\beta\gamma}\right)+N_{a}q_{b}^{\alpha\gamma}\,,\label{eq340}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}_{b}^{\gamma} & =N_{b}\left(\tilde{\mathbf{k}}_{\gamma}^{\prime}\cdot\mathbf{g}^{p}-R\theta\tilde{\mathbf{k}}\cdot\sum\limits _{\beta}\left(\frac{\partial}{\partial\tilde{c}^{\gamma}}\left(\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\right)\mathbf{d}^{\beta}+\frac{\tilde{\kappa}^{\beta}}{d_{0}^{\beta}}\mathbf{d}_{c}^{\beta\gamma}\right)\cdot\grad\tilde{c}^{\beta}\right)\\
 & -R\theta\tilde{\mathbf{k}}\cdot\frac{\tilde{\kappa}^{\gamma}}{d_{0}^{\gamma}}\mathbf{d}^{\gamma}\cdot\grad N_{b}\,,
\end{aligned}
\label{eq341}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{j}_{b}^{\alpha\gamma} & =N_{b}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{d}^{\alpha}+\tilde{\kappa}^{\alpha}\mathbf{d}_{c}^{\alpha\gamma}\right)\cdot\mathbf{g}^{\alpha}\\
 & +\frac{\tilde{\kappa}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\left[\delta_{\alpha\gamma}\left(N_{b}\mathbf{w}-\varphi^{w}d_{0}^{\alpha}\grad N_{b}\right)+\tilde{c}^{\alpha}\left(\mathbf{w}_{b}^{\gamma}-\frac{N_{b}}{d_{0}^{\alpha}}\frac{\partial d_{0}^{\alpha}}{\partial\tilde{c}^{\gamma}}\mathbf{w}\right)\right]\,,
\end{aligned}
\label{eq342}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
q_{b}^{\alpha\gamma}=-N_{b}\frac{\varphi^{w}}{\Delta t}\left(\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\tilde{c}^{\alpha}+\delta_{\alpha\gamma}\tilde{\kappa}^{\alpha}\right)\,.\label{eq343}
\end{equation}

\end_inset

The discretization of 
\begin_inset Formula $\delta W_{\text{ext}}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq321"

\end_inset


\series bold
 
\series default
has the form 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\text{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{c}
N_{a}t_{n}\mathbf{n}\\
N_{a}w_{n}\\
N_{a}\tilde{j}_{n}^{\alpha}\\
N_{a}\tilde{j}_{n}^{\beta}
\end{array}\right]\,,\label{eq345}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|$
\end_inset

.
 The summation is performed over all surface elements on which these boundary
 conditions are prescribed.
 The discretization of 
\begin_inset Formula $-D\delta W_{\text{ext}}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
-D\delta W_{\text{ext}}=\sum\limits _{e=1}^{n_{e}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a} & \delta\tilde{p}_{a} & \delta\tilde{c}_{a}^{\alpha} & \delta\tilde{c}_{a}^{\beta}\end{array}\right]\cdot\left[\begin{array}{cccc}
\mathbf{K}_{ab}^{uu} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ab}^{pu} & 0 & 0 & 0\\
\mathbf{k}_{ab}^{\alpha u} & 0 & 0 & 0\\
\mathbf{k}_{ab}^{\beta u} & 0 & 0 & 0
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\tilde{p}_{b}\\
\Delta\tilde{c}_{b}^{\alpha}\\
\Delta\tilde{c}_{b}^{\beta}
\end{array}\right]\,,\label{eq346}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =t_{n}N_{a}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right\} \,,\\
\mathbf{k}_{ab}^{pu} & =-w_{n}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n},\\
\mathbf{k}_{ab}^{\alpha u} & =-\tilde{j}_{n}^{\alpha}N_{a}\left(\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}-\frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}\right)\times\mathbf{n}.
\end{aligned}
\label{eq347}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} $
\end_inset

 is the antisymmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{v}$
\end_inset

 (such that 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \mathbf{v}\right\} \cdot\mathbf{q}=\mathbf{v}\times\mathbf{q}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{q})$
\end_inset

.
\end_layout

\begin_layout Subsection
Electric Potential and Partition Coefficient Derivatives
\begin_inset CommandInset label
LatexCommand label
name "subsec:Potential-partition-derivatives"

\end_inset


\end_layout

\begin_layout Standard
When the mixture is charged it is necessary to solve for the electric potential
 
\begin_inset Formula $\psi$
\end_inset

 using the electroneutrality condition in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq124"

\end_inset

.
 This equation may be rewritted as a polynomial in 
\begin_inset Formula $\zeta$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\sum\limits _{i=0}^{n}a_{i}\zeta^{i}\,,\label{eq348}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\zeta=\exp\left(-\frac{F_{c}\psi}{R\theta}\right)\,,\label{eq349}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
a_{i}=\begin{cases}
z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha} & i=z^{\alpha}-z^{\min}\\
c^{F} & i=-z^{\min}
\end{cases}\,.\label{eq350}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $z^{\min}=\min_{\alpha}z^{\alpha}$
\end_inset

 and the polynomial degress is 
\begin_inset Formula $n=z^{\max}-z^{\min}$
\end_inset

 where 
\begin_inset Formula $z^{\max}=\max_{\alpha}z^{\alpha}$
\end_inset

.
 Since more than one solute may carry the same charge 
\begin_inset Formula $z^{\alpha}$
\end_inset

, the coefficients 
\begin_inset Formula $a_{i}$
\end_inset

 should be evaluated from the summation of 
\begin_inset Formula $z^{\alpha}\hat{\kappa}^{\alpha}\tilde{c}^{\alpha}$
\end_inset

 over all such solutes.
 Only real positive roots are valid, since 
\begin_inset Formula $\psi=-R\theta\left(\ln\zeta\right)/F_{c}$
\end_inset

 according to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq349"

\end_inset

.
 Using Descartes' rule of signs, an inspection of the coefficients 
\begin_inset Formula $a_{i}$
\end_inset

 shows tht there is only one sign change in the polynomial, regardless of
 the sign of 
\begin_inset Formula $c^{F}$
\end_inset

, implying that there will always be only one positive root 
\begin_inset Formula $\zeta$
\end_inset

, which must thus be real.
 Therefore, there cannot be any ambiguity in the calculation of 
\begin_inset Formula $\psi$
\end_inset

, irrespective of the polynomial degree.
 Newton's method is used to solve for the positive real root when 
\begin_inset Formula $n>2$
\end_inset

.
\end_layout

\begin_layout Standard
Using the above relations, it follows that 
\begin_inset Formula $\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\zeta^{z^{\alpha}}$
\end_inset

.
 An examination of the equations resulting from the linearization of the
 internal virtual work shows that it is necessary to evaluate derivatives
 of 
\begin_inset Formula $\tilde{\kappa}^{\alpha}$
\end_inset

 with respect to 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\gamma}$
\end_inset

, which are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{\partial\tilde{\kappa}^{\alpha}}{\partial J} & =\frac{\partial\hat{\kappa}^{\alpha}}{\partial J}\zeta^{z^{\alpha}}+z^{\alpha}\tilde{\kappa}^{\alpha}\frac{1}{\zeta}\frac{\partial\zeta}{\partial J}\\
\frac{\partial\tilde{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}} & =\frac{\partial\hat{\kappa}^{\alpha}}{\partial\tilde{c}^{\gamma}}\zeta^{z^{\alpha}}+z^{\alpha}\tilde{\kappa}^{\alpha}\frac{1}{\zeta}\frac{\partial\zeta}{\partial\tilde{c}^{\gamma}}
\end{aligned}
\,.\label{eq351}
\end{equation}

\end_inset

In these expressions, the derivatives of 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

 are obtained from the user-defined constitutive relations for the solubility.
 Derivatives of 
\begin_inset Formula $\zeta$
\end_inset

 may be evaluated by differentiating the electroneutrality condition to
 produce 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{1}{\zeta}\frac{\partial\zeta}{\partial J} & =-\frac{\frac{\partial c^{F}}{\partial J}+\sum\nolimits _{\beta}z^{\beta}\zeta^{z^{\beta}}\tilde{c}^{\beta}\frac{\partial\hat{\kappa}^{\beta}}{\partial J}}{\sum\nolimits _{\beta}\left(z^{\beta}\right)^{2}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}}\\
\frac{1}{\zeta}\frac{\partial\zeta}{\partial\tilde{c}^{\gamma}} & =-\frac{z^{\gamma}\tilde{\kappa}^{\gamma}+\sum\nolimits _{\beta}z^{\beta}\zeta^{z^{\beta}}\tilde{c}^{\beta}\frac{\partial\hat{\kappa}^{\beta}}{\partial\tilde{c}^{\gamma}}}{\sum\nolimits _{\beta}\left(z^{\beta}\right)^{2}\tilde{\kappa}^{\beta}\tilde{c}^{\beta}}
\end{aligned}
\,.\label{eq352}
\end{equation}

\end_inset

The derivative 
\begin_inset Formula $\partial c^{F}/\partial J$
\end_inset

 may be evaluated from 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F}\,,\label{eq353}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction (volume of solid in current configurat
ion per volume of the mixture in the reference configuration) and 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 is the referential fixed charge density (equivalent charge in current configura
tion per volume of the mixture in the reference configuration).
\end_layout

\begin_layout Subsection
Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-chemical-reactions"

\end_inset


\end_layout

\begin_layout Subsubsection
Virtual Work and Linearization
\end_layout

\begin_layout Standard
The contribution to 
\begin_inset Formula $\delta W$
\end_inset

 due to chemical reactions is given by 
\begin_inset Formula $\delta G$
\end_inset

, where 
\begin_inset Formula 
\[
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\sum_{\alpha}\nu^{\alpha}\mathcal{V}^{\alpha}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
\delta G=\int_{b}\delta\tilde{p}\left[\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\right]\,dv+\sum\limits _{\iota}\nu^{\iota}\int_{b}\delta\tilde{c}^{\iota}\left(1-\varphi^{s}\right)\hat{\zeta}\,dv\,.\label{eq354}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 along a solid displacement increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\mathbf{u}\right] & =\int_{b}\delta\tilde{p}\,\left(\hat{\varphi}^{w}\,\divg\Delta\mathbf{u}+\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}:\Delta\boldsymbol{\varepsilon}\right)\,dv\\
 & +\overline{\mathcal{V}}\int_{b}\delta\tilde{p}\left[\hat{\zeta}\,\divg\Delta\mathbf{u}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}:\Delta\boldsymbol{\varepsilon}\right]\,dv\\
 & +\sum_{\iota}\nu^{\iota}\int_{b}\delta\tilde{c}^{\iota}\left[\hat{\zeta}\left(1-\frac{\partial\varphi_{r}^{s}}{\partial J}\right)\,\divg\Delta\mathbf{u}+\left(J-\varphi_{r}^{s}\right)\hat{\boldsymbol{\zeta}}_{\varepsilon}:\Delta\boldsymbol{\varepsilon}\right]\,dv
\end{aligned}
\,,\label{eq354b}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}=\mathbf{F}\cdot\frac{\partial\hat{\varphi}^{w}}{\partial\mathbf{E}}\cdot\mathbf{F}^{T}\,,\quad\hat{\boldsymbol{\zeta}}_{\varepsilon}=J^{-1}\mathbf{F}\cdot\frac{\partial\hat{\zeta}}{\partial\mathbf{E}}\cdot\mathbf{F}^{T}\,,\label{eq354c}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
\frac{\partial\varphi_{r}^{s}}{\partial J}=\frac{\sum_{\sigma}\frac{M^{\sigma}}{\rho_{T}^{\sigma}}c^{\sigma}\left(1+\sum_{\sigma}\frac{M^{\sigma}}{\rho_{T}^{\sigma}}c^{\sigma}\right)+\left(J-\varphi_{0}^{s}\right)\sum_{\sigma}\frac{M^{\sigma}}{\rho_{T}^{\sigma}}\frac{1}{\tilde{\kappa}^{\sigma}}\frac{\partial\tilde{\kappa}^{\sigma}}{\partial J}c^{\sigma}}{\left(1+\sum\limits _{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}\right)^{2}}
\]

\end_inset

for solutes-as-SBMs, and
\begin_inset Formula 
\[
\frac{\partial\varphi_{r}^{s}}{\partial J}=\frac{\sum_{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\left(J\varphi^{w}+\sum_{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\right)+J\varphi^{w}\left(J-\varphi_{0}^{s}\right)\sum_{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\frac{1}{\tilde{\kappa}^{\sigma}}\frac{\partial\tilde{\kappa}^{\sigma}}{\partial J}}{\left(J\varphi^{w}+\sum\limits _{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\right)^{2}}
\]

\end_inset

for SBMs, as obtained from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:phirs-solutes-as-SBMs"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Currently, 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 is assumed to be independent of 
\begin_inset Formula $\tilde{p}$
\end_inset

 in FEBio; it follows that the linearization along the effective fluid pressure
 increment 
\begin_inset Formula $\Delta\tilde{p}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\tilde{p}\right]=\int_{b}\delta\tilde{p}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{p}}\Delta p\,dv\,.\label{eq354d}
\end{equation}

\end_inset

Finally, the linearization along a concentration increment 
\begin_inset Formula $\Delta\tilde{c}^{\iota}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\tilde{c}^{\iota}\right] & =\int_{b}\delta\tilde{p}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{c}^{\iota}}\Delta\tilde{c}^{\iota}\,dv\\
 & +\overline{\mathcal{V}}\int_{b}\delta\tilde{p}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\Delta\tilde{c}^{\iota}\,dv\\
 & +\sum_{\gamma}\nu^{\gamma}\int_{b}\delta\tilde{c}^{\gamma}\left(\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}-\frac{1}{J}\frac{\partial\varphi_{r}^{s}}{\partial\tilde{c}^{\iota}}\hat{\zeta}\right)\Delta\tilde{c}^{\iota}\,dv
\end{aligned}
\,.\label{eq354e}
\end{equation}

\end_inset

where
\begin_inset Formula 
\[
\frac{\partial\varphi_{r}^{s}}{\partial\tilde{c}^{\iota}}=\begin{cases}
\frac{\left(J-\varphi_{r}^{s}\right)^{2}}{J-\varphi_{0}^{s}}\sum_{\sigma}\frac{M^{\sigma}}{\rho_{T}^{\sigma}}\left(\tilde{\kappa}^{\sigma}+\tilde{c}^{\sigma}\frac{\partial\tilde{\kappa}^{\sigma}}{\partial\tilde{c}^{\sigma}}\right) & \iota=\sigma\\
\frac{\left(J-\varphi_{r}^{s}\right)^{2}}{J-\varphi_{0}^{s}}\sum_{\sigma}\frac{M^{\alpha}}{\rho_{T}^{\sigma}}\tilde{c}^{\sigma}\frac{\partial\tilde{\kappa}^{\sigma}}{\partial\tilde{c}^{\iota}} & \iota\ne\sigma
\end{cases}
\]

\end_inset

for solutes-as-SBMs, as obtained from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:phirs-solutes-as-SBMs"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The discretized form of these expressions is given by
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\tilde{p}_{a}r_{a}^{p}+\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}r_{a}^{\gamma}\,,\label{eq354f}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}r_{a}^{p} & =\int_{b}N_{a}\,\left[\hat{\varphi}^{w}+\left(1-\varphi^{s}\right)\hat{\zeta}\bar{\mathcal{V}}\right]\,dv\\
r_{a}^{\gamma} & =\nu^{\gamma}\int_{b}N_{a}\left(1-\varphi^{s}\right)\hat{\zeta}\,dv
\end{aligned}
\,.\label{eq354g}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\mathbf{u}\right] & =\sum_{a}\delta\tilde{p}_{a}\sum_{b}\mathbf{k}_{ab}^{pu}\cdot\Delta\mathbf{u}_{b}\\
 & +\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}\sum_{b}\mathbf{k}_{ab}^{\gamma u}\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\,,\label{eq354h}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{pu} & =\int_{b}N_{a}\left(\hat{\varphi}^{w}\mathbf{I}+\hat{\boldsymbol{\varphi}}_{\varepsilon}^{w}\right)\cdot\grad N_{b}\,dv\\
 & +\bar{\mathcal{V}}\int_{a}N_{a}\left[\hat{\zeta}\mathbf{I}+J\varphi^{w}\hat{\boldsymbol{\zeta}}_{\varepsilon}\right]\cdot\grad N_{b}\,dv\\
\mathbf{k}_{ab}^{\gamma u} & =\nu^{\gamma}\int_{a}N_{a}\left[\left(1-\frac{\partial\varphi_{r}^{s}}{\partial J}\right)\hat{\zeta}\mathbf{I}+J\varphi^{w}\hat{\boldsymbol{\zeta}}_{\varepsilon}\right]\cdot\grad N_{b}\,dv
\end{aligned}
\,.\label{eq354i}
\end{equation}

\end_inset

Then,
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\tilde{p}\right]=\sum_{a}\delta\tilde{p}_{a}\sum_{b}k_{ab}^{pp}\Delta\tilde{p}_{b}\,,\label{eq354j}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
k_{ab}^{pp}=\int_{b}N_{a}\,\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{p}}N_{b}\,dv\,.\label{eq354k}
\end{equation}

\end_inset

Finally,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G\left[\Delta\tilde{c}^{\iota}\right] & =\sum_{a}\delta\tilde{p}_{a}\sum_{b}k_{ab}^{p\iota}\Delta\tilde{c}_{b}^{\iota}\\
 & +\sum_{\gamma}\sum_{a}\delta\tilde{c}_{a}^{\gamma}\sum_{b}k_{ab}^{\gamma\iota}\Delta\tilde{c}_{b}^{\iota}
\end{aligned}
\,,\label{eq354l}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ab}^{p\iota} & =\int_{b}N_{a}N_{b}\frac{\partial\hat{\varphi}^{w}}{\partial\tilde{c}^{\iota}}\,dv+\bar{\mathcal{V}}\int_{b}N_{a}N_{b}\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}\,dv\\
k_{ab}^{\gamma\iota} & =\nu^{\gamma}\int_{b}N_{a}N_{b}\left(\left(1-\varphi^{s}\right)\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\iota}}-\frac{1}{J}\frac{\partial\varphi_{r}^{s}}{\partial\tilde{c}^{\iota}}\hat{\zeta}\right)\,dv
\end{aligned}
\,.\label{eq354m}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Updating Solid-Bound Molecule Concentrations
\end_layout

\begin_layout Standard
The solid-bound molecule concentrations 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 are evaluated at integration points of each element; they do not represent
 nodal degrees of freedom.
 The values of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 are updated at the end of each iteration in the solution of the nonlinear
 equations for the nodal degrees of freedom, using trapezoidal integration
 on 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq155"

\end_inset

.
 According to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq164"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq166"

\end_inset

, we have 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}=\left(J-\varphi_{r}^{s}\right)M^{\sigma}\nu^{\sigma}\hat{\zeta}$
\end_inset

, which is evaluated as the average of values at 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

, then
\begin_inset Formula 
\begin{equation}
\left(\rho_{r}^{\sigma}\right)_{n+1}=\left(\rho_{r}^{\sigma}\right)_{n}+\left(\hat{\rho}_{r}^{\sigma}\right)_{n+\frac{1}{2}}\Delta t\label{eq:sbm-incremental-eq}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

.
\end_layout

\begin_layout Section
Computational Fluid Dynamics
\begin_inset CommandInset label
LatexCommand label
name "sec:Computational-Fluid-Dynamics"

\end_inset


\end_layout

\begin_layout Standard
A more detailed description of the FEBio fluid solver can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Weak Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Weak-Formulation"

\end_inset


\end_layout

\begin_layout Standard
The nodal unknowns in this formulation are 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 (or 
\begin_inset Formula $e$
\end_inset

), which may be solved using the momentum balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:momentum-balance"

\end_inset

 and the kinematic constraint between 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

.
 The virtual work integral for a Galerkin finite element formulation 
\begin_inset CommandInset citation
LatexCommand cite
key "Bonet97"
literal "true"

\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{\Omega}\delta\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)dv\\
 & +\int_{\Omega}\delta J\left(\frac{\dot{J}}{J}-\divg\mathbf{v}\right)dv\,,
\end{aligned}
\label{eq:virtual work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is a virtual velocity and 
\begin_inset Formula $\delta J$
\end_inset

 is a virtual energy density; 
\begin_inset Formula $\Omega$
\end_inset

 is the fluid finite element domain and 
\begin_inset Formula $dv$
\end_inset

 is a differential volume in 
\begin_inset Formula $\Omega$
\end_inset

.
 This virtual work statement may be directly related to the axiom of energy
 balance, specialized to conditions of isothermal flow of viscous compressible
 fluids (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Energy-Balance"

\end_inset

).
 Using the divergence theorem, we may rewrite the weak form of this integral
 as the difference between external and internal virtual work, 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{\Omega}\boldsymbol{\tau}:\grad\delta\mathbf{v}\,dv+\int_{\Omega}\delta\mathbf{v}\cdot\left(\grad p+\rho\mathbf{a}\right)\,dv\\
 & -\int_{\Omega}\left(\delta J\frac{\dot{J}}{J}+\grad\delta J\cdot\mathbf{v}\right)\,dv\,,
\end{aligned}
\label{eq:virtual-work-internal-1}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{t}^{\tau}\,da+\int_{\Omega}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv-\int_{\partial\Omega}\delta J\,v_{n}\,da\,.\label{eq:virtual-work-external-1}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\partial\Omega$
\end_inset

 is the boundary of 
\begin_inset Formula $\Omega$
\end_inset

 and 
\begin_inset Formula $da$
\end_inset

 is a differential area on 
\begin_inset Formula $\partial\Omega$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the viscous component of the traction 
\begin_inset Formula $\mathbf{t}$
\end_inset

, and 
\begin_inset Formula $v_{n}=\mathbf{v}\cdot\mathbf{n}$
\end_inset

 is the velocity normal to the boundary 
\begin_inset Formula $\partial\Omega$
\end_inset

, with 
\begin_inset Formula $\mathbf{n}$
\end_inset

 representing the outward normal on 
\begin_inset Formula $\partial\Omega$
\end_inset

.
 From these expressions, it becomes evident that essential (Dirichlet) boundary
 conditions may be prescribed on 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

, while natural (Neumann) boundary conditions may be prescribed on 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $v_{n}$
\end_inset

.
 The appearance of velocity in both essential and natural boundary conditions
 may seem surprising at first.
 To better understand the nature of these boundary conditions, it is convenient
 to separate the velocity into its normal and tangential components, 
\begin_inset Formula $\mathbf{v}=v_{n}\mathbf{n}+\mathbf{v}_{t}$
\end_inset

, where 
\begin_inset Formula $\mathbf{v}_{t}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{v}$
\end_inset

.
 In particular, for inviscid flow, the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 and its corresponding traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 are both zero, leaving 
\begin_inset Formula $v_{n}$
\end_inset

 as the sole natural boundary condition; similarly, 
\begin_inset Formula $J$
\end_inset

 becomes the only essential boundary condition in such flows, since 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 is unknown 
\emph on
a priori
\emph default
 on a frictionless boundary and must be obtained from the solution of the
 analysis.
 
\end_layout

\begin_layout Standard
In general, prescribing 
\begin_inset Formula $J$
\end_inset

 is equivalent to prescribing the elastic fluid pressure, since 
\begin_inset Formula $p$
\end_inset

 is only a function of 
\begin_inset Formula $J$
\end_inset

.
 On a boundary where no conditions are prescribed explicitly, we conclude
 that 
\begin_inset Formula $v_{n}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, which represents a frictionless wall.
 Conversely, it is possible to prescribe 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 on a boundary to produce a desired inflow or outflow while simultaneously
 stabilizing the flow conditions by prescribing a suitable viscous traction.
 Prescribing essential boundary conditions 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 determines the tangential velocity on a boundary as well as the elastic
 fluid pressure 
\begin_inset Formula $p$
\end_inset

, leaving the option to also prescribe the normal component of the viscous
 traction, 
\begin_inset Formula $t_{n}^{\tau}=\mathbf{t}^{\tau}\cdot\mathbf{n}$
\end_inset

, to completely determine the normal traction 
\begin_inset Formula $t_{n}=\mathbf{t}\cdot\mathbf{n}$
\end_inset

 (or else 
\begin_inset Formula $t_{n}^{\tau}$
\end_inset

 naturally equals zero).
 Mixed boundary conditions represent common physical features: Prescribing
 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 completely determines the velocity 
\begin_inset Formula $\mathbf{v}$
\end_inset

 on a boundary; prescribing 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 completely determines the traction 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 on a boundary.
 Note that 
\begin_inset Formula $v_{n}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 are mutually exclusive boundary conditions, and the same holds for 
\begin_inset Formula $\mathbf{v}_{t}$
\end_inset

 and the tangential component of the viscous traction, 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{t}^{\tau}$
\end_inset

.
\end_layout

\begin_layout Subsection
Temporal Discretization and Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Discretization-Linearization"

\end_inset


\end_layout

\begin_layout Standard
The time derivatives, 
\begin_inset Formula $\partial\mathbf{v}/\partial t$
\end_inset

 which appears in the expression for 
\begin_inset Formula $\mathbf{a}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:acceleration"

\end_inset

, and 
\begin_inset Formula $\partial J/\partial t$
\end_inset

 which similarly appears in 
\begin_inset Formula $\dot{J}$
\end_inset

, may be discretized upon the choice of a time integration scheme, such
 as the generalized-
\begin_inset Formula $\alpha$
\end_inset

 method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"

\end_inset

).
 In this scheme, 
\begin_inset Formula $\delta W$
\end_inset

 is evaluated at an intermediate time step 
\begin_inset Formula $t_{n+\alpha}=\alpha t_{n+1}+\left(1-\alpha\right)t_{n}$
\end_inset

 between the current time step 
\begin_inset Formula $t_{n+1}$
\end_inset

 and previous time step 
\begin_inset Formula $t_{n}$
\end_inset

, though different values of 
\begin_inset Formula $\alpha$
\end_inset

 are used for the primary variables and their time derivatives.
 The velocity and volume ratio are evaluated as 
\begin_inset Formula $\mathbf{v}_{n+\alpha_{f}}$
\end_inset

 and 
\begin_inset Formula $J_{n+\alpha_{f}}$
\end_inset

 at the intermediate time step 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

, whereas their time derivatives are evaluated as 
\begin_inset Formula $\left(\partial\mathbf{v}/\partial t\right)_{n+\alpha_{m}}$
\end_inset

 and 
\begin_inset Formula $\left(\partial J/\partial t\right)_{n+\alpha_{m}}$
\end_inset

 at the intermediate time step 
\begin_inset Formula $t_{n+\alpha_{m}}$
\end_inset

.
 The parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from the spectral radius for an infinite time step, 
\begin_inset Formula $\rho_{\infty}$
\end_inset

, as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The solution of the nonlinear equation 
\begin_inset Formula $\delta W=0$
\end_inset

 is obtained by linearizing this relation as
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{v}\right]+D\delta W\left[\Delta J\right]\approx0\,,\label{eq:linearized-virtual-work}
\end{equation}

\end_inset

where the operator 
\begin_inset Formula $D\delta W\left[\cdot\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $\delta W$
\end_inset

 at 
\begin_inset Formula $\left(\mathbf{v},J\right)$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 of 
\begin_inset Formula $\mathbf{v}$
\end_inset

, or 
\begin_inset Formula $\Delta J$
\end_inset

 of 
\begin_inset Formula $J$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Bonet97"
literal "true"

\end_inset

.
 The aim of this analysis is to solve for the velocity 
\begin_inset Formula $\mathbf{v}_{n+1}$
\end_inset

 and volume ratio 
\begin_inset Formula $J_{n+1}$
\end_inset

 at the current time step 
\begin_inset Formula $t_{n+1}$
\end_inset

.
 Using the split form of 
\begin_inset Formula $\delta W$
\end_inset

 between external and internal work contributions, this relation may be
 expanded as
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\delta W_{int}\left[\Delta\mathbf{v}\right]+D\delta W_{int}\left[\Delta J\right]-D\delta W_{ext}\left[\Delta\mathbf{v}\right]\\
 & -D\delta W_{ext}\left[\Delta J\right]\approx\delta W_{ext}-\delta W_{int}\,.
\end{aligned}
\label{eq:linearized-work-split}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In this framework the finite element mesh is defined on the spatial domain
 
\begin_inset Formula $\Omega$
\end_inset

, which is fixed (time-invariant) in conventional CFD treatments.
 Thus, we can linearize 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 in the velocity 
\begin_inset Formula $\mathbf{v}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\Delta J$
\end_inset

 in the volume ratio 
\begin_inset Formula $J_{n+1}$
\end_inset

, by simply bringing the directional derivative operator into the integrals
 of eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-internal-1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-external-1"

\end_inset

.
 The linearization of 
\begin_inset Formula $\mathbf{v}_{n+\alpha_{f}}$
\end_inset

 and 
\begin_inset Formula $J_{n+\alpha_{f}}$
\end_inset

 is given by
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{v}_{n+\alpha_{f}}\left[\Delta\mathbf{v}\right] & =\alpha_{f}\Delta\mathbf{v}\\
DJ_{n+\alpha_{f}}\left[\Delta J\right] & =\alpha_{f}\Delta J
\end{aligned}
\]

\end_inset

whereas that of 
\begin_inset Formula $\left(\partial\mathbf{v}/\partial t\right)_{n+\alpha_{m}}$
\end_inset

 and 
\begin_inset Formula $\left(\partial J/\partial t\right)_{n+\alpha_{m}}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\mathbf{v}}{dt}\right)_{n+\alpha_{m}}\left[\Delta\mathbf{v}\right]=\frac{\alpha_{m}}{\gamma}\frac{\Delta\mathbf{v}}{\Delta t}\,,\label{eq:discretized-a}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial J}{\partial t}\right)_{n+\alpha_{m}}\left[\Delta\mathbf{v}\right]=\frac{\alpha_{m}}{\gamma}\frac{\Delta J}{\Delta t}\,.\label{eq:discretized-J}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\Delta t$
\end_inset

 is the current time increment and 
\begin_inset Formula $\gamma$
\end_inset

 is the Newmark integration parameter 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 is then
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{v}\right] & =\alpha_{f}\int_{\Omega}\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}^{\tau}:\grad\Delta\mathbf{v}\,dv\\
 & +\alpha_{f}\int_{\Omega}\delta\mathbf{v}\cdot\rho\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\mathbf{I}}{\Delta t}+\mathbf{L}\right)\cdot\Delta\mathbf{v}+\grad\Delta\mathbf{v}\cdot\mathbf{v}\right)\,dv\\
 & -\alpha_{f}\int_{\Omega}\left(\frac{\delta J}{J}\grad J+\grad\delta J\right)\cdot\Delta\mathbf{v}\,dv
\end{aligned}
\label{eq:Wint-linearization-v}
\end{equation}

\end_inset

where we have introduced the fourth-order tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 representing the tangent of the viscous stress with respect to the rate
 of deformation, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{\tau}=\frac{\partial\boldsymbol{\tau}}{\partial\mathbf{D}}\,.\label{eq:stress-tangent-D}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 exhibits minor symmetries because of the symmetries of 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}$
\end_inset

; in Cartesian components, we have 
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}=\mathcal{C}_{jikl}^{\tau}$
\end_inset

 and 
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}=\mathcal{C}_{ijlk}^{\tau}$
\end_inset

.
 In general, 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 does not exhibit major symmetry (
\begin_inset Formula $\mathcal{C}_{ijkl}^{\tau}\ne\mathcal{C}_{klij}^{\tau}$
\end_inset

), though the common constitutive relations adopted in fluid mechanics produce
 such symmetry as shown below.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta J$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta J\right] & =\alpha_{f}\int_{b}\Delta J\,\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{v}\,dv-\alpha_{f}\int_{\Omega}\delta\mathbf{v}\cdot\Delta J\frac{\rho}{J}\mathbf{a}\,dv\\
 & +\alpha_{f}\int_{\Omega}\delta\mathbf{v}\cdot\left(p^{\prime}\grad\Delta J+\Delta J\,p^{\prime\prime}\grad J\right)\,dv\\
 & -\alpha_{f}\int_{\Omega}\frac{\delta J}{J}\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}-\frac{\dot{J}}{J}\right)\Delta J+\grad\Delta J\cdot\mathbf{v}\right)\,dv
\end{aligned}
\label{eq:Wint-linearization-J}
\end{equation}

\end_inset

where we have used 
\begin_inset Formula $DJ\left[\Delta J\right]=\Delta J$
\end_inset

; 
\begin_inset Formula $p^{\prime}$
\end_inset

 and 
\begin_inset Formula $p^{\prime\prime}$
\end_inset

 respectively represent the first and second derivatives of 
\begin_inset Formula $p\left(J\right)$
\end_inset

.
 We have also defined 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}$
\end_inset

 as the tangent of the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 with respect to 
\begin_inset Formula $J$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{J}^{\prime}=\frac{\partial\boldsymbol{\tau}}{\partial J}\,.\label{eq:stress-tangent-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work, when 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

, 
\begin_inset Formula $\mathbf{b}$
\end_inset

 and 
\begin_inset Formula $v_{n}$
\end_inset

 are prescribed, these linearizations simplify to
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta\mathbf{v}\right]=0\,,\label{eq:Wext-linearization-v}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta J\right]=-\alpha_{f}\int_{b}\delta\mathbf{v}\cdot\Delta J\,\frac{\rho}{J}\mathbf{b}\,dv\,.\label{eq:Wext-linearization-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We may define the fluid dilatation 
\begin_inset Formula $e=J-1$
\end_inset

 as an alternative essential variable, since initial and boundary conditions
 
\begin_inset Formula $e=0$
\end_inset

 are more convenient to handle in a numerical scheme than 
\begin_inset Formula $J=1$
\end_inset

.
 It follows that 
\begin_inset Formula $\grad J=\grad e$
\end_inset

 and 
\begin_inset Formula $\partial J/\partial t=\partial e/\partial t$
\end_inset

.
 Therefore the changes to the above equations are minimal, simply requiring
 the substitution 
\begin_inset Formula $J=1+e$
\end_inset

 and 
\begin_inset Formula $\Delta J=\Delta e$
\end_inset

.
 Steady-state analyses may be obtained by setting the terms involving 
\begin_inset Formula $\Delta t^{-1}$
\end_inset

 to zero in eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-a"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discretized-J"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-v"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

.
\end_layout

\begin_layout Subsection
Spatial Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Spatial-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The velocity 
\begin_inset Formula $\mathbf{v}\left(\mathbf{x},t\right)$
\end_inset

 and Jacobian 
\begin_inset Formula $J\left(\mathbf{x},t\right)$
\end_inset

 are spatially interpolated over the domain 
\begin_inset Formula $\Omega$
\end_inset

 using the same interpolation functions 
\begin_inset Formula $N_{a}\left(\mathbf{x}\right)$
\end_inset

, with 
\begin_inset Formula $a=1$
\end_inset

 to 
\begin_inset Formula $n$
\end_inset

 where 
\begin_inset Formula $n$
\end_inset

 is the number of nodes in an element),
\begin_inset Formula 
\begin{equation}
\mathbf{v}\left(\mathbf{x},t\right)=\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)\mathbf{v}_{a}\,,\quad J\left(\mathbf{x},t\right)=\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)J_{a}\,.\label{eq:v-J-interpolation}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{v}_{a}$
\end_inset

 and 
\begin_inset Formula $J_{a}$
\end_inset

 are nodal values of 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 that evolve with time.
 In contrast to classical mixed formulations for incompressible flow 
\begin_inset CommandInset citation
LatexCommand cite
key "Reddy01"
literal "true"

\end_inset

, which solve for the pressure 
\begin_inset Formula $p$
\end_inset

 using 
\begin_inset Formula $\divg\mathbf{v}=0$
\end_inset

 instead of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:divv-kinematic-relation"

\end_inset

, equal order interpolation is acceptable in this formulation since the
 governing equations for 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

 involve spatial derivatives of both variables (
\begin_inset Formula $\grad\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\grad J$
\end_inset

).
 The expressions of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:v-J-interpolation"

\end_inset

 may be used to evaluate 
\begin_inset Formula $\mathbf{L}$
\end_inset

, 
\begin_inset Formula $\divg\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\mathbf{a}$
\end_inset

, 
\begin_inset Formula $\grad J$
\end_inset

, 
\begin_inset Formula $\dot{J}$
\end_inset

, etc.
 Similar interpolations are used for virtual increments 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\delta J$
\end_inset

, as well as real increments 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $\Delta J$
\end_inset

.
\end_layout

\begin_layout Standard
When substituted into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-internal"

\end_inset

, we find that the discretized form of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 may be written as
\begin_inset Formula 
\begin{equation}
\delta W_{int}=\sum_{a}\delta\mathbf{v}_{a}\cdot\left(\mathbf{f}_{a}^{\sigma}+\mathbf{f}_{a}^{\rho}\right)+f_{a}^{J}\delta J_{a}\,,\label{eq:discretized-Wint}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\sigma} & =\int_{\Omega}\left(\boldsymbol{\tau}\cdot\grad N_{a}+N_{a}\grad p\right)\,dv\,,\\
\mathbf{f}_{a}^{\rho} & =\int_{\Omega}N_{a}\rho\mathbf{a}\,dv\,,\\
f_{a}^{J} & =\int_{\Omega}-\left(N_{a}\frac{\dot{J}}{J}+\grad N_{a}\cdot\mathbf{v}\right)\,dv\,.
\end{aligned}
\label{eq:discretized-internal-forces}
\end{equation}

\end_inset

Similarly, the discretized form of 
\begin_inset Formula $D\delta W_{int}\left[\Delta\mathbf{v}\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-v"

\end_inset

 becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{v}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\left(\mathbf{K}_{ab}^{vv}+\mathbf{M}_{ab}^{vv}\right)\cdot\Delta\mathbf{v}_{b}\\
 & +\sum_{a}\delta J_{a}\sum_{b}\mathbf{k}_{ab}^{Jv}\cdot\Delta\mathbf{v}_{b}\,,
\end{aligned}
\label{eq:discretized-DWint-v}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{vv} & =\alpha_{f}\int_{\Omega}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{v}\cdot\grad N_{b}\,dv\,,\\
\mathbf{M}_{ab}^{vv} & =\alpha_{f}\int_{\Omega}N_{a}\rho\left(N_{b}\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\mathbf{I}}{\Delta t}+\grad\mathbf{v}\right)+\left(\grad N_{b}\cdot\mathbf{v}\right)\mathbf{I}\right)\,dv\,,\\
\mathbf{k}_{ab}^{Jv} & =-\alpha_{f}\int_{\Omega}\left(\frac{N_{a}}{J}\grad J+\grad N_{a}\right)N_{b}\,dv\,,
\end{aligned}
\label{eq:discretized-stiffness-v}
\end{equation}

\end_inset

whereas that of 
\begin_inset Formula $D\delta W_{int}\left[\Delta J\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

 becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta J\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\left(\mathbf{k}_{ab}^{vJ}+\mathbf{m}_{ab}^{vJ}\right)\,\Delta J_{b}\\
 & +\sum_{a}\delta J_{a}\sum_{b}k_{ab}^{JJ}\,\Delta J_{b}
\end{aligned}
\label{eq:discretized-DWint-J}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{vJ} & =\alpha_{f}\int_{\Omega}\left[N_{b}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}+N_{a}\left(p^{\prime}\grad N_{b}+N_{b}p^{\prime\prime}\grad J\right)\right]\,dv\,,\\
\mathbf{m}_{ab}^{vJ} & =-\alpha_{f}\int_{\Omega}N_{a}N_{b}\frac{\rho}{J}\mathbf{a}\,dv\,,\\
k_{ab}^{JJ} & =-\alpha_{f}\int_{\Omega}\frac{N_{a}}{J}\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}-\frac{\dot{J}}{J}\right)N_{b}+\grad N_{b}\cdot\mathbf{v}\right)\,dv\,.
\end{aligned}
\label{eq:discretized-stiffness-J}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:virtual-work-external"

\end_inset

, its discretized form is
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\sum_{a}\delta\mathbf{v}_{a}\cdot\left(\mathbf{f}_{a}^{\text{t}}+\mathbf{f}_{a}^{\text{b}}\right)+\delta J_{a}f_{a}^{v}\,,\label{eq:discretized-Wext}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\text{t}} & =\int_{\partial\Omega}N_{a}\mathbf{t}^{\tau}\,da\,,\\
\mathbf{f}_{a}^{\text{b}} & =\int_{\Omega}N_{a}\rho\mathbf{b}\,dv\,,\\
f_{a}^{v} & =-\int_{\Omega}N_{a}v_{n}\,da\,.
\end{aligned}
\label{eq:discretized-external-forces}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $D\left(\delta W_{ext}\right)\left[\Delta J\right]$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wext-linearization-J"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\left(\delta W_{ext}\right)\left[\Delta J\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{\text{b}}\,\Delta J_{b}\,,\label{eq:discretized-DWext-J}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{\text{b}}=-\alpha_{f}\int_{\Omega}N_{a}N_{b}\frac{\rho}{J}\mathbf{b}\,dv\,.\label{eq:discretized-stiffness-ext}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Special Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Special-Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Subsubsection
Backflow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Backflow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
For arterial blood flow, backflow stabilization has been proposed previously
 to deal with truncated domains where the entire artery is not modeled explicitl
y 
\begin_inset CommandInset citation
LatexCommand cite
key "Bazilevs09,Esmaily-Moghadam11"
literal "true"

\end_inset

; for these types of problems, letting 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

 or prescribing a constant pressure at the outflow boundary may not prevent
 flow reversals that compromise convergence of an analysis.
 Instead, these authors proposed a velocity-dependent traction boundary
 condition, 
\begin_inset Formula $\mathbf{t}=\beta\rho\left(\mathbf{v}\otimes\mathbf{v}\right)\cdot\mathbf{n}$
\end_inset

 with a tensile normal component, that counters the backflow (only when
 
\begin_inset Formula $v_{n}<0$
\end_inset

).
 Here, 
\begin_inset Formula $\beta$
\end_inset

 is a non-dimensional user-defined parameter; a value of 
\begin_inset Formula $\beta=0$
\end_inset

 turns off this feature, while a value of 
\begin_inset Formula $\beta=1$
\end_inset

 generally shows good numerical performance.
 We adapt this previously proposed formulation by letting the normal component
 of the viscous traction be given by 
\begin_inset Formula 
\begin{equation}
t_{n}^{\tau}=\begin{cases}
\beta\rho_{r}v_{n}^{2} & v_{n}<0\\
0 & v_{n}\ge0
\end{cases}\,.\label{eq:BFS-normal-traction}
\end{equation}

\end_inset

The choice of 
\begin_inset Formula $\rho_{r}$
\end_inset

 in lieu of 
\begin_inset Formula $\rho$
\end_inset

 is for convenience, to avoid the dependence of 
\begin_inset Formula $\rho$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

 (which is negligible for nearly incompressible flow).
 Then, the contribution of this traction to the virtual external work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{v}\cdot t_{n}^{\tau}\mathbf{n}\,da\,.\label{eq:BFSckflow-virtual-work}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 in the velocity is given by
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{K}_{n}\cdot\Delta\mathbf{v}\,da\,,\label{eq:BFS-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{n}=\begin{cases}
2\beta\rho_{r}v_{n}\left(\mathbf{n}\otimes\mathbf{n}\right) & v_{n}<0\\
\mathbf{0} & v_{n}\ge0
\end{cases}\,.\label{eq:BFS-stiffness}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{n}\,,\quad\mathbf{f}_{a}^{n}=\int_{\partial\Omega}N_{a}t_{n}^{\tau}\mathbf{n}\,da\,,\label{eq:BFS-discretized-work}
\end{equation}

\end_inset

whereas the discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{n}\cdot\Delta\mathbf{v}_{b}\,,\quad\mathbf{K}_{ab}^{n}=\int_{\partial\Omega}N_{a}N_{b}\mathbf{K}_{n}\,da\,.\label{eq:BFS-discretized-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
A (viscous) tangential traction is implemented as a separate flow stabilization
 method in the next section, applicable to inlet or outlet surfaces, without
 a conditional requirement based on the sign of 
\begin_inset Formula $v_{n}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Tangential Flow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Tangential-Flow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
For certain outlet conditions, using the natural boundary condition 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\mathbf{0}$
\end_inset

 may lead to flow instabilities.
 It is possible to minimize these effects by prescribing a tangential viscous
 traction onto the boundary surface, which opposes this tangential flow.
 Optionally, this condition may be combined with the backflow stabilization
 described above.
\end_layout

\begin_layout Standard
Similar to the previous section, we introduce a non-dimensional parameter
 
\begin_inset Formula $\beta$
\end_inset

, with the tangential traction given by 
\begin_inset Formula 
\begin{equation}
\mathbf{t}_{t}^{\tau}=-\beta\rho_{r}\left|\mathbf{v}_{t}\right|\mathbf{v}_{t}\,.\label{eq:tangential-stabilization}
\end{equation}

\end_inset

This form shows that 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}$
\end_inset

 opposes tangential flow.
 The external virtual work for this traction is
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{t}_{t}^{\tau}\,da\,.\label{eq:TS-external-work}
\end{equation}

\end_inset

Its linearization along an increment 
\begin_inset Formula $\Delta\mathbf{v}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\int_{\partial\Omega}\delta\mathbf{v}\cdot\mathbf{K}_{t}\cdot\Delta\mathbf{v}\,da\,,\label{eq:TS-linearization}
\end{equation}

\end_inset

where it can be shown that
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{t}=-\beta\rho_{r}\left|\mathbf{v}_{t}\right|\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}+\frac{\mathbf{v}_{t}}{\left|\mathbf{v}_{t}\right|}\otimes\frac{\mathbf{v}_{t}}{\left|\mathbf{v}_{t}\right|}\right)\,.\label{eq:TS-stiffness}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{\tau}\,,\quad\mathbf{f}_{a}^{\tau}=\int_{\partial\Omega}N_{a}\mathbf{t}_{t}^{\tau}\,da\,.\label{eq:TS-discretized-work}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{t}\cdot\Delta\mathbf{v}_{b}\,,\quad\mathbf{K}_{ab}^{t}=\int_{\partial\Omega}N_{a}N_{b}\mathbf{K}_{t}\,da\,.\label{eq:TS-discretized-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Flow Resistance
\begin_inset CommandInset label
LatexCommand label
name "subsec:CFD-Flow-Resistance"

\end_inset


\end_layout

\begin_layout Standard
Flow resistance is typically implemented when modeling arterial flow, where
 the finite element domain only describes a portion of an arterial network
 
\begin_inset CommandInset citation
LatexCommand cite
key "Vignon-Clementel06"
literal "true"

\end_inset

.
 A flow resistance may be imposed on downstream boundaries to simulate the
 resistance produced by the vascular network with its branches and bifurcations.
 The resistance is equivalent to a mean pressure which is proportional to
 the volumetric flow rate 
\begin_inset Formula $Q$
\end_inset

,
\begin_inset Formula 
\[
p=RQ\,,\quad Q=\int_{\partial\Omega}v_{n}\,da\,,
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is the resistance.
 Using the pressure-dilatation relation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ideal-fluid"

\end_inset

, equivalent to 
\begin_inset Formula $p=-K\cdot e$
\end_inset

, this pressure may be prescribed as an essential boundary condition on
 the dilatation 
\begin_inset Formula $e$
\end_inset

.
\end_layout

\begin_layout Section
Weak Formulation for FSI
\begin_inset CommandInset label
LatexCommand label
name "sec:Weak-Formulation-FSI"

\end_inset


\end_layout

\begin_layout Subsection
General Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:FSI-General-Formulation"

\end_inset


\end_layout

\begin_layout Standard
The strong form of the virtual work statement is 
\begin_inset Formula $\delta W=0$
\end_inset

 where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{b}\delta\mathbf{v}^{s}\cdot\divg\boldsymbol{\sigma}^{s}\,dv\\
 & +\int_{b}\delta\mathbf{w}\cdot\left[\divg\boldsymbol{\sigma}^{f}+\rho^{f}\left(\mathbf{b}-\mathbf{a}^{f}\right)\right]\,dv\\
 & -\int_{b}\delta J^{f}\left[\frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\divg\mathbf{w}-\frac{\dot{J}^{s}}{J^{s}}\right]\,dv
\end{aligned}
\,.\label{eq:fsi-virtual-work-strong}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $b$
\end_inset

 is the mixture domain (whose boundaries are defined on the solid), 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

 is the virtual solid velocity, 
\begin_inset Formula $\delta\mathbf{w}$
\end_inset

 is the virtual relative fluid velocity, and 
\begin_inset Formula $\delta J^{f}$
\end_inset

 is the virtual energy density.
 The weak form of this statement may be written as the difference 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

 between external virtual work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 and internal virtual work 
\begin_inset Formula $\delta W_{int}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{b}\boldsymbol{\sigma}^{s}:\grad\delta\mathbf{v}^{s}\,dv\\
 & +\int_{b}\boldsymbol{\tau}:\grad\delta\mathbf{w}\,dv+\int_{b}\delta\mathbf{w}\cdot\left(\grad p+\rho^{f}\mathbf{a}^{f}\right)\,dv\\
 & +\int_{b}\delta J^{f}\left[\frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\frac{\dot{J}^{s}}{J^{s}}\right]\,dv\\
 & +\int_{b}\mathbf{w}\cdot\grad\delta J^{f}\,dv
\end{aligned}
\,,\label{eq:fsi-internal-virtual-work}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext} & =\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}^{s}\,da\\
 & +\int_{\partial b}\delta\mathbf{w}\cdot\mathbf{t}^{\tau}\,da+\int_{b}\delta\mathbf{w}\cdot\rho^{f}\mathbf{b}\,dv\\
 & +\int_{\partial b}\delta J^{f}w_{n}\,da
\end{aligned}
\,.\label{eq:fsi-external-virtual-work}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{t}^{s}=\boldsymbol{\sigma}^{s}\cdot\mathbf{n}$
\end_inset

 is the solid traction, 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the fluid viscous traction, and 
\begin_inset Formula $w_{n}=\mathbf{w}_{n}\cdot\mathbf{n}$
\end_inset

 is the normal component of the relative fluid velocity on the boundary
 
\begin_inset Formula $\partial b$
\end_inset

, whose outward unit normal is 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 In practice, both 
\begin_inset Formula $\boldsymbol{\sigma}^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{s}$
\end_inset

 should contribute negligibly to 
\begin_inset Formula $\delta W$
\end_inset

, but they cannot be set exactly to zero since we need some small elasticity
 to regularize the deforming mixture mesh.
\end_layout

\begin_layout Subsection
Time Integration
\begin_inset CommandInset label
LatexCommand label
name "subsec:FSI-Time-Integration"

\end_inset


\end_layout

\begin_layout Standard
In the generalized 
\begin_inset Formula $\alpha-$
\end_inset

method we evaluate displacements and velocities at the intermediate time
 
\begin_inset Formula $t_{n+\alpha_{f}}=t_{n}+\alpha_{f}\left(t_{n+1}-t_{n}\right)$
\end_inset

, such that
\begin_inset Formula 
\[
\begin{aligned}\boldsymbol{\chi}_{n+\alpha_{f}}^{s} & =\left(1-\alpha_{f}\right)\boldsymbol{\chi}_{n}^{s}+\alpha_{f}\boldsymbol{\chi}_{n+1}^{s}\\
\mathbf{u}_{n+\alpha_{f}}^{s} & =\left(1-\alpha_{f}\right)\mathbf{u}_{n}^{s}+\alpha_{f}\mathbf{u}_{n+1}^{s}\\
\mathbf{v}_{n+\alpha_{f}}^{s} & =\left(1-\alpha_{f}\right)\mathbf{v}_{n}^{s}+\alpha_{f}\mathbf{v}_{n+1}^{s}\\
\mathbf{w}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{w}_{n}+\alpha_{f}\mathbf{w}_{n+1}\\
J_{n+\alpha_{f}}^{f} & =\left(1-\alpha_{f}\right)J_{n}^{f}+\alpha_{f}J_{n+1}^{f}
\end{aligned}
\]

\end_inset

In particular, it follows that
\begin_inset Formula 
\[
\mathbf{F}_{n+\alpha_{f}}^{s}=\frac{\partial\boldsymbol{\chi}_{n+\alpha_{f}}^{s}}{\partial\mathbf{X}}=\left(1-\alpha_{f}\right)\mathbf{F}_{n}^{s}+\alpha_{f}\mathbf{F}_{n+1}^{s}
\]

\end_inset


\begin_inset Formula 
\[
J_{n+\alpha_{f}}^{s}=\det\mathbf{F}_{n+\alpha_{f}}^{s}
\]

\end_inset


\begin_inset Formula 
\[
\dot{J}_{n+\alpha_{f}}^{s}=J_{n+\alpha_{f}}^{s}\mathbf{F}_{n+\alpha_{f}}^{-T}:\Grad\mathbf{v}_{n+\alpha_{f}}^{s}
\]

\end_inset


\begin_inset Formula 
\[
\mathbf{L}_{n+\alpha_{f}}^{s}=\Grad\mathbf{v}_{n+\alpha_{f}}^{s}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}
\]

\end_inset

In practice however, we get better numerical results when using
\begin_inset Formula 
\[
\dot{J}_{n+\alpha_{f}}^{s}=\frac{J_{n+1}^{s}-J_{n}^{s}}{\Delta t}
\]

\end_inset


\begin_inset Formula 
\[
\mathbf{L}_{n+\alpha_{f}}^{s}=\frac{\mathbf{F}_{n+1}-\mathbf{F}_{n}}{\Delta t}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}
\]

\end_inset

Similarly, we evaluate velocity derivatives at the intermediate time 
\begin_inset Formula $t_{n+\alpha_{m}}=t_{n}+\alpha_{m}\left(t_{n+1}-t_{n}\right)$
\end_inset

, such that
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{v}}_{n+\alpha_{m}}^{s} & =\left(1-\alpha_{m}\right)\dot{\mathbf{v}}_{n}^{s}+\alpha_{m}\dot{\mathbf{v}}_{n+1}^{s}\\
\dot{\mathbf{w}}_{n+\alpha_{m}} & =\left(1-\alpha_{m}\right)\dot{\mathbf{w}}_{n}+\alpha_{m}\dot{\mathbf{w}}_{n+1}\\
\dot{J}_{n+\alpha_{m}}^{f} & =\left(1-\alpha_{m}\right)\dot{J}_{n}^{f}+\alpha_{m}\dot{J}_{n+1}^{f}
\end{aligned}
\]

\end_inset

The parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from a single parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 using
\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{1}{2}\frac{3-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:fsi-ga-alphas-1st}
\end{equation}

\end_inset

for first-order systems, or
\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{2-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:fsi-ga-alphas-2nd}
\end{equation}

\end_inset

for second-order systems, where 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

.
 This parameter is the spectral radius for an infinite time step, which
 controls the amount of damping of high frequencies; a value of zero produces
 the greatest amount of damping, anihilating the highest frequency in one
 step, whereas a value of one preserves the highest frequency.
 Since the solid motion is governed by a second-order differential equation
 in time, we adopt the formulas for second-order systems.
\end_layout

\begin_layout Standard
To complete the integration scheme, we evaluate
\begin_inset Formula 
\[
\begin{aligned}\beta & =\frac{1}{4}\left(1+\alpha_{m}-\alpha_{f}\right)^{2}\\
\gamma & =\frac{1}{2}+\alpha_{m}-\alpha_{f}
\end{aligned}
\]

\end_inset

then
\begin_inset Formula 
\[
\begin{aligned}\mathbf{v}_{n+1}^{s} & =\mathbf{v}_{n}^{s}+\Delta t\left[\left(1-\gamma\right)\dot{\mathbf{v}}_{n}^{s}+\gamma\dot{\mathbf{v}}_{n+1}^{s}\right]\\
\mathbf{u}_{n+1}^{s} & =\mathbf{u}_{n}^{s}+\Delta t\mathbf{v}_{n}^{s}+\frac{\Delta t^{2}}{2}\left[\left(1-2\beta\right)\dot{\mathbf{v}}_{n}^{s}+2\beta\dot{\mathbf{v}}_{n+1}^{s}\right]\\
\mathbf{w}_{n+1} & =\mathbf{w}_{n}+\Delta t\left[\left(1-\gamma\right)\dot{\mathbf{w}}_{n}+\gamma\dot{\mathbf{w}}_{n+1}\right]\\
J_{n+1}^{f} & =J_{n}^{f}+\Delta t\left[\left(1-\gamma\right)\dot{J}_{n}^{f}+\gamma\dot{J}_{n+1}^{f}\right]
\end{aligned}
\]

\end_inset

Thus,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{v}}_{n+1}^{s} & =\frac{1}{\beta\Delta t}\left(\frac{\mathbf{u}_{n+1}^{s}-\mathbf{u}_{n}^{s}}{\Delta t}-\mathbf{v}_{n}^{s}\right)+\left(1-\frac{1}{2\beta}\right)\dot{\mathbf{v}}_{n}^{s}\\
\dot{\mathbf{w}}_{n+1} & =\frac{\mathbf{w}_{n+1}-\mathbf{w}_{n}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{\mathbf{w}}_{n}=\frac{\mathbf{w}_{n+\alpha_{f}}-\mathbf{w}_{n}}{\alpha_{f}\gamma\Delta t}-\left(\frac{1}{\gamma}-1\right)\dot{\mathbf{w}}_{n}\\
\dot{J}_{n+1}^{f} & =\frac{J_{n+1}^{f}-J_{n}^{f}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{J}_{n}^{f}=\frac{J_{n+\alpha_{f}}^{f}-J_{n}^{f}}{\alpha_{f}\gamma\Delta t}-\left(\frac{1}{\gamma}-1\right)\dot{J}_{n}^{f}
\end{aligned}
\]

\end_inset

According to this method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

, the virtual work is evaluated using intermediate time step values, at
 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

 for all parameters except 
\begin_inset Formula $\dot{\mathbf{v}}^{s}$
\end_inset

, 
\begin_inset Formula $\dot{\mathbf{w}}$
\end_inset

, and 
\begin_inset Formula $\dot{J}^{f}$
\end_inset

, which are evaluated at 
\begin_inset Formula $t_{n+\alpha_{m}}$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\end_layout

\begin_layout Standard
The discretization of the internal work produces
\begin_inset Formula 
\begin{equation}
\delta W_{int}=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\int_{b}\mathbf{f}_{a}^{u}\,dv+\delta\mathbf{w}_{a}\cdot\int_{b}\mathbf{f}_{a}^{w}\,dv+\delta J_{a}^{f}\int_{b}f_{a}^{J}\,dv\label{eq:fsi-discretized-internal-work}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\delta W_{int} & =\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\int_{b}\boldsymbol{\sigma}^{s}\cdot\grad N_{a}\,dv\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\int_{b}\boldsymbol{\tau}\cdot\grad N_{a}\,dv+\sum_{a}\delta\mathbf{w}_{a}\cdot\int_{b}N_{a}\left(\grad p+\rho^{f}\mathbf{a}^{f}\right)\,dv\\
 & +\sum_{a}\delta J_{a}^{f}\int_{b}N_{a}\left[\frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\frac{\dot{J}^{s}}{J^{s}}\right]\,dv\\
 & +\sum_{a}\delta J_{a}^{f}\int_{b}\mathbf{w}\cdot\grad N_{a}\,dv
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u} & =\boldsymbol{\sigma}^{s}\cdot\grad N_{a}\\
\mathbf{f}_{a}^{w} & =\boldsymbol{\tau}\cdot\grad N_{a}+N_{a}\left(\grad p+\rho^{f}\mathbf{a}^{f}\right)\\
f_{a}^{J} & =N_{a}\left[\frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\frac{\dot{J}^{s}}{J^{s}}\right]+\mathbf{w}\cdot\grad N_{a}
\end{aligned}
\label{eq:fsi-discretized-residuals}
\end{equation}

\end_inset

We used the following interpolations:
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{s} & =\sum_{a}N_{a}\delta\mathbf{v}_{a}^{s} & \Delta\mathbf{u} & =\sum_{b}N_{b}\Delta\mathbf{u}_{b}\\
\grad\delta\mathbf{v}^{s} & =\sum_{a}\delta\mathbf{v}_{a}^{s}\otimes\grad N_{a} & \grad\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\otimes\grad N_{b}\\
\divg\delta\mathbf{v}^{s} & =\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\grad N_{a} & \divg\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\cdot\grad N_{b}\\
\delta\mathbf{w} & =\sum_{a}N_{a}\delta\mathbf{w}_{a} & \Delta\mathbf{w} & =\sum_{b}N_{b}\Delta\mathbf{w}_{b}\\
\grad\delta\mathbf{w} & =\sum_{a}\delta\mathbf{w}_{a}\otimes\grad N_{a} & \grad\Delta\mathbf{w} & =\sum_{b}\Delta\mathbf{w}_{b}\otimes\grad N_{b}\\
\delta J^{f} & =\sum_{a}N_{a}\delta J_{a}^{f} & \Delta J^{f} & =\sum_{b}N_{b}\Delta J_{b}^{f}\\
\grad\delta J^{f} & =\sum_{a}\delta J_{a}^{f}\grad N_{a} & \grad\Delta J^{f} & =\sum_{b}\Delta J_{b}^{f}\grad N_{b}
\end{aligned}
\label{eq:fsi-interpolations}
\end{equation}

\end_inset

Note that the 
\begin_inset Formula $\grad\equiv\frac{\partial}{\partial\mathbf{x}}$
\end_inset

 operator should be evaluated using 
\begin_inset Formula $\mathbf{x}_{n+\alpha_{f}}$
\end_inset

.
\end_layout

\begin_layout Standard
The solution of the nonlinear equation 
\begin_inset Formula $\delta W=0$
\end_inset

 is obtained by linearizing this relation as
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta\mathbf{w}\right]+D\delta W\left[\Delta J^{f}\right]\approx0\,,\label{eq:fsi-linearized-virtual-work}
\end{equation}

\end_inset

where the operator 
\begin_inset Formula $D\delta W\left[\cdot\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $\delta W$
\end_inset

 at 
\begin_inset Formula $\left(\mathbf{u}^{s},\mathbf{w},J^{f}\right)$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 of 
\begin_inset Formula $\mathbf{u}^{s}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

 of 
\begin_inset Formula $\mathbf{w}$
\end_inset

, or 
\begin_inset Formula $\Delta J^{f}$
\end_inset

 of 
\begin_inset Formula $J^{f}$
\end_inset

.
 
\end_layout

\begin_layout Standard
To linearize the virtual work, we need to express the integrals appearing
 in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 and 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 over the material frame of the finite element solid domain.
 For notational convenience, we let 
\begin_inset Formula $J\equiv J^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}\equiv\mathbf{F}^{s}$
\end_inset

.
 Thus,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\int_{b}\boldsymbol{\sigma}^{s}:\grad\delta\mathbf{v}^{s}\,dv & =\int_{B}\mathbf{F}\cdot\mathbf{S}^{s}:\Grad\delta\mathbf{v}^{s}\,dV\end{aligned}
\,,\label{eq:fsi-work-material-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}^{s}=J\cdot\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}^{s}\cdot\mathbf{F}^{-T}$
\end_inset

 is the second Piola-Kirchhoff stress for the solid material.
 Similarly,
\begin_inset Formula 
\begin{equation}
\int_{b}\boldsymbol{\tau}:\grad\delta\mathbf{w}\,dv=\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV\,.\label{eq:fsi-work-material-2}
\end{equation}

\end_inset

Next,
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \int_{b}\delta\mathbf{w}\cdot\left(\grad p+\rho^{f}\mathbf{a}^{f}\right)\,dv\\
 & =\int_{B}\delta\mathbf{w}\cdot\left(J\mathbf{F}^{-T}\cdot\Grad p+J\rho^{f}\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\rho^{f}\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right)\,dV
\end{aligned}
\label{eq:fsi-work-material-3-4}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{b}\delta J^{f}\left[\frac{1}{J^{f}}\left(\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\frac{\dot{J}}{J}\right]\,dv=\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV\label{eq:fsi-work-material-5}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\int_{b}\mathbf{w}\cdot\grad\delta J^{f}\,dv=\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV\label{eq:fsi-work-material-6}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{W}=J\mathbf{F}^{-1}\cdot\mathbf{w}$
\end_inset

.
\end_layout

\begin_layout Standard
Keep in mind that we are solving for the motions 
\begin_inset Formula $\boldsymbol{\chi}_{n+1}^{\iota}$
\end_inset

 at 
\begin_inset Formula $t_{n+1}$
\end_inset

.
 Therefore,
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{u}^{s}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Delta\mathbf{u}\\
D\mathbf{F}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Grad\Delta\mathbf{u}\\
DJ\left[\Delta\mathbf{u}\right] & =\alpha_{f}J\left(\divg\Delta\mathbf{u}\right)\\
D\dot{J}\left[\Delta\mathbf{u}\right] & =D\left(J\mathbf{F}^{-T}:\Grad\mathbf{v}^{s}\right)\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}J\left[\left(\divg\mathbf{v}^{s}+\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)-\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}^{s}\right]\\
D\mathbf{v}^{s}\left[\Delta\mathbf{u}\right] & =\frac{\alpha_{f}\gamma}{\beta\Delta t}\Delta\mathbf{u}\\
D\mathbf{w}\left[\Delta\mathbf{w}\right] & =\alpha_{f}\Delta\mathbf{w}\\
DJ^{f}\left[\Delta J^{f}\right] & =\alpha_{f}\Delta J^{f}\\
D\rho^{f}\left[\Delta J^{f}\right] & =-\alpha_{f}\frac{\rho^{f}}{J^{f}}\Delta J^{f}
\end{aligned}
\]

\end_inset

In general, 
\begin_inset Formula $\boldsymbol{\sigma}^{s}$
\end_inset

 (and thus, 
\begin_inset Formula $\mathbf{S}^{s}$
\end_inset

) is only a function of the solid strain, such as the right Cauchy-Green
 tensor 
\begin_inset Formula $\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}$
\end_inset

 or the Green-Lagrange strain 
\begin_inset Formula $\mathbf{E}=\left(\mathbf{C}-\mathbf{I}\right)/2$
\end_inset

.
 
\begin_inset Formula 
\[
D\mathbf{E}\left[\Delta\mathbf{u}\right]=\frac{\alpha_{f}}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)
\]

\end_inset

Therefore, following the standard approach in solid mechanics, the linearization
 of 
\begin_inset Formula $\mathbf{S}^{s}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{S}^{s} & =D\mathbf{S}^{s}\left[\Delta\mathbf{u}\right]=\frac{\partial\mathbf{S}^{s}}{\partial\mathbf{E}}:D\mathbf{E}\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}^{s}:\frac{1}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}^{s}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right):\Delta\boldsymbol{\varepsilon}
\end{aligned}
\label{eq:fsi-solid-stress-linearization}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In general, 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is a function of the fluid volume ratio 
\begin_inset Formula $J^{f}$
\end_inset

 and the rate of deformation of the fluid, 
\begin_inset Formula $\mathbf{D}^{f}=\frac{1}{2}\left(\mathbf{L}^{f}+\left(\mathbf{L}^{f}\right)^{T}\right)$
\end_inset

.
 However, since 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 is not a degree of freedom, we need to let 
\begin_inset Formula $\mathbf{D}^{f}=\mathbf{D}^{w}+\mathbf{D}^{s}$
\end_inset

, where 
\begin_inset Formula $\mathbf{D}^{w}=\frac{1}{2}\left(\mathbf{L}^{w}+\left(\mathbf{L}^{w}\right)^{T}\right)$
\end_inset

 and 
\begin_inset Formula $\mathbf{D}^{s}=\frac{1}{2}\left(\mathbf{L}^{s}+\left(\mathbf{L}^{s}\right)^{T}\right)$
\end_inset

.
 Thus,
\begin_inset Formula 
\begin{equation}
D\boldsymbol{\tau}=\boldsymbol{\mathcal{C}}^{\tau}:\left(D\mathbf{D}^{f}\left[\Delta\mathbf{w}\right]+D\mathbf{D}^{f}\left[\Delta\mathbf{u}\right]\right)+\frac{\partial\boldsymbol{\tau}}{\partial J^{f}}DJ^{f}\left[\Delta J^{f}\right]\label{eq:fsi-fluid-stress-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{\tau}=\frac{\partial\boldsymbol{\tau}}{\partial\mathbf{D}^{f}}\label{eq:fsi-viscous-tangent-tensor}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $\int_{B}\mathbf{F}\cdot\mathbf{S}^{s}:\Grad\delta\mathbf{v}^{s}\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(\int_{B}\mathbf{F}\cdot\mathbf{S}^{s}:\Grad\delta\mathbf{v}^{s}\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{b}\alpha_{f}\left(\boldsymbol{\sigma}^{s}:\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}^{s}+\grad\delta\mathbf{v}^{s}:\boldsymbol{\mathcal{C}}^{s}:\Delta\boldsymbol{\varepsilon}\right)\,dv
\end{aligned}
\label{eq:fsi-term-1-Du}
\end{equation}

\end_inset

where
\begin_inset Formula 
\[
\boldsymbol{\mathcal{C}}^{s}=J^{-1}\left(\mathbf{F}\,\underline{\otimes}\,\mathbf{F}\right):\boldsymbol{\mathbb{C}}^{s}:\left(\mathbf{F}^{T}\,\underline{\otimes}\,\mathbf{F}^{T}\right)
\]

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}\mathbf{F}\cdot\mathbf{S}^{s}:\Grad\delta\mathbf{v}^{s}\,dV\right)\left[\Delta\mathbf{w}\right]=0\label{eq:fsi-term-1-Dw}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}\mathbf{F}\cdot\mathbf{S}^{s}:\Grad\delta\mathbf{v}^{s}\,dV\right)\left[\Delta J^{f}\right]=0\label{eq:fsi-term-1-DJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretized version produces
\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\alpha_{f}\left(\boldsymbol{\sigma}^{s}:\grad^{T}\Delta\mathbf{u}\cdot\grad\delta\mathbf{v}^{s}+\grad\delta\mathbf{v}^{s}:\boldsymbol{\mathcal{C}}^{s}:\Delta\boldsymbol{\varepsilon}\right)\,dv\\
 & =\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{uu}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uu}=\alpha_{f}\left(\left(\grad N_{a}\cdot\boldsymbol{\sigma}^{s}\cdot\grad N_{b}\right)\mathbf{I}+\left(\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{s}\cdot\grad N_{b}\right)\right)\label{eq:fsi-term-1-Kuu}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{uw}=\mathbf{0}\label{eq:term-1-Kuw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{uJ}=\mathbf{0}\label{eq:term-1-kuJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{b}\alpha_{f}\left(\boldsymbol{\tau}:\grad\delta\mathbf{w}\cdot\Delta\mathbf{G}+\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\,dv
\end{aligned}
\label{eq:fsi-term-2-Du}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned}D\left(\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV\right)\left[\Delta\mathbf{u}\right] & =\int_{B}D\left(\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}\right)\left[\Delta\mathbf{u}\right]:\Grad\delta\mathbf{w}\,dV\\
 & =\int_{B}\left(D\boldsymbol{\tau}\left[\Delta\mathbf{u}\right]\cdot J\mathbf{F}^{-T}+\boldsymbol{\tau}\cdot D\left(J\mathbf{F}^{-T}\right)\left[\Delta\mathbf{u}\right]\right):\Grad\delta\mathbf{w}\,dV
\end{aligned}
\]

\end_inset

where we used
\begin_inset Formula 
\[
\boldsymbol{\mathcal{C}}^{\tau}=\frac{\partial\boldsymbol{\tau}}{\partial\mathbf{D}^{f}}\,.
\]

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV\right)\left[\Delta\mathbf{w}\right] & =\int_{b}\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\grad\Delta\mathbf{w}\,dv\end{aligned}
\label{eq:fsi-term-2-Dw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(\int_{B}\boldsymbol{\tau}\cdot J\mathbf{F}^{-T}:\Grad\delta\mathbf{w}\,dV\right)\left[\Delta J^{f}\right]=\int_{b}\alpha_{f}\Delta J^{f}\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{w}\,dv\label{eq:fsi-term-2-DJ}
\end{equation}

\end_inset

where
\begin_inset Formula 
\[
\boldsymbol{\tau}_{J}^{\prime}=\frac{\partial\boldsymbol{\tau}}{\partial J^{f}}
\]

\end_inset


\end_layout

\begin_layout Standard
The discretized version produces
\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\alpha_{f}\left(\boldsymbol{\tau}:\grad\delta\mathbf{w}\cdot\Delta\mathbf{G}+\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\,dv\\
 & =\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{wu}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{wu}=\alpha_{f}\boldsymbol{\tau}\cdot\left(\grad N_{a}\otimes\grad N_{b}-\grad N_{b}\otimes\grad N_{a}\right)+\left(\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\right)\cdot\mathbf{M}\label{eq:fsi-term-2-Kwu}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\int_{b}\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\grad\Delta\mathbf{w}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{ww}\,dv\cdot\Delta\mathbf{w}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{ab}^{ww}=\alpha_{f}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\label{eq:fsi-term-2-Kww}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\int_{b}\alpha_{f}\Delta J^{f}\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{w}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{k}_{ab}^{wJ}\,dv\,\Delta J_{b}^{f}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{k}_{ab}^{wJ}=\alpha_{f}N_{b}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}\label{eq:fsi-term-2-kwJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $\int_{B}\delta\mathbf{w}\cdot J\mathbf{F}^{-T}\cdot\Grad p\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta\mathbf{w}\cdot J\mathbf{F}^{-T}\cdot\Grad p\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{b}\alpha_{f}\delta\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\grad p\,dv
\end{aligned}
}\label{eq:fsi-term-3-Du}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{w}\cdot J\mathbf{F}^{-T}\cdot\Grad p\,dV\right)\left[\Delta\mathbf{w}\right]=0}\label{eq:fsi-term-3-Dw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta\mathbf{w}\cdot J\mathbf{F}^{-T}\cdot\Grad p\,dV\right)\left[\Delta J^{f}\right]\\
 & =\int_{b}\alpha_{f}\delta\mathbf{w}\cdot\left(\Delta J^{f}p^{\prime\prime}\left(J^{f}\right)\grad J^{f}+p^{\prime}\left(J^{f}\right)\grad\Delta J^{f}\right)\,dv
\end{aligned}
}\label{eq:fsi-term-3-DJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretization of these terms produces
\begin_inset Formula 
\[
\int_{b}\alpha_{f}\delta\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\grad p\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{wu}\,dv\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{wu}=\alpha_{f}N_{a}\left(\grad p\otimes\grad N_{b}-\grad N_{b}\otimes\grad p\right)}\label{eq:fsi-term-3-Kwu}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{ww}=\mathbf{0}}\label{eq:term-3-Kww}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\int_{b}\alpha_{f}\delta\mathbf{w}\cdot\left(\Delta J^{f}p^{\prime\prime}\left(J^{f}\right)\grad J^{f}+p^{\prime}\left(J^{f}\right)\grad\Delta J^{f}\right)\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{k}_{ab}^{wJ}\,dv\Delta J_{b}^{f}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{wJ}=\alpha_{f}N_{a}\left(N_{b}p^{\prime\prime}\left(J^{f}\right)\grad J^{f}+p^{\prime}\left(J^{f}\right)\grad N_{b}\right)}\label{eq:fsi-term-3-kwJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $\int_{B}\delta\mathbf{w}\cdot\rho^{f}\left[J\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right]\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{B}\delta\mathbf{w}\cdot\rho^{f}\left[J\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right]\,dV
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}\left[J\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right]\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\left[\left(\divg\Delta\mathbf{u}\right)\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\frac{\gamma}{\beta\Delta t}\grad\Delta\mathbf{u}\cdot\mathbf{w}+\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\Delta\mathbf{u}\right]\,dv\\
 & +\int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\mathbf{L}^{f}\cdot\Delta\mathbf{G}\cdot\mathbf{w}\,dv
\end{aligned}
}\label{eq:fsi-term-4-Du}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}\left[J\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right]\,dV\right)\left[\Delta\mathbf{w}\right]\\
 & =\int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\left[\left(\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}\mathbf{I}+\mathbf{L}^{f}\right)\cdot\Delta\mathbf{w}+\grad\Delta\mathbf{w}\cdot\mathbf{w}\right]\,dv
\end{aligned}
}\label{eq:fsi-term-4-Dw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}\left[J\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\left(\Grad\mathbf{w}+\Grad\mathbf{v}^{s}\right)\cdot\mathbf{W}\right]\,dV\right)\left[\Delta J^{f}\right]\\
 & =-\int_{b}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho^{f}}{J^{f}}\Delta J^{f}\mathbf{a}^{f}\,dv
\end{aligned}
}\label{eq:fsi-term-4-DJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretized version is given by
\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\left[\left(\divg\Delta\mathbf{u}\right)\left(\dot{\mathbf{w}}+\dot{\mathbf{v}}^{s}\right)+\frac{\gamma}{\beta\Delta t}\grad\Delta\mathbf{u}\cdot\mathbf{w}+\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\Delta\mathbf{u}\right]\,dv\\
 & +\int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\mathbf{L}^{f}\cdot\Delta\mathbf{G}\cdot\mathbf{w}\,dv\\
 & =\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{wu}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{ab}^{wu} & =\alpha_{f}N_{a}\rho^{f}\left[\mathbf{a}^{f}\otimes\grad N_{b}-\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{L}^{f}+\left(\frac{\gamma}{\beta\Delta t}\left(\grad N_{b}\cdot\mathbf{w}\right)+\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}N_{b}\right)\mathbf{I}\right]\end{aligned}
}\label{eq:fsi-term-4-Kwu}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\delta\mathbf{w}\cdot\alpha_{f}\rho^{f}\left[\left(\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}\mathbf{I}+\mathbf{L}^{f}\right)\cdot\Delta\mathbf{w}+\grad\Delta\mathbf{w}\cdot\mathbf{w}\right]\,dv\\
 & =\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{ww}\,dv\cdot\Delta\mathbf{w}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{ww}=\alpha_{f}N_{a}\rho^{f}\left[N_{b}\left(\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}\mathbf{I}+\mathbf{L}^{f}\right)+\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right]}\label{eq:fsi-term-4-Kww}
\end{equation}

\end_inset


\begin_inset Formula 
\[
-\int_{B}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho^{f}}{J^{f}}\Delta J^{f}\mathbf{a}^{f}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{k}_{ab}^{wJ}\,dv\Delta J_{b}^{f}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{wJ}=-\alpha_{f}N_{a}N_{b}\frac{\rho^{f}}{J^{f}}\mathbf{a}^{f}}\label{eq:fsi-term-4-kwJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & D\left(\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(DJ\left[\Delta\mathbf{u}\right]\dot{J}^{f}+\Grad J^{f}\cdot D\mathbf{W}\left[\Delta\mathbf{u}\right]\right)-D\dot{J}\left[\Delta\mathbf{u}\right]\right]\,dV\\
 & =\int_{b}\delta J^{f}\alpha_{f}\left[\left(\frac{\dot{J}^{f}}{J^{f}}-\divg\mathbf{v}^{s}-\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)+\mathbf{w}\cdot\left[\left(\divg\Delta\mathbf{u}\right)\mathbf{I}-\grad^{T}\Delta\mathbf{u}\right]\cdot\frac{\grad J^{f}}{J^{f}}+\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}^{s}\right]\,dv
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{b}\delta J^{f}\alpha_{f}\left[\left(\frac{\dot{J}^{f}}{J^{f}}-\divg\mathbf{v}^{s}-\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)+\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\frac{\grad J^{f}}{J^{f}}+\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}^{s}\right]\,dv
\end{aligned}
}\label{eq:fsi-term-5-Du}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV\right)\left[\Delta\mathbf{w}\right]\\
 & =\int_{b}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\Delta\mathbf{w}\cdot\grad J^{f}\,dv
\end{aligned}
}\label{eq:fsi-term-5-Dw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\delta J^{f}\left[\frac{1}{J^{f}}\left(J\dot{J}^{f}+\Grad J^{f}\cdot\mathbf{W}\right)-\dot{J}\right]\,dV\right)\left[\Delta J^{f}\right]\\
 & =\int_{b}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\left(\left[\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}-\frac{1}{J^{f}}\left(\dot{J}^{f}+\mathbf{w}\cdot\grad J^{f}\right)\right]\Delta J^{f}+\mathbf{w}\cdot\grad\Delta J^{f}\right)\,dv
\end{aligned}
}\label{eq:fsi-term-5-DJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretization of these terms produces
\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\delta J^{f}\alpha_{f}\left[\left(\frac{\dot{J}^{f}}{J^{f}}-\divg\mathbf{v}^{s}-\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)+\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\frac{\grad J^{f}}{J^{f}}+\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}^{s}\right]\,dv\\
 & =\sum_{a}\delta J_{a}^{f}\sum_{b}\int_{b}\mathbf{k}_{ab}^{Ju}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{k}_{ab}^{Ju} & =\alpha_{f}N_{a}\left[\left(\frac{\dot{J}^{f}}{J^{f}}-\divg\mathbf{v}^{s}-\frac{\gamma}{\beta\Delta t}\right)\grad N_{b}+\left(\grad N_{b}\otimes\frac{\grad J^{f}}{J^{f}}-\frac{\grad J^{f}}{J^{f}}\otimes\grad N_{b}\right)\cdot\mathbf{w}+\left(\mathbf{L}^{s}\right)^{T}\cdot\grad N_{b}\right]\end{aligned}
}\label{eq:fsi-term-5-kJu}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\int_{b}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\Delta\mathbf{w}\cdot\grad J^{f}\,dv=\sum_{a}\delta J_{a}^{f}\sum_{b}\int_{b}\mathbf{k}_{ab}^{Jw}\,dv\cdot\Delta\mathbf{w}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{Jw}=\alpha_{f}\frac{N_{a}N_{b}}{J^{f}}\grad J^{f}}\label{eq:fsi-term-5-kJw}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & \int_{b}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\left(\left[\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}-\frac{1}{J^{f}}\left(\dot{J}^{f}+\mathbf{w}\cdot\grad J^{f}\right)\right]\Delta J^{f}+\mathbf{w}\cdot\grad\Delta J^{f}\right)\,dv\\
 & =\sum_{a}\delta J_{a}^{f}\sum_{b}\int_{b}k_{ab}^{JJ}\,dv\Delta J_{b}^{f}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{k_{ab}^{JJ}=\alpha_{f}N_{a}\frac{1}{J^{f}}\left(N_{b}\left[\frac{\alpha_{m}}{\alpha_{f}\gamma\Delta t}-\frac{1}{J^{f}}\left(\dot{J}^{f}+\mathbf{w}\cdot\grad J^{f}\right)\right]+\mathbf{w}\cdot\grad N_{b}\right)}\label{eq:fsi-term-5-kJJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of 
\begin_inset Formula $-\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
-\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\alpha_{f}\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\grad\delta J^{f}\,dv}\label{eq:fsi-term-6-Du}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & D\left(\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{B}\Grad\delta J^{f}\cdot D\mathbf{W}\left[\Delta\mathbf{w}\right]\,dV\\
 & =\int_{B}\alpha_{f}\Delta\mathbf{w}\cdot\grad\delta J^{f}\,dv
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV\right)\left[\Delta\mathbf{w}\right]=\int_{B}\alpha_{f}\Delta\mathbf{w}\cdot\grad\delta J^{f}\,dv}\label{eq:fsi-term-6-Dw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\Grad\delta J^{f}\cdot\mathbf{W}\,dV\right)\left[\Delta J^{f}\right]=0}\label{eq:fsi-term-6-DJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discretization of these terms produces
\begin_inset Formula 
\[
\int_{b}\alpha_{f}\mathbf{w}\cdot\Delta\mathbf{G}^{T}\cdot\grad\delta J^{f}\,dv=\sum_{a}\delta J_{a}^{f}\sum_{b}\int_{v}\mathbf{k}_{ab}^{Ju}\,dv\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{Ju}=\alpha_{f}\left(\grad N_{b}\otimes\grad N_{a}-\grad N_{a}\otimes\grad N_{b}\right)\cdot\mathbf{w}}\label{eq:fsi-term-6-kJu}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\int_{B}\alpha_{f}\Delta\mathbf{w}\cdot\grad\delta J^{f}\,dv=\sum_{a}\delta J_{a}^{f}\sum_{b}\int_{b}\mathbf{k}_{ab}^{Jw}\,dv\cdot\Delta\mathbf{w}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{Jw}=\alpha_{f}N_{b}\grad N_{a}}\label{eq:fsi-term-6-kJw}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{k_{ab}^{JJ}=0}\label{eq:fsi-term-6-kJJ}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Body force term 
\begin_inset Formula $\int_{b}\delta\mathbf{w}\cdot\rho^{f}\mathbf{b}\,dv$
\end_inset


\end_layout

\begin_layout Standard
The body force term may be discretized as
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{w}\cdot\rho^{f}\mathbf{b}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\int_{b}N_{a}\rho^{f}\mathbf{b}\,dv
\]

\end_inset

To linearizes this expression, we first evaluate it in the material domain,
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{w}\cdot\rho^{f}\mathbf{b}\,dv=\int_{B}\delta\mathbf{w}\cdot\rho^{f}J\mathbf{b}\,dV
\]

\end_inset

Now,
\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}J\mathbf{b}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\alpha_{f}\rho^{f}\left(\divg\Delta\mathbf{u}\right)\delta\mathbf{w}\cdot\mathbf{b}\,dv}\label{eq:fsi-bf-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}J\mathbf{b}\,dV\right)\left[\Delta\mathbf{w}\right]=0}\label{eq:fsi-bf-2}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{w}\cdot\rho^{f}J\mathbf{b}\,dV\right)\left[\Delta J^{f}\right]=-\int_{b}\Delta J^{f}\frac{\alpha_{f}\rho^{f}}{J^{f}}\delta\mathbf{w}\cdot\mathbf{b}\,dv}\label{eq:fsi-bf-3}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The discrete forms of these expressions are given by
\begin_inset Formula 
\[
\int_{b}\alpha_{f}\rho^{f}\left(\divg\Delta\mathbf{u}\right)\delta\mathbf{w}\cdot\mathbf{b}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{wu}\,dv\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{wu}=\alpha_{f}\rho^{f}N_{a}\mathbf{b}\otimes\grad N_{b}}\label{eq:fsi-bf-4}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{ww}=\mathbf{0}}\label{eq:fsi-bf-5}
\end{equation}

\end_inset


\begin_inset Formula 
\[
-\int_{b}\Delta J^{f}\frac{\alpha_{f}\rho^{f}}{J^{f}}\delta\mathbf{w}\cdot\mathbf{b}\,dv=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{b}\mathbf{k}_{ab}^{wJ}\,dv\,\Delta J_{b}^{f}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{wJ}=-\alpha_{f}N_{a}N_{b}\frac{\rho^{f}}{J^{f}}\mathbf{b}}\label{eq:fsi-bf-6}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Fluid traction acting on solid interface
\end_layout

\begin_layout Standard
At a fluid-solid interface 
\begin_inset Formula $\Gamma$
\end_inset

, the fluid traction 
\begin_inset Formula $\mathbf{t}^{f}=\boldsymbol{\sigma}^{f}\cdot\mathbf{n}$
\end_inset

 acts on the solid surface, 
\begin_inset Formula $\mathbf{t}^{s}=-\mathbf{t}^{f}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the outward normal to the fluid surface.
 The resulting virtual work on the solid domain is
\begin_inset Formula 
\[
\delta G=\int_{\Gamma}\delta\mathbf{v}^{s}\cdot\mathbf{t}_{n+\alpha_{f}}^{s}\,da=\int_{\Gamma}-\delta\mathbf{v}^{s}\cdot\boldsymbol{\sigma}^{f}\cdot\mathbf{n}\,da=\int_{\Gamma_{\eta}}-\delta\mathbf{v}^{s}\cdot\boldsymbol{\sigma}^{f}\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\,d\eta^{1}d\eta^{2}
\]

\end_inset

The linearization of this work is given by
\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{u}\right]=\int_{\Gamma_{\eta}}-\delta\mathbf{v}^{s}\cdot\alpha_{f}\left[\left(\boldsymbol{\mathcal{C}}^{v}:\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)+\boldsymbol{\sigma}^{f}\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)\right]\,d\eta^{1}d\eta^{2}
\]

\end_inset

where 
\begin_inset Formula 
\[
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}}{\partial\eta^{\alpha}}
\]

\end_inset

are covariant basis vectors on 
\begin_inset Formula $\Gamma$
\end_inset

.
 Similarly,
\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{w}\right]=\int_{\Gamma_{\eta}}-\delta\mathbf{v}^{s}\cdot\alpha_{f}\left[\left(\boldsymbol{\mathcal{C}}^{v}:\grad\Delta\mathbf{w}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\right]\,d\eta^{1}d\eta^{2}
\]

\end_inset

and
\begin_inset Formula 
\[
D\delta G\left[\Delta J^{f}\right]=\int_{\Gamma_{\eta}}-\Delta J^{f}\delta\mathbf{v}^{s}\cdot\alpha_{f}\left[\left(-p^{\prime}\left(J^{f}\right)+\boldsymbol{\tau}_{J}^{\prime}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\right]\,d\eta^{1}d\eta^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
The discretized form of these equations is
\begin_inset Formula 
\[
\delta G=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\int_{\Gamma}\mathbf{f}_{a}\,d\eta^{1}d\eta^{2}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}_{a}=-N_{a}\boldsymbol{\sigma}^{f}\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)}\label{eq:fsi-ft-1}
\end{equation}

\end_inset


\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{u}\right]=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{\Gamma_{\eta}}\mathbf{K}_{ab}^{uu}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{uu}=-\alpha_{f}N_{a}\left(\left[\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}^{v}\cdot\grad N_{b}\right]\cdot\mathbf{M}+\boldsymbol{\sigma}^{f}\cdot\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}-\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}\right\} \right)}\label{eq:fsi-ft-2}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{w}\right]=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{\Gamma_{\eta}}\mathbf{K}_{ab}^{uw}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{w}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{uw}=-\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}^{v}\cdot\grad N_{b}}\label{eq:fsi-ft-3}
\end{equation}

\end_inset


\begin_inset Formula 
\[
D\delta G\left[\Delta J^{f}\right]=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{\Gamma_{\eta}}\mathbf{k}_{ab}^{uJ}\,d\eta^{1}d\eta^{2}\,\Delta J_{b}^{f}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{k}_{ab}^{uJ}=-\alpha_{f}N_{a}N_{b}\left(-p^{\prime}\left(J^{f}\right)+\boldsymbol{\tau}_{J}^{\prime}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)}\label{eq:fsi-ft-4}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Special Boundary Conditions
\end_layout

\begin_layout Subsubsection
Backflow Stabilization
\end_layout

\begin_layout Standard
Let the normal component of the viscous traction be given by 
\begin_inset Formula 
\begin{equation}
t_{n}^{\tau}=\begin{cases}
\beta\rho_{r}w_{n}^{2} & w_{n}<0\\
0 & w_{n}\ge0
\end{cases}\,.\label{eq:fsi-BFS-normal-traction}
\end{equation}

\end_inset

Then, the contribution of this traction to the virtual external work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{w}\cdot t_{n}^{\tau}\mathbf{n}\,da\,.\label{eq:fsi-BFSckflow-virtual-work}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

 in the relative velocity is given by
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{w}\right]=\int_{\partial\Omega}\delta\mathbf{w}\cdot\alpha_{f}\mathbf{K}_{n}\cdot\Delta\mathbf{w}\,da\,,\label{eq:fsi-BFS-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{n}=\begin{cases}
2\beta\rho_{r}w_{n}\left(\mathbf{n}\otimes\mathbf{n}\right) & v_{n}<0\\
\mathbf{0} & v_{n}\ge0
\end{cases}\,.\label{eq:fsi-BFS-stiffness}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{u}\right]=\int_{\partial\Omega_{\eta}}\delta\mathbf{w}\cdot\alpha_{f}t_{n}^{\tau}\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\,d\eta^{1}d\eta^{2}
\]

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{w}_{a}\cdot\int_{\partial\Omega_{\eta}}\mathbf{f}_{a}^{n}\,d\eta^{1}d\eta^{2},\quad\boxed{\mathbf{f}_{a}^{n}=N_{a}t_{n}^{\tau}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)}\,,\label{eq:fsi-BFS-discretized-work}
\end{equation}

\end_inset

whereas the discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\left(\int_{\partial\Omega_{\eta}}\mathbf{K}_{ab}^{wu}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{u}+\int_{\partial\Omega_{\eta}}\mathbf{K}_{ab}^{ww}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{w}_{b}\right)\,,\label{eq:BFS-discretized-tangent-1}
\end{equation}

\end_inset

with
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{ww}=\alpha_{f}N_{a}N_{b}\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\mathbf{K}_{n}}\,,\label{eq:fsi-BFS-Kww}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{wu}=\alpha_{f}N_{a}t_{n}^{\tau}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}-\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}\right\} }\label{eq:fsi-BFS-Kwu}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Tangential Stabilization
\end_layout

\begin_layout Standard
The tangential traction given by 
\begin_inset Formula 
\begin{equation}
\mathbf{t}_{t}^{\tau}=-\beta\rho_{r}\left|\mathbf{w}_{t}\right|\mathbf{w}_{t}\,.\label{eq:fsi-tangential-stabilization}
\end{equation}

\end_inset

This form shows that 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}$
\end_inset

 opposes tangential flow.
 The external virtual work for this traction is
\begin_inset Formula 
\begin{equation}
\delta G=\int_{\partial\Omega}\delta\mathbf{w}\cdot\mathbf{t}_{t}^{\tau}\,da\,.\label{eq:fsi-TS-external-work}
\end{equation}

\end_inset

Its linearization along an increment 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{w}\right]=\int_{\partial\Omega}\delta\mathbf{w}\cdot\alpha_{f}\mathbf{K}_{t}\cdot\Delta\mathbf{w}\,da\,,\label{eq:fsi-TS-linearization}
\end{equation}

\end_inset

where it can be shown that
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{t}=-\beta\rho_{r}\left|\mathbf{w}_{t}\right|\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}+\frac{\mathbf{w}_{t}}{\left|\mathbf{w}_{t}\right|}\otimes\frac{\mathbf{w}_{t}}{\left|\mathbf{w}_{t}\right|}\right)\,.\label{eq:fsi-TS-stiffness}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\[
D\delta G\left[\Delta\mathbf{u}\right]=\int_{\partial\Omega_{\eta}}\delta\mathbf{w}\cdot\alpha_{f}\left(\mathbf{t}_{t}^{\tau}\otimes\mathbf{n}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)\,d\eta^{1}d\eta^{2}\,.
\]

\end_inset

The discretized form of 
\begin_inset Formula $\delta G$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{a}\delta\mathbf{v}_{a}\cdot\int_{\partial\Omega}\mathbf{f}_{a}^{\tau}\,d\eta^{1}d\eta^{2}\,,\quad\boxed{\mathbf{f}_{a}^{\tau}=N_{a}\mathbf{t}_{t}^{\tau}\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq:fsi-TS-discretized-work}
\end{equation}

\end_inset

The discretized form of 
\begin_inset Formula $D\delta G\left[\Delta\mathbf{v}\right]$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G\left[\Delta\mathbf{v}\right]=\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\int_{\partial\Omega_{\eta}}\left(\mathbf{K}_{ab}^{wu}\cdot\Delta\mathbf{u}_{b}+\mathbf{K}_{ab}^{ww}\cdot\Delta\mathbf{w}_{b}\right)\,d\eta^{1}d\eta^{2}\,,\label{eq:TS-discretized-tangent-1}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{ww}=\alpha_{f}N_{a}N_{b}\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\mathbf{K}_{t}}\,,\label{eq:fsi-TS-Kww}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{wu}=\alpha_{f}N_{a}\left(\mathbf{t}_{t}^{\tau}\otimes\mathbf{n}\right)\cdot\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{b}}{\partial\eta^{2}}\mathbf{g}_{1}-\frac{\partial N_{b}}{\partial\eta^{1}}\mathbf{g}_{2}\right\} }\,.\label{eq:fsi-TS-Kwu}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Weak Formulation for BFSI
\begin_inset CommandInset label
LatexCommand label
name "sec:BFSI-Weak-Formulation"

\end_inset


\end_layout

\begin_layout Subsection
Virtual Work and Weak Form 
\begin_inset CommandInset label
LatexCommand label
name "subsec:BFSI-Virtual-Work"

\end_inset


\end_layout

\begin_layout Standard
The virtual work statement is used to enforce the three governing equations
 needed to solve for the nodal DOFs 
\begin_inset Formula $\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $e^{f}$
\end_inset

, namely the mixture mass balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-kin-constr"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the fluid momentum balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and the solid momentum balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-solid-momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We may rewrite the momentum balance equations to facilitate the enforcement
 of natural traction boundary conditions given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-fluid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-solid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Using 
\begin_inset Formula $\boldsymbol{\tau}^{f}=\varphi^{f}\boldsymbol{\tau}$
\end_inset

, these become 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\varphi^{s}\left(-\rho_{T}^{f}\mathbf{a}^{f}+\rho_{T}^{s}\mathbf{a}^{s}\right)= & -\frac{\varphi^{s^{2}}}{\varphi^{f}}\mathbf{\boldsymbol{\tau}}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}+\divg\left(-\varphi^{s}\boldsymbol{\tau}+\boldsymbol{\sigma}^{e}\right)\\
 & +\varphi^{s}\left(-\rho_{T}^{f}\mathbf{b}^{f}+\rho_{T}^{s}\mathbf{b}^{s}\right)+\mathbf{k}^{-1}\cdot\mathbf{w}\,,\\
\rho_{T}^{f}\mathbf{a}^{f}= & -\grad p+\frac{1}{\phi^{f}}\mathbf{\boldsymbol{\tau}}\cdot\grad\varphi^{f}+\divg\boldsymbol{\tau}\\
 & +\rho_{T}^{f}\mathbf{b}^{f}-\mathbf{k}^{-1}\cdot\mathbf{w}\,.
\end{aligned}
\label{eq:bfsi-gov-eqn-jump}
\end{equation}

\end_inset

The virtual work statement for a Galerkin finite element formulation 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

 is 
\begin_inset Formula $\delta W=0$
\end_inset

, where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\int_{\Omega^{b}}\delta\mathbf{v}^{s}\cdot\left[\divg\left(-\varphi^{s}\boldsymbol{\tau}+\boldsymbol{\sigma}^{e}\right)-\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}+\mathbf{k}^{-1}\cdot\mathbf{w}\right]\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}^{s}\cdot\varphi^{s}\left(-\rho_{T}^{f}\left(\mathbf{b}^{f}-\mathbf{a}^{f}\right)+\rho_{T}^{s}\left(\mathbf{b}^{s}-\mathbf{a}^{s}\right)\right)\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\left[\divg\boldsymbol{\tau}-\grad p+\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\phi^{f}-\mathbf{k}^{-1}\cdot\mathbf{w}\right]\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\rho_{T}^{f}\left(\mathbf{b}^{f}-\mathbf{a}^{f}\right)\,dv\\
 & +\int_{\Omega^{b}}\delta J^{f}\left[\divg\mathbf{w}+\frac{\dot{J}^{s}}{J^{s}}-\frac{1}{J^{f}}\left(\varphi^{f}\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)\right]\,dv\,.
\end{aligned}
\label{eq:bfsi-virtual-work-strong}
\end{equation}

\end_inset

These integrals are evaluated in the current configuration of 
\begin_inset Formula $\Omega^{b}$
\end_inset

.
 Here, 
\begin_inset Formula $\delta\mathbf{v}^{s}$
\end_inset

 is the virtual solid velocity, 
\begin_inset Formula $\delta\mathbf{w}$
\end_inset

 is the virtual relative fluid volumetric flux, and 
\begin_inset Formula $\delta J^{f}$
\end_inset

 is the virtual fluid energy density.
 Integrating by parts and using the divergence theorem, the weak form of
 this statement may be written as 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

 where the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{\Omega^{b}}\left[\left(-\varphi^{s}\boldsymbol{\tau}+\boldsymbol{\sigma}^{e}\right):\grad\delta\mathbf{v}^{s}-\delta\mathbf{v}^{s}\cdot\mathbf{k}^{-1}\cdot\mathbf{w}\right]\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}^{s}\cdot\varphi^{s}\left(\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}-\rho_{T}^{f}\mathbf{a}^{f}+\rho_{T}^{s}\mathbf{a}^{s}\right)\,dv\\
 & +\int_{\Omega^{b}}\boldsymbol{\tau}:\grad\delta\mathbf{w}\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\left(\grad p+\mathbf{k}^{-1}\cdot\mathbf{w}\right)\,dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\left(\rho_{T}^{f}\mathbf{a}^{f}-\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\varphi^{f}\right)\,dv\\
 & +\int_{\Omega^{b}}\mathbf{w}\cdot\grad\delta J^{f}\,dv\,,\\
 & +\int_{\Omega^{b}}\delta J^{f}\left[\frac{1}{J^{f}}\left(\varphi^{f}\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)-\frac{\dot{J}^{s}}{J^{s}}\right]\,dv
\end{aligned}
\label{eq:bfsi-int-virtual-work}
\end{equation}

\end_inset

 and the external part is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext} & =\int_{\partial\Omega^{b}}\delta\mathbf{v}^{s}\cdot\mathbf{t}^{\sigma}\,da\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}^{s}\cdot\varphi^{s}\left(-\rho_{T}^{f}\mathbf{b}^{f}+\rho_{T}^{s}\mathbf{b}^{s}\right)\,dv\\
 & +\int_{\partial\Omega^{b}}\delta\mathbf{w}\cdot\mathbf{t}^{\tau}\,da+\int_{\Omega^{f}}\delta\mathbf{w}\cdot\rho_{T}^{f}\mathbf{b}^{f}\,dv\\
 & +\int_{\partial\Omega^{b}}\delta J^{f}w_{n}\,da\,.
\end{aligned}
\label{eq:bfsi-ext-virtual-work}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{\sigma}=-\varphi^{s}\mathbf{t}^{\tau}+\mathbf{t}^{e}\,.\label{eq:bfsi-sigma-traction}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{t}^{e}=\boldsymbol{\sigma}^{e}\cdot\mathbf{n}$
\end_inset

 is the elastic traction, 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the true fluid viscous traction, and 
\begin_inset Formula $w_{n}=\mathbf{w}_{n}\cdot\mathbf{n}$
\end_inset

 is the normal component of the relative fluid flux on the boundary 
\begin_inset Formula $\partial\Omega^{b}$
\end_inset

, whose outward unit normal is 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 The traction 
\begin_inset Formula $\mathbf{t}^{\sigma}$
\end_inset

 emerges from the jump condition in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-solid-mtm-jump"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The integrands of the surface integrals represent the natural boundary
 conditions for this formulation.
 If boundary conditions are not set explicitly on 
\begin_inset Formula $\partial\Omega^{b}$
\end_inset

, the natural boundary conditions are 
\begin_inset Formula $\mathbf{t}^{\sigma}=\mathbf{0}$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, and 
\begin_inset Formula $w_{n}=0$
\end_inset

.
 These natural boundary conditions are consistent with the jump conditions
 presented above.
 Essential boundary conditions are prescribed on the solid displacement
 
\begin_inset Formula $\mathbf{u}$
\end_inset

, relative volumetric fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

, and fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

, which are also consistent with the above jump conditions.
 In particular, an essential no-slip boundary condition may be prescribed
 on 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

 by setting 
\begin_inset Formula $\mathbf{w}=\mathbf{0}$
\end_inset

.
 A symmetry plane may be prescribed with the essential boundary condition
 
\begin_inset Formula $u_{n}\equiv\mathbf{u}\cdot\mathbf{n}=0$
\end_inset

 and the natural boundary conditions 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $w_{n}=0$
\end_inset

.
\end_layout

\begin_layout Standard
In this formulation, the mixture traction is defined as 
\begin_inset Formula $\mathbf{t}=-p\mathbf{n}+\mathbf{t}^{e}+\varphi^{f}\mathbf{t}^{\tau}$
\end_inset

, which may also be written as 
\begin_inset Formula $\mathbf{t}=-p\mathbf{n}+\mathbf{t}^{\sigma}+\mathbf{t}^{\tau}$
\end_inset

.
 Because of the way we chose to split the internal and external virtual
 work in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-int-virtual-work"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-ext-virtual-work"

\end_inset

, 
\begin_inset Formula $\mathbf{t}$
\end_inset

 is not a natural boundary condition in this formulation.
 In this expression for 
\begin_inset Formula $\mathbf{t}$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\sigma}$
\end_inset

, and 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 may be prescribed as natural boundary conditions, whereas 
\begin_inset Formula $p$
\end_inset

 may be prescribed as an essential boundary condition on 
\begin_inset Formula $e^{f}$
\end_inset

, using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-pressure-state"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 However, there are two general scenarios where 
\begin_inset Formula $\mathbf{t}$
\end_inset

 needs to be prescribed on a region of the boundary 
\begin_inset Formula $\partial\Omega^{b}$
\end_inset

 with incomplete prior knowledge of 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\sigma}$
\end_inset

, or 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

: (1) When a BFSI boundary 
\begin_inset Formula $\Gamma^{b}$
\end_inset

 represents a free surface (such as the fluid surface in channel flow),
 the mixture traction boundary condition requires that 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

, in which case it is necessary to explicitly enforce 
\begin_inset Formula $-p\mathbf{n}+\mathbf{t}^{\sigma}+\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

 as a constraint equation on that boundary, to impart the free surface 
\begin_inset Formula $\Gamma^{b}$
\end_inset

 its natural shape.
 (2) At a biphasic-solid interface 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

, 
\begin_inset Formula $\mathbf{t}$
\end_inset

 must balance the traction acting on the adjoining solid domain.
 Since 
\begin_inset Formula $\mathbf{u}$
\end_inset

 is continuous across 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

 due to shared nodes, the solid natural boundary condition 
\begin_inset Formula $\mathbf{t}^{\sigma}$
\end_inset

 of 
\begin_inset Formula $\mathbf{t}$
\end_inset

 is already accounted for by the deformation, so that it is only necessary
 to prescribe the portion 
\begin_inset Formula $-p\mathbf{n}+\mathbf{t}^{\tau}$
\end_inset

 of 
\begin_inset Formula $\mathbf{t}$
\end_inset

 on the solid domain, thus 
\begin_inset Formula $-p\mathbf{n}+\mathbf{t}^{\tau}+\mathbf{t}^{s}=\mathbf{0}$
\end_inset

 where 
\begin_inset Formula $\mathbf{t}^{s}$
\end_inset

 is the (equal and opposite) traction acting on the solid domain.
 In both cases, the form of this traction boundary condition is the same,
 with 
\begin_inset Formula $\mathbf{t}^{e}$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{s}$
\end_inset

 representing the tractions acting on 
\begin_inset Formula $\Gamma^{b}$
\end_inset

 and 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

, respectively.
\end_layout

\begin_layout Standard
For both of these cases, the resulting virtual work on the free surface
 
\begin_inset Formula $\Gamma^{b}$
\end_inset

 or the interface 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

 takes the form
\begin_inset Formula 
\begin{equation}
\delta F=-\int_{\Gamma}\delta\mathbf{v}^{s}\cdot\left(-p\mathbf{n}+\mathbf{t}^{\tau}\right)\,da\,,\label{eq:bfsi-traction-virtual-work}
\end{equation}

\end_inset

where the elemental area 
\begin_inset Formula $da$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 may be evaluated from the covariant basis vectors 
\begin_inset Formula $\mathbf{g}_{\alpha}$
\end_inset

 (
\begin_inset Formula $\alpha=1,2$
\end_inset

),
\begin_inset Formula 
\begin{equation}
da=\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}\,,\label{eq:bfsi-diff-area}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}=\frac{\partial\mathbf{x}\left(\eta^{1},\eta^{2}\right)}{\partial\eta^{\alpha}}\,,\label{eq:bfsi-covar-vectors}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{x}\left(\eta^{1},\eta^{2}\right)$
\end_inset

 is the parametric representation of 
\begin_inset Formula $\Gamma$
\end_inset

, defined on the solid constituent.
 The outward normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 to 
\begin_inset Formula $\Omega^{b}$
\end_inset

 on 
\begin_inset Formula $\Gamma$
\end_inset

 is evaluated from
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq:bfsi-norm-vector}
\end{equation}

\end_inset

As a result, the virtual work can be rewritten as 
\begin_inset Formula 
\begin{equation}
\delta F=-\int_{\Gamma}\delta\mathbf{v}^{s}\cdot\left(-p\mathbf{I}+\boldsymbol{\tau}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\,d\eta^{1}d\eta^{2}\,.\label{eq:bfsi-traction-final}
\end{equation}

\end_inset

In FEBio this boundary condition is called 
\emph on
BFSI traction
\emph default
, which the user must explicitly prescribe on free surfaces 
\begin_inset Formula $\Gamma^{b}$
\end_inset

 and deformable interfaces 
\begin_inset Formula $\Gamma^{bs}$
\end_inset

.
 The code automatically determines which of these two types of interfaces
 is being considered.
\end_layout

\begin_layout Subsection
BFSI Linearization 
\begin_inset CommandInset label
LatexCommand label
name "sec:BFSI-Linearization"

\end_inset


\end_layout

\begin_layout Standard
Using the virtual work integral 
\begin_inset Formula $\delta W$
\end_inset

 such that 
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]+D\delta W\left[\Delta\mathbf{w}\right]+D\delta W\left[\Delta J^{f}\right]\approx0\,,\label{eq:Virtual-Work-Expanded-BFSI}
\end{equation}

\end_inset

 it may be expanded as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\delta W_{int}\left[\Delta\mathbf{u}\right]+D\delta W_{int}\left[\Delta\mathbf{w}\right]+D\delta W_{int}\left[\Delta J^{f}\right]\\
 & -D\delta W_{ext}\left[\Delta\mathbf{u}\right]-D\delta W_{ext}\left[\Delta\mathbf{w}\right]-D\delta W_{ext}\left[\Delta J^{f}\right]\\
 & \approx\delta W_{ext}-\delta W_{int}\,.
\end{aligned}
\label{eq:linearized-work-split-bfsi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linearizations of integrals are performed in the material frame of the
 solid domain of 
\begin_inset Formula $\Omega^{b}$
\end_inset

, allowing us to linearize 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

, or 
\begin_inset Formula $\Delta J^{f}$
\end_inset

 by simply bringing the directional derivative operator inside the integrals
 of Eqs.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-int-virtual-work"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-ext-virtual-work"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For notational convenience, we let 
\begin_inset Formula $J\equiv J^{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{F}\equiv\mathbf{F}^{s}$
\end_inset

.
 Thus, the conversion of the internal virtual work to the material frame
 of the solid produces 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int}= & \int_{\Omega^{b}}\left(-\varphi_{r}^{s}\mathbf{T}_{d}+\mathbf{F}\cdot\boldsymbol{\sigma}^{e}\cdot\mathbf{F}^{T}\right):\Grad\delta\mathbf{v}\cdot\mathbf{F}^{-1}dV\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\varphi_{r}^{s}\left(\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}\cdot\mathbf{F}^{-T}\cdot\Grad\left(\frac{\varphi^{f}}{\varphi^{s}}\right)-\rho_{T}^{f}\mathbf{a}^{f}+\rho_{T}^{s}\dot{\mathbf{v}}^{s}\right)dV\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-J^{2}\mathbf{F}^{-T}\cdot\mathbf{K}^{-1}\cdot\mathbf{F}^{-1}\cdot\mathbf{w}dV\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot J\left(\rho_{T}^{f}\mathbf{a}^{f}+\mathbf{F}^{-T}\cdot\Grad p\right)dV\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot J\left(-\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\mathbf{F}^{-T}\cdot\Grad\varphi^{f}+J\mathbf{F}^{-T}\cdot\mathbf{K}^{-1}\cdot\mathbf{F}^{-1}\cdot\mathbf{w}\right)dV\\
 & +\int_{\Omega^{b}}J\boldsymbol{\tau}:\Grad\delta\mathbf{w}\cdot\mathbf{F}^{-1}dV\\
 & +\int_{\Omega^{b}}J\Grad\delta J^{f}\cdot\mathbf{F}^{-1}\cdot\mathbf{w}+\delta J^{f}\left(J\frac{\varphi^{f}}{J^{f}}\frac{D^{f}J^{f}}{Dt}-\dot{J}^{s}\right)dV\thinspace,
\end{aligned}
\label{eq:int-virtual-work-material-BFSI}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}=J\,\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}^{e}\cdot\mathbf{F}^{-T}$
\end_inset

 is the second Piola-Kirchhoff stress for the solid constituent of the mixture,
 
\begin_inset Formula $\mathbf{W}=J\mathbf{F}^{-1}\cdot\mathbf{w}$
\end_inset

 is the Piola transformation of 
\begin_inset Formula $\mathbf{w}$
\end_inset

, and 
\begin_inset Formula $dV=J^{-1}dv$
\end_inset

 is an elemental volume of 
\begin_inset Formula $\Omega^{f}$
\end_inset

 in its material frame 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 In addition, 
\begin_inset Formula $\mathbf{K}^{-1}=J^{-1}\mathbf{F}^{T}\cdot\mathbf{k}^{-1}\cdot\mathbf{F}$
\end_inset

 is the inverse of the permeability tensor in the material frame.
 Note that in the material frame, the fluid acceleration 
\begin_inset Formula $\mathbf{a}^{f}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\mathbf{a}^{f}=\frac{1}{\varphi^{f}}\left(\dot{\mathbf{w}}+\varphi^{f}\dot{\mathbf{v}}^{s}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}}{J}\mathbf{w}+\frac{1}{J}\left(\frac{1}{\varphi^{f}}\Grad\mathbf{w}+\Grad\mathbf{v}^{s}-\frac{1}{\varphi^{f^{2}}}\mathbf{w}\otimes\Grad\varphi^{f}\right)\cdot\mathbf{W}\right)\,.\label{eq:material-fluid-accel-BFSI}
\end{equation}

\end_inset

 The linearization of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 is then performed along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, and the integral is reverted back to the spatial frame, yielding for the
 displacement equations
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{u}\right]= & \int_{\Omega^{b}}\alpha_{f}\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}^{e}:\grad\delta\mathbf{v}+\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}:\grad\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\varphi^{s}\boldsymbol{\tau}:\grad\delta\mathbf{v}\cdot\left(\grad\Delta\mathbf{u}+\frac{\varphi^{s}}{\varphi^{f}}\divg\Delta\mathbf{u}\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}^{\tau}:\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{D}^{w}+\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\grad\delta\mathbf{v}:\frac{1}{\varphi^{f^{2}}}\boldsymbol{\mathcal{C}}^{\tau}:2\frac{\varphi^{s}}{\varphi^{f}}\left(\divg\Delta\mathbf{u}\right)\mathbf{w}\otimes\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\varphi^{s}\grad\delta\mathbf{v}:\frac{1}{\varphi^{f^{2}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\grad^{T}\Delta\mathbf{u}\cdot\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\varphi^{s}\grad\delta\mathbf{v}:\frac{1}{\varphi^{f^{2}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\left(\divg\Delta\mathbf{u}\right)\grad\varphi^{f}+\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\tau}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\divg\Delta\mathbf{u}+\grad^{T}\Delta\mathbf{u}\right)\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\tau}\cdot\frac{1}{\varphi^{s}}\grad\left(\divg\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\mathcal{C}}^{\tau}:\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{D}^{w}+\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:2\frac{\varphi^{s}}{\varphi^{f}}\left(\divg\Delta\mathbf{u}\right)\mathbf{w}\otimes\grad\varphi^{f}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\grad^{T}\Delta\mathbf{u}\cdot\grad\varphi^{f}\right)\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\divg\Delta\mathbf{u}\grad\varphi^{f}+\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\dot{\mathbf{v}}^{s}+\varphi^{f}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\frac{\varphi^{s}}{\varphi^{f}}\left[\left(\left(-\frac{1}{\varphi^{f}}\right)\frac{\dot{J}}{J}+\frac{\gamma}{\beta\Delta t}\right)\divg\Delta\mathbf{u}-\grad^{T}\Delta\mathbf{u}:\mathbf{L}^{s}\right]\mathbf{w}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\divg\Delta\mathbf{u}\grad\mathbf{w}+\frac{\gamma}{\beta\Delta t}\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f^{3}}}\left[\left(\left(\varphi^{s}+1\right)\frac{1}{\varphi^{f}}\grad\varphi^{f}\divg\Delta\mathbf{u}-\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)\cdot\mathbf{w}\right]\mathbf{w}dv
\end{aligned}
\label{eq:Wint-lin-u-u-BFSI}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\mathbf{L}^{f}\cdot\grad\Delta\mathbf{u}\cdot\mathbf{w}+\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\mathbf{a}^{f}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\rho^{s}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\Delta\mathbf{u}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\left(-2\left(\divg\Delta\mathbf{u}\right)\mathbf{k}^{-1}+\grad^{T}\Delta\mathbf{u}\cdot\mathbf{k}^{-1}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\left(\mathbf{k}^{-1}\cdot\grad\Delta\mathbf{u}+\left(\mathbf{k}^{-1}\underbar{\otimes}\mathbf{k}^{-1}\right):\mathsf{k}:\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}dv\thinspace,
\end{aligned}
\]

\end_inset

 for the fluid flux equations 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{u}\right]= & \int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(-\frac{\varphi^{s}}{\varphi^{f}}\left[\left(-\frac{1}{\varphi^{f}}\frac{\dot{J}}{J}+\frac{\gamma}{\beta\Delta t}\right)\divg\Delta\mathbf{u}-\grad^{T}\Delta\mathbf{u}:\mathbf{L}^{s}\right]\mathbf{w}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\varphi^{s}\left(\divg\Delta\mathbf{u}\right)\dot{\mathbf{v}}^{s}+\varphi^{f}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\divg\Delta\mathbf{u}\grad\mathbf{w}+\frac{\gamma}{\beta\Delta t}\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\frac{1}{\varphi^{f^{2}}}\left[\left(\left(\varphi^{s}+1\right)\frac{1}{\varphi^{f}}\grad\varphi^{f}\left(\divg\Delta\mathbf{u}\right)-\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)\cdot\mathbf{w}\right]\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\mathbf{L}^{f}\cdot\grad\Delta\mathbf{u}\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\left(1-\frac{\varphi^{s}}{\varphi^{f}}\right)\left(\divg\Delta\mathbf{u}\right)\rho_{T}^{f}\mathbf{a}^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\left(\left(\divg\Delta\mathbf{u}\right)\mathbf{I}-\grad^{T}\Delta\mathbf{u}\right)\cdot\grad pdv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\left(2\left(\divg\Delta\mathbf{u}\right)\mathbf{k}^{-1}-\grad^{T}\Delta\mathbf{u}\cdot\mathbf{k}^{-1}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\left(\mathbf{k}^{-1}\cdot\grad\Delta\mathbf{u}+\left(\mathbf{k}^{-1}\underbar{\otimes}\mathbf{k}^{-1}\right):\mathsf{k}:\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\left(\divg\Delta\mathbf{u}\right)\mathbf{I}+\grad^{T}\Delta\mathbf{u}\right)\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\left(\divg\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\frac{1}{\varphi^{f}}\boldsymbol{\mathcal{C}}^{\tau}:\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{D}^{w}+\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\frac{1}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:2\frac{\varphi^{s}}{\varphi^{f}}\left(\divg\Delta\mathbf{u}\right)\mathbf{w}\otimes\grad\varphi^{f}\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{1}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\grad^{T}\Delta\mathbf{u}\cdot\grad\varphi^{f}\right)\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{1}{\varphi^{f^{3}}}\boldsymbol{\mathcal{C}}^{\tau}:\mathbf{w}\otimes\left(-\left(\divg\Delta\mathbf{u}\right)\grad\varphi^{f}+\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\boldsymbol{\tau}:\grad\delta\mathbf{w}\cdot\left(\left(1-\frac{\varphi^{s}}{\varphi^{f}}\right)\left(\divg\Delta\mathbf{u}\right)\mathbf{I}-\grad\Delta\mathbf{u}\right)dv
\end{aligned}
\label{eq:Wint-lin-w-u-BFSI}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & +\int_{\Omega^{b}}\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{D}^{w}+\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:2\frac{\varphi^{s}}{\varphi^{f^{3}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{w}\otimes\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\frac{1}{\varphi^{f^{2}}}\mathbf{w}\otimes\left(-\grad^{T}\Delta\mathbf{u}\cdot\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\frac{1}{\varphi^{f^{2}}}\mathbf{w}\otimes\left(-\left(\divg\Delta\mathbf{u}\right)\grad\varphi^{f}+\varphi^{s}\grad\left(\divg\Delta\mathbf{u}\right)\right)dv\thinspace,
\end{aligned}
\]

\end_inset

 and for the fluid dilatation equations 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{u}\right]= & \int_{\Omega^{b}}\alpha_{f}\grad\delta J^{f}\cdot\left(\divg\Delta\mathbf{u}\mathbf{I}-\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\left(\dot{J}^{f}\divg\Delta\mathbf{u}+\grad J^{f}\cdot\left(\left(\divg\Delta\mathbf{u}\right)\mathbf{I}-\grad\Delta\mathbf{u}\right)\cdot\mathbf{w}\right)dv\\
 & +\int_{\Omega^{b}}-\delta J^{f}\alpha_{f}\left(\divg\mathbf{v}^{s}+\frac{\gamma}{\beta\Delta t}\right)\divg\Delta\mathbf{u}+\grad^{T}\Delta\mathbf{u}:\mathbf{L}^{s}dv\thinspace,
\end{aligned}
\label{eq:Wint-lin-J-u-BFSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula $\mathbf{M}=\frac{\gamma}{\beta\Delta t}\mathbf{I}-\mathbf{L}^{s}$
\end_inset

, and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order spatial elasticity tensor associated with 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 As done in the CFD formulation (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Discretization-Linearization"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2018"
literal "true"

\end_inset

, we have introduced the fourth-order tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 representing the tangent of the viscous stress with respect to the rate
 of deformation, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}^{\tau}=\frac{\partial\boldsymbol{\tau}}{\partial\mathbf{D}^{f}}\,,\label{eq:visc-stress-tan-D-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{D}^{f}$
\end_inset

 is the fluid rate of deformation tensor (the symmetric part of 
\begin_inset Formula $\mathbf{L}^{f}$
\end_inset

).
 The tensors 
\begin_inset Formula $\boldsymbol{\mathcal{C}}_{d}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 depend on the choice of constitutive relations for the fluid and solid
 constituents of 
\begin_inset Formula $\Omega^{f}$
\end_inset

, respectively.
 In addition, 
\begin_inset Formula $\mathsf{k}$
\end_inset

 is the spatial fourth order permeability tensor with respect to right Cauchy-Gr
een tensor 
\begin_inset Formula $\mathbf{C}$
\end_inset

.
 The linearized equations include the generalized-
\begin_inset Formula $\alpha$
\end_inset

 parameters because the virtual work is evaluated at the intermediate time
 step, while the increment itself (
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 in this case) is at the current time step 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen2000a"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Standard
Following the same procedure, the linearizations of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{w}\right]= & \int_{\Omega^{b}}-\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}^{\tau}:\left(\grad\Delta\mathbf{w}-\frac{1}{\varphi^{f}}\Delta\mathbf{w}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\left(\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}}{J}-\frac{1}{\varphi^{f^{2}}}\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\right)\mathbf{I}+\mathbf{L}^{f}\right)\cdot\Delta\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f^{2}}}\grad\Delta\mathbf{w}\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\frac{\left(\varphi^{s}\right)^{2}}{\left(\varphi^{f}\right)^{2}}\boldsymbol{\mathcal{C}}^{\tau}:\left(\grad\Delta\mathbf{w}-\frac{1}{\varphi^{f}}\Delta\mathbf{w}\otimes\grad\varphi^{f}\right)\cdot\grad\left(\frac{\varphi^{f}}{\varphi^{s}}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot-\alpha_{f}\mathbf{k}^{-1}\cdot\Delta\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\left(\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}}{J}-\frac{1}{\varphi^{f^{2}}}\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\right)\mathbf{I}+\mathbf{L}^{f}\right)\cdot\Delta\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f^{2}}}\grad\Delta\mathbf{w}\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\mathbf{k}^{-1}\cdot\Delta\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\frac{1}{\varphi^{f^{2}}}\boldsymbol{\mathcal{C}}^{\tau}:\left(\frac{1}{\varphi^{f}}\Delta\mathbf{w}\otimes\grad\varphi^{f}-\grad\Delta\mathbf{w}\right)\cdot\grad\varphi^{f}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{1}{\varphi^{f}}\grad\delta\mathbf{w}:\boldsymbol{\mathcal{C}}^{\tau}:\left(\grad\Delta\mathbf{w}-\frac{1}{\varphi^{f}}\Delta\mathbf{w}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\grad\delta J^{f}\cdot\Delta\mathbf{w}+\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\grad J^{f}\cdot\Delta\mathbf{w}dv\thinspace,
\end{aligned}
\label{eq:Wint-lin-w-BFSI}
\end{equation}

\end_inset

 whereas the linearizations of 
\begin_inset Formula $\delta W_{int}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta J^{f}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta J^{f}\right]= & \int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{v}\Delta J^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\varphi^{s}\left(\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}+\frac{\rho_{T}^{f}}{J^{f}}\mathbf{a}^{f}\right)\Delta J^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\left(p^{\prime\prime}\grad J^{f}\Delta J^{f}+p^{\prime}\grad\Delta J^{f}\right)dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\left(\frac{\rho_{T}^{f}}{J^{f}}\mathbf{a}^{f}\Delta J^{f}+\frac{1}{\varphi^{f}}\boldsymbol{\tau}_{J}^{\prime}\Delta J^{f}\cdot\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\boldsymbol{\tau}_{J}^{\prime}:\grad\delta\mathbf{w}\Delta J^{f}dv\\
 & +\int_{\Omega^{b}}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\left(\varphi^{f}\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{1}{J^{f}}\left(\varphi^{f}\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)\right)\Delta J^{f}dv\\
 & +\int_{\Omega^{b}}\delta J^{f}\alpha_{f}\frac{1}{J^{f}}\grad\Delta J^{f}\cdot\mathbf{w}dv\thinspace.
\end{aligned}
\label{eq:Wint-lin-J-BFSI}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $p^{\prime}$
\end_inset

 and 
\begin_inset Formula $p^{\prime\prime}$
\end_inset

 respectively represent the first and second derivatives of 
\begin_inset Formula $p\left(J^{f}\right)$
\end_inset

.
 We have also defined 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}$
\end_inset

 as the tangent of the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 with respect to 
\begin_inset Formula $J^{f}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{J}^{\prime}=\frac{\partial\boldsymbol{\tau}}{\partial J^{f}}\,.\label{eq:visc-stress-tan-J-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work, when 
\begin_inset Formula $\mathbf{t}^{\sigma}$
\end_inset

, 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

, all 
\begin_inset Formula $\mathbf{b}$
\end_inset

 and 
\begin_inset Formula $w_{n}$
\end_inset

 are prescribed, the linearizations simplify to 
\begin_inset Formula 
\begin{equation}
D\delta W_{ext}\left[\Delta\mathbf{u}\right]=\int_{\Omega^{b}}\delta\mathbf{w}\cdot\alpha_{f}\divg\Delta\mathbf{u}\rho_{T}^{f}\mathbf{b}^{f}dv\,,\label{eq:Wext-lin-u-BFSI}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\delta W_{ext}\left[\Delta\mathbf{w}\right]=0\,,\label{eq:Wext-lin-w-BFSI}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{ext}\left[\Delta J^{f}\right]= & \int_{\Omega^{b}}\delta\mathbf{w}\cdot-\alpha_{f}\frac{\rho_{T}^{f}}{J^{f}}\mathbf{b}^{f}\Delta J^{f}dv\\
 & +\int_{\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{J^{f}}\mathbf{b}^{f}\Delta J^{f}dv\,.
\end{aligned}
\label{eq:Wext-lin-J-BFSI}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
As discussed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Mass-Momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we define the fluid dilatation 
\begin_inset Formula $e^{f}=J^{f}-1$
\end_inset

 as an alternative essential variable, since initial and boundary conditions
 
\begin_inset Formula $e^{f}=0$
\end_inset

 are more convenient to handle in a numerical scheme than 
\begin_inset Formula $J^{f}=1$
\end_inset

.
 It follows that 
\begin_inset Formula $\grad J^{f}=\grad e^{f}$
\end_inset

 and 
\begin_inset Formula $\dot{J}^{f}=\dot{e}^{f}$
\end_inset

.
 Therefore the changes to the above equations are minimal, simply requiring
 the substitution 
\begin_inset Formula $J^{f}=1+e^{f}$
\end_inset

 and 
\begin_inset Formula $\Delta J^{f}=\Delta e^{f}$
\end_inset

.
\end_layout

\begin_layout Subsection
BFSI Spatial Discretization
\begin_inset CommandInset label
LatexCommand label
name "sec:BFSI-Spatial-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The degrees of freedom 
\begin_inset Formula $\mathbf{u}\left(\mathbf{x},t\right)$
\end_inset

, 
\begin_inset Formula $\mathbf{w}\left(\mathbf{x},t\right)$
\end_inset

, 
\begin_inset Formula $J^{f}\left(\mathbf{x},t\right)$
\end_inset

 are spatially interpolated over the domain 
\begin_inset Formula $\Omega^{f}$
\end_inset

 using the same interpolation functions 
\begin_inset Formula $N_{a}\left(\mathbf{x}\right)$
\end_inset

, with 
\begin_inset Formula $a=1$
\end_inset

 to 
\begin_inset Formula $n$
\end_inset

, where 
\begin_inset Formula $n$
\end_inset

 is the number of nodes in an element, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{u}\left(\mathbf{x},t\right) & =\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)\mathbf{u}_{a}\,,\\
\mathbf{w}\left(\mathbf{x},t\right) & =\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)\mathbf{w}_{a}\,,\\
J^{f}\left(\mathbf{x},t\right) & =\sum_{a=1}^{n}N_{a}\left(\mathbf{x}\right)J_{a}^{f}\,.
\end{aligned}
\label{eq:spatial-interpol-BFSI}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{u}_{a}$
\end_inset

, 
\begin_inset Formula $\mathbf{w}_{a}$
\end_inset

, and 
\begin_inset Formula $J_{a}^{f}$
\end_inset

 are the nodal values of the degrees of freedom that evolve over time.
 These relations may be used to evaluate 
\begin_inset Formula $\mathbf{L}^{s}$
\end_inset

, 
\begin_inset Formula $\mathbf{L}^{w}$
\end_inset

, 
\begin_inset Formula $\divg\mathbf{w}$
\end_inset

, 
\begin_inset Formula $\dot{\mathbf{w}}$
\end_inset

, 
\begin_inset Formula $\grad J^{f}$
\end_inset

, 
\begin_inset Formula $\dot{J^{f}}$
\end_inset

, etc.
 Similar interpolations are used for virtual increments 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\delta\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\delta J^{f}$
\end_inset

, as well as real increments 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\Delta J^{f}$
\end_inset

.
 In practice, interpolations 
\begin_inset Formula $N_{a}$
\end_inset

 are performed in the parametric space of each finite element, which is
 a material frame.
\end_layout

\begin_layout Standard
Now, the discretized form of 
\begin_inset Formula $\delta W_{int}$
\end_inset

, using eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-int-virtual-work"
plural "false"
caps "false"
noprefix "false"

\end_inset

, may be written as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{u}\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}\\
 & +\sum_{a}\delta J_{a}^{f}f_{a}^{J}\,,
\end{aligned}
\label{eq:Wint-discret-BFSI}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u}= & \int_{\Omega^{b}}\left(-\varphi^{s}\boldsymbol{\tau}+\boldsymbol{\sigma}^{e}\right)\cdot\grad N_{a}dv\\
 & +\int_{\Omega^{b}}N_{a}\left(\varphi^{s}\left(\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}-\rho_{T}^{f}\mathbf{a}^{f}+\rho_{T}^{s}\dot{\mathbf{v}}^{s}\right)-\mathbf{k}^{-1}\cdot\mathbf{w}\right)dv\,,\\
\mathbf{f}_{a}^{w}= & \int_{\Omega^{b}}\boldsymbol{\tau}\cdot\grad N_{a}+N_{a}\left(\rho_{T}^{f}\mathbf{a}^{f}+\grad p-\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\grad\varphi^{f}+\mathbf{k}^{-1}\cdot\mathbf{w}\right)dv\,,\\
f_{a}^{J}= & \int_{\Omega^{b}}\grad N_{a}\cdot\mathbf{w}+N_{a}\left(\frac{\varphi^{f}}{J^{f}}\frac{D^{f}J^{f}}{Dt}-\frac{\dot{J}^{s}}{J^{s}}\right)dv\,.
\end{aligned}
\label{eq:Wint-discret-parts-BFSI}
\end{equation}

\end_inset

 The discretized form of 
\begin_inset Formula $D\delta W_{int}\left[\Delta\mathbf{u}\right]$
\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{u}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{uu}\cdot\Delta\mathbf{u}_{b}\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{wu}\cdot\Delta\mathbf{u}_{b}\\
 & +\sum_{a}\delta J_{a}^{f}\sum_{b}\mathbf{k}_{ab}^{Ju}\cdot\Delta\mathbf{u}_{b}\,,
\end{aligned}
\label{eq:Wint-lin-u-discret-FSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu}= & \int_{\Omega^{b}}\alpha_{f}\left(\left(\boldsymbol{\sigma}^{e}:\grad N_{b}\otimes\grad N_{a}\right)\mathbf{I}+\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\varphi^{s}\boldsymbol{\tau}\cdot\left(\frac{\varphi^{s}}{\varphi^{f}}\grad N_{a}\otimes\grad N_{b}+\grad N_{b}\otimes\grad N_{a}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\cdot\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{D}^{w}+\mathbf{M}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{\varphi^{s}}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\varphi^{f}\otimes\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{\varphi^{s}}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(\grad N_{b}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{\varphi^{s}}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(-\grad\varphi^{f}\otimes\grad N_{b}+\varphi^{s}\grad\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\tau}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\frac{\varphi^{f}}{\varphi^{s}}\otimes\grad N_{b}+\grad N_{b}\otimes\grad\frac{\varphi^{f}}{\varphi^{s}}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f}}\boldsymbol{\tau}\cdot\frac{1}{\varphi^{s}}\grad\grad N_{b}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f}}\grad\frac{\varphi^{f}}{\varphi^{s}}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\cdot\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{D}^{w}+\mathbf{M}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\grad\frac{\varphi^{f}}{\varphi^{s}}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\varphi^{f}\otimes\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\grad\frac{\varphi^{f}}{\varphi^{s}}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(\grad N_{b}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\grad\frac{\varphi^{f}}{\varphi^{s}}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(-\grad\varphi^{f}\otimes\grad N_{b}+\varphi^{s}\grad\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\rho_{T}^{f}N_{a}\left(\varphi^{s}\dot{\mathbf{v}}^{s}\otimes\grad N_{b}+\varphi^{f}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}N_{b}\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\rho_{T}^{f}N_{a}\frac{\varphi^{s^{2}}}{\varphi^{f^{2}}}\left[\left(\left(-\frac{1}{\varphi^{f}}\right)\frac{\dot{J}}{J}+\frac{\gamma}{\beta\Delta t}\right)\mathbf{w}\otimes\grad N_{b}-\mathbf{w}\otimes\left(\mathbf{L}^{s^{T}}\cdot\grad N_{b}\right)\right]dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{L}^{w}\cdot\mathbf{w}\otimes\grad N_{b}+\frac{\gamma}{\beta\Delta t}\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\rho_{T}^{f}\frac{\varphi^{s}}{\varphi^{f^{4}}}\left(\varphi^{s}+1\right)\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\mathbf{w}\otimes\grad N_{b}dv
\end{aligned}
\label{eq:Wint-lin-uu-discret-BFSI}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & +\int_{\Omega^{b}}\alpha_{f}N_{a}\rho_{T}^{f}\frac{\varphi^{s^{2}}}{\varphi^{f^{3}}}\mathbf{w}\otimes\grad\grad^{T}N_{b}\cdot\mathbf{w}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\rho_{T}^{f}N_{a}\left(\mathbf{L}^{f}\left(\grad N_{b}\cdot\mathbf{w}\right)+\varphi^{s}\mathbf{a}^{f}\otimes\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}\rho^{s}N_{b}\mathbf{I}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(-2\left(\mathbf{k}^{-1}\cdot\mathbf{w}\right)\otimes\grad N_{b}+\grad N_{b}\otimes\left(\mathbf{k}^{-1}\cdot\mathbf{w}\right)\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{k}^{-1}+\left(\mathbf{k}^{-1}\underbar{\otimes}\mathbf{k}^{-1}\right):\mathsf{k}:\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right)dv\,,
\end{aligned}
\]

\end_inset

 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{wu}= & \int_{\Omega^{b}}\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}N_{a}\left(\varphi^{s}\dot{\mathbf{v}}^{s}\otimes\grad N_{b}+\varphi^{f}\frac{\alpha_{m}}{\alpha_{f}\beta\Delta t^{2}}N_{b}\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}N_{a}\frac{\varphi^{s}}{\varphi^{f}}\left(-\frac{1}{\varphi^{f}}\frac{\dot{J}}{J}+\frac{\gamma}{\beta\Delta t}\right)\mathbf{w}\otimes\grad N_{b}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}N_{a}\frac{\varphi^{s}}{\varphi^{f}}\mathbf{w}\otimes\left(\mathbf{L}^{s^{T}}\cdot\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\mathbf{L}^{w}\cdot\mathbf{w}\right)\otimes\grad N_{b}+\frac{\gamma}{\beta\Delta t}\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\rho_{T}^{f}}{\varphi^{f^{4}}}\left(\varphi^{s}+1\right)\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\mathbf{w}\otimes\grad N_{b}dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{\rho_{T}^{f}}{\varphi^{f^{3}}}\varphi^{s}\mathbf{w}\otimes\left(\grad\grad^{T}N_{b}\cdot\mathbf{w}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{\rho_{T}^{f}}{\varphi^{f}}N_{a}\mathbf{L}^{f}\left(\grad N_{b}\cdot\mathbf{w}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(1-\frac{\varphi^{s}}{\varphi^{f}}\right)\rho_{T}^{f}\mathbf{a}^{f}\otimes\grad N_{b}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(\grad p\otimes\grad N_{b}-\grad N_{b}\otimes\grad p\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(2\left(\mathbf{k}^{-1}\cdot\mathbf{w}\right)\otimes\grad N_{b}-\grad N_{b}\otimes\left(\mathbf{k}^{-1}\cdot\mathbf{w}\right)\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\left(\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{k}^{-1}+\left(\mathbf{k}^{-1}\underbar{\otimes}\mathbf{k}^{-1}\right):\mathsf{k}:\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\varphi^{f}\otimes\grad N_{b}+\grad N_{b}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{1}{\varphi^{f}}\boldsymbol{\tau}\cdot\varphi^{s}\grad\grad N_{b}dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{1}{\varphi^{f}}\grad\varphi^{f}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\cdot\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{D}^{w}+\mathbf{M}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{1}{\varphi^{f^{3}}}\grad\varphi^{f}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\varphi^{f}\otimes\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\frac{1}{\varphi^{f^{3}}}\grad\varphi^{f}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(\grad N_{b}\otimes\grad\varphi^{f}\right)dv
\end{aligned}
\label{eq:Wint-lin-wu-discret-BFSI}
\end{equation}

\end_inset


\begin_inset Formula 
\[
\begin{aligned} & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{1}{\varphi^{f^{3}}}\grad\varphi^{f}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(-\grad\varphi^{f}\otimes\grad N_{b}+\varphi^{s}\grad\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\boldsymbol{\tau}\cdot\left(\left(1-\frac{\varphi^{s}}{\varphi^{f}}\right)\grad N_{a}\otimes\grad N_{b}-\grad N_{b}\otimes\grad N_{a}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}\cdot\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{D}^{w}+\mathbf{M}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{1}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f}}\grad\varphi^{f}\otimes\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{1}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(\grad N_{b}\otimes\grad\varphi^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\frac{1}{\varphi^{f^{2}}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(-\grad\varphi^{f}\otimes\grad N_{b}+\varphi^{s}\grad\grad N_{b}\right)dv\,,
\end{aligned}
\]

\end_inset

 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{Ju}= & \int_{\Omega^{b}}\alpha_{f}\left(\grad N_{b}\otimes\mathbf{w}-\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}\right)\cdot\grad N_{a}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{1}{J^{f}}\left(\dot{J}^{f}\grad N_{b}+\left(\grad N_{b}\otimes\mathbf{w}-\grad N_{b}\cdot\mathbf{w}\mathbf{I}\right)\cdot\grad J^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}\left(\frac{\dot{J}}{J}+\frac{\gamma}{\beta\Delta t}\right)\grad N_{b}+\mathbf{L}^{s^{T}}\cdot\grad N_{b}dv\,,
\end{aligned}
\label{eq:Wint-lin-Ju-discret-BFSI}
\end{equation}

\end_inset

 whereas that of 
\begin_inset Formula $D\delta W_{int}\left[\Delta\mathbf{w}\right]$
\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta\mathbf{w}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{uw}\cdot\Delta\mathbf{w}_{b}\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{ww}\cdot\Delta\mathbf{w}_{b}\\
 & +\sum_{a}\delta J_{a}^{f}\sum_{b}\mathbf{k}_{ab}^{Jw}\cdot\Delta\mathbf{w}_{b}\,,
\end{aligned}
\label{eq:Wint-lin-w-discret-BFSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uw}= & \int_{\Omega^{b}}\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\left(\frac{1}{\varphi^{f}}N_{b}\grad\varphi^{f}-\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f}}N_{a}\left(\left(\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}}{J}-\frac{1}{\varphi^{f^{2}}}\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\right)\mathbf{I}+\mathbf{L}^{f}\right)N_{b}dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{\varphi^{f^{2}}}N_{a}\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\left(\varphi^{s}\right)^{2}}{\left(\varphi^{f}\right)^{2}}\grad\frac{\varphi^{f}}{\varphi^{s}}\cdot\boldsymbol{\mathcal{C}}_{d}\cdot\left(-\frac{1}{\varphi^{f}}N_{b}\grad\varphi^{f}+\grad N_{b}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{a}N_{b}\mathbf{k}^{-1}dv\,,\\
\mathbf{K}_{ab}^{ww}= & \int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\rho_{T}^{f}}{\varphi^{f}}\left(\left(\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{\varphi^{s}}{\varphi^{f}}\frac{\dot{J}}{J}-\frac{1}{\varphi^{f^{2}}}\left(\grad\varphi^{f}\cdot\mathbf{w}\right)\right)\mathbf{I}+\mathbf{L}^{f}\right)N_{b}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\frac{\rho_{T}^{f}}{\varphi^{f^{2}}}\left(\grad N_{b}\cdot\mathbf{w}\right)\mathbf{I}dv\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{a}\left(\frac{1}{\varphi^{f^{2}}}\grad\varphi^{f}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\left(\frac{1}{\varphi^{f}}N_{b}\grad\varphi^{f}-\grad N_{b}\right)+N_{b}\mathbf{k}^{-1}\right)dv\\
 & +\int_{\Omega^{b}}\alpha_{f}\frac{1}{\varphi^{f}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\left(-\frac{1}{\varphi^{f}}N_{b}\grad\varphi^{f}+\grad N_{b}\right)dv\,,\\
\mathbf{k}_{ab}^{Jw}= & \int_{\Omega^{b}}\alpha_{f}N_{b}\left(\grad N_{a}+N_{a}\frac{1}{J^{f}}\grad J^{f}\right)dv\,,
\end{aligned}
\label{eq:Wint-lin-w-discret-parts-BFSI}
\end{equation}

\end_inset

 and finally, for 
\begin_inset Formula $D\delta W_{int}\left[\Delta J^{f}\right]$
\end_inset

 the equations become 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{int}\left[\Delta J^{f}\right]= & \sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{uJ}\Delta J_{b}^{f}\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{wJ}\Delta J_{b}^{f}\\
 & +\sum_{a}\delta J_{a}^{f}\sum_{b}k_{ab}^{JJ}\Delta J_{b}^{f}\,,
\end{aligned}
\label{eq:Wint-lin-J-discret-BFSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ab}^{uJ}= & \int_{\Omega^{b}}\alpha_{f}\varphi^{s}N_{a}N_{b}\left(\frac{\varphi^{s}}{\varphi^{f}}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad\frac{\varphi^{f}}{\varphi^{s}}+\frac{\rho_{T}^{f}}{J^{f}}\mathbf{a}^{f}\right)dv\\
 & +\int_{\Omega^{b}}-\alpha_{f}N_{b}\varphi^{s}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}dv\,,\\
\mathbf{k}_{ab}^{wJ}= & \int_{\Omega^{b}}\alpha_{f}N_{a}\left(p^{\prime}\grad N_{b}+N_{b}\left(p^{\prime\prime}\grad J^{f}-\frac{\rho_{T}^{f}}{J^{f}}\mathbf{a}^{f}-\frac{1}{\varphi^{f}}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad\varphi^{f}\right)\right)dv\Delta J_{b}^{f}\\
 & +\int_{\Omega^{b}}\alpha_{f}N_{b}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}dv\,,\\
k_{ab}^{JJ}= & \int_{\Omega^{b}}\alpha_{f}N_{a}\frac{1}{J^{f}}\left(\left(\varphi^{f}\frac{\alpha_{m}}{\gamma\alpha_{f}\Delta t}-\frac{1}{J^{f}}\left(\varphi^{f}\dot{J}^{f}+\grad J^{f}\cdot\mathbf{w}\right)\right)N_{b}+\grad N_{b}\cdot\mathbf{w}\right)dv\,,
\end{aligned}
\label{eq:Wint-lin-J-discret-parts-BFSI}
\end{equation}

\end_inset

 for external virtual work in eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-ext-virtual-work"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the discretized equations are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext} & =\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}^{u}\\
 & +\sum_{a}\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}\\
 & +\sum_{a}\delta J_{a}^{f}f_{a}^{J}\,,
\end{aligned}
\label{eq:Wext-discret-BFSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a,ext}^{u} & =\int_{\partial\Omega^{b}}N_{a}\mathbf{t}^{\sigma}da+\int_{\Omega^{b}}N_{a}\varphi^{s}\left(-\rho_{T}^{f}\mathbf{b}^{f}+\rho_{T}^{s}\mathbf{b}^{s}\right)dv\,,\\
\mathbf{f}_{a,ext}^{w} & =\int_{\partial\Omega^{b}}N_{a}\mathbf{t}^{\tau}da+\int_{\Omega^{b}}\rho_{T}^{f}N_{a}\mathbf{b}^{f}dv\,,\\
f_{a,ext}^{J} & =\int_{\partial\Omega^{b}}N_{a}w_{n}da\,,
\end{aligned}
\label{eq:Wext-discret-parts-BFSI}
\end{equation}

\end_inset

and the discretized forms of the linearized external virtual work are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W_{ext}\left[\Delta\mathbf{u}\right] & =\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{wu}\cdot\Delta\mathbf{u}_{b}\,,\\
D\delta W_{ext}\left[\Delta J^{f}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{uJ}\Delta J_{b}^{f}+\sum_{a}\delta\mathbf{w}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{wJ}\Delta J_{b}^{f}\,,
\end{aligned}
\label{eq:Wext-lin-discret-BFSI}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab,ext}^{wu}= & \int_{\Omega^{b}}\alpha_{f}N_{a}\rho_{T}^{f}\mathbf{b}^{f}\otimes\grad N_{b}dv\,,\\
\mathbf{k}_{ab,ext}^{uJ}= & -\int_{\Omega^{b}}\alpha_{f}\varphi^{s}\frac{\rho_{T}^{f}}{J^{f}}N_{a}N_{b}\mathbf{b}^{f}dv\,,\\
\mathbf{k}_{ab,ext}^{wJ}= & -\int_{\Omega^{b}}\alpha_{f}\frac{\rho_{T}^{f}}{J^{f}}N_{a}N_{b}\mathbf{b}^{f}dv\,.
\end{aligned}
\label{eq:Wext-lin-discret-parts-BFSI}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Combining these results, from the linearized virtual work equation of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:linearized-work-split"

\end_inset

 we can represent the system of equations in a compact matrix form as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw} & \mathbf{k}_{ab}^{uJ}-\mathbf{k}_{ab,ext}^{uJ}\\
\mathbf{K}_{ab}^{wu}-\mathbf{K}_{ab,ext}^{wu} & \mathbf{K}_{ab}^{ww} & \mathbf{k}_{ab}^{wJ}-\mathbf{k}_{ab,ext}^{wJ}\\
\mathbf{k}_{ab}^{Ju} & \mathbf{k}_{ab}^{Jw} & k_{ab}^{JJ}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}\\
\Delta\mathbf{w}\\
\Delta J^{f}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{f}_{a,ext}^{u}-\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a,ext}^{w}-\mathbf{f}_{a}^{w}\\
f_{a,ext}^{J}-f_{a}^{J}
\end{array}\right]\,.\label{eq:Virtual-work-matrix-BFSI}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
BFSI Traction Interface 
\begin_inset CommandInset label
LatexCommand label
name "sec:BFSI-Traction-Interface"

\end_inset


\end_layout

\begin_layout Standard
The virtual work 
\begin_inset Formula $\delta F$
\end_inset

 on a biphasic-FSI interface was given in eq.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bfsi-traction-final"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The linearizations of 
\begin_inset Formula $\delta F$
\end_inset

 are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta F\left[\Delta\mathbf{u}\right]= & \int_{\partial\Omega^{b}}\delta\mathbf{v}\cdot\alpha_{f}\frac{\varphi^{s}}{\varphi^{f}}\left(\divg\Delta\mathbf{u}\right)\mathbf{T}_{d}\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\boldsymbol{\mathcal{C}}^{\tau}:\alpha_{f}\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{D}^{w}+\mathbf{M}\cdot\grad\Delta\mathbf{u}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\boldsymbol{\mathcal{C}}^{\tau}:\alpha_{f}\left(2\frac{\varphi^{s}}{\varphi^{f^{3}}}\left(\divg\Delta\mathbf{u}\right)\mathbf{w}\otimes\grad\varphi^{f}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\boldsymbol{\mathcal{C}}^{\tau}:\alpha_{f}\left(-\frac{1}{\varphi^{f^{2}}}\mathbf{w}\otimes\left(-\grad^{T}\Delta\mathbf{u}\cdot\grad\varphi^{f}\right)\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}\delta\mathbf{v}\cdot\boldsymbol{\mathcal{C}}^{\tau}:\alpha_{f}\left(\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{w}\otimes\left(-\frac{1}{J}\left(\divg\Delta\mathbf{u}\right)\grad J+\grad\left(\divg\Delta\mathbf{u}\right)\right)\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\alpha_{f}\boldsymbol{\tau}\cdot\left(\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\times\mathbf{g}_{2}+\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}\right)\thinspace d\eta^{1}d\eta^{2}\,,\\
D\delta F\left[\Delta\mathbf{w}\right] & =\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\alpha_{f}\boldsymbol{\mathcal{C}}^{\tau}:\left(\frac{1}{\varphi^{f}}\grad\Delta\mathbf{w}-\frac{1}{\varphi^{f^{2}}}\Delta\mathbf{w}\otimes\grad\varphi^{f}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\,,\\
D\delta F\left[\Delta J^{f}\right] & =\int_{\partial\Omega^{b}}-\delta\mathbf{v}\cdot\alpha_{f}\left(-p^{\prime}\mathbf{I}+\boldsymbol{\tau}_{J}^{\prime}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\Delta J^{f}\thinspace d\eta^{1}d\eta^{2}\,.
\end{aligned}
\label{eq:BFSI-int-lin}
\end{equation}

\end_inset

 The discretized forms of this virtual work is 
\begin_inset Formula 
\begin{equation}
\delta F=\sum_{a}\delta\mathbf{v}_{a}\cdot\mathbf{f}_{a}\,,\label{eq:BSI-int-discret}
\end{equation}

\end_inset

 where 
\begin_inset Formula 
\begin{equation}
\mathbf{f}_{a}=\int_{\partial\Omega^{b}}-N_{a}\left(-p\mathbf{I}+\boldsymbol{\tau}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\,.\label{eq:BFSI-int-discret-parts}
\end{equation}

\end_inset

The discretized forms of the linearizations are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta F\left[\Delta\mathbf{u}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{uu}\cdot\Delta\mathbf{u}_{b}\,,\\
D\delta F\left[\Delta\mathbf{w}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{K}_{ab}^{uw}\cdot\Delta\mathbf{w}_{b}\,,\\
D\delta F\left[\Delta J^{f}\right] & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\mathbf{k}_{ab}^{uJ}\Delta J_{b}^{f}\,,
\end{aligned}
\label{eq:BFSI-int-lin-discret}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu}= & \int_{\partial\Omega^{b}}\alpha_{f}N_{a}\frac{\varphi^{s}}{\varphi^{f}}\left(\boldsymbol{\tau}\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\right)\otimes\grad N_{b}\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}_{d}\cdot\grad N_{b}\cdot\left(-\frac{\varphi^{s}}{\varphi^{f^{2}}}\mathbf{D}^{w}+\mathbf{M}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(2\frac{\varphi^{s}}{\varphi^{f^{3}}}\grad\varphi^{f}\otimes\grad N_{b}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\left(\frac{1}{\varphi^{f^{2}}}\grad N_{b}\otimes\grad\varphi^{f}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\mathbf{w}\cdot\frac{\varphi^{s}}{\varphi^{f^{2}}}\left(-\frac{1}{J}\grad J\otimes\grad N_{b}+\grad\grad N_{b}\right)\thinspace d\eta^{1}d\eta^{2}\\
 & +\int_{\partial\Omega^{b}}-\alpha_{f}N_{a}\left(-p\mathbf{I}+\boldsymbol{\tau}\right)\cdot\boldsymbol{\mathcal{A}}\left\{ -\mathbf{g}_{2}\frac{\partial N_{b}}{\partial\eta^{1}}+\mathbf{g}_{1}\frac{\partial N_{b}}{\partial\eta^{2}}\right\} \thinspace d\eta^{1}d\eta^{2}\,,\\
\mathbf{K}_{ab}^{uw}= & \int_{\partial\Omega^{b}}-\alpha_{f}N_{a}\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\cdot\boldsymbol{\mathcal{C}}_{d}\cdot\frac{1}{\varphi^{f}}\left(\grad N_{b}-\frac{1}{\varphi^{f}}N_{b}\grad\varphi^{f}\right)\thinspace d\eta^{1}d\eta^{2}\,,\\
\mathbf{k}_{ab}^{uJ}= & \int_{\partial\Omega^{b}}-\alpha_{f}N_{a}N_{b}\left(-p^{\prime}\mathbf{I}+\boldsymbol{\tau}_{J}^{\prime}\right)\cdot\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\thinspace d\eta^{1}d\eta^{2}\,.
\end{aligned}
\label{eq:BFSI-int-lin-discret-parts}
\end{equation}

\end_inset

 Note that 
\begin_inset Formula $\boldsymbol{\mathcal{A}}\left\{ \cdot\right\} $
\end_inset

 represents the skew-symmetric tensor form of the bracketed vector.
\end_layout

\begin_layout Section
Weak Formulation for Fluid-Solutes Analyses
\begin_inset CommandInset label
LatexCommand label
name "sec:Weak-Fluid-Solutes"

\end_inset


\end_layout

\begin_layout Subsection
Virtual Work and Weak form for Fluid-Solutes
\end_layout

\begin_layout Standard
The virtual work statement is used to enforce the governing equations needed
 to solve for the nodal 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

, 
\begin_inset Formula $e^{f}$
\end_inset

, and all 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

, namely the mixture mass balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mix-Mass-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the fluid momentum balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Bal-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and the solute mass balances 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Bal-Solute-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, in addition to the current density constraint 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Current-Density-Constraint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The virtual work statement for a Galerkin finite element formulation 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet2008"
literal "true"

\end_inset

 is 
\begin_inset Formula $\delta W=0$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W= & \int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(-\grad\tilde{p}+\divg\boldsymbol{\tau}-\sum_{\iota}R\theta\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}+\rho^{f}\left(\mathbf{b}^{f}-\mathbf{a}^{f}\right)+M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)dv\\
 & +\int_{\Omega^{f}}\delta J^{f}\left(-\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\divg\mathbf{v}^{f}\right)dv\\
 & +\sum_{\iota}\int_{\Omega^{f}}\delta\tilde{c}^{\iota}\left(\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}+\divg\mathbf{j}^{\iota}-\hat{c}^{\iota}+\sum_{\beta}z^{\beta}\divg\mathbf{j}^{\iota}\right)dv\,.
\end{aligned}
\label{eq:CFDSol-Virtual-Work}
\end{equation}

\end_inset

These integrals are evaluated in the current (time-invariant) configuration
 of 
\begin_inset Formula $\Omega^{f}$
\end_inset

.
 Here, 
\begin_inset Formula $\delta\mathbf{v}^{f}$
\end_inset

 is the virtual fluid velocity, 
\begin_inset Formula $\delta J^{f}$
\end_inset

 is the virtual fluid energy density, and 
\begin_inset Formula $\delta\tilde{c}^{\iota}$
\end_inset

 is the virtual molar energy of solute 
\begin_inset Formula $\iota$
\end_inset

.
 Integrating by parts and using the divergence theorem, the weak form of
 this statement may be written as 
\begin_inset Formula $0=\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

 where the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int}= & \int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(\grad\tilde{p}+\rho^{f}\mathbf{a}^{f}+\sum_{\iota}R\theta\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}\right)+\boldsymbol{\tau}:\grad\delta\mathbf{v}^{f}dv\\
 & +\int_{\Omega^{f}}\delta J^{f}\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\grad\delta J^{f}\cdot\mathbf{v}^{f}dv\\
 & +\sum_{\iota}\int_{\Omega^{f}}\left(\grad\delta\tilde{c}^{\iota}\cdot\left(\mathbf{j}_{d}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{d}^{\gamma}\right)-\delta\tilde{c}^{\iota}\left(\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}-\hat{c}^{\iota}\right)\right)dv\,.
\end{aligned}
\label{eq:Int-Virtual-Work-CFDSol}
\end{equation}

\end_inset

The external virtual work is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext}= & \int_{\Gamma^{f}}\delta\mathbf{v}^{f}\cdot\mathbf{t}^{\tau}da+\int_{\Gamma^{f}}\delta J^{f}v_{n}^{f}da+\int_{\Gamma^{f}}\delta\tilde{c}^{\iota}\tilde{j}_{n}^{\iota}da\\
 & +\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(\rho^{f}\mathbf{b}^{f}+\sum_{\iota}M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)dv\\
 & -\sum_{\iota}\int_{\Omega^{f}}\grad\delta\tilde{c}^{\iota}\cdot\tilde{\mathbf{j}}_{b}^{\iota}dv\,,
\end{aligned}
\label{eq:Ext-Virt-Work-CFDSol}
\end{equation}

\end_inset

 where
\begin_inset Formula 
\begin{equation}
\tilde{j}_{n}^{\iota}=\left(\mathbf{j}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}^{\gamma}\right)\cdot\mathbf{n}\,.\label{eq:Normal-Sol-Flux-CFDSol}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the fluid viscous traction, 
\begin_inset Formula $v_{n}^{f}=\mathbf{v}^{f}\cdot\mathbf{n}$
\end_inset

 is the normal component of the fluid velocity on the boundary 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, and 
\begin_inset Formula $\tilde{j}_{n}^{\iota}$
\end_inset

 is the normal effective diffusive flux of solute 
\begin_inset Formula $\iota$
\end_inset

 on the boundary 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the outward normal to 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 The integrands of the surface integrals represent the natural boundary
 conditions for this formulation.
 If boundary conditions are not set explicitly on 
\begin_inset Formula $\Gamma^{f}$
\end_inset

, the natural boundary conditions are 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, 
\begin_inset Formula $v_{n}^{f}=0$
\end_inset

, and 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=0$
\end_inset

.
 These natural boundary conditions are consistent with the jump conditions
 presented above in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fluid-Mtm-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Jump-Final-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Jump-Sol-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Essential boundary conditions are prescribed on the fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

, fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

, and effective solute concentration 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

, which are also consistent with the above jump conditions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:J-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Mass-Jump-Final-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Conc-Jump-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For example, an essential no-slip boundary condition may be prescribed
 on 
\begin_inset Formula $\Gamma^{f}$
\end_inset

 by setting 
\begin_inset Formula $\mathbf{v}^{f}=\mathbf{0}$
\end_inset

.
 A symmetry plane may be prescribed from the natural boundary conditions
 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, 
\begin_inset Formula $v_{n}^{f}=0$
\end_inset

, and 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=0$
\end_inset

.
 In this formulation, the mixture traction is defined as 
\begin_inset Formula $\mathbf{t}=-p\mathbf{n}+\mathbf{t}^{\tau}$
\end_inset

.
 Because of the way we chose to split the internal and external virtual
 work in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Int-Virtual-Work-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Ext-Virt-Work-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\mathbf{t}$
\end_inset

 is not a natural boundary condition in this formulation.
 Thus, when 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

 is desired, it has to be enforced by satisfying the natural boundary condition
 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

, and selecting suitable values for the essential boundary conditions 
\begin_inset Formula $J^{f}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Total-fluid-p-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Eff-Pressure-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to produce 
\begin_inset Formula $p=0$
\end_inset

, as explained next.
\end_layout

\begin_layout Standard
The actual fluid gauge pressure in this fluid-solutes mixture is 
\begin_inset Formula $p$
\end_inset

, as given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Total-fluid-p-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 To prescribe a desired value 
\begin_inset Formula $p=p^{*}$
\end_inset

 on a boundary, we implemented a 
\begin_inset Quotes eld
\end_inset

fluid pressure
\begin_inset Quotes erd
\end_inset

 boundary condition that prescribed the correct value of 
\begin_inset Formula $J^{f}$
\end_inset

 according to the current values of all 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

, using the user-selected constitutive model for 
\begin_inset Formula $\tilde{p}\left(J^{f}\right)$
\end_inset

.
 For example, using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Eff-Pressure-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

, this 
\begin_inset Quotes eld
\end_inset

fluid pressure
\begin_inset Quotes erd
\end_inset

 boundary condition actually prescribes 
\begin_inset Formula $J^{f}=1/\left(1+\left(p^{*}-R\theta\Phi\sum_{\iota}\tilde{\kappa}^{\iota}\tilde{c}^{\iota}\right)/K\right)$
\end_inset

 as an essential boundary condition at nodes of 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
 The values of 
\begin_inset Formula $\Phi$
\end_inset

 and 
\begin_inset Formula $\tilde{\kappa}^{\iota}$
\end_inset

 are obtained from the finite element of the domain 
\begin_inset Formula $\Omega^{f}$
\end_inset

 right underneath the face 
\begin_inset Formula $\Gamma^{f}$
\end_inset

.
\end_layout

\begin_layout Subsection
Linearization for Fluid-Solutes
\end_layout

\begin_layout Standard
We can rewrite the internal work of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CFDSol-Virtual-Work"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\[
\begin{aligned}\delta W_{int} & =\delta W_{int}^{v}+\delta W_{int}^{J}+\delta W_{int}^{c}\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\delta W_{int}^{v} & =\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(\grad\tilde{p}+\rho^{f}\mathbf{a}^{f}+\sum_{\iota}R\theta\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}\right)+\boldsymbol{\tau}:\grad\delta\mathbf{v}^{f}dv\\
\delta W_{int}^{J} & =\int_{\Omega^{f}}\delta J^{f}\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\grad\delta J^{f}\cdot\mathbf{v}^{f}dv\\
\delta W_{int}^{c} & =\sum_{\iota}\int_{\Omega^{f}}\left(\grad\delta\tilde{c}^{\iota}\cdot\left(\mathbf{j}_{d}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{d}^{\gamma}\right)-\delta\tilde{c}^{\iota}\left(\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}-\hat{c}^{\iota}\right)\right)dv\,.
\end{aligned}
\]

\end_inset

Recall that 
\begin_inset Formula $\hat{c}^{\iota}=\nu^{\iota}\hat{\zeta}$
\end_inset

.
 Also note that
\begin_inset Formula 
\[
\begin{aligned}\mathbf{a}^{f} & =\frac{\partial\mathbf{v}^{f}}{\partial t}+\grad\mathbf{v}^{f}\cdot\mathbf{v}^{f}\\
\frac{D^{f}J^{f}}{Dt} & =\frac{\partial J^{f}}{\partial t}+\grad J^{f}\cdot\mathbf{v}^{f}\\
\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt} & =\tilde{c}^{\iota}\left(\tilde{\kappa}^{\iota}+J^{f}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\right)\frac{D^{f}J^{f}}{Dt}+J^{f}\left(\tilde{\kappa}^{\iota}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\\
\frac{D^{f}c^{\iota}}{Dt} & =\frac{\partial c^{\iota}}{\partial t}+\grad c^{\iota}\cdot\mathbf{v}^{f}\\
 & =\tilde{\kappa}^{\iota}\frac{\partial\tilde{c}^{\iota}}{\partial t}+\tilde{c}^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial t}+\left(\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}+\tilde{c}^{\iota}\grad\tilde{\kappa}^{\iota}\right)\cdot\mathbf{v}^{f}\\
\frac{\partial\tilde{\kappa}^{\iota}}{\partial t} & =\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\frac{\partial J^{f}}{\partial t}+\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\frac{\partial\tilde{c}^{\gamma}}{\partial t}\\
\grad\tilde{\kappa}^{\iota} & =\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\grad J+\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\grad\tilde{c}^{\gamma}
\end{aligned}
\]

\end_inset

Using the temporal discretization approach outlined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Discretization-Linearization"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the linearizations of each of these terms along increments in the degrees
 of freedom are obtained using
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{a}^{f}\left[\Delta\mathbf{v}^{f}\right] & =\frac{\alpha_{m}}{\gamma}\frac{\Delta\mathbf{v}^{f}}{\Delta t}+\alpha_{f}\left(\grad\Delta\mathbf{v}^{f}\cdot\mathbf{v}^{f}+\mathbf{L}^{f}\cdot\Delta\mathbf{v}^{f}\right)\\
D\left(\frac{D^{f}J^{f}}{Dt}\right)\left[\Delta\mathbf{v}_{f}\right] & =\alpha_{f}\grad J^{f}\cdot\Delta\mathbf{v}_{f}\\
D\boldsymbol{\tau}\left[\Delta\mathbf{v}^{f}\right] & =\alpha_{f}\boldsymbol{\mathcal{C}}^{\tau}:\frac{1}{2}\left(\grad\Delta\mathbf{v}^{f}+\grad^{T}\Delta\mathbf{v}^{f}\right)\\
D\left(\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}\right)\left[\Delta\mathbf{v}^{f}\right] & =\alpha_{f}\grad\left(J^{f}c^{\iota}\right)\cdot\Delta\mathbf{v}^{f}
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}D\left(\grad\tilde{p}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\left(\tilde{p}_{J}^{\prime}\grad\Delta J^{f}+\Delta J^{f}\tilde{p}_{J}^{\prime\prime}\grad J^{f}\right)\\
D\rho^{f}\left[\Delta J^{f}\right] & =-\alpha_{f}\frac{\rho^{f}}{J^{f}}\Delta J^{f}\\
D\boldsymbol{\tau}\left[\Delta J^{f}\right] & =\alpha_{f}\boldsymbol{\tau}_{J}^{\prime}\Delta J^{f}\\
D\left(\frac{D^{f}J^{f}}{Dt}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\Delta J^{f}}{\Delta t}+\grad\Delta J^{f}\cdot\mathbf{v}^{f}\right)\\
D\tilde{\kappa}^{\iota}\left[\Delta J^{f}\right] & =\alpha_{f}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\Delta J^{f}\\
D\left(\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\tilde{c}^{\iota}\left(\tilde{\kappa}^{\iota}+J^{f}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\right)\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\Delta J^{f}}{\Delta t}+\grad\Delta J^{f}\cdot\mathbf{v}^{f}\right)\\
 & +\alpha_{f}\tilde{c}^{\iota}\frac{D^{f}J^{f}}{Dt}\left(2\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}+J^{f}\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial\left(J^{f}\right)^{2}}\right)\Delta J^{f}\\
 & +\alpha_{f}\left(\tilde{\kappa}^{\iota}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\Delta J^{f}\\
 & +\alpha_{f}J^{f}\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\left(\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial J^{f}\partial\tilde{c}^{\gamma}}\right)\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\Delta J^{f}\\
D\hat{c}^{\iota}\left[\Delta J^{f}\right] & =\alpha_{f}\nu^{\iota}\frac{\partial\hat{\zeta}}{\partial J^{f}}\Delta J^{f}\\
D\mathbf{j}_{d}^{\iota}\left[\Delta J^{f}\right] & =-\alpha_{f}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\Delta J^{f}d_{0}^{\iota}\grad\tilde{c}^{\iota}
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}D\left(\tilde{\kappa}^{\iota}\tilde{c}^{\iota}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}+\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\iota}\right)\Delta\tilde{c}^{\beta}\\
D\left(\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}\grad\Delta\tilde{c}^{\beta}+\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\Delta\tilde{c}^{\beta}\grad\tilde{c}^{\iota}\right)\\
D\left(\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}J^{f}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}+\tilde{c}^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}+\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}\right)\Delta\tilde{c}^{\beta}+\grad\Delta\tilde{c}^{\beta}\cdot\mathbf{v}^{f}\right)\\
D\hat{c}^{\iota}\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}\nu^{\iota}\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\beta}}\Delta\tilde{c}^{\beta}\\
D\mathbf{j}_{d}^{\iota}\left[\Delta\tilde{c}^{\beta}\right] & =-\alpha_{f}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}d_{0}^{\beta}\grad\Delta\tilde{c}^{\beta}+\Delta\tilde{c}^{\beta}\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}d_{0}^{\iota}+\tilde{\kappa}^{\iota}\frac{\partial d_{0}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\grad\tilde{c}^{\iota}\right)
\end{aligned}
\]

\end_inset

Then we can evaluate the linearizations as follows,
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{v}\right)\left[\Delta\mathbf{v}^{f}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\rho^{f}\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\Delta\mathbf{v}^{f}}{\Delta t}+\left(\grad\Delta\mathbf{v}^{f}\cdot\mathbf{v}^{f}+\mathbf{L}^{f}\cdot\Delta\mathbf{v}^{f}\right)\right)dv\\
 & +\alpha_{f}\int_{\Omega^{f}}\grad\delta\mathbf{v}^{f}:\boldsymbol{\mathcal{C}}^{\tau}:\frac{1}{2}\left(\grad\Delta\mathbf{v}^{f}+\grad^{T}\Delta\mathbf{v}^{f}\right)dv\\
D\left(\delta W_{int}^{v}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(\tilde{p}_{J}^{\prime}\grad\Delta J^{f}+\Delta J^{f}\tilde{p}_{J}^{\prime\prime}\grad J^{f}+\Delta J^{f}\sum_{\iota}R\theta\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\grad\tilde{c}^{\iota}\right)dv\\
 & -\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\frac{\rho^{f}}{J^{f}}\Delta J^{f}\mathbf{a}^{f}dv+\alpha_{f}\int_{\Omega^{f}}\boldsymbol{\tau}_{J}^{\prime}\Delta J^{f}:\grad\delta\mathbf{v}^{f}dv\\
D\left(\delta W_{int}^{v}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot R\theta\sum_{\iota}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}\grad\Delta\tilde{c}^{\beta}+\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\Delta\tilde{c}^{\beta}\grad\tilde{c}^{\iota}\right)dv
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{J}\right)\left[\Delta\mathbf{v}^{f}\right] & =\alpha_{f}\int_{\Omega^{f}}\left(\delta J^{f}\frac{1}{J^{f}}\grad J^{f}+\grad\delta J^{f}\right)\cdot\Delta\mathbf{v}^{f}dv\\
D\left(\delta W_{int}^{J}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta J^{f}\frac{1}{J^{f}}\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}-\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}\right)\Delta J^{f}+\grad\Delta J^{f}\cdot\mathbf{v}^{f}\right)dv\\
D\left(\delta W_{int}^{J}\right)\left[\Delta\tilde{c}^{\beta}\right] & =0
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{c}\right)\left[\Delta\mathbf{v}^{f}\right] & =\sum_{\iota}\int_{\Omega^{f}}-\delta\tilde{c}^{\iota}\frac{1}{J^{f}}\grad\left(J^{f}c^{\iota}\right)\cdot\alpha_{f}\Delta\mathbf{v}_{f}\\
D\left(\delta W_{int}^{c}\right)\left[\Delta J^{f}\right] & =\sum_{\iota}\int_{\Omega^{f}}\delta\tilde{c}^{\iota}\frac{\alpha_{f}\Delta J^{f}}{\left(J^{f}\right)^{2}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}\\
 & -\delta\tilde{c}^{\iota}\alpha_{f}\frac{\tilde{c}^{\iota}}{J^{f}}\left(\tilde{\kappa}^{\iota}+J^{f}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\right)\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{\Delta J^{f}}{\Delta t}+\grad\Delta J^{f}\cdot\mathbf{v}^{f}\right)\\
 & -\delta\tilde{c}^{\iota}\alpha_{f}\frac{\tilde{c}^{\iota}}{J^{f}}\frac{D^{f}J^{f}}{Dt}\left(2\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}+J^{f}\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial\left(J^{f}\right)^{2}}\right)\Delta J^{f}\\
 & -\delta\tilde{c}^{\iota}\alpha_{f}\frac{1}{J^{f}}\left(\tilde{\kappa}^{\iota}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\Delta J^{f}\\
 & -\delta\tilde{c}^{\iota}\alpha_{f}\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\left(\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial J^{f}\partial\tilde{c}^{\gamma}}\right)\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\Delta J^{f}\\
 & +\alpha_{f}\delta\tilde{c}^{\iota}\nu^{\iota}\frac{\partial\hat{\zeta}}{\partial J^{f}}\Delta J^{f}-\alpha_{f}\grad\delta\tilde{c}^{\iota}\cdot\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}d_{0}^{\iota}\grad\tilde{c}^{\iota}+\sum_{\gamma}z^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}d_{0}^{\gamma}\grad\tilde{c}^{\gamma}\right)\Delta J^{f}dv\\
D\left(\delta W_{int}^{c}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\sum_{\iota}\int_{\Omega^{f}}-\delta\tilde{c}^{\iota}\alpha_{f}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}+\tilde{c}^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}+\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}\right)\Delta\tilde{c}^{\beta}+\grad\Delta\tilde{c}^{\beta}\cdot\mathbf{v}^{f}\right)\\
 & +\delta\tilde{c}^{\iota}\alpha_{f}\nu^{\iota}\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\beta}}\Delta\tilde{c}^{\beta}\\
 & -\alpha_{f}\grad\delta\tilde{c}^{\iota}\cdot\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}d_{0}^{\beta}\grad\Delta\tilde{c}^{\beta}+\Delta\tilde{c}^{\beta}\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}d_{0}^{\iota}+\tilde{\kappa}^{\iota}\frac{\partial d_{0}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\grad\tilde{c}^{\iota}\right)\\
 & -\alpha_{f}\grad\delta\tilde{c}^{\iota}\cdot\left(z^{\beta}\tilde{\kappa}^{\beta}d_{0}^{\beta}\grad\Delta\tilde{c}^{\beta}+\Delta\tilde{c}^{\beta}\sum_{\gamma}z^{\gamma}\left(\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}d_{0}^{\gamma}+\tilde{\kappa}^{\gamma}\frac{\partial d_{0}^{\gamma}}{\partial\tilde{c}^{\beta}}\right)\grad\tilde{c}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
Similarly, we can rewrite eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Ext-Virt-Work-CFDSol"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\[
\begin{aligned}\delta W_{ext}= & \int_{\Gamma^{f}}\delta\mathbf{v}^{f}\cdot\mathbf{t}^{\tau}da+\int_{\Gamma^{f}}\delta J^{f}v_{n}^{f}da+\int_{\Gamma^{f}}\delta\tilde{c}^{\iota}\tilde{j}_{n}^{\iota}da\\
 & +\delta G_{ext}^{v}+\delta G_{ext}^{c}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\delta G_{ext}^{v} & =\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(\rho^{f}\mathbf{b}^{f}+\sum_{\iota}M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)dv\\
\delta G_{ext}^{c} & =-\sum_{\iota}\int_{\Omega^{f}}\grad\delta\tilde{c}^{\iota}\cdot\left(\mathbf{j}_{b}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{b}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset

and we can linearize 
\begin_inset Formula $\delta G_{ext}^{v}$
\end_inset

 and 
\begin_inset Formula $\delta G_{ext}^{c}$
\end_inset

 as
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta G_{ext}^{v}\right)\left[\Delta\mathbf{v}^{f}\right] & =\mathbf{0}\\
D\left(\delta G_{ext}^{v}\right)\left[\Delta J^{f}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(-\frac{\rho^{f}}{J^{f}}\mathbf{b}^{f}+\sum_{\iota}M^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\tilde{c}^{\iota}\mathbf{b}^{\iota}\right)\Delta J^{f}dv\\
D\left(\delta G_{ext}^{v}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\alpha_{f}\int_{\Omega^{f}}\delta\mathbf{v}^{f}\cdot\left(M^{\beta}\tilde{\kappa}^{\beta}\mathbf{b}^{\beta}+\sum_{\gamma}M^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)\Delta\tilde{c}^{\beta}dv
\end{aligned}
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta G_{ext}^{c}\right)\left[\Delta\mathbf{v}^{f}\right] & =\mathbf{0}\\
D\left(\delta G_{ext}^{c}\right)\left[\Delta J^{f}\right] & =-\sum_{\iota}\alpha_{f}\int_{\Omega^{f}}\grad\delta\tilde{c}^{\iota}\cdot\left(s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\tilde{c}^{\iota}\mathbf{b}^{\iota}+\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)\Delta J^{f}dv\\
D\left(\delta G_{ext}^{c}\right)\left[\Delta\tilde{c}^{\beta}\right] & =-\sum_{\iota}\alpha_{f}\int_{\Omega^{f}}\grad\delta\tilde{c}^{\iota}\cdot\left(\left(\delta_{\iota\beta}+z^{\beta}\right)s^{\beta}\tilde{\kappa}^{\beta}\mathbf{b}^{\beta}+s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\iota}\mathbf{b}^{\iota}+\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)\Delta\tilde{c}^{\beta}\,dv
\end{aligned}
\]

\end_inset

under the assumption that 
\begin_inset Formula $D\mathbf{b}^{\alpha}\left[\Delta\mathbf{v}^{f}\right]=\mathbf{0}$
\end_inset


\end_layout

\begin_layout Subsection
Discretization for Fluid-Solutes
\end_layout

\begin_layout Standard
To evaluate the discretized form of the virtual work and its linearizations
 we use
\begin_inset Formula 
\[
\begin{aligned}\delta\mathbf{v}^{f} & =\sum_{a}N_{a}\delta\mathbf{v}_{a}^{f} & \Delta\mathbf{v}^{f} & =\sum_{b}N_{b}\Delta\mathbf{v}_{b}^{f}\\
\delta J^{f} & =\sum_{a}N_{a}\delta J_{a}^{f} & \Delta J^{f} & =\sum_{b}N_{b}\Delta J_{b}^{f}\\
\delta\tilde{c}^{\iota} & =\sum_{a}N_{a}\delta\tilde{c}_{a}^{\iota} & \Delta\tilde{c}^{\beta} & =\sum_{b}N_{b}\Delta\tilde{c}_{b}^{\beta}
\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $N_{a}$
\end_inset

 are shape functions.
 Then, the discretized form of the virtual work takes the form
\begin_inset Formula 
\[
\begin{aligned}\delta W_{int}^{v} & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\mathbf{f}_{a}^{v}\\
\delta W_{int}^{J} & =\sum_{a}\delta J_{a}^{f}f_{a}^{J}\\
\delta W_{int}^{c} & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}f_{a}^{\iota}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{f}_{a}^{v} & =\int_{\Omega^{f}}N_{a}\left(\grad\tilde{p}+\rho^{f}\mathbf{a}^{f}+\sum_{\iota}R\theta\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}\right)+\boldsymbol{\tau}\cdot\grad N_{a}dv\\
f_{a}^{J} & =\int_{\Omega^{f}}N_{a}\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\grad N_{a}\cdot\mathbf{v}^{f}dv\\
f_{a}^{\iota} & =\int_{\Omega^{f}}-N_{a}\left(\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}-\hat{c}^{\iota}\right)+\grad N_{a}\cdot\left(\mathbf{j}_{d}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{d}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt} & =\frac{c^{\iota}}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\tilde{\kappa}^{\iota}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\frac{D^{f}\tilde{\kappa}^{\iota}}{Dt}\end{aligned}
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}\delta G_{ext}^{v} & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\mathbf{b}_{a}^{v}\\
\delta G_{ext}^{c} & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}b_{a}^{\iota}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{b}_{a}^{v} & =\int_{\Omega^{f}}N_{a}\left(\rho^{f}\mathbf{b}^{f}+\sum_{\iota}M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)dv\\
b_{a}^{\iota} & =\int_{\Omega^{f}}N_{a}\divg\left(\mathbf{j}_{b}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{b}^{\gamma}\right)\,dv
\end{aligned}
\]

\end_inset

Note that
\begin_inset Formula 
\[
\begin{aligned}\frac{D^{f}J^{f}}{Dt} & =\frac{\partial J^{f}}{\partial t}+\grad J^{f}\cdot\mathbf{v}^{f}\\
\frac{D^{f}c^{\iota}}{Dt} & =\frac{\partial c^{\iota}}{\partial t}+\grad c^{\iota}\cdot\mathbf{v}^{f}\\
 & =\tilde{\kappa}^{\iota}\frac{\partial\tilde{c}^{\iota}}{\partial t}+\tilde{c}^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial t}+\left(\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}+\tilde{c}^{\iota}\grad\tilde{\kappa}^{\iota}\right)\cdot\mathbf{v}^{f}\\
\frac{D^{f}\tilde{\kappa}^{\iota}}{Dt} & =\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\frac{D^{f}J^{f}}{Dt}+\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\frac{D\tilde{c}^{\gamma}}{Dt}\\
\grad\tilde{\kappa}^{\iota} & =\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\grad J+\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}\grad\tilde{c}^{\gamma}\\
\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt} & =c^{\iota}\frac{D^{f}J^{f}}{Dt}+J^{f}\frac{D^{f}c^{\iota}}{Dt}
\end{aligned}
\]

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{int}^{v}$
\end_inset

 gets discretized into
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{v}\right)\left[\Delta\mathbf{v}^{f}\right] & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\sum_{b}\alpha_{f}\mathbf{K}_{ab}^{vv}\cdot\Delta\mathbf{v}_{b}^{f}\\
D\left(\delta W_{int}^{v}\right)\left[\Delta J^{f}\right] & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\sum_{b}\alpha_{f}\mathbf{k}_{ab}^{vJ}\Delta J_{b}^{f}\\
D\left(\delta W_{int}^{v}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\sum_{b}\alpha_{f}\mathbf{k}_{ab}^{v\beta}\Delta\tilde{c}_{b}^{\beta}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{K}_{ab}^{vv} & =\int_{\Omega^{f}}\grad N_{a}\cdot\boldsymbol{\mathcal{C}}^{\tau}\cdot\grad N_{b}dv\\
 & +\int_{\Omega^{f}}N_{a}\rho^{f}\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{N_{b}}{\Delta t}+\grad N_{b}\cdot\mathbf{v}^{f}\right)\mathbf{I}+N_{b}\mathbf{L}^{f}\right)dv\\
\mathbf{k}_{ab}^{vJ} & =\int_{\Omega^{f}}N_{a}\left(\tilde{p}_{J}^{\prime}\grad N_{b}+N_{b}\left(\tilde{p}_{J}^{\prime\prime}\grad J^{f}+R\theta\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}\grad\tilde{c}^{\gamma}\right)\right)dv\\
 & +\int_{\Omega^{f}}N_{b}\boldsymbol{\tau}_{J}^{\prime}\cdot\grad N_{a}dv-\alpha_{f}\int_{\Omega^{f}}N_{a}N_{b}\frac{\rho^{f}}{J^{f}}\mathbf{a}^{f}dv\\
\mathbf{k}_{ab}^{v\beta} & =\int_{\Omega^{f}}N_{a}R\theta\left(\tilde{\kappa}^{\beta}\grad N_{b}+N_{b}\sum_{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\grad\tilde{c}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{int}^{J}$
\end_inset

 gets discretized into
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{J}\right)\left[\Delta\mathbf{v}^{f}\right] & =\sum_{a}\delta J_{a}^{f}\sum_{b}\alpha_{f}\mathbf{k}_{ab}^{Jv}\cdot\Delta\mathbf{v}_{b}^{f}\\
D\left(\delta W_{int}^{J}\right)\left[\Delta J^{f}\right] & =\sum_{a}\delta J_{a}^{f}\sum_{b}\alpha_{f}k_{ab}^{JJ}\Delta J_{b}^{f}\\
D\left(\delta W_{int}^{J}\right)\left[\Delta\tilde{c}^{\beta}\right] & =0
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{k}_{ab}^{Jv} & =\int_{\Omega^{f}}N_{b}\left(N_{a}\frac{1}{J^{f}}\grad J^{f}+\grad N_{a}\right)dv\\
k_{ab}^{JJ} & =\int_{\Omega^{f}}\frac{N_{a}}{J^{f}}\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}-\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}\right)N_{b}+\grad N_{b}\cdot\mathbf{v}^{f}\right)dv
\end{aligned}
\]

\end_inset

Finally, the linearization of 
\begin_inset Formula $\delta W_{int}^{c}$
\end_inset

 gets discretized into
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta W_{int}^{c}\right)\left[\Delta\mathbf{v}^{f}\right] & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}\sum_{b}\alpha_{f}\mathbf{k}_{ab}^{\iota v}\cdot\Delta\mathbf{v}_{b}^{f}\\
D\left(\delta W_{int}^{c}\right)\left[\Delta J^{f}\right] & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}\sum_{b}\alpha_{f}k_{ab}^{\iota J}\Delta J_{b}^{f}\\
D\left(\delta W_{int}^{c}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}\sum_{b}\alpha_{f}k^{\iota\beta}\,\Delta\tilde{c}_{b}^{\beta}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{k}_{ab}^{\iota v} & =-\int_{\Omega^{f}}N_{a}N_{b}\frac{1}{J^{f}}\grad\left(J^{f}c^{\iota}\right)\,dv\\
k_{ab}^{\iota J} & =\int_{\Omega^{f}}N_{a}N_{b}\frac{1}{\left(J^{f}\right)^{2}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt}\\
 & -N_{a}\tilde{c}^{\iota}\left(\frac{\tilde{\kappa}^{\iota}}{J^{f}}+\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\right)\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{N_{b}}{\Delta t}+\grad N_{b}\cdot\mathbf{v}^{f}\right)\\
 & -N_{a}N_{b}\frac{\tilde{c}^{\iota}}{J^{f}}\frac{D^{f}J^{f}}{Dt}\left(2\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}+J^{f}\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial\left(J^{f}\right)^{2}}\right)\\
 & -N_{a}N_{b}\left(\left(\frac{\tilde{\kappa}^{\iota}}{J^{f}}+\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\right)\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\sum_{\gamma}\left(\frac{1}{J^{f}}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\gamma}}+\frac{\partial^{2}\tilde{\kappa}^{\iota}}{\partial J^{f}\partial\tilde{c}^{\gamma}}\right)\frac{D^{f}\tilde{c}^{\gamma}}{Dt}\right)\\
 & +N_{a}N_{b}\nu^{\iota}\underbrace{\frac{\partial\hat{\zeta}}{\partial J^{f}}}_{=0\text{ currently}}-N_{b}\grad N_{a}\cdot\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}d_{0}^{\iota}\grad\tilde{c}^{\iota}+\sum_{\gamma}z^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}d_{0}^{\gamma}\grad\tilde{c}^{\gamma}\right)dv\\
k^{\iota\beta} & =\int_{\Omega^{f}}-N_{a}\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}+\tilde{c}^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\left(\left(\frac{\alpha_{m}}{\alpha_{f}\gamma}\frac{1}{\Delta t}+\frac{1}{J^{f}}\frac{D^{f}J^{f}}{Dt}\right)N_{b}+\grad N_{b}\cdot\mathbf{v}^{f}\right)\\
 & +N_{a}N_{b}\nu^{\iota}\frac{\partial\hat{\zeta}}{\partial\tilde{c}^{\beta}}\\
 & -\grad N_{a}\cdot\left(\delta_{\iota\beta}\tilde{\kappa}^{\beta}d_{0}^{\beta}\grad N_{b}+N_{b}\left(\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}d_{0}^{\iota}+\tilde{\kappa}^{\iota}\frac{\partial d_{0}^{\iota}}{\partial\tilde{c}^{\beta}}\right)\grad\tilde{c}^{\iota}\right)\\
 & -\grad N_{a}\cdot\left(z^{\beta}\tilde{\kappa}^{\beta}d_{0}^{\beta}\grad N_{b}+N_{b}\sum_{\gamma}z^{\gamma}\left(\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}d_{0}^{\gamma}+\tilde{\kappa}^{\gamma}\frac{\partial d_{0}^{\gamma}}{\partial\tilde{c}^{\beta}}\right)\grad\tilde{c}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset


\begin_inset Formula 
\[
\begin{aligned}\frac{1}{J^{f}}\grad\left(J^{f}c^{\iota}\right) & =\frac{1}{J^{f}}c^{\iota}\grad J^{f}+\tilde{\kappa}^{\iota}\grad\tilde{c}^{\iota}+\tilde{c}^{\iota}\grad\tilde{\kappa}^{\iota}\\
\frac{1}{J^{f}}\frac{D^{f}\left(J^{f}c^{\iota}\right)}{Dt} & =\frac{c^{\iota}}{J^{f}}\frac{D^{f}J^{f}}{Dt}+\tilde{\kappa}^{\iota}\frac{D^{f}\tilde{c}^{\iota}}{Dt}+\tilde{c}^{\iota}\frac{D^{f}\tilde{\kappa}^{\iota}}{Dt}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
For the external work contributions from body forces, the discretized forms
 are
\begin_inset Formula 
\[
\begin{aligned}\delta G_{ext}^{v} & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\mathbf{b}_{a}^{v}\\
\delta G_{ext}^{c} & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}b_{a}^{\iota}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{b}_{a}^{v} & =\int_{\Omega^{f}}N_{a}\left(\rho^{f}\mathbf{b}^{f}+\sum_{\iota}M^{\iota}c^{\iota}\mathbf{b}^{\iota}\right)dv\\
b_{a}^{\iota} & =-\int_{\Omega^{f}}\grad N_{a}\cdot\left(\mathbf{j}_{b}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}_{b}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset

and 
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta G_{ext}^{v}\right)\left[\Delta\mathbf{v}^{f}\right] & =\mathbf{0}\\
D\left(\delta G_{ext}^{v}\right)\left[\Delta J^{f}\right] & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\sum_{b}\alpha_{f}\mathbf{b}_{ab}^{vJ}\Delta J_{b}^{f}\\
D\left(\delta G_{ext}^{v}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\sum_{a}\delta\mathbf{v}_{a}^{f}\cdot\sum_{b}\alpha_{f}\mathbf{b}_{ab}^{v\beta}\Delta\tilde{c}_{b}^{\beta}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}\mathbf{b}_{ab}^{vJ} & =\int_{\Omega^{f}}N_{a}N_{b}\left(-\frac{\rho^{f}}{J^{f}}\mathbf{b}^{f}+\sum_{\gamma}M^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}\tilde{c}^{\iota}\mathbf{b}^{\gamma}\right)dv\\
\mathbf{b}_{ab}^{v\beta} & =\int_{\Omega^{f}}N_{a}N_{b}\left(M^{\beta}\tilde{\kappa}^{\beta}\mathbf{b}^{\beta}+\sum_{\gamma}M^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)dv
\end{aligned}
\]

\end_inset

Similarly,
\begin_inset Formula 
\[
\begin{aligned}D\left(\delta G_{ext}^{c}\right)\left[\Delta\mathbf{v}^{f}\right] & =\mathbf{0}\\
D\left(\delta G_{ext}^{c}\right)\left[\Delta J^{f}\right] & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}\sum_{b}\alpha_{f}b_{ab}^{\iota J}\Delta J_{b}^{f}\\
D\left(\delta G_{ext}^{c}\right)\left[\Delta\tilde{c}^{\beta}\right] & =\sum_{\iota}\sum_{a}\delta\tilde{c}_{a}^{\iota}\sum_{b}\alpha_{f}b_{ab}^{\iota\beta}\Delta\tilde{c}_{b}^{\beta}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}b_{ab}^{\iota J} & =-\int_{\Omega^{f}}N_{b}\grad N_{a}\cdot\left(s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\tilde{c}^{\iota}\mathbf{b}^{\iota}+\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)dv\\
b_{ab}^{\iota\beta} & =-\int_{\Omega^{f}}N_{b}\grad N_{a}\cdot\left(\left(\delta_{\iota\beta}+z^{\beta}\right)s^{\beta}\tilde{\kappa}^{\beta}\mathbf{b}^{\beta}+s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\iota}\mathbf{b}^{\iota}+\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\gamma}\mathbf{b}^{\gamma}\right)\,dv
\end{aligned}
\]

\end_inset

In the special case when the body force acting on each constituent is the
 same, 
\begin_inset Formula $\mathbf{b}^{f}=\mathbf{b}^{\iota}\equiv\mathbf{b}$
\end_inset

, these expressions simplify further,
\begin_inset Formula 
\[
\begin{aligned}b_{ab}^{\iota J} & =-\int_{\Omega^{f}}N_{b}\left(w^{\iota J}+w_{e}^{cJ}\right)\grad N_{a}\cdot\mathbf{b}dv\\
b_{ab}^{\iota\beta} & =-\int_{\Omega^{f}}N_{b}\left(\left(\delta_{\iota\beta}+z^{\beta}\right)s^{\beta}\tilde{\kappa}^{\beta}+w^{\iota\beta}+w_{e}^{c\beta}\right)\grad N_{a}\cdot\mathbf{b}\,dv
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}w^{\iota J} & \equiv s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial J^{f}}\tilde{c}^{\iota} & w_{e}^{cJ} & \equiv\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial J^{f}}\tilde{c}^{\gamma}\\
w^{\iota\beta} & \equiv s^{\iota}\frac{\partial\tilde{\kappa}^{\iota}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\iota} & w_{e}^{c\beta} & \equiv\sum_{\gamma}z^{\gamma}s^{\gamma}\frac{\partial\tilde{\kappa}^{\gamma}}{\partial\tilde{c}^{\beta}}\tilde{c}^{\gamma}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Section
Newton-Raphson Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Newton-Raphson-Method"

\end_inset


\end_layout

\begin_layout Standard
The Newton-Raphson method (also known as 
\begin_inset Quotes eld
\end_inset

Newton's method
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Full Newton method
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

the Newton method
\begin_inset Quotes erd
\end_inset

) is the basis for solving the nonlinear finite element equations.
 This section will describe the 
\emph on
Full Newton method
\emph default
 and the Broyden-Fletcher-Goldfarb-Shanno (BFGS) method 
\begin_inset CommandInset citation
LatexCommand citep
key "Matthies79"
literal "true"

\end_inset

.
 The latter variation is actually a 
\emph on
quasi-Newton method
\emph default
.
 It is important since it provides several advantages over the full Newton
 method and it is this method that is implemented in FEBio 
\begin_inset CommandInset citation
LatexCommand citep
key "Matthies79"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Full Newton Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Full-Newton-Method"

\end_inset


\end_layout

\begin_layout Standard
The Newton-Raphson equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq173"

\end_inset

 can be written in terms of the discretized equilibrium equations that were
 derived in the previous section as follows: 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{v}^{T}\cdot\mathbf{K}\cdot\mathbf{u}=-\delta\mathbf{v}^{T}\cdot\mathbf{R}.\label{eq355}
\end{equation}

\end_inset

Since the virtual velocities 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

are arbitrary, a discretized Newton-Raphson scheme can be formulated as
 follows: 
\begin_inset Formula 
\begin{equation}
\begin{array}{cc}
\mathbf{K}\left(\mathbf{x}_{k}\right)\cdot\mathbf{u}=-\mathbf{R}\left(\mathbf{x}_{k}\right); & \mathbf{x}_{k+1}=\mathbf{x}_{k}+\mathbf{u}\end{array}.\label{eq356}
\end{equation}

\end_inset

This is the basis of the Newton-Raphson method.
 For each iteration 
\begin_inset Formula $k$
\end_inset

, both the stiffness matrix and the residual vector are re-evaluated and
 a displacement increment 
\series bold
u 
\series default
is calculated by pre-multiplying both sides of the above equation by 
\begin_inset Formula $\mathbf{K}^{-1}$
\end_inset

.
 This procedure is repeated until some convergence criteria are satisfied.
\end_layout

\begin_layout Standard
The formation of the stiffness matrix and, especially, calculation of its
 inverse, are computationally expensive.
 Quasi-Newton methods do not require the reevaluation of the stiffness matrix
 for every iteration.
 Instead, a quick update is calculated.
 One particular method that has been quite successful in the field of computatio
nal solid mechanics is the BFGS method, which is described in the next section.
\end_layout

\begin_layout Subsection
BFGS Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:BFGS-Method"

\end_inset


\end_layout

\begin_layout Standard
The BFGS method updates the stiffness matrix (or rather its inverse) to
 provide an approximation to the exact matrix.
 A displacement increment is defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{k}=\mathbf{x}_{k}-\mathbf{x}_{k-1}\,,\label{eq357}
\end{equation}

\end_inset

and an increment in the residual is defined as 
\begin_inset Formula 
\begin{equation}
\mathbf{G}_{k}=\mathbf{R}_{k-1}-\mathbf{R}_{k}\,.\label{eq358}
\end{equation}

\end_inset

The updated matrix 
\begin_inset Formula $\mathbf{K}_{k}$
\end_inset

 should satisfy the quasi-Newton equation: 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{k}\mathbf{d}_{k}=\mathbf{G}_{k}\,.\label{eq359}
\end{equation}

\end_inset

In order to calculate this update, as displacement increment is first calculated
: 
\begin_inset Formula 
\begin{equation}
\mathbf{u}=\mathbf{K}_{k-1}^{-1}\mathbf{R}_{k-1}\,.\label{eq360}
\end{equation}

\end_inset

This displacement vector defines a 
\begin_inset Quotes eld
\end_inset

direction
\begin_inset Quotes erd
\end_inset

 for the actual displacement increment.
 A line search (see next section) can now be applied to determine the optimal
 displacement increment: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{k}=\mathbf{x}_{k-1}+s\mathbf{u}\,,\label{eq361}
\end{equation}

\end_inset

where 
\begin_inset Formula $s$
\end_inset

is determined from the line search.
 With the updated position calculated, 
\begin_inset Formula $\mathbf{R}_{k}$
\end_inset

can be evaluated.
 Also, using equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq357"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq358"

\end_inset

, 
\begin_inset Formula $\mathbf{d}_{k}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G}_{k}$
\end_inset

 can be evaluted.
 The stiffness update can now be expressed as 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{k}^{-1}=\mathbf{A}_{k}^{T}\mathbf{K}_{k-1}^{-1}\mathbf{A}_{k}\,,\label{eq362}
\end{equation}

\end_inset

where the matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is an 
\begin_inset Formula $n\times n$
\end_inset

 matrix of the simple form: 
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{k}=\mathbf{1}+\mathbf{v}_{k}\mathbf{w}_{k}^{T}\,.\label{eq363}
\end{equation}

\end_inset

The vectors 
\series bold

\begin_inset Formula $\mathbf{v}$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $\mathbf{w}$
\end_inset


\series default
 are given by 
\begin_inset Formula 
\begin{equation}
\mathbf{v}_{k}=-\left(\frac{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}{\mathbf{d}_{k}^{T}\mathbf{K}_{k-1}\mathbf{d}_{k}}\right)^{1/2}\mathbf{K}_{k-1}\mathbf{d}_{k}-\mathbf{G}_{k}\,,\label{eq364}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{w}_{k}=\frac{\mathbf{d}_{k}}{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}\,.\label{eq365}
\end{equation}

\end_inset

The vector 
\begin_inset Formula $\mathbf{K}_{k-1}\mathbf{d}_{k}$
\end_inset

 is equal to 
\begin_inset Formula $s\mathbf{R}_{k-1}$
\end_inset

 and has already been calculated.
\end_layout

\begin_layout Standard
To avoid numerically dangerous updates, the condition number 
\begin_inset Formula $c$
\end_inset

 of the updating matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is calculated:
\begin_inset Formula 
\begin{equation}
c=\left(\frac{\mathbf{d}_{k}^{T}\mathbf{G}_{k}}{\mathbf{d}_{k}^{T}\mathbf{K}_{k-1}\mathbf{d}_{k}}\right)^{1/2}\,.\label{eq365b}
\end{equation}

\end_inset

The update is not performed when this number exceeds a preset tolerance.
\end_layout

\begin_layout Standard
Considering the actual computations involved, it should be noted that using
 the matrix updates defined above, the calculation of the search direction
 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq360"

\end_inset

 can be rewritten as, 
\begin_inset Formula 
\begin{equation}
\mathbf{u}=\left(\mathbf{1}+\mathbf{w}_{k-1}\mathbf{v}_{k-1}^{T}\right)\cdots\left(\mathbf{1}+\mathbf{w}_{1}\mathbf{v}_{1}^{T}\right)\mathbf{K}_{0}^{-1}\left(\mathbf{1}+\mathbf{v}_{1}\mathbf{w}_{1}^{T}\right)\cdots\left(\mathbf{1}+\mathbf{v}_{k-1}\mathbf{w}_{k-1}^{T}\right)\mathbf{R}_{k-1}\,.\label{eq366}
\end{equation}

\end_inset

Hence, the search direction can be computed without explicitly calculating
 the updated matrices or performing any additional costly matrix factorizations
 as required in the full Newton-Raphson method.
\end_layout

\begin_layout Subsection
Line Search Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Line-Search-Method"

\end_inset


\end_layout

\begin_layout Standard
A powerful technique often used to improve the convergence rate of Newton
 based methods is the 
\emph on
line search method
\emph default
.
 In this method, the direction of the displacement vector 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset

 
\series default
is considered as optimal, but the magnitude is controlled by a parameter
 
\begin_inset Formula $s$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{k+1}=\mathbf{x}_{k}+s\mathbf{u}\,.\label{eq367}
\end{equation}

\end_inset

The value of 
\begin_inset Formula $s$
\end_inset

is usually chosen so that the total potential energy 
\begin_inset Formula $W\left(s\right)=W\left(\mathbf{x}_{k}+s\mathbf{u}\right)$
\end_inset

at the end of the iteration is minimized in the direction of 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset


\series default
.
 This is equivalent to the requirement that the residual force 
\begin_inset Formula $\mathbf{R}\left(\mathbf{x}_{k}+s\mathbf{u}\right)$
\end_inset

at the end of the iteration is orthogonal to 
\series bold

\begin_inset Formula $\mathbf{u}$
\end_inset


\series default
: 
\begin_inset Formula 
\begin{equation}
R\left(s\right)=\mathbf{u}^{T}\mathbf{R}\left(\mathbf{x}_{k}+s\mathbf{u}\right)=0\,.\label{eq368}
\end{equation}

\end_inset

However, in practice it is sufficient to obtain a value of 
\begin_inset Formula $s$
\end_inset

such that, 
\begin_inset Formula 
\begin{equation}
\left|R\left(s\right)\right|<\rho\left|R\left(0\right)\right|\,,\label{eq369}
\end{equation}

\end_inset

where typically a value of 
\begin_inset Formula $\rho=0.9$
\end_inset

 is used.
 Under normal conditions the value 
\begin_inset Formula $s=1$
\end_inset

 automatically satisfies equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq369"

\end_inset

 and therefore few extra operations are involved.
 However, when this is not the case, a more suitable value for 
\begin_inset Formula $s$
\end_inset

needs to be obtained.
 For this reason it is convenient to approximate 
\begin_inset Formula $R\left(s\right)$
\end_inset

as a quadratic in 
\begin_inset Formula $s$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
R\left(s\right)\approx\left(1-s\right)R\left(0\right)+R\left(1\right)s^{2}=0\,,\label{eq370}
\end{equation}

\end_inset

which yields a value for 
\begin_inset Formula $s$
\end_inset

as 
\begin_inset Formula 
\begin{equation}
s=\frac{r}{2}\pm\sqrt{\left(\frac{r}{2}\right)^{2}-r}\,,\quad r=\frac{R\left(0\right)}{R\left(1\right)}\,.\label{eq371}
\end{equation}

\end_inset

If 
\begin_inset Formula $r<0$
\end_inset

, the square root is positive and a first improved value for 
\begin_inset Formula $s$
\end_inset

is obtained: 
\begin_inset Formula 
\begin{equation}
s_{1}=\frac{r}{2}+\sqrt{\left(\frac{r}{2}\right)^{2}-r}\,.\label{eq372}
\end{equation}

\end_inset

If 
\begin_inset Formula $r>0$
\end_inset

 the 
\begin_inset Formula $s$
\end_inset

can be obtained by using the value that minimizes the quadratic function,
 that is, 
\begin_inset Formula $s_{1}=r/2$
\end_inset

.
 This procedure is now repeated with 
\begin_inset Formula $R\left(1\right)$
\end_inset

 replaced by 
\begin_inset Formula $R\left(s_{1}\right)$
\end_inset

 until equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq369"

\end_inset

 is satisfied.
\end_layout

\begin_layout Subsection
Conjugate gradient solution method
\end_layout

\begin_layout Standard
The Newton-Raphson solution algorithms are highly effective for nearly linear
 problems, but they have two major limitations.
 Firstly, for very large models, the size of the stiffness matrix K can
 grow very large as well.
 The factorization of this matrix, which is needed when using direct linear
 solvers, can become very time consuming and requires a large amount of
 memory.
 This is the main factor that limits the size of model that can be solved
 on a given computer.
 Secondly, where the stiffness is small, it can overestimate the displacement,
 resulting in excessive distortion of the mesh and the familiar negative
 Jacobian failure.
 This can occur when a material has a low initial stiffness that increases
 at higher strains (we work around this by using a large number of small
 timesteps to reduce the nonlinearity on each increment), when buckling
 causes a temporary low or negative stiffness, when a part of the model
 is not sufficiently constrained, or when contacts cause sudden changes
 of stiffness.
 For these reasons the Newton-Raphson algorithms often fail to converge
 for very nonlinear materials, models with contacts or unstable structures
 that can buckle or crumple under load.
\end_layout

\begin_layout Standard
An alternative strategy is to estimate a direction to move each node directly
 from the residual R:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u=-}\boldsymbol{R\left(x_{k}\right)}
\]

\end_inset


\end_layout

\begin_layout Standard
Then a line search is needed to find the appropriate distance to move in
 that direction.
 This is the steepest descent method, which has the disadvantage that it
 converges slowly in a series of decreasing zig-zag steps.
 Its convergence is much improved by adding a fraction β of the previous
 step:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}_{k}=-\boldsymbol{R}\left(\boldsymbol{x}_{k}\right)+\beta\boldsymbol{u}_{k-1}
\]

\end_inset


\end_layout

\begin_layout Standard
There are many different ways to calculate β; one method which has excellent
 convergence for nonlinear problems is due to Hager and Zhang:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{y}_{i}=\boldsymbol{R}_{i-1}-\boldsymbol{R}_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\beta_{i}=\frac{-1}{\boldsymbol{u}_{i-1}\cdot\boldsymbol{y}_{i}}\left(\boldsymbol{y}_{i}-2\boldsymbol{u}_{i-1}\frac{\left\Vert \boldsymbol{y}_{i}\right\Vert ^{2}}{\boldsymbol{u}_{i-1}\cdot\boldsymbol{y}_{i}}\right)\cdot\boldsymbol{R}_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\eta_{i}=\frac{-1}{\left\Vert \boldsymbol{u}_{i-1}\right\Vert min\left\{ \eta,\left\Vert \boldsymbol{R}_{i-1}\right\Vert \right\} }
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\beta_{i}=max\left\{ \beta_{i},\eta_{i}\right\} 
\]

\end_inset


\end_layout

\begin_layout Standard
A limitation of this method is that the distance each node moves is proportional
 to the residual; stiffer nodes produce a larger residual for a given displaceme
nt and therefore move further, whereas in fact they need to move less than
 more compliant nodes.
 This results in mesh distortion where the element size varies, for midside
 nodes in quadratic elements or for mixed materials.
 This problem can be reduced by using a preconditioner, dividing the residual
 at each node by an estimate of its stiffness.
 This requires changes also to the calculation of β:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\beta_{i}=\frac{-1}{\boldsymbol{u}_{i-1}\cdot\boldsymbol{y}_{i}}\left(\boldsymbol{y_{i}^{T}P}-2\boldsymbol{u}_{i-1}\frac{\boldsymbol{y_{i}^{T}Py}_{i}}{\boldsymbol{u}_{i-1}\cdot\boldsymbol{y}_{i}}\right)\cdot\boldsymbol{R}_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\eta_{i}=0.4\frac{\Delta\boldsymbol{u}_{i-1}^{T}\boldsymbol{R}_{i}}{\boldsymbol{u_{i-1}^{T}P^{-1}u_{i-1}}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\beta_{i}=max\left\{ \beta_{i},\eta_{i}\right\} 
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}_{i+1}=\boldsymbol{P}\boldsymbol{R}_{i}+\beta_{i}\boldsymbol{u}_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
The preconditioner 
\series bold
P
\series default
 can be found in various ways; a convenient approximation is to use the
 reciprocal of the main diagonal of the stiffness matrix:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{P}^{-1}=diag\left(\boldsymbol{K}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
This is calculated once at the beginning of the solution.
\end_layout

\begin_layout Section
Generalized 
\begin_inset Formula $\alpha-$
\end_inset

Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Generalized-Alpha-Method"

\end_inset


\end_layout

\begin_layout Standard
The generalized 
\begin_inset Formula $\alpha-$
\end_inset

method is used for temporal discretization of governing equations in fluid
 mechanics.
 For this method we combine the degrees of freedom into 
\begin_inset Formula $\mathbf{Y}_{n}=\left\{ \mathbf{v},J\right\} _{n}$
\end_inset

, where the subscript 
\begin_inset Formula $n$
\end_inset

 denotes time 
\begin_inset Formula $t_{n}$
\end_inset

; similarly, we let 
\begin_inset Formula $\dot{\mathbf{Y}}_{n}=\left\{ \frac{\partial\mathbf{v}}{\partial t},\frac{\partial J}{\partial t}\right\} _{n}$
\end_inset

.
 According to this method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

, the virtual work is evaluated at 
\begin_inset Formula $\delta W\left(\dot{\mathbf{Y}}_{n+\alpha_{m}},\mathbf{Y}_{n+\alpha_{f}}\right)$
\end_inset

, where 
\begin_inset Formula $t_{n+\alpha}=t_{n}+\alpha\Delta t$
\end_inset

 and 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

.
 Here,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{Y}_{n+\alpha_{f}} & =\alpha_{f}\mathbf{Y}_{n+1}+\left(1-\alpha_{f}\right)\mathbf{Y}_{n}\\
\dot{\mathbf{Y}}_{n+\alpha_{m}} & =\alpha_{m}\dot{\mathbf{Y}}_{n+1}+\left(1-\alpha_{m}\right)\dot{\mathbf{Y}}_{n}
\end{aligned}
\,.\label{eq:ga-Y-Ydot}
\end{equation}

\end_inset

The parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from a single parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 using
\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{1}{2}\frac{3-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas}
\end{equation}

\end_inset

where 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

.
 This parameter is the spectral radius for an infinite time step, which
 controls the amount of damping of high frequencies; a value of zero produces
 the greatest amount of damping, anihilating the highest frequency in one
 step, whereas a value of one preserves the highest frequency.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\delta W\left(\dot{\mathbf{Y}}_{n+\alpha_{m}},\mathbf{Y}_{n+\alpha_{f}}\right)$
\end_inset

 reported in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CFD-Discretization-Linearization"

\end_inset

 is effectively performed along an increment 
\begin_inset Formula $\Delta\mathbf{Y}$
\end_inset

 of 
\begin_inset Formula $\mathbf{Y}_{n+1}$
\end_inset

 so that the solution to 
\begin_inset Formula $\delta W=0$
\end_inset

 produces 
\begin_inset Formula $\mathbf{Y}_{n+1}$
\end_inset

.
 Based on Newmark integration, we have
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{Y}}_{n+1}=\frac{\mathbf{Y}_{n+1}-\mathbf{Y}_{n}}{\gamma\Delta t}-\left(\frac{1}{\gamma}-1\right)\dot{\mathbf{Y}}_{n}\,.\label{eq:ga-Newmark-integration}
\end{equation}

\end_inset

where, according to the generalized 
\begin_inset Formula $\alpha-$
\end_inset

method,
\begin_inset Formula 
\begin{equation}
\gamma=\frac{1}{2}+\alpha_{m}-\alpha_{f}\,.\label{eq:ga-ksi-gamma}
\end{equation}

\end_inset

Therefore, in this scheme, 
\begin_inset Formula $\dot{\mathbf{Y}}_{n+\alpha_{m}}$
\end_inset

 is evaluated from
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{Y}}_{n+\alpha_{m}}=\left(1-\frac{\alpha_{m}}{\gamma}\right)\dot{\mathbf{Y}}_{n}+\frac{\xi}{\Delta t}\left(\mathbf{Y}_{n+\alpha_{f}}-\mathbf{Y}_{n}\right)\,,\quad\xi\equiv\frac{\alpha_{m}}{\alpha_{f}\gamma}.\label{eq:ga-Ydot-evaluation}
\end{equation}

\end_inset

Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ga-Y-Ydot"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ga-Ydot-evaluation"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we find that
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{Y}_{n+\alpha_{f}}\left[\Delta\mathbf{Y}\right] & =\alpha_{f}\Delta\mathbf{Y}\\
D\dot{\mathbf{Y}}_{n+\alpha_{m}}\left[\Delta\mathbf{Y}\right] & =\frac{\alpha_{m}}{\gamma}\frac{\Delta\mathbf{Y}}{\Delta t}
\end{aligned}
\label{eq:ga-Y-Ydot-linearization}
\end{equation}

\end_inset

Given the solution 
\begin_inset Formula $\left(\dot{\mathbf{Y}}_{n+\alpha_{m}},\mathbf{Y}_{n+\alpha_{f}}\right)$
\end_inset

, the solution at 
\begin_inset Formula $t_{n+1}$
\end_inset

 is evaluated from
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{Y}_{n+1} & =\mathbf{Y}_{n}+\frac{\mathbf{Y}_{n+\alpha_{f}}-\mathbf{Y}_{n}}{\alpha_{f}}\,,\\
\dot{\mathbf{Y}}_{n+1} & =\dot{\mathbf{Y}}_{n}+\frac{\dot{\mathbf{Y}}_{n+\alpha_{m}}-\dot{\mathbf{Y}}_{n}}{\alpha_{m}}\,.
\end{aligned}
\label{eq:ga-Y-updates}
\end{equation}

\end_inset

Four different options are presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

 for initializing 
\begin_inset Formula $\mathbf{Y}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\dot{\mathbf{Y}}_{n+1}$
\end_inset

 at the beginning of time step 
\begin_inset Formula $t_{n+1}$
\end_inset

; the first three of these have been implemented in FEBio.
 For steady flows these authors recommend disregarding 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 and setting 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\gamma=1$
\end_inset

 to recover the backward Euler scheme.
\end_layout

\begin_layout Chapter
Element Library
\begin_inset CommandInset label
LatexCommand label
name "chap:Element-Library"

\end_inset


\end_layout

\begin_layout Standard
FEBio provides several element types for finite element discretization.
 This chapter describes these elements in more detail.
\end_layout

\begin_layout Section
Solid Elements
\begin_inset CommandInset label
LatexCommand label
name "sec:Solid-elements"

\end_inset


\end_layout

\begin_layout Standard
The 3D solid elements available in FEBio are 
\emph on
isoparametric elements
\emph default
.
 All of the solid elements are formulated in a global Cartesian coordinate
 system.
 For all these elements, a local coordinate system (so-called 
\emph on
isoparametric coordinates
\emph default
) is defined as well.
 The global position vector 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
 can be written as a function of the isoparametric coordinates in the following
 sense: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(r,s,t\right)=\sum\limits _{i=1}^{n}N_{i}\left(r,s,t\right)\mathbf{x}_{i}.\label{eq373}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $n$
\end_inset

 is the number of nodes, 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 are the isoparametric coordinates, 
\begin_inset Formula $N_{i}$
\end_inset

 are the element shape functions and 
\begin_inset Formula $\mathbf{x}_{i}$
\end_inset

 are the spatial coordinates of the element nodes.
 The same parametric interpolation is used for the interpolation of other
 scalar and vector quantities.
\end_layout

\begin_layout Standard
All elements in FEBio are integrated numerically.
 This implies that integrals over the volume of the element 
\begin_inset Formula $v^{e}$
\end_inset

 are approximated by a sum: 
\begin_inset Formula 
\begin{equation}
\int\limits _{v^{e}}f\left(\mathbf{x}\right)\,dv=\int\limits _{\Square^{e}}f\left({\mathbf{r}}\right)J(\mathbf{r})d\Square\,\cong\sum\limits _{i=1}^{m}f\left(\mathbf{r}_{i}\right)J_{i}w_{i}\,.\label{eq374}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\Square$
\end_inset

 is the biunit cube, 
\begin_inset Formula $m$
\end_inset

 is the number of integration points, 
\begin_inset Formula $\mathbf{r}_{i}$
\end_inset

are the location of the integration points in isoparametric coordinates,
 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the transformation 
\begin_inset Formula $\mathbf{x}=\mathbf{x}\left(r,s,t\right)$
\end_inset

, and 
\begin_inset Formula $w_{i}$
\end_inset

 is a weight associated with the integration point.
 The integration is performed over the element's volume in the natural coordinat
e system.
\end_layout

\begin_layout Standard
Most fully integrated solid elements are unsuitable for the analysis of
 (nearly-) incompressible material behavior.
 To deal with this type of deformation, a three-field element implementation
 is available in FEBio 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Hexahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Hexahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
FEBio implements an 8-node trilinear hexahedral element.
 This element is also known as a 
\emph on
brick 
\emph default
element.
 The shape functions for these elements are defined in function of the isoparame
tric coordinates 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t,$
\end_inset

 and are given below.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =\frac{1}{8}\left(1-r\right)\left(1-s\right)\left(1-t\right)\\
N_{2} & =\frac{1}{8}\left(1+r\right)\left(1-s\right)\left(1-t\right)\\
N_{3} & =\frac{1}{8}\left(1+r\right)\left(1+s\right)\left(1-t\right)\\
N_{4} & =\frac{1}{8}\left(1-r\right)\left(1+s\right)\left(1-t\right)\\
N_{5} & =\frac{1}{8}\left(1-r\right)\left(1-s\right)\left(1+t\right)\\
N_{6} & =\frac{1}{8}\left(1+r\right)\left(1-s\right)\left(1+t\right)\\
N_{7} & =\frac{1}{8}\left(1+r\right)\left(1+s\right)\left(1+t\right)\\
N_{8} & =\frac{1}{8}\left(1-r\right)\left(1+s\right)\left(1+t\right)
\end{aligned}
\,.\label{eq375}
\end{equation}

\end_inset

The following integration rule is implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Pentahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Pentahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
Pentahedral elements (also knows as 
\begin_inset Quotes eld
\end_inset

wedge
\begin_inset Quotes erd
\end_inset

 elements) consist of six nodes and five faces.
 Their shape functions are defined in function of the isoparametric coordinates
 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

 and are given as follows.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =\frac{1}{2}\left(1-r-s\right)\left(1-t\right)\\
N_{2} & =\frac{1}{2}r\left(1-t\right)\\
N_{3} & =\frac{1}{2}s\left(1-t\right)\\
N_{4} & =\frac{1}{2}\left(1-r-s\right)\left(1+t\right)\\
N_{5} & =\frac{1}{2}r\left(1+t\right)\\
N_{6} & =\frac{1}{2}s\left(1+t\right)
\end{aligned}
\,.\label{eq376}
\end{equation}

\end_inset

The following integration rule is implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
6-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.666666667
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.577350269
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Tetrahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tetrahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
Linear 4-node tetrahedral elements are also available in FEBio.
 Their shape functions are defined in function of the isoparametric coordinates
 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $t$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}N_{1} & =1-r-s-t\\
N_{2} & =r\\
N_{3} & =s\\
N_{4} & =t
\end{aligned}
\,.\label{eq377}
\end{equation}

\end_inset

The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
1-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.166666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigSolidElementsTM.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Different solid element types that are available in FEBio
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Quadratic Tetrahedral Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quadratic-Tetrahedral-Elements"

\end_inset


\end_layout

\begin_layout Standard
FEBio implements a 10-node quadratic tetrahedral element.
 It has four corner nodes and six nodes located at the midpoint of the edges.
 The shape functions in terms area coordinates are given below.
 The area coordinates relate to the isoparametric coordinates as follows.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}t_{1} & =1-r-s-t\\
t_{2} & =r\\
t_{3} & =s\\
t_{4} & =t
\end{aligned}
\,.\label{eq378}
\end{equation}

\end_inset

The shape functions follow.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}H_{i} & =t_{i}\left(2t_{i}-1\right),\,i=1\cdots4\\
H_{5} & =4t_{1}t_{2}\\
H_{6} & =4t_{2}t_{3}\\
H_{7} & =4t_{3}t_{1}\\
H_{8} & =4t_{1}t_{4}\\
H_{9} & =4t_{2}t_{4}\\
H_{10} & =4t_{3}t_{4}
\end{aligned}
\,.\label{eq379}
\end{equation}

\end_inset

The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
4-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58541020
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.13819660
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.041666667 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01583591
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.328054697
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.023087995 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.679143178
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.106952274
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.018578672 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
11-point Gauss-Lobatto rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.002777778 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011111111 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.088888889 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
FEBio also implements a 15-node quadratic tetrahedral element.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigQuadraticTetrahedralElements.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Quadratic tetrahedral elements available in FEBio.
 Left, a 10-node quadratic tet.
 Right, a 15-node quadratic tet.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The following integration rules are implemented for this element type.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8-point Gauss rule
\series default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 Note that weights sum up to one and not to the volume of the tet in the
 natural coordinate system (i.e.
 1/6).
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0158359099
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3280546970
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.138527967 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6791431780
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1069522740
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.111472033 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
11-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.01315555556 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.071428571428571 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.785714285714286 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007622222222 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.100596423833201 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.399403576166799 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.024888888889 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="4">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
15-point Gauss rule
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
r
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
w
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.030283678097089 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.333333333333333
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.000000000000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.006026785714286 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.090909090909091
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.727272727272727
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.011645249086029 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.433449846426336
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.066550153573664
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010949141561386 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Section
Shell Elements
\begin_inset CommandInset label
LatexCommand label
name "sec:Shell-Elements"

\end_inset


\end_layout

\begin_layout Standard
Historically, shells have been formulated using two different approaches
 
\begin_inset CommandInset citation
LatexCommand citep
key "Hughes80"
literal "true"

\end_inset

.
 The difference between these approaches lies in the way the rotational
 degrees of freedom are defined.
 In the first approach, the rotational degrees of freedom are defined as
 angles.
 In addition, the plane stress condition needs to be enforced to take thickness
 variations into account.
 This approach is very useful for infinitesimal strains, but becomes very
 difficult to pursue in finite deformation due to the fact that finite rotations
 do not commute.
 Another disadvantage of this approach is that it requires a modification
 to the material formulation to enforce the plane stress condition.
 For complex materials this modification is very difficult or even impossible
 to obtain.
\end_layout

\begin_layout Standard
The alternative approach is to use an 
\emph on
extensible director 
\emph default
to describe the rotational degrees of freedom.
 With this approach it is not necessary to enforce the plane-stress condition
 and the full 3D constitutive relations can be employed.
 This approach is adapted in FEBio as described here.
\end_layout

\begin_layout Standard
The shell formulation implemented in FEBio is still a work in progress.
 The goal is to implement an extensible director formulation with strain
 enhancements to deal with the well-known locking effect in incompressible
 and bending problems 
\begin_inset CommandInset citation
LatexCommand citep
key "Betsch96"
literal "true"

\end_inset

.
 With the current state of the implementation, it is advised to use quadratic
 elements in such problems.
\end_layout

\begin_layout Standard
Starting with FEBio 2.6, two shell formulations have become available: The
 original formulation, where nodes are located at the mid-surface through
 the thickness of the shell, and a new formulation where nodes are located
 on the front face of the shell.
 The original formulation uses nodal displacements and directors as degrees
 of freedom; the new formulation uses front and back face nodal displacements.
 The new formulation is designed to properly accommodate shells attached
 to the surface of a solid element, or shells sandwiched between two solid
 elements, with minimal alterations to the rest of the code.
 The original formulation does not strictly enforce continuity of all the
 relevant degrees of freedom in those situations.
 However, this original formulation is maintained in the code for backward
 compatibility.
\end_layout

\begin_layout Standard
Most of the shell elements available in FEBio use a 
\emph on
compatible strain
\emph default
 formulation, where the calculation of strain components is based only on
 nodal displacements, similar to hexahedral or pentrahedral elements.
 Users should be aware that this compatible strain formulation is very susceptib
le to element locking when the shell thickness is much smaller than the
 shell size (e.g., when the aspect ratio is less than 0.01).
 Therefore, these shell formulations should be used with caution, keeping
 in mind this important constraint.
 Conversely, these shell elements perform very well when they are attached
 to solid elements (e.g., skin over muscle), or sandwiched between shell elements
 (e.g., cell membrane separating cytoplasm from extra-cellular matrix).
\end_layout

\begin_layout Standard
The element-locking limitation of compatible strain shell formulations has
 motivated the development of specialized shell formulations that attempt
 to overcome locking.
 The FE literature on this subject is rather extensive and we refer the
 reader to the excellent review chapter by Bischoff et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bischoff18"
literal "false"

\end_inset

 on this topic.
 Methods for overcoming locking include the assumed natural strain (ANS)
 formulation for transverse shear strains 
\begin_inset CommandInset citation
LatexCommand citep
key "MacNeal78,Bathe86"
literal "false"

\end_inset

 and transverse normal strains 
\begin_inset CommandInset citation
LatexCommand citep
key "Betsch95,Bischoff97"
literal "false"

\end_inset

.
 The ANS formulation may be supplemented with the enhanced assumed strain
 (EAS) method 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo90"
literal "false"

\end_inset

 and extended to large deformations 
\begin_inset CommandInset citation
LatexCommand citep
key "Klinkel99,Vu-Quoc03,Simo93"
literal "false"

\end_inset

.
 FEBio includes the ANS (
\emph on
q4ans
\emph default
) and EAS (
\emph on
q4eas
\emph default
) quadrilateral shell element formulations of Vu-Quoc and Tan 
\begin_inset CommandInset citation
LatexCommand citep
key "Vu-Quoc03"
literal "false"

\end_inset

, using a seven-parameter EAS interpolation, which is otherwise substantially
 similar to the five-parameter interpolation presented in an earlier study
 by Klinkel et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Klinkel99"
literal "false"

\end_inset

.
 These shell elements are not suitable for attachment to a solid element,
 nor sandwiching between two solid elements.
 Since they don't experience element locking, they should be loaded more
 slowly than compatible strain shell elements.
 The formulations presented below are for the compatible strain shell elements.
\end_layout

\begin_layout Subsection
Shell with mid-surface nodal displacements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shell-formulation-standalone"

\end_inset


\end_layout

\begin_layout Standard
We create a shell formulation by reducing a solid element interpolation
 which is linear along the parametric coordinate 
\begin_inset Formula $\xi_{3}$
\end_inset

.
 We start with the general interpolation for a solid element, 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{i}\right)\mathbf{x}_{a}\,,\label{eq380}
\end{equation}

\end_inset

where 
\begin_inset Formula $i=1,2,3$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 is the number of nodes, and specialize it to the case of a shell as 
\begin_inset Formula 
\begin{equation}
N_{a}\left(\xi_{i}\right)=\begin{cases}
\frac{1-\xi_{3}}{2}M_{a}\left(\xi_{\alpha}\right) & 1\leqslant a\leqslant m\\
\frac{1+\xi_{3}}{2}M_{a}\left(\xi_{\alpha}\right) & m+1\leqslant a\leqslant n
\end{cases}\,,\label{eq381}
\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha=1,2$
\end_inset

, 
\begin_inset Formula $m=n/2$
\end_inset

 is the number of shell element nodes, and 
\begin_inset Formula $M_{a}\left(\xi_{\alpha}\right)$
\end_inset

 are the interpolation functions within the mid-shell surface.
 The description of the mid-shell surface is thus given by 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{x}}\left(\xi_{\alpha}\right)=\sum\limits _{a=1}^{n}N_{a}\left(\xi_{1},\xi_{2},0\right)\mathbf{x}_{a}\equiv\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{\hat{x}}_{b}\,,\label{eq382}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{\hat{x}}_{b}=\frac{1}{2}\left(\mathbf{x}_{b}+\mathbf{x}_{b+m}\right)\label{eq383}
\end{equation}

\end_inset

are the nodal positions for the mid-shell surface.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementsTM.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Example of shell elements with four mid-surface nodal positions 
\begin_inset Formula $\mathbf{\hat{x}}_{b}$
\end_inset

 and directors 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 (
\begin_inset Formula $b=1-4)$
\end_inset

, reduced from a solid element.
 
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
We also define the director across the shell surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{d}\left(\xi_{\alpha}\right)=\mathbf{x}\left(\xi_{1},\xi_{2},1\right)-\mathbf{x}\left(\xi_{1},\xi_{2},-1\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{d}_{b}\,,\label{eq384}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{d}_{b}=\mathbf{x}_{b+m}-\mathbf{x}_{b},\quad b=1-m\label{eq385}
\end{equation}

\end_inset

are the nodal directors.
 Note that the magnitude of the nodal director represents the shell thickness,
 
\begin_inset Formula $h\left(\xi_{\alpha}\right)=\left\Vert \mathbf{d}\left(\xi_{\alpha}\right)\right\Vert $
\end_inset

 and the shell thicknesses at the nodes are 
\begin_inset Formula $h_{b}=\left\Vert \mathbf{d}_{b}\right\Vert $
\end_inset

.
 With these definitions we find that the interpolation across the parametric
 space of the shell element is 
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\mathbf{\hat{x}}\left(\xi_{\alpha}\right)+\frac{1}{2}\xi_{3}\mathbf{d}\left(\xi_{\alpha}\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\left(\mathbf{\hat{x}}_{b}+\frac{1}{2}\xi_{3}\mathbf{d}_{b}\right)\,.\label{eq386}
\end{equation}

\end_inset

From this relation we can obtain the covariant basis vectors as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{\alpha}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{\alpha}}=\sum\limits _{b=1}^{m}\frac{\partial M_{b}}{\partial\xi_{\alpha}}\left(\mathbf{\hat{x}}_{b}+\frac{1}{2}\xi_{3}\mathbf{d}_{b}\right)\\
\mathbf{g}_{3}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{3}}=\frac{1}{2}\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\mathbf{d}_{b}
\end{aligned}
\,,\label{eq387}
\end{equation}

\end_inset

from which we may evaluate the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}^{j}$
\end_inset

 using the identity 
\begin_inset Formula $\mathbf{g}_{i}\cdot\mathbf{g}^{j}=\delta_{i}^{j}$
\end_inset

.
 Then, the gradients of the shape functions are given by 
\begin_inset Formula 
\begin{equation}
\grad M_{b}=\frac{\partial M_{b}}{\partial\xi_{\alpha}}\mathbf{g}^{\alpha},\quad\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)=\frac{1}{2}\left(\xi_{3}\grad M_{b}+M_{b}\mathbf{g}^{3}\right)\,.\label{eq388}
\end{equation}

\end_inset

It follows from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq386"

\end_inset

 that the virtual displacement is 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{u}\left(\xi_{i}\right)=\sum\limits _{a=1}^{m}M_{a}\left(\xi_{\alpha}\right)\left(\delta\mathbf{\hat{u}}_{a}+\frac{1}{2}\xi_{3}\delta\mathbf{d}_{a}\right)\,,\label{eq389}
\end{equation}

\end_inset

and the incremental displacement is 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}\left(\xi_{i}\right)=\sum\limits _{b=1}^{m}M_{b}\left(\xi_{\alpha}\right)\left(\Delta\mathbf{\hat{u}}_{b}+\frac{1}{2}\xi_{3}\Delta\mathbf{d}_{b}\right)\,.\label{eq390}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In FEBio, for historical reasons, the nodal director 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 is currently called 
\emph on
rotation
\emph default
.
 This is a misnomer and users should treat this 
\emph on
rotation
\emph default
 as the vector 
\begin_inset Formula $\mathbf{d}_{a}$
\end_inset

 whose components have units of length.
 Thus, fixing or prescribing 
\emph on
rotation
\emph default
 components in the input file effectively places these constraints on the
 components of the nodal director; similarly, requesting 
\emph on
rotation
\emph default
 in the output files will produce the components of the director.
\end_layout

\begin_layout Standard
When this type of shell is connected face-to-face with a solid element,
 the nodes located at 
\begin_inset Formula $\mathbf{\hat{x}}_{b}$
\end_inset

 automatically share their displacement degrees of freedom 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 with the corresponding nodes from the face of the solid element.
 However, no continuity is enforced between the directors 
\begin_inset Formula $\mathbf{d}_{b}$
\end_inset

 and the solid element deformation.
 One consequence of this condition is that a shell sandwiched between two
 solid elements will not detect out-of-plane shear and normal stresses transmitt
ed by the solid element(s).
 Another consequence is that bending of the solid element(s) will not produce
 a bending moment in the shell.
 Therefore, these shell elements are best used as shell-only structures.
\end_layout

\begin_layout Subsubsection
Elastic Shell
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elastic-Shell"

\end_inset


\end_layout

\begin_layout Standard
For an elastic shell, the internal virtual work becomes 
\begin_inset Formula 
\begin{equation}
\delta W_{\text{int}}^{e}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}:\grad\delta\mathbf{u}\,dv=\sum\limits _{a=1}^{n}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{d}
\end{array}\right]\,,\label{eq391}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{f}_{a}^{u}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}\cdot\grad M_{a}\,dv,\quad\mathbf{f}_{a}^{d}=\int\limits _{\Omega^{e}}\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\,dv\,.\label{eq392}
\end{equation}

\end_inset

The linearization of the internal virtual work is 
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
D\left(\delta W_{\text{int}}^{e}\right)\left[\Delta\mathbf{u}\right]=\int\limits _{\Omega^{e}}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv\\
+\int\limits _{\Omega^{e}}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv
\end{array}\,.\label{eq393}
\end{equation}

\end_inset

The first of these integrals may be discretized as 
\begin_inset Formula 
\begin{equation}
\int\limits _{\Omega^{e}}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv=\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{ud}\\
\mathbf{K}_{ab}^{du} & \mathbf{K}_{ab}^{dd}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{\hat{u}}_{b}\\
\Delta\mathbf{d}_{b}
\end{array}\right]\,,\label{eq394}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int\limits _{\Omega^{e}}\left(\grad M_{a}\cdot\boldsymbol{\sigma}\cdot\grad M_{b}\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{ud} & =\int\limits _{\Omega^{e}}\left(\grad M_{a}\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{du} & =\int\limits _{\Omega^{e}}\left(\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad M_{b}\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{dd} & =\int\limits _{\Omega^{e}}\left(\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\right)\mathbf{I}\,dv
\end{aligned}
\,.\label{eq395}
\end{equation}

\end_inset

The second integral in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq393"

\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\int\limits _{\Omega^{e}}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv=\sum\limits _{a=1}^{m}\sum\limits _{b=1}^{m}\left[\begin{array}{cc}
\delta\mathbf{\hat{u}}_{a} & \delta\mathbf{d}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{ud}\\
\mathbf{K}_{ab}^{du} & \mathbf{K}_{ab}^{dd}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{\hat{u}}_{b}\\
\Delta\mathbf{d}_{b}
\end{array}\right]\,,\label{eq396}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int\limits _{\Omega^{e}}\grad M_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad M_{b}\,dv\\
\mathbf{K}_{ab}^{ud} & =\int\limits _{\Omega^{e}}\grad M_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{du} & =\int\limits _{\Omega^{e}}\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad M_{b}\,dv\\
\mathbf{K}_{ab}^{dd} & =\int\limits _{\Omega^{e}}\grad\left(\frac{1}{2}\xi_{3}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1}{2}\xi_{3}M_{b}\right)\,dv
\end{aligned}
\,.\label{eq397}
\end{equation}

\end_inset

Similar expressions may be derived for the external work and inertia forces.
\end_layout

\begin_layout Standard
In FEBio a 3-point Gaussian quadrature rule is used for the through-the-thicknes
s integration.
 FEBio currently supports four- and eight-node quadrilateral and three-
 and six-node triangular shell elements.
\end_layout

\begin_layout Subsubsection
Quadrilateral shells
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quadrilateral-shells"

\end_inset


\end_layout

\begin_layout Standard
For four-node quadrilateral shells, the shape functions are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =\frac{1}{4}\left(1-r\right)\left(1-s\right)\\
M_{2} & =\frac{1}{4}\left(1+r\right)\left(1-s\right)\\
M_{3} & =\frac{1}{4}\left(1+r\right)\left(1+s\right)\\
M_{4} & =\frac{1}{4}\left(1-r\right)\left(1+s\right)
\end{aligned}
\,.\label{eq398}
\end{equation}

\end_inset

For eight-node quadrilateral shells the shape functions are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =\frac{1}{4}\left(1-r\right)\left(1-s\right)-\frac{1}{2}\left(M_{8}+M_{5}\right) & M_{5} & =\frac{1}{2}\left(1-r^{2}\right)\left(1-s\right)\\
M_{2} & =\frac{1}{4}\left(1+r\right)\left(1-s\right)-\frac{1}{2}\left(M_{5}+M_{6}\right) & M_{6} & =\frac{1}{2}\left(1-s^{2}\right)\left(1+r\right)\\
M_{3} & =\frac{1}{4}\left(1+r\right)\left(1+s\right)-\frac{1}{2}\left(M_{6}+M_{7}\right) & M_{7} & =\frac{1}{2}\left(1-r^{2}\right)\left(1+s\right)\\
M_{4} & =\frac{1}{4}\left(1-r\right)\left(1+s\right)-\frac{1}{2}\left(M_{7}+M_{8}\right) & M_{8} & =\frac{1}{2}\left(1-s^{2}\right)\left(1-r\right)
\end{aligned}
\,.\label{eq399}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Triangular shells
\begin_inset CommandInset label
LatexCommand label
name "subsec:Triangular-shells"

\end_inset


\end_layout

\begin_layout Standard
For three-node triangular shell elements, the shape functions are given
 by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =1-r-s\\
M_{2} & =r\\
M_{3} & =s
\end{aligned}
\,.\label{eq400}
\end{equation}

\end_inset

For six-node triangular shell elements they are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}M_{1} & =r_{1}\left(2r_{1}-1\right) & M_{4} & =4r_{1}r_{2}\\
M_{2} & =r_{2}\left(2r_{2}-1\right) & M_{5} & =4r_{2}r_{3}\\
M_{3} & =r_{3}\left(2r_{3}-1\right) & M_{6} & =4r_{3}r_{1}\\
r_{1} & =1-r-s & r_{2} & =r & r_{3} & =s
\end{aligned}
\,.\label{eq401}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementTypesTM.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Different shell elements available in FEBio.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Shells with front and back face nodal displacements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shells-front-back"

\end_inset


\end_layout

\begin_layout Standard
We create a shell formulation by reducing a 3D element interpolation which
 is linear along 
\begin_inset Formula $\xi_{3}$
\end_inset

.
 The nodal positions at the back of the shell (
\begin_inset Formula $\xi_{3}=-1$
\end_inset

) are denoted by 
\begin_inset Formula $\mathbf{y}_{a}$
\end_inset

 and those on the front of the shell (
\begin_inset Formula $\xi_{3}=+1$
\end_inset

) are denoted by 
\begin_inset Formula $\mathbf{x}_{a}$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\xi_{i}\right)=\sum_{a}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\frac{1+\xi_{3}}{2}\mathbf{x}_{a}+\frac{1-\xi_{3}}{2}\mathbf{y}_{a}\right)=\sum_{a}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\mathbf{x}_{a}-\frac{1-\xi_{3}}{2}\mathbf{d}_{a}\right)\label{eq:solid-element-interpolation}
\end{equation}

\end_inset

The vector from 
\begin_inset Formula $\mathbf{y}_{a}$
\end_inset

 to 
\begin_inset Formula $\mathbf{x}_{a}$
\end_inset

 is the director, 
\begin_inset Formula $\mathbf{d}_{a}$
\end_inset

,
\begin_inset Formula 
\[
\mathbf{d}_{a}=\mathbf{x}_{a}-\mathbf{y}_{a}
\]

\end_inset

From this relation we can get the shell covariant basis vectors,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{\alpha}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{\alpha}}=\sum_{a}\frac{\partial M_{a}}{\partial\xi_{\alpha}}\left(\frac{1+\xi_{3}}{2}\mathbf{x}_{a}+\frac{1-\xi_{3}}{2}\mathbf{y}_{a}\right)=\sum_{a}\frac{\partial M_{a}}{\partial\xi_{\alpha}}\left(\mathbf{x}_{a}-\frac{1-\xi_{3}}{2}\mathbf{d}_{a}\right)\\
\mathbf{g}_{3}\left(\xi_{i}\right) & =\frac{\partial\mathbf{x}}{\partial\xi_{3}}=\sum_{a}\frac{1}{2}M_{a}\left(\xi_{1},\xi_{2}\right)\left(\mathbf{x}_{a}-\mathbf{y}_{a}\right)=\sum_{a}\frac{1}{2}M_{a}\left(\xi_{1},\xi_{2}\right)\mathbf{d}_{a}
\end{aligned}
\label{eq:shell-covariant-basis}
\end{equation}

\end_inset

from which we may evaluate the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}^{i}$
\end_inset

.
 Let the front-face and back-face displacements be denoted by 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula $\mathbf{x}_{a}=\mathbf{X}_{a}+\mathbf{u}_{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}_{a}=\mathbf{Y}_{a}+\mathbf{w}_{a}$
\end_inset

, where 
\begin_inset Formula $\mathbf{X}_{a}$
\end_inset

 represents the shell nodal positions in the reference configuration, provided
 as nodal coordinates in the input file, and 
\begin_inset Formula $\mathbf{Y}_{a}=\mathbf{X}_{a}-\mathbf{D}_{a}$
\end_inset

 is evaluated from the user-defined referential shell thickness, and the
 surface surface normals evaluated at each node.
 If the shell surface is not planar in the reference configuration, users
 must be careful to select shell thicknesses that don't produce inverted
 elements (negative Jacobians) as a result of this extrapolation.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigShellElementsFB.png
	lyxscale 45
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Example of shell element with front-face nodal positions 
\begin_inset Formula $\mathbf{x}_{b}$
\end_inset

 and back-face nodal positions 
\begin_inset Formula $\mathbf{y}_{b}$
\end_inset

 (
\begin_inset Formula $b=1-4)$
\end_inset

, reduced from a solid element.
 
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
It follows that the virtual displacement is
\begin_inset Formula 
\begin{equation}
\delta\mathbf{u}\left(\xi_{i}\right)=\sum_{a}M_{a}\left(\frac{1+\xi_{3}}{2}\delta\mathbf{u}_{a}+\frac{1-\xi_{3}}{2}\delta\mathbf{w}_{a}\right)\,,\label{eq:shell-virtual-velocity}
\end{equation}

\end_inset

and the incremental displacement is
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}\left(\xi_{i}\right)=\sum_{b}M_{b}\left(\frac{1+\xi_{3}}{2}\Delta\mathbf{u}_{b}+\frac{1-\xi_{3}}{2}\Delta\mathbf{w}_{b}\right)\,,\label{eq:shell-incremental-displacement}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
\grad\delta\mathbf{u}=\sum_{a}\delta\mathbf{u}_{a}\otimes\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)+\delta\mathbf{w}_{a}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\,,\label{eq:gradient-virtual-velocity}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\grad\Delta\mathbf{u}=\sum_{b}\Delta\mathbf{u}_{b}\otimes\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)+\Delta\mathbf{w}_{b}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\label{eq:gradient-incremental-displacement}
\end{equation}

\end_inset

Note that
\begin_inset Formula 
\begin{equation}
\grad M_{b}=\frac{\partial M_{b}}{\partial\xi_{\alpha}}\mathbf{g}^{\alpha}\,,\label{eq:shell-shape-gradient-M}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)=\frac{1}{2}\left(\left(1+\xi_{3}\right)\grad M_{b}+M_{b}\mathbf{g}^{3}\right)\label{eq:shell-shape-gradient-Mu}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)=\frac{1}{2}\left(\left(1-\xi_{3}\right)\grad M_{b}-M_{b}\mathbf{g}^{3}\right)\label{eq:shell-shape-gradient-Md}
\end{equation}

\end_inset

To evaluate the deformation gradient in this shell element, we use
\begin_inset Formula 
\[
\mathbf{F}=\Grad\mathbf{x}=\sum_{b}\mathbf{u}_{b}\otimes\Grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)+\mathbf{w}_{b}\otimes\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
For this formulation, when a shell element is connected face-to-face with
 a solid element, the nodal displacements of the solid element face are
 set to coincide with the back-face nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 of the shell.
 When a user prescribes displacement components on that shared face, they
 apply to the front-face displacements 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

.
 Similarly, prescribed pressures and contact pressures act on the shell
 front face.
\end_layout

\begin_layout Standard
When a shell element is sandwiched between two solid elements, the nodal
 displacements of the solid element facing the shell back face are set to
 coincide with the shell back-face nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

, whereas the nodal displacements of the solid element facing the shell
 front face are set to coincide with the shell front-face nodal displacements
 
\begin_inset Formula $\mathbf{u}_{a}$
\end_inset

.
 If the shell thickness exceeds the thickness of the solid element connected
 to its back face, results become unpredictable.
\end_layout

\begin_layout Subsubsection
Elastic Shell
\end_layout

\begin_layout Standard
For an elastic solid, the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{v}\boldsymbol{\sigma}:\grad\delta\mathbf{u}\,dv\\
 & =\sum_{a}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}
\end{array}\right]
\end{aligned}
\,,\label{eq:virtual-work-internal}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u} & =\int_{v}\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\,dv\\
\mathbf{f}_{a}^{w} & =\int_{v}\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\,dv
\end{aligned}
\,.\label{eq:shell-internal-force}
\end{equation}

\end_inset

For the external work of body forces,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{ext} & =\int_{v}\delta\mathbf{u}\cdot\rho\mathbf{b}\,dv\\
 & =\sum_{a=1}^{m}\delta\mathbf{u}_{a}\cdot\mathbf{f}_{a}^{u}+\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}
\end{aligned}
\,,\label{eq:virtual-work-external}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{u} & =\int_{v}\frac{1+\xi_{3}}{2}M_{a}\rho\mathbf{b}\,dv\\
\mathbf{f}_{a}^{w} & =\int_{v}\frac{1-\xi_{3}}{2}M_{a}\rho\mathbf{b}\,dv
\end{aligned}
\,.\label{eq:shell-external-force}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linearization of the internal virtual work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{int}\right)\left[\Delta\mathbf{u}\right] & =\int_{v}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv\\
 & +\int_{v}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv
\end{aligned}
\,.\label{eq:linearized-internal-work}
\end{equation}

\end_inset

So
\begin_inset Formula 
\begin{equation}
\int_{v}\tr\left(\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}\cdot\grad^{T}\delta\mathbf{u}\right)\,dv=\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]\,,\label{eq:discretized-geometric-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{v}\left(\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{uw} & =\int_{v}\left(\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{wu} & =\int_{v}\left(\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv\\
\mathbf{K}_{ab}^{ww} & =\int_{v}\left(\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\sigma}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\right)\mathbf{I}\,dv
\end{aligned}
\,.\label{eq:shell-geometric-stiffness}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\int_{v}\grad\delta\mathbf{u}:\boldsymbol{\mathcal{C}}:\grad^{T}\Delta\mathbf{u}\,dv=\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]\,,\label{eq:discretized-material-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{v}\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{uw} & =\int_{v}\grad\left(\frac{1+\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{wu} & =\int_{v}\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1+\xi_{3}}{2}M_{b}\right)\,dv\\
\mathbf{K}_{ab}^{ww} & =\int_{v}\grad\left(\frac{1-\xi_{3}}{2}M_{a}\right)\cdot\boldsymbol{\mathcal{C}}\cdot\grad\left(\frac{1-\xi_{3}}{2}M_{b}\right)\,dv
\end{aligned}
\,.\label{eq:shell-material-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The linearization of the external work is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left(\delta W_{ext}\right) & =\sum_{a=1}^{m}\sum_{b=1}^{m}\int_{v}\left(\frac{1+\xi_{3}}{2}M_{a}\delta\mathbf{u}_{a}+\frac{1-\xi_{3}}{2}M_{a}\delta\mathbf{w}_{a}\right)\cdot\rho\grad\mathbf{b}\cdot\left(\frac{1+\xi_{3}}{2}\Delta\mathbf{u}_{b}+\frac{1-\xi_{3}}{2}M_{b}\Delta\mathbf{w}_{b}\right)\,dv\\
 & =\sum_{a}\sum_{b}\left[\begin{array}{cc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}
\end{array}\right]
\end{aligned}
\,,\label{eq:linearized-external-work}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ab}^{uu} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)^{2}M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{uw} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)\left(\frac{1-\xi_{3}}{2}\right)M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{wu} & =\int_{V}\left(\frac{1+\xi_{3}}{2}\right)\left(\frac{1-\xi_{3}}{2}\right)M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV\\
\mathbf{K}_{ab}^{ww} & =\int_{V}\left(\frac{1-\xi_{3}}{2}\right)^{2}M_{a}M_{b}\rho_{0}\grad\mathbf{b}\,dV
\end{aligned}
\,.\label{eq:shell-external-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
External work of surface forces
\end_layout

\begin_layout Standard
We assume that surface forces are applied on the shell front face (
\begin_inset Formula $\xi_{3}=+1$
\end_inset

).
 Therefore, the external work of surface forces has the form
\begin_inset Formula 
\begin{equation}
\delta W_{ext}=\int_{\partial v}\delta\mathbf{u}\left(\xi_{1},\xi_{2},+1\right)\cdot\mathbf{t}\,da=\sum_{a}\delta\mathbf{u}_{a}\cdot\int_{\partial v}M_{a}\left(\xi_{1},\xi_{2}\right)\mathbf{t}\,da\label{eq:fbs-ext-work}
\end{equation}

\end_inset

In other words, the treatment of surface forces on a shell becomes identical
 to the treatment of surface forces on the face of a solid.
 No special treatment is needed.
\end_layout

\begin_layout Subsubsection
Shell on top of solid element
\end_layout

\begin_layout Standard
When a shell is coincident with the face of a solid element, we assume that
 the face of the solid element coincides with the back face (
\begin_inset Formula $\xi_{3}=-1$
\end_inset

) of the shell element.
 This means that the solid element nodal displacements 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 on that face coincide with the shell nodal displacements 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

.
 Therefore, when we use UnpackLM for those solid elements, we should reassign
 the DOF ID's of the 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements to those of the 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 displacements stored in that same node.
\end_layout

\begin_layout Subsubsection
Shell sandwiched between solid elements
\end_layout

\begin_layout Standard
When a shell is sandwiched between two solid elements, we reassign the DOF
 ID's of the the solid 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements facing the back of the shell to those of the shell 
\begin_inset Formula $\mathbf{w}_{b}$
\end_inset

 displacements stored in that same node.
 The DOF ID's of solid 
\begin_inset Formula $\mathbf{u}_{b}$
\end_inset

 displacements facing the front of the shell remain unchanged; they will
 coincide with those of the corresponding solid element nodes.
\end_layout

\begin_layout Subsubsection
Rigid-Shell Interface
\end_layout

\begin_layout Standard
When the node of a deformable shell belongs to a rigid body, we need to
 substitute the nodal degrees of freedom with the rigid body degrees of
 freedom.
 The positions of the shell front face and back face nodes are 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{x}_{b} & =\mathbf{r}+\boldsymbol{\Lambda}\cdot\left(\mathbf{X}_{b}-\mathbf{R}\right)\equiv\mathbf{r}+\mathbf{a}_{b}\\
\mathbf{y}_{b} & =\mathbf{r}+\boldsymbol{\Lambda}\cdot\left(\mathbf{Y}_{b}-\mathbf{R}\right)\equiv\mathbf{r}+\mathbf{b}_{b}
\end{aligned}
\,,\label{eq:fbs-rigid-shell}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}$
\end_inset

 is the current position of the rigid body center of mass and 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is its initial position; 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 is the rotation tensor for the rigid body.
 We assume that 
\begin_inset Formula $\mathbf{x}_{b}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}_{b}$
\end_inset

 are connected to the same rigid body.
 From these relations it follows that virtual displacements are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{u}_{a} & =\delta\mathbf{r}-\hat{\mathbf{a}}_{a}\cdot\delta\boldsymbol{\theta}\\
\delta\mathbf{w}_{b} & =\delta\mathbf{r}-\hat{\mathbf{b}}_{a}\cdot\delta\boldsymbol{\theta}
\end{aligned}
\,,\label{eq:fbs-rsi-virtual}
\end{equation}

\end_inset

and incremental displacements are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\mathbf{u}_{b} & =\Delta\mathbf{r}-\hat{\mathbf{a}}_{b}\cdot\Delta\boldsymbol{\theta}\\
\Delta\mathbf{w}_{b} & =\Delta\mathbf{r}-\hat{\mathbf{b}}_{b}\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\,,\label{eq:fbs-rsi-incremental}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{a}}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{a}$
\end_inset

, such that 
\begin_inset Formula $\hat{\mathbf{a}}\cdot\mathbf{v}=\mathbf{a}\times\mathbf{v}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{v}$
\end_inset

.
 When nodes are flexible (when they do not belong to any rigid body), the
 virtual work has the general form
\begin_inset Formula 
\begin{equation}
\delta W=\sum_{a=1}^{m}\delta\mathbf{u}_{a}\cdot\mathbf{f}_{a}^{u}+\delta\mathbf{w}_{a}\cdot\mathbf{f}_{a}^{w}+\delta p_{a}\,f_{a}^{p}=\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]\,,\label{eq:fbs-rsi-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 denotes any additional degree-of-freedom at that node.
 If node 
\begin_inset Formula $a$
\end_inset

 is rigid we get
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]=\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\left[\begin{array}{ccc}
\mathbf{I} & \mathbf{I} & \mathbf{0}\\
\hat{\mathbf{a}}_{a} & \hat{\mathbf{b}}_{a} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & 1
\end{array}\right]\,.\label{eq:fbs-rsi-a-rigid}
\end{equation}

\end_inset

If node 
\begin_inset Formula $b$
\end_inset

 is rigid we get
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]=\left[\begin{array}{ccc}
\mathbf{I} & -\hat{\mathbf{a}}_{b} & \mathbf{0}\\
\mathbf{I} & -\hat{\mathbf{b}}_{b} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & 1
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]\,.\label{eq:fbs-rsi-b-rigid}
\end{equation}

\end_inset

When node 
\begin_inset Formula $a$
\end_inset

 belongs to a rigid body, the expression for 
\begin_inset Formula $\delta W$
\end_inset

 must be substituted with
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W & =\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}\\
\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]\\
 & =\sum_{a=1}^{m}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\omega} & \delta p_{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{a}^{u}+\mathbf{f}_{a}^{w}\\
\hat{\mathbf{a}}_{a}^{n+\alpha}\cdot\mathbf{f}_{a}^{u}+\hat{\mathbf{b}}_{a}^{n+\alpha}\cdot\mathbf{f}_{a}^{w}\\
f_{a}^{p}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-work-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Similarly, the linearized virtual work has the general form
\begin_inset Formula 
\begin{equation}
D\delta W=\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu} & \mathbf{K}_{ab}^{uw} & \mathbf{k}_{ab}^{up}\\
\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{ww} & \mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu} & \mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]\,.\label{eq:fbs-rsi-D-work}
\end{equation}

\end_inset

When node 
\begin_inset Formula $a$
\end_inset

 is rigid but node 
\begin_inset Formula $b$
\end_inset

 is not,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu} & \mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww} & \mathbf{k}_{ab}^{up}+\mathbf{k}_{ab}^{wp}\\
\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uu}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{wu} & \hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uw}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{ww} & \hat{\mathbf{a}}_{a}\cdot\mathbf{k}_{ab}^{up}+\hat{\mathbf{b}}_{a}\cdot\mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu} & \mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\\
 & \times\left[\begin{array}{c}
\Delta\mathbf{u}_{b}\\
\Delta\mathbf{w}_{b}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-2}
\end{equation}

\end_inset

If nodes 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 are both rigid,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{r} & \delta\boldsymbol{\theta} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww} & \left(\begin{aligned}-\left(\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu}\right)\cdot\hat{\mathbf{a}}_{b}\\
-\left(\mathbf{K}_{ab}^{uw}+\mathbf{K}_{ab}^{ww}\right)\cdot\hat{\mathbf{b}}_{b}
\end{aligned}
\right) & \mathbf{k}_{ab}^{up}+\mathbf{k}_{ab}^{wp}\\
\left(\begin{aligned}\hat{\mathbf{a}}_{a}\cdot\left(\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{uw}\right)\\
+\hat{\mathbf{b}}_{a}\cdot\left(\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{ww}\right)
\end{aligned}
\right) & \left(\begin{aligned}-\left(\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uu}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{wu}\right)\cdot\hat{\mathbf{a}}_{b}\\
-\left(\hat{\mathbf{a}}_{a}\cdot\mathbf{K}_{ab}^{uw}+\hat{\mathbf{b}}_{a}\cdot\mathbf{K}_{ab}^{ww}\right)\cdot\hat{\mathbf{b}}_{b}
\end{aligned}
\right) & \hat{\mathbf{a}}_{a}\cdot\mathbf{k}_{ab}^{up}+\hat{\mathbf{b}}_{a}\cdot\mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu}+\mathbf{k}_{ab}^{pw} & \hat{\mathbf{a}}_{b}\cdot\mathbf{k}_{ab}^{pu}+\hat{\mathbf{b}}_{b}\cdot\mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\\
 & \times\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-3}
\end{equation}

\end_inset

If node 
\begin_inset Formula $a$
\end_inset

 is not rigid and node 
\begin_inset Formula $b$
\end_inset

 is rigid,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta W & =\sum_{a}\sum_{b}\left[\begin{array}{ccc}
\delta\mathbf{u}_{a} & \delta\mathbf{w}_{a} & \delta p_{a}\end{array}\right]\times\\
 & \left[\begin{array}{ccc}
\mathbf{K}_{ab}^{uu}+\mathbf{K}_{ab}^{wu} & -\mathbf{K}_{ab}^{uu}\cdot\hat{\mathbf{a}}_{b}-\mathbf{K}_{ab}^{uw}\cdot\hat{\mathbf{b}}_{b} & \mathbf{k}_{ab}^{up}\\
\mathbf{K}_{ab}^{wu}+\mathbf{K}_{ab}^{ww} & -\mathbf{K}_{ab}^{wu}\cdot\hat{\mathbf{a}}_{b}-\mathbf{K}_{ab}^{ww}\cdot\hat{\mathbf{b}}_{b} & \mathbf{k}_{ab}^{wp}\\
\mathbf{k}_{ab}^{pu}+\mathbf{k}_{ab}^{pw} & \hat{\mathbf{a}}_{b}\cdot\mathbf{k}_{ab}^{pu}+\hat{\mathbf{b}}_{b}\cdot\mathbf{k}_{ab}^{pw} & k_{ab}^{pp}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}\\
\Delta p_{b}
\end{array}\right]
\end{aligned}
\,.\label{eq:fbs-rsi-D-work-4}
\end{equation}

\end_inset


\end_layout

\begin_layout Chapter
Constitutive Models
\begin_inset CommandInset label
LatexCommand label
name "chap:Constitutive-Models"

\end_inset


\end_layout

\begin_layout Standard
This chapter describes the theoretical background behind the constitutive
 models that are available in FEBio.
 Most materials are derived from a hyperelastic strain-energy function.
 Please consult Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Hyperelasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for more background information on this class of materials.
\end_layout

\begin_layout Section
Linear Elasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Linear-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
In the theory of linear elasticity the Cauchy stress tensor is a linear
 function of the small strain tensor 
\begin_inset Formula $\boldsymbol{\varepsilon}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,.\label{eq402}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order elasticity tensor that contains the material properties.
 In the most general case this tensor has 21 independent parameters.
 However, in the presence of material symmetry the number of independent
 parameters is greatly reduced.
 For example, in the case of isotropic linear elasticity only two independent
 parameters remain.
 In this case, the elasticity tensor is given by 
\begin_inset Formula $\boldsymbol{\mathcal{C}}=\lambda\mathbf{I}\otimes\mathbf{I}+2\mu\mathbf{I}\,\overline{\underline{\otimes}}\,\mathbf{I}$
\end_inset

, or equivalently, 
\begin_inset Formula 
\begin{equation}
\mathcal{C}_{ijkl}=\lambda\delta_{ij}\delta_{kl}+\mu\left(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk}\right)\,.\label{eq403}
\end{equation}

\end_inset

The material coefficients 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are known as the Lamé parameters.
 Using this equation, the stress-strain relationship can be written as 
\begin_inset Formula 
\begin{equation}
\sigma_{ij}=\lambda\varepsilon_{kk}\delta_{ij}+2\mu\varepsilon_{ij}\,.\label{eq404}
\end{equation}

\end_inset

If the stress and strain are represented inVoigt notation, the constitutive
 equation can be rewritten in matrix form as 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
\sigma_{11}\\
\sigma_{22}\\
\sigma_{33}\\
\sigma_{12}\\
\sigma_{23}\\
\sigma_{13}
\end{array}\right]=\left[\begin{array}{cccccc}
\lambda+2\mu & \lambda & \lambda & 0 & 0 & 0\\
\lambda & \lambda+2\mu & \lambda & 0 & 0 & 0\\
\lambda & \lambda & \lambda+2\mu & 0 & 0 & 0\\
0 & 0 & 0 & \mu & 0 & 0\\
0 & 0 & 0 & 0 & \mu & 0\\
0 & 0 & 0 & 0 & 0 & \mu
\end{array}\right]\left[\begin{array}{c}
\varepsilon_{11}\\
\varepsilon_{22}\\
\varepsilon_{33}\\
\gamma_{12}\\
\gamma_{23}\\
\gamma_{13}
\end{array}\right]\,.\label{eq405}
\end{equation}

\end_inset

The shear strain measures 
\begin_inset Formula $\gamma_{ij}=2\varepsilon_{ij}$
\end_inset

 are called the 
\emph on
engineering strains
\emph default
.
\end_layout

\begin_layout Standard
The following table relates the Lamé parameters to the more familiar Young's
 modulus 
\begin_inset Formula $E$
\end_inset

 and Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 or to the bulk modulus 
\begin_inset Formula $K$
\end_inset

 and shear modulus 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda,\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $K,G$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
E=\frac{\mu}{\lambda+\mu}\left(2\mu+3\lambda\right)\\
\nu=\frac{\lambda}{2\left(\lambda+\mu\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
E=\frac{9KG}{3K+G}\\
\nu=\frac{3K-2G}{6K+2G}
\end{array}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda,\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
\lambda=\frac{\nu E}{\left(1+\nu\right)\left(1-2\nu\right)}\\
\mu=\frac{E}{2\left(1+\nu\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
\lambda=K-\frac{2}{3}G\\
\mu=G
\end{array}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $K,G$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
K=\frac{E}{3\left(1-2v\right)}\\
G=\frac{E}{2\left(1+v\right)}
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\begin{array}{l}
K=\lambda+\frac{2}{3}\mu\\
G=\mu
\end{array}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The theoretical range of the Young's modulus and Poisson's ratio for an
 isotropic material have the ranges 
\begin_inset Formula 
\begin{equation}
0<E<\infty\,,\label{eq406}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
-1\leqslant\nu<0.5\,.\label{eq407}
\end{equation}

\end_inset

Materials with Poisson's ratio (close to) 0.5 are known as (nearly-) incompressib
le materials.
 For these materials, the bulk modulus approaches infinity.
 Most materials have a positive Poisson's ratio.
 However there do exist some materials with a negative ratio.
 These materials are known as 
\emph on
auxetic
\emph default
 materials and they have the remarkable property that they expand under
 tension.
\end_layout

\begin_layout Standard
The linear stress-strain relationship can also be derived from a strain-energy
 function such as in the case of hyperelastic materials.
 In this case the linear strain-energy is given by 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\boldsymbol{\varepsilon}:\boldsymbol{\mathcal{C}}:\boldsymbol{\varepsilon}\,.\label{eq408}
\end{equation}

\end_inset

The stress is then similarly derived from 
\begin_inset Formula $\boldsymbol{\sigma}=\frac{\partial W}{\partial\boldsymbol{\mathbf{\varepsilon}}}$
\end_inset

.
 In the case of isotropic elasticity, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq408"

\end_inset

 can be simplified: 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\lambda\left(\tr\boldsymbol{\mathbf{\varepsilon}}\right)^{2}+\mu\boldsymbol{\mathbf{\varepsilon}}:\boldsymbol{\mathbf{\varepsilon}}\,.\label{eq409}
\end{equation}

\end_inset

The Cauchy stress is now given in tensor form by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\lambda\left(\tr\boldsymbol{\varepsilon}\right)\mathbf{I}+2\mu\boldsymbol{\varepsilon}\,.\label{eq410}
\end{equation}

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Compressible Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Compressible-materials"

\end_inset

 
\end_layout

\begin_layout Subsection
Isotropic Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
The linear elastic material model as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Elasticity"

\end_inset

 is only valid for small strains and small rotations.
 A first modification to this model to the range of nonlinear deformations
 is given by the St.
 Venant-Kirchhoff model 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

, which in FEBio is referred to as 
\emph on
isotropic elasticity
\emph default
.
 This model is objective for large strains and rotations.
 For the isotropic case it can be derived from the following hyperelastic
 strain-energy function: 
\begin_inset Formula 
\begin{equation}
W=\frac{1}{2}\lambda\left(\tr\mathbf{E}\right)^{2}+\mu\mathbf{E}:\mathbf{E}\,.\label{eq411}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress can be derived from this: 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\frac{\partial W}{\partial\mathbf{E}}=\lambda\left(\tr\mathbf{E}\right)\mathbf{I}+2\mu\mathbf{E}\,.\label{eq412}
\end{equation}

\end_inset

Note that these equations are similar to the corresponding equations in
 the linear elastic case, except that the small strain tensor is replaced
 by the Green-Lagrange elasticity tensor 
\series bold

\begin_inset Formula $\mathbf{E}$
\end_inset


\series default
.
 The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\lambda\mathbf{I}\otimes\mathbf{I}+2\mu\mathbf{I}\odot\mathbf{I}\,.\label{eq413}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response can be somewhat strange if not completely
 unrealistic.
 For example, it can be shown that under uni-axial tension the stress becomes
 infinite and the volume tends to zero for finite strains.
 Therefore, for large strains it is highly recommended to avoid this material
 and instead use one of the other non-linear material models described below.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{J}\left(\lambda\tr\mathbf{E}-\mu\right)\mathbf{b}+\frac{\mu}{J}\mathbf{b}^{2}\,,\label{eq414}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tr\mathbf{E}=\left(\tr\mathbf{b}-3\right)/2$
\end_inset

 , whereas the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{\lambda}{J}\mathbf{b}\otimes\mathbf{b}+\frac{2}{J}\mu\mathbf{b}\odot\mathbf{b}\,.\label{eq415}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Orthotropic Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthotropic-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
An extension of the St.
 Venant-Kirchhoff model 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

 to orthotropic symmetry is provided in FEBio, referred to as 
\emph on
orthotropic elasticity
\emph default
.
 This model is objective for large strains and rotations.
 It can be derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\begin{equation}
W=\sum\limits _{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{0}:\mathbf{E}^{2}+\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\,,\label{eq416}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}^{0}=\mathbf{a}_{a}^{0}\otimes\mathbf{a}_{a}^{0}$
\end_inset

 is the structural tensor corresponding to one of the three mutually orthogonal
 planes of symmetry whose unit outward normal is 
\begin_inset Formula $\mathbf{a}_{a}^{0}$
\end_inset

 (
\begin_inset Formula $\mathbf{a}_{a}^{0}\cdot\mathbf{a}_{b}^{0}=\delta_{ab}$
\end_inset

).
 The material constants are the three shear moduli 
\begin_inset Formula $\mu_{a}$
\end_inset

 and six moduli 
\begin_inset Formula $\lambda_{ab}$
\end_inset

, where 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab}$
\end_inset

.
 They may be related to the Young's moduli 
\begin_inset Formula $E_{a}$
\end_inset

, shear moduli 
\begin_inset Formula $G_{ab}$
\end_inset

 and Poisson's ratios 
\begin_inset Formula $\nu_{ab}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\begin{array}{l}
\left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \left(\mu_{1}+\mu_{2}\right)/2 & 0 & 0\\
0 & 0 & 0 & 0 & \left(\mu_{2}+\mu_{3}\right)/2 & 0\\
0 & 0 & 0 & 0 & 0 & \left(\mu_{3}+\mu_{1}\right)/2
\end{array}\right]^{-1}=\\
\left[\begin{array}{cccccc}
1/E_{1} & -\nu_{12}/E_{1} & -\nu_{13}/E_{1} & 0 & 0 & 0\\
-\nu_{21}/E_{2} & 1/E_{2} & -\nu_{23}/E_{2} & 0 & 0 & 0\\
-\nu_{31}/E_{3} & -\nu_{32}/E_{3} & 1/E_{3} & 0 & 0 & 0\\
0 & 0 & 0 & 1/G_{12} & 0 & 0\\
0 & 0 & 0 & 0 & 1/G_{23} & 0\\
0 & 0 & 0 & 0 & 0 & 1/G_{31}
\end{array}\right]\,.
\end{array}\label{eq417}
\end{equation}

\end_inset

The second Piola-Kirchhoff stress can be derived from this strain energy
 density function: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =\frac{\partial W}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\cdot\mathbf{E}+\mathbf{E}\cdot\mathbf{A}_{a}^{0}\right)\\
 & +\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left[\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{b}^{0}+\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\mathbf{A}_{a}^{0}\right]\,.
\end{aligned}
\label{eq418}
\end{equation}

\end_inset

Note that these equations are similar to the corresponding equations in
 the linear orthotropic elastic case, except that the small strain tensor
 is replaced by the Green-Lagrange elasticity tensor 
\begin_inset Formula $\mathbf{E}$
\end_inset

.
 The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\odot\mathbf{I}+\mathbf{I}\odot\mathbf{A}_{a}^{0}\right)+\frac{1}{2}\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{b}^{0}+\mathbf{A}_{b}^{0}\otimes\mathbf{A}_{a}^{0}\right)\,.\label{eq419}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response can be somewhat strange if not completely
 unrealistic.
 For example, it can be shown that under uni-axial tension the stress becomes
 infinite and the volume tends to zero for finite strains.
 Therefore, for large strains it is highly recommended to avoid this material
 and instead use one of the other non-linear material models described below.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\sigma} & =\sum\limits _{a=1}^{3}\frac{\mu_{a}}{2J}\left(\mathbf{A}_{a}\cdot\left(\mathbf{b}-\mathbf{I}\right)+\left(\mathbf{b}-\mathbf{I}\right)\cdot\mathbf{A}_{a}\right)\\
 & +\frac{1}{2}\sum\limits _{b=1}^{3}\frac{\lambda_{ab}}{2J}\left[\left(\mathbf{A}_{a}:\mathbf{I}-1\right)\mathbf{A}_{b}+\left(\mathbf{A}_{b}:\mathbf{I}-1\right)\mathbf{A}_{a}\right]\,,
\end{aligned}
\label{eq420}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}=\mathbf{F}\cdot\mathbf{A}_{a}^{0}\cdot\mathbf{F}^{T}$
\end_inset

 and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\sum\limits _{a=1}^{3}\frac{\mu_{a}}{J}\left(\mathbf{A}_{a}\odot\mathbf{b}+\mathbf{b}\odot\mathbf{A}_{a}\right)+\frac{1}{2}\sum\limits _{b=1}^{3}\frac{\lambda_{ab}}{J}\left({\mathbf{A}_{a}\otimes\mathbf{A}_{b}+\mathbf{A}_{b}\otimes\mathbf{A}_{a}}\right)\,.\label{eq421}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Neo-Hookean Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Neo-Hookean-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This is a compressible neo-Hookean material.
 It is derived from the following hyperelastic strain energy function 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
W=\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln J+\frac{\lambda}{2}\left(\ln J\right)^{2}\,.\label{eq422}
\end{equation}

\end_inset

The parameters 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 are the Lamé parameters from linear elasticity.
 This model reduces to the isotropic linear elastic model for small strains
 and rotations.
\end_layout

\begin_layout Standard
The Cauchy stress is given by, 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{\mu}{J}\left(\mathbf{b}-\mathbf{I}\right)+\frac{\lambda}{J}\left(\ln J\right)\mathbf{I}\,,\label{eq423}
\end{equation}

\end_inset

and the spatial elasticity tensor is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{\lambda}{J}\mathbf{I}\otimes\mathbf{I}+\frac{2}{J}\left(\mu-\lambda\ln J\right)\mathbf{I}\odot\mathbf{I}\,.\label{eq424}
\end{equation}

\end_inset

The neo-Hookean material is an extension of Hooke's law for the case of
 large deformations.
 It is useable for certain plastics and rubber-like substances.
 A generalization of this model is the Mooney-Rivlin material, which is
 often used to describe the elastic response of biological tissue.
\end_layout

\begin_layout Standard
In FEBio this constitutive model uses a standard displacement-based element
 formulation and a "coupled" strain energy, so care must be taken when modeling
 materials with nearly-incompressible material behavior to avoid element
 locking.
\end_layout

\begin_layout Subsection
Natural Neo-Hookean
\begin_inset CommandInset label
LatexCommand label
name "subsec:Natural-Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
This is a compressible isotropic neo-Hookean material that uses the natural
 (Hencky) strain tensor invariants to formulate its strain energy density.
 These invariants are reviewed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Criscione00"
literal "false"

\end_inset

.
 The left Hencky strain is evaluated from 
\begin_inset Formula $\boldsymbol{\eta}=\ln\mathbf{V}$
\end_inset

 where 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is the left stretch tensor in the polar decomposition of the deformation
 gradient 
\begin_inset Formula $\mathbf{F}=\mathbf{V}\cdot\mathbf{R}$
\end_inset

.
 To evaluate 
\begin_inset Formula $\boldsymbol{\eta}$
\end_inset

 we first evaluate the left Cauchy-Green tensor 
\begin_inset Formula $\mathbf{b}=\mathbf{V}^{2}$
\end_inset

 from 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:left-Cauchy-Green"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and get its eigenvalues 
\begin_inset Formula $\lambda_{i}^{2}$
\end_inset

 and eigenvectors 
\begin_inset Formula $\mathbf{n}_{i}$
\end_inset

.
 Then
\begin_inset Formula 
\begin{equation}
\boldsymbol{\eta}=\sum_{i=1}^{3}\left(\ln\lambda_{i}\right)\mathbf{n}_{i}\otimes\mathbf{n}_{i}\,.\label{eq:left-Hencky}
\end{equation}

\end_inset

The invariants 
\begin_inset Formula $K_{i}$
\end_inset

 of the natural strain tensor are
\begin_inset Formula 
\begin{equation}
\begin{aligned}K_{1} & =\tr\boldsymbol{\eta}=\ln J & \text{amount of dilatation}\\
K_{2} & =\left|\dev\boldsymbol{\eta}\right|=\sqrt{\dev\boldsymbol{\eta}:\dev\boldsymbol{\eta}} & \text{amount of distortion}\\
K_{3} & =3\sqrt{6}\det\boldsymbol{\Phi} & \text{mode of distortion}
\end{aligned}
\label{eq:Hencky-isotropic-invariants}
\end{equation}

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 as usual, and
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Phi}=\frac{1}{K_{2}}\dev\boldsymbol{\eta}\,.\label{eq:Hencky-3rd-basis}
\end{equation}

\end_inset

It can be shown that
\begin_inset Formula 
\begin{equation}
\boldsymbol{\eta}=\frac{1}{3}K_{1}\mathbf{I}+K_{2}\boldsymbol{\Phi}\,.\label{eq:left-Hencky-redux}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $K_{2}\boldsymbol{\Phi}\to\mathbf{0}$
\end_inset

 as 
\begin_inset Formula $K_{2}\to0$
\end_inset

.
 It also follows that 
\begin_inset Formula $\boldsymbol{\eta}:\boldsymbol{\eta}=\frac{1}{3}K_{1}^{2}+K_{2}^{2}$
\end_inset

.
 As explained in 
\begin_inset CommandInset citation
LatexCommand citep
key "Criscione00"
literal "false"

\end_inset

, 
\begin_inset Formula $K_{1}\in\left(-\infty,\infty\right)$
\end_inset

 with positive 
\begin_inset Formula $K_{1}$
\end_inset

 implying expansion and negative 
\begin_inset Formula $K_{1}$
\end_inset

 implying contraction.
 Similarly, 
\begin_inset Formula $K_{2}\in[0,\infty)$
\end_inset

, with 
\begin_inset Formula $K_{2}=0$
\end_inset

 implying no distortion.
 Finally, 
\begin_inset Formula $K_{3}\in\left[-1,1\right]$
\end_inset

 with 
\begin_inset Formula $K_{3}=1$
\end_inset

 representing uniaxial extension, 
\begin_inset Formula $K_{3}=-1$
\end_inset

 representing uniaxial contraction and 
\begin_inset Formula $K_{3}=0$
\end_inset

 representing pure shear.
\end_layout

\begin_layout Standard
For the natural neo-Hookean material the strain energy density is
\begin_inset Formula 
\begin{equation}
W=\frac{\kappa}{2}K_{1}^{2}+\mu K_{2}^{2}\label{eq:NNH-sed}
\end{equation}

\end_inset

where 
\begin_inset Formula $\kappa$
\end_inset

 is the material's bulk modulus and 
\begin_inset Formula $\mu$
\end_inset

 is its shear modulus.
 To evaluate the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and spatial elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

, we use the framework of isotropic elasticity in principal directions (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Isotropic-Elasticity-Principal"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 This requires us to express 
\begin_inset Formula $K_{1}$
\end_inset

 and 
\begin_inset Formula $K_{2}$
\end_inset

 in terms of the eigenvalues 
\begin_inset Formula $\lambda_{i}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\begin{aligned}K_{1} & =\ln\left(\lambda_{1}\lambda_{2}\lambda_{3}\right)\\
K_{2} & =\frac{1}{3}\sqrt{\left(\ln\frac{\lambda_{1}^{2}}{\lambda_{2}\lambda_{3}}\right)^{2}+\left(\ln\frac{\lambda_{2}^{2}}{\lambda_{3}\lambda_{1}}\right)^{2}+\left(\ln\frac{\lambda_{3}^{2}}{\lambda_{1}\lambda_{2}}\right)^{2}}
\end{aligned}
\,.\label{eq:NNH-invariants}
\end{equation}

\end_inset

Now the stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IEPD-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where, based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IEPD-principal-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the principal normal stresses are evaluated as
\begin_inset Formula 
\begin{equation}
\sigma_{i}=\frac{1}{3J}\left[\left(3\kappa+4\mu\right)\ln\lambda_{i}+\left(3\kappa-2\mu\right)\left(\ln\lambda_{j}+\ln\lambda_{k}\right)\right]\,,\label{eq:NNH-principal-stress}
\end{equation}

\end_inset

with 
\begin_inset Formula $i,j,k$
\end_inset

 forming a permutation over 
\begin_inset Formula $1,2,3$
\end_inset

.
 Similarly, the spatial elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IEPD-elasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where we substitute
\begin_inset Formula 
\begin{equation}
J^{-1}\lambda_{i}^{2}\frac{\partial^{2}W}{\partial\lambda_{i}^{2}}-\sigma_{i}=\frac{1}{3J}\left[\left(3\kappa+4\mu\right)\left(1-2\ln\lambda_{i}\right)-2\left(3\kappa-2\mu\right)\left(\ln\lambda_{j}+\ln\lambda_{k}\right)\right]\label{eq:NNH-elasticity-coef1}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
J^{-1}\lambda_{j}\lambda_{k}\frac{\partial^{2}W}{\partial\lambda_{j}\partial\lambda_{k}}=\frac{3\kappa-2\mu}{3J}\,.\label{eq:NNH-elasticity-coef2}
\end{equation}

\end_inset

Finally, in the limiting case when pairs of eigenvalues are repeated, we
 substitute
\begin_inset Formula 
\begin{equation}
\lim_{\lambda_{k}^{2}\to\lambda_{j}^{2}}2\frac{\lambda_{k}^{2}\sigma_{j}-\lambda_{j}^{2}\sigma_{k}}{\lambda_{j}^{2}-\lambda_{k}^{2}}=\frac{2\mu}{J}-\frac{4\left(3\kappa+\mu\right)\ln\lambda_{j}+2\left(3\kappa-2\mu\right)\ln\lambda_{i}}{3J}\,.\label{eq:NNH-elasticity-coef3}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Ogden Unconstrained
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
The Ogden unconstrained material is defined using the following hyperelastic
 strain energy function: 
\begin_inset Formula 
\begin{equation}
W\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)=\frac{1}{2}c_{p}\left(J-1\right)^{2}+\sum\limits _{k=1}^{N}\frac{c_{k}}{m_{k}^{2}}\left(\lambda_{1}^{m_{k}}+\lambda_{2}^{m_{k}}+\lambda_{3}^{m_{k}}-3-m_{k}\ln J\right)\,.\label{eq425}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\lambda_{i}$
\end_inset

 are the principal stretches and 
\begin_inset Formula $c_{p}$
\end_inset

, 
\begin_inset Formula $c_{k}$
\end_inset

 and 
\begin_inset Formula $m_{k}$
\end_inset

 are material parameters.
\end_layout

\begin_layout Standard
The Cauchy stress tensor for this material may be obtained using the general
 formula for isotropic elasticity in principal directions given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IEPD-stress"

\end_inset

, with 
\begin_inset Formula 
\begin{equation}
\sigma_{i}=c_{p}\left(J-1\right)+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left(\lambda_{i}^{m_{k}}-1\right)\,.\label{eq426}
\end{equation}

\end_inset

Similarly, the spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\sum\limits _{i=1}^{3}\left(c_{p}+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left[\left(m_{k}-2\right)\lambda_{i}^{m_{k}}+2\right]\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}c_{p}\left(2J-1\right)\left(\mathbf{a}_{i}\otimes\mathbf{a}_{j}+\mathbf{a}_{j}\otimes\mathbf{a}_{i}\right)\\
 & +\sum\limits _{i=1}^{3}\sum\limits _{j=i+1}^{3}2\frac{\lambda_{j}^{2}\sigma_{i}-\lambda_{i}^{2}\sigma_{j}}{\lambda_{i}^{2}-\lambda_{j}^{2}}\left(\mathbf{a}_{i}\odot\mathbf{a}_{j}+\mathbf{a}_{j}\odot\mathbf{a}_{i}\right)\,,
\end{aligned}
\label{eq427}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}_{i}=\mathbf{n}_{i}\otimes\mathbf{n}_{i}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{i}$
\end_inset

 are the eigenvectors of 
\begin_inset Formula $\mathbf{b}$
\end_inset

.
 In the limit when eigenvalues coincide, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\lambda_{j}\to\lambda_{i}}2\frac{\sigma_{i}\lambda_{j}^{2}-\sigma_{j}\lambda_{i}^{2}}{\lambda_{i}^{2}-\lambda_{j}^{2}}=2c_{p}\left(1-J\right)+\sum\limits _{k=1}^{N}\frac{1}{J}\frac{c_{k}}{m_{k}}\left[2+\left(m_{k}-2\right)\lambda_{i}^{m_{k}}\right]\,.\label{eq428}
\end{equation}

\end_inset

In the reference configuration the elasticity tensor reduces to 
\begin_inset Formula 
\begin{equation}
\left.\boldsymbol{\mathcal{C}}\right|_{\mathbf{b}=\mathbf{I}}=c_{p}\mathbf{I}\otimes\mathbf{I}+\left(\sum\limits _{k=1}^{N}c_{k}\right)\mathbf{I}\odot\mathbf{I}\,,\label{eq429}
\end{equation}

\end_inset

which has the form of Hooke's law for infinitesimal isotropic elasticity
 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Elasticity"

\end_inset

), with equivalent Lamé coefficients 
\begin_inset Formula $c_{p}\equiv\lambda$
\end_inset

 and 
\begin_inset Formula $2\mu\equiv\sum\nolimits _{k=1}^{N}c_{k}$
\end_inset

.
\end_layout

\begin_layout Subsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow"

\end_inset


\end_layout

\begin_layout Standard
The coupled hyperelastic strain-energy function for this material is given
 by 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\Psi\left(I_{1},I_{2},J\right)=\frac{1}{2}c\left(e^{Q}-1\right)\,,\label{eq430}
\end{equation}

\end_inset

where 
\begin_inset Formula $I_{1}$
\end_inset

and 
\begin_inset Formula $I_{2}$
\end_inset

are the first and second invariants of the right Cauchy-Green tensor and
 
\begin_inset Formula $J$
\end_inset

the jacobian of the deformation.
 Furthermore, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Q & =\frac{\beta}{\lambda+2\mu}\left[\left(2\mu-\lambda\right)\left(I_{1}-3\right)+\lambda\left(I_{2}-3\right)-\left(\lambda+2\mu\right)\ln J^{2}\right]\,,\\
c & =\frac{\lambda+2\mu}{2\beta}\,,
\end{aligned}
\label{eq431}
\end{equation}

\end_inset

and 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are the Lamé parameters.
 The corresponding Cauchy stress tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\frac{1}{2J}e^{Q}\left(\left[2\mu+\lambda\left(I_{1}-1\right)\right]\mathbf{b}-\lambda\mathbf{b}^{2}-\left(\lambda+2\mu\right)\mathbf{I}\right)\,,\label{eq432}
\end{equation}

\end_inset

and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\frac{4\beta}{\lambda+2\mu}Je^{-Q}\boldsymbol{\sigma}\otimes\boldsymbol{\sigma}+J^{-1}e^{Q}\left[\lambda\left(\mathbf{b}\otimes\mathbf{b}-\mathbf{b}\odot\mathbf{b}\right)+\left(\lambda+2\mu\right)\mathbf{I}\odot\mathbf{I}\right]\,.\label{eq433}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Conewise Linear Elasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Conewise-Linear-Elasticity"

\end_inset


\end_layout

\begin_layout Standard
Curnier et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"
literal "true"

\end_inset

 formulated a model for describing bimodular elastic solids exhibiting orthotrop
ic material symmetry.
 This can be derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\begin{equation}
W=\sum\limits _{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{0}:\mathbf{E}^{2}+\frac{1}{2}\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)+\sum\limits _{b=1,\,b\ne a}^{3}\frac{1}{2}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{0}:\mathbf{E}\right)\,,\label{eq434}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}^{0}=\mathbf{a}_{a}^{0}\otimes\mathbf{a}_{a}^{0}$
\end_inset

 is the structural tensor corresponding to one of the three mutually orthogonal
 planes of symmetry whose unit outward normal is 
\begin_inset Formula $\mathbf{a}_{a}^{0}$
\end_inset

 (
\begin_inset Formula $\mathbf{a}_{a}^{0}\cdot\mathbf{a}_{b}^{0}=\delta_{ab})$
\end_inset

.
 The bimodular response is described by 
\begin_inset Formula 
\begin{equation}
\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]=\begin{cases}
\lambda_{+aa} & \mathbf{A}_{a}^{0}:\mathbf{E}\geqslant0\\
\lambda_{-aa} & \mathbf{A}_{a}^{0}:\mathbf{E}<0
\end{cases}\,.\label{eq435}
\end{equation}

\end_inset

The material constants are the three shear moduli 
\begin_inset Formula $\mu_{a}$
\end_inset

, three tensile moduli 
\begin_inset Formula $\lambda_{+aa}$
\end_inset

, three compressive moduli 
\begin_inset Formula $\lambda_{-aa}$
\end_inset

, and three moduli 
\begin_inset Formula $\lambda_{ab}$
\end_inset

 (
\begin_inset Formula $b\ne a)$
\end_inset

, where 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab}$
\end_inset

.
 The second Piola-Kirchhoff stress can be derived from this strain energy
 density function: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S} & =\frac{\partial W}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\cdot\mathbf{E}+\mathbf{E}\cdot\mathbf{A}_{a}^{0}\right)\\
 & +\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{a}^{0}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\left(\mathbf{A}_{a}^{0}:\mathbf{E}\right)\mathbf{A}_{b}^{0}\,.
\end{aligned}
\label{eq436}
\end{equation}

\end_inset

The material elasticity tensor is then given by, 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \boldsymbol{\mathbb{C}}=\frac{\partial\mathbf{S}}{\partial\mathbf{E}}=\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}^{0}\odot\mathbf{I}+\mathbf{I}\odot\mathbf{A}_{a}^{0}\right)\\
 & +\lambda_{aa}\left[\mathbf{A}_{a}^{0}:\mathbf{E}\right]\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{a}^{0}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\mathbf{A}_{a}^{0}\otimes\mathbf{A}_{b}^{0}
\end{aligned}
\,.\label{eq437}
\end{equation}

\end_inset

It is important to note that although this model is objective, it should
 only be used for small strains.
 For large strains, the response may be unrealistic.
 The Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\sigma} & =J^{-1}\left(\sum\limits _{a=1}^{3}\frac{\mu_{a}}{2}\left(\mathbf{A}_{a}\cdot\left(\mathbf{b}-\mathbf{I}\right)+\left(\mathbf{b}-\mathbf{I}\right)\cdot\mathbf{A}_{a}\right)\right.\\
 & \left.+\lambda_{aa}\left[K_{a}\right]K_{a}\mathbf{A}_{a}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}K_{a}\mathbf{A}_{b}\right)\,,
\end{aligned}
\label{eq438}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{a}=\mathbf{F}\cdot\mathbf{A}_{a}^{0}\cdot\mathbf{F}^{T}$
\end_inset

 and 
\begin_inset Formula $K_{a}=\frac{1}{2}\left({\mathbf{A}_{a}:\mathbf{I}-1}\right)$
\end_inset

.
 The spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=J^{-1}\left(\sum\limits _{a=1}^{3}\mu_{a}\left(\mathbf{A}_{a}\odot\mathbf{b}+\mathbf{b}\odot\mathbf{A}_{a}\right)+\lambda_{aa}\left[K_{a}\right]\mathbf{A}_{a}\otimes\mathbf{A}_{a}+\sum\limits _{b=1,\,b\ne a}^{3}\lambda_{ab}\mathbf{A}_{a}\otimes\mathbf{A}_{b}\right)\,.\label{eq439}
\end{equation}

\end_inset

In the special case of cubic symmetry the number of material constants reduces
 to four, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{+11} & =\lambda_{+22}=\lambda_{+33}\equiv\lambda_{+1}\\
\lambda_{-11} & =\lambda_{-22}=\lambda_{-33}\equiv\lambda_{-1}\\
\lambda_{12} & =\lambda_{23}=\lambda_{31}\equiv\lambda_{2}\\
\mu_{1} & =\mu_{2}=\mu_{3}\equiv\mu
\end{aligned}
\,.\label{eq440}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Donnan-Equilibrium-Swelling-1"

\end_inset


\end_layout

\begin_layout Standard
The swelling pressure is described by the equations for ideal Donnan equilibrium
, assuming that the material is porous, with a charged solid matrix, and
 the external bathing environment consists of a salt solution of monovalent
 counter-ions.
 Since osmotic swelling must be resisted by a solid material, this material
 is not stable on its own.
 It must be combined with an elastic material that resists the swelling.
\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the Donnan equilibrium
 response 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09a"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-\pi\,\mathbf{I}\,,\label{eq441}
\end{equation}

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure, given by 
\begin_inset Formula 
\begin{equation}
\pi=R\theta\left(\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right),\label{eq442}
\end{equation}

\end_inset


\begin_inset Formula $\bar{c}^{*}$
\end_inset

 is the bath osmolarity (twice the concentration) and 
\begin_inset Formula $c^{F}$
\end_inset

 is the fixed charge density in the current configuration, related to the
 reference configuration via, 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}c_{0}^{F}\,,\label{eq443}
\end{equation}

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant and 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 may be negative or positive.
 The gel porosity 
\begin_inset Formula $\varphi_{0}^{w}$
\end_inset

 is unitless and must be in the range 
\begin_inset Formula $0<\varphi_{0}^{w}<1$
\end_inset

.
 The corresponding spatial elasticity tensor is 
\begin_inset CommandInset citation
LatexCommand citep
key "Azeloglu08"
literal "true"

\end_inset

 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =\frac{R\theta J\left(c^{F}\right)^{2}}{\left(J-1+\varphi_{0}^{w}\right)\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}}\mathbf{I}\otimes\mathbf{I}\\
 & +R\theta\left[\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right]\left(2\mathbf{I}\odot\mathbf{I}-\mathbf{I}\otimes\mathbf{I}\right)\,.
\end{aligned}
\label{eq444}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Perfect Osmometer Equilibrium Osmotic Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perfect-Osmometer-Equilibrium"

\end_inset


\end_layout

\begin_layout Standard
The swelling pressure is described by the equations for a perfect osmometer,
 assuming that the material is porous, containing an interstitial solution
 whose solutes cannot be exchanged with the external bathing environment.
 Similarly, solutes in the external bathing solution cannot be exchanged
 with the interstitial fluid of the porous material.
 Therefore, osmotic pressurization occurs when there is an imbalance between
 the interstitial and bathing solution osmolarities.
 Since osmotic swelling must be resisted by a solid matrix, this material
 is not stable on its own.
 It must be combined with an elastic material that resists the swelling.
\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the perfect osmometer
 equilibrium response 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian06"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-\pi\,\mathbf{I}\,,\label{eq445}
\end{equation}

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure, given by 
\begin_inset Formula 
\begin{equation}
\pi=R\theta\left(\bar{c}-\bar{c}^{\ast}\right)\,.\label{eq446}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant and 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature, 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset

 is the external bath osmolarity and 
\begin_inset Formula $\bar{c}$
\end_inset

 is the interstitial fluid osmolarity in the current configuration, related
 to the reference configuration osmolarity 
\begin_inset Formula $\bar{c}_{0}$
\end_inset

 via, 
\begin_inset Formula 
\begin{equation}
\bar{c}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}\bar{c}_{0}\,.\label{eq447}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Though this material is porous, this is not a full-fledged poroelastic material.
 The behavior described by this material is strictly valid only after the
 transient response of interstitial fluid and solute fluxes has subsided.
 The corresponding spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=R\theta\left[\frac{J\,\bar{c}}{J-1+\varphi_{0}^{w}}\mathbf{I}\otimes\mathbf{I}+\left(\bar{c}-\bar{c}^{\ast}\right)\left(2\mathbf{I}\odot\mathbf{I}-\mathbf{I}\otimes\mathbf{I}\right)\right]\,.\label{eq448}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Large Poisson's Ratio Ligament
\begin_inset CommandInset label
LatexCommand label
name "subsec:Large-Poisson-Ratio-Lig"

\end_inset


\end_layout

\begin_layout Standard
This material captures the transversely isotropic behavior of tendon and
 ligaments while enforcing a large Poisson's ratio.
 The material utilizes a three part strain energy equation: 
\begin_inset Formula 
\[
W=W_{\text{fiber}}+W_{\text{matrix}}+W_{\text{vol}}\,,
\]

\end_inset

where: 
\begin_inset Formula 
\[
\begin{aligned}W_{\text{fiber}} & =\frac{1}{2}\frac{c_{1}}{c_{2}}\left(e^{c_{2}\left(\lambda-1\right)^{2}-1}\right)\,,\\
W_{\text{matrix}} & =\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln\left(\sqrt{I_{3}}\right)\,,\\
W_{\text{vol}} & =\frac{\kappa}{2}\left(\ln\left(\frac{I_{5}-I_{1}I_{4}+I_{2}}{I_{4}^{2(m-v_{0})}e^{-4m\left(\lambda-1\right)}}\right)\right)^{2}\,.
\end{aligned}
\]

\end_inset

The transversely isotropic strain energy 
\begin_inset Formula $W_{\text{fiber}}$
\end_inset

 takes into account the behavior of the collagen fibers.
 The isotropic strain energy 
\begin_inset Formula $W_{\text{matrix}}$
\end_inset

 takes into account the mechanical contribution of the extrafibrillar matrix
 and provides the majority of support when loaded transverse to the fiber
 direction.
 The variables 
\begin_inset Formula $c_{\mathrm{1}}$
\end_inset

, 
\begin_inset Formula $c_{2}$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are material parameters controlling the stress-strain response of the material.
\end_layout

\begin_layout Standard
The volumetric strain energy 
\begin_inset Formula $W_{\text{vol}}$
\end_inset

 acts as a penalty term which enforces a Poisson's ratio based on user selection
 of the parameters 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $v_{\mathrm{0}}$
\end_inset

.
 The variable 
\begin_inset Formula $\kappa$
\end_inset

 acts as a penalty parameter.
 Raising 
\begin_inset Formula $\kappa$
\end_inset

 will cause the prescribed Poisson's ratio to be enforced.
 The Poisson's ratio in question is given by the following function: 
\begin_inset Formula 
\[
v_{\text{apparent}}=-\frac{\lambda^{m-v_{0}}e^{-m\left(\lambda-1\right)}-1}{\lambda-1}\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
Porous Neo-Hookean Material
\begin_inset CommandInset label
LatexCommand label
name "subsec:Porous-Neo-Hookean-Material"

\end_inset


\end_layout

\begin_layout Standard
Consider a porous neo-Hookean material with referential porosity 
\begin_inset Formula $\varphi_{r}^{w}$
\end_inset

.
 The pores are compressible but the skeleton is intrinsically incompressible.
 Thus, upon pore closure, the material behavior needs to switch from compressibl
e to incompressible.
\end_layout

\begin_layout Standard
In the current configuration, the porosity is given by
\begin_inset Formula 
\[
\varphi^{w}=\frac{J-1+\varphi_{r}^{w}}{J}\,.
\]

\end_inset

We may define a new variable,
\begin_inset Formula 
\[
\bar{J}\equiv\frac{J-1+\varphi_{r}^{w}}{\varphi_{r}^{w}}=\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\,,
\]

\end_inset

which represents the pore volume ratio.
 It is equal to 
\begin_inset Formula $1$
\end_inset

 when 
\begin_inset Formula $J=1$
\end_inset

 and is equal to 
\begin_inset Formula $J$
\end_inset

 when 
\begin_inset Formula $\varphi_{r}^{w}=1$
\end_inset

 (or 
\begin_inset Formula $\varphi_{r}^{s}=1-\varphi_{r}^{w}=0$
\end_inset

).
 Now,
\begin_inset Formula 
\[
\varphi^{w}=\varphi_{r}^{w}\frac{\bar{J}}{J}\,,
\]

\end_inset

and
\begin_inset Formula 
\[
\frac{\partial\bar{J}}{\partial J}=\frac{1}{\varphi_{r}^{w}}\,.
\]

\end_inset

Pore closure occurs when 
\begin_inset Formula $\varphi^{w}=0$
\end_inset

, which corresponds to 
\begin_inset Formula $J=\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $\bar{J}=0$
\end_inset

.
\end_layout

\begin_layout Standard
Let us also define a modified deformation gradient,
\begin_inset Formula 
\[
\bar{\mathbf{F}}=\left(\frac{\bar{J}}{J}\right)^{1/3}\mathbf{F}\,,
\]

\end_inset

such that 
\begin_inset Formula $\det\bar{\mathbf{F}}=\bar{J}$
\end_inset

.
 Let the corresponding modified right Cauchy-Green tensor be given by
\begin_inset Formula 
\[
\bar{\mathbf{C}}=\bar{\mathbf{F}}^{T}\cdot\bar{\mathbf{F}}=\left(\frac{\bar{J}}{J}\right)^{2/3}\mathbf{C}\,,
\]

\end_inset

so that
\begin_inset Formula 
\[
\frac{\partial\bar{\mathbf{C}}}{\partial\mathbf{C}}=\left(\frac{\bar{J}}{J}\right)^{2/3}\left(\frac{\varphi_{r}^{s}}{3\left(J-\varphi_{r}^{s}\right)}\mathbf{C}\otimes\mathbf{C}^{-1}+\mathbf{I}\odot\mathbf{I}\right)\,.
\]

\end_inset


\end_layout

\begin_layout Standard
The constitutive relation for the strain energy density of the compressible
 porous neo-Hookean material may be given by
\begin_inset Formula 
\[
\Psi_{r}=\frac{\mu}{2}\left(\bar{I}_{1}-3\right)-\mu\ln\bar{J}\,,
\]

\end_inset

where 
\begin_inset Formula $\bar{I}_{1}=\text{tr}\bar{\mathbf{C}}$
\end_inset

.
 This relation shows that the material develops an infinite strain energy
 density as 
\begin_inset Formula $\bar{J}$
\end_inset

 approaches zero.
 From this expression, the 2nd Piola-Kirchhoff stress is given by
\begin_inset Formula 
\[
\mathbf{S}=2\frac{\partial\Psi_{r}}{\partial\mathbf{C}}=\mu\left[\left(\frac{\bar{J}}{J}\right)^{2/3}\mathbf{I}+\frac{1}{J-\varphi_{r}^{s}}\left(\varphi_{r}^{s}\left(\frac{\bar{J}}{J}\right)^{2/3}\frac{I_{1}}{3}-J\right)\mathbf{C}^{-1}\right]\,.
\]

\end_inset

When 
\begin_inset Formula $\mathbf{C}=\mathbf{I}$
\end_inset

 we can verify that 
\begin_inset Formula $\mathbf{S}=\mathbf{0}$
\end_inset

.
 The corresponding Cauchy stress is
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\frac{\mu}{J}\left[\left(\frac{\bar{J}}{J}\right)^{2/3}\mathbf{b}+\frac{1}{J-\varphi_{r}^{s}}\left(\varphi_{r}^{s}\left(\frac{\bar{J}}{J}\right)^{2/3}\frac{I_{1}}{3}-J\right)\mathbf{I}\right]\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the left Cauchy-Green tensor.
\end_layout

\begin_layout Standard
The material elasticity tensor is given by
\begin_inset Formula 
\[
\begin{aligned}\mathbb{C} & =2\frac{\partial\mathbf{S}}{\partial\mathbf{C}}\\
 & =\frac{2}{3}g\left(J\right)\left(\mathbf{I}\otimes\mathbf{C}^{-1}+\mathbf{C}^{-1}\otimes\mathbf{I}\right)+\left(J\frac{dg}{dJ}\frac{I_{1}}{3}+J\frac{dh}{dJ}\right)\mathbf{C}^{-1}\otimes\mathbf{C}^{-1}\\
 & -2\left[g\left(J\right)\frac{I_{1}}{3}+h\left(J\right)\right]\mathbf{C}^{-1}\odot\mathbf{C}^{-1}
\end{aligned}
\,,
\]

\end_inset

where
\begin_inset Formula 
\[
\begin{aligned}f\left(J\right) & =\mu\left(\frac{\bar{J}}{J}\right)^{2/3}\\
g\left(J\right) & =\frac{\varphi_{r}^{s}}{J-\varphi_{r}^{s}}f\left(J\right)\\
h\left(J\right) & =-\mu\frac{J}{J-\varphi_{r}^{s}}
\end{aligned}
\,,
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}J\frac{dg}{dJ} & =\mu\frac{\left(2\varphi_{r}^{s}-3J\right)\varphi_{r}^{s}}{3\left(J-\varphi_{r}^{s}\right)^{2}}\left(\frac{\bar{J}}{J}\right)^{2/3}\\
J\frac{dh}{dJ} & =\mu\frac{J\varphi_{r}^{s}}{\left(J-\varphi_{r}^{s}\right)^{2}}
\end{aligned}
\,.
\]

\end_inset

Then, the spatial elasticity tensor may be evaluated as
\begin_inset Formula 
\[
\boldsymbol{\mathcal{C}}=J^{-1}\left[\frac{2}{3}g\left(J\right)\left(\mathbf{b}\otimes\mathbf{I}+\mathbf{I}\otimes\mathbf{b}\right)+\left(J\frac{dg}{dJ}\frac{I_{1}}{3}+J\frac{dh}{dJ}\right)\mathbf{I}\otimes\mathbf{I}-2\left[g\left(J\right)\frac{I_{1}}{3}+h\left(J\right)\right]\mathbf{I}\odot\mathbf{I}\right]\,.
\]

\end_inset


\end_layout

\begin_layout Standard
In the limit of infinitesimal strains and rotations, when 
\begin_inset Formula $\mathbf{b}=\mathbf{I}$
\end_inset

 and 
\begin_inset Formula $J=1$
\end_inset

, we find that
\begin_inset Formula 
\[
\begin{aligned}f\left(1\right) & =\mu & J\frac{dg}{dJ} & =\mu\frac{\left(2\varphi_{r}^{s}-3\right)\varphi_{r}^{s}}{3\left(1-\varphi_{r}^{s}\right)^{2}}\\
g\left(J\right) & =\mu\frac{\varphi_{r}^{s}}{1-\varphi_{r}^{s}} & J\frac{dh}{dJ} & =\mu\frac{\varphi_{r}^{s}}{\left(1-\varphi_{r}^{s}\right)^{2}}\\
h\left(J\right) & =-\mu\frac{1}{1-\varphi_{r}^{s}}\mu
\end{aligned}
\]

\end_inset

and
\begin_inset Formula 
\[
\boldsymbol{\mathcal{C}}=\frac{2\mu}{3}\left(\frac{1}{\left(\varphi_{r}^{w}\right)^{2}}-1\right)\mathbf{I}\otimes\mathbf{I}+2\mu\mathbf{I}\odot\mathbf{I}\,.
\]

\end_inset

Thus, by comparison to a standard neo-Hookean material, this porous neo-Hookean
 material has an effective Young's modulus equal to
\begin_inset Formula 
\[
E=\frac{3\mu}{1+\frac{1}{2}\left(\varphi_{r}^{w}\right)^{2}}\,,
\]

\end_inset

and an effective Poisson's ratio equal to
\begin_inset Formula 
\[
\nu=\frac{1-\left(\varphi_{r}^{w}\right)^{2}}{2+\left(\varphi_{r}^{w}\right)^{2}}\,.
\]

\end_inset

The two material properties that need to be provided are 
\begin_inset Formula $E$
\end_inset

 and the referential porosity 
\begin_inset Formula $\varphi_{r}^{w}$
\end_inset

 (or referential solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}=1-\varphi_{r}^{w}$
\end_inset

).
 Poisson's ratio in the limit of infinitesimal strains is dictated by the
 porosity according to the above formula.
 In particular, a highly porous material (
\begin_inset Formula $\varphi_{r}^{w}\to1$
\end_inset

) has an effective (infinitesimal strain) Poisson ratio that approaches
 zero (
\begin_inset Formula $\nu\to0$
\end_inset

) and 
\begin_inset Formula $E\to2\mu$
\end_inset

.
 A low porosity material (
\begin_inset Formula $\varphi_{r}^{w}\to0$
\end_inset

) has 
\begin_inset Formula $\nu\to\frac{1}{2}$
\end_inset

 and 
\begin_inset Formula $E\to3\mu$
\end_inset

, which is the expected behavior of an incompressible neo-Hookean solid.
 Note that setting 
\begin_inset Formula $\varphi_{r}^{w}=0$
\end_inset

 would not produce good numerical behavior, since the Cauchy stress in an
 incompressible material would need to be supplemented by a pressure term
 (a Lagrange multiplier that enforces the incompressibility constraint).
 Nevertheless, this compressible porous neo-Hookean material behaves well
 even for values of 
\begin_inset Formula $\varphi^{w}$
\end_inset

 as low as 
\begin_inset Formula $\sim0.015$
\end_inset

.
\end_layout

\begin_layout Subsection
Cell Growth
\end_layout

\begin_layout Standard
The cell growth material implements a swelling pressure 
\begin_inset Formula $\pi$
\end_inset

 such that the Cauchy stress is given by
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-\pi\mathbf{I}\,,
\]

\end_inset

where
\begin_inset Formula 
\[
\pi=RT\left(\frac{c_{r}}{J-\varphi_{r}^{s}}-c_{e}\right)\,.
\]

\end_inset

Here, 
\begin_inset Formula $c_{r}$
\end_inset

 represents the referential molar concentration of intracellular solutes
 (moles of solutes per mixture volume in the reference configuration), 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential intracellular solid volume fraction, and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the determinant of the deformation gradient, representing the volume
 ratio in the current configuration.
 The extracellular osmolarity is 
\begin_inset Formula $c_{e}$
\end_inset

.
 This model assumes that neither intracellular solutes nor extracellular
 solutes may transport across the cell membrane passively.
 When a cell divides, it must use active transport mechanisms to bring in
 membrane-impermeant extracellular solutes inside, some of which are converted
 into intracellular solid matrix (e.g., cytoskeletal structures).
 As the intracellular osmolarity increases, water is transported into the
 cell, thus causing it to swell.
 The process of cell division is not modeled explicitly in this continuum
 representation, though the net effect is that cell proliferation leads
 to an increase in intracellular osmotic pressure, which generally translates
 into an increase in volume (unless the cell growth is constrained significantly
).
 In a cell growth model, the initial condition (when 
\begin_inset Formula $J=1$
\end_inset

) should be selected for 
\begin_inset Formula $c_{r}$
\end_inset

 and 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 such that 
\begin_inset Formula $\pi=0$
\end_inset

, thus
\begin_inset Formula 
\[
\frac{c_{r}}{1-\varphi_{r}^{s}}=c_{e}\quad\text{initial condition}\,.
\]

\end_inset


\end_layout

\begin_layout Standard
The spatial elasticity tensor associated with this osmotic pressure is
\begin_inset Formula 
\[
\boldsymbol{\Pi}=-\left(\pi+J\frac{\partial\pi}{\partial J}\right)\mathbf{I}\otimes\mathbf{I}+2\pi\mathbf{I}\odot\mathbf{I}\,,
\]

\end_inset

where
\begin_inset Formula 
\[
J\frac{\partial\pi}{\partial J}=-RT\frac{J}{\left(J-\varphi_{r}^{s}\right)^{2}}c_{r}\,.
\]

\end_inset

This elasticity tensor has the same form as that of an isotropic elastic
 material whose effective Young's modulus 
\begin_inset Formula $E_{Y}$
\end_inset

 and Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 are given by
\begin_inset Formula 
\[
\begin{aligned}E_{Y} & =\pi\frac{\left(\pi+3J\frac{\partial\pi}{\partial J}\right)}{J\frac{\partial\pi}{\partial J}}\\
\nu & =\frac{\pi+J\frac{\partial\pi}{\partial J}}{2J\frac{\partial\pi}{\partial J}}
\end{aligned}
\,.
\]

\end_inset

In the reference configuration, when 
\begin_inset Formula $\pi=0$
\end_inset

, it follows that 
\begin_inset Formula $E_{Y}=0$
\end_inset

 and 
\begin_inset Formula $\nu=\frac{1}{2}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{m}+\tilde{\boldsymbol{\sigma}}_{f}\,.\label{eq471-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Fiber with Exponential Power Law
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Exponential-Power"

\end_inset


\end_layout

\begin_layout Standard
This material model describes a constitutive model for fibers, where a single
 fiber family follows an exponential power law strain energy function.
 The Cauchy stress is given by: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=2J^{-1}H\left(I_{n}-I_{0}\right)I_{n}\frac{\partial\Psi_{r}}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq:fepl-stress}
\end{equation}

\end_inset

and the corresponding spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=4J^{-1}H\left(I_{n}-I_{0}\right)I_{n}^{2}\frac{\partial^{2}\Psi_{r}}{\partial I_{n}^{2}}\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\,,\label{eq:fepl-elasticity}
\end{equation}

\end_inset

where 
\begin_inset Formula $I_{n}=\lambda_{n}^{2}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}$
\end_inset

 is the square of the fiber stretch, 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the fiber orientation in the reference configuration, 
\begin_inset Formula 
\begin{equation}
\mathbf{n}_{r}=\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3}\,,\label{eq:fepl-fiber-nr}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}/\lambda_{n}$
\end_inset

.
 The function 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 Thus, the stress and elasticity tensors are non-zero only when 
\begin_inset Formula $I_{n}>I_{0}$
\end_inset

, where 
\begin_inset Formula $I_{0}=\lambda_{0}^{2}$
\end_inset

 is the square of the stretch at which the fiber's tensile response engages.
 By default we may take 
\begin_inset Formula $I_{0}=1$
\end_inset

, though the actual value of 
\begin_inset Formula $I_{0}$
\end_inset

 may be set by the user.
 The fiber strain energy density is given by 
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{n}-I_{0}\right)^{\beta}\right]-1\right)\,,\label{eq:fepl-fiber-Psi}
\end{equation}

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

, 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
 From this expression we get
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{\partial\Psi_{r}}{\partial I_{n}} & =\xi\left(I_{n}-I_{0}\right)^{\beta-1}\exp\left[\alpha\left(I_{n}-I_{0}\right)^{\beta}\right]\\
\frac{\partial^{2}\Psi_{r}}{\partial I_{n}^{2}} & =\xi\left(\beta\left(1+\alpha\left(I_{n}-I_{0}\right)^{\beta}\right)-1\right)\left(I_{n}-I_{0}\right)^{\beta-2}\exp\left[\alpha\left(I_{n}-I_{0}\right)^{\beta}\right]
\end{aligned}
\,.\label{eq:fepl-fiber-dPsi}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note: In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

, this expression produces a power law, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\alpha\to0}\Psi_{r}=\frac{\xi}{\beta}\left(I_{n}-I_{0}\right)^{\beta}\,.\label{eq:fepl-Psi-alpha0}
\end{equation}

\end_inset

Note: According to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fepl-elasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fepl-fiber-dPsi"
plural "false"
caps "false"
noprefix "false"

\end_inset

, when 
\begin_inset Formula $\beta>2$
\end_inset

 the fiber modulus is zero at the strain origin (
\begin_inset Formula $I_{n}=I_{0})$
\end_inset

.
 Therefore, use 
\begin_inset Formula $\beta>2$
\end_inset

 when a smooth transition in the stress is desired from compression to tension.
\end_layout

\begin_layout Standard
There is an option to also add a shear modulus 
\begin_inset Formula $\mu$
\end_inset

 to account for the interaction of a fiber with the ground matrix.
 This additional contribution does not depend on whether the fiber is in
 tension.
 It has a strain energy density
\begin_inset Formula 
\begin{equation}
W=\frac{\mu}{4}\left(K_{n}-1-2\left(I_{n}-1\right)\right)\,,\quad K_{n}=\mathbf{n}_{r}\cdot\mathbf{C}^{2}\cdot\mathbf{n}_{r}\label{eq:fepl-shear-sed}
\end{equation}

\end_inset

The corresponding stress is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\sigma} & =2\frac{I_{n}}{J}\left(\frac{\partial W}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}+\frac{\partial W}{\partial K_{n}}\left(\mathbf{n}\otimes\mathbf{n}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{n}\otimes\mathbf{n}\right)\right)\\
 & =\frac{\mu}{2}\frac{I_{n}}{J}\left(\mathbf{n}\otimes\mathbf{n}\cdot\left(\mathbf{b}-\mathbf{I}\right)+\left(\mathbf{b}-\mathbf{I}\right)\cdot\mathbf{n}\otimes\mathbf{n}\right)
\end{aligned}
\label{eq:fepl-shear-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 The elasticity tensor is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}} & =4\frac{I_{n}^{2}}{J}\left(\frac{\partial^{2}W}{\partial I_{n}^{2}}\mathbf{N}\otimes\mathbf{N}+\frac{\partial^{2}W}{\partial K_{n}^{2}}\left(\mathbf{N}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{N}\right)\otimes\left(\mathbf{N}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{N}\right)\right)\\
 & +4\frac{I_{n}^{2}}{J}\frac{\partial^{2}W}{\partial I_{n}\partial K_{n}}\left(\mathbf{N}\otimes\left(\mathbf{N}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{N}\right)+\left(\mathbf{N}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{N}\right)\otimes\mathbf{N}\right)\\
 & +\frac{4I_{n}}{J}\frac{\partial W}{\partial K_{n}}\left(\mathbf{N}\odot\mathbf{b}+\mathbf{b}\odot\mathbf{N}\right)\\
 & =\mu\frac{I_{n}}{J}\left(\mathbf{N}\odot\mathbf{b}+\mathbf{b}\odot\mathbf{N}\right)
\end{aligned}
\,,\label{eq:fepl-shear-elasticity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{N}=\mathbf{n}\otimes\mathbf{n}$
\end_inset

.
\end_layout

\begin_layout Subsection
Fiber with Natural Neo-Hookean Response
\end_layout

\begin_layout Standard
This model is an adaptation of the natural neo-Hookean material presented
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "subsec:Natural-Neo-Hookean"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Consider that the state of strain in a fiber is given by the unidirectional
 natural (left Hencky) strain along the fiber,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\eta}=\ln\lambda_{n}\,\mathbf{n}\otimes\mathbf{n}\label{eq:fnh-strain}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{n}$
\end_inset

 is the stretch ratio along the current fiber unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 For this special state of strain the invariants 
\begin_inset Formula $K_{i}$
\end_inset

 of the natural strain tensor reduce to 
\begin_inset Formula $K_{1}=\ln\lambda_{n}$
\end_inset

, 
\begin_inset Formula $K_{2}=\sqrt{3/2}\ln\lambda_{n}$
\end_inset

, and 
\begin_inset Formula $K_{3}=1$
\end_inset

.
 In this case, a natural neo-Hookean fiber response is given by
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\frac{\xi}{2}H\left(\ln\lambda_{n}\right)\left(\ln\lambda_{n}\right)^{2}\,.\label{eq:fnh-sed}
\end{equation}

\end_inset

The corresponding Cauchy stress is
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\xi J^{-1}H\left(\ln\lambda_{n}\right)\ln\lambda_{n}\mathbf{n}\otimes\mathbf{n}\label{eq:fnh-stress}
\end{equation}

\end_inset

and the elasticity tensor is
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\xi J^{-1}H\left(\ln\lambda_{n}\right)\left(1-2\ln\lambda_{n}\right)\mathbf{N}\otimes\mathbf{N}\label{eq:fnh-elasticity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\xi$
\end_inset

 is the fiber modulus.
 This expression shows that the components of the elasticity tensor become
 negative when 
\begin_inset Formula $1-2\ln\lambda_{n}<0$
\end_inset

, or equivalently when 
\begin_inset Formula $\lambda_{n}>e^{\frac{1}{2}}$
\end_inset

.
 However, the stress always remains positive.
\end_layout

\begin_layout Standard
If we want the tensile response to engage only beyond a threshold stretch
 ratio 
\begin_inset Formula $\lambda_{0}$
\end_inset

, we may rewrite the strain energy density as
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\frac{\xi}{2}H\left(\ln\lambda_{n}-\ln\lambda_{0}\right)\left(\ln\lambda_{n}-\ln\lambda_{0}\right)^{2}=\frac{\xi}{2}H\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)^{2}\,.\label{eq:fnh-sed-redux}
\end{equation}

\end_inset

Then
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\xi J^{-1}H\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)\ln\frac{\lambda_{n}}{\lambda_{0}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq:fnh-stress-redux}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=\xi J^{-1}H\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)\left(1-2\ln\frac{\lambda_{n}}{\lambda_{0}}\right)\mathbf{N}\otimes\mathbf{N}\,.\label{eq:fnh-elasticity-redux}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Nearly-Incompressible Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Nearly-Incompressible-Materials"

\end_inset

 
\end_layout

\begin_layout Subsection
Mooney-Rivlin Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mooney-Rivlin-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This material model is a hyperelastic Mooney-Rivlin type with uncoupled
 deviatoric and volumetric behavior.
 The uncoupled strain energy W is given by: 
\begin_inset Formula 
\begin{equation}
W=c_{1}\left(\tilde{I}_{1}-3\right)+c_{2}\left(\tilde{I}_{2}-3\right)+\frac{1}{2}K\left(\ln J\right)^{2}\,.\label{eq449}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $c_{1}$
\end_inset

 and 
\begin_inset Formula $c_{2}$
\end_inset

 are the Mooney-Rivlin material coefficients, 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the invariants of the deviatoric part of the right Cauchy-Green deformation
 tensor, 
\begin_inset Formula $\mathbf{\tilde{C}}=\mathbf{\tilde{F}}^{T}\cdot\mathbf{\tilde{F}}$
\end_inset

, where 
\begin_inset Formula $\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}$
\end_inset

, 
\series bold
\emph on

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
\emph default
 is the deformation gradient and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the Jacobian of the deformation.
 When 
\begin_inset Formula $c_{2}=0$
\end_inset

, this model reduces to an uncoupled version of the incompressible neo-Hookean
 constitutive model.
\end_layout

\begin_layout Standard
The Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\frac{2}{J}\left[\left(c_{1}+c_{2}\tilde{I}_{1}\right)\mathbf{\tilde{b}}-c_{2}\mathbf{\tilde{b}}^{2}-\frac{1}{3}\left(c_{1}\tilde{I}_{1}+2c_{2}\tilde{I}_{2}\right)\mathbf{I}\right]\,.\label{eq450}
\end{equation}

\end_inset

The spatial elasticity tensor is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{C}}=p\left(\mathbf{I}\otimes\mathbf{I}-2\mathbf{I}\odot\mathbf{I}\right)-\frac{2}{3}\left(\dev\boldsymbol{\sigma}\otimes\mathbf{I}+\mathbf{I}\otimes\dev\boldsymbol{\sigma}\right)+\boldsymbol{\mathcal{C}}_{w}\,,\label{eq451}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}}_{w} & =\frac{4}{3J}\left(c_{1}\tilde{I}_{1}+2c_{2}\tilde{I}_{2}\right)\left(\mathbf{I}\odot\mathbf{I}-\frac{1}{3}\mathbf{I}\otimes\mathbf{I}\right)+\frac{4c_{2}}{J}\left(\mathbf{\tilde{b}}\otimes\mathbf{\tilde{b}}-\mathbf{\tilde{b}}\odot\mathbf{\tilde{b}}\right)\\
 & -\frac{4c_{2}}{3J}\left[\left(\tilde{I}_{1}\mathbf{\tilde{b}}-\mathbf{\tilde{b}}^{2}\right)\otimes\mathbf{I}+\mathbf{I}\otimes\left(\tilde{I}_{1}\mathbf{\tilde{b}}-\mathbf{\tilde{b}}^{2}\right)\right]+\frac{8c_{2}\tilde{I}_{2}}{9J}\mathbf{I}\otimes\mathbf{I}\,.
\end{aligned}
\label{eq452}
\end{equation}

\end_inset

This material model uses a three-field element formulation, interpolating
 displacements as linear field variables and pressure and volume ratio as
 piecewise constant in each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Ogden Hyperelastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden-Hyperelastic"

\end_inset


\end_layout

\begin_layout Standard
The Ogden material is defined using the following hyperelastic strain energy
 function: 
\begin_inset Formula 
\begin{equation}
W\left(\lambda_{1},\lambda_{2},\lambda_{3},J\right)=\sum\limits _{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\tilde{\lambda}_{1}^{m_{i}}+\tilde{\lambda}_{2}^{m_{i}}+\tilde{\lambda}_{3}^{m_{i}}-3\right)+U\left(J\right)\,.\label{eq453}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\tilde{\lambda}_{i}$
\end_inset

 are the deviatoric principal stretches and 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{i}$
\end_inset

 are material parameters.
 The term 
\begin_inset Formula $U\left(J\right)$
\end_inset

 is the volumetric component and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient.
\end_layout

\begin_layout Standard
Note that the neo-Hookean and Mooney-Rivlin models can also be obtained
 from the general Ogden strain energy function using special choices for
 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Veronda-Westmann Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Veronda-Westmann-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
This model is similar to the Mooney-Rivlin model in that it also uses an
 uncoupled strain energy.
 However, in this case the strain energy is given by an exponential form:
 
\begin_inset Formula 
\begin{equation}
W=C_{1}\left[e^{\left(C_{2}\left(\tilde{I}_{1}-3\right)\right)}-1\right]-\frac{C_{1}C_{2}}{2}\left(\tilde{I}_{2}-3\right)+U\left(J\right)\,.\label{eq454}
\end{equation}

\end_inset

The dilatational term 
\begin_inset Formula $U$
\end_inset

 is identical to the Mooney-Rivlin model.
\end_layout

\begin_layout Standard
The Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is found from 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\dev\tilde{\boldsymbol{\sigma}}\,,\label{eq455}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\frac{2}{J}\left[\left(W_{1}+I_{1}W_{2}\right)\tilde{\mathbf{b}}-W_{2}\tilde{\mathbf{b}}^{2}\right]\,.\label{eq456}
\end{equation}

\end_inset

The strain energy derivatives are given by 
\begin_inset Formula 
\begin{equation}
W_{1}=C_{1}C_{2}e^{C_{2}\left(I_{1}-3\right)}\,,\label{eq457}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
W_{2}=-\frac{C_{1}C_{2}}{2}\,.\label{eq458}
\end{equation}

\end_inset

This material model was the result from the research of the elastic response
 of skin tissue 
\begin_inset CommandInset citation
LatexCommand citep
key "Veronda70"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Arruda-Boyce Hyperelasticity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Arruda-Boyce-Hyperelasticity"

\end_inset


\end_layout

\begin_layout Standard
Arruda and Boyce proposed a model for the deformation of rubber materials
 
\begin_inset CommandInset citation
LatexCommand citep
key "Arruda93"
literal "true"

\end_inset

.
 Their main motivation was to develop a model that accurately captures the
 behavior of rubbers in different loading scenarios and that can be described
 with a limited number of physically motivated parameters.
 Their model is based on the Langevin chain statistics, which models a rubber
 chain segment between chemical crosslinks as a number 
\begin_inset Formula $N$
\end_inset

 of rigid links of equal length 
\begin_inset Formula $l$
\end_inset

.
 The parameter 
\begin_inset Formula $N$
\end_inset

 is related to the locking stretch 
\begin_inset Formula $\lambda_{L}$
\end_inset

, the stretch at which the chains reach their full extended state, 
\begin_inset Formula $\lambda_{L}=\sqrt{N}$
\end_inset

.
\end_layout

\begin_layout Standard
Their proposed strain-energy is a truncated Taylor series of the inverse
 Langevin function.
 A formulation that retains the first five terms of this function takes
 on the following form: 
\begin_inset Formula 
\begin{equation}
\tilde{W}=\mu\sum\limits _{i=1}^{5}\frac{\alpha_{i}}{N^{i-1}}\left(\tilde{I}_{1}^{i}-3^{i}\right)+U\left(J\right)\,,\label{eq459}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is a shear-modulus like parameter and the coefficients 
\begin_inset Formula $\alpha_{i}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\alpha_{1}=\frac{1}{2}\,,\quad\alpha_{2}=\frac{1}{20}\,,\quad\alpha_{3}=\frac{11}{1050}\,,\quad\alpha_{4}=\frac{19}{7000}\,,\quad\alpha_{5}=\frac{519}{673750}\,.\label{eq460}
\end{equation}

\end_inset

The Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=p\mathbf{I}+\frac{2}{J}\dev\left(W_{1}\mathbf{\tilde{b}}\right)=p\mathbf{I}+\frac{2W_{1}}{J}\left(\mathbf{\tilde{b}}-\frac{1}{3}\tilde{I}_{1}\mathbf{I}\right)\,,\label{eq461}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
W_{1}=\frac{\partial\tilde{W}}{\partial\tilde{I}_{1}}=\mu\sum\limits _{i=1}^{5}\alpha_{i}i\left(\frac{\tilde{I}_{1}}{N}\right)^{i-1}\,.\label{eq462}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Transversely Isotropic Hyperelastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Hyperelas-1"

\end_inset


\end_layout

\begin_layout Standard
This constitutive model can be used to represent a material that has a single
 preferred fiber direction and was developed for application to biological
 soft tissues 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96,Puso98,Quapp98"
literal "true"

\end_inset

.
 It can be used to model tissues such as tendons, ligaments and muscle.
 The elastic response of the tissue is assumed to arise from the resistance
 of the fiber family and an isotropic matrix.
 It is assumed that the strain energy function can be written as follows:
 
\begin_inset Formula 
\begin{equation}
W=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+F_{2}\left(\tilde{\lambda}\right)+\frac{K}{2}\left[\ln\left(J\right)\right]^{2}\,.\label{eq463}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the first and second invariants of the deviatoric version of the right
 Cauchy Green deformation tensor 
\begin_inset Formula $\mathbf{\tilde{C}}$
\end_inset

 and 
\begin_inset Formula $\tilde{\lambda}$
\end_inset

 is the deviatoric part of the stretch along the fiber direction (
\begin_inset Formula $\tilde{\lambda}^{2}=\mathbf{A}\cdot\mathbf{\tilde{C}}\cdot\mathbf{A}$
\end_inset

, where 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is the initial fiber direction).
 The function 
\begin_inset Formula $F_{1}$
\end_inset

 represents the material response of the isotropic ground substance matrix,
 while 
\begin_inset Formula $F_{2}$
\end_inset

represents the contribution from the fiber family.
 The strain energy of the fiber family is as follows: 
\begin_inset Formula 
\begin{equation}
\tilde{\lambda}\frac{\partial F_{2}}{\partial\tilde{\lambda}}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\tilde{\lambda}-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}+C_{6}\tilde{\lambda} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.\label{eq464}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\lambda_{m}$
\end_inset

 is the stretch at which the fibers are straightened, 
\begin_inset Formula $C_{3}$
\end_inset

 scales the exponential stresses, 
\begin_inset Formula $C_{4}$
\end_inset

 is the rate of uncrimping of the fibers, and 
\begin_inset Formula $C_{5}$
\end_inset

 is the modulus of the straightened fibers.
 
\begin_inset Formula $C_{6}$
\end_inset

 is determined from the requirement that the stress is continuous at 
\begin_inset Formula $\lambda_{m}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
C_{6}=\frac{1}{\lambda_{m}}\left[C_{3}\left(e^{C_{4}\left(\lambda_{m}-1\right)}-1\right)-C_{5}\right]\,.\label{eq464b}
\end{equation}

\end_inset

It also follows that
\begin_inset Formula 
\begin{equation}
F_{2}\left(\tilde{\lambda}\right)=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{-C_{4}}\left[\Ei\left(C_{4}\tilde{\lambda}\right)-\Ei\left(C_{4}\right)\right]-\ln\tilde{\lambda}\right) & 1<\tilde{\lambda}<\lambda_{m}\\
\left(C_{5}+\frac{C_{6}}{2}\tilde{\lambda}\right)\tilde{\lambda}+C_{7} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,,\label{eq464c}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
C_{7}=C_{3}\left(e^{-C_{4}}\left[\Ei\left(C_{4}\lambda_{m}\right)-\Ei\left(C_{4}\right)\right]-\ln\lambda_{m}\right)-\left(C_{5}+\frac{C_{6}}{2}\lambda_{m}\right)\lambda_{m}\,.\label{eq464d}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This material model uses a three-field element formulation, interpolating
 displacements as linear field variables and pressure and volume ratio as
 piecewise constant on each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Ellipsoidal Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ellipsoidal-Fiber-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This constitutive model describes a material that is composed of an ellipsoidal
 continuous fiber distribution in an uncoupled formulation.
 The deviatoric part of the stress is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09a,Ateshian07a,Lanir83"
literal "true"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\boldsymbol{\sigma}}_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,,\label{eq465}
\end{equation}

\end_inset

and the corresponding elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\boldsymbol{\mathcal{C}}}_{n}\left(\mathbf{n}\right)\sin\phi\,d\phi\,d\theta\,.\label{eq466}
\end{equation}

\end_inset


\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\mathbf{F}$
\end_inset

, 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction (in the reference configuration),
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

, 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}$
\end_inset

 and 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber stress is determined from a fiber strain energy function in the
 usual manner: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}_{n}\left(\mathbf{n}\right)=2J^{-1}\tilde{I}_{n}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq467}
\end{equation}

\end_inset

whereas the fiber elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}_{n}\left(\mathbf{n}\right)=4J^{-1}\tilde{I}_{n}^{2}\frac{\partial^{2}\tilde{\Psi}}{\partial\tilde{I}_{n}^{2}}\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\,,\label{eq468}
\end{equation}

\end_inset

where in this material 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}\left(\mathbf{n},\tilde{I}_{n}\right)=\xi\left(\mathbf{n}\right)\left(\tilde{I}_{n}-1\right)^{\beta\left(\mathbf{n}\right)}\,.\label{eq469}
\end{equation}

\end_inset

The materials parameters 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\xi$
\end_inset

 are determined from: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\,,\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}\,.
\end{aligned}
\label{eq470}
\end{equation}

\end_inset

Since fibers can only sustain tension, this material is not stable on its
 own.
 It must be combined with a material that acts as the ground matrix.
 The total stress is then given by the sum of the fiber stress and the ground
 matrix stress: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{m}+\tilde{\boldsymbol{\sigma}}_{f}\,.\label{eq471}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Fiber with Exponential Power Law Uncoupled
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Exponential-Power-UC"

\end_inset


\end_layout

\begin_layout Standard
This material model describes a constitutive model for fibers, where a single
 fiber family follows an exponential power law strain energy function.
 The deviatoric part of the Cauchy stress is given by: 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=2J^{-1}H\left(\tilde{I}_{n}-1\right)\tilde{I}_{n}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,\label{eq472}
\end{equation}

\end_inset

and the corresponding spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=4J^{-1}H\left(\tilde{I}_{n}-1\right)\tilde{I}_{n}^{2}\frac{\partial^{2}\tilde{\Psi}}{\partial\tilde{I}_{n}^{2}}\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\otimes\mathbf{n}\,,\label{eq473}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch, 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the fiber orientation in the reference configuration, 
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3}\,,\label{eq474}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}$
\end_inset

 and 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber strain energy density is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(\tilde{I}_{n}-1\right)^{\beta}\right]-1\right)\,,\label{eq475}
\end{equation}

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

, 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
\end_layout

\begin_layout Standard
Note: In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

, this expression produces a power law, 
\begin_inset Formula 
\begin{equation}
\lim\limits _{\alpha\to0}\tilde{\Psi}=\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta}\,.\label{eq476}
\end{equation}

\end_inset

Note: When 
\begin_inset Formula $\beta>2$
\end_inset

, the fiber modulus is zero at the strain origin (
\begin_inset Formula $\tilde{I}_{n}=1)$
\end_inset

.
 Therefore, use 
\begin_inset Formula $\beta>2$
\end_inset

when a smooth transition in the stress is desired from compression to tension.
\end_layout

\begin_layout Subsection
Fung Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fung-Orthotropic"

\end_inset


\end_layout

\begin_layout Standard
The hyperelastic strain energy function for a Fung Orthotropic material
 is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung93,Fung79"
literal "true"

\end_inset

 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}=\frac{1}{2}c\left(e^{\tilde{Q}}-1\right)+U\left(J\right)\,,\label{eq477}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{Q}=c^{-1}\sum\limits _{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{\tilde{E}}^{2}+\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{\tilde{E}}\right)\left(\mathbf{M}_{b}:\mathbf{\tilde{E}}\right)\right]\,.\label{eq478}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{\tilde{E}}=\frac{1}{2}\left(\mathbf{\tilde{C}}-\mathbf{I}\right)$
\end_inset

 and 
\begin_inset Formula $\mathbf{M}_{a}=\mathbf{A}_{a}\otimes\mathbf{A}_{a}$
\end_inset

, where 
\begin_inset Formula $\mathbf{A}_{a}$
\end_inset

 are orthonormal vectors that define the initial direction of material axes.
 The orthotropic Lamé coefficients should be chosen such that the stiffness
 matrix, 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]\label{eq479}
\end{equation}

\end_inset

is positive definite.
\end_layout

\begin_layout Subsection
Tension-Compression Nonlinear Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:TC-Nonlinear-Orthotropic"

\end_inset


\end_layout

\begin_layout Standard
This material model is based on the following uncoupled hyperelastic strain
 energy function 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07c"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C},\lambda_{1},\lambda_{2},\lambda_{3}\right)=\tilde{\Psi}_{\text{iso}}\left(\mathbf{\tilde{C}}\right)+\sum\limits _{i=1}^{3}\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)+U\left(J\right)\,.\label{eq480}
\end{equation}

\end_inset

The isotropic strain energy 
\begin_inset Formula $\tilde{\Psi}_{\text{iso}}$
\end_inset

 and the dilatational energy 
\begin_inset Formula $U$
\end_inset

 are the same as for the Mooney-Rivlin material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin-Hyperelasticity"

\end_inset

).
 The tension-compression term is defined as follows: 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)=\begin{cases}
\xi_{i}\left(\tilde{\lambda}_{i}-1\right)^{\beta_{i}} & \tilde{\lambda}_{i}>1\\
0 & \tilde{\lambda}_{i}\leqslant1
\end{cases}\,,\xi_{i}\geqslant0\quad\mbox{(no sum over }i\text{).}\label{eq481}
\end{equation}

\end_inset

The 
\begin_inset Formula $\tilde{\lambda}_{i}$
\end_inset

 parameters are the deviatoric fiber stretches of the local material fibers,
 
\begin_inset Formula 
\begin{equation}
\tilde{\lambda}_{i}=\left(\mathbf{A}_{i}\cdot\mathbf{\tilde{C}}\cdot\mathbf{A}_{i}\right)^{1/2}\,.\label{eq482}
\end{equation}

\end_inset

The local material fibers are defined (in the reference frame) as an orthonormal
 set of vectors 
\begin_inset Formula $\mathbf{A}_{i}$
\end_inset

.
 The corresponding deviatoric part of the Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=J^{-1}\sum\limits _{i=1}^{3}\frac{1}{\tilde{\lambda}_{i}}\frac{\partial\tilde{\Psi}}{\partial\tilde{\lambda}_{i}}\mathbf{a}_{i}\otimes\mathbf{a}_{i}\,,\label{eq483}
\end{equation}

\end_inset

and the spatial elasticity tensor is 
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=J^{-1}\sum\limits _{i=1}^{3}\frac{1}{\tilde{\lambda}_{i}}\frac{\partial}{\partial\tilde{\lambda}_{i}}\left(\frac{1}{\tilde{\lambda}_{i}}\frac{\partial\tilde{\Psi}}{\partial\tilde{\lambda}_{i}}\right)\mathbf{a}_{i}\otimes\mathbf{a}_{i}\otimes\mathbf{a}_{i}\otimes\mathbf{a}_{i}\,,\label{eq484}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{a}_{i}=\mathbf{\tilde{F}}\cdot\mathbf{A}_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Holmes-Mow Uncoupled
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow-Uncoupled"

\end_inset


\end_layout

\begin_layout Standard
The uncoupled hyperelastic strain-energy function for this material is given
 by 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C}\right)=\tilde{\Psi}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)\,,\label{eq:HMU-SED}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\tilde{\Psi}\left(\tilde{\mathbf{C}}\right)=\frac{1}{2}\frac{\mu}{\beta}\left(e^{\tilde{Q}}-1\right)\,,\label{eq:HMU-DSED}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\tilde{Q}=\beta\left(\tilde{I}_{1}-3\right)\,.\label{eq:HMU-Q}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mu$
\end_inset

 is the shear modulus and 
\begin_inset Formula $\beta$
\end_inset

 is the exponential nonlinearity coefficient.
 The corresponding spatial stress and elasticity tensors are
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}=\frac{\mu}{J}e^{\tilde{Q}}\tilde{\mathbf{b}}\,,\label{eq:HMU-stress}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\mathcal{C}}}=2\beta\frac{\mu}{J}e^{\tilde{Q}}\tilde{\mathbf{b}}\otimes\tilde{\mathbf{b}}\label{eq:HMU-elasticity}
\end{equation}

\end_inset

respectively.
 Note that 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 does not reduce to zero when 
\begin_inset Formula $\tilde{\mathbf{b}}=\mathbf{I}$
\end_inset

, but 
\begin_inset Formula $\dev\tilde{\boldsymbol{\sigma}}$
\end_inset

 does.
 These expressions can be substituted into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-Cauchy-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-spatial-elasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to evaluate the final expressions for the Cauchy stress and spatial elasticity
 tensors, respectively.
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Viscoelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Viscoelasticity"

\end_inset


\end_layout

\begin_layout Standard
When some of the energy stored during mechanical loading of a material gets
 dissipated into heat, the material's response is called inelastic.
 Inelastic behaviors include viscoelasticity and plasticity, although this
 presentation focuses exclusively on viscoelasticity.
 In continuum mechanics, we can identify three forms of viscoelasticity
 in materials.
 Viscoelasticity may occur due to (1) friction between molecules of the
 same material, (2) friction between solid and fluid matter in a porous
 deformable medium, and (3) breaking and reforming of weak bonds between
 molecules of the same material.
 The first form is classically described as the viscous response of a material,
 whereby the friction between molecules of the same material is represented
 by the material's viscosity 
\begin_inset CommandInset citation
LatexCommand citep
key "Coleman63"
literal "false"

\end_inset

.
 The second form is classically described by poroelasticity 
\begin_inset CommandInset citation
LatexCommand citep
key "Cryer63,Rice76"
literal "false"

\end_inset

 or biphasic 
\begin_inset CommandInset citation
LatexCommand citep
key "Mow80"
literal "false"

\end_inset

 theory, whereby the frictional drag between the porous solid and its interstiti
al fluid is represented by the hydraulic permeability (also known as Darcy's
 law of permeation), see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The last form was proposed by Green and Tobolsky 
\begin_inset CommandInset citation
LatexCommand citep
key "Green46,Tobolsky60"
literal "false"

\end_inset

 as the fundamental mechanism for viscoelasticity in polymers.
 Recently, we presented a constrained reactive mixture approach to formulate
 a reactive viscoelasticity theory that embodies the molecular mechanism
 of viscoelasticity proposed by those authors 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian15,Ateshian23"
literal "false"

\end_inset

, see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A conventional approach for modeling viscoelasticity uses the framework
 of internal state variables 
\begin_inset CommandInset citation
LatexCommand citep
key "Coleman67"
literal "false"

\end_inset

, whereby we may decompose the deformation gradient 
\begin_inset Formula $\mathbf{F}$
\end_inset

 into deformations occurring in a microstructural model of the material,
 consisting of a spring and dashpot in series 
\begin_inset CommandInset citation
LatexCommand citep
key "Lubliner85,Simo87,Holzapfel96"
literal "false"

\end_inset

, see Section
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Internal-State-Variable"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Internal State Variable Theory
\begin_inset CommandInset label
LatexCommand label
name "subsec:Internal-State-Variable"

\end_inset


\end_layout

\begin_layout Standard
We may model a continuum version of the standard linear solid using quasilinear
 viscoelasticity, as shown for example by Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "false"

\end_inset

, though we make minor modifications and extensions to his presentation
 here.
 Consider that the microstructural model of this viscoelastic material consists
 of a spring and dashpot in series (a Maxwell model), combined with a spring
 in parallel, which is equivalent to the Maxwell representation of a standard
 linear solid in linear viscoelasticity (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:spring-dashpot-model"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The total deformation gradient, associated with the parallel spring, is
 
\begin_inset Formula $\mathbf{F}=\mathbf{F}_{s}\cdot\mathbf{F}_{d}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}_{s}$
\end_inset

 is the internal state variable representing the deformation gradient associated
 with the series spring of the Maxwell model, and 
\begin_inset Formula $\mathbf{F}_{d}$
\end_inset

 is that associated with the dashpot.
 The second Piola-Kirchhoff stress in the parallel spring is given by
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigStandardLinearSolid.png
	lyxscale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Spring-dashpot model for Maxwell representation of the standard solid.
\begin_inset CommandInset label
LatexCommand label
name "fig:spring-dashpot-model"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{S}^{e}\left(\mathbf{F}\right)=\frac{\partial\Psi_{r}^{e}}{\partial\mathbf{E}}\,,\label{eq:IVT-parallel-spring-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{E}=\frac{1}{2}\left(\mathbf{F}^{T}\cdot\mathbf{F}-\mathbf{I}\right)$
\end_inset

 is the Lagrange strain tensor derived from 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 In this quasilinear viscoelasticity theory, the second Piola-Kirchhoff
 stress in the Maxwell spring is given by
\begin_inset Formula 
\begin{equation}
\mathbf{M}\left(\mathbf{F}_{s}\right)=\gamma\mathbf{S}^{e}\left(\mathbf{F}_{s}\right)\,,\label{eq:IVT-series-spring-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma\ge0$
\end_inset

 is a user-defined non-dimensional parameter that produces standard hyperelastic
ity in the limit when 
\begin_inset Formula $\gamma=0$
\end_inset

.
 Note that 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-series-spring-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 uses the same constitutive model as in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-parallel-spring-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

, but its argument is different (
\begin_inset Formula $\mathbf{F}_{s}$
\end_inset

 instead of 
\begin_inset Formula $\mathbf{F}$
\end_inset

).
 By recognizing that 
\begin_inset Formula $\mathbf{M}$
\end_inset

 should also be the stress in the Maxwell dashpot, we use eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-series-spring-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to find that
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{S}}^{e}\left(\mathbf{F}_{s}\left(t\right)\right)+\frac{1}{\tau}\mathbf{S}^{e}\left(\mathbf{F}_{s}\left(t\right)\right)=\dot{\mathbf{S}}^{e}\left(\mathbf{F}\left(t\right)\right)\,,\quad\mathbf{S}^{e}\left(\mathbf{F}_{s}\left(0\right)\right)=\mathbf{0}\,,\label{eq:IVT-ODE}
\end{equation}

\end_inset

where the time constant 
\begin_inset Formula $\tau$
\end_inset

 is the ratio of the damping coefficient in the dashpot to the Maxwell spring
 stiffness, and the dot operator represents the material time derivative
 in the material frame.
 The solution to this 
\emph on
linear
\emph default
 ordinary differential equation (hence, quasi
\emph on
-linear
\emph default
 viscoelasticity theory) is
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{e}\left(\mathbf{F}_{s}\left(t\right)\right)=\int_{0}^{t}e^{-\left(t-s\right)/\nu}\frac{d\mathbf{S}^{e}\left(\mathbf{F}\left(s\right)\right)}{ds}\,ds\,.\label{eq:IVT-P-solution}
\end{equation}

\end_inset

Now, the total stress 
\begin_inset Formula $\mathbf{S}$
\end_inset

 in this material, which is the sum of stresses in the two springs, 
\begin_inset Formula $\mathbf{S}=\mathbf{S}^{e}\left(\mathbf{F}\right)+\gamma\mathbf{S}^{e}\left(\mathbf{F}_{s}\right)$
\end_inset

, reduces to the familiar form
\begin_inset Formula 
\begin{equation}
\mathbf{S}=\int_{0}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}\left(\mathbf{F}\left(s\right)\right)}{ds}\,ds\,,\label{eq:IVT-total-stress}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
G\left(t\right)=1+\gamma e^{-t/\tau}\label{eq:IVT-relaxation-fcn}
\end{equation}

\end_inset

is called the relaxation function.
 A convenient and efficient numerical scheme for solving for 
\begin_inset Formula $\mathbf{S}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-total-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 was given previously by Puso and Weiss 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso98"
literal "false"

\end_inset

, where they used 
\begin_inset Formula $\mathbf{H}$
\end_inset

 to denote 
\begin_inset Formula $\mathbf{S}^{e}\left(\mathbf{F}_{s}\right)$
\end_inset

 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Puso-Weiss-Scheme"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Of course, the last step in this analysis is to evaluate the Cauchy stress
 from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-total-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 using the standard push-forward formula 
\begin_inset Formula $\boldsymbol{\sigma}=J^{-1}\mathbf{F}\cdot\mathbf{S}\cdot\mathbf{F}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
The strain energy density associated with this viscoelastic material corresponds
 to that stored in the two springs.
 Its continuum form is
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\Psi_{r}^{e}\left(\mathbf{F}\right)+\gamma\Psi_{r}^{e}\left(\mathbf{F}_{s}\right)\,.\label{eq:IVT-SED}
\end{equation}

\end_inset

It is important to note that this presentation does not provide an explicit
 solution for 
\begin_inset Formula $\mathbf{F}_{s}\left(t\right)$
\end_inset

.
 In principle, it is possible to extract a suitable measure of strain associated
 with 
\begin_inset Formula $\mathbf{F}_{s}\left(t\right)$
\end_inset

 by inverting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-P-solution"
plural "false"
caps "false"
noprefix "false"

\end_inset

, since 
\begin_inset Formula $\mathbf{S}^{e}\left(\mathbf{F}_{s}\left(t\right)\right)$
\end_inset

 must be evaluated explicitly in this scheme as part of the solution for
 
\begin_inset Formula $\mathbf{S}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-total-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 This inversion requires the adoption of suitable constitutive assumptions
 about the multiplicative decomposition 
\begin_inset Formula $\mathbf{F}=\mathbf{F}_{s}\cdot\mathbf{F}_{d}$
\end_inset

; it may possibly be numerically expensive.
\end_layout

\begin_layout Standard
In the context of reactive viscoelasticity (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

), in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-SED"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we can refer to 
\begin_inset Formula $\Psi_{r}^{e}\left(\mathbf{F}\right)$
\end_inset

 as the strong bond strain energy density, since it persists under a non-zero
 strain, whereas 
\begin_inset Formula $\gamma\Psi_{r}^{e}\left(\mathbf{F}_{s}\right)$
\end_inset

 represents the weak bond strain energy density, since it decays to zero
 under a constant strain as 
\begin_inset Formula $t\to\infty$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Strain Energy Density in Standard Solid
\begin_inset CommandInset label
LatexCommand label
name "subsec:SED-Standard-Solid"

\end_inset


\end_layout

\begin_layout Standard
For example, in the special case of a stress-relaxation response to an instantan
eous step strain, evaluated from 
\begin_inset Formula $\mathbf{F}\left(0^{+}\right)$
\end_inset

, we may let 
\begin_inset Formula $\mathbf{F}_{s}\left(0^{+}\right)=\mathbf{F}\left(0^{+}\right)$
\end_inset

 since the dashpot cannot deform instantaneously, under the reasonable constitut
ive assumption that there is no rigid body rotation associated with the
 dashpot distinct from that of the Maxwell series spring, thus 
\begin_inset Formula $\mathbf{F}_{d}\left(0^{+}\right)=\mathbf{I}$
\end_inset

.
 If we adopt this assumption for all times 
\begin_inset Formula $t$
\end_inset

, then we can also conclude that the right stretch tensor 
\begin_inset Formula $\mathbf{U}_{s}$
\end_inset

 of the Maxwell spring deformation gradient tends toward 
\begin_inset Formula $\mathbf{I}$
\end_inset

 in the limit as 
\begin_inset Formula $t\to\infty$
\end_inset

, as the dashpot elongates or contracts to match the right-stretch tensor
 of the parallel spring, also implying that 
\begin_inset Formula $\Psi_{r}^{e}\left(\mathbf{F}_{s}\right)\to0$
\end_inset

 in this limit.
\end_layout

\begin_layout Standard
Building upon this example, we can assume more generally that 
\begin_inset Formula $\mathbf{U}=\mathbf{U}_{s}\cdot\mathbf{U}_{d}$
\end_inset

 under the constitutive assumption that the rotation tensor 
\begin_inset Formula $\mathbf{R}$
\end_inset

 in the polar decomposition of 
\begin_inset Formula $\mathbf{F}=\mathbf{R}\cdot\mathbf{U}$
\end_inset

 is the same in both branches of the microstructural model.
 However, for self-consistency, we must also assume that 
\begin_inset Formula $\mathbf{U}_{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{d}$
\end_inset

 share the same eigenvectors as 
\begin_inset Formula $\mathbf{U}$
\end_inset

 to preserve the symmetry of all three right-stretch tensors.
 Thus, a valid constitutive model for the multiplicative decomposition is
 to let 
\begin_inset Formula $\mathbf{U}_{s}=\mathbf{U}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{d}=\mathbf{U}^{1-\alpha}$
\end_inset

, where the exponent 
\begin_inset Formula $\alpha\left(t\right)$
\end_inset

 is a scalar function of time that can be obtained by solving eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:IVT-total-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the form 
\begin_inset Formula $\gamma\mathbf{S}^{e}\left(\mathbf{U}^{\alpha}\right)=\mathbf{S}\left(\mathbf{U}\right)-\mathbf{S}^{e}\left(\mathbf{U}\right)$
\end_inset

 at the current time 
\begin_inset Formula $t$
\end_inset

.
 This constitutive model is insensitive to flipping the spring and dashopt
 sequence in the Maxwell element, as should be expected.
 Now, for an instantaneous step strain, we would have 
\begin_inset Formula $\alpha\left(0^{+}\right)=1$
\end_inset

, whereas the steady-state response to a step strain would produce 
\begin_inset Formula $\lim_{t\to\infty}\alpha\left(t\right)=0$
\end_inset

.
 Logically, it would be reasonable to expect that 
\begin_inset Formula $\alpha\left(t\right)$
\end_inset

 must remain in the range 
\begin_inset Formula $0\le\alpha\le1$
\end_inset

, since we cannot physically justify that the Maxwell spring would stretch
 (expand or contract) by a greater amount than the parallel spring.
 A more formal enforcement of thermodynamic constraints of this internal
 variable theory 
\begin_inset CommandInset citation
LatexCommand citep
key "Coleman67"
literal "false"

\end_inset

, not provided here, should confirm this expectation.
\end_layout

\begin_layout Subsubsection
Puso and Weiss Numerical Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:Puso-Weiss-Scheme"

\end_inset


\end_layout

\begin_layout Standard
Here we consider the slightly more general case where the relaxation function
 is given by a Prony series
\begin_inset Formula 
\begin{equation}
G\left(t\right)=\gamma_{0}+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right)\,.\label{eq486}
\end{equation}

\end_inset

With this function chosen for the relaxation function, we can write the
 total stress as 
\begin_inset Formula 
\begin{equation}
\mathbf{S}\left(t\right)=\int\limits _{0}^{t}\left(\gamma_{0}+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(\left(-t+s\right)/\tau_{i}\right)\frac{d\mathbf{S}^{e}}{ds}\right)\,ds\,.\label{eq487}
\end{equation}

\end_inset

Introducing the internal variables, 
\begin_inset Formula 
\begin{equation}
\mathbf{H}^{\left(i\right)}\left(t\right)=\int\limits _{0}^{t}\exp\left[-\left(t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\,,\label{eq488}
\end{equation}

\end_inset

we can rewrite 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq487"

\end_inset

 as follows, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}\left(t\right)=\gamma_{0}\mathbf{S}^{e}\left(t\right)+\sum\limits _{i=1}^{N}\gamma_{i}\mathbf{H}^{\left(i\right)}\left(t\right)\,.\label{eq489}
\end{equation}

\end_inset

In FEBio, 
\begin_inset Formula $\gamma_{0}=1$
\end_inset

, so 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the long-term elastic response of the material.
\end_layout

\begin_layout Standard
The question now remains how to evaluate the internal variables.
 From equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq488"

\end_inset

 it appears that we have to integrate over the entire time domain.
 However, we can find a recurrence relationship that will allow us to evaluate
 the internal variables at a time 
\begin_inset Formula $t+\Delta t$
\end_inset

 given the values at time 
\begin_inset Formula $t$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{H}^{\left(i\right)}\left(t+\Delta t\right) & =\int\limits _{0}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\\
 & =\exp\left(-\Delta t/\tau_{i}\right)\int\limits _{0}^{t}\exp\left[-\left(t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds+\int\limits _{t}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\\
 & =\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}^{\left(i\right)}\left(t\right)+\int\limits _{t}^{t+\Delta t}\exp\left[-\left(t+\Delta t-s\right)/\tau_{i}\right]\frac{d\mathbf{S}^{e}}{ds}\,ds\,.
\end{aligned}
\label{eq490}
\end{equation}

\end_inset

The last term can now be simplified using the midpoint rule to approximate
 the derivate.
 In that case we find the recurrence relation: 
\begin_inset Formula 
\begin{equation}
\mathbf{H}^{\left(i\right)}\left(t+\Delta t\right)=\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}^{\left(i\right)}\left(t\right)+\frac{1-\exp\left(-\Delta t/\tau_{i}\right)}{\Delta t/\tau_{i}}\left(\mathbf{S}^{e}\left(t+\Delta t\right)-\mathbf{S}^{e}\left(t\right)\right)\,.\label{eq491}
\end{equation}

\end_inset

The following procedure can now be applied to calculate the new stress.
 Given 
\begin_inset Formula $\mathbf{S}_{n}^{e}$
\end_inset

 and 
\begin_inset Formula $\mathbf{H}_{n}^{\left(i\right)}$
\end_inset

 corresponding to time 
\begin_inset Formula $t$
\end_inset

, find 
\begin_inset Formula $\mathbf{S}_{n+1}^{e}$
\end_inset

 and 
\begin_inset Formula $\mathbf{H}_{n+1}^{\left(i\right)}$
\end_inset

 corresponding to time 
\begin_inset Formula $t+\Delta t$
\end_inset

:
\end_layout

\begin_layout Enumerate
calculate elastic stress: 
\begin_inset Formula 
\[
\mathbf{S}_{n+1}^{e}=2\frac{\partial\Psi_{r}^{e}}{\partial\mathbf{C}_{n+1}}\,,
\]

\end_inset

 
\end_layout

\begin_layout Enumerate
evaluate internal variables: 
\begin_inset Formula 
\[
\mathbf{H}_{n+1}^{i}=\exp\left(-\Delta t/\tau_{i}\right)\mathbf{H}_{n}^{i}+\frac{1-\exp\left(-\Delta t/\tau_{i}\right)}{\Delta t/\tau_{i}}\left(\mathbf{S}_{n+1}^{e}-\mathbf{S}_{n}^{e}\right)\,,
\]

\end_inset

 
\end_layout

\begin_layout Enumerate
find the total stress: 
\begin_inset Formula 
\[
\mathbf{S}_{n+1}=\gamma_{0}\mathbf{S}_{n+1}^{e}+\sum\limits _{i=1}^{N}\gamma_{i}\mathbf{H}_{n+1}^{i}\,.
\]

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Reactive Viscoelasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Viscoelasticity"

\end_inset


\end_layout

\begin_layout Standard
Reactive viscoelasticity models a material as a mixture of strong bonds,
 which are permanent, and weak bonds, which break and reform in response
 to loading 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian15,Ateshian22"
literal "true"

\end_inset

.
 This framework is based on constrained reactive mixtures of solids (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mixture-of-Solids"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Strong bonds produce the equilibrium elastic response, whereas weak bonds
 produce the transient viscous response.
 Strong bonds are in a stress-free state when in their reference configuration
 
\begin_inset Formula $\mathbf{X}$
\end_inset

.
 Their deformation gradient is defined as usual, 
\begin_inset Formula $\mathbf{F}\left(\mathbf{X},t\right)=\partial\boldsymbol{\chi}\left(\mathbf{X},t\right)/\partial\mathbf{X}$
\end_inset

.
 When weak bonds break in response to loading at some time 
\begin_inset Formula $u$
\end_inset

, they reform instantaneously in a stress-free configuration 
\begin_inset Formula $\mathbf{X}^{u}$
\end_inset

 that coincides with the current configuration at time 
\begin_inset Formula $u$
\end_inset

, thus, 
\begin_inset Formula $\mathbf{X}^{u}=\boldsymbol{\chi}\left(\mathbf{X},u\right)$
\end_inset

.
 Therefore, a reaction transforms intact loaded bonds into reformed unloaded
 bonds.
 Weak bonds that reform at time 
\begin_inset Formula $u$
\end_inset

 may be called 
\begin_inset Formula $u-$
\end_inset

generation bonds.
 The deformation gradient of 
\begin_inset Formula $u-$
\end_inset

generation weak bonds relative to their reference configuration 
\begin_inset Formula $\mathbf{X}^{u}$
\end_inset

 is denoted by 
\begin_inset Formula $\mathbf{F}^{u}\left(\mathbf{X},t\right)$
\end_inset

, which may be evaluated from the chain rule, 
\begin_inset Formula 
\begin{equation}
\mathbf{F}\left(\mathbf{X},t\right)=\mathbf{F}^{u}\left(\mathbf{X},t\right)\cdot\bar{\mathbf{R}}\left(\mathbf{X},u\right)\cdot\mathbf{U}\left(\mathbf{X},u\right)\,,\label{eq492}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is the right-stretch tensor of 
\begin_inset Formula $\mathbf{F}=\mathbf{R}\cdot\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{R}}=\left(\mathbf{R}^{u}\right)^{T}\cdot\mathbf{R}$
\end_inset

 is the relative rotation between generation 
\begin_inset Formula $u$
\end_inset

 and the master generation.
 The strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 in a reactive viscoelastic material is given by 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\sum\limits _{u}w^{u}\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)\,,\label{eq493}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{r}^{e}$
\end_inset

 is the strain energy density of strong bonds and 
\begin_inset Formula $\Psi_{0}^{b}$
\end_inset

 is the strain energy density of weak bonds, when they all belong to the
 same generation.
 In this expression, 
\begin_inset Formula $w^{u}\left(\mathbf{X},t\right)$
\end_inset

 is the mass fraction of 
\begin_inset Formula $u-$
\end_inset

generation weak bonds, which evolves over time as described below.
 The summation is taken over all generations 
\begin_inset Formula $u$
\end_inset

 that were created prior to the current time 
\begin_inset Formula $t$
\end_inset

.
 Based on eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the mixture Cauchy stress 
\begin_inset Formula $\sigma$
\end_inset

 in a reactive viscoelastic material is similarly given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}\left(\mathbf{F}^{s}\right)=\boldsymbol{\sigma}^{e}\left(\mathbf{F}^{s}\right)+\sum\limits _{u}w^{u}J^{-1}\left(u\right)\boldsymbol{\sigma}_{0}^{b}\left(\mathbf{F}^{u}\right)\,,\label{eq494}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress in the strong bonds and 
\begin_inset Formula $\boldsymbol{\sigma}_{0}^{b}$
\end_inset

 is the stress in the weak bonds.
 These stresses are related to the respective strain energy densities of
 strong and weak bonds according to 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{e}\left(\mathbf{F}^{s}\right)=\frac{1}{J^{s}}\frac{\partial\Psi_{r}^{e}\left(\mathbf{F}^{s}\right)}{\partial\mathbf{F}^{s}}\cdot\left(\mathbf{F}^{s}\right)^{T},\quad\boldsymbol{\sigma}_{0}^{b}\left(\mathbf{F}^{u}\right)=\frac{1}{J^{u}}\frac{\partial\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)}{\partial\mathbf{F}^{u}}\cdot\left(\mathbf{F}^{u}\right)^{T}\,.\label{eq495}
\end{equation}

\end_inset

The mass fractions 
\begin_inset Formula $w^{u}\left(\mathbf{X},t\right)$
\end_inset

 are obtained by solving the equation of mass balance for reactive constrained
 mixtures, 
\begin_inset Formula 
\begin{equation}
\dot{w}^{u}=\hat{w}^{u}\left(\mathbf{F},w^{\gamma}\right)\,,\label{eq496}
\end{equation}

\end_inset

where the mass fraction supply 
\begin_inset Formula $\hat{w}^{u}$
\end_inset

 must be specified as a constitutive function of the deformation gradient
 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and the mass fractions 
\begin_inset Formula $w^{\gamma}$
\end_inset

 from all generations.
 Since mass must be conserved over all generations, it follows that 
\begin_inset Formula 
\begin{equation}
\sum\limits _{u}\hat{w}^{u}=0,\quad\sum\limits _{u}w^{u}=1\,.\label{eq497}
\end{equation}

\end_inset

Any number of valid solutions may exist for 
\begin_inset Formula $w^{u}$
\end_inset

, based on constitutive assumptions for 
\begin_inset Formula $\hat{w}^{u}$
\end_inset

.
 For example, for 
\begin_inset Formula $u-$
\end_inset

generation bonds reforming in an unloaded state during the time interval
 
\begin_inset Formula $u\leqslant t<v$
\end_inset

, and subsequently breaking in response to loading at 
\begin_inset Formula $t=v$
\end_inset

, Type I bond kinetics provides a solution of the form 
\begin_inset Formula 
\begin{equation}
w^{u}\left(\mathbf{X},t\right)=\begin{cases}
0 & t<u\\
f^{u}\left(\mathbf{X},t\right) & u\leqslant t<v\\
f^{u}\left(\mathbf{X},v\right)g\left(\mathbf{F}\left(v\right);\mathbf{X},t-v\right) & v\leqslant t
\end{cases}\,,\label{eq498}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
f^{u}\left(\mathbf{X},t\right)=1-\sum\limits _{\gamma<u}w^{\gamma}\left(\mathbf{X},t\right)\,,\label{eq499}
\end{equation}

\end_inset

and 
\begin_inset Formula $g\left(\mathbf{F}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 is a reduced relaxation function which may assume any number of valid forms.
 (A reduced relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

 satisfies 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

 and 
\begin_inset Formula $g\left(t\to\infty\right)=0$
\end_inset

, and decreases monotonically with 
\begin_inset Formula $t$
\end_inset

.) In particular, 
\begin_inset Formula $g$
\end_inset

 may depend on the state of strain at time 
\begin_inset Formula $v$
\end_inset

 when the 
\begin_inset Formula $u-$
\end_inset

generation starts breaking and reforming.
 In the recursive expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq498"

\end_inset

, the earliest generation 
\begin_inset Formula $u=-\infty$
\end_inset

, which is initially at rest, produces 
\begin_inset Formula $w^{u}\left(t\right)=1$
\end_inset

 for 
\begin_inset Formula $t<v$
\end_inset

 and 
\begin_inset Formula $w^{u}\left(t\right)=g\left(\mathbf{F}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 for 
\begin_inset Formula $t\geqslant v$
\end_inset

; this latter expression seeds the recursion for subsequent generations.
 Therefore, providing a functional form for 
\begin_inset Formula $g$
\end_inset

 suffices to produce the solution for all bond generations 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard
For Type II bond kinetics, the solution for the mass fractions is given
 by 
\begin_inset Formula 
\begin{equation}
w^{u}\left(t\right)=\begin{cases}
0 & t<u\\
1-g\left(t-u\right) & u\leqslant t<v\\
g\left(t-v\right)-g\left(t-u\right) & v\leqslant t
\end{cases}\,.\label{eq500}
\end{equation}

\end_inset

For this type of bond kinetics, the reduced relaxation function 
\begin_inset Formula $g$
\end_inset

 cannot depend on the magnitude of the strain, because strain-dependence
 might violate the constraint 
\begin_inset Formula $0\leqslant w^{u}\leqslant1$
\end_inset

.
 Thus, type II bond kinetics is only valid for quasilinear viscoelasticity,
 whereas type I bond kinetics also encompasses nonlinear viscoelasticity.
\end_layout

\begin_layout Standard
For all bond kinetics, it is also possible to constrain the occurrence of
 the breaking-and-reforming reaction to specific forms of the strain.
 For example, the reaction may be allowed to proceed only in the case of
 dilatational strain, or only in the case of distortional strain.
\end_layout

\begin_layout Standard
The finite element implementation of reactive viscoelasticity stores the
 value of time 
\begin_inset Formula $v$
\end_inset

, mass fraction of reformed bonds 
\begin_inset Formula $f^{u}\left(\mathbf{X},v\right)$
\end_inset

, and the right stretch tensor 
\begin_inset Formula $\mathbf{U}\left(\mathbf{X},v\right)$
\end_inset

 needed to evaluate 
\begin_inset Formula $w^{u}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq498"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset Formula $\mathbf{F}^{v}\left(\mathbf{X},t\right)$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq492"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Constitutive Model for 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "subsec:Constitutive-Model-Rbar"

\end_inset


\end_layout

\begin_layout Standard
In reactive viscoelasticity we adopt the constitutive assumption that 
\begin_inset Formula $\mathbf{U}^{u}=\mathbf{I}$
\end_inset

, thus 
\begin_inset Formula $\mathbf{F}^{u}=\mathbf{R}^{u}$
\end_inset

, at time 
\begin_inset Formula $t^{u}$
\end_inset

 when generation 
\begin_inset Formula $u$
\end_inset

 must come into existence in a stress-free state.
 Since 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq492"
plural "false"
caps "false"
noprefix "false"

\end_inset

 must be a proper orthogonal transformation, we may select
\begin_inset Formula 
\begin{equation}
\begin{aligned}\bar{\mathbf{R}} & =\mathbf{I}\,.\end{aligned}
\label{eq:A-R-identity}
\end{equation}

\end_inset

Since this choice is invariant to any transformation 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 it remains valid for all material symmetries, ranging from triclinic to
 isotropic.
 Therefore, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq492"
plural "false"
caps "false"
noprefix "false"

\end_inset

 now takes the form
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{u}\left(\mathbf{X},t\right)=\mathbf{F}\left(\mathbf{X},t\right)\cdot\mathbf{U}^{-1}\left(\mathbf{X},u\right)\label{eq:rv-Fu-model}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is the right stretch tensor of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
There remains one special case that must be addressed with a separate choice
 for 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

.
 In biomechanics we often find it convenient to model fibrous or fibrillar
 materials using one-dimensional fibers that can only sustain tension.
 Typically, such fibers are represented with a strain energy density function
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Psi_{0}\left(\mathbf{C}\right) & =H\left(I_{n}-1\right)\Psi_{n}\left(I_{n}\right)\,, & I_{n} & =\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}\end{aligned}
\label{eq:A-fiber-models}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the unit vector along the fiber in its reference configuration, and
 
\begin_inset Formula $I_{n}$
\end_inset

 is the square of the stretch ratio along the fiber.
 The Heaviside unit step function 
\begin_inset Formula $H\left(I_{n}-1\right)$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A-fiber-models"
plural "false"
caps "false"
noprefix "false"

\end_inset

 ensures that the fiber contributes strain energy only when it is under
 tension (
\begin_inset Formula $I_{n}>1$
\end_inset

); thus, the constitutive model 
\begin_inset Formula $\Psi_{n}\left(I_{n}\right)$
\end_inset

 for the tensile response of the fiber must reduce to zero when 
\begin_inset Formula $I_{n}=1$
\end_inset

.
\end_layout

\begin_layout Standard
In the reactive viscoelasticity framework, each generation 
\begin_inset Formula $u$
\end_inset

 comes into existence at time 
\begin_inset Formula $t^{u}$
\end_inset

, thus the constitutive model for the fiber must account for the fact that
 the fiber orientation is no longer along 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 at time 
\begin_inset Formula $t^{u}$
\end_inset

.
 Indeed, the total weak bond free energy in a reactive viscoelastic material
 now reduces to
\begin_inset Formula 
\begin{equation}
\begin{aligned}\sum_{u}w^{u}\Psi_{0}^{b}\left(\mathbf{F}^{u}\left(t\right)\right) & =\sum_{u}w^{u}H\left(I_{n}^{u}-1\right)\Psi_{n}\left(I_{n}^{u}\right)\\
I_{n}^{u} & =\mathbf{n}_{r}^{u}\cdot\mathbf{C}^{u}\cdot\mathbf{n}_{r}^{u}
\end{aligned}
\label{eq:A-fiber-SED}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{r}^{u}$
\end_inset

 is the fiber orientation at time 
\begin_inset Formula $t^{u}$
\end_inset

 and 
\begin_inset Formula $I_{n}^{u}$
\end_inset

 is the square of the stretch ratio of the fiber relative to its reference
 configuration at time 
\begin_inset Formula $t^{u}$
\end_inset

.
 Recall that the elemental line along 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 gets transformed in the material frame at any time 
\begin_inset Formula $t$
\end_inset

 by 
\begin_inset Formula $\mathbf{U}$
\end_inset

 to 
\begin_inset Formula $\lambda_{n}\mathbf{n}=\mathbf{U}\cdot\mathbf{n}_{r}$
\end_inset

 where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{n} & =\sqrt{\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}}\,, & \mathbf{n} & =\frac{1}{\lambda_{n}}\mathbf{U}\cdot\mathbf{n}_{r}\end{aligned}
\label{eq:A-fiber-current}
\end{equation}

\end_inset

At time 
\begin_inset Formula $t^{u}$
\end_inset

 when generation 
\begin_inset Formula $u$
\end_inset

 forms in a stress-free state, it follows that the fiber material is now
 based on the orientation 
\begin_inset Formula $\mathbf{n}_{r}^{u}\equiv\mathbf{n}\left(t^{u}\right)$
\end_inset

, evaluated using 
\begin_inset Formula $\mathbf{U}\left(\mathbf{X},t^{u}\right)$
\end_inset

 as shown in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A-fiber-current"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In general, 
\begin_inset Formula $\mathbf{n}_{r}^{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 need not be collinear, therefore we can find the rotation 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

 that transforms 
\begin_inset Formula $\mathbf{n}_{r}^{u}$
\end_inset

 to 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{R}}=\left(1-\cos\gamma\right)\mathbf{m}\otimes\mathbf{m}+\cos\gamma\mathbf{I}-\mathbb{E}\cdot\left(\sin\gamma\,\mathbf{m}\right)\label{eq:A-R-fiber}
\end{equation}

\end_inset

with 
\begin_inset Formula $\cos\gamma=\mathbf{n}_{r}^{u}\cdot\mathbf{n}_{r}$
\end_inset

 and 
\begin_inset Formula $\sin\gamma\,\mathbf{m}=\mathbf{n}_{r}^{u}\times\mathbf{n}_{r}$
\end_inset

.
 In this expression, 
\begin_inset Formula $\mathbf{m}$
\end_inset

 is the unit vector along the rotation axis, 
\begin_inset Formula $\gamma$
\end_inset

 is the rotation angle about the axis, and 
\begin_inset Formula $\mathbb{E}$
\end_inset

 represents the (pseudo-)third-order permutation tensor whose components
 are equal to the permutation symbol 
\begin_inset Formula $\varepsilon_{ijk}$
\end_inset

.
 Thus, 
\begin_inset Formula $-\mathbb{E}\cdot\boldsymbol{\omega}$
\end_inset

 is the antisymmetric second-order tensor 
\begin_inset Formula $\boldsymbol{\Omega}$
\end_inset

 whose dual vector is 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

, from which it follows that 
\begin_inset Formula $\boldsymbol{\Omega}\cdot\mathbf{a}=\boldsymbol{\omega}\times\mathbf{a}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

.
 Here again, since 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

 represents a relative rotation between the material vectors 
\begin_inset Formula $\mathbf{n}_{r}^{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

, it is invariant to any transformation 
\begin_inset Formula $\mathbf{Q}$
\end_inset

.
\end_layout

\begin_layout Standard
In practice it is not necessary to evaluate 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A-R-fiber"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for each generation 
\begin_inset Formula $u$
\end_inset

 of each fiber in a material model; instead one can reset the fiber direction
 from 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 to 
\begin_inset Formula $\mathbf{n}_{r}^{u}=\mathbf{n}\left(u\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is evaluated as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:A-fiber-current"
plural "false"
caps "false"
noprefix "false"

\end_inset

, requiring only the storage of 
\begin_inset Formula $\mathbf{U}\left(\mathbf{X},u\right)$
\end_inset

 for each generation 
\begin_inset Formula $u$
\end_inset

.
 This scheme may also be used with continuous fiber distributions 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou16"
literal "false"

\end_inset

.
 As explained in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian22"
literal "false"

\end_inset

, this constitutive model for 
\begin_inset Formula $\bar{\mathbf{R}}$
\end_inset

 ensures that cyclical loading of a reactive viscoelastic fibrous material
 never produces compressive fiber stresses.
\end_layout

\begin_layout Subsubsection
Reduced Relaxation Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Reduced-Relaxation-Functions"

\end_inset


\end_layout

\begin_layout Standard
Reduced relaxation functions are monotonically decreasing functions of time
 
\begin_inset Formula $g\left(t\right)$
\end_inset

 that satisfy 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

 and 
\begin_inset Formula $\lim_{t\to\infty}g\left(t\right)=0$
\end_inset

.
 Many different forms of reduced relaxation functions are available in FEBio,
 given in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio User's Manual}}
\end_layout

\end_inset

.
 The simplest and most commonly used relaxation function is the exponential
 function 
\begin_inset Formula $g\left(t\right)=e^{-t/\tau}$
\end_inset

, where 
\begin_inset Formula $\tau$
\end_inset

 is the relaxation constant.
 In viscoelasticity theory it is common to use a combination of relaxation
 functions with distinct relaxation constants 
\begin_inset Formula $\tau_{i}$
\end_inset

, described as a Prony series of the form 
\begin_inset Formula 
\begin{equation}
g\left(t\right)=\frac{\sum_{i}\gamma_{i}e^{-t/\tau_{i}}}{\sum_{i}\gamma_{i}}\,.\label{eq:rrf-Prony}
\end{equation}

\end_inset

The coefficients 
\begin_inset Formula $\gamma_{i}$
\end_inset

 are normalized by 
\begin_inset Formula $\sum_{i}\gamma_{i}$
\end_inset

 to enforce 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

.
 Alternatively, we could have written
\begin_inset Formula 
\begin{equation}
g\left(t\right)=\sum_{i}\hat{\gamma}_{i}e^{-t/\tau_{i}}\,,\quad\sum_{i}\hat{\gamma}_{i}=1\,.\label{eq:rrf-Prony-alt}
\end{equation}

\end_inset

This type of relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

 is said to have a discrete spectrum of coefficients 
\begin_inset Formula $\hat{\gamma}_{i}$
\end_inset

 corresponding to each 
\begin_inset Formula $\tau_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
It is also possible to define a continuous relaxation spectrum 
\begin_inset Formula $\hat{\gamma}\left(\tau\right)$
\end_inset

 such that the reduced relaxation function is given by
\begin_inset Formula 
\begin{equation}
g\left(t\right)=\int_{0}^{\infty}\hat{\gamma}\left(\tau\right)e^{-t/\tau}\,d\tau\,.\label{eq:rrf-g-continuous-spectrum}
\end{equation}

\end_inset

To satisfy 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

 the continous relaxation spectrum 
\begin_inset Formula $\hat{\gamma}\left(\tau\right)$
\end_inset

 must satisfy
\begin_inset Formula 
\begin{equation}
\int_{0}^{\infty}\hat{\gamma}\left(\tau\right)\,d\tau=1\,.\label{eq:rrf-continuous-spectrum-constraint}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For example, Fung 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung72"
literal "false"

\end_inset

 proposed a relaxation spectrum of the form
\begin_inset Formula 
\begin{equation}
\hat{\gamma}\left(\tau\right)=\begin{cases}
\frac{1}{\ln\frac{\tau_{2}}{\tau_{1}}}\frac{1}{\tau} & \tau_{1}\le\tau\le\tau_{2}\\
0 & \text{otherwise}
\end{cases}\,.\label{eq:rrf-Fung-spectrum-72}
\end{equation}

\end_inset

When substituted into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-g-continuous-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

 it produces
\begin_inset Formula 
\begin{equation}
g\left(t\right)=\frac{\Gamma\left(0,\frac{t}{\tau_{2}}\right)-\Gamma\left(0,\frac{t}{\tau_{1}}\right)}{\ln\frac{\tau_{2}}{\tau_{1}}}=\frac{-\Ei\left(-\frac{t}{\tau_{2}}\right)+\Ei\left(-\frac{t}{\tau_{1}}\right)}{\ln\frac{\tau_{2}}{\tau_{1}}}\,,\label{eq:rrf-Fung-72}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma\left(a,z\right)$
\end_inset

 is the incomplete gamma function and 
\begin_inset Formula $\Ei\left(z\right)$
\end_inset

 is the exponential integral function, which satisfy 
\begin_inset Formula $\Gamma\left(0,z\right)=-\Ei\left(-z\right)$
\end_inset

.
 An alternative model proposed later by Fung 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung81"
literal "false"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
\hat{\gamma}\left(\tau\right)=\begin{cases}
\frac{1}{\tau_{2}-\tau_{1}} & \tau_{1}\le\tau\le\tau_{2}\\
0 & \text{otherwise}
\end{cases}\,,\label{eq:rrf-Fung-spectrum-81}
\end{equation}

\end_inset

which produces
\begin_inset Formula 
\begin{equation}
g\left(t\right)=\frac{\tau_{2}e^{-t/\tau_{2}}-\tau_{1}e^{-t/\tau_{1}}+t\left[\Ei\left(-\frac{t}{\tau_{2}}\right)-\Ei\left(-\frac{t}{\tau_{1}}\right)\right]}{\tau_{2}-\tau_{1}}\,.\label{eq:rrf-Fung-81}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
A generalization of Fung's earlier continuous relaxation spectrum may be
 derived from the work of Malkin 
\begin_inset CommandInset citation
LatexCommand citep
key "Malkin06"
literal "false"

\end_inset

 who proposed to use a function proportional to 
\begin_inset Formula $\tau^{-\beta}$
\end_inset

.
 If we constrain this spectrum to the range 
\begin_inset Formula $\tau_{1}\le\tau\le\tau_{2}$
\end_inset

 it takes the form (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Malkin-relaxation-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigRelaxationSpectrumMalkin.pdf
	lyxscale 50
	width 4in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Continuous relaxation spectrum 
\begin_inset Formula $\hat{\gamma}\left(\tau\right)$
\end_inset

 of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-Malkin-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

, based on the work of Malkin 
\begin_inset CommandInset citation
LatexCommand citep
key "Malkin06"
literal "false"

\end_inset

, for two representative values of 
\begin_inset Formula $\beta$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:Malkin-relaxation-spectrum"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\hat{\gamma}\left(\tau\right)=\begin{cases}
\frac{\beta-1}{\tau_{1}^{1-\beta}-\tau_{2}^{1-\beta}}\frac{1}{\tau^{\beta}} & \tau_{1}\le\tau\le\tau_{2}\\
0 & \text{otherwise}
\end{cases}\,.\label{eq:rrf-Malkin-spectrum}
\end{equation}

\end_inset

When substituted into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-g-continuous-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

 this continuous relaxation spectrum produces the reduced relaxation function
 (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Malkin-reduced-relaxation"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigRelaxationMalkin.pdf
	lyxscale 50
	width 4in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Malkin's reduced relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-Malkin"
plural "false"
caps "false"
noprefix "false"

\end_inset

, for 
\begin_inset Formula $\tau_{1}=10^{-2}$
\end_inset

 and 
\begin_inset Formula $\tau_{2}=10^{3}$
\end_inset

, for two representative values of 
\begin_inset Formula $\beta$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:Malkin-reduced-relaxation"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
g\left(t\right)=\frac{\left(\beta-1\right)t^{1-\beta}}{\tau_{1}^{1-\beta}-\tau_{2}^{1-\beta}}\left[\Gamma\left(\beta-1,\frac{t}{\tau_{2}}\right)-\Gamma\left(\beta-1,\frac{t}{\tau_{1}}\right)\right]\,.\label{eq:rrf-Malkin}
\end{equation}

\end_inset

In the limit as 
\begin_inset Formula $\beta\to1$
\end_inset

, the expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-Malkin"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-Fung-72"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For proper evaluation of the 
\begin_inset Formula $\Gamma$
\end_inset

 function we must have 
\begin_inset Formula $\beta\ge1$
\end_inset

.
\end_layout

\begin_layout Standard
Another example for a continuous relaxation spectrum is the exponential
 spectrum (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:exponential-relaxation-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigRelaxationSpectrumExponential.pdf
	lyxscale 50
	width 4in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Continuous exponential relaxation spectrum 
\begin_inset Formula $\hat{\gamma}\left(\tau\right)$
\end_inset

 of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-exponential-spectrum"
plural "false"
caps "false"
noprefix "false"

\end_inset

, for three representative values of 
\begin_inset Formula $\tau_{0}$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:exponential-relaxation-spectrum"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\hat{\gamma}\left(\tau\right)=\frac{1}{\tau_{0}}e^{-\tau/\tau_{0}}\,,\quad0\le\tau<\infty\,,\label{eq:rrf-exponential-spectrum}
\end{equation}

\end_inset

which produces
\begin_inset Formula 
\begin{equation}
g\left(t\right)=2\sqrt{\frac{t}{\tau_{0}}}K_{1}\left(2\sqrt{\frac{t}{\tau_{0}}}\right)\,,\label{eq:rrf-exponential}
\end{equation}

\end_inset

where 
\begin_inset Formula $K_{1}\left(z\right)$
\end_inset

 is the modified Bessel function of the second kind, of order 1 (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:relaxation-continuous-exponential"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigContinuousExponentialRelaxation.pdf
	lyxscale 50
	width 5in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Reduced relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

 of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rrf-exponential"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for continuous exponential relaxation spectrum, for three representative
 values of 
\begin_inset Formula $\tau_{0}$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:relaxation-continuous-exponential"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Viscous Friction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Viscous-Friction"

\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress in a viscous material 
\begin_inset CommandInset citation
LatexCommand citep
key "Coleman63"
literal "false"

\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\boldsymbol{\sigma}^{e}+\boldsymbol{\tau}\,,\label{eq:viscous-friction-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the elastic part of the stress as given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hyperelastic-stress-C"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress, which depends on the rate of deformation tensor
 
\begin_inset Formula $\mathbf{D}$
\end_inset

 (the symmetric part of the velocity gradient).
 For example, in an isotropic Newtonian viscous response, 
\begin_inset Formula $\boldsymbol{\tau}=\lambda\left(\text{tr}\mathbf{D}\right)\mathbf{I}+2\mu\mathbf{D}$
\end_inset

, where 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are viscosity coefficients.
 Since 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 reduces to zero under static loading (when 
\begin_inset Formula $\mathbf{D}=\mathbf{0}$
\end_inset

), it follows that 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the equilibrium response of this type of viscoelastic material.
 For a viscous fluid, the elastic stress tensor simplifies to 
\begin_inset Formula $\boldsymbol{\sigma}^{e}=-p\mathbf{I}$
\end_inset

, where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure.
 In a compressible fluid, 
\begin_inset Formula $p$
\end_inset

 is a function of the volumetric strain (e.g., a function of 
\begin_inset Formula $J$
\end_inset

) and the absolute temperature.
\end_layout

\begin_layout Standard
By the nature of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-friction-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we may interpret this type of viscous material microscopically as a spring
 and dashpot in parallel, often called a Voigt model in linear viscoelasticity
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bland60,Coleman61"
literal "false"

\end_inset

, though the general continuum mechanics expression of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-friction-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may encompass nonlinear behaviors for 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 and for 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

.
 The energy density dissipated in this type of material is 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}$
\end_inset

.
\end_layout

\begin_layout Standard
Though we include this type of viscoelastic model here for completeness,
 in practice, investigators in biomechanics have rarely adopted this model
 to describe biological tissues, because it predicts that the stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 becomes infinite under a step increase in strain.
\end_layout

\begin_layout Section
Reactive Damage Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Damage-Mechanics"

\end_inset


\end_layout

\begin_layout Subsection
Bond-Breaking Reaction
\end_layout

\begin_layout Standard
The reactive damage mechanics framework was first described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Nims16"
literal "false"

\end_inset

.
 It is based on constrained reactive mixtures of solids (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mixture-of-Solids"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and used to model damage in an elastic solid as a reaction that transforms
 intact (elastic) bonds into broken bonds,
\begin_inset Formula 
\begin{equation}
\mathcal{E}^{i}\to\mathcal{E}^{b}\,.\label{eq:dmg-reaction}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

 is the material associated with bonds 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha=i$
\end_inset

 for intact bonds and 
\begin_inset Formula $\alpha=b$
\end_inset

 for broken bonds).
 The material is modeled as a constrained mixture of these two constituents
 
\begin_inset Formula $\alpha$
\end_inset

.
 Whereas intact bonds may store free energy, broken bond sustain none.
 This framework assumes that isothermal conditions prevail.
 Thus, any heat generated by the dissipative damage reaction must be radiated
 from the continuum to preserve a constant temperature.
 In an isothermal framework, the free energy density is also equal to the
 strain energy density.
\end_layout

\begin_layout Standard
The referential mass density of the solid mixture is 
\begin_inset Formula $\rho_{r}$
\end_inset

 (mass of solid per volume in its referential, stress-free configuration),
 which remains constant throughout an analysis.
 The material associated with intact bonds has an apparent mass density
 
\begin_inset Formula $\rho_{r}^{i}$
\end_inset

 while that associated with broken bonds is 
\begin_inset Formula $\rho_{r}^{b},$
\end_inset

such that the mixture mass balance is satisfied by
\begin_inset Formula 
\begin{equation}
\rho_{r}=\rho_{r}^{i}+\rho_{r}^{b}\,.\label{eq:dmg-mass-balance}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Strain Energy Density and Stress
\end_layout

\begin_layout Standard
Let the specific free energy stored in intact bonds be represented by 
\begin_inset Formula $\psi\left(\mathbf{F}\right)$
\end_inset

; that of broken bonds is zero.
 Therefore, the free energy density of the mixture is
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=\rho_{r}^{i}\psi\left(\mathbf{F}\right)\,.\label{eq:dmg-FED}
\end{equation}

\end_inset

We may define the mass fraction 
\begin_inset Formula $w^{\alpha}$
\end_inset

 of bond species 
\begin_inset Formula $\alpha$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
w^{\alpha}=\frac{\rho_{r}^{\alpha}}{\rho_{r}}\,.\label{eq:dmg-mass-fraction}
\end{equation}

\end_inset

Now, the mixture mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-mass-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as 
\begin_inset Formula $\sum_{\alpha}w^{\alpha}=1$
\end_inset

, or more specifically,
\begin_inset Formula 
\begin{equation}
w^{i}+w^{b}=1\,.\label{eq:dmg-massfraction-balance}
\end{equation}

\end_inset

We may also rewrite the mixture free energy density in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-FED"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=w^{i}\rho_{r}\psi\left(\mathbf{F}\right)=\left(1-w^{b}\right)\rho_{r}\psi\left(\mathbf{F}\right)\,,\label{eq:dmg-FED-redux}
\end{equation}

\end_inset

where we have made use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-massfraction-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The corresponding Cauchy stress may be evaluated using the standard hyperelasti
city formula,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=J^{-1}\frac{\partial\Psi_{r}}{\partial\mathbf{F}}\cdot\mathbf{F}^{T}=\left(1-w^{b}\right)\frac{\rho_{r}}{J}\frac{\partial\psi}{\partial\mathbf{F}}\cdot\mathbf{F}^{T}.\label{eq:dmg-stress}
\end{equation}

\end_inset

These relation show that the free energy density and stress of a damaged
 material are scaled by the mass fraction 
\begin_inset Formula $w^{i}=1-w^{b}$
\end_inset

 of remaining intact bonds.
 Comparing these formulas to those of classical damage mechanics 
\begin_inset CommandInset citation
LatexCommand citep
key "Kachanov58,Rabotnov80,Chaboche81,Lemaitre84,Lemaitre85,Simo87a"
literal "false"

\end_inset

, it becomes immediately apparent that the classical damage variable 
\begin_inset Formula $D$
\end_inset

 appearing in those theories is equivalent to the mass fraction 
\begin_inset Formula $w^{b}$
\end_inset

 of broken bonds,
\begin_inset Formula 
\begin{equation}
D\equiv w^{b}.\label{eq:dmg-variable}
\end{equation}

\end_inset

To further clarify this equivalence, we may let 
\begin_inset Formula $\Psi_{0}\equiv\rho_{r}\psi$
\end_inset

 represent the free energy density of an intact elastic solid, such that
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-FED-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as 
\begin_inset Formula $\Psi_{r}=\left(1-D\right)\Psi_{0}$
\end_inset

.
 Similarly, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as 
\begin_inset Formula $\boldsymbol{\sigma}=\left(1-D\right)\boldsymbol{\sigma}_{0}$
\end_inset

, where 
\begin_inset Formula $\boldsymbol{\sigma}_{0}$
\end_inset

 is the stress in the intact elastic solid, derived from the hyperelasticity
 relation 
\begin_inset Formula $\boldsymbol{\sigma}_{0}=J^{-1}\left(\partial\Psi_{0}/\partial\mathbf{F}\right)\cdot\mathbf{F}^{T}$
\end_inset

.
\end_layout

\begin_layout Standard
For nearly-incompressible hyperelastic materials (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Nearly-Incompressible-Hyperelast"
plural "false"
caps "false"
noprefix "false"

\end_inset

), the strain energy density of the intact material has the form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-SED"
plural "false"
caps "false"
noprefix "false"

\end_inset

, thus 
\begin_inset Formula $\Psi_{0}\left(\mathbf{C}\right)=\tilde{\Psi}_{0}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)$
\end_inset

.
 In this case, we assume that the damage only affects the distortional part
 of the strain energy density 
\begin_inset Formula $\tilde{\Psi}_{0}\left(\tilde{\mathbf{C}}\right)$
\end_inset

, consistent with the general framework advocated in 
\begin_inset CommandInset citation
LatexCommand citep
key "Holzapfel00"
literal "false"

\end_inset

.
 Thus, for 
\emph on
uncoupled damage
\emph default
, we assume that 
\begin_inset Formula $\Psi_{r}\left(\mathbf{C}\right)=\left(1-D\right)\tilde{\Psi}_{0}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)$
\end_inset

.
 The resulting damage stress similarly takes the form 
\begin_inset Formula $\boldsymbol{\sigma}=\left(1-D\right)\dev\tilde{\boldsymbol{\sigma}}_{0}+p\mathbf{I}$
\end_inset

, consistent with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-Cauchy-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

, where 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{0}$
\end_inset

 is evaluated from 
\begin_inset Formula $\tilde{\Psi}_{0}\left(\tilde{\mathbf{C}}\right)$
\end_inset

 as given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-Cauchy-stress-tilde"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 is evaluated from 
\begin_inset Formula $U\left(J\right)$
\end_inset

 as given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:UC-p"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
When investigating the damage mechanics of tension-bearing fibrous materials,
 described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Tension-Bearing-Fiber-Materials"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it is important to use the unconstrained version of the fiber and damage
 mechanics models, even when the fibers are embedded in a ground matrix
 with a nearly-incompressible response (uncoupled formulation).
 This is a necessary requirement since uncoupled fiber formulations are
 now understood to be non-physical.
 Nevertheless, for historical reasons, FEBio allows users to use uncoupled
 fiber formulations in an uncoupled damage material.
\end_layout

\begin_layout Subsection
Damage Criterion
\end_layout

\begin_layout Standard
At each material point 
\begin_inset Formula $\mathbf{X}$
\end_inset

 in the continuum, damage occurs when a scalar damage (or failure) measure
 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 achieves a critical value 
\begin_inset Formula $\Xi_{m}$
\end_inset

 over the loading history,
\begin_inset Formula 
\begin{equation}
\Xi_{m}\left(\mathbf{X}\right)=\max_{-\infty<s\le t}\Xi\left(\mathbf{F}\left(\mathbf{X},s\right)\right)\,.\label{eq:dmg-critical-measure}
\end{equation}

\end_inset

The scalar damage measure 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 must be invariant to orthogonal transformations 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 that preserve material symmetry, or else the damage formulation would not
 be observer-independent.
 For example, for isotropic materials, 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 must be an isotropic function of the deformation, in which case it should
 be expressed as 
\begin_inset Formula $\Xi\left(\mathbf{U}\right)$
\end_inset

 or 
\begin_inset Formula $\Xi\left(\mathbf{E}\right)$
\end_inset

, where 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is the right stretch tensor in the polar decomposition 
\begin_inset Formula $\mathbf{F}=\mathbf{R}\cdot\mathbf{U}$
\end_inset

 of the deformation gradient, and
\begin_inset Formula 
\begin{equation}
\mathbf{E}=\frac{1}{2}\left(\mathbf{F}^{T}\cdot\mathbf{F}-\mathbf{I}\right)=\frac{1}{2}\left(\mathbf{U}^{2}-\mathbf{I}\right)\label{eq:Lagrange-strain-tensor}
\end{equation}

\end_inset

is the Green-Lagrange strain tensor.
 It follows that
\begin_inset Formula 
\[
\left(\frac{\partial\mathbf{E}}{\partial\mathbf{U}}\right)_{ijmn}=\frac{1}{2}\left(\frac{1}{2}\left(\delta_{im}U_{nj}+\delta_{in}U_{mj}\right)+\frac{1}{2}\left(U_{im}\delta_{jn}+U_{in}\delta_{jm}\right)\right)\,.
\]

\end_inset

For anisotropic materials where 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the unit normal to a symmetry plane and 
\begin_inset Formula $\mathbf{A}=\mathbf{a}\otimes\mathbf{a}$
\end_inset

, the damage measure 
\begin_inset Formula $\Xi$
\end_inset

 must satisfy
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U},\mathbf{A}\right)=\Xi\left(\mathbf{Q}\cdot\mathbf{U}\cdot\mathbf{Q}^{T},\mathbf{Q}\cdot\mathbf{A}\cdot\mathbf{Q}^{T}\right)\,,\label{eq:dmg-criterion-invariance}
\end{equation}

\end_inset

for transformations 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 that satisfy 
\begin_inset Formula $\mathbf{Q}\cdot\mathbf{A}\cdot\mathbf{Q}^{T}=\mathbf{A}$
\end_inset

 (or 
\begin_inset Formula $\mathbf{Q}\cdot\mathbf{a}=\mathbf{a}$
\end_inset

).
 We may replace 
\begin_inset Formula $\mathbf{U}$
\end_inset

 with 
\begin_inset Formula $\mathbf{E}$
\end_inset

 in the above expression.
\end_layout

\begin_layout Standard
We assume that the amount of damage (the fraction 
\begin_inset Formula $D$
\end_inset

 of broken bonds) is given by the function of state
\begin_inset Formula 
\begin{equation}
D=F\left(\Xi_{m}\right)\,,\label{eq:dmg-CDF}
\end{equation}

\end_inset

where 
\begin_inset Formula $0\le F\left(\Xi_{m}\right)\le1$
\end_inset

.
 As shown in 
\begin_inset CommandInset citation
LatexCommand citep
key "Nims16"
literal "false"

\end_inset

, the Clausius-Duhem inequality imposes the constraint that 
\begin_inset Formula $F\left(\Xi_{m}\right)$
\end_inset

 must be a monotonically increasing function of its argument.
 Therefore, we may understand 
\begin_inset Formula $F$
\end_inset

 to represent a cumulative density function (CDF), whose derivative 
\begin_inset Formula $f\left(\Xi_{m}\right)=F^{\prime}\left(\Xi_{m}\right)$
\end_inset

 is a probability distribution function (PDF) that describes the probability
 of bonds breaking at the specific threshold 
\begin_inset Formula $\Xi_{m}$
\end_inset

.
\end_layout

\begin_layout Subsection
Reaction Kinetics and Thermodynamics
\end_layout

\begin_layout Standard
The axiom of mass balance in a reactive constrained mixture reduces to
\begin_inset Formula 
\begin{equation}
\dot{\rho}_{r}^{\alpha}=\hat{\rho}_{r}^{\alpha}\,,\label{eq:dmg-mass-balance-alpha}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dot{\rho}_{r}^{\alpha}$
\end_inset

 is the material time derivative of 
\begin_inset Formula $\rho_{r}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\hat{\rho}_{r}^{\alpha}$
\end_inset

 is a function of state representing the referential mass supply density
 to constituent 
\begin_inset Formula $\alpha$
\end_inset

 due to reactions with all other constituents.
 In the damage framework, the above relations show that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\rho_{r}^{i} & =\rho_{r}\left(1-F\left(\Xi_{m}\right)\right)\\
\rho_{r}^{b} & =\rho_{r}F\left(\Xi_{m}\right)
\end{aligned}
\,.\label{eq:dmg-mass-densities}
\end{equation}

\end_inset

Substituting these expressions into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-mass-balance-alpha"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows that the referential mass density supplies are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\rho}_{r}^{i} & =-\rho_{r}\dot{F}\left(\Xi_{m}\right)\\
\hat{\rho}_{r}^{b} & =\rho_{r}\dot{F}\left(\Xi_{m}\right)
\end{aligned}
\,,\label{eq:dmg-mass-supplies}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\dot{F}\left(\Xi_{m}\right)=\begin{cases}
\left.f\left(\Xi\right)\dot{\Xi}\right|_{\Xi_{m}} & \text{advancing damage}\\
0 & \text{otherwise}
\end{cases}\,.\label{eq:dmg-CDF-mtd}
\end{equation}

\end_inset

In these expressions, the damage is advancing when 
\begin_inset Formula $\Xi_{m}$
\end_inset

 increases over two consecutive time points.
 In this expression for 
\begin_inset Formula $\dot{F}$
\end_inset

 we need to evaluate
\begin_inset Formula 
\begin{equation}
\dot{\Xi}\left(\mathbf{U}\right)=\frac{\partial\Xi}{\partial\mathbf{U}}:\dot{\mathbf{U}}=\mathbf{N}:\dot{\mathbf{U}}\,,\label{eq:dmg-Xsi-dot}
\end{equation}

\end_inset

where we defined 
\begin_inset Formula 
\begin{equation}
\mathbf{N}\equiv\frac{\partial\Xi}{\partial\mathbf{U}}\,\label{eq:dmg-surface-normal}
\end{equation}

\end_inset

to represent the tensorial normal to the damage hypersurface, which needs
 to be evaluated at 
\begin_inset Formula $\Xi_{m}$
\end_inset

.
\end_layout

\begin_layout Standard
In this isothermal damage framework it can be shown from the energy balance
 that a heat supply density 
\begin_inset Formula $\rho_{r}r$
\end_inset

 must radiate the bond-breaking energy out of the continuum to maintain
 isothermal conditions, where
\begin_inset Formula 
\begin{equation}
\rho_{r}r=\hat{\rho}_{r}^{i}\psi\left(\mathbf{F}\right)=-\rho_{r}\dot{F}\left(\Xi_{m}\right)\psi\left(\mathbf{F}\right)\,.\label{eq:dmg-heat-supply}
\end{equation}

\end_inset

Since 
\begin_inset Formula $F$
\end_inset

 is a monotonically increasing function of 
\begin_inset Formula $\Xi_{m}$
\end_inset

, its material time derivative 
\begin_inset Formula $\dot{F}$
\end_inset

 is always positive when the damage is increasing, and zero otherwise as
 per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-Xsi-dot"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Since the specific strain energy 
\begin_inset Formula $\psi\left(\mathbf{F}\right)$
\end_inset

 is always positive, it follows that the specific heat supply 
\begin_inset Formula $r=-\dot{F}\left(\Xi_{m}\right)\psi\left(\mathbf{F}\right)$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-heat-supply"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is negative or zero, consistent with the expectation that heat needs to
 leave the continuum to maintain isothermal conditions.
\end_layout

\begin_layout Subsection
Constitutive Models for Damage and Yield Criteria
\end_layout

\begin_layout Standard
Constitutive models for the damage or yield measure 
\begin_inset Formula $\Xi\left(\mathbf{U}\right)$
\end_inset

 may be derived from energy- or stress-based potentials or (less commonly)
 strain measures.
 A summary of constitutive models for damage or yield criteria currently
 implemented in FEBio is presented below.
\end_layout

\begin_layout Subsubsection
Strain Energy Density
\end_layout

\begin_layout Standard
It may be assumed that damage occurs when the strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 achieves a certain threshold 
\begin_inset Formula $\Psi_{m}$
\end_inset

.
 In that case, the constitutive model for the damage measure is
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\Psi_{r}\left(\mathbf{U}\right)\,.\label{eq:dmg-model-SED}
\end{equation}

\end_inset

This damage measure is valid for isotropic or anisotropic materials, since
 the strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 must satisfy the frame-invariance of eq.
\begin_inset CommandInset ref
LatexCommand pageref
reference "eq:dmg-criterion-invariance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by construction.
 The resulting damage surface normal is
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{\partial\Psi_{r}}{\partial\mathbf{U}}=\frac{1}{2}\left(\mathbf{S}\cdot\mathbf{U}+\mathbf{U}\cdot\mathbf{S}\right)\,,\label{eq:dmg-model-SED-N}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}=\partial\Psi_{r}/\partial\mathbf{E}=J\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}$
\end_inset

 is the second Piola-Kirchhoff stress associated with the material.
\end_layout

\begin_layout Subsubsection
Simo Damage Criterion
\end_layout

\begin_layout Standard
Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87,Simo87a"
literal "false"

\end_inset

 proposed a damage criterion related to the strain energy density,
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\sqrt{2\Psi_{r}\left(\mathbf{U}\right)}\,.\label{eq:dmg-model-Simo}
\end{equation}

\end_inset

This damage measure is valid for isotropic or anisotropic materials, since
 the strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 must satisfy the frame-invariance of eq.
\begin_inset CommandInset ref
LatexCommand pageref
reference "eq:dmg-criterion-invariance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by construction.
 Its resulting damage surface normal is
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{1}{\sqrt{2\Psi_{r}}}\frac{1}{2}\left(\mathbf{S}\cdot\mathbf{U}+\mathbf{U}\cdot\mathbf{S}\right)\,,\label{eq:dmg-model-Simo-N}
\end{equation}

\end_inset

where we have used the result of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-model-SED-N"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The normal reduces to the null tensor in the limit when 
\begin_inset Formula $\Psi_{r}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 tend to zero.
\end_layout

\begin_layout Subsubsection
Specific Strain Energy
\end_layout

\begin_layout Standard
It may be assumed that damage occurs when the specific strain energy 
\begin_inset Formula $\Psi_{r}/\rho_{r}$
\end_inset

 achieves a certain threshold 
\begin_inset Formula $\psi_{m}$
\end_inset

.
 In that case, the constitutive model for the damage measure is
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\frac{1}{\rho_{r}}\Psi_{r}\left(\mathbf{U}\right)\,.\label{eq:dmg-model-SSE}
\end{equation}

\end_inset

This damage measure is valid for isotropic or anisotropic materials, since
 the strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 must satisfy the frame-invariance of eq.
\begin_inset CommandInset ref
LatexCommand pageref
reference "eq:dmg-criterion-invariance"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by construction.
 The resulting damage surface normal is
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{1}{\rho_{r}}\frac{\partial\Psi_{r}}{\partial\mathbf{U}}=\frac{1}{2\rho_{r}}\left(\mathbf{S}\cdot\mathbf{U}+\mathbf{U}\cdot\mathbf{S}\right)\,,\label{eq:dmg-model-SSE-N}
\end{equation}

\end_inset

where we have used the result of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-model-SED-N"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Von Mises Stress
\end_layout

\begin_layout Standard
For this criterion it is assumed that damage or yield is initiated by increases
 in the von Mises (or effective) stress, 
\begin_inset Formula $\sigma_{Y}$
\end_inset

.
 Thus,
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\sigma_{Y}\left(\mathbf{U}\right)=\sqrt{\frac{3}{2}\dev\boldsymbol{\sigma}:\dev\boldsymbol{\sigma}}\,,\label{eq:dmg-model-VMS}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dev\boldsymbol{\sigma}$
\end_inset

 is the deviatoric part of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

.
 To evaluate the damage surface normal in this case, we must use the chain
 rule,
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}:\frac{\partial\boldsymbol{\sigma}}{\partial\mathbf{F}}:\frac{\partial\mathbf{F}}{\partial\mathbf{U}}\,.\label{eq:dmg-normal-chain-rule}
\end{equation}

\end_inset

From the hyperelasticity relation in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 it can be shown that
\begin_inset Formula 
\begin{equation}
\frac{\partial\boldsymbol{\sigma}}{\partial\mathbf{F}}=\left(\boldsymbol{\mathcal{C}}+\mathbf{I}\oslash\boldsymbol{\sigma}+\boldsymbol{\sigma}\obslash\mathbf{I}-\boldsymbol{\sigma}\otimes\mathbf{I}\right)\cdot\mathbf{F}^{-T}\,,\label{eq:dmg-stress-tangent}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the fourth-order spatial elasticity tensor associated with the strain
 energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

.
 Then, it can be shown that
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{1}{2}\mathbf{R}^{T}\cdot\mathbf{M}\cdot\mathbf{R}\cdot\mathbf{U}^{-1}+\frac{1}{2}\mathbf{U}^{-1}\cdot\mathbf{R}^{T}\cdot\mathbf{M}^{T}\cdot\mathbf{R}\,,\label{eq:dmg-N-redux}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{M}=\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}:\boldsymbol{\mathcal{C}}+2\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}\cdot\boldsymbol{\sigma}-\left(\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}:\boldsymbol{\sigma}\right)\mathbf{I}\,.\label{eq:dmg-N-M}
\end{equation}

\end_inset

From the von Mises criterion in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-model-VMS"
plural "false"
caps "false"
noprefix "false"

\end_inset

, it can be shown that
\begin_inset Formula 
\begin{equation}
\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}=\frac{3}{2\sigma_{Y}}\dev\boldsymbol{\sigma}\,.\label{eq:dmg-VMS-tangent}
\end{equation}

\end_inset

Substituting Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-M"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-VMS-tangent"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides the surface normal 
\begin_inset Formula $\mathbf{N}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Maximum Normal Stress
\end_layout

\begin_layout Standard
For this criterion, the damage measure takes the form
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\sigma_{1}\,,\label{eq:dmg-model-MNS}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma_{1}$
\end_inset

 is the maximum principal stress (under the assumption that the three principal
 stresses of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 are ordered such that 
\begin_inset Formula $\sigma_{1}\ge\sigma_{2}\ge\sigma_{3}$
\end_inset

).
 To evaluate the damage surface normal, we may use Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-M"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where
\begin_inset Formula 
\begin{equation}
\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}=\frac{\partial\sigma_{1}}{\partial\boldsymbol{\sigma}}=\mathbf{n}_{1}\otimes\mathbf{n}_{1}\,.\label{eq:dmg-MNS-tangent}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{n}_{1}$
\end_inset

 is a unit vector along the principal direction of maximum normal stress
 (the eigenvector of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 corresponding to the eigenvalue 
\begin_inset Formula $\sigma_{1}$
\end_inset

).
\end_layout

\begin_layout Subsubsection
Maximum Shear Stress
\end_layout

\begin_layout Standard
For this criterion, the damage measure takes the form
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=\frac{\sigma_{1}-\sigma_{3}}{2}\,,\label{eq:dmg-model-MSS}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and 
\begin_inset Formula $\sigma_{3}$
\end_inset

 are the maximum and minimum principal normal stresses (under the assumption
 that the three principal stresses of 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 are ordered such that 
\begin_inset Formula $\sigma_{1}\ge\sigma_{2}\ge\sigma_{3}$
\end_inset

).
 To evaluate the damage surface normal, we may use Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-M"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where
\begin_inset Formula 
\begin{equation}
\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}=\frac{1}{2}\left(\mathbf{n}_{1}\otimes\mathbf{n}_{1}-\mathbf{n}_{3}\otimes\mathbf{n}_{3}\right)\,.\label{eq:dmg-MSS-tangent}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{n}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}_{3}$
\end_inset

 are unit vectors along the principal directions of maximum and minimum
 normal stress, respectively.
\end_layout

\begin_layout Subsubsection
Drucker Shear Stress
\end_layout

\begin_layout Standard
This criterion is based on the yield criterion for plasticity introduced
 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Drucker49"
literal "false"

\end_inset

.
 Its damage (or yield) measure takes the form
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=k=\left(J_{2}^{3}-cJ_{3}^{2}\right)^{1/6}\,,\label{eq:dmg-model-Drucker}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{2}=\frac{1}{2}\dev\boldsymbol{\sigma}:\dev\boldsymbol{\sigma}$
\end_inset

, 
\begin_inset Formula $J_{3}=\det\left(\dev\boldsymbol{\sigma}\right)$
\end_inset

, 
\begin_inset Formula $k$
\end_inset

 is the yield limit in simple shear and 
\begin_inset Formula $c$
\end_inset

 is a user-specified non-dimensional material constant which must lie in
 the range 
\begin_inset Formula $-\frac{27}{8}\le c\le\frac{9}{4}$
\end_inset

.
 To better understand the meaning of 
\begin_inset Formula $k$
\end_inset

, consider uniaxial loading of a bar which yields at the normal stress value
 of 
\begin_inset Formula $\sigma_{y}$
\end_inset

.
 In this case,
\begin_inset Formula 
\begin{equation}
k=\frac{\sigma_{y}}{\sqrt{3}}\left(1-\frac{4}{27}c\right)^{1/6}\quad\frac{\sigma_{y}}{\sqrt{3}}\left(\frac{2}{3}\right)^{1/6}\le k\le\frac{\sigma_{y}}{\sqrt{3}}\left(\frac{3}{2}\right)^{1/6}\,.\label{eq:dmg-Drucker-range}
\end{equation}

\end_inset

In the special case when 
\begin_inset Formula $c=0$
\end_inset

 the Drucker criterion reduces to the von Mises criterion, with 
\begin_inset Formula $k=\sigma_{y}/\sqrt{3}$
\end_inset

.
 To evaluate the damage or yield surface normal, we may use Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dmg-N-M"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where
\begin_inset Formula 
\begin{equation}
\frac{\partial\Xi}{\partial\boldsymbol{\sigma}}=\frac{1}{k^{5}}\left(\frac{J_{2}^{2}}{2}\dev\boldsymbol{\sigma}-\frac{cJ_{3}^{2}}{3}\dev\left(\dev\boldsymbol{\sigma}\right)^{-1}\right)\,.\label{eq:dmg-Drucker-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Maximum Normal Lagrange Strain
\end_layout

\begin_layout Standard
The Lagrange strain tensor 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is related to 
\begin_inset Formula $\mathbf{F}$
\end_inset

 via eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Lagrange-strain-tensor"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Its maximum principal value is denoted by 
\begin_inset Formula $E_{1}$
\end_inset

.
 For this criterion, we let
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=E_{1}\,.\label{eq:dmg-model-MNLS}
\end{equation}

\end_inset

Then, the damage surface normal is given by
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{\partial E_{1}}{\partial\mathbf{U}}=\sqrt{1+2E_{1}}\mathbf{n}_{1}\otimes\mathbf{n}_{1}\,,\label{eq:dmg-MNLS-N}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{1}$
\end_inset

 is a unit vector along the principal direction of normal strain.
\end_layout

\begin_layout Standard
Note that the maximum normal Lagrange strain is a kinematic measure, thus
 it does not represent an intrinsic material property.
 Though FEBio allows users to specify this criterion, it is strongly recommended
 to employ stress- or strain-energy-density-based failure or yield criteria
 in practice.
\end_layout

\begin_layout Subsubsection
Octahedral Lagrange Strain
\end_layout

\begin_layout Standard
The octahedral Lagrange strain is given by
\begin_inset Formula 
\begin{equation}
e\left(\mathbf{U}\right)=\sqrt{\frac{2}{3}\dev\mathbf{E}:\dev\mathbf{E}}\,,\label{eq:octahedral-Lagrange-strain}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dev\mathbf{E}$
\end_inset

 is the deviatoric part of the Lagrange strain tensor,
\begin_inset Formula 
\begin{equation}
\dev\mathbf{E}=\mathbf{E}-\frac{1}{3}\tr\left(\mathbf{E}\right)\mathbf{I}\,,\label{eq:deviatoric-Lagrange-strain}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Lagrange-strain-tensor"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For this damage measure we let
\begin_inset Formula 
\begin{equation}
\Xi\left(\mathbf{U}\right)=e\left(\mathbf{U}\right)\,.\label{eq:dmg-model-OLS}
\end{equation}

\end_inset

The damage surface normal can be evaluated from
\begin_inset Formula 
\begin{equation}
\mathbf{N}=\frac{\partial e}{\partial\mathbf{E}}:\frac{\partial\mathbf{E}}{\partial\mathbf{U}}=\frac{1}{3e}\left(\dev\mathbf{E}\cdot\mathbf{U}+\mathbf{U}\cdot\dev\mathbf{E}\right)\,,\label{eq:dmg-OLS-N}
\end{equation}

\end_inset

where we used
\begin_inset Formula 
\begin{equation}
\frac{\partial e}{\partial\mathbf{E}}=\frac{2}{3e}\dev\mathbf{E}\label{eq:dmg-e-tangent}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{E}}{\partial\mathbf{U}}=\frac{1}{2}\frac{\partial\mathbf{U}^{2}}{\partial\mathbf{U}}=\frac{1}{2}\left(\mathbf{I}\odot\mathbf{U}+\mathbf{U}\odot\mathbf{I}\right)\,.\label{eq:dmg-E-U-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note that the octahedral Lagrange strain is a kinematic measure, thus it
 does not represent an intrinsic material property.
 Though FEBio allows users to specify this criterion, it is strongly recommended
 to employ stress- or strain-energy-density-based failure or yield criteria
 in practice.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Plasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Plasticity"

\end_inset


\end_layout

\begin_layout Standard
Reactive plasticity models a material as a mixture of bonds that break in
 response to loading and reform in a stressed state 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "false"

\end_inset

.
 This framework is based on constrained reactive mixtures of solids (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mixture-of-Solids"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Elastic-Perfectly Plastic Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elastic-Perfectly-Plastic-Response"

\end_inset


\end_layout

\begin_layout Standard
This section describes a reactive framework in which all loaded bonds in
 an elemental region break and reform simultaneously into a stressed state
 with a new reference configuration, resulting in elastic-perfectly plastic
 behavior.
 The theory outlined here is similar to reactive viscoelasticity (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian15,Nims17"
literal "false"

\end_inset

, although bonds now reform in a stressed rather than a stress-free state.
\end_layout

\begin_layout Standard
The elastic response of this material is achieved when bonds have not yet
 failed in response to loading.
 In this case it is assumed that the bonds belong to generation 
\begin_inset Formula $s$
\end_inset

 (the master constituent) whose reference configuration is represented by
 material points located at 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

.
 When bonds break and reform at time 
\begin_inset Formula $t^{\sigma}$
\end_inset

, a new 
\begin_inset Formula $\sigma-$
\end_inset

generation is formed.
 Consider that bonds of the 
\begin_inset Formula $\sigma-$
\end_inset

generation yield based on a scalar 
\shape italic
yield measure
\shape default
 
\begin_inset Formula $\Phi\left(\mathbf{U}^{\sigma}\right)$
\end_inset

 (e.g., the von Mises stress), where 
\begin_inset Formula $\mathbf{U}^{\sigma}$
\end_inset

 is the right stretch tensor from the polar decomposition 
\begin_inset Formula $\mathbf{F}^{\sigma}=\mathbf{R}\cdot\mathbf{U}^{\sigma}$
\end_inset

, and 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is the rotation tensor, assumed to also be the rotation tensor of 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

.
 Thus, according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\mathbf{U}^{s}=\mathbf{U}^{\sigma}\cdot\mathbf{F}^{\sigma s}$
\end_inset

.
\end_layout

\begin_layout Standard
Let the 
\shape italic
yield threshold
\shape default
 for the 
\begin_inset Formula $\sigma-$
\end_inset

generation be given by 
\begin_inset Formula $\Phi_{m}$
\end_inset

, which represents the threshold value at which yielding begins.
 For 
\begin_inset Formula $\sigma-$
\end_inset

generation bonds the 
\shape italic
yield criterion
\shape default
 may thus be defined as
\begin_inset Formula 
\begin{equation}
\varphi\left(\mathbf{U}^{\sigma}\right)=\Phi\left(\mathbf{U}^{\sigma}\right)-\Phi_{m}\le0\,,\label{eq:plasticity-yield-criterion}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi\left(\mathbf{U}^{\sigma}\right)$
\end_inset

 represents the 
\shape italic
yield surface
\shape default
 of 
\begin_inset Formula $\sigma-$
\end_inset

generation bonds whose 
\shape italic
tensorial normal
\shape default
 is
\begin_inset Formula 
\begin{equation}
\mathbf{N}^{\sigma}=\frac{\partial\varphi}{\partial\mathbf{U}^{\sigma}}=\frac{\partial\Phi\left(\mathbf{U}^{\sigma}\right)}{\partial\mathbf{U}^{\sigma}}\,.\label{eq:plasticity-yield-surface-normal}
\end{equation}

\end_inset

When yield thresholds are formulated in stress space, the dependence on
 the deformation takes the form 
\begin_inset Formula $\Phi=\Phi\left(\boldsymbol{\sigma}^{\sigma}\left(\mathbf{U}^{\sigma}\right)\right)$
\end_inset

.
\end_layout

\begin_layout Standard
Consider two consecutive generations 
\begin_inset Formula $\sigma$
\end_inset

, denoted by 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

, such that the bond-breaking-and-reforming reaction is 
\begin_inset Formula $\mathcal{E}^{u}\to\mathcal{E}^{v}$
\end_inset

.
 Upon breaking of the 
\begin_inset Formula $u-$
\end_inset

generation to form the 
\begin_inset Formula $v-$
\end_inset

generation the plastic consistency condition is given by 
\begin_inset Formula $d\varphi=0$
\end_inset

, which reduces to
\begin_inset Formula 
\begin{equation}
\mathbf{N}^{u}\left(u\right):\left(\mathbf{U}^{v}\left(v\right)-\mathbf{U}^{u}\left(u\right)\right)=0\,.\label{eq:plastic-consistency-condition}
\end{equation}

\end_inset

The constitutive model for 
\begin_inset Formula $\mathbf{F}^{\sigma s}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\left(\mathbf{F}^{vs}\right)^{-1}=\left(\mathbf{F}^{us}\right)^{-1}\cdot\left(\mathbf{I}-\lambda\hat{\mathbf{N}}^{v}\right)\label{eq:plasticity-Fvsi-normality}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{N}}^{v}=\frac{\mathbf{N}^{v}}{\sqrt{\mathbf{N}^{v}:\mathbf{N}^{v}}}\,
\end{equation}

\end_inset

is the unit tensor along 
\begin_inset Formula $\mathbf{N}^{v}$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 is a non-dimensional scalar which may be determined analytically by enforcing
 the plastic consistency condition in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plastic-consistency-condition"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 When the plastic deformation is assumed to be isochoric the solution for
 
\begin_inset Formula $\lambda$
\end_inset

 is obtained while enforcing 
\begin_inset Formula $\det\mathbf{F}^{\sigma s}=1$
\end_inset

.
 For the earliest yielded generation 
\begin_inset Formula $u$
\end_inset

, the preceding 
\begin_inset Formula $s-$
\end_inset

generation is in the elastic regime; therefore, 
\begin_inset Formula $\mathbf{F}^{us}=\mathbf{I}$
\end_inset

 at the start of the recursive relation in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticity-Fvsi-normality"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The stress response of this solid mixture is given generically by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mixture-stress-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

, specialized to the case where each generation 
\begin_inset Formula $\sigma$
\end_inset

 is assumed to have the same constitutive model 
\begin_inset Formula $\Psi_{0}$
\end_inset

 for its strain energy density, 
\begin_inset Formula $\Psi_{r}^{\sigma}=J^{\sigma s}\Psi_{0}$
\end_inset

.
 For example, in the case of the three consecutive 
\begin_inset Formula $\sigma$
\end_inset

 generations 
\begin_inset Formula $s$
\end_inset

, 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

, the strain energy density is 
\begin_inset Formula $\Psi_{r}\left(\mathbf{F}^{s}\right)=\sum_{\sigma}w^{\sigma}J^{\sigma s}\Psi_{0}\left(\mathbf{U}^{\sigma}\right)$
\end_inset

 and the stress is
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=w^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{U}^{s}\right)+w^{u}\boldsymbol{\sigma}_{0}\left(\mathbf{U}^{u}\right)+w^{v}\boldsymbol{\sigma}_{0}\left(\mathbf{U}^{v}\right)\,,\label{eq:epp-mixture-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{U}^{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}^{v}$
\end_inset

 are evaluated from 
\begin_inset Formula $\mathbf{U}^{s}\cdot\left(\mathbf{F}^{\sigma s}\right)^{-1}=\mathbf{U}^{\sigma}$
\end_inset

 (
\begin_inset Formula $\sigma=u,v$
\end_inset

) and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticity-Fvsi-normality"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and 
\begin_inset Formula $\boldsymbol{\sigma}_{0}$
\end_inset

 is given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:febio-stress-function"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For an elastic-perfectly plastic response the bond mass fractions are constitut
ively assumed to satisfy
\begin_inset Formula 
\begin{equation}
\begin{aligned}w^{s} & =1-H\left(t-t^{u}\right)\end{aligned}
\,,\quad w^{u}=H\left(t-t^{u}\right)-H\left(t-t^{v}\right)\,,\quad\begin{aligned}w^{v} & =H\left(t-t^{v}\right)\,,\end{aligned}
\label{eq:epp-mass-fractions}
\end{equation}

\end_inset

where 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the Heaviside unit step function.
 The corresponding constitutive models for 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 may be obtained by substituting these expressions into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-alpha-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The onset of yielding of generations 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 is the time 
\begin_inset Formula $t$
\end_inset

 when 
\begin_inset Formula $\varphi\left(\mathbf{U}^{s}\right)=0$
\end_inset

 (
\begin_inset Formula $\mathcal{E}^{s}\to\mathcal{E}^{u}$
\end_inset

, 
\begin_inset Formula $t=t^{u}$
\end_inset

) and 
\begin_inset Formula $\varphi\left(\mathbf{U}^{u}\right)=0$
\end_inset

 (
\begin_inset Formula $\mathcal{E}^{u}\to\mathcal{E}^{v}$
\end_inset

, 
\begin_inset Formula $t=t^{v}$
\end_inset

), respectively.
 In summary 
\begin_inset Formula $w^{\sigma}=1$
\end_inset

 during the lifetime of generation 
\begin_inset Formula $\sigma$
\end_inset

 (
\begin_inset Formula $t^{\sigma}\le t<t^{\sigma+1}$
\end_inset

) and 
\begin_inset Formula $0$
\end_inset

 at other times 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Subsection
Kinematic 
\begin_inset Quotes eld
\end_inset

Hardening
\begin_inset Quotes erd
\end_inset

 Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Kinematic-Hardening-Response"

\end_inset


\end_layout

\begin_layout Standard
The framework presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Elastic-Perfectly-Plastic-Response"
plural "false"
caps "false"
noprefix "false"

\end_inset

 has considered an elastic-perfectly plastic response, i.e., all the bonds
 yield when a single yield threshold 
\begin_inset Formula $\Phi_{m}$
\end_inset

 is met.
 However, a wealth of experimental results show a more progressive yielding,
 rather than a sudden onset, and an increase in the stress with increasing
 plastic deformation, a phenomenon alternately termed strain hardening or
 work hardening.
 Real materials typically exhibit the Bauschinger effect, where loading
 to yield in one direction changes the yield threshold in the reverse direction.
 The hardening behavior that accounts for this effect is known as kinematic
 hardening; for a load reversal, it predicts yielding occurs when the change
 in load achieves twice the monotonic yield strength.
 The reactive plasticity framework can be extended to allow for kinematic
 hardening by introducing multiple families of bonds.
 In the current FEBio implementation each bond family 
\begin_inset Formula $\beta$
\end_inset

 shares the same yield criterion 
\begin_inset Formula $\Phi$
\end_inset

 but distinct associated yield thresholds 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

, and it follows the elastic-perfectly plastic behavior for multiple generations
 outlined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Elastic-Perfectly-Plastic-Response"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The superposition of multiple bond families 
\begin_inset Formula $\beta$
\end_inset

 in parallel naturally develops behavior consistent with kinematic hardening,
 as different bond families yield at different thresholds.
\end_layout

\begin_layout Standard
We consider 
\begin_inset Formula $n_{f}$
\end_inset

 
\shape italic
bond families
\shape default
 
\begin_inset Formula $\beta=0,\dots,n_{f}-1$
\end_inset

, which may yield under different thresholds, where each bond family may
 evolve over multiple generations 
\begin_inset Formula $\sigma$
\end_inset

.
 This framework requires us to update our notation to include a subscript
 
\begin_inset Formula $\beta$
\end_inset

 for suitable variables introduced in the presentation above.
 In particular, the reference configuration of generation 
\begin_inset Formula $\sigma$
\end_inset

 in bond family 
\begin_inset Formula $\beta$
\end_inset

 is now denoted by 
\begin_inset Formula $\mathbf{X}_{\beta}^{\sigma}$
\end_inset

 and the corresponding deformation gradient is 
\begin_inset Formula $\mathbf{F}_{\beta}^{\sigma}$
\end_inset

.
 We assume that the free energy density of each bond family 
\begin_inset Formula $\beta$
\end_inset

 is 
\begin_inset Formula $\Psi_{\beta r}=J_{\beta}^{\sigma s}\Psi_{0}\left(\mathbf{F}_{\beta}^{\sigma}\right)$
\end_inset

, when the mixture consists entirely of bonds of family 
\begin_inset Formula $\beta$
\end_inset

 in generation 
\begin_inset Formula $\sigma$
\end_inset

.
 The master reference configuration of all bond families remains 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

 and the associated (total) deformation gradient is still 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

.
 Therefore, each bond family 
\begin_inset Formula $\beta$
\end_inset

 requires a constitutive relation for the function of state 
\begin_inset Formula $\mathbf{F}_{\beta}^{\sigma s}$
\end_inset

 in the updated form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-total-def-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

, such as that given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticity-Fvsi-normality"
plural "false"
caps "false"
noprefix "false"

\end_inset

, where each term should now include a subscript 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\begin_layout Standard
The referential mass density of bond family 
\begin_inset Formula $\beta$
\end_inset

 is 
\begin_inset Formula $\rho_{r\beta}$
\end_inset

, such that the mixture referential mass density is given by 
\begin_inset Formula $\rho_{r}=\sum_{\beta}\rho_{r\beta}$
\end_inset

.
 The referential mass density of generation 
\begin_inset Formula $\sigma$
\end_inset

 in bond family 
\begin_inset Formula $\beta$
\end_inset

 is 
\begin_inset Formula $\rho_{r\beta}^{\sigma}$
\end_inset

, which satisfies 
\begin_inset Formula $\sum_{\sigma}\rho_{r\beta}^{\sigma}=\rho_{r\beta}$
\end_inset

, as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:general-mass-balance"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For convenience, we define
\begin_inset Formula 
\begin{equation}
w_{\beta}\equiv\frac{\rho_{r\beta}}{\rho_{r}}\,,\quad\sum_{\beta}w_{\beta}=1\,,\label{eq:multiplebonds-family-mass-balance}
\end{equation}

\end_inset

which represents the mass fraction of each bond family 
\begin_inset Formula $\beta$
\end_inset

 within the constrained solid mixture, and
\begin_inset Formula 
\begin{equation}
w_{\beta}^{\sigma}=\frac{\rho_{r\beta}^{\sigma}}{\rho_{r\beta}}\,,\quad\sum_{\sigma}w_{\beta}^{\sigma}=1\,,\label{eq:multiplebonds-bond-species-mass-fractions}
\end{equation}

\end_inset

which represents the mass fraction of each generation 
\begin_inset Formula $\sigma$
\end_inset

 within the bond family 
\begin_inset Formula $\beta$
\end_inset

.
 From these definitions, it follows that bond family mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 are time-invariant (thus user-selected for a particular material response),
 whereas generation mass fractions 
\begin_inset Formula $w_{\beta}^{\sigma}$
\end_inset

 evolve with bond-breaking-and-reforming reactions.
\end_layout

\begin_layout Standard
The mixture strain energy density 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is now given by
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\sum_{\beta}w_{\beta}\sum_{\sigma}w_{\beta}^{\sigma}J_{\beta}^{\sigma s}\Psi_{0}\left(\mathbf{F}_{\beta}^{\sigma}\right)\,,\label{eq:multiplebonds-mixture-energy}
\end{equation}

\end_inset

whereas the mixture stress is
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum_{\beta}w_{\beta}\underbrace{\sum_{\sigma}w_{\beta}^{\sigma}\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{\sigma}\right)}_{\boldsymbol{\sigma}_{\beta}}\,,\quad\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{\sigma}\right)=\frac{1}{J_{\beta}^{\sigma}}\frac{\partial\Psi_{0}}{\partial\mathbf{F}_{\beta}^{\sigma}}\cdot\left(\mathbf{F}_{\beta}^{\sigma}\right)^{T}\,.\label{eq:multiplebonds-mixture-stress}
\end{equation}

\end_inset

To simplify the remainder of this presentation, we introduce the concept
 of 
\shape italic
yielded bonds
\shape default
, denoted by 
\begin_inset Formula $y$
\end_inset

, to represent bonds of the current extant generation in a plasticity formulatio
n.
 The yielded bond fraction for each family 
\begin_inset Formula $\beta$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
w_{\beta}^{y}=\sum_{\sigma\neq s}w_{\beta}^{\sigma}=1-w_{\beta}^{s}\label{eq:hardening-yielded-mass-fraction}
\end{equation}

\end_inset

where the summation runs over all possible yielded generations 
\begin_inset Formula $\sigma\neq s$
\end_inset

.
 In particular, at time 
\begin_inset Formula $t=u$
\end_inset

, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-yielded-mass-fraction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reduces to the statement 
\begin_inset Formula $w_{\beta}^{y}=w_{\beta}^{u}$
\end_inset

.
 We then define the relative deformation gradient of yielded bonds as 
\begin_inset Formula $\mathbf{F}_{\beta}^{y}$
\end_inset

, which equals 
\begin_inset Formula $\mathbf{F}_{\beta}^{\sigma}$
\end_inset

 for the extant generation 
\begin_inset Formula $\sigma$
\end_inset

 in family 
\begin_inset Formula $\beta$
\end_inset

.
 With these notational changes, we may write the yielding reactions in the
 form
\begin_inset Formula 
\begin{equation}
\mathcal{E}^{s}\to\underbrace{\mathcal{E}^{u}\rightarrow\mathcal{E}^{v}\rightarrow\dots}_{\mathcal{E}^{y}}\,.\label{eq:hardening-yielded-rxn}
\end{equation}

\end_inset

Then the mixture stress in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:multiplebonds-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as 
\begin_inset Formula $\boldsymbol{\sigma}=\sum_{\beta}w_{\beta}\boldsymbol{\sigma}_{\beta}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\sigma}_{\beta}=w_{\beta}^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{F}^{s}\right)+\left(1-w_{\beta}^{s}\right)\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{y}\right)$
\end_inset

.
 We may also define the total fraction 
\begin_inset Formula $w^{s}$
\end_inset

 of intact bonds in the mixture as 
\begin_inset Formula $w^{s}=\sum_{\beta}w_{\beta}w_{\beta}^{s}$
\end_inset

, and the total fraction of yielded bonds as 
\begin_inset Formula $w^{y}=\sum_{\beta}w_{\beta}w_{\beta}^{y}=1-w^{s}$
\end_inset

, such that 
\begin_inset Formula $w^{s}+w^{y}=1$
\end_inset

.
 Then 
\begin_inset Formula $\boldsymbol{\sigma}=w^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{F}^{s}\right)+\sum_{\beta}w_{\beta}\left(1-w_{\beta}^{s}\right)\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{y}\right)$
\end_inset

.
 The summation in this last expression does not simplify further since 
\begin_inset Formula $\mathbf{F}_{\beta}^{y}$
\end_inset

 is different for each bond family 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\begin_layout Standard
Let each bond family 
\begin_inset Formula $\beta$
\end_inset

 exhibit an elastic-perfectly plastic response, following the model of Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Elastic-Perfectly-Plastic-Response"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Once the yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 is reached, all the intact bonds of that family yield at once, such that
 
\begin_inset Formula $w_{\beta}^{s}=0$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}=1$
\end_inset

 as shown for the mixture stress response in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-families-superposition"
plural "false"
caps "false"
noprefix "false"

\end_inset

a-c.
 Now consider that there are three bond families, 
\begin_inset Formula $\beta=0,1,2$
\end_inset

 which are weighted evenly, 
\begin_inset Formula $w_{\beta}=1/3\,\forall\beta$
\end_inset

.
 The stress response for this illustrative example is shown in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-families-superposition"
plural "false"
caps "false"
noprefix "false"

\end_inset

d-f.
 Though each bond family is elastic-perfectly plastic, their superposition
 develops 
\begin_inset Quotes eld
\end_inset

hardening
\begin_inset Quotes erd
\end_inset

-like behavior.
 At the onset of yielding, when family 
\begin_inset Formula $\beta=0$
\end_inset

 yields, its bond mass fractions are 
\begin_inset Formula $w_{0}^{s}=0$
\end_inset

 and 
\begin_inset Formula $w_{0}^{y}=1$
\end_inset

, implying that this entire family has yielded.
 However, since the family has a mass fraction 
\begin_inset Formula $w_{0}=1/3$
\end_inset

 in the solid mixture, two-thirds of the bonds in the mixture remain intact
 at this juncture, 
\begin_inset Formula $1-w_{0}^{s}=2/3$
\end_inset

.
 As subsequent families 
\begin_inset Formula $\beta$
\end_inset

 yield, their bonds transition from intact to yielded generations in the
 same manner.
 Though the resulting stress response in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-families-superposition"
plural "false"
caps "false"
noprefix "false"

\end_inset

d is classically described as a 
\begin_inset Quotes eld
\end_inset

hardening
\begin_inset Quotes erd
\end_inset

 behavior, the reactive plasticity mixture framework proposes a different
 interpretation, namely that there are multiple elastic-perfectly plastic
 bond families in the material, each with a different threshold of yielding.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigReactivePlasticityStress.png
	lyxscale 50
	width 6in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The phenomenon described as 
\begin_inset Quotes eld
\end_inset

kinematic hardening
\begin_inset Quotes erd
\end_inset

 in classical plasticity may be represented by the superposition of multiple
 elastic-perfectly plastic bond families with different yield thresholds.
 The elastic-perfectly plastic stress response of a single bond family 
\begin_inset Formula $\beta=0$
\end_inset

 in the reactive framework is presented in (a), with the initial linear
 response contributed by the intact bonds 
\begin_inset Formula $s$
\end_inset

; upon yielding at the threshold 
\begin_inset Formula $\Phi_{m0}$
\end_inset

, the perfectly plastic response consists of multiple generations of breaking
 and reforming bonds 
\begin_inset Formula $\sigma=u,v,\dots$
\end_inset

.
 The evolution of mass fractions 
\begin_inset Formula $w_{0}^{s}$
\end_inset

 of intact and 
\begin_inset Formula $w_{0}^{y}$
\end_inset

 of yielded bonds is presented in (b) and (c), respectively.
 The stress response obtained from the superposition of three bond families
 
\begin_inset Formula $\beta=0,1,2$
\end_inset

 is shown in (d), where each family occupies the same mass fraction 
\begin_inset Formula $w_{\beta}$
\end_inset

 in the mixture, 
\begin_inset Formula $w_{0}=w_{1}=w_{2}=\frac{1}{3}$
\end_inset

, reproducing the classical kinematic hardening behavior.
 Green dashed lines help indicate changes in slope due to yielding of each
 bond family.
 The corresponding mixture mass fractions of (e) intact bonds 
\begin_inset Formula $w^{s}$
\end_inset

, and (f) yielded bonds 
\begin_inset Formula $w^{y}=1-w^{s}$
\end_inset

 further illustrates the occurence of each yielding reaction.
\begin_inset CommandInset label
LatexCommand label
name "fig:hardening-families-superposition"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
For each bond family 
\begin_inset Formula $\beta$
\end_inset

, the family mass fraction 
\begin_inset Formula $w_{\beta}$
\end_inset

 and the associated yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 must be provided by constitutive assumption, along with a single constitutive
 model for 
\begin_inset Formula $\Psi_{0}$
\end_inset

 which applies to all generations of all bond families.
 The total number 
\begin_inset Formula $n_{f}$
\end_inset

 of bond families must also be provided.
 Parameters 
\begin_inset Formula $n_{f}$
\end_inset

 and 
\begin_inset Formula $\left\{ w_{\beta},\Phi_{m\beta}\right\} ,\,\beta\in\left[0,n_{f}-1\right]$
\end_inset

 suffice to define an elastoplastic material which exhibits classical kinematic
 hardening behavior, for a given elastic response 
\begin_inset Formula $\Psi_{0}$
\end_inset

 and yield criterion 
\begin_inset Formula $\Phi$
\end_inset

.
\end_layout

\begin_layout Subsection
Constitutive Modeling of Yield Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Yield-Constitutive-Modeling"

\end_inset


\end_layout

\begin_layout Standard
Here, we provide basic constitutive relations for the parameters 
\begin_inset Formula $\left\{ w_{\beta},\Phi_{m\beta}\right\} ,\,\beta\in\left[0,n_{f}-1\right]$
\end_inset

 which define an elastoplastic material.
 We also demonstrate how these various parameters affect the uniaxial stress-str
ain response of a material.
 The example in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-families-superposition"
plural "false"
caps "false"
noprefix "false"

\end_inset

d shows how superposition of multiple elastic-perfectly plastic bond families
 may create a hardening-like curve.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigReactivePlasticityYieldThresholds.png
	lyxscale 30
	width 3in

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Schematic stress-strain curve illustrating derivation of constitutive models
 for 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

.
 
\begin_inset Formula $E$
\end_inset

 is Young's modulus of the elastic solid (whose value does not matter here),
 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 are the effective yield thresholds for the global material (given), 
\begin_inset Formula $\varepsilon_{\beta}$
\end_inset

 are the yield strains and 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 are the true yield thresholds for each bond family, which need to be determined
, and 
\begin_inset Formula $w_{\beta}$
\end_inset

 are the family mass fractions (given).
\color black

\begin_inset CommandInset label
LatexCommand label
name "fig:hardening-constitutive-diagram"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

In particular, we present a constitutive modeling framework that requires
 at most six scalar parameters, regardless of the value of 
\begin_inset Formula $n_{f}$
\end_inset

.
\end_layout

\begin_layout Standard
Since each family behaves elastically until it yields, a family's yield
 threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 is generally not the value recorded on a stress-strain curve when the slope
 changes (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-constitutive-diagram"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 That value may be called the 
\shape italic
apparent yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

, which can be related to the true yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 by assuming a linear elastic stress-strain relationship prior to yielding.
 For simplicity, we assume that 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 values are evenly distributed between an 
\shape italic
initial yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\text{0}}$
\end_inset

 and a 
\shape italic
final yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

, parameters which may be identified from a stress strain curve (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

a-b).
 Beyond 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

, the material either behaves as if it is perfectly plastic (a scenario
 which may be valid around the ultimate strength, for example), or it transition
s to a linear hardening regime.
 The constitutive model thus specifies
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Upsilon_{\beta} & =\Upsilon_{\text{0}}+\beta\frac{\Upsilon_{\text{max}}-\Upsilon_{\text{0}}}{n_{f}-1}, & \beta & =0,\ldots,n_{f}-1\\
\Phi_{m\beta} & =\Phi_{m,\beta-1}+\frac{\Upsilon_{\beta}-\Upsilon_{\beta-1}}{1-\sum_{b=0}^{\beta-1}w_{b}}, & \Phi_{m0} & =\Upsilon_{0}
\end{aligned}
\label{eq:hardening-phi-model-no-r}
\end{equation}

\end_inset

The relationships between 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 and 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 embodied in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-phi-model-no-r"
plural "false"
caps "false"
noprefix "false"

\end_inset

 are illustrated graphically in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-constitutive-diagram"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Through this relationship, only the values of 
\begin_inset Formula $\Upsilon_{\text{0}}$
\end_inset

 and 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

 must be specified, along with 
\begin_inset Formula $n_{f}$
\end_inset

.
\end_layout

\begin_layout Standard
The family mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 govern the influence of each family on the overall material response.
 The simplest model for 
\begin_inset Formula $w_{\beta}$
\end_inset

 involves specifying the mass fraction of the first yielding family 
\begin_inset Formula $w_{0}$
\end_inset

, which controls the slope of the initial post-yield response (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

a), and then evenly weighting the rest of the bond families, 
\begin_inset Formula $w_{\beta}=\left(1-w_{0}\right)/\left(n_{f}-1\right)$
\end_inset

.
 However, in cases where the material transitions to a linear hardening
 regime, we can recover this behavior by adding one more bond family, 
\begin_inset Formula $\beta=n_{f}$
\end_inset

, that never yields, thus remaining elastic.
 The associated mass fraction 
\begin_inset Formula $w_{\beta}$
\end_inset


\shape italic
\emph on
 for 
\begin_inset Formula $\beta=n_{f}$
\end_inset

 is called the 
\emph default
elastic mass fraction
\shape default
 and denoted 
\begin_inset Formula $w_{e}$
\end_inset

; a non-zero value for this parameter may be specified whenever we wish
 to include linear hardening behavior (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

b).
 Given initial and elastic mass fractions 
\begin_inset Formula $w_{0}$
\end_inset

 and 
\begin_inset Formula $w_{e}$
\end_inset

, the simplest constitutive assumption for the remaining 
\begin_inset Formula $w_{\beta}$
\end_inset

's assumes the remaining mass is evenly divided, such that
\begin_inset Formula 
\begin{equation}
w_{\beta}=\frac{1-w_{e}-w_{0}}{n_{f}-1},\,\beta\in\left[1,n_{f}-1\right]\,.\label{eq:hardening-m-model-no-r}
\end{equation}

\end_inset

The effect of the mass fraction parameters 
\begin_inset Formula $w_{0}$
\end_inset

 and 
\begin_inset Formula $w_{e}$
\end_inset

 is explored parametrically in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

c and Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

d, respectively.
 In general, most ductile materials have 
\begin_inset Formula $w_{0}$
\end_inset

 very close to unity, which provides hardening behavior over a finite strain
 range.
 As 
\begin_inset Formula $w_{0}\to1$
\end_inset

 the stress-strain behavior approaches perfect plasticity.
 In contrast, when 
\begin_inset Formula $w_{e}=0$
\end_inset

, the material response becomes perfectly plastic once the final yield threshold
 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

 has been exceeded.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigReactivePlasticityYieldModel.png
	lyxscale 20
	width 6in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Modeling uniaxial stress-strain curves using the constitutive model for
 scalar bond family parameters given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Yield-Constitutive-Modeling"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Identification of parameters on idealized stress-strain curves showing
 (a) a plateau in the stress, or (b) exhibiting a region of linear hardening.
 The yielding behavior is fully described by the set of parameters 
\begin_inset Formula $\left\{ n_{f},\Upsilon_{0},\Upsilon_{\text{max}},w_{0},w_{e},r\right\} $
\end_inset

.
 Parametric variations of (c) 
\begin_inset Formula $w_{0}$
\end_inset

 and (d) 
\begin_inset Formula $w_{e}$
\end_inset

 illustrate their influence on the stress-strain response; other parameters
 are held fixed.
 In (c-d) 
\begin_inset Formula $n_{f}=10$
\end_inset

, 
\begin_inset Formula $\Upsilon_{0}=600$
\end_inset

 MPa, 
\begin_inset Formula $\Upsilon_{\text{max}}=1000$
\end_inset

 MPa, and 
\begin_inset Formula $r=1$
\end_inset

.
 In (c), 
\begin_inset Formula $w_{e}=0$
\end_inset

 and in (d) 
\begin_inset Formula $w_{0}=0.75$
\end_inset

.
 For all cases, 
\begin_inset Formula $E=200\,\text{GPa}$
\end_inset

 and 
\begin_inset Formula $\nu=0.3$
\end_inset

.
\color black

\begin_inset CommandInset label
LatexCommand label
name "fig:hardening-family-parametric-curves"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

As 
\begin_inset Formula $w_{e}$
\end_inset

 increases, a region of linear hardening is seen on a plot of the true stress
 against strain.
 For most ductile materials, 
\begin_inset Formula $w_{e}$
\end_inset

 is usually 
\begin_inset Formula $0$
\end_inset

 or on the order of 
\begin_inset Formula $0.001$
\end_inset

.
\end_layout

\begin_layout Standard
It is also possible to refine the constitutive relations of Eqs.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-phi-model-no-r"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-m-model-no-r"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by introducing a 
\shape italic
bias factor
\shape default
 
\begin_inset Formula $r$
\end_inset

, which allows a geometric progression rather than uniform spacing of the
 apparent yield thresholds and family mass fractions.
 The bias factor 
\begin_inset Formula $r$
\end_inset

 has the effect of modifying the shape of the hardening region between 
\begin_inset Formula $\Upsilon_{0}$
\end_inset

 and 
\begin_inset Formula $\Upsilon_{\text{max }}$
\end_inset

 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

b).
 The modified constitutive relations for 
\begin_inset Formula $w_{\beta}$
\end_inset

 and 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 take the form
\begin_inset Formula 
\begin{equation}
\begin{aligned}c & =\frac{1-r}{1-r^{n_{f}-1}} & \Phi_{m0} & =\Upsilon_{0}\\
\Upsilon_{1} & =\Upsilon_{0}+c\left(\Upsilon_{\text{max}}-\Upsilon_{0}\right), & \Phi_{m1} & =\Upsilon_{0}+\frac{\Upsilon_{1}-\Upsilon_{0}}{1-w_{0}}\\
\Upsilon_{\beta} & =\Upsilon_{\beta-1}+r\left(\Upsilon_{\beta-1}-\Upsilon_{\beta-2}\right), & \Phi_{m\beta} & =\Phi_{m,\beta-1}+\frac{\Upsilon_{\beta}-\Upsilon_{\beta-1}}{1-\sum_{b=0}^{\beta-1}w_{b}}
\end{aligned}
\label{eq:hardening-phi-model-bias}
\end{equation}

\end_inset

The mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 are similarly biased, where 
\begin_inset Formula $w_{0}$
\end_inset

 and 
\begin_inset Formula $w_{e}$
\end_inset

 are specified and
\begin_inset Formula 
\begin{equation}
\begin{aligned}w_{1} & =c\left(1-w_{e}-w_{0}\right)\\
w_{\beta} & =w_{\beta-1}r
\end{aligned}
\label{eq:hardening-m-bias}
\end{equation}

\end_inset

The full set of parameters is then given by 
\begin_inset Formula $\left\{ n_{f},\Upsilon_{0},\Upsilon_{\text{max}},w_{0},w_{e},r\right\} $
\end_inset

.
 Setting 
\begin_inset Formula $r=1$
\end_inset

 recovers the uniform distribution presented in Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-phi-model-no-r"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-m-model-no-r"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"

\end_inset

a-b graphically describes the influence of each parameter on simplified
 stress-strain curves, showing how these parameters may be extracted from
 experimental data.
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Elastoplastic Damage Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Plasticity-with-damage"

\end_inset


\end_layout

\begin_layout Standard
Plastic deformation (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is often coupled with damage, as the finite deformation and plastic flow
 of a loaded material typically induces some amount of failure.
 Within the constrained reactive mixture framework adopted in FEBio (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mixture-of-Solids"
plural "false"
caps "false"
noprefix "false"

\end_inset

), damage is produced by bonds breaking permanently (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"

\end_inset

), which reduces the generation mass fractions 
\begin_inset Formula $w_{\beta}^{\sigma}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "false"

\end_inset

.
 In our treatment of elastoplastic damage we assume that both intact and
 yielded bonds may become damaged.
 Damage to intact bonds may represent some initial damage value for a material
 with defects, or damage due to intermolecular failure of bonds that never
 yielded; we refer to this as 
\emph on
elastic damage
\emph default
.
 Damage to yielded bonds represents 
\emph on
plastic damage
\emph default
.
 The mechanism of damage and the failure measure may be different for these
 two types of bonds, particularly since a stress- or energy-based failure
 measure may not be appropriate for plastic damage.
 Intact bonds belong to the 
\begin_inset Formula $s-$
\end_inset

generation which is present at 
\begin_inset Formula $t=-\infty$
\end_inset

.
 Once yielding occurs, all successive generations of that family are labeled
 as yielded bonds 
\begin_inset Formula $y$
\end_inset

.
 This distinction is necessary so we can then distinguish between damage
 to intact bonds (elastic damage) and damage to yielded bonds (plastic damage),
 since intact bonds which get damaged never have the ability to yield.
 It is important to note that the nature of the plastic deformation described
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 remains unchanged.
 Damage modifies the material behavior by reducing the fraction of bonds
 in various generations, which scales the response accordingly.
\end_layout

\begin_layout Standard
In a reactive constrained mixture framework the insertion of damage into
 the reactive plasticity formulation is straightforward.
 Since bonds break permanently in a damage reaction, there is no need to
 define a function of state 
\begin_inset Formula $\mathbf{F}_{\beta}^{\sigma s}$
\end_inset

 to describe a (non-existing) reformed configuration.
 Furthermore, the specific free energy of broken bonds is zero.
 The scalar 
\shape italic
elastic damage criterion
\shape default
 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}^{s}\right)$
\end_inset

, which is taken to have the same functional form for all bond families
 
\begin_inset Formula $\beta$
\end_inset

, is the analog to the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

 for plasticity.
 As shown in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the main contrast with reactive plasticity is that not all bonds in the
 family 
\begin_inset Formula $\beta$
\end_inset

 break simultaneously at a single 
\shape italic
elastic damage threshold
\shape default
 
\begin_inset Formula $\Xi_{m\beta}^{e}$
\end_inset

.
 Instead, the fraction of broken bonds varies as a function of 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}^{s}\right)$
\end_inset

, denoted by 
\begin_inset Formula $F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

, such that 
\begin_inset Formula $0\le F^{e}\left(\Xi_{\beta}^{e}\right)\le1$
\end_inset

.
 Here, 
\begin_inset Formula $F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

 is a function of state; it must be a monotonically increasing function
 of its argument to satisfy the Clausius-Duhem inequality 
\begin_inset CommandInset citation
LatexCommand citep
key "Nims16"
literal "false"

\end_inset

.
 We may view 
\begin_inset Formula $F^{e}$
\end_inset

 as a cumulative distribution function (CDF), whose corresponding probability
 distribution function (PDF) represents the probability of damage at a particula
r value of 
\begin_inset Formula $\Xi_{\beta}^{e}$
\end_inset

.
\end_layout

\begin_layout Subsection
Theoretical Formulation
\end_layout

\begin_layout Standard
We first briefly sketch the structure of the elastoplastic damage theory
 in FEBio for a single bond family 
\begin_inset Formula $\beta$
\end_inset

.
 Since each bond family in reactive plasticity yields all at once, we can
 easily split an elastoplastic damage theory into two parts to represent
 elastic and plastic damage regimes.
 Assume that the first yielding reaction for bond family 
\begin_inset Formula $\beta$
\end_inset

 occurs at time 
\begin_inset Formula $t=u_{\beta}$
\end_inset

.
 Prior to this initial yielding, the damage behavior described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"

\end_inset

 applies, and the material composition is generally a mixture of intact
 (
\begin_inset Formula $\sigma=s$
\end_inset

) and broken (
\begin_inset Formula $\sigma=b$
\end_inset

) bonds satisfying the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{s}\to\mathcal{E}_{\beta}^{b}$
\end_inset

.
 The corresponding bond mass fractions satisfy 
\begin_inset Formula $1=w_{\beta}^{s}+w_{\beta}^{b}$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}=0$
\end_inset

, where 
\begin_inset Formula $w_{\beta}^{b}=F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

 is the elastic damage in bond family 
\begin_inset Formula $\beta$
\end_inset

.
 At 
\begin_inset Formula $t=u_{\beta}$
\end_inset

, the remaining intact bonds 
\begin_inset Formula $w_{\beta}^{s}=1-w_{\beta}^{b}$
\end_inset

 all yield, following the reaction in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:hardening-yielded-rxn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The family mass balance is then given as 
\begin_inset Formula $1=w_{\beta}^{y}+w_{\beta}^{b}$
\end_inset

, since 
\begin_inset Formula $w_{\beta}^{s}=0$
\end_inset

 after yielding.
 The mass fraction of broken bonds 
\begin_inset Formula $w^{b}=\sum_{\beta}w_{\beta}w_{\beta}^{b}$
\end_inset

 is equal to the elastic damage variable 
\begin_inset Formula $D$
\end_inset

 as defined in classical damage mechanics.
\end_layout

\begin_layout Standard
For time 
\begin_inset Formula $t>u_{\beta}$
\end_inset

, yielded bonds may continue to yield, but they may also sustain damage
 according to the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{y}\to\mathcal{E}_{\beta}^{b}$
\end_inset

, which reduces their mass fraction 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

.
 Damage to yielded bonds may occur based on a function of state (often described
 as a plastic strain, though it is not an observable kinematic variable),
 which is distinct from the measure of elastic damage.
 Therefore, we denote the 
\shape italic
plastic damage measure
\shape default
 as 
\begin_inset Formula $\Xi^{p}\left(\mathbf{F}_{\beta}^{ys}\right)$
\end_inset

 and its cumulative distribution function by 
\begin_inset Formula $F^{p}\left(\Xi_{\beta}^{p}\right)$
\end_inset

, under the assumption that all bond families 
\begin_inset Formula $\beta$
\end_inset

 share the same functional forms for 
\begin_inset Formula $\Xi^{p}$
\end_inset

 and 
\begin_inset Formula $F^{p}$
\end_inset

.
 For each bond family 
\begin_inset Formula $\beta$
\end_inset

, only the remaining undamaged fraction 
\begin_inset Formula $1-F^{p}\left(\Xi_{\beta}^{p}\right)$
\end_inset

 of yielded bonds may break and reform as the next yielded generation.
\end_layout

\begin_layout Standard
The modern understanding is that plastic strain is ill-defined and not a
 suitable state variable.
 It must be recognized that, just as 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 is a constitutively-prescribed function of state and does not carry the
 meaning of a plastic deformation gradient, the plastic damage measure 
\begin_inset Formula $\Xi^{p}\left(\mathbf{F}_{\beta}^{ys}\right)$
\end_inset

 is also a function of state.
 This quantity is called a plastic strain for convenience only.
\end_layout

\begin_layout Standard
When plastic deformation occurs simultaneously with damage, the mass fraction
 of each successive yielded generation will have decreased.
 The following treatment now considers the superposition of multiple plastic
 bond families, as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Kinematic-Hardening-Response"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Damage to Intact Bonds
\end_layout

\begin_layout Standard
At any given time 
\begin_inset Formula $t$
\end_inset

, there is a maximum value of 
\begin_inset Formula $\Xi^{e}$
\end_inset

 that has been achieved over the past deformation history.
 This maximum value may be distinct for each bond family 
\begin_inset Formula $\beta$
\end_inset

, since intact bond families may yield at different values of 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

; it is thus denoted by 
\begin_inset Formula $\Xi_{m\beta}^{e}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\Xi_{m\beta}^{e}=\max_{\begin{aligned}-\infty<\tau\le t<u_{\beta}\end{aligned}
}\Xi^{e}\left(\mathbf{F}^{s}\left(\tau\right)\right)\,.\label{eq:plasticdmg-intact-ximax-family}
\end{equation}

\end_inset

Any damage sustained by intact bonds reduces their mass fraction, such that
\begin_inset Formula 
\begin{equation}
\left\{ \begin{aligned}w_{\beta}^{s} & =1-F^{e}\left(\Xi_{m\beta}^{e}\right)\\
w_{\beta}^{y} & =0\\
w_{\beta}^{b} & =F^{e}\left(\Xi_{m\beta}^{e}\right)
\end{aligned}
\right.\,,\quad t<u_{\beta}\,,\label{eq:plasticdmg-massfraction-pre-yield}
\end{equation}

\end_inset

and hence the mass balance of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:multiplebonds-bond-species-mass-fractions"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is satisfied.
 Since all remaining intact bonds yield at 
\begin_inset Formula $t=u_{\beta}$
\end_inset

 and thus no intact bonds are left to sustain damage, 
\begin_inset Formula $F^{e}\left(\Xi_{m\beta}^{e}\right)$
\end_inset

 remains constant constant for bond family 
\begin_inset Formula $\beta$
\end_inset

 when 
\begin_inset Formula $t\geq u_{\beta}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Damage to Yielded Bonds
\end_layout

\begin_layout Standard
At time 
\begin_inset Formula $t=u_{\beta}$
\end_inset

, the yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 for family 
\begin_inset Formula $\beta$
\end_inset

 is reached and all remaining intact bonds in family 
\begin_inset Formula $\beta$
\end_inset

 yield such that
\begin_inset Formula 
\begin{equation}
\left\{ \begin{aligned}w_{\beta}^{s} & =0\\
w_{\beta}^{y} & =1-F^{e}\left(\Xi_{m\beta}^{e}\right)\\
w_{\beta}^{b} & =F^{e}\left(\Xi_{m\beta}^{e}\right)
\end{aligned}
\right.\,,\quad t=u_{\beta}\,.\label{eq:plasticdmg-mass-fraction-yield}
\end{equation}

\end_inset

Once they have formed, yielded bonds may sustain plastic damage.
 The maximum value of the plastic damage measure 
\begin_inset Formula $\Xi^{p}$
\end_inset

 experienced by family 
\begin_inset Formula $\beta$
\end_inset

 up until the current time 
\begin_inset Formula $t$
\end_inset

 is denoted by 
\begin_inset Formula $\Xi_{m\beta}^{p}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\Xi_{m\beta}^{p}=\max_{\begin{aligned}u_{\beta}\leq\tau<t\end{aligned}
}\Xi^{p}\left(\mathbf{F}_{\beta}^{y}\left(\tau\right)\right)\,.\label{eq:plasticdmg-yielded-ximax-family}
\end{equation}

\end_inset

For 
\begin_inset Formula $t>u_{\beta}$
\end_inset

, yielded bonds may continue to yield, breaking and reforming into successive
 generations.
 However, in contrast to Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the mass fraction 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

 of yielded bonds in family 
\begin_inset Formula $\beta$
\end_inset

 no longer remains constant over successive yield generations, due to the
 plastic damage reaction.
 Each time a yielded bond breaks and reforms into a new generation, 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

 is given by the undamaged fraction of yielded bonds,
\begin_inset Formula 
\begin{equation}
\left\{ \begin{aligned}w_{\beta}^{s} & =0\\
w_{\beta}^{y} & =\left(1-F^{p}\left(\Xi_{m\beta}^{p}\right)\right)\left(1-F^{e}\left(\Xi_{m\beta}^{e}\right)\right)\\
w_{\beta}^{b} & =F^{e}\left(\Xi_{m\beta}^{e}\right)+F^{p}\left(\Xi_{m\beta}^{p}\right)\left(1-F^{e}\left(\Xi_{m\beta}^{e}\right)\right)
\end{aligned}
\right.\,,\quad t>u_{\beta}\,.\label{eq:plasticdmg-mass-fraction-post-yield}
\end{equation}

\end_inset

Equations
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticdmg-massfraction-pre-yield"
plural "false"
caps "false"
noprefix "false"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticdmg-mass-fraction-yield"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticdmg-mass-fraction-post-yield"
plural "false"
caps "false"
noprefix "false"

\end_inset

 govern the temporal behavior of the bond species mass fractions.
\end_layout

\begin_layout Subsubsection
Strain Energy Density, Stress, and Damage
\end_layout

\begin_layout Standard
Recognizing that damaged (broken) bonds do not store free energy, the referentia
l mixture free energy density in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:multiplebonds-mixture-energy"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may be rewritten as
\begin_inset Formula 
\begin{equation}
\Psi_{r}=\sum_{\beta}w_{\beta}\left(w_{\beta}^{s}\Psi_{0}\left(\mathbf{F}^{s}\right)+w_{\beta}^{y}J^{ys}\Psi_{0}\left(\mathbf{F}_{\beta}^{y}\right)\right)\,,\label{eq:plasticdmg-free-energy}
\end{equation}

\end_inset

where the bond mass fractions 
\begin_inset Formula $w_{\beta}^{s}$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

 are given in Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticdmg-massfraction-pre-yield"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:plasticdmg-mass-fraction-post-yield"
plural "false"
caps "false"
noprefix "false"

\end_inset

 prior to, during, and after yielding of each bond family 
\begin_inset Formula $\beta$
\end_inset

.
 Similarly, the mixture stress may be evaluated from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:multiplebonds-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum_{\beta}w_{\beta}\left(w_{\beta}^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{F}^{s}\right)+w_{\beta}^{y}\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{y}\right)\right)\,,\label{eq:plasticdmg-mixture-stress}
\end{equation}

\end_inset

where the stresses 
\begin_inset Formula $\boldsymbol{\sigma}_{0}$
\end_inset

 are given by the standard hyperelasticity relation in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:multiplebonds-mixture-stress"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 These expressions may be simplified further when assuming that the functional
 form of 
\begin_inset Formula $\psi_{\beta}$
\end_inset

 remains the same for all bond families 
\begin_inset Formula $\beta$
\end_inset

.
 Finally, the reactive mixture equivalent of the damage variable 
\begin_inset Formula $D$
\end_inset

 may be evaluated for elastoplastic damage as the fraction of all bonds
 that are broken,
\begin_inset Formula 
\begin{equation}
D=w^{b}=\sum_{\beta}w_{\beta}w_{\beta}^{b}\,.\label{eq:plasticdmg-damage-variable}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Damage Measures
\begin_inset CommandInset label
LatexCommand label
name "subsec:Yielded-damage-reaction"

\end_inset


\end_layout

\begin_layout Standard
For elastic damage, we may use the same functional measure as proposed for
 plastic yielding (e.g., the von Mises stress); this implies that the functions
 
\begin_inset Formula $\Xi^{e}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 have the same form.
 For plastic damage, experimental results show that during plastic flow
 damage is coupled with measures of plastic strain 
\begin_inset CommandInset citation
LatexCommand citep
key "Lemaitre05"
literal "false"

\end_inset

, necessitating a (pseudo-)strain-based plastic damage measure 
\begin_inset Formula $\Xi^{p}$
\end_inset

.
 For yielded bonds in a bond family 
\begin_inset Formula $\beta$
\end_inset

, we can use the constitutively-determined mapping 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 to define plastic right Cauchy-Green and Lagrange strain tensors through
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{C}_{\beta}^{ys} & =\left(\mathbf{F}_{\beta}^{ys}\right)^{T}\cdot\mathbf{F}_{\beta}^{ys}\\
\mathbf{E}_{\beta}^{ys} & =\frac{1}{2}\left(\mathbf{C}_{\beta}^{ys}-\mathbf{I}\right)
\end{aligned}
\,.
\end{equation}

\end_inset

One possible constitutive relation for 
\begin_inset Formula $\Xi^{p}$
\end_inset

, which remains valid for general deformations, is to set it equal to the
 
\shape italic
effective plastic strain
\shape default
 
\begin_inset Formula $e_{\beta}^{p}$
\end_inset

 for the various bond families 
\begin_inset Formula $\beta$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
e_{\beta}^{p}=\sqrt{\frac{2}{3}\dev\mathbf{E}_{\beta}^{ys}:\dev\mathbf{E}_{\beta}^{ys}}\,.\label{eq:plasticdmg-effective-plastic-strain}
\end{equation}

\end_inset

In a numerical implementation, the effective plastic strain 
\begin_inset Formula $e_{0}^{p}$
\end_inset

 of the first bond family to yield may be reported as the effective plastic
 strain in the entire material, for consistency with plastic strain measures
 in classical models of plasticity.
\end_layout

\begin_layout Standard
Quantities in this section do not represent plastic strains or plastic strain
 tensors, though we adopt the terminology due to similarities.
 Recall that the non-observable function of state 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}=\mathbf{F}_{\beta}^{ys}\left(\mathbf{F}^{s},\rho_{r\beta}^{\alpha}\right)$
\end_inset

 is a time-invariant mapping providing the reference configuration of a
 yielded bond 
\begin_inset Formula $y$
\end_inset

 with respect to the reference configuration of the master constituent 
\begin_inset Formula $s$
\end_inset

, for family 
\begin_inset Formula $\beta$
\end_inset

.
 The quantities 
\begin_inset Formula $\mathbf{C}_{\beta}^{ys}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\beta}^{ys}$
\end_inset

 then also represent non-observable functions of state calculated as strain
 tensors.
 Consequently, 
\begin_inset Formula $e_{\beta}^{p}$
\end_inset

 is a measure of the relative motion of the reference configuration of bond
 family 
\begin_inset Formula $\beta$
\end_inset

 , expressed as a scalar 
\begin_inset Quotes eld
\end_inset

strain
\begin_inset Quotes erd
\end_inset

.
 Physically, this amounts to the modeling assumption that once the breaking-and-
reforming process takes a bond family out of a local neighborhood centered
 about its original position, the bond begins to degrade with further breaking-a
nd-reforming processes.
 That each of these quantities exists for every bond family 
\begin_inset Formula $\beta$
\end_inset

 emphasizes the lack of any true or unique plastic strain measure in this
 framework.
\end_layout

\begin_layout Subsubsection
Cumulative Damage Distribution Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cumulative-Damage-Distribution"

\end_inset


\end_layout

\begin_layout Standard
The final set of constitutive relations required to fully define an elastoplasti
c damage material are the two CDFs, 
\begin_inset Formula $F^{e}\left(\Xi_{m\beta}^{e}\right)$
\end_inset

 and 
\begin_inset Formula $F^{p}\left(\Xi_{m\beta}^{p}\right)$
\end_inset

.
 As shown by 
\begin_inset CommandInset citation
LatexCommand citet
key "Nims16"
literal "false"

\end_inset

, the only requirement imposed by the Clausius-Duhem inequality is that
 these be monotonically increasing functions.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigReactivePlasticityDamage.png
	lyxscale 20
	width 6in

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Parametric study of the effect of the damage parameter 
\begin_inset Formula $\gamma^{p}$
\end_inset

 for a Weibull distribution, with no intact damage taking place.
 (a) As 
\begin_inset Formula $\gamma^{p}$
\end_inset

 increases, the onset of noticeable damage shifts to higher strains and
 becomes more rapid.
 (b) Plot of the damage variable 
\begin_inset Formula $D=\sum_{\beta}w_{\beta}F^{p}\left(\Xi_{m\beta}^{p}\right)$
\end_inset

.
 The response becomes more nonlinear as 
\begin_inset Formula $\gamma^{p}$
\end_inset

 deviates from unity.
 Other plasticity and damage parameters are 
\begin_inset Formula $n_{f}=20$
\end_inset

, 
\begin_inset Formula $\Upsilon_{0}=600$
\end_inset

 MPa, 
\begin_inset Formula $\Upsilon_{\text{max}}=1000$
\end_inset

 MPa, 
\begin_inset Formula $w_{0}=0.75$
\end_inset

, 
\begin_inset Formula $w_{e}=0$
\end_inset

, 
\begin_inset Formula $r=1$
\end_inset

, and 
\begin_inset Formula $\kappa^{p}=0.03$
\end_inset

.
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:damage-parametric"

\end_inset


\end_layout

\end_inset

 Whereas these CDFs may be characterized directly from experimental data,
 here we illustrate the FEBio elastoplastic damage framework using a Weibull
 distribution of the form
\begin_inset Formula 
\begin{equation}
F\left(\Xi\right)=1-\exp\left(-\left(\frac{\Xi}{\kappa}\right)^{\gamma}\right)\,,\label{eq:Weibull-cdf}
\end{equation}

\end_inset

where 
\begin_inset Formula $\kappa$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

) is the value of 
\begin_inset Formula $\Xi$
\end_inset

 at which the fraction 
\begin_inset Formula $1-e^{-1}$
\end_inset

 of bonds have failed and the exponent 
\begin_inset Formula $\gamma$
\end_inset

 (unitless) controls the slope of the response, such that 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 approaches a step function with a jump at 
\begin_inset Formula $\Xi=\kappa$
\end_inset

 as 
\begin_inset Formula $\gamma\to\infty$
\end_inset

.
 Therefore, each damage function has two free parameters 
\begin_inset Formula $\kappa$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

.
 Based on experimental evidence, we may let 
\begin_inset Formula $\Xi^{e}$
\end_inset

 be given by the von Mises (effective) stress, while 
\begin_inset Formula $\Xi^{p}$
\end_inset

 is taken to be the effective plastic strain (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Yielded-damage-reaction"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:damage-parametric"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows the effect of the Weibull parameter 
\begin_inset Formula $\gamma^{p}$
\end_inset

 on the stress-strain and damage-strain responses, with 
\begin_inset Formula $\kappa^{p}$
\end_inset

 fixed.
 The damage response as a function of plastic strain is identically the
 prescribed CDF (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:damage-parametric"
plural "false"
caps "false"
noprefix "false"

\end_inset

b).
 The shape of the CDF changes from logarithmic-like to exponential as 
\begin_inset Formula $\gamma^{p}$
\end_inset

 increases, demonstrating the ability of this formulation to recover a broad
 variety of experimentally measured damage-strain behaviors 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonora97"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Hydraulic Permeability
\begin_inset CommandInset label
LatexCommand label
name "sec:Hydraulic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
Hydraulic permeability is a material function needed for biphasic and multiphasi
c materials.
\end_layout

\begin_layout Subsection
Constant Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is isotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k\,\mathbf{I}\,.\label{eq501}
\end{equation}

\end_inset

For this material model, 
\begin_inset Formula $k$
\end_inset

 is constant.
 Generally, this assumption is only reasonable when strains are small.
\end_layout

\begin_layout Subsection
Exponential Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exponential-Isotropic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
This isotropic material has a permeability that varies as a function of
 the determinant 
\begin_inset Formula $J$
\end_inset

 of the deformation gradient.
 Its general form is
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k\left(J\right)\mathbf{I}\,,\label{eq:isotropic-permeability}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
k\left(J\right)=k_{0}\exp\left(M\frac{J-1}{J-\varphi_{0}}\right)\,.\label{eq:perm-exp-iso}
\end{equation}

\end_inset

Pore closure occurs as 
\begin_inset Formula $J$
\end_inset

 approaches 
\begin_inset Formula $\varphi_{0}$
\end_inset

 from above, in which case the permeability reduces to zero,
\begin_inset Formula 
\begin{equation}
\lim_{J\to\varphi_{0}}k\left(J\right)=0\,.\label{eq:perm-pore-closure}
\end{equation}

\end_inset

In the special case when 
\begin_inset Formula $M=0$
\end_inset

, the permeability becomes constant.
 In the limit of infinitesimal strains, the permeability has the form
\begin_inset Formula 
\begin{equation}
k\left(J\right)=k_{0}\left(1+\frac{M}{1-\varphi_{0}}\left(J-1\right)+\mathcal{O}\left(\left(J-1\right)^{2}\right)\right)\,.\label{eq:perm-expiso-Taylor}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the type of isotropic permeability given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:isotropic-permeability"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the spatial permeability tangent 
\begin_inset Formula $\boldsymbol{\mathcal{K}}$
\end_inset

 with respect to the solid matrix strain has the general form
\begin_inset Formula 
\begin{equation}
\boldsymbol{\mathcal{K}}=\left(k+Jk^{\prime}\right)\mathbf{I}\otimes\mathbf{I}-2k\mathbf{I}\odot\mathbf{I}\,,\label{eq:isotropic-perm-tangent}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
k^{\prime}\left(J\right)=M\frac{1-\varphi_{0}}{\left(J-\varphi_{0}\right)^{2}}k\left(J\right)\label{eq:perm-exp-iso-tangent}
\end{equation}

\end_inset

in this case.
\end_layout

\begin_layout Subsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow-permeability"

\end_inset


\end_layout

\begin_layout Standard
This isotropic material uses a strain-dependent permeability tensor as formulate
d by 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k\left(J\right)\mathbf{I}\,,\label{eq502}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
k\left(J\right)=k_{0}\left(\frac{J-\varphi_{0}}{1-\varphi_{0}}\right)^{\alpha}e^{\frac{1}{2}M\left(J^{2}-1\right)}\,.\label{eq503}
\end{equation}

\end_inset

When 
\begin_inset Formula $\alpha>0$
\end_inset

, pore closure occurs as 
\begin_inset Formula $J\to\varphi_{0}$
\end_inset

 from above, in which case 
\begin_inset Formula $k$
\end_inset

 reduces to 
\begin_inset Formula $0$
\end_inset

.
 Setting 
\begin_inset Formula $\alpha=0$
\end_inset

 and 
\begin_inset Formula $M=0$
\end_inset

 produces a constant permeability.
 In the limit of infinitesimal strains,
\begin_inset Formula 
\begin{equation}
k\left(J\right)=k_{0}\left(1+\left(M+\frac{\alpha}{1-\varphi_{0}}\right)\left(J-1\right)+\mathcal{O}\left(\left(J-1\right)^{2}\right)\right)\,.\label{eq:perm-HM-Taylor}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The spatial tangent of the permeability tensor with respect to strain may
 be evaluated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:isotropic-perm-tangent"
plural "false"
caps "false"
noprefix "false"

\end_inset

 using
\begin_inset Formula 
\begin{equation}
k^{\prime}\left(J\right)=\left(J\,M+\frac{\alpha}{J-\varphi_{0}}\right)k\left(J\right)\,.\label{eq:perm-HM-tangent}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Referentially Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Permeabi"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that accommodates
 strain-induced anisotropy 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=\left(k_{0r}\mathbf{I}+\frac{k_{1r}}{J^{2}}\mathbf{b}+\frac{k_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2}\,,\label{eq504}
\end{equation}

\end_inset

Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is isotropic and given by 
\begin_inset Formula $\mathbf{k}=\left(k_{0r}+k_{1r}+k_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Orthotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Permea"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that is orthotropic
 in the reference configuration, and accommodates strain-induced anisotropy
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\mathbf{k}=k_{0}\mathbf{I}+\sum\limits _{a=1}^{3}k_{1}^{a}\mathbf{m}_{a}+k_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,\label{eq505}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & k_{0}=k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\,,\\
 & k_{1}^{a}=\frac{k_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\,,\\
 & k_{2}^{a}=\frac{k_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}\,.
\end{aligned}
\quad a=1,2,3\label{eq506}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensors representing the spatial structural tensors describing
 the orthogonal planes of symmetry, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,\label{eq507}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Transversely Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-TISO-permeability"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that is transversely
 isotropic in the reference configuration, and accommodates strain-induced
 anisotropy 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{0}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\mathbf{I}\\
 & +\left(\frac{k_{1r}^{T}}{J^{2}}\left(\mathbf{b}-\mathbf{m}\right)+\frac{k_{2r}^{T}}{2J^{4}}\left[2\mathbf{b}^{2}-\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right]\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{T}}e^{M_{T}\left(J^{2}-1\right)/2}\\
 & +\left(\frac{1}{J^{2}}k_{1r}^{A}\mathbf{m}+\frac{1}{2J^{4}}k_{2r}^{A}\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{A}}e^{M_{A}\left(J^{2}-1\right)/2}\,,
\end{aligned}
\label{eq508}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{m}$
\end_inset

 is a second order tensor representing the spatial structural tensor describing
 the axial direction, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}=\mathbf{F}\cdot\left(\mathbf{V}\otimes\mathbf{V}\right)\cdot\mathbf{F}^{T}\,,\label{eq509}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is a unit vector along the axial direction.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=\left(k_{0r}+k_{1r}^{T}+k_{2r}^{T}\right)\mathbf{I}+\left(k_{1r}^{A}-k_{1r}^{T}+k_{2r}^{A}-k_{2r}^{T}\right)\left(\mathbf{V}\otimes\mathbf{V}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Solute Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "sec:Solute-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
Diffusivity materials provide a constitutive relation for the solute diffusivity
 in a biphasic-solute material.
 In general, the diffusivity tensor 
\begin_inset Formula $\mathbf{d}$
\end_inset

 may be a function of strain and solute concentration.
\end_layout

\begin_layout Subsection
Constant Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is isotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=d\,\mathbf{I}\,.\label{eq510}
\end{equation}

\end_inset

For this material model, 
\begin_inset Formula $d$
\end_inset

 is constant.
 This assumption is only true when strains are small.
 Note that the user must specify 
\begin_inset Formula $d\leqslant d_{0}$
\end_inset

, where 
\begin_inset Formula $d_{0}$
\end_inset

 is the solute diffusivity in free solution, since a solute cannot diffuse
 through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Subsection
Constant Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Orthotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
When the permeability is orthotropic, 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\sum\limits _{a=1}^{3}d^{a}\mathbf{V}_{a}\otimes\mathbf{V}_{a}\,,\label{eq511}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 For this material model, the 
\begin_inset Formula $d^{a}$
\end_inset

 are constant.
 Therefore this model should be used only when strains are small.
 Note that the user must specify 
\begin_inset Formula $d^{a}\leqslant d_{0}$
\end_inset

, where 
\begin_inset Formula $d_{0}$
\end_inset

 is the solute diffusivity in free solution, since a solute cannot diffuse
 through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Subsection
Referentially Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Diffusiv"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that is isotropic
 in the reference configuration and accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left(d_{0r}\mathbf{I}+\frac{d_{1r}}{J^{2}}\mathbf{b}+\frac{d_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2},\label{eq512}
\end{equation}

\end_inset

where 
\begin_inset Formula $J$
\end_inset

 is the jacobian of the deformation, i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient, and 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 Note that the diffusivity in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is isotropic and given by 
\begin_inset Formula $\mathbf{d}=\left(d_{0r}+d_{1r}+d_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Subsection
Referentially Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Diffus"

\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that is orthotropic
 in the reference configuration and accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\begin{equation}
\mathbf{d}=d_{0}\mathbf{I}+\sum\limits _{a=1}^{3}d_{1}^{a}\mathbf{m}_{a}+d_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,\label{eq513}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}d_{0} & =d_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\,,\\
d_{1}^{a} & =\frac{d_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\,,\\
d_{2}^{a} & =\frac{d_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}\,.
\end{aligned}
\quad a=1,2,3\label{eq514}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation, i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where
\series bold
 
\series default

\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensor representing the spatial structural tensors describing
 the orthogonal planes of symmetry, given by 
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3\,,\label{eq515}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I}$
\end_inset

) is given by 
\begin_inset Formula $\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Solute Solubility
\begin_inset CommandInset label
LatexCommand label
name "sec:Solute-Solubility"

\end_inset


\end_layout

\begin_layout Standard
Solubility constitutive equations provide a relation for 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 as a function of solid matrix strain and effective solute concentrations.
\end_layout

\begin_layout Subsection
Constant Solubility
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Solubility"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 is constant.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Osmotic Coefficient
\begin_inset CommandInset label
LatexCommand label
name "sec:Osmotic-Coefficient"

\end_inset


\end_layout

\begin_layout Standard
Osmotic coefficient constitutive equations provide a relation for 
\begin_inset Formula $\Phi$
\end_inset

 as a function of solid matrix strain and effective solute concentrations.
\end_layout

\begin_layout Subsection
Constant Osmotic Coefficient
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Osmotic-Coefficient"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $\Phi$
\end_inset

 is constant.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Active Contraction Model
\begin_inset CommandInset label
LatexCommand label
name "sec:Active-Contraction-Model"

\end_inset


\end_layout

\begin_layout Standard
A time varying 
\begin_inset Quotes eld
\end_inset

elastance
\begin_inset Quotes erd
\end_inset

 active contraction model 
\begin_inset CommandInset citation
LatexCommand citep
key "Guccione91"
literal "true"

\end_inset

 was added to the transversely isotropic materials.
 When active contraction is activated, the total Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is defined as the sum of the active stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}^{a}=T^{a}\mathbf{a}\otimes\mathbf{a}$
\end_inset

 and the passive stress tensor 
\begin_inset Formula $\boldsymbol{\sigma}^{p}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\boldsymbol{\sigma}^{p}+\boldsymbol{\sigma}^{a},\label{eq516}
\end{equation}

\end_inset

where 
\series bold
\emph on
a
\series default
\emph default
 is the deformed fiber vector (unit length), defined as 
\begin_inset Formula $\lambda\mathbf{a}=\mathbf{F}\cdot\mathbf{a}$
\end_inset

.
 The time varying elastance model is a modification of the standard Hill
 equation that scales the standard equation by an activation curve 
\begin_inset Formula $C\left(t\right)$
\end_inset

.
 The active fiber stress 
\begin_inset Formula $T^{a}$
\end_inset

 is defined as: 
\begin_inset Formula 
\begin{equation}
T^{a}=T_{\max}\frac{Ca_{0}^{2}}{Ca_{0}^{2}+ECa_{50}^{2}}C\left(t\right),\label{eq517}
\end{equation}

\end_inset

where 
\begin_inset Formula $T_{max}=135.7\,\text{kPa}$
\end_inset

 is the isometric tension under maximal activation at the peak intracellular
 calcium concentration of
\emph on
 
\begin_inset Formula $\text{Ca}_{0}=4.35\,\mu\text{M}$
\end_inset


\emph default
.
 The length dependent calcium sensitivity is governed by the following equation:
 
\begin_inset Formula 
\begin{equation}
ECa_{50}=\frac{\left(\text{Ca}_{0}\right)_{\max}}{\sqrt{\exp\left[B(l-l_{0})\right]-1}}\,,\label{eq518}
\end{equation}

\end_inset

where 
\begin_inset Formula $\left(\text{Ca}_{0}\right)_{\max}=4.35\,\mu\text{M}$
\end_inset

 is the maximum peak intracellular calcium concentration, 
\begin_inset Formula $B=4.75\,\mu\text{m}^{-1}$
\end_inset

 governs the shape of the peak isometric tension-sarcomere length relation,
 
\begin_inset Formula $l_{0}=1.58\,\mu\text{m}$
\end_inset

 is the sarcomere length at which no active tension develops, and 
\begin_inset Formula $l$
\end_inset

 is the sarcomere length which is the product of the fiber stretch 
\begin_inset Formula $\lambda$
\end_inset

 and the sarcomere unloaded length 
\begin_inset Formula $l_{r}=2.04\,\mu\text{m}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Prescribed Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "sec:Prescribed-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
Prescribed active contraction models allow the user to directly specify
 the time history of the active contractile stress.
\end_layout

\begin_layout Subsection
Uniaxial Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uniaxial-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
For this model, the active stress is acting along a prescribed direction
 given by the unit vector 
\begin_inset Formula $\mathbf{a}_{r}$
\end_inset

 in the reference configuration.
 The 
\begin_inset Formula $2^{\text{nd}}$
\end_inset

 Piola-Kirchhoff stress is 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\mathbf{a}_{r}\otimes\mathbf{a}_{r}\,,\label{eq519}
\end{equation}

\end_inset

and the Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\mathbf{a}\otimes\mathbf{a}\,,\label{eq520}
\end{equation}

\end_inset

where 
\begin_inset Formula $T^{a}$
\end_inset

 is the prescribed contractile stress and 
\begin_inset Formula $\mathbf{a}=\mathbf{F}\cdot\mathbf{a}_{r}$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{S}^{a}$
\end_inset

 is not a function of deformation, the material and spatial tangents are
 both zero.
\end_layout

\begin_layout Subsection
Transversely Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:TISO-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
In this case, the active stress is isotropic in a plane transverse to the
 direction 
\begin_inset Formula $\mathbf{a}_{r}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\left(\mathbf{I}-\mathbf{a}_{r}\otimes\mathbf{a}_{r}\right)\,,\label{eq521}
\end{equation}

\end_inset

and the corresponding Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\left(\mathbf{B}-\mathbf{a}\otimes\mathbf{a}\right)\,,\label{eq522}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 The material and spatial tangents are zero.
\end_layout

\begin_layout Subsection
Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
An isotropic active contractile stress is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{S}^{a}=T^{a}\mathbf{I}\label{eq523}
\end{equation}

\end_inset

and the corresponding Cauchy stress is 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{a}=J^{-1}T^{a}\mathbf{B}\,.\label{eq524}
\end{equation}

\end_inset

The material and spatial tangents are zero.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Chemical Reaction Production Rate
\begin_inset CommandInset label
LatexCommand label
name "sec:CR-Production-Rate"

\end_inset


\end_layout

\begin_layout Standard
Production rate constitutive equations provide a relation for 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 as a function of solid matrix strain, solute concentrations, and the concentrat
ions of solid-bound molecular species.
\end_layout

\begin_layout Subsection
Mass Action Forward
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Forward"

\end_inset


\end_layout

\begin_layout Standard
According to the law of mass action for forward reactions, 
\begin_inset Formula 
\begin{equation}
\hat{\zeta}=k\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\,.\label{eq525}
\end{equation}

\end_inset

A constitutive relation for the specific reaction rate 
\begin_inset Formula $k\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 must also be provided.
\end_layout

\begin_layout Subsection
Mass Action Reversible
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Reversible"

\end_inset


\end_layout

\begin_layout Standard
According to the law of mass action for reversible reactions, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\zeta}_{F} & =k_{F}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\\
\hat{\zeta}_{R} & =k_{R}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{P}^{\alpha}}\\
\hat{\zeta} & =\hat{\zeta}_{F}-\hat{\zeta}_{R}=\hat{\zeta}_{F}\left[1-K_{c}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu^{\alpha}}\right]\,,
\end{aligned}
\label{eq526}
\end{equation}

\end_inset

where 
\begin_inset Formula $K_{c}=k_{R}/k_{F}$
\end_inset

 is a function that reduces to the equilibrium constant of the reversible
 reaction at chemical equilibrium (when 
\begin_inset Formula $\hat{\zeta}=0)$
\end_inset

.
 Constitutive relations for the specific forward and reverse reaction rates,
 
\begin_inset Formula $k_{F}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 and 
\begin_inset Formula $k_{R}\left(\theta,\mathbf{F},\rho_{r}^{\sigma}\right)$
\end_inset

 respectively, must also be provided.
\end_layout

\begin_layout Subsection
Michaelis-Menten
\begin_inset CommandInset label
LatexCommand label
name "subsec:Michaelis-Menten"

\end_inset


\end_layout

\begin_layout Standard
Michaelis-Menten is a model for enzyme kinetics as represented by the reactions
 
\begin_inset Formula 
\begin{equation}
\mathcal{E}^{e}+\mathcal{E}^{s}\rightleftharpoons\mathcal{E}^{es}\to\mathcal{E}^{e}+\mathcal{E}^{p}\,,\label{eq527}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{E}^{e}$
\end_inset

 is the enzyme, 
\begin_inset Formula $\mathcal{E}^{s}$
\end_inset

 is the substrate, 
\begin_inset Formula $\mathcal{E}^{es}$
\end_inset

 is the enzyme-substrate complex, and 
\begin_inset Formula $\mathcal{E}^{p}$
\end_inset

 is the product.
 The molar mass supply 
\begin_inset Formula $\hat{c}^{p}$
\end_inset

 producing 
\begin_inset Formula $\mathcal{E}^{p}$
\end_inset

 is related to the concentration of the substrate 
\begin_inset Formula $\mathcal{E}^{s}$
\end_inset

 via 
\begin_inset Formula 
\begin{equation}
\hat{c}^{p}=\frac{V_{max}c^{s}}{K_{m}+c^{s}}\,,\label{eq528}
\end{equation}

\end_inset

where 
\begin_inset Formula $V_{max}$
\end_inset

 is the maximum rate achieved by the system, at maximum (saturating) substrate
 concentrations.
 
\begin_inset Formula $K_{m}$
\end_inset

 is the substrate concentration at which the reaction rate is half of 
\begin_inset Formula $V_{max}$
\end_inset

.
\end_layout

\begin_layout Standard
This relation may be derived by applying the law of mass action to the two
 reactions in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq527"

\end_inset

.
 under the simplifying assumption that the reversible reaction between the
 enzyme and substrate reaches steady state much faster than the subsequent
 forward reaction forming the product.
 If the first and second reactions are denoted by subscripts 1 and 2, respective
ly, the law of mass action for the first (reversible) and second (forwar)
 reaction produces 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\hat{\zeta}_{1} & =k_{F1}c^{e}c^{s}-k_{R1}c^{es},\quad\hat{\zeta}_{2}=k_{F2}c^{es}\,,\\
\hat{c}^{s} & =-\hat{\zeta}_{1},\quad\hat{c}^{p}=\hat{\zeta}_{2},\quad\hat{c}^{es}=\hat{\zeta}_{1}-\hat{\zeta}_{2}\,.
\end{aligned}
\label{eq529}
\end{equation}

\end_inset

The total enzyme concentration remains constant at 
\begin_inset Formula $c_{0}^{e}=c^{e}+c^{es}$
\end_inset

, so that
\begin_inset Formula $\hat{\zeta}_{1}=k_{F1}c_{0}^{e}c^{s}-\left(k_{F1}c^{s}+k_{R1}\right)c^{es}$
\end_inset

.
 Assuming that the first reaction equilibrates much faster than the second
 is equivalent to letting 
\begin_inset Formula $\hat{\zeta}_{1}\approx0$
\end_inset

, in which case 
\begin_inset Formula 
\begin{equation}
c^{es}\approx\frac{c_{0}^{e}c^{s}}{c^{s}+K_{m}}\,,\label{eq530}
\end{equation}

\end_inset

where 
\begin_inset Formula $K_{m}=k_{R1}/k_{F1}$
\end_inset

.
 Then, 
\begin_inset Formula 
\[
\hat{\zeta}_{2}=\frac{V_{\max}c^{s}}{c^{s}+K_{m}}\,,
\]

\end_inset

where 
\begin_inset Formula $V_{\max}=k_{F2}c_{0}^{e}$
\end_inset

 represents the maximum value of 
\begin_inset Formula $\hat{\zeta}_{2}$
\end_inset

, when 
\begin_inset Formula $K_{m}\ll c^{s}$
\end_inset

.
 In practice, choosing 
\begin_inset Formula $k_{F1}\gg k_{F2}$
\end_inset

 can produce the desired effect.
\end_layout

\begin_layout Section
Specific Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "sec:Specific-Reaction-Rate"

\end_inset


\end_layout

\begin_layout Standard
Specific reaction rate constitutive equations provide a relation for 
\begin_inset Formula $k$
\end_inset

 as a function of solid matrix strain and the concentrations of solid-bound
 molecular species.
\end_layout

\begin_layout Subsection
Constant Specific Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Specific-Reaction"

\end_inset


\end_layout

\begin_layout Standard
For this material model, 
\begin_inset Formula $k$
\end_inset

 is constant.
\end_layout

\begin_layout Subsection
Huiskes Remodeling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Huiskes-Remodeling"

\end_inset


\end_layout

\begin_layout Standard
For this material, the specific reaction rate depends on the deviation of
 the specific strain energy from a threshold value, 
\begin_inset Formula 
\begin{equation}
k\left(\mathbf{F},\rho_{r}^{s}\right)=\frac{B}{\left(J-\varphi_{r}^{s}\right)M^{s}}\left(\frac{\Psi_{r}}{\rho_{r}^{s}}-\psi_{0}\right)\,,,\label{eq531}
\end{equation}

\end_inset

where 
\begin_inset Formula $B$
\end_inset

 is a constant, 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is the strain energy density of the solid, 
\begin_inset Formula $\rho_{r}^{s}$
\end_inset

 is the referential mass density of the solid, 
\begin_inset Formula $\psi_{0}$
\end_inset

 is the threshold value for the specific strain energy.
 In this relation, 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is evaluated from the solid deformation and 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is evaluated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:referential-solid-volume-fraction"

\end_inset

.
\end_layout

\begin_layout Section
Viscous Fluids
\end_layout

\begin_layout Standard
The most common family of constitutive relations employed for viscous fluids,
 including Newtonian fluids, is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}\left(J,\mathbf{D}\right)=\left(\kappa-\frac{2}{3}\mu\right)\left(\tr\mathbf{D}\right)\,\mathbf{I}+2\mu\,\mathbf{D}\,,\label{eq:viscous-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are, respectively, the dynamic shear and bulk viscosity coefficients (both
 positive), which may generally depend on 
\begin_inset Formula $J$
\end_inset

 and, for non-Newtonian fluids, on invariants of 
\begin_inset Formula $\mathbf{D}$
\end_inset

.
 In practice, most constitutive models for non-Newtonian viscous fluids
 only use a dependence on 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

, since it is the only non-zero invariant in viscometric flows 
\begin_inset CommandInset citation
LatexCommand cite
key "Reddy08"
literal "true"

\end_inset

.
 In this case, substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress-tangent-D"

\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\mathcal{C}}^{\tau} & =\left(\kappa-\frac{2}{3}\mu\right)\mathbf{I}\otimes\mathbf{I}+\frac{2}{\dot{\gamma}}\left(\frac{\partial\kappa}{\partial\dot{\gamma}}-\frac{2}{3}\frac{\partial\mu}{\partial\dot{\gamma}}\right)\left(\tr\mathbf{D}\right)\mathbf{I}\otimes\mathbf{D}\\
 & +2\left(\frac{2}{\dot{\gamma}}\frac{\partial\mu}{\partial\dot{\gamma}}\mathbf{D}\otimes\mathbf{D}+\mu\,\mathbf{I}\odot\mathbf{I}\right)\,.
\end{aligned}
\label{eq:viscous-tangent-D}
\end{equation}

\end_inset

The term containing 
\begin_inset Formula $\mathbf{I}\otimes\mathbf{D}$
\end_inset

 is the only one that does not exhibit major symmetry.
 In Newtonian fluids, 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\kappa$
\end_inset

 are independent of 
\begin_inset Formula $\mathbf{D}$
\end_inset

; in incompressible fluids they are independent of 
\begin_inset Formula $J$
\end_inset

 (since 
\begin_inset Formula $J=1$
\end_inset

 remains constant and 
\begin_inset Formula $\tr\mathbf{D}=0$
\end_inset

).
 Thus, for both of these cases the term containing 
\begin_inset Formula $\mathbf{I}\otimes\mathbf{D}$
\end_inset

 drops out and 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 exhibits major symmetry.
\end_layout

\begin_layout Standard
Similarly, using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

, the tangent 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stress-tangent-J"

\end_inset

 reduces to
\begin_inset Formula 
\begin{equation}
\boldsymbol{\tau}_{J}^{\prime}=\left(\frac{\partial\kappa}{\partial J}-\frac{2}{3}\frac{\partial\mu}{\partial J}\right)\left(\tr\mathbf{D}\right)\,\mathbf{I}+2\frac{\partial\mu}{\partial J}\,\mathbf{D}\,.\label{eq:viscous-tangent-J}
\end{equation}

\end_inset

Explicit forms for the dependence of 
\begin_inset Formula $\mu$
\end_inset

 or 
\begin_inset Formula $\kappa$
\end_inset

 on 
\begin_inset Formula $J$
\end_inset

 are not illustrated here, since viscosity generally shows negligible dependence
 on pressure (thus 
\begin_inset Formula $J$
\end_inset

) over typical ranges of pressures in fluids, hence 
\begin_inset Formula $\boldsymbol{\tau}_{J}^{\prime}\approx\mathbf{0}$
\end_inset

 in most analyses.
\end_layout

\begin_layout Standard
Many fluid mechanics textbooks employ Stoke's condition (
\begin_inset Formula $\kappa=0$
\end_inset

) for the purpose of equating the elastic pressure 
\begin_inset Formula $p$
\end_inset

 with the mean normal stress 
\begin_inset Formula $-\frac{1}{3}\tr\boldsymbol{\sigma}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Panton06"
literal "true"

\end_inset

; in FEBio, 
\begin_inset Formula $\kappa$
\end_inset

 is kept as a user-defined material property, which may be set to zero if
 desired.
 A common example of a non-Newtonian fluid is the Carreau model, where 
\begin_inset Formula $\boldsymbol{\tau}=2\mu\left(\dot{\gamma}\right)\mathbf{D}$
\end_inset

, which is a special case of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-stress"

\end_inset

, with 
\begin_inset Formula $\kappa=2\mu/3$
\end_inset

 and
\begin_inset Formula 
\begin{equation}
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\left(1+\left(\lambda\dot{\gamma}\right)^{2}\right)^{\left(n-1\right)/2}\,,\label{eq:Carreau-model-viscosity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda$
\end_inset

 is a time constant, 
\begin_inset Formula $n$
\end_inset

 is a parameter governing the power-law response, 
\begin_inset Formula $\mu_{0}$
\end_inset

 is the viscosity when 
\begin_inset Formula $\dot{\gamma}=0$
\end_inset

 and 
\begin_inset Formula $\mu_{\infty}$
\end_inset

 is the viscosity as 
\begin_inset Formula $\dot{\gamma}\to\infty$
\end_inset

.
 Other common models of non-Newtonian viscous fluids are summarized in 
\begin_inset CommandInset citation
LatexCommand cite
key "Cho91"
literal "true"

\end_inset

, though it should be noted that some of these models produce infinite values
 when evaluating 
\begin_inset Formula $\dot{\gamma}^{-1}\partial\mu/\partial\dot{\gamma}$
\end_inset

 as 
\begin_inset Formula $\dot{\gamma}\to0$
\end_inset

, which is problematic in the evaluation of 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{\tau}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:viscous-tangent-D"

\end_inset

.
\end_layout

\begin_layout Standard
For nearly incompressible fluids, a simple constitutive relation may be
 adopted for the pressure,
\begin_inset Formula 
\begin{equation}
p\left(J\right)=K\left(1-J\right)\,,\label{eq:ideal-fluid}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the bulk modulus of the fluid in the limit when 
\begin_inset Formula $J=1$
\end_inset

.
 It follows that 
\begin_inset Formula $p^{\prime}\left(J\right)=-K$
\end_inset

 and 
\begin_inset Formula $p^{\prime\prime}\left(J\right)=0$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Wint-linearization-J"

\end_inset

.
 This constitutive relation is adopted for nearly-incompressible CFD analyses
 in FEBio, though alternative formulations may be easily implemented.
\end_layout

\begin_layout Chapter
Dynamics
\begin_inset CommandInset label
LatexCommand label
name "chap:Dynamics"

\end_inset


\end_layout

\begin_layout Standard
FEBio can perform a nonlinear dynamic analysis by iteratively solving the
 following nonlinear semi-discrete finite element equations 
\begin_inset CommandInset citation
LatexCommand citep
key "Bathe82"
literal "true"

\end_inset

.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & \mathbf{M\ddot{d}}_{n+1}^{k}+\mathbf{K}\Delta\mathbf{d}^{k}=\mathbf{T}_{n+1}^{k}-\mathbf{F}_{n+1}\\
 & \mathbf{d}_{n+1}^{k}=\mathbf{d}_{n+1}^{k-1}+\Delta\mathbf{d}^{k}
\end{aligned}
\,.\label{eq717}
\end{equation}

\end_inset

Here, 
\series bold

\begin_inset Formula $\mathbf{M}$
\end_inset


\series default
 is the mass matrix, 
\series bold

\begin_inset Formula $\mathbf{K}$
\end_inset


\series default
 the stiffness matrix, 
\series bold

\begin_inset Formula $\mathbf{T}$
\end_inset


\series default
 the internal force (stress) vector and 
\series bold

\begin_inset Formula $\mathbf{F}$
\end_inset


\series default
 the externally applied loads.
 The upperscript index 
\begin_inset Formula $k$
\end_inset

 refers to the iteration number, the subscript 
\begin_inset Formula $n$
\end_inset

refers to the time increment.
 The trapezoidal (or midpoint) rule is used to perform the time integration.
 This results in the following approximations for the displacement and velocity
 updates.
 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{d}_{n+1} & =\mathbf{d}_{n}+\frac{h}{2}\left(\mathbf{\dot{d}}_{n}+\mathbf{\dot{d}}_{n+1}\right)\\
\mathbf{\dot{d}}_{n+1} & =\mathbf{\dot{d}}_{n}+\frac{h}{2}\left(\mathbf{\ddot{d}}_{n}+\mathbf{\ddot{d}}_{n+1}\right)
\end{aligned}
\,.\label{eq718}
\end{equation}

\end_inset

Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq718"

\end_inset

 we can solve for 
\begin_inset Formula $\mathbf{\ddot{d}}_{n+1}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{\ddot{d}}_{n+1}^{k}=\frac{4}{h^{2}}\left(\mathbf{d}_{n+1}^{k-1}-\mathbf{d}_{n}+\Delta\mathbf{d}^{k}\right)-\frac{4}{h}\mathbf{\dot{d}}_{n}-\mathbf{\ddot{d}}_{n}\,.\label{eq719}
\end{equation}

\end_inset

Substituting this into equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq717"

\end_inset

 results in the following linear system of equations.
 
\begin_inset Formula 
\begin{equation}
\left(\frac{4}{h^{2}}\mathbf{M}+\mathbf{K}\right)\Delta\mathbf{d}^{k}=\mathbf{T}_{n+1}^{k}-\mathbf{F}_{n+1}-\mathbf{M}\left(\frac{4}{h^{2}}\left(\mathbf{d}_{n+1}^{k-1}-\mathbf{d}_{n}\right)-\frac{4}{h}\mathbf{\dot{d}}_{n}-\mathbf{\ddot{d}}_{n}\right)\,.\label{eq720}
\end{equation}

\end_inset

Solving this equation for 
\begin_inset Formula $\Delta\mathbf{d}^{k}$
\end_inset

 and using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq717"

\end_inset

 gives the new displacement vector 
\begin_inset Formula $\mathbf{d}_{n+1}^{k}$
\end_inset

 .
 The acceleration vector 
\begin_inset Formula $\mathbf{\ddot{d}}_{n+1}^{k}$
\end_inset

 can then be found from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq719"

\end_inset

 and the velocity vector 
\begin_inset Formula $\mathbf{\dot{d}}_{n+1}^{k}$
\end_inset

 from
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq719"

\end_inset

.
 This algorithm is repeated until convergence is reached.
\end_layout

\begin_layout Section
Newmark Integration
\begin_inset CommandInset label
LatexCommand label
name "sec:Newmark-Integration"

\end_inset


\end_layout

\begin_layout Standard
To solve a differential equation which is second-order in time, we need
 to perform a numerical integration in the time domain.
 Let 
\begin_inset Formula $\theta\left(t\right)$
\end_inset

 denote the function of interest and let 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

 represent consecutive time steps such that 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

.
 The function 
\begin_inset Formula $\theta\left(t\right)$
\end_inset

 may be represented at each time point as 
\begin_inset Formula $\theta_{n}=\theta\left(t_{n}\right)$
\end_inset

 and 
\begin_inset Formula $\theta_{n+1}=\theta\left(t_{n+1}\right)$
\end_inset

.
 The Newmark integration formulas are used to evaluate 
\begin_inset Formula $\theta_{n+1}$
\end_inset

 and 
\begin_inset Formula $\dot{\theta}_{n+1}$
\end_inset

 at time 
\begin_inset Formula $\theta_{n+1}$
\end_inset

, assuming that they can be integrated from a judiciously selected 
\begin_inset Formula $\ddot{\theta}\left(t_{n+\gamma}\right)$
\end_inset

 in the time interval 
\begin_inset Formula $\left[t_{n},t_{n+1}\right]$
\end_inset

.
 Using the mean value theorem for definite integrals, we know that an exact
 solution may be found for the integral according to
\begin_inset Formula 
\begin{equation}
\int_{t_{n}}^{t_{n+1}}\ddot{\theta}\left(t\right)\,dt=\dot{\theta}_{n+1}-\dot{\theta}_{n}\equiv\ddot{\theta}\left(t_{n+\gamma}\right)\Delta t\,,\label{eq:Newmark-mean-value-theorem}
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma$
\end_inset

 is generally unknown 
\emph on
a priori
\emph default
.
 In the Newmark integration scheme we let
\begin_inset Formula 
\begin{equation}
\ddot{\theta}\left(t_{n+\gamma}\right)=\gamma\ddot{\theta}_{n+1}+\left(1-\gamma\right)\ddot{\theta}_{n}\,,\label{eq:Newmark-gamma-deriv}
\end{equation}

\end_inset

where 
\begin_inset Formula $\gamma$
\end_inset

 is a user-selected parameter in the range 
\begin_inset Formula $0$
\end_inset

 to 
\begin_inset Formula $1$
\end_inset

.
 It follows that
\begin_inset Formula 
\begin{equation}
\dot{\theta}_{n+1}=\dot{\theta}_{n}+\Delta t\left[\gamma\ddot{\theta}_{n+1}+\left(1-\gamma\right)\ddot{\theta}_{n}\right]\,.\label{eq:Newmark-velocity}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We can similarly integrate this function twice to obtain 
\begin_inset Formula $\theta_{n+1}$
\end_inset

,
\begin_inset Formula 
\[
\int_{t_{n}}^{t_{n+1}}\int_{t_{n}}^{t}\ddot{\theta}\left(\tau\right)\,d\tau\,dt=\int_{t_{n}}^{t_{n+1}}\left(\dot{\theta}\left(t\right)-\dot{\theta}_{n}\right)\,dt=\theta_{n+1}-\theta_{n}-\dot{\theta}_{n}\Delta t\equiv\ddot{\theta}\left(t_{n+2\beta}\right)\frac{\Delta t^{2}}{2}
\]

\end_inset

where we let
\begin_inset Formula 
\[
\ddot{\theta}\left(t_{n+2\beta}\right)=2\beta\ddot{\theta}_{n+1}+\left(1-2\beta\right)\ddot{\theta}_{n}\,.
\]

\end_inset

Here, 
\begin_inset Formula $\beta$
\end_inset

 represents a parameter that varies from 
\begin_inset Formula $0$
\end_inset

 to 
\begin_inset Formula $\frac{1}{2}$
\end_inset

.
 It follows that
\begin_inset Formula 
\begin{equation}
\theta_{n+1}=\theta_{n}+\dot{\theta}_{n}\Delta t+\frac{\Delta t^{2}}{2}\left[2\beta\ddot{\theta}_{n+1}+\left(1-2\beta\right)\ddot{\theta}_{n}\right]\,,\label{eq:Newmark-displacement}
\end{equation}

\end_inset

or alternatively,
\begin_inset Formula 
\begin{equation}
\ddot{\theta}_{n+1}=\frac{1}{\beta\Delta t^{2}}\left(\theta_{n+1}-\theta_{n}-\dot{\theta}_{n}\Delta t\right)-\left(\frac{1}{2\beta}-1\right)\ddot{\theta}_{n}\,,\label{eq:Newmark-acceleration}
\end{equation}

\end_inset

from which we may re-evaluate 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Newmark-velocity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\dot{\theta}_{n+1}=\dot{\theta}_{n}+\Delta t\left[\frac{\gamma}{\beta\Delta t^{2}}\left(\theta_{n+1}-\theta_{n}-\dot{\theta}_{n}\Delta t\right)+\left(1-\frac{\gamma}{2\beta}\right)\ddot{\theta}_{n}\right]\,.\label{eq:Newmark-velocity-redux}
\end{equation}

\end_inset

Stability of this integration scheme is guaranteed when 
\begin_inset Formula 
\begin{equation}
\gamma\ge\frac{1}{2}\,,\quad\beta\ge\frac{\left(\gamma+\frac{1}{2}\right)^{2}}{4}\,.\label{eq:Newmark-stability}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Elastodynamics
\begin_inset CommandInset label
LatexCommand label
name "sec:Elastodynamics"

\end_inset


\end_layout

\begin_layout Subsection
Governing Equations
\end_layout

\begin_layout Standard
The linear momentum balance for elastodynamics is 
\begin_inset Formula 
\begin{equation}
\rho\mathbf{a}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,\label{eq:edy-solid-momentum}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the density, 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the acceleration, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress, and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is the body force per mass.
 The angular momentum balance is satisfied by letting 
\begin_inset Formula $\boldsymbol{\sigma}^{T}=\boldsymbol{\sigma}$
\end_inset

.
 The integrated form of the mass balance equations yields
\begin_inset Formula 
\begin{equation}
\rho=\frac{\rho_{r}}{J}\,,\label{eq:edy-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the density in the reference configuration and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

, where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 The acceleration is given by the material time derivative of the velocity
 
\begin_inset Formula $\mathbf{v}$
\end_inset

, evaluated either in a spatial or a material frame,
\begin_inset Formula 
\begin{equation}
\mathbf{a}=\dot{\mathbf{v}}\label{eq:edy-acceleration}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Virtual Work
\end_layout

\begin_layout Standard
The virtual work for the domain 
\begin_inset Formula $b$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\delta W=\int_{b}\delta\mathbf{v}\cdot\left(\divg\boldsymbol{\sigma}+\rho\left(\mathbf{b}-\mathbf{a}\right)\right)\,dv\,,\label{eq:edy-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 is the virtual velocity.
 Using the divergence theorem, this virtual work may be expressed as the
 difference 
\begin_inset Formula $\delta W=\delta W_{ext}-\delta W_{int}$
\end_inset

 between external virtual work 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 and internal virtual work 
\begin_inset Formula $\delta W_{int}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta W_{int} & =\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}\,dv+\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{a}\,dv\,,\\
\delta W_{ext} & =\int_{\partial b}\delta\mathbf{v}\cdot\mathbf{t}\,da+\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv\,,
\end{aligned}
\label{eq:edy-int-ext-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 is the traction on the boundary 
\begin_inset Formula $\partial b$
\end_inset

.
\end_layout

\begin_layout Subsection
Generalized 
\begin_inset Formula $\alpha-$
\end_inset

Method for Elastodynamics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generalized-alpha-elastodynamics"

\end_inset


\end_layout

\begin_layout Standard
In the generalized 
\begin_inset Formula $\alpha-$
\end_inset

method, we evaluate displacements and velocities at the intermediate time
 
\begin_inset Formula $t_{n+\alpha_{f}}=t_{n}+\alpha_{f}\left(t_{n+1}-t_{n}\right)$
\end_inset

, where 
\begin_inset Formula $\alpha_{f}$
\end_inset

 is a user-defined parameter (
\begin_inset Formula $0<\alpha_{f}\le1$
\end_inset

), such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\chi}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\boldsymbol{\chi}_{n}+\alpha_{f}\boldsymbol{\chi}_{n+1}\,,\\
\mathbf{u}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{u}_{n}+\alpha_{f}\mathbf{u}_{n+1}\,,\\
\mathbf{v}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{v}_{n}+\alpha_{f}\mathbf{v}_{n+1}\,,
\end{aligned}
\label{eq:edy-motion-interpolation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

 is the motion and 
\begin_inset Formula $\mathbf{u}$
\end_inset

 is the displacement.
 In particular, it follows that the deformation gradient and its determinant
 are given at the intermediate time by
\begin_inset Formula 
\begin{equation}
\mathbf{F}_{n+\alpha_{f}}=\frac{\partial\boldsymbol{\chi}_{n+\alpha_{f}}}{\partial\mathbf{X}}=\left(1-\alpha_{f}\right)\mathbf{F}_{n}+\alpha_{f}\mathbf{F}_{n+1}\,,\label{eq:edy-mp-defgrad}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
J_{n+\alpha_{f}}=\det\mathbf{F}_{n+\alpha_{f}}\,.\label{eq:edy-mp-detJ}
\end{equation}

\end_inset

The material time derivative of 
\begin_inset Formula $J_{n+\alpha_{f}}$
\end_inset

, and the velocity gradient 
\begin_inset Formula $\mathbf{L}_{n+\alpha_{f}}$
\end_inset

 are normally evaluated as
\begin_inset Formula 
\begin{equation}
\dot{J}_{n+\alpha_{f}}=J_{n+\alpha_{f}}\mathbf{F}_{n+\alpha_{f}}^{-T}:\Grad\mathbf{v}_{n+\alpha_{f}}\,,\label{eq:edy-Jdot-exact}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathbf{L}_{n+\alpha_{f}}=\Grad\mathbf{v}_{n+\alpha_{f}}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}\,.\label{eq:edy-L-exact}
\end{equation}

\end_inset

In practice however, we get better numerical results when using
\begin_inset Formula 
\begin{equation}
\dot{J}_{n+\alpha_{f}}=\frac{J_{n+1}-J_{n}}{\Delta t}\,,\label{eq:edy-Jdot-approx}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\mathbf{L}_{n+\alpha_{f}}=\frac{\mathbf{F}_{n+1}-\mathbf{F}_{n}}{\Delta t}\cdot\mathbf{F}_{n+\alpha_{f}}^{-1}\,.\label{eq:edy-L-approx}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
According to the generalized
\begin_inset Formula $-\alpha$
\end_inset

 method, we evaluate the velocity derivative at a different intermediate
 time 
\begin_inset Formula $t_{n+\alpha_{m}}=t_{n}+\alpha_{m}\left(t_{n+1}-t_{n}\right)$
\end_inset

, such that
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{v}}_{n+\alpha_{m}}=\left(1-\alpha_{m}\right)\dot{\mathbf{v}}_{n}+\alpha_{m}\dot{\mathbf{v}}_{n+1}\,.\label{eq:edy-vdot-interpolation}
\end{equation}

\end_inset

Since elastodynamics represent a second-order system of equations in time,
 the parameters 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 are evaluated from a single parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 using 
\begin_inset CommandInset citation
LatexCommand citep
key "Bazilevs08"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{2-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas-2-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

.
 This parameter is the spectral radius for an infinite time step, which
 controls the amount of damping of high frequencies; a value of zero produces
 the greatest amount of damping, anihilating the highest frequency in one
 step, whereas a value of one preserves the highest frequency.
\end_layout

\begin_layout Standard
To complete the integration scheme 
\begin_inset CommandInset citation
LatexCommand citep
key "Jansen00"
literal "true"

\end_inset

, we evaluate
\begin_inset Formula 
\begin{equation}
\begin{aligned}\beta & =\frac{1}{4}\left(1+\alpha_{m}-\alpha_{f}\right)^{2}\\
\gamma & =\frac{1}{2}+\alpha_{m}-\alpha_{f}
\end{aligned}
\,,\label{eq:edy-Newmark}
\end{equation}

\end_inset

then we use the Newmark integration formulas (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Newmark-Integration"
plural "false"
caps "false"
noprefix "false"

\end_inset

),
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{v}_{n+1} & =\mathbf{v}_{n}+\Delta t\left[\left(1-\gamma\right)\dot{\mathbf{v}}_{n}+\gamma\dot{\mathbf{v}}_{n+1}\right]\\
\mathbf{u}_{n+1} & =\mathbf{u}_{n}+\Delta t\mathbf{v}_{n}+\frac{\Delta t^{2}}{2}\left[\left(1-2\beta\right)\dot{\mathbf{v}}_{n}+2\beta\dot{\mathbf{v}}_{n+1}\right]\\
\dot{\mathbf{v}}_{n+1} & =\frac{1}{\beta\Delta t}\left(\frac{\mathbf{u}_{n+1}-\mathbf{u}_{n}}{\Delta t}-\mathbf{v}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\dot{\mathbf{v}}_{n}
\end{aligned}
\,.\label{eq:edy-current-time}
\end{equation}

\end_inset

At the start of each time step, we initialize the variables as follows:
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{u}_{n+1} & =\mathbf{u}_{n}\\
\dot{\mathbf{v}}_{n+1} & =\left(1-\frac{1}{2\beta}\right)\dot{\mathbf{v}}_{n}-\frac{1}{\beta\Delta t}\mathbf{v}_{n}\\
\mathbf{v}_{n+1} & =\left(1-\frac{\gamma}{\beta}\right)\mathbf{v}_{n}+\Delta t\left(1-\frac{\gamma}{2\beta}\right)\dot{\mathbf{v}}_{n}
\end{aligned}
\,.\label{eq:edy-initializations}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization
\end_layout

\begin_layout Standard
The solution of the nonlinear equation 
\begin_inset Formula $\delta W=0$
\end_inset

 is obtained by linearizing this relation as
\begin_inset Formula 
\begin{equation}
\delta W+D\delta W\left[\Delta\mathbf{u}\right]\approx0\,,\label{eq:edy-linearized-virtual-work}
\end{equation}

\end_inset

where the operator 
\begin_inset Formula $D\delta W\left[\cdot\right]$
\end_inset

 represents the directional derivative of 
\begin_inset Formula $\delta W$
\end_inset

 at 
\begin_inset Formula $\mathbf{u}$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

 of 
\begin_inset Formula $\mathbf{u}_{n+1}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 According to the generalized
\begin_inset Formula $-\alpha$
\end_inset

 method 
\begin_inset CommandInset citation
LatexCommand cite
key "Jansen00"
literal "true"

\end_inset

, the virtual work is evaluated using intermediate time step values, at
 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

 for all parameters except 
\begin_inset Formula $\dot{\mathbf{v}}$
\end_inset

, which is evaluated at 
\begin_inset Formula $t_{n+\alpha_{m}}$
\end_inset

.
 It follows from these definitions that the linearizations of critical variables
 are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{u}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Delta\mathbf{u}\\
D\mathbf{F}\left[\Delta\mathbf{u}\right] & =\alpha_{f}\Grad\Delta\mathbf{u}\\
DJ\left[\Delta\mathbf{u}\right] & =\alpha_{f}J\left(\divg\Delta\mathbf{u}\right)\\
D\dot{J}\left[\Delta\mathbf{u}\right] & =D\left(J\mathbf{F}^{-T}:\Grad\mathbf{v}\right)\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}J\left[\left(\divg\mathbf{v}+\frac{\gamma}{\beta\Delta t}\right)\left(\divg\Delta\mathbf{u}\right)-\left(\grad\Delta\mathbf{u}\right)^{T}:\mathbf{L}\right]\\
D\mathbf{v}\left[\Delta\mathbf{u}\right] & =\frac{\alpha_{f}\gamma}{\beta\Delta t}\Delta\mathbf{u}\\
D\dot{\mathbf{v}}\left[\Delta\mathbf{u}\right] & =\frac{\alpha_{m}}{\beta\Delta t^{2}}\Delta\mathbf{u}
\end{aligned}
\,.\label{eq:edy-linearizations}
\end{equation}

\end_inset

To linearize the virtual work, we need to express the integrals appearing
 in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 and 
\begin_inset Formula $\delta W_{ext}$
\end_inset

 over the material frame of the finite element solid domain.
\end_layout

\begin_layout Subsubsection
Internal Work
\end_layout

\begin_layout Standard
The first term in the internal work becomes
\begin_inset Formula 
\begin{equation}
\begin{aligned}\int_{b}\boldsymbol{\sigma}:\grad\delta\mathbf{v}\,dv & =\int_{B}\mathbf{F}\cdot\mathbf{S}:\Grad\delta\mathbf{v}\,dV\end{aligned}
\,,\label{eq:work-material-1-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}=J\cdot\mathbf{F}^{-1}\cdot\boldsymbol{\sigma}\cdot\mathbf{F}^{-T}$
\end_inset

 is the second Piola-Kirchhoff stress for the solid material.
 In general, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 (and thus, 
\begin_inset Formula $\mathbf{S}$
\end_inset

) is only a function of the solid strain, such as the right Cauchy-Green
 tensor 
\begin_inset Formula $\mathbf{C}=\mathbf{F}^{T}\cdot\mathbf{F}$
\end_inset

 or the Green-Lagrange strain 
\begin_inset Formula $\mathbf{E}=\left(\mathbf{C}-\mathbf{I}\right)/2$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
D\mathbf{E}\left[\Delta\mathbf{u}\right]=\frac{\alpha_{f}}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)\,.\label{eq:edy-E-linearization}
\end{equation}

\end_inset

Therefore, following the standard approach in solid mechanics, the linearization
 of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{S}\left[\Delta\mathbf{u}\right] & =\frac{\partial\mathbf{S}}{\partial\mathbf{E}}:D\mathbf{E}\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}:\frac{1}{2}\left(\Grad^{T}\Delta\mathbf{u}\cdot\mathbf{F}+\mathbf{F}^{T}\cdot\Grad\Delta\mathbf{u}\right)\\
 & =\alpha_{f}\boldsymbol{\mathbb{C}}:\left(\mathbf{F}^{T}\oslash\mathbf{F}^{T}\right):\Delta\boldsymbol{\varepsilon}
\end{aligned}
\,,\label{eq:edy-solid-stress-linearization}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathbb{C}}$
\end_inset

 is the material elasticity tensor.
 Now, the linearization of the first term in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned} & D\left(\int_{B}\mathbf{F}\cdot\mathbf{S}:\Grad\delta\mathbf{v}\,dV\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{v}\alpha_{f}\left(\grad\delta\mathbf{v}:\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}+\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}:\grad\Delta\mathbf{u}\right)\,dv
\end{aligned}
}\,.\label{eq:edy-Dint-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 is the spatial elasticity tensor.
 Similarly, the second term in 
\begin_inset Formula $\delta W_{int}$
\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\boxed{D\left(\int_{B}\delta\mathbf{v}\cdot\rho_{r}\mathbf{a}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\delta\mathbf{v}\cdot\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho\Delta\mathbf{u}\,dv}\,.\label{eq:edy-Dint-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
External Work
\end_layout

\begin_layout Standard
The linearization of the body force term is
\begin_inset Formula 
\begin{equation}
D\left(\int_{B}\delta\mathbf{v}\cdot\rho_{r}\mathbf{b}\,dV\right)\left[\Delta\mathbf{u}\right]=\int_{b}\delta\mathbf{v}\cdot\alpha_{f}\rho\grad\mathbf{b}\cdot\Delta\mathbf{u}\,dv\,.\label{eq:edy-Dext}
\end{equation}

\end_inset

The linearization of the traction force term is
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(\int_{\Gamma_{\eta}}\delta\mathbf{v}\cdot\mathbf{t}\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}\right)\left[\Delta\mathbf{u}\right]\\
 & =\int_{\Gamma_{\eta}}\alpha_{f}\delta\mathbf{v}\cdot\left(\mathbf{t}\otimes\mathbf{n}\right)\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\,d\eta^{1}d\eta^{2}\\
 & +\int_{\Gamma_{\eta}}\delta\mathbf{v}\cdot D\mathbf{t}\left[\Delta\mathbf{u}\right]\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\,d\eta^{1}d\eta^{2}
\end{aligned}
\,.\label{eq:edy-Dext-final}
\end{equation}

\end_inset

Note that 
\begin_inset Formula $D\mathbf{t}\left[\Delta\mathbf{u}\right]$
\end_inset

 depends on the nature of the surface traction.
 For a prescribed traction we have 
\begin_inset Formula $D\mathbf{t}\left[\Delta\mathbf{u}\right]=\mathbf{0}$
\end_inset

.
 A contact analysis needs more elaborate derivations (not yet implemented
 as of FEBio 2.7).
 In the above expression we used
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|\left[\Delta\mathbf{u}\right] & =\mathbf{n}\cdot D\left(\mathbf{g}_{1}\times\mathbf{g}_{2}\right)\left[\Delta\mathbf{u}\right]\\
 & =\alpha_{f}\mathbf{n}\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)
\end{aligned}
\label{eq:edy-Dext-DA}
\end{equation}

\end_inset

where the unit outward normal is evaluated as
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{g}_{1}\times\mathbf{g}_{2}}{\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,.\label{eq:edy-unit-normal}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization
\end_layout

\begin_layout Standard
We use the following interpolations:
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v} & =\sum_{a}N_{a}\delta\mathbf{v}_{a} & \Delta\mathbf{u} & =\sum_{b}N_{b}\Delta\mathbf{u}_{b}\\
\grad\delta\mathbf{v} & =\sum_{a}\delta\mathbf{v}_{a}\otimes\grad N_{a} & \grad\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\otimes\grad N_{b}\\
\divg\delta\mathbf{v} & =\sum_{a}\delta\mathbf{v}_{a}\cdot\grad N_{a} & \divg\Delta\mathbf{u} & =\sum_{b}\Delta\mathbf{u}_{b}\cdot\grad N_{b}
\end{aligned}
\,,\label{eq:interpolations-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}\left(\eta^{1},\eta^{2},\eta^{3}\right)$
\end_inset

 are shape functions of the element parametric coordinates 
\begin_inset Formula $\left(\eta^{1},\eta^{2},\eta^{3}\right)$
\end_inset

.
 Note that the 
\begin_inset Formula $\grad\equiv\frac{\partial}{\partial\mathbf{x}}$
\end_inset

 operator should be evaluated at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

, using 
\begin_inset Formula $\mathbf{x}_{n+\alpha_{f}}$
\end_inset

.
 For example, in the case of a scalar function 
\begin_inset Formula $f$
\end_inset

,
\begin_inset Formula 
\[
\begin{aligned}\grad f & =\frac{\partial f}{\partial\mathbf{x}_{n+\alpha_{f}}}=\frac{\partial f}{\partial\eta^{i}}\mathbf{g}_{n+\alpha_{f}}^{i}\\
\mathbf{g}_{n+\alpha_{f}}^{i} & =\frac{\partial\eta^{i}}{\partial\mathbf{x}_{n+\alpha_{f}}}
\end{aligned}
\,,
\]

\end_inset

where the contravariant basis vectors 
\begin_inset Formula $\mathbf{g}_{n+\alpha_{f}}^{i}$
\end_inset

 may be evaluated from the covariant basis vectors
\begin_inset Formula 
\[
\mathbf{g}_{i}^{n+\alpha_{f}}=\frac{\partial\mathbf{x}_{n+\alpha_{f}}}{\partial\eta^{i}}=\left(1-\alpha_{f}\right)\frac{\partial\mathbf{x}_{n}}{\partial\eta^{i}}+\alpha_{f}\frac{\partial\mathbf{x}_{n+1}}{\partial\eta^{i}}
\]

\end_inset

using 
\begin_inset Formula $\mathbf{g}_{i}^{n+\alpha_{f}}\cdot\mathbf{g}_{n+\alpha_{f}}^{j}=\delta_{i}^{j}$
\end_inset

.
\end_layout

\begin_layout Standard
The discretization of the internal work produces
\begin_inset Formula 
\begin{equation}
\delta W_{int}=\sum_{a}\delta\mathbf{v}_{a}\cdot\int_{b}\left(\mathbf{f}_{a}^{u}+\mathbf{f}_{a}^{\rho}\right)\,dv\,,\label{eq:edy-discretized-internal-work}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{f}_{a}^{u} & =\boldsymbol{\sigma}\cdot\grad N_{a}\\
\mathbf{f}_{a}^{\rho} & =N_{a}\rho\mathbf{a}
\end{aligned}
}\,.\label{eq:edy-discretized-residuals}
\end{equation}

\end_inset

The discretization of the stress and elasticity terms in the internal work
 is
\begin_inset Formula 
\[
\begin{aligned} & \int_{v}\alpha_{f}\left(\grad\delta\mathbf{v}:\grad\Delta\mathbf{u}\cdot\boldsymbol{\sigma}+\grad\delta\mathbf{v}:\boldsymbol{\mathcal{C}}:\grad\Delta\mathbf{u}\right)\,dv\\
 & =\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\int_{v}\mathbf{K}_{ab}\,dv\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\,,
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}=\alpha_{f}\left(\left(\grad N_{a}\cdot\boldsymbol{\sigma}\cdot\grad N_{b}\right)\mathbf{I}+\grad N_{a}\cdot\boldsymbol{\mathcal{C}}\cdot\grad N_{b}\right)}\,.\label{eq:edy-Wint-Kab}
\end{equation}

\end_inset

The discretization of the mass term in the internal work is
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}\cdot\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho\Delta\mathbf{u}\,dv=\sum_{a}\delta\mathbf{v}_{a}\cdot\sum_{b}\int_{b}\mathbf{M}_{ab}\,dv\cdot\Delta\mathbf{u}_{b}\,,
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{M}_{ab}=\frac{\alpha_{m}}{\beta\Delta t^{2}}\rho N_{a}N_{b}\mathbf{I}}\,.\label{eq:edy-Wint-Mab}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the external work of body forces,
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}\cdot\rho\mathbf{b}\,dv=\sum_{a}\delta\mathbf{v}_{a}\cdot\int_{b}\mathbf{f}_{a}^{\mathbf{b}}\,dv
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}_{a}^{\mathbf{b}}=N_{a}\rho^{s}\mathbf{b}}\,,\label{eq:edy-Wext-fb}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
\int_{b}\delta\mathbf{v}^{s}\cdot\alpha_{f}\rho^{s}\grad\mathbf{b}\cdot\Delta\mathbf{u}\,dv=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{b}\mathbf{K}_{ab}^{\mathbf{b}}\,dv\cdot\Delta\mathbf{u}_{b}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{\mathbf{b}}=\alpha_{f}N_{a}N_{b}\rho^{s}\grad\mathbf{b}}\,.\label{eq:edy-Wext-Kb}
\end{equation}

\end_inset

For prescribed tractions,
\begin_inset Formula 
\[
\int_{\partial b}\delta\mathbf{v}^{s}\cdot\mathbf{t}^{s}\,da=\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\int_{\Gamma_{\eta}}\mathbf{f}_{a}^{t}\,d\eta^{1}d\eta^{2}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}_{a}^{t}=N_{a}\mathbf{t}^{s}\,\left|\mathbf{g}_{1}\times\mathbf{g}_{2}\right|}\,,\label{eq:edy-Wext-ft}
\end{equation}

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned} & \int_{\Gamma_{\eta}}\alpha_{f}\delta\mathbf{v}^{s}\cdot\left(\mathbf{t}^{s}\otimes\mathbf{n}\right)\cdot\left(\mathbf{g}_{1}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{2}}-\mathbf{g}_{2}\times\frac{\partial\Delta\mathbf{u}}{\partial\eta^{1}}\right)\,d\eta^{1}d\eta^{2}\\
 & =\sum_{a}\delta\mathbf{v}_{a}^{s}\cdot\sum_{b}\int_{\Gamma_{\eta}}\mathbf{K}_{ab}^{t}\,d\eta^{1}d\eta^{2}\cdot\Delta\mathbf{u}_{b}
\end{aligned}
\]

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{ab}^{t}=\alpha_{f}N_{a}\left(\mathbf{t}^{s}\otimes\mathbf{n}\right)\cdot\left(\frac{\partial N_{b}}{\partial\eta^{2}}\hat{\mathbf{g}}_{1}-\frac{\partial N_{b}}{\partial\eta^{1}}\hat{\mathbf{g}}_{2}\right)}\,,\label{eq:edy-Wext-Kt}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{g}}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{g}$
\end_inset

.
\end_layout

\begin_layout Subsection
Energy-Momentum Conservation Scheme
\end_layout

\begin_layout Standard
The time discretization scheme may be selected in a manner that enforces
 linear and angular momentum, and energy conservation over consecutive time
 steps 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

, when boundary conditions and external loads are time-independent.
 Based on the prior literature 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo92a,Gonzalez00,Puso02"
literal "true"

\end_inset

, this momentum and energy conservation may be achieved by using the midpoint
 rule (
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

, leading to 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\frac{1}{2}$
\end_inset

), and evaluating the virtual work at 
\begin_inset Formula $t_{n+\frac{1}{2}}$
\end_inset

.
 However, since the virtual work strictly enforces momentum balance only,
 there is no guarantee that energy conservation will be satisfied as a result
 of time discretization.
 Therefore, we need to enforce a specific scheme to satisfy energy balance.
\end_layout

\begin_layout Subsubsection
Energy Balance
\end_layout

\begin_layout Standard
For an elastic solid, in the absence of heat exchanges (i.e., in elastodynamics),
 the equation of energy balance reduces
\begin_inset Formula 
\begin{equation}
\rho\dot{\varepsilon}=\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the specific internal energy and 
\begin_inset Formula $\mathbf{D}$
\end_inset

 is the rate of deformation tensor.
 Recall that 
\begin_inset Formula $\varepsilon=\psi+\theta\eta$
\end_inset

, where 
\begin_inset Formula $\psi$
\end_inset

 is the specific free energy, 
\begin_inset Formula $\theta$
\end_inset

 is the absolute temperature and 
\begin_inset Formula $\eta$
\end_inset

 is the specific entropy.
 Since 
\begin_inset Formula $\eta=0$
\end_inset

 in elasticity (due to the temperature remaining constant), the above energy
 balance may be combined with the mass balance 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-mass-balance"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\rho\dot{\psi}=\frac{\rho_{r}}{J}\dot{\psi}=\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-r1}
\end{equation}

\end_inset

or
\begin_inset Formula 
\begin{equation}
\dot{\Psi}_{r}=J\boldsymbol{\sigma}:\mathbf{D}\,,\label{eq:edy-energy-r2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{r}=\rho_{r}\psi$
\end_inset

 is the free energy density (per volume of the material in the reference
 configuration).
\end_layout

\begin_layout Standard
In our time integration scheme, to satisfy energy balance, this equation
 needs to be evaluated at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

, thus
\begin_inset Formula 
\begin{equation}
\left(\dot{\Psi}_{r}\right)_{n+\alpha_{f}}=J_{n+\alpha_{f}}\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\,.\label{eq:edy-mp-energy}
\end{equation}

\end_inset

However, the solution for 
\begin_inset Formula $\boldsymbol{\sigma}_{n+\alpha_{f}}\equiv\boldsymbol{\sigma}\left(\mathbf{F}_{n+\alpha_{f}}\right)$
\end_inset

 obtained from the momentum balance may not necessarity satisfy this equation.
 Thus, to satisfy energy balance over consecutive time steps, we want to
 evaluate an effective stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}$
\end_inset

 such that
\begin_inset Formula 
\begin{equation}
J_{n+\alpha_{f}}\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}=\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{\Delta t}\,.\label{eq:edy-energy-discretized}
\end{equation}

\end_inset

To find a solution for 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}$
\end_inset

, we follow the procedure of Gonzalez 
\begin_inset CommandInset citation
LatexCommand citep
key "Gonzalez00"
literal "true"

\end_inset

 and let
\begin_inset Formula 
\begin{equation}
\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}+f\mathbf{D}_{n+\alpha_{f}}\,,\label{eq:edy-eff-stress-model}
\end{equation}

\end_inset

where 
\begin_inset Formula $f$
\end_inset

 is some scalar function to be determined.
 Substituting this relation, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-eff-stress-model"

\end_inset

, into the previous equation, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:edy-energy-discretized"

\end_inset

, produces
\begin_inset Formula 
\begin{equation}
f=\left(\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{J_{n+\alpha_{f}}^{s}\Delta t}-\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\right)\frac{1}{\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}}\,.\label{eq:edy-eff-stress-f}
\end{equation}

\end_inset

Hence, the equation for an effective stress needed to satisfy energy balance
 between consecutive time steps is
\begin_inset Formula 
\begin{equation}
\boxed{\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}+\left(\frac{\left(\Psi_{r}\right)_{n+1}-\left(\Psi_{r}\right)_{n}}{J_{n+\alpha_{f}}\Delta t}-\boldsymbol{\sigma}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}\right)\frac{\mathbf{D}_{n+\alpha_{f}}}{\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}}}\,.\label{eq:edy-eff-stress-final}
\end{equation}

\end_inset

In the limit when 
\begin_inset Formula $\mathbf{D}_{n+\alpha_{f}}:\mathbf{D}_{n+\alpha_{f}}=0$
\end_inset

, we use 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{n+\alpha_{f}}=\boldsymbol{\sigma}_{n+\alpha_{f}}$
\end_inset

.
 Recall that this scheme produces conservation of linear and angular momentum
 and total energy only with 
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

, or equivalently, 
\begin_inset Formula $\alpha_{f}=\alpha_{m}=\frac{1}{2}$
\end_inset

, 
\begin_inset Formula $\beta=\frac{1}{2}$
\end_inset

 and 
\begin_inset Formula $\gamma=1$
\end_inset

.
 Therefore, this effective stress calculation is only applied when the user
 employs 
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

.
\end_layout

\begin_layout Section
Rigid Body Dynamics
\end_layout

\begin_layout Subsection
Rigid Body Rotation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Body-Rotation"

\end_inset


\end_layout

\begin_layout Subsubsection
Exponential Map
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exponential-Map"

\end_inset


\end_layout

\begin_layout Standard
Conventionally, the rigid body rotation tensor 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 corresponding to a rotation of angle 
\begin_inset Formula $\chi$
\end_inset

 about the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

 may be expressed in terms of the vector 
\begin_inset Formula $\boldsymbol{\chi}=\chi\mathbf{n}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\cos\chi\,\mathbf{I}-\sin\chi\,\boldsymbol{\mathcal{E}}\cdot\mathbf{n}+\left(1-\cos\chi\right)\mathbf{n}\otimes\mathbf{n}\label{eq:rbr-rotation-tensor}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{E}}$
\end_inset

 is the third-order permutation pseudo-tensor with Cartesian components
 
\begin_inset Formula $\varepsilon_{ijk}$
\end_inset

.
 Making use of the trigonometric identity,
\begin_inset Formula 
\begin{equation}
\cos\chi=1-2\sin^{2}\frac{1}{2}\chi\,,\label{eq:rbr-identity-1}
\end{equation}

\end_inset

this expression may be rearranged as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\mathbf{I}-\frac{\sin\chi}{\chi}\,\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}+\frac{2}{\chi^{2}}\sin^{2}\frac{1}{2}\chi\left(\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\right)^{2}\,,\label{eq:rbr-rotation-tensor-alt-1}
\end{equation}

\end_inset

where we have made use of the identity
\begin_inset Formula 
\begin{equation}
\left(\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\right)^{2}=\boldsymbol{\chi}\otimes\boldsymbol{\chi}-\chi^{2}\mathbf{I}\,.\label{eq:rbr-identity-2}
\end{equation}

\end_inset

Letting
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\chi}}=-\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\chi}\label{eq:rbr-antisymmetric-tensor}
\end{equation}

\end_inset

represent the antisymmetric tensor with axial vector 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)$
\end_inset

 may now be represented as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)\equiv\exp\left[\hat{\boldsymbol{\chi}}\right]=\mathbf{I}+\frac{\sin\chi}{\chi}\hat{\boldsymbol{\chi}}+\frac{2}{\chi^{2}}\sin^{2}\left(\frac{1}{2}\chi\right)\,\hat{\boldsymbol{\chi}}^{2}\,,\label{eq:rbr-rotation-tensor-alt-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\exp\left[\hat{\boldsymbol{\chi}}\right]$
\end_inset

 is known as the
\emph on
 exponential map
\emph default
.
 Thus, the exponential map provides the rotation tensor for a rotation 
\begin_inset Formula $\chi$
\end_inset

 about the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 Note that 
\begin_inset Formula $\boldsymbol{\Lambda}\cdot\boldsymbol{\chi}=\boldsymbol{\chi}$
\end_inset

, since 
\begin_inset Formula $\hat{\boldsymbol{\chi}}\cdot\boldsymbol{\chi}=\boldsymbol{\chi}\times\boldsymbol{\chi}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 be any orthogonal transformation, then
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{Q}\cdot\exp\left[\hat{\boldsymbol{\chi}}\right]\cdot\mathbf{Q}^{T} & =\mathbf{I}+\frac{\sin\chi}{\chi}\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}+\frac{2}{\chi^{2}}\sin^{2}\frac{1}{2}\chi\left(\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}\right)^{2}\\
 & =\exp\left[\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}\right]\equiv\exp\left[\hat{\boldsymbol{\theta}}\right]
\end{aligned}
\label{eq:rbr-orthogonal-transformation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\boldsymbol{\theta}}=\mathbf{Q}\cdot\hat{\boldsymbol{\chi}}\cdot\mathbf{Q}^{T}$
\end_inset

 and its corresponding axial vector is 
\begin_inset Formula $\boldsymbol{\theta}=\mathbf{Q}\cdot\boldsymbol{\chi}$
\end_inset

, implying that 
\begin_inset Formula $\theta=\chi$
\end_inset

.
 This property of the exponential map is used in the next derivation.
\end_layout

\begin_layout Standard
Consider a vector 
\begin_inset Formula $\mathbf{Z}$
\end_inset

 in the reference configuration of a rigid body.
 Upon rigid body rotation, this vector is currently at
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}\,.\label{eq:rbr-rotation-t}
\end{equation}

\end_inset

The corresponding axial vector of 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is 
\begin_inset Formula $\boldsymbol{\chi}\left(t\right)$
\end_inset

.
 At a subsequent time 
\begin_inset Formula $t^{\prime}$
\end_inset

, we would similarly have 
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t^{\prime}\right)=\boldsymbol{\Lambda}\left(t^{\prime}\right)\cdot\mathbf{Z}=\exp\left[\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}\,,\label{eq:rbr-orthogonal-rotation-t-prime}
\end{equation}

\end_inset

where here, 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the incremental (finite) rotation from 
\begin_inset Formula $t$
\end_inset

 to 
\begin_inset Formula $t^{\prime}$
\end_inset

.
 Alternatively, we may choose to write
\begin_inset Formula 
\begin{equation}
\mathbf{z}\left(t^{\prime}\right)=\boldsymbol{\Lambda}\left(t^{\prime}\right)\cdot\mathbf{Z}=\boldsymbol{\Lambda}\left(t\right)\cdot\exp\left[\hat{\boldsymbol{\Theta}}\right]\cdot\mathbf{Z}\,,\label{eq:rbr-incremental-finite-rotation}
\end{equation}

\end_inset

such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\Lambda}\left(t^{\prime}\right) & =\exp\left[\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\left(t\right)\\
 & =\boldsymbol{\Lambda}\left(t\right)\cdot\exp\left[\hat{\boldsymbol{\Theta}}\right]
\end{aligned}
\,,\label{eq:rbr-material-spatial-increments}
\end{equation}

\end_inset

implying that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\exp\left[\hat{\boldsymbol{\theta}}\right] & =\exp\left[\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\boldsymbol{\Theta}}\cdot\boldsymbol{\Lambda}^{T}\left(t\right)\right]\\
\boldsymbol{\theta} & =\boldsymbol{\Lambda}\left(t\right)\cdot\boldsymbol{\Theta}
\end{aligned}
\,.\label{eq:rbr-material-spatial-redux}
\end{equation}

\end_inset

Note from these relations that 
\begin_inset Formula $\theta=\Theta$
\end_inset

.
 Thus, 
\begin_inset Formula $\boldsymbol{\Theta}$
\end_inset

 is the material representation of the incremental rotation from 
\begin_inset Formula $t$
\end_inset

 to 
\begin_inset Formula $t^{\prime}$
\end_inset

, while 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is the corresponding spatial representation.
\end_layout

\begin_layout Subsubsection
Cayley Transform
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cayley-Transform"

\end_inset


\end_layout

\begin_layout Standard
An alternative to the exponential map is the Cayley transform,
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}\left(\boldsymbol{\chi}\right)=\cay\left[\hat{\boldsymbol{\chi}}\right]=\mathbf{I}+\frac{2}{1+\left(\frac{1}{2}\chi\right)^{2}}\left(\frac{1}{2}\hat{\boldsymbol{\chi}}+\frac{1}{4}\hat{\boldsymbol{\chi}}^{2}\right)\label{eq:rbr-Cayley-transform}
\end{equation}

\end_inset

which is a second order approximation to the exponential map.
 This formula is a correction to that appearing in 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"
literal "true"

\end_inset

 (which has 
\begin_inset Formula $\frac{1}{2}\chi^{2}$
\end_inset

 in the denominator).
 According to Puso 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"
literal "true"

\end_inset

, the Cayley transform must be used to enforce conservation of momentum
 and energy in a midpoint rule discretization scheme, whenever the rigid
 body is connected to a deformable body, or whenever two rigid bodies are
 connected by a joint.
 Comparing the above expression to the exponential map 
\begin_inset Formula $\exp\left[\hat{\boldsymbol{\theta}}\right]$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbr-rotation-tensor-alt-2"

\end_inset

, we find that 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 are related via
\begin_inset Formula 
\begin{equation}
\boldsymbol{\chi}=2\tan\frac{\theta}{2}\,\mathbf{n}\,.\label{eq:exponential-Cayley-relation}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization Along Rotational Increment
\begin_inset CommandInset label
LatexCommand label
name "subsec:Linearization-Along-Rotational"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 represent a spatial rotational increment, such that a rotation tensor compounde
d by an infinitesimal incremental rotation is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}_{\varepsilon}=\cay\left[\varepsilon\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\,.\label{eq:rbr-spatial-rotation-increment}
\end{equation}

\end_inset

Using the Cayley transform for illustration, the linearization of 
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 along the increment 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is obtained from
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\boldsymbol{\Lambda}\left[\boldsymbol{\theta}\right] & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}\cay\left[\varepsilon\hat{\boldsymbol{\theta}}\right]\cdot\boldsymbol{\Lambda}\\
 & =\left.\frac{d}{d\varepsilon}\right|_{\varepsilon=0}\left(\mathbf{I}+\frac{2}{1+\frac{1}{4}\varepsilon^{2}\theta^{2}}\left(\frac{1}{2}\varepsilon\hat{\boldsymbol{\theta}}+\frac{1}{4}\varepsilon^{2}\hat{\boldsymbol{\theta}}^{2}\right)\right)\cdot\boldsymbol{\Lambda}\\
 & =\hat{\boldsymbol{\theta}}\cdot\boldsymbol{\Lambda}
\end{aligned}
\,.\label{eq:rbr-spatial-rotation-linearization}
\end{equation}

\end_inset

The same result may be obtained with the exponential map.
 Similarly, using an infinitesimal material rotational increment such that
 
\begin_inset Formula $\boldsymbol{\Lambda}_{\varepsilon}=\boldsymbol{\Lambda}\cdot\cay\left[\varepsilon\hat{\boldsymbol{\Theta}}\right]$
\end_inset

, we may find
\begin_inset Formula 
\begin{equation}
D\boldsymbol{\Lambda}\left[\boldsymbol{\Theta}\right]=\boldsymbol{\Lambda}\cdot\hat{\boldsymbol{\Theta}}\,.\label{eq:rbr-material-rotation-increment}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
General Rigid Body Motion
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Rigid-Body"

\end_inset


\end_layout

\begin_layout Standard
If the point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is connected to a rigid body, its motion is given by
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{r}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}=\mathbf{r}\left(t\right)+\mathbf{z}\left(t\right)\label{eq:rbm-position}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}\left(t\right)$
\end_inset

 is the position of the rigid body center of mass and 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is the body's rotation tensor, which satisfies 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t_{0}\right)=\mathbf{I}$
\end_inset

 at the initial time 
\begin_inset Formula $t_{0}$
\end_inset

; here, 
\begin_inset Formula $\mathbf{z}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{Z}$
\end_inset

 is the distance of the point from the body's center of mass, and 
\begin_inset Formula $\mathbf{X}=\mathbf{r}\left(t_{0}\right)+\mathbf{Z}$
\end_inset

 is the initial position.
 The velocity of that point is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{x}} & =\dot{\mathbf{r}}\left(t\right)+\dot{\boldsymbol{\Lambda}}\left(t\right)\cdot\mathbf{Z}\end{aligned}
\,,\label{eq:rbm-velocity}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\dot{\boldsymbol{\Lambda}}\left(t\right)=\hat{\boldsymbol{\omega}}\left(t\right)\cdot\boldsymbol{\Lambda}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\mathbf{W}}\left(t\right)\,.\label{eq:rbm-lambda-dot}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\hat{\boldsymbol{\omega}}$
\end_inset

 is an antisymmetric tensor with axial vector 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

 which represents the spatial angular velocity vector; similarly, 
\begin_inset Formula $\hat{\mathbf{W}}$
\end_inset

 is an antisymmetric tensor with axial vector 
\begin_inset Formula $\mathbf{W}$
\end_inset

 (the material angular velocity), such that 
\begin_inset Formula $\boldsymbol{\omega}=\boldsymbol{\Lambda}\cdot\mathbf{W}$
\end_inset

 and
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{\omega}}=\boldsymbol{\Lambda}\cdot\hat{\mathbf{W}}\cdot\boldsymbol{\Lambda}^{T}\,.\label{eq:rbm-material-spatial-angular-velocity}
\end{equation}

\end_inset

We may now rewrite
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{x}} & =\dot{\mathbf{r}}\left(t\right)+\hat{\boldsymbol{\omega}}\left(t\right)\cdot\mathbf{z}\left(t\right)\\
 & =\dot{\mathbf{r}}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\hat{\mathbf{W}}\left(t\right)\cdot\mathbf{Z}
\end{aligned}
\,,\label{eq:rbm-rigid-point-velocity}
\end{equation}

\end_inset

so that the acceleration of the point is
\begin_inset Formula 
\begin{equation}
\begin{aligned}\ddot{\mathbf{x}} & =\ddot{\mathbf{r}}\left(t\right)+\left(\hat{\boldsymbol{\alpha}}\left(t\right)+\hat{\boldsymbol{\omega}}^{2}\left(t\right)\right)\cdot\mathbf{z}\\
 & =\ddot{\mathbf{r}}\left(t\right)+\boldsymbol{\Lambda}\left(t\right)\cdot\left(\hat{\mathbf{A}}\left(t\right)+\hat{\mathbf{W}}^{2}\left(t\right)\right)\cdot\mathbf{Z}
\end{aligned}
\,,\label{eq:rbm-rigid-point-acceleration}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\alpha}=\dot{\boldsymbol{\omega}}=\boldsymbol{\Lambda}\cdot\mathbf{A}$
\end_inset

 is the spatial angular acceleration vector, 
\begin_inset Formula $\mathbf{A}=\dot{\mathbf{W}}$
\end_inset

 is the material angular acceleration vector.
 As shown below, the time discretization is performed in the material frame.
\end_layout

\begin_layout Subsection
Rigid Body Momentum Balance
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Body-Momentum"

\end_inset


\end_layout

\begin_layout Standard
For a rigid body, the conservation of linear momentum is given by
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\left(m\dot{\mathbf{r}}\right)=\dot{\mathbf{p}}=\mathbf{f}^{ext}\left(t\right)\label{eq:rbm-linear-momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $m$
\end_inset

 is the mass of the rigid body, 
\begin_inset Formula $\dot{\mathbf{r}}$
\end_inset

 is the velocity of the center of mass, 
\begin_inset Formula $\mathbf{p}=m\dot{\mathbf{r}}$
\end_inset

 is the linear momentum, and 
\begin_inset Formula $\mathbf{f}^{ext}\left(t\right)$
\end_inset

 represents the sum of external forces acting on the body.
 Here, 
\begin_inset Formula $m$
\end_inset

 is constant for a rigid body.
 There are typically four contributions to 
\begin_inset Formula $\mathbf{f}^{ext}\left(t\right)$
\end_inset

: Body forces 
\begin_inset Formula $\mathbf{f}_{b}^{ext}\left(t\right)=m\mathbf{b}\left(t\right)$
\end_inset

 (where 
\begin_inset Formula $\mathbf{b}$
\end_inset

 represents the body force per mass, such as gravitational acceleration),
 other user-prescribed forces 
\begin_inset Formula $\mathbf{f}_{p}^{ext}\left(t\right)$
\end_inset

 (which act at the center of mass), forces 
\begin_inset Formula $\mathbf{f}_{c}^{ext}\left(t\right)$
\end_inset

 produced by rigid body connectors (such as revolute and prismatic joints,
 or contact forces), and forces 
\begin_inset Formula $\mathbf{f}_{f}^{ext}\left(t\right)$
\end_inset

 produced by rigid-flexible connections (where deformable materials interface
 with the rigid body), in which case 
\begin_inset Formula $\mathbf{f}_{f}^{ext}$
\end_inset

 is evaluated from the traction 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

 over that interface, with 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 representing the stress in the deformable material.
\end_layout

\begin_layout Standard
The conservation of angular momentum is similarly given by
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\left(\mathbf{J}\cdot\boldsymbol{\omega}\right)=\dot{\mathbf{h}}=\boldsymbol{\omega}\times\mathbf{h}+\mathbf{J}\cdot\boldsymbol{\alpha}=\mathbf{m}^{ext}\left(t\right)\label{eq:rbm-angular-momentum-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{J}$
\end_inset

 is the rigid body mass moment of inertia about its center of mass, 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

 is its angular velocity, 
\begin_inset Formula $\mathbf{h}=\mathbf{J}\cdot\boldsymbol{\omega}$
\end_inset

 is its angular momentum, 
\begin_inset Formula $\boldsymbol{\alpha}=\dot{\boldsymbol{\omega}}$
\end_inset

 is the rigid body angular acceleration, and 
\begin_inset Formula $\mathbf{m}^{ext}\left(t\right)$
\end_inset

 is the sum of moments acting on the rigid body.
 External moments include contributions from user-prescribed moments/torques
 
\begin_inset Formula $\mathbf{m}_{p}^{ext}\left(t\right)$
\end_inset

, from rigid body connectors, 
\begin_inset Formula $\mathbf{m}_{c}^{ext}\left(t\right)=\mathbf{z}_{c}\left(t\right)\times\mathbf{f}_{c}^{ext}\left(t\right)$
\end_inset

 where 
\begin_inset Formula $\mathbf{z}_{c}\left(t\right)$
\end_inset

 is the connector insertion relative to the rigid body center of mass, and
 rigid-flexible interfaces, 
\begin_inset Formula $\mathbf{m}_{f}^{ext}\left(t\right)=\mathbf{z}_{f}\left(t\right)\times\mathbf{f}_{f}^{ext}\left(t\right)$
\end_inset

 where 
\begin_inset Formula $\mathbf{z}_{f}\left(t\right)$
\end_inset

 is the position of the interface point relative to the rigid body center
 of mass.
 Since body forces 
\begin_inset Formula $\mathbf{f}_{b}^{ext}$
\end_inset

 and user-prescribed forces 
\begin_inset Formula $\mathbf{f}_{p}^{ext}$
\end_inset

 act at the center of mass, they do not contribute to 
\begin_inset Formula $\mathbf{m}^{ext}\left(t\right)$
\end_inset

.
 Note that
\begin_inset Formula 
\begin{equation}
\mathbf{J}\left(t\right)=\boldsymbol{\Lambda}\left(t\right)\cdot\mathbf{J}_{r}\cdot\boldsymbol{\Lambda}^{T}\left(t\right)\,,\label{eq:rbm-moi-rotation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{J}_{r}$
\end_inset

 is the mass moment of inertia about the center of mass in the reference
 configuration and 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 is the rotation tensor representing the orientation of the rigid body at
 time 
\begin_inset Formula $t$
\end_inset

, with 
\begin_inset Formula $\boldsymbol{\Lambda}=\mathbf{I}$
\end_inset

 in the reference configuration.
 
\end_layout

\begin_layout Standard
The virtual work statement is given by
\begin_inset Formula 
\begin{equation}
\delta W=\delta\mathbf{r}\cdot\left(\mathbf{f}^{ext}\left(t\right)-\dot{\mathbf{p}}\right)+\delta\boldsymbol{\theta}\cdot\left(\mathbf{m}^{ext}\left(t\right)-\dot{\mathbf{h}}\right)\,,\label{eq:rbm-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{r}$
\end_inset

 is the virtual velocity of the center of mass and 
\begin_inset Formula $\delta\boldsymbol{\theta}$
\end_inset

 is the virtual angular velocity of the rigid body.
 
\end_layout

\begin_layout Subsection
Time Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Time-Discretization"

\end_inset


\end_layout

\begin_layout Subsubsection
Newmark Integration for Rigid Body Dynamics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Newmark-Integration-RBD"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

 represent consecutive time points.
 According to the Newmark integration scheme, the rigid body center of mass
 velocity and acceleration at 
\begin_inset Formula $t_{n+1}$
\end_inset

 may be expressed in terms of their values at 
\begin_inset Formula $t_{n}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{r}}_{n+1} & =\dot{\mathbf{r}}_{n}+\Delta t\left[\left(1-\gamma\right)\ddot{\mathbf{r}}_{n}+\gamma\ddot{\mathbf{r}}_{n+1}\right]\\
\ddot{\mathbf{r}}_{n+1} & =\frac{1}{\beta\Delta t}\left[\frac{1}{\Delta t}\left(\mathbf{r}_{n+1}-\mathbf{r}_{n}\right)-\dot{\mathbf{r}}_{n}\right]+\left(1-\frac{1}{2\beta}\right)\ddot{\mathbf{r}}_{n}
\end{aligned}
\,,\label{eq:td-Newmark-COM}
\end{equation}

\end_inset

where 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

 are Newmark parameters that satisfy 
\begin_inset Formula $0\le2\beta\le1$
\end_inset

 and 
\begin_inset Formula $0\le\gamma\le1$
\end_inset

.
\end_layout

\begin_layout Standard
Let the rigid body rotation tensor 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)$
\end_inset

 be expressed as 
\begin_inset Formula $\boldsymbol{\Lambda}\left(t\right)=\exp\left[\boldsymbol{\xi}\left(t\right)\right]$
\end_inset

, and 
\begin_inset Formula $\boldsymbol{\xi}\left(t\right)$
\end_inset

 is the material rotation of the rigid body from its reference configuration.
 Thus, 
\begin_inset Formula $\boldsymbol{\Lambda}_{n}=\exp\left[\boldsymbol{\xi}_{n}\right]$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Lambda}_{n+1}=\exp\left[\boldsymbol{\xi}_{n+1}\right]$
\end_inset

 respectively represent the rigid body rotation tensors at 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

.
 (In practice, 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

 is stored as a quaternion to facilitate the multiplication of rotation
 tensors.) These tensors are related by the incremental spatial rotation
 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 or material rotation 
\begin_inset Formula $\boldsymbol{\Theta}$
\end_inset

 from 
\begin_inset Formula $t_{n}$
\end_inset

 to 
\begin_inset Formula $t_{n+1}$
\end_inset

 according to
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}_{n+1}=\cay\left[\boldsymbol{\theta}\right]\cdot\boldsymbol{\Lambda}_{n}=\boldsymbol{\Lambda}_{n}\cdot\cay\left[\boldsymbol{\Theta}\right]\,.\label{eq:td-incremental-rotation}
\end{equation}

\end_inset

Here, it should be understood that the material frame for this incremental
 rotation is the configuration at time 
\begin_inset Formula $t_{n}$
\end_inset

, while the spatial frame is the configuration at 
\begin_inset Formula $t_{n+1}$
\end_inset

.
 For rotational motion, the Newmark scheme is applied in the material frame
 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{W}_{n+1} & =\frac{\gamma}{\beta\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\mathbf{W}_{n}+\frac{\Delta t}{2}\mathbf{A}_{n}\right)\\
\mathbf{A}_{n+1} & =\frac{1}{\gamma\Delta t}\left(\mathbf{W}_{n+1}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{\gamma}\right)\mathbf{A}_{n}\\
 & =\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\Theta}-\mathbf{W}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\mathbf{A}_{n}
\end{aligned}
\,.\label{eq:td-Newmark-mrot}
\end{equation}

\end_inset

Then, using the relations 
\begin_inset Formula $\boldsymbol{\omega}=\boldsymbol{\Lambda}\cdot\mathbf{W}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\alpha}=\boldsymbol{\Lambda}\cdot\mathbf{A}$
\end_inset

 at 
\begin_inset Formula $t_{n}$
\end_inset

 and 
\begin_inset Formula $t_{n+1}$
\end_inset

, along with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:td-incremental-rotation"

\end_inset

, we may express these relations in the spatial frame as
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\omega}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{\gamma}{\beta\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}+\left(2-\frac{\gamma}{\beta}\right)\left(\boldsymbol{\omega}_{n}+\frac{\Delta t}{2}\boldsymbol{\alpha}_{n}\right)\right)\\
\boldsymbol{\alpha}_{n+1} & =\cay\left[\boldsymbol{\theta}\right]\cdot\left(\frac{1}{\beta\Delta t}\left(\frac{1}{\Delta t}\boldsymbol{\theta}-\boldsymbol{\omega}_{n}\right)+\left(1-\frac{1}{2\beta}\right)\boldsymbol{\alpha}_{n}\right)
\end{aligned}
\,.\label{eq:td-Newmark-srot}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In a nonlinear solution scheme we solve for 
\begin_inset Formula $\boldsymbol{\Theta}$
\end_inset

 incrementally.
 According to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbr-material-rotation-increment"

\end_inset

, the linearization of 
\begin_inset Formula $\cay\left[\boldsymbol{\Theta}\right]$
\end_inset

 along an increment 
\begin_inset Formula $\Delta\boldsymbol{\Theta}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
D\left(\cay\left[\boldsymbol{\Theta}\right]\right)\left[\Delta\boldsymbol{\Theta}\right]=\cay\left[\boldsymbol{\Theta}\right]\cdot\widehat{\Delta\boldsymbol{\Theta}}\,,\label{eq:td-linearization-rot}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
D\boldsymbol{\Lambda}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]=\boldsymbol{\Lambda}_{n+1}\cdot\widehat{\Delta\boldsymbol{\Theta}}\,.\label{eq:td-linearization-Lambda}
\end{equation}

\end_inset

The linearizations of 
\begin_inset Formula $\mathbf{W}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}_{n+1}$
\end_inset

, as given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:td-Newmark-mrot"

\end_inset

, along an increment 
\begin_inset Formula $\Delta\boldsymbol{\Theta}$
\end_inset

 requires us to first evaluate 
\begin_inset Formula $D\boldsymbol{\Theta}\left[\Delta\boldsymbol{\Theta}\right]$
\end_inset

.
 According to Puso 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso02"
literal "true"

\end_inset

,
\begin_inset Formula 
\begin{equation}
D\boldsymbol{\Theta}\left[\Delta\boldsymbol{\Theta}\right]=\mathbf{T}\left(\boldsymbol{\Theta}\right)\cdot\Delta\boldsymbol{\Theta}\,,\label{td-Theta-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{T}\left(\boldsymbol{\Theta}\right)=\mathbf{I}+\frac{1}{2}\hat{\boldsymbol{\Theta}}+\frac{1}{4}\boldsymbol{\Theta}\otimes\boldsymbol{\Theta}\,.\label{eq:td-T-Theta-relation}
\end{equation}

\end_inset

Thus,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{W}_{n+1}\left[\Delta\boldsymbol{\Theta}\right] & =\frac{\gamma}{\beta\Delta t}\mathbf{T}\left(\boldsymbol{\Theta}\right)\cdot\Delta\boldsymbol{\Theta}\\
D\mathbf{A}_{n+1}\left[\Delta\boldsymbol{\Theta}\right] & =\frac{1}{\beta\Delta t^{2}}\mathbf{T}\left(\boldsymbol{\Theta}\right)\cdot\Delta\boldsymbol{\Theta}
\end{aligned}
\,.\label{eq:tf-W-A-linearizations}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Generalized-
\begin_inset Formula $\alpha$
\end_inset

 Method for Rigid Body Dynamics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generalized-alpha-RBD"

\end_inset


\end_layout

\begin_layout Standard
In the generalized-
\begin_inset Formula $\alpha$
\end_inset

 method, we evaluate forces and moments at time 
\begin_inset Formula $t_{n+\alpha_{f}}=\left(1-\alpha_{f}\right)t_{n}+\alpha_{f}t_{n+1}$
\end_inset

 and the time rate of change of linear and angular momenta at time 
\begin_inset Formula $t_{n+\alpha_{m}}=\left(1-\alpha_{m}\right)t_{n}+\alpha_{m}t_{n+1}$
\end_inset

, where 
\begin_inset Formula $\alpha_{f}$
\end_inset

 and 
\begin_inset Formula $\alpha_{m}$
\end_inset

 may be evaluated from the spectral radius for an infinite time step, 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generalized-Alpha-Method"

\end_inset

).
 For second-order systems these parameters may be evaluated from 
\begin_inset CommandInset citation
LatexCommand citep
key "Bazilevs2008"
literal "true"

\end_inset


\begin_inset Formula 
\begin{equation}
\alpha_{f}=\frac{1}{1+\rho_{\infty}}\,,\quad\alpha_{m}=\frac{2-\rho_{\infty}}{1+\rho_{\infty}}\,,\label{eq:ga-alphas-2nd}
\end{equation}

\end_inset

Then, the Newmark parameters are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\beta & =\frac{1}{4}\left(1+\alpha_{m}-\alpha_{f}\right)^{2}\,,\\
\gamma & =\frac{1}{2}+\alpha_{m}-\alpha_{f}\,.
\end{aligned}
\label{eq:ga-Newmark-params}
\end{equation}

\end_inset

Accordingly, to solve numerically for 
\begin_inset Formula $\delta W=0$
\end_inset

 over the time domain, we express 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbm-virtual-work"

\end_inset

 in the discretized time domain as
\begin_inset Formula 
\begin{equation}
\delta\mathbf{r}\cdot\left(\mathbf{f}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{p}}_{n+\alpha_{m}}\right)+\delta\boldsymbol{\theta}\cdot\left(\mathbf{m}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{h}}_{n+\alpha_{m}}\right)=0\,,\label{eq:ga-virtual-work}
\end{equation}

\end_inset

or equivalently,
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\delta\mathbf{r} & \delta\boldsymbol{\theta}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{p}}_{n+\alpha_{m}}\\
\mathbf{m}_{n+\alpha_{f}}^{ext}-\dot{\mathbf{h}}_{n+\alpha_{m}}
\end{array}\right]=0\,,\label{eq:ga-virtual-work-alt}
\end{equation}

\end_inset

Thus, the residual vector is given by
\begin_inset Formula 
\begin{equation}
\left[\mathbf{R}\right]=\left[\begin{array}{c}
\mathbf{f}_{n+\alpha_{f}}^{ext}\\
\mathbf{m}_{n+\alpha_{f}}^{ext}
\end{array}\right]-\left[\begin{array}{c}
\dot{\mathbf{p}}_{n+\alpha_{m}}\\
\dot{\mathbf{h}}_{n+\alpha_{m}}
\end{array}\right]\label{eq:ga-residual-vector}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{p}}_{n+\alpha_{m}} & =\left(1-\alpha_{m}\right)\dot{\mathbf{p}}_{n}+\alpha_{m}\dot{\mathbf{p}}_{n+1}\\
\dot{\mathbf{h}}_{n+\alpha_{m}} & =\left(1-\alpha_{m}\right)\dot{\mathbf{h}}_{n}+\alpha_{m}\dot{\mathbf{h}}_{n+1}
\end{aligned}
\,.\label{eq:ga-momenta-interpolation}
\end{equation}

\end_inset

According to the Newmark integration scheme,
\begin_inset Formula 
\begin{equation}
\begin{aligned}\dot{\mathbf{p}}_{n+1} & =\frac{\mathbf{p}_{n+1}-\mathbf{p}_{n}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{\mathbf{p}}_{n}\\
\dot{\mathbf{h}}_{n+1} & =\frac{\mathbf{h}_{n+1}-\mathbf{h}_{n}}{\gamma\Delta t}+\left(1-\frac{1}{\gamma}\right)\dot{\mathbf{h}}_{n}
\end{aligned}
\,,\label{eq:ga-momenta-Newmark}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{p}_{n+1}=m\dot{\mathbf{r}}_{n+1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{h}_{n+1}=\mathbf{J}_{n+1}\cdot\boldsymbol{\omega}_{n+1}$
\end_inset

.
\end_layout

\begin_layout Standard
The nonlinear system 
\begin_inset Formula $\mathbf{R}=\mathbf{0}$
\end_inset

 is solved using a Newton scheme that requires linearizing 
\begin_inset Formula $\mathbf{R}$
\end_inset

 along increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

.
 Thus,
\begin_inset Formula 
\begin{equation}
\mathbf{R}+D\mathbf{R}\left[\Delta\mathbf{r}\right]+D\mathbf{R}\left[\Delta\boldsymbol{\theta}\right]\approx\mathbf{0}\,.\label{eq:ga-Newton-scheme}
\end{equation}

\end_inset

The increments 
\begin_inset Formula $\Delta\mathbf{r}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 are evaluated at 
\begin_inset Formula $t_{n+1}$
\end_inset

 and the iterative Newton scheme requires updates of the form
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{r}_{n+1}^{j+1} & =\mathbf{r}_{n+1}^{j}+\Delta\mathbf{r}\\
\cay\left[\boldsymbol{\theta}^{j+1}\right] & =\cay\left[\Delta\boldsymbol{\theta}\right]\cdot\cay\left[\boldsymbol{\theta}^{j}\right]
\end{aligned}
\,,\label{eq:ga-Newton-iterations}
\end{equation}

\end_inset

where 
\begin_inset Formula $j$
\end_inset

 represents the Newton iteration.
 At each Newton iteration, the current value of 
\begin_inset Formula $\cay\left[\boldsymbol{\theta}^{j+1}\right]$
\end_inset

 is used to perform the update
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Lambda}_{n+1}^{j+1}=\cay\left[\boldsymbol{\theta}^{j+1}\right]\cdot\boldsymbol{\Lambda}_{n}\,,\label{eq:ga-rotation-iterations}
\end{equation}

\end_inset

until convergence is achieved.
\end_layout

\begin_layout Standard
In practice, it is convenient to store 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\Delta\boldsymbol{\theta}$
\end_inset

 in quaternions, recognizing that
\begin_inset Formula 
\[
\cay\left[\theta\mathbf{n}\right]=\exp\left[\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}\right]\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit vector along 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 and 
\begin_inset Formula $\theta=\left\Vert \boldsymbol{\theta}\right\Vert $
\end_inset

.
 Thus, it is 
\begin_inset Formula $\left(2\tan^{-1}\frac{\theta}{2}\right)\mathbf{n}$
\end_inset

 which is stored in the quaternion, instead of 
\begin_inset Formula $\theta\mathbf{n}$
\end_inset

.
\end_layout

\begin_layout Standard
In the linearization of 
\begin_inset Formula $\mathbf{R}$
\end_inset

, the contributions from the rate of change of linear momentum 
\begin_inset Formula $\dot{\mathbf{p}}_{n+\alpha_{m}}$
\end_inset

 reduce to
\begin_inset Formula 
\[
\begin{aligned}D\dot{\mathbf{p}}_{n+\alpha_{m}}\left[\Delta\mathbf{r}\right] & =\frac{\alpha_{m}}{\beta\Delta t^{2}}m\Delta\mathbf{r}\\
D\dot{\mathbf{p}}_{n+\alpha_{m}}\left[\Delta\boldsymbol{\theta}\right] & =\mathbf{0}
\end{aligned}
\,.
\]

\end_inset

To evaluate the contributions from the rate of change of angular momentum
 
\begin_inset Formula $\dot{\mathbf{h}}_{n+\alpha_{m}}$
\end_inset

, we start from 
\begin_inset Formula $D\dot{\mathbf{h}}_{n+\alpha_{m}}=\alpha_{m}D\dot{\mathbf{h}}_{n+1}$
\end_inset

.
 Then, it becomes necessary to transform the variables to the material frame,
\begin_inset Formula 
\[
\begin{aligned}\dot{\mathbf{h}}_{n+1} & =\boldsymbol{\omega}_{n+1}\times\mathbf{h}_{n+1}+\mathbf{J}_{n+1}\cdot\boldsymbol{\alpha}_{n+1}\\
 & =\boldsymbol{\Lambda}_{n+1}\cdot\left(\hat{\mathbf{W}}_{n+1}\cdot\mathbf{J}_{r}\cdot\mathbf{W}_{n+1}+\mathbf{J}_{r}\cdot\mathbf{A}_{n+1}\right)
\end{aligned}
\,.
\]

\end_inset

It follows that
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+\alpha_{m}}\left[\Delta\mathbf{r}\right]=\mathbf{0}\,.
\]

\end_inset

Then, using the relations in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Newmark-Integration-RBD"

\end_inset

, it can be shown that
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+\alpha_{m}}\left[\Delta\boldsymbol{\Theta}\right]=\alpha_{m}\left[\frac{1}{\beta\Delta t}\left(\left(\gamma\hat{\boldsymbol{\omega}}_{n+1}+\frac{1}{\Delta t}\mathbf{I}\right)\cdot\mathbf{J}_{n+1}-\gamma\hat{\mathbf{h}}_{n+1}\right)\cdot\mathbf{T}\left(\boldsymbol{\theta}\right)-\hat{\dot{\mathbf{h}}}_{n+1}\right]\cdot\Delta\boldsymbol{\theta}\equiv\alpha_{m}\mathbf{K}\cdot\Delta\boldsymbol{\theta}\,.
\]

\end_inset

Alternatively, we may use the discretization in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ga-momenta-Newmark"

\end_inset

 to produce
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+\alpha_{m}}\left[\Delta\boldsymbol{\Theta}\right]=\frac{\alpha_{m}}{\gamma\Delta t}D\mathbf{h}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]
\]

\end_inset

where
\begin_inset Formula 
\[
D\mathbf{h}_{n+1}\left[\Delta\boldsymbol{\Theta}\right]=\left(\frac{\gamma}{\beta\Delta t}\mathbf{J}_{n+1}\cdot\mathbf{T}\left(\boldsymbol{\theta}\right)-\hat{\mathbf{h}}_{n+1}\right)\cdot\Delta\boldsymbol{\theta}
\]

\end_inset

so that
\begin_inset Formula 
\[
D\dot{\mathbf{h}}_{n+\alpha_{m}}\left[\Delta\boldsymbol{\Theta}\right]=\frac{\alpha_{m}}{\Delta t}\left(\frac{1}{\beta\Delta t}\mathbf{J}_{n+1}\cdot\mathbf{T}\left(\boldsymbol{\theta}\right)-\frac{1}{\gamma}\hat{\mathbf{h}}_{n+1}\right)\cdot\Delta\boldsymbol{\theta}\equiv\alpha_{m}\mathbf{K}\cdot\Delta\boldsymbol{\theta}
\]

\end_inset

Therefore, the contribution to 
\begin_inset Formula $D\mathbf{R}$
\end_inset

 from the linear and angular momenta produces a stiffness matrix called
 the mass matrix,
\begin_inset Formula 
\[
D\left[\begin{array}{c}
\dot{\mathbf{p}}_{n+\alpha_{m}}\\
\dot{\mathbf{h}}_{n+\alpha_{m}}
\end{array}\right]=\alpha_{m}\left[\begin{array}{cc}
\frac{m}{\beta\Delta t^{2}}\mathbf{I} & \mathbf{0}\\
\mathbf{0} & \mathbf{K}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}\\
\Delta\boldsymbol{\theta}
\end{array}\right]\,.
\]

\end_inset


\end_layout

\begin_layout Standard
Consider that the moments 
\begin_inset Formula $\mathbf{m}_{n+\alpha_{f}}^{ext}$
\end_inset

 about the rigid body center of mass are produced by the forces 
\begin_inset Formula $\mathbf{f}_{n+\alpha_{f}}^{ext}$
\end_inset

 according to
\begin_inset Formula 
\[
\mathbf{m}_{n+\alpha_{f}}^{ext}=\mathbf{z}_{n+\alpha_{f}}\times\mathbf{f}_{n+\alpha_{f}}^{ext}=\hat{\mathbf{z}}_{n+\alpha_{f}}\cdot\mathbf{f}_{n+\alpha_{f}}^{ext}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{z}_{n+\alpha_{f}}$
\end_inset

 is the moment arm at 
\begin_inset Formula $t_{n+\alpha_{f}}$
\end_inset

,
\begin_inset Formula 
\[
\begin{aligned}\mathbf{z}_{n+\alpha_{f}} & =\left(1-\alpha_{f}\right)\mathbf{z}_{n}+\alpha_{f}\mathbf{z}_{n+1}\\
 & =\left[\left(1-\alpha_{f}\right)\boldsymbol{\Lambda}_{n}+\alpha_{f}\boldsymbol{\Lambda}_{n+1}\right]\cdot\mathbf{Z}\\
 & \equiv\boldsymbol{\Lambda}_{n+\alpha_{f}}\cdot\mathbf{Z}
\end{aligned}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{Z}$
\end_inset

 is the moment arm in the reference configuration.
 Note that
\begin_inset Formula 
\[
\begin{aligned}D\mathbf{z}_{n+\alpha_{f}}\left[\Delta\mathbf{r}\right] & =\mathbf{0}\\
D\mathbf{z}_{n+\alpha_{f}}\left[\Delta\boldsymbol{\theta}\right] & =\alpha_{f}D\boldsymbol{\Lambda}_{n+1}\left[\Delta\boldsymbol{\theta}\right]\cdot\mathbf{Z}=-\alpha_{f}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}
\end{aligned}
\]

\end_inset

Thus,
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]\\
D\mathbf{m}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]\\
\mathbf{z}_{n+\alpha_{f}}\times D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\mathbf{r}\right]
\end{array}\right]
\]

\end_inset

and
\begin_inset Formula 
\[
\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
D\mathbf{m}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]
\end{array}\right]=\left[\begin{array}{c}
D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]\\
\mathbf{z}_{n+\alpha_{f}}\times D\mathbf{f}_{n+\alpha_{f}}^{ext}\left[\Delta\boldsymbol{\theta}\right]-\left(\alpha_{f}\hat{\mathbf{z}}_{n+1}\cdot\Delta\boldsymbol{\theta}\right)\times\mathbf{f}_{n+\alpha_{f}}^{ext}
\end{array}\right]\,.
\]

\end_inset


\end_layout

\begin_layout Chapter
Contact and Coupling
\begin_inset CommandInset label
LatexCommand label
name "chap:Contact-and-Coupling"

\end_inset


\end_layout

\begin_layout Standard
FEBio allows the user to connect the different parts of the model in various
 ways.
 Deformable parts can be connected to rigid bodies.
 Deformable objects can be brought in contact with each other.
 Rigid bodies can be connected with rigid joints.
 This chapter describes the different ways to couple parts together.
\end_layout

\begin_layout Section
Sliding Interfaces
\begin_inset CommandInset label
LatexCommand label
name "sec:Sliding-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
This section summarizes the theoretical developments of the two body contact
 problem.
 After introducing some notation and terminology, the contact integral is
 presented, which contains the contribution to the virtual work equation
 from the contact tractions.
 Since the nonlinear contact problem is solved using a Newton based iterative
 method, the contact integral is linearized.
 Next, anticipating a finite element implementation, the contact integral
 and its linearization are discretized using a standard finite element approach.
 Finally the augmented Lagrangian method for enforcing the contact constraints
 is described.
\end_layout

\begin_layout Subsection
Contact Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sliding-Contact-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
For the most part the notation of this section follows 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen02"
literal "true"

\end_inset

, with a few simplifications here and there since the implementation in
 FEBio is currently for quasi-static, frictionless, two body contact problem.
\end_layout

\begin_layout Standard
The volume occupied by body 
\begin_inset Formula $i$
\end_inset

 in the reference configuration is denoted by 
\begin_inset Formula $\Omega^{\left(i\right)}\subset\mathbb{R}^{3}$
\end_inset

where 
\begin_inset Formula $i=1,2$
\end_inset

.
 The boundary of body 
\begin_inset Formula $i$
\end_inset

 is denoted by 
\begin_inset Formula $\Gamma^{\left(i\right)}$
\end_inset

 and is divided into three regions 
\begin_inset Formula $\Gamma^{\left(i\right)}=\Gamma_{\sigma}^{\left(i\right)}\cup\Gamma_{u}^{\left(i\right)}\cup\Gamma_{c}^{\left(i\right)}$
\end_inset

, where 
\begin_inset Formula $\Gamma_{\sigma}^{\left(i\right)}$
\end_inset

 is the boundary where tractions are applied, 
\begin_inset Formula $\Gamma_{u}^{\left(i\right)}$
\end_inset

 the boundary where the solution is prescribed and 
\begin_inset Formula $\Gamma_{c}^{\left(i\right)}$
\end_inset

 the part of the boundary that will be in contact with the other body.
 It is assumed that 
\begin_inset Formula $\Gamma_{\sigma}^{\left(i\right)}\cap\Gamma_{u}^{\left(i\right)}\cap\Gamma_{c}^{\left(i\right)}=\emptyset$
\end_inset

.
\end_layout

\begin_layout Standard
The deformation of body 
\begin_inset Formula $i$
\end_inset

 is defined by 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

.
 The boundary of the deformed body 
\begin_inset Formula $i$
\end_inset

, that is the boundary of 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}\left(\Omega^{\left(i\right)}\right)$
\end_inset

 is denoted by 
\begin_inset Formula $\gamma^{\left(i\right)}=\gamma_{\sigma}^{\left(i\right)}\cup\gamma_{u}^{\left(i\right)}\cup\gamma_{c}^{\left(i\right)}$
\end_inset

 where 
\begin_inset Formula $\gamma_{\sigma}^{\left(i\right)}=\boldsymbol{\varphi}^{\left(i\right)}\left(\Gamma_{\sigma}^{\left(i\right)}\right)$
\end_inset

 is the boundary in the current configuration where the tractions are applied
 and similar definitions for 
\begin_inset Formula $\gamma_{u}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma_{c}^{\left(i\right)}$
\end_inset

.
 See the figure below for a graphical illustration of the defined regions.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigTwoBodyContactProblem.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
The two-body contact problem.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Points in body 1 are denoted by 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 in the reference configuration and 
\series bold

\begin_inset Formula $\mathbf{x}$
\end_inset


\series default
 in the current configuration.
 For body 2 these points are denoted by 
\series bold

\begin_inset Formula $\mathbf{Y}$
\end_inset


\series default
 and 
\series bold

\begin_inset Formula $\mathbf{y}$
\end_inset


\series default
.
 To define contact, the location where the two bodies are in contact with
 each other must be established.
 If body 1 is the 
\emph on
slave body
\emph default
 and body 2 is the 
\emph on
master body
\emph default
, then for a given point 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
 on the slave reference contact surface there is a point 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

 on the master contact surface that is in some sense closest to point 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset


\series default
.
 This closest point is defined in a closest point projection sense: 
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{Y}}\left(\mathbf{X}\right)=\arg\min\limits _{\mathbf{Y}\in\Gamma_{c}^{\left(2\right)}}\left\Vert \boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{Y}\right)\right\Vert \,.\label{eq564}
\end{equation}

\end_inset

With the definition of 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

 established the 
\emph on
gap function
\emph default
 can be defined, which is a measure for the distance between 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset

 
\series default
and 
\begin_inset Formula $\mathbf{\bar{Y}}\left(\mathbf{X}\right)$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
g\left(\mathbf{X}\right)=-\boldsymbol{\nu}\cdot\left(\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right)\,,\label{eq565}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

 is the local surface normal of surface 
\begin_inset Formula $\gamma_{c}^{\left(2\right)}$
\end_inset

 evaluated at 
\begin_inset Formula $\mathbf{\bar{y}}=\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)$
\end_inset

.
 Note that 
\begin_inset Formula $g>0$
\end_inset

 when 
\series bold

\begin_inset Formula $\mathbf{X}$
\end_inset

 
\series default
has penetrated body 2, so that the constraint condition to be satisfied
 at all time is 
\begin_inset Formula $g\leqslant0$
\end_inset

.
\end_layout

\begin_layout Subsection
Weak Form of Two Body Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:Weak-Form-Two-Body"

\end_inset


\end_layout

\begin_layout Standard
The balance of linear momentum can be written for each of the two bodies
 in the reference configuration, 
\begin_inset Formula 
\begin{equation}
G^{\left(i\right)}\left(\boldsymbol{\varphi}^{\left(i\right)},\mathbf{w}^{\left(i\right)}\right)=\int\limits _{\Omega^{\left(i\right)}}\Grad\mathbf{w}^{\left(i\right)}:\mathbf{P}^{\left(i\right)}\,d\Omega-\int\limits _{\Omega^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{F}^{\left(i\right)}\,d\Omega-\int\limits _{\Gamma_{s}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma-\int\limits _{\Gamma_{c}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma=0\,,\label{eq566}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}$
\end_inset

 is a weighting function and 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset


\series default
 is the 
\begin_inset Formula $1^{\text{st}}$
\end_inset

 Piola-Kirchhoff stress tensor.
 The last term corresponds to the virtual work of the contact tractions
 on body 
\begin_inset Formula $i$
\end_inset

.
 For notational convenience, the notations 
\begin_inset Formula $\varphi$
\end_inset

and 
\begin_inset Formula $w$
\end_inset

 are introduced to denote the collection of the respective mappings 
\begin_inset Formula $\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}$
\end_inset

 (for 
\begin_inset Formula $i=$
\end_inset

1,2).
 In other words, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\varphi & :\bar{\Omega}^{\left(1\right)}\cup\bar{\Omega}^{\left(2\right)}\to\mathbb{R}^{3}\,,\\
w & :\bar{\Omega}^{\left(1\right)}\cup\bar{\Omega}^{\left(2\right)}\to\mathbb{R}^{3}\,.
\end{aligned}
\label{eq567}
\end{equation}

\end_inset

The variational principle for the two body system is the sum of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq566"

\end_inset

 for body 1 and 2 and can be expressed as, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}G\left(\boldsymbol{\varphi},\mathbf{w}\right) & :=\sum\limits _{i=1}^{2}G^{\left(i\right)}\left(\boldsymbol{\varphi}^{\left(i\right)},\mathbf{w}^{\left(i\right)}\right)\\
 & =\underbrace{\sum\limits _{i=1}^{2}\left\{ \int\limits _{\Omega^{\left(i\right)}}\Grad\mathbf{w}^{\left(i\right)}:\mathbf{P}^{\left(i\right)}\,d\Omega-\int\limits _{\Omega^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{F}^{\left(i\right)}\,d\Omega-\int\limits _{\Gamma_{s}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma\right\} }_{G^{\text{int},\text{ext}}\left(\boldsymbol{\varphi},\mathbf{w}\right)}\\
 & \underbrace{-\sum\limits _{i=1}^{2}\int\limits _{\Gamma_{c}^{\left(i\right)}}\mathbf{w}^{\left(i\right)}\cdot\mathbf{T}^{\left(i\right)}\,d\Gamma}_{G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)}\,.
\end{aligned}
\label{eq568}
\end{equation}

\end_inset

Or in short, 
\begin_inset Formula 
\begin{equation}
G\left(\boldsymbol{\varphi},\mathbf{w}\right)=G^{\text{int},\text{ext}}\left(\boldsymbol{\varphi},\mathbf{w}\right)+G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\,.\label{eq569}
\end{equation}

\end_inset

Note that the minus sign is included in the definition of the contact integral
 
\begin_inset Formula $G^{c}$
\end_inset

.
 The contact integral can be written as an integration over the contact
 surface of body 1 by balancing linear momentum across the contact surface:
 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)d\Gamma^{\left(2\right)}=-\mathbf{t}^{\left(1\right)}\left(\mathbf{x}\right)\,d\Gamma^{\left(1\right)}\,.\label{eq570}
\end{equation}

\end_inset

The contact integral can now be rewritten over the contact surface of body
 1: 
\begin_inset Formula 
\begin{equation}
G^{c}=-\int\limits _{\Gamma_{c}^{\left(1\right)}}\mathbf{t}^{\left(1\right)}\left(\mathbf{x}\right)\cdot\left[\mathbf{w}^{\left(1\right)}\left(\mathbf{x}\right)-\mathbf{w}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)\right]\,d\Gamma\,.\label{eq571}
\end{equation}

\end_inset

In the case of frictionless contact, the contact traction is taken as perpendicu
lar to surface 2 and therefore can be written as, 
\begin_inset Formula $\mathbf{t}^{\left(1\right)}=t_{N}\boldsymbol{\nu}$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\nu}$
\end_inset

 is the (outward) surface normal and 
\begin_inset Formula $t_{N}$
\end_inset

 is to be determined from the solution strategy.
 For example in a Lagrange multiplier method the 
\begin_inset Formula $t_{N}$
\end_inset

's would be the Lagrange multipliers.
\end_layout

\begin_layout Standard
By noting that the variation of the gap function is given by 
\begin_inset Formula 
\begin{equation}
\delta g=-\boldsymbol{\nu}\cdot\left(\mathbf{w}^{\left(1\right)}\left(\mathbf{x}\right)-\mathbf{w}^{\left(2\right)}\left(\mathbf{\bar{y}}\left(\mathbf{x}\right)\right)\right)\,,\label{eq572}
\end{equation}

\end_inset

equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq571"

\end_inset

 can be simplified as, 
\begin_inset Formula 
\begin{equation}
G^{c}=\int\limits _{\Gamma_{c}^{\left(1\right)}}t_{N}\delta g\,d\Gamma\,.\label{eq573}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Linearization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Linearization-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
In a Newton-Raphson implementation the contact integral must be linearized
 with respect to the current configuration: 
\begin_inset Formula 
\begin{equation}
\Delta G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\int\limits _{\Gamma_{c}^{\left(1\right)}}\Delta\left(t_{N}\delta g\right)\,d\Gamma\,.\label{eq574}
\end{equation}

\end_inset

Examining the normal contact term first, the directional derivative of 
\begin_inset Formula $t_{N}$
\end_inset

 is given (for the case of the penalty regularization) by: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta t_{N} & =\Delta\left\{ \varepsilon_{N}\left\langle g\right\rangle \right\} \\
 & =H\left(g\right)\varepsilon_{N}\Delta g
\end{aligned}
\,,\label{eq575}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 is the penalty factor and 
\begin_inset Formula $H\left(g\right)$
\end_inset

 is the Heaviside function.
 The quantity 
\begin_inset Formula $\Delta\left(\delta g\right)$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta\left(\delta g\right) & =g\left[\boldsymbol{\nu}\cdot\delta\varphi_{,\gamma}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)+\kappa_{\alpha\gamma}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\delta\bar{\xi}_{\alpha}\right]m^{\gamma\beta}\\
 & \left[\boldsymbol{\nu}\cdot\Delta\varphi_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)+\kappa_{\alpha\beta}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\Delta\bar{\xi}^{\alpha}\right]\\
 & +\delta\bar{\xi}^{\beta}\boldsymbol{\nu}\cdot\left[\Delta\varphi_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right]+\Delta\bar{\xi}^{\beta}\boldsymbol{\nu}\cdot\left[\delta\boldsymbol{\varphi}_{,\beta}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\right]\\
 & +\kappa_{\alpha\beta}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\delta\bar{\xi}^{\beta}\Delta\bar{\xi}^{\alpha}\,.
\end{aligned}
\label{eq576}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Discretization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discretization-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
The contact integral, which is repeated here, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\int\limits _{\Gamma^{\left(1\right)}}t_{N}\delta g\,d\Gamma\,,\label{eq577}
\end{equation}

\end_inset

will now be discretized using a standard finite element procedure.
 First it is noted that the integration can be written as a sum over the
 surface element areas: 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\sum\limits _{e=1}^{N_{sel}}\int\limits _{\Gamma^{\left(1\right)e}}t_{N}\delta g\,d\Gamma\,,\label{eq578}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{sel}$
\end_inset

 is the number of surface elements.
 The integration can be approximated using a quadrature rule, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\cong\sum\limits _{e=1}^{N_{sel}}\left\{ \sum\limits _{i=1}^{N_{int}^{e}}w^{i}j\left(\boldsymbol{\xi}_{i}\right)t_{N}\left(\boldsymbol{\xi}_{i}\right)\delta g\left(\boldsymbol{\xi}_{i}\right)\right\} \,,\label{eq579}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{int}^{e}$
\end_inset

 are the number of integration points for element 
\begin_inset Formula $e$
\end_inset

.
 It is now assumed that the integration points coincide with the element's
 nodes (e.g.
 for a quadrilateral surface element we have 
\begin_inset Formula $\boldsymbol{\xi}_{1}=\left(-1,-1\right)$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\xi}_{2}=\left(1,-1\right)$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\xi}_{3}=\left(1,1\right)$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\xi}_{4}=\left(-1,1\right))$
\end_inset

.
 With this quadrature rule, we have 
\begin_inset Formula 
\begin{equation}
\begin{aligned}w^{\left(1\right)}\left(\boldsymbol{\xi}_{i}\right) & =\mathbf{c}_{i}^{\left(1\right)}\\
w^{\left(2\right)}\left(\bar{\boldsymbol{\xi}}_{i}\right) & =\sum\limits _{j=1}^{n}N_{j}\left(\bar{\boldsymbol{\xi}}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}
\end{aligned}
\,,\label{eq580}
\end{equation}

\end_inset

so that, 
\begin_inset Formula 
\begin{equation}
\delta g\left(\boldsymbol{\xi}_{i}\right)=-\boldsymbol{\nu}\cdot\left(\mathbf{c}_{i}^{\left(1\right)}-\sum\limits _{j=1}^{n}N_{j}^{\left(2\right)}\left(\bar{\boldsymbol{\xi}}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\right)\,.\label{eq581}
\end{equation}

\end_inset

If the following vectors are defined, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\boldsymbol{\Phi}^{T} & =\left[\begin{array}{cccc}
\mathbf{c}_{i}^{\left(1\right)} & \mathbf{c}_{1}^{\left(2\right)} & \cdots & \mathbf{c}_{n}^{\left(2\right)}\end{array}\right]\\
\mathbf{N}^{T} & =\left[\begin{array}{cccc}
\boldsymbol{\nu} & -\boldsymbol{\nu}N_{1}^{\left(2\right)} & \cdots & -\boldsymbol{\nu}N_{n}^{\left(2\right)}\end{array}\right]
\end{aligned}
\,,\label{eq582}
\end{equation}

\end_inset

equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq579"

\end_inset

 can then be rewritten as follows, 
\begin_inset Formula 
\begin{equation}
G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)\cong\sum\limits _{e=1}^{N_{sel}}\left\{ \sum\limits _{i=1}^{N_{int}^{e}}w^{i}j\left(\boldsymbol{\xi}_{i}\right)t_{N}\left(\boldsymbol{\xi}_{i}\right)\delta\boldsymbol{\Phi}^{T}\mathbf{N}^{T}\right\} \,.\label{eq583}
\end{equation}

\end_inset

The specific form for 
\begin_inset Formula $t_{N}$
\end_inset

will depend on the method employed for enforcing the contact constraint.
\end_layout

\begin_layout Subsection
Discretization of the Contact Stiffness
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discretization-Contact-Stiffness"

\end_inset


\end_layout

\begin_layout Standard
A similar procedure can now be used to calculate the discretized contact
 stiffness matrix.
 The linearization of the contact integral is repeated here: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\Delta G^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right) & =\sum\limits _{e=1}^{N_{sel}}\int\limits _{\Gamma^{\left(1\right)e}}\Delta\left(t_{N}\delta g\right)\,d\Gamma\\
 & =\sum\limits _{e=1}^{N_{sel}}\sum\limits _{i=1}^{N_{int}^{e}}w_{i}j\left(\boldsymbol{\xi}_{i}\right)\Delta\left(t_{N}\delta g\right)\left(\boldsymbol{\xi}_{i}\right)
\end{aligned}
\,.\label{eq584}
\end{equation}

\end_inset

Using matrix notation we can rewrite equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq584"

\end_inset

 as, 
\begin_inset Formula 
\begin{equation}
\Delta W^{c}\left(\boldsymbol{\varphi},\mathbf{w}\right)=\sum\limits _{e=1}^{N_{sel}}\sum\limits _{i}^{N_{int}^{e}}w_{i}j\left(\mathbf{\xi}_{i}\right)\delta\boldsymbol{\Phi}\cdot\mathbf{k}^{c}\Delta\boldsymbol{\Phi}\,,\label{eq585}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\boldsymbol{\Phi}$
\end_inset

 is as above and 
\begin_inset Formula $\Delta\boldsymbol{\Phi}$
\end_inset

 similar to 
\begin_inset Formula $\delta\boldsymbol{\Phi}$
\end_inset

 with 
\begin_inset Formula $\delta$
\end_inset

 replaced with 
\begin_inset Formula $\Delta$
\end_inset

, and 
\begin_inset Formula $\mathbf{k}^{c}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}^{c} & =\varepsilon_{N}H\left(\lambda_{N}^{k}+\varepsilon_{N}g\right)\mathbf{NN}^{T}+t_{N}\left\{ g\left[m^{11}\mathbf{\bar{N}}_{1}\mathbf{\bar{N}}_{1}^{T}\right.\right.\\
 & +m^{12}\left(\mathbf{\bar{N}}_{1}\mathbf{\bar{N}}_{2}^{T}+\mathbf{\bar{N}}_{2}\mathbf{\bar{N}}_{1}^{T}\right)+\left.m^{22}\mathbf{\bar{N}}_{2}\mathbf{\bar{N}}_{2}^{T}\right]-\mathbf{D}_{1}\mathbf{N}_{1}^{T}\\
 & -\mathbf{D}_{2}\mathbf{N}_{2}^{T}-\mathbf{N}_{1}\mathbf{D}_{1}^{T}-\mathbf{N}_{2}\mathbf{D}_{2}^{T}+\left.\kappa_{12}\left(\mathbf{D}_{1}\mathbf{D}_{2}^{T}+\mathbf{D}_{2}\mathbf{D}_{1}^{T}\right)\right\} 
\end{aligned}
\,,\label{eq586}
\end{equation}

\end_inset

where, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}= & \left[\begin{array}{c}
\boldsymbol{\nu}\\
-N_{1}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}\\
\vdots\\
-N_{4}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}
\end{array}\right]\,, & \mathbf{T}_{\alpha} & =\left[\begin{array}{c}
\boldsymbol{\tau}_{\alpha}\\
-N_{1}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\tau}_{\alpha}\\
\vdots\\
-N_{4}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\tau}_{\alpha}
\end{array}\right]\,, & \mathbf{N}_{\alpha} & =\left[\begin{array}{c}
\mathbf{0}\\
-N_{1,\alpha}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}\\
\vdots\\
-N_{4,\alpha}\left(\bar{\boldsymbol{\xi}}\right)\boldsymbol{\nu}
\end{array}\right]\,.\end{aligned}
\label{eq587}
\end{equation}

\end_inset

The following vectors are also defined which depend on the vectors of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq587"

\end_inset

: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{D}_{1} & =\frac{1}{\det\mathbf{A}}\left[A_{22}\left(\mathbf{T}_{1}+g\mathbf{N}_{1}\right)-A_{12}\left(\mathbf{T}_{2}+g\mathbf{N}_{2}\right)\right]\\
\mathbf{D}_{2} & =\frac{1}{\det\mathbf{A}}\left[A_{11}\left(\mathbf{T}_{2}+g\mathbf{N}_{2}\right)-A_{12}\left(\mathbf{T}_{1}+g\mathbf{N}_{1}\right)\right]\\
\mathbf{\bar{N}}_{1} & =\mathbf{N}_{1}-\kappa_{12}\mathbf{D}_{2}\\
\mathbf{\bar{N}}_{2} & =\mathbf{N}_{2}-\kappa_{12}\mathbf{D}_{1}
\end{aligned}
\,,\label{eq588}
\end{equation}

\end_inset

where the matrix 
\series bold

\begin_inset Formula $\mathbf{A}$
\end_inset


\series default
 is defined as, 
\begin_inset Formula 
\begin{equation}
A_{ij}=m_{ij}+g\kappa_{ij}\,.\label{eq589}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $m_{ij}=\boldsymbol{\tau}_{i}\cdot\boldsymbol{\tau}_{j}$
\end_inset

 is the surface metric tensor and 
\begin_inset Formula $\kappa_{ij}=\boldsymbol{\nu}\cdot\boldsymbol{\varphi}_{t,ij}^{\left(2\right)}\left(\mathbf{\bar{Y}}\right)$
\end_inset

 denotes the components of the surface curvature at 
\begin_inset Formula $\bar{\boldsymbol{\xi}}$
\end_inset

.
\end_layout

\begin_layout Subsection
Augmented Lagrangian Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Augmented-Lagrangian-Method"

\end_inset


\end_layout

\begin_layout Standard
The augmented Lagrangian method is used in FEBio to enforce the contact
 constraints to a user-specified tolerance.
 This implies that the normal contact tractions are given by, 
\begin_inset Formula 
\begin{equation}
t_{N}=\left\langle \lambda_{N}+\varepsilon_{N}g\right\rangle \,.\label{eq590}
\end{equation}

\end_inset

Note that this assumption is consistent with the approach that was used
 in establishing the discretization of the linearization of the contact
 integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq586"

\end_inset

.
 In 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq590"

\end_inset

 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 is a penalty factor that is chosen arbitrarily.
\end_layout

\begin_layout Standard
The Newton-Raphson iterative method is now used to solve the nonlinear contact
 problem where Uzawa's method (REF) is employed to calculate the Lagrange
 multipliers 
\begin_inset Formula $\lambda_{N}$
\end_inset

.
 This implies that the Lagrange multipliers are kept fixed during the Newton-Rap
hson iterations.
 After convergence the multipliers are updated and a new NR procedure is
 started.
 This procedure can be summarized by the following four steps.
\end_layout

\begin_layout Enumerate

\series bold
Initialize 
\series default
the augmented Lagrangian iteration counter 
\begin_inset Formula $k$
\end_inset

, and the initial guesses for the multipliers: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{N_{n+1}}^{\left(0\right)} & =\lambda_{N_{n}}\,,\\
k & =0\,.
\end{aligned}
\label{eq591}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Solve
\series default
 for 
\begin_inset Formula $\mathbf{d}_{n+1}^{\left(k\right)}$
\end_inset

, the solution vector corresponding to the fixed 
\begin_inset Formula $k$
\end_inset

th iterate for the multipliers, 
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{int}\left(\mathbf{d}_{n+1}^{\left(k\right)}\right)+\mathbf{F}^{c}\left(\mathbf{d}_{n+1}^{\left(k\right)}\right)=\mathbf{F}_{n+1}^{ext}\,,\label{eq592}
\end{equation}

\end_inset

where the contact tractions used to compute 
\begin_inset Formula $\mathbf{F}^{c}$
\end_inset

, the contact force, are governed by 
\begin_inset Formula 
\begin{equation}
t_{N_{n+1}}^{\left(k\right)}=\left\langle \lambda_{N_{n+1}}^{\left(k\right)}+\varepsilon_{N}g_{n+1}^{k}\right\rangle \,.\label{eq593}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Update
\series default
 the Lagrange multipliers and iteration counters: 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{N_{n+1}}^{\left(k+1\right)} & =\left\langle \lambda_{N_{n+1}}^{\left(k\right)}+\varepsilon_{N}g_{n+1}^{\left(k\right)}\right\rangle \,,\\
k & =k+1\,.
\end{aligned}
\label{eq594}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate

\series bold
Return
\series default
 to the solution phase.
 
\end_layout

\begin_layout Standard
Steps 2-4 of the above algorithm are generally repeated until all contact
 constraints are satisfied to a user-specified tolerance or little change
 in the solution vector from augmentation to augmentation is noted.
\end_layout

\begin_layout Subsection
Automatic Penalty Calculation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Automatic-Penalty-Calculation"

\end_inset


\end_layout

\begin_layout Standard
The determination of the penalty factor 
\begin_inset Formula $\varepsilon_{N}$
\end_inset

 can be a difficult task, since a good value may depend on both material
 parameters and geometrical factors.
 In FEBio the value of this penalty factor can be determined automatically.
 In this case FEBio will calculate a penalty factor for each facet using
 the following formula.
 
\begin_inset Formula 
\begin{equation}
\varepsilon_{i}=\frac{f_{SI}E_{i}A_{i}}{V_{i}}\,.\label{eq595}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $E_{i}$
\end_inset

 is the effective Young's modulus along the facet normal, 
\begin_inset Formula $A_{i}$
\end_inset

 the surface area of the facet, 
\begin_inset Formula $V_{i}$
\end_inset

 the volume of the element to which this facet belongs and 
\begin_inset Formula $f_{SI}$
\end_inset

 a user defined scale factor.
 The parameter 
\begin_inset Formula $E_{i}$
\end_inset

 is evaluated from the elasticity tensor 
\begin_inset Formula $\boldsymbol{\mathcal{C}}$
\end_inset

 and the facet unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\frac{1}{E_{i}}=\left(\mathbf{n}\otimes\mathbf{n}\right):\boldsymbol{\mathcal{C}}^{-1}:\left(\mathbf{n}\otimes\mathbf{n}\right)\,,\label{eq596}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{C}}^{-1}$
\end_inset

 is the compliance tensor.
\end_layout

\begin_layout Subsection
Facet-To-Facet Sliding
\begin_inset CommandInset label
LatexCommand label
name "subsec:Alternative-Formulations"

\end_inset


\end_layout

\begin_layout Standard
As of FEBio version 1.2, two alternative formulations for sliding contact
 are available.
 The first method, which is referred to as the 
\emph on
facet-to-facet sliding
\emph default
, is very similar to the formulation described above.
 It only differs in that it uses a Gaussian quadrature rule instead of nodal
 integration.
 Because of the more accurate integration rule, it was noted that this method
 in many situations was more stable and resulted in better convergence.
\end_layout

\begin_layout Subsection
Sliding-Elastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sliding-Elastic"

\end_inset


\end_layout

\begin_layout Standard
This algorithm was presented in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

 and differs considerably from the previous two.
 Consider a domain 
\begin_inset Formula $b$
\end_inset

 consisting of two bodies 
\begin_inset Formula $b^{(1)}$
\end_inset

 and 
\begin_inset Formula $b^{(2)}$
\end_inset

 with respective boundaries 
\begin_inset Formula $\partial b^{(1)}$
\end_inset

 and 
\begin_inset Formula $\partial b^{(2)}$
\end_inset

.
 The two bodies are in contact over portions of
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $\partial b^{(1)}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 and 
\begin_inset Formula $\partial b^{(2)}$
\end_inset

, respectively denoted 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

.
 The contribution of contact to the external virtual work may be written
 as
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum_{i=1}^{2}\intop_{\gamma^{(i)}}\delta\mathbf{v}^{(i)}\cdot\mathbf{t}^{(i)}\,da^{(i)}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 is a virtual velocity, 
\begin_inset Formula $\mathbf{t}^{(i)}$
\end_inset

 represents the traction on 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

, and 
\begin_inset Formula $da^{(i)}$
\end_inset

 is an elemental area of 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

.
 In contact analyses, the tractions on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

 are equal and opposite, 
\begin_inset Formula $\mathbf{t}^{(1)}=-\mathbf{t}^{(2)}$
\end_inset

, and the contact surfaces are shared, hence we may select one surface to
 perform the integration over.
 The virtual work arising from contact may be written as an integral over
 the primary surface 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 only, yielding
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\intop_{\gamma^{(1)}}\left(\delta\mathbf{v}^{(1)}-\delta\mathbf{v}^{(2)}\right)\cdot\mathbf{t}^{(1)}\,da^{(1)}\label{eq:contact_int}
\end{equation}

\end_inset

eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact_int"

\end_inset

 is commonly referred to as the contact integral.
\end_layout

\begin_layout Standard
To evaluate the directional derivatives of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 along increments in the displacements 
\begin_inset Formula $\Delta\mathbf{u}^{(i)}$
\end_inset

 of 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, as required for an iterative technique such as Newton's method, it is
 necessary to formulate the integration over an invariant domain so that
 the directional derivative may be brought inside the integral without concern
 for variations in the domain of integration.
 In our approach the integral is formulated over the invariant parametric
 space of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b,Bonet97"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
Each surface 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

 is expressed in parametric form using coordinates 
\begin_inset Formula $\eta_{(i)}^{\alpha}$
\end_inset

, and material points 
\begin_inset Formula $X^{(i)}$
\end_inset

 are identified through their parametric coordinates.
 On each surface 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

, covariant basis vectors are given by
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{(i)}=\frac{\partial\mathbf{x}^{(i)}}{\partial\eta_{(i)}^{\alpha}}\,.\label{eq:basis_vectors}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{x}^{(i)}\left(\eta_{(i)}^{\alpha},t\right)$
\end_inset

 is the spatial representation of surface 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

 as it deforms over time 
\begin_inset Formula $t$
\end_inset

, in terms of contravariant surface parametric coordinates 
\begin_inset Formula $\eta_{(i)}^{\alpha}$
\end_inset

.
 These covariant basis vectors are tangent to 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

, and it follows that the unit outward normal to 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{(i)}=\frac{\mathbf{g}_{1}^{(i)}\times\mathbf{g}_{2}^{(i)}}{\left|\mathbf{g}_{1}^{(i)}\times\mathbf{g}_{2}^{(i)}\right|}\,.\label{eq:n}
\end{equation}

\end_inset

Furthermore, the elemental area on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

 is evaluated as
\begin_inset Formula 
\begin{equation}
\begin{aligned}da^{(i)} & =J_{\eta}^{(i)}\,d\eta_{(i)}^{1}d\eta_{(i)}^{2}\,, & J_{\eta}^{(i)} & =\left|\mathbf{g}_{1}^{(i)}\times\mathbf{g}_{2}^{(i)}\right|\,.\end{aligned}
\label{eq:da_jeta}
\end{equation}

\end_inset

Therefore the contact integral of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact_int"

\end_inset

 may be placed into matrix form and rewritten as
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\mathbf{t}^{(1)}\\
-\mathbf{t}^{(1)}
\end{bmatrix}\,J_{\eta}^{(1)}\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}\,,\label{eq:contact-int-invariant}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Gamma_{\eta}^{(1)}$
\end_inset

 represents the invariant parametric space of surface 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and integration is performed over points 
\begin_inset Formula $X^{(1)}$
\end_inset

 with prescribed parametric coordinates 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

.
 Since 
\begin_inset Formula $\Gamma_{\eta}^{(1)}$
\end_inset

 represents a material frame, it is possible to linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

 by applying the directional derivative operator directly to the integrand,
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\int_{\Gamma_{\eta}^{(1)}}D\left(\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\mathbf{t}^{(1)}\\
-\mathbf{t}^{(1)}
\end{bmatrix}\,J_{\eta}^{(1)}\right)d\eta_{(1)}^{1}d\eta_{(1)}^{2}\,,\label{eq:dgc}
\end{equation}

\end_inset

where it is understood that for any function 
\begin_inset Formula $f$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
Df\equiv\sum_{i=1}^{2}Df\left[\Delta\mathbf{u}^{(i)}\right]\,.
\end{equation}

\end_inset

To proceed with this linearization, it is necessary to formulate the kinematics
 of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

 and provide expressions for the contact traction 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 that can differentiate between frictional stick and slip.
\end_layout

\begin_layout Subsubsection
Slip Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Slip-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
During contact slip, 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 move relative to one another as their configurations evolve.
 Performing a contact analysis requires mapping points between these surfaces.
 For the spatial position 
\begin_inset Formula $\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)$
\end_inset

 of each material point on the primary surface, we define the intersection
 point 
\begin_inset Formula $\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)$
\end_inset

 on the secondary surface as the point intersected by a ray directed along
 the unit outward normal to the primary surface 
\begin_inset Formula $\mathbf{n}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{(2)}=\mathbf{x}^{(1)}+g\mathbf{n}^{(1)},\label{eq:slip_x2}
\end{equation}

\end_inset

where the gap function 
\begin_inset Formula $g$
\end_inset

 is defined to be positive when the surfaces 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 are separated, and negative when they penetrate,
\begin_inset Formula 
\begin{equation}
g=\left(\mathbf{x}^{(2)}-\mathbf{x}^{(1)}\right)\cdot\mathbf{n}^{(1)}.\label{eq:slip_gap}
\end{equation}

\end_inset

The ray intersects 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 at a spatial position 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 through which different material points 
\begin_inset Formula $X^{(2)}$
\end_inset

 identified by parametric coordinates 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 may convect.
 Computationally, this ray intersection and contact detection is performed
 with an Octree method 
\begin_inset CommandInset citation
LatexCommand citep
key "Foley96"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The projection approach of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"

\end_inset

, described in our previous study 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

 and commonly termed 
\emph on
ray-tracing
\emph default
 
\begin_inset CommandInset citation
LatexCommand citep
key "Poulios15"
literal "true"

\end_inset

, can be characterized as an inverse projection relative to the classical
 contact mechanics approach used for NTS contact 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen02,Wriggers06"
literal "true"

\end_inset

.
 Although the definition of this projection and its associated gap function
 is not new, it has typically been employed mostly for mortar contact (e.g.
 as in Tur et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Tur09"
literal "true"

\end_inset

).
 The benefits associated with a projection method such as eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"

\end_inset

 for non-mortar contact have been developed in detail 
\begin_inset CommandInset citation
LatexCommand citep
key "Poulios15"
literal "true"

\end_inset

.
 Here it suffices to note that avoiding a reliance on secondary surface
 normal vectors eliminates many contact-searching difficulties that plague
 NTS algorithms 
\begin_inset CommandInset citation
LatexCommand citep
key "Zavarise09"
literal "true"

\end_inset

, and also serves to greatly reduce the complexity of the linearizations
 and the resulting stiffness matrices.
 
\end_layout

\begin_layout Subsubsection
Stick Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Stick-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_gap"

\end_inset

 describe searching for evolving contact and are only valid during slip.
 In stick no relative motion occurs between contacting points, thus the
 intersection point 
\begin_inset Formula $X^{\left(2\right)}$
\end_inset

 on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 does not evolve during the iterative solution process, allowing the development
 of kinematics of sticking contact.
 Implicit in this condition is the assumption that the contact projection
 was previously resolved, and thus contact searching is not performed again;
 rather, the contact point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 is given by the parametric coordinates of intersection 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 found from the previous time point, which will be denoted as 
\begin_inset Formula $\eta_{(2)p}^{\alpha}$
\end_inset

, with the subscripted 
\begin_inset Formula $p$
\end_inset

 referring to the previous time.
 Thus, we write the spatial position of 
\begin_inset Formula $X^{\left(2\right)}$
\end_inset

 in stick as
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{s}^{(2)}=\mathbf{x}^{(2)}\left(\eta_{(2)p}^{\alpha},t\right)=\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)+\mathbf{g}_{s}\,,\label{eq:stick_x2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 is a vectorial gap function,
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{s}=\mathbf{x}_{s}^{(2)}-\mathbf{x}^{(1)}\,.\label{eq:stick_gap}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 is the vectorial distance, at the current time 
\begin_inset Formula $t$
\end_inset

, between material points which were in contact at the previous time step;
 for perfect stick we must have 
\begin_inset Formula $\mathbf{g}_{s}=\mathbf{0}$
\end_inset

.
 In a finite element implementation however, it is important to note that
 the intersection point 
\begin_inset Formula $\mathbf{x}_{s}^{(2)}$
\end_inset

 is not in general the point that would be found from a ray directed from
 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

 along the unit outward normal 
\begin_inset Formula $\mathbf{n}^{(1)}$
\end_inset

.
 This is because stick will not be enforced exactly, so the points 
\begin_inset Formula $\mathbf{x}^{(1)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}_{s}^{(2)}$
\end_inset

 will separate slightly when using a penalty method for enforcing this constrain
t.
 How to minimize this separation and enforce perfect stick behavior is the
 subject of the forthcoming sections.
\end_layout

\begin_layout Subsubsection
Velocities
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Velocities"

\end_inset


\end_layout

\begin_layout Standard
The kinematics developed above can be used to formulate velocities.
 The formulation for stick developed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Coulomb-Friction"

\end_inset

 does not rely on velocity constraints, therefore we are only concerned
 with velocities of opposing contact points in slip.
 The development of velocities presented below anticipates the need for
 a relative velocity as required by Coulomb's law of kinetic friction, which
 aligns the friction force with this slip direction.
 
\end_layout

\begin_layout Standard
Since the parametric coordinates 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

 of integration points represent material points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, the velocity 
\begin_inset Formula $\mathbf{v}^{\left(1\right)}$
\end_inset

 of these points on the primary surface is evaluated from the material time
 derivative in the material frame, 
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)=\frac{\partial\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)}{\partial t}\,.\label{eq:v1}
\end{equation}

\end_inset

In contrast, since material may convect through the intersection point of
 the ray with 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

, the total velocity 
\begin_inset Formula $\mathbf{v}^{(2)}$
\end_inset

 at the intersection point on 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 needs to be evaluated using the material time derivative in the spatial
 frame, 
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)=\frac{\partial\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)}{\partial t}+\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}\,.\label{eq:both_v2}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\partial\mathbf{x}^{(2)}/\partial t$
\end_inset

 represents the velocity of the intersection point on 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

, whereas 
\begin_inset Formula $\dot{\eta}_{(2)}^{\alpha}$
\end_inset

 are the contravariant components of the convective velocity of material
 passing through this intersection point.
 In effect, 
\begin_inset Formula $\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}$
\end_inset

 represents the relative (slip) velocity between the material on 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 and that on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

.
 Importantly, as noted below when performing time discretization and linearizati
on, by definition 
\begin_inset Formula $\partial\mathbf{x}^{(2)}/\partial t$
\end_inset

 is evaluated while keeping 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 constant.
\end_layout

\begin_layout Standard
We now use these relations to produce a more practical formulation of the
 slip velocity for our frictional contact implementation.
 Taking the material time derivative of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"

\end_inset

 and using the contact persistency condition 
\begin_inset Formula $\dot{g}=0$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen93"
literal "true"

\end_inset

 produces 
\begin_inset Formula $\mathbf{v}^{\left(2\right)}=\mathbf{v}^{\left(1\right)}+g\dot{\mathbf{n}}^{\left(1\right)}$
\end_inset

.
 Substituting Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:v1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:both_v2"

\end_inset

 into this expression yields a frame-invariant measure of relative velocity
 between 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Poulios15,Curnier95"
literal "true"

\end_inset

, 
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{r}\equiv\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}=g\dot{\mathbf{n}}^{(1)}+\frac{\partial\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)}{\partial t}-\frac{\partial\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)}{\partial t},\label{eq:vr}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dot{\mathbf{n}}^{(1)}$
\end_inset

 is the material time derivative of 
\begin_inset Formula $\mathbf{n}^{(1)}$
\end_inset

 in the parametric material frame of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, evaluated from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:n"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{n}}^{(1)}=\mathbf{P}_{N}\cdot\frac{\dot{\mathbf{g}}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}+\mathbf{g}_{1}^{(1)}\times\dot{\mathbf{g}}_{2}^{(1)}}{J_{\eta}^{(1)}}\,.\label{eq:n_dot}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\dot{\mathbf{g}}_{\alpha}^{(1)}$
\end_inset

 denotes the material time derivative of 
\begin_inset Formula $\mathbf{g}_{\alpha}^{(1)}$
\end_inset

 in the material frame,
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{g}}_{\alpha}^{(1)}\left(\eta_{\left(1\right)}^{\beta},t\right)=\frac{\partial\mathbf{g}_{\alpha}^{(1)}\left(\eta_{\left(1\right)}^{\beta},t\right)}{\partial t}\,,
\end{equation}

\end_inset

and we define the tangential plane projection tensor 
\begin_inset Formula $\mathbf{P}_{N}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\mathbf{P}_{N}=\mathbf{I}-\mathbf{n}^{(1)}\otimes\mathbf{n}^{(1)}\,.\label{eq:Pn}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Previous authors have utilized 
\begin_inset Formula $\mathbf{v}^{r}=\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}$
\end_inset

 directly instead of the right-hand-side of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vr"

\end_inset

; this expression requires the evaluation of time derivatives of parametric
 coordinates 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers90,Laursen93,Sauer15"
literal "true"

\end_inset

, which necessitates special integration algorithms to handle crossing element
 boundaries 
\begin_inset CommandInset citation
LatexCommand citep
key "Saracibar97"
literal "true"

\end_inset

.
 The relative velocity measure on the right-hand-side of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vr"

\end_inset

 obviates the need for any such special treatment.
 In particular, the choice of 
\begin_inset Formula $\partial\mathbf{x}^{(2)}/\partial t$
\end_inset

 ensures that element boundaries will never be crossed when calculating
 this velocity, since it is evaluated while keeping 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 constant.
\end_layout

\begin_layout Standard
The tangential frictional traction in slip depends only on the tangential
 component of the relative velocity, therefore we may define the slip direction
 
\begin_inset Formula $\mathbf{s}^{(1)}$
\end_inset

 as the unit vector of the projection 
\begin_inset Formula $\mathbf{P}_{N}\cdot\mathbf{v}^{r}$
\end_inset

 of 
\begin_inset Formula $\mathbf{v}^{r}$
\end_inset

 onto the tangent plane of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{s}^{(1)}=\frac{\mathbf{P}_{N}\cdot\mathbf{v}^{r}}{\left|\mathbf{P}_{N}\cdot\mathbf{v}^{r}\right|}\,,\label{eq:s1}
\end{equation}

\end_inset

These definitions of contact kinematics may now be used to formulate frictional
 contact.
\end_layout

\begin_layout Subsubsection
Coulomb Frictional Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Coulomb-Friction"

\end_inset


\end_layout

\begin_layout Standard
This work considers Coulomb frictional contact, with no distinction made
 between static and kinetic coefficients of friction.
 Although classical Coulomb friction is the most frequently adopted behavior,
 it should be noted that other constitutive equations, including micromechanical
ly-inspired formulations which consider local phenomena, have been proposed
 as well 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers90,Wriggers06"
literal "true"

\end_inset

.
 During frictional contact, the contact traction 
\begin_inset Formula $\mathbf{t}^{(i)}$
\end_inset

 on the opposing surfaces is determined by the sticking or slipping behavior.
 For Coulomb friction, the relationship between sticking and slipping is
 described by a slip criterion 
\begin_inset Formula $\Phi$
\end_inset

, where on the primary surface
\begin_inset Formula 
\begin{equation}
\Phi=\left|\mathbf{t}_{T}^{(1)}\right|-\mu\left|t_{n}\right|\,.
\end{equation}

\end_inset

Here, 
\begin_inset Formula $t_{n}=\mathbf{t}^{(1)}\cdot\mathbf{n}^{(1)}$
\end_inset

 is the normal component of the contact traction (negative in compression),
 
\begin_inset Formula $\mathbf{t}_{T}^{(1)}=\mathbf{t}^{(1)}-t_{n}\mathbf{n}^{(1)}$
\end_inset

 is the tangential component of the contact traction, and 
\begin_inset Formula $\mu$
\end_inset

 is the friction coefficient.
 The value of the slip criterion determines the stick-slip status,
\begin_inset Formula 
\begin{equation}
\Phi\begin{cases}
<0 & \text{sticking}\\
=0 & \text{slipping}
\end{cases}\label{eq:slip-criterion}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Algorithmically, stick and slip are typically based on a predictor-corrector
 approach derived from an analogy with elastoplasticity 
\begin_inset CommandInset citation
LatexCommand citep
key "Giannakopoulos89"
literal "true"

\end_inset

, leading to constitutive relations for the rate of the traction and thus
 requiring numerical integration 
\begin_inset CommandInset citation
LatexCommand citep
key "Saracibar97"
literal "true"

\end_inset

.
 Variations of this approach have been utilized in differing forms 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers90,Laursen93,Sauer15"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Standard
In contrast, this presentation proposes to treat stick and slip separately,
 controlled by an exact return mapping based on the slip criterion.
 The return mapping defines a rule for correcting a calculated traction
 which exceeds the slip limit and is thus not permissible.
 Stick will be treated as a special case of a tied interface, whereas in
 slip the traction will be directly prescribed.
 The formulation of Coulomb frictional contact is presented for both penalty
 and augmented Lagrangian regularization schemes.
\end_layout

\begin_layout Subsubsection
Penalty Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Penalty-Scheme"

\end_inset


\end_layout

\begin_layout Standard
During stick, no relative motion may occur between surfaces; thus, points
 on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 that were in contact at the previous time must remain in contact.
 The stick traction may be obtained by penalizing any relative motion between
 such points,
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\varepsilon\mathbf{g}_{s}\,,\label{eq:stick_traction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the penalty parameter and we have employed eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_gap"

\end_inset

.
 
\end_layout

\begin_layout Standard
During slip, we first calculate the normal component of the contact traction
 by penalizing the normal gap of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_gap"

\end_inset

,
\begin_inset Formula 
\begin{equation}
t_{n}=\varepsilon g\,.\label{eq:slip_tn}
\end{equation}

\end_inset

The total traction vector is then directly obtained as
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=t_{n}\left(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}\right)\,.\label{eq:slip_traction}
\end{equation}

\end_inset

Here we have achieved an exact expression for the tangential traction in
 slip and remark that since 
\begin_inset Formula $t_{n}$
\end_inset

 is strictly negative in contact, the frictional contact traction 
\begin_inset Formula $\mu t_{n}\mathbf{s}^{(1)}$
\end_inset

 acting on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 is in the direction opposing the motion of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 relative to 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 A trial state and return map, presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Stick-Slip-Algorithm"

\end_inset

, is employed to differentiate between stick and slip.
\end_layout

\begin_layout Subsubsection
Augmented Lagrangian Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Augmented-Lagrangian"

\end_inset


\end_layout

\begin_layout Standard
The augmented Lagrangian scheme employed in this study is first order and
 utilizes Uzawa's algorithm 
\begin_inset CommandInset citation
LatexCommand citep
key "Bertsekas82"
literal "true"

\end_inset

, where multipliers are updated outside of the Newton step, producing a
 double loop algorithm (see the texts by Laursen 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen02"
literal "true"

\end_inset

 and Wriggers 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers06"
literal "true"

\end_inset

 for a discussion of Uzawa's algorithm applied to frictional contact problems).
 Such an approach preserves the quadratic convergence of Newton's method
 near solution points.
 The presented scheme is a modification of the approach suggested by Simo
 and Laursen 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo92c"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
During stick, the traction is calculated by augmenting the vector gap 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\boldsymbol{\lambda}_{s}+\varepsilon\mathbf{g}_{s}\,,\label{eq:AL_stick_traction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 is the vectorial Lagrange multiplier in stick.
 In slip, we first calculate the normal component of the contact traction
 by augmenting the normal gap 
\begin_inset Formula $g$
\end_inset

,
\begin_inset Formula 
\begin{equation}
t_{n}=\lambda_{n}+\varepsilon g\,,\label{eq:AL_tn}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{n}$
\end_inset

 is the normal Lagrange multiplier.
 The total traction vector in slip is then defined to be 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=t_{n}\left(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}\right)\,,
\end{equation}

\end_inset

where 
\begin_inset Formula $t_{n}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_tn"

\end_inset

.
 In this approach the Lagrange multiplier 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 augments the traction 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 in stick, but in slip only the normal component of traction 
\begin_inset Formula $t_{n}$
\end_inset

 is augmented by 
\begin_inset Formula $\lambda_{n}$
\end_inset

 and the tangential traction is directly prescribed from the augmented normal
 component.
 This approach has the advantage of preserving an exact mapping to the proper
 tangential traction in slip, which is consistent with the augmented normal
 traction.
 As in the penalty case, a trial state and return map controlled by the
 slip criterion is employed to differentiate between stick and slip, presented
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Stick-Slip-Algorithm"

\end_inset

.
 
\end_layout

\begin_layout Standard
The Lagrange multipliers 
\begin_inset Formula $\lambda_{n}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 are held constant during each Newton step.
 Outside of the Newton loop, in this study we propose a novel update scheme
 where one of these multipliers is considered active and is updated from
 the kinematic data (
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 or 
\begin_inset Formula $g$
\end_inset

), and the other is considered passive and is derived from the active multiplier.
 The contact status is determined via eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-criterion"

\end_inset

.
 If the current status is stick (
\begin_inset Formula $\Phi<0$
\end_inset

), we update 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 (active) and derive 
\begin_inset Formula $\lambda_{n}$
\end_inset

 (passive),
\begin_inset Formula 
\begin{equation}
\begin{aligned}\boldsymbol{\lambda}_{s} & \leftarrow\boldsymbol{\lambda}_{s}+\varepsilon\mathbf{g}_{s}\\
\lambda_{n} & =\boldsymbol{\lambda}_{s}\cdot\mathbf{n}^{(1)}
\end{aligned}
\label{eq:AL-stick}
\end{equation}

\end_inset

Alternatively, if the current contact status is slip (
\begin_inset Formula $\Phi=0$
\end_inset

), we update 
\begin_inset Formula $\lambda_{n}$
\end_inset

 (active) and derive 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 (passive),
\begin_inset Formula 
\begin{equation}
\begin{aligned}\lambda_{n} & \leftarrow\lambda_{n}+\varepsilon g\\
\boldsymbol{\lambda}_{s} & =\lambda_{n}\left(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}\right)
\end{aligned}
\label{eq:AL-slip}
\end{equation}

\end_inset

An active-passive strategy for the multipliers ensures consistency when
 the contact status switches between stick and slip and is made possible
 due to this formulation's use of a single penalty parameter 
\begin_inset Formula $\varepsilon$
\end_inset

, in conjunction with an exact return mapping for slip.
 
\end_layout

\begin_layout Standard
Augmentations proceed until a tolerance related to a convergence criterion
 is met.
 In this formulation, two separate convergence criteria and their associated
 tolerances are defined.
 The first criterion considers the relative change of the norms of the active
 Lagrange multipliers between successive iterations, where the associated
 unitless tolerance 
\begin_inset Formula $P_{tol}$
\end_inset

 specifies the largest allowable change.
 Convergence is achieved when
\begin_inset Formula 
\begin{equation}
\left|\frac{L^{r}-L^{r-1}}{L^{r}}\right|<P_{tol}\,,
\end{equation}

\end_inset

where 
\begin_inset Formula $L^{r}$
\end_inset

 represents the total norm of the active multipliers across the contact
 surface at augmentation step 
\begin_inset Formula $r$
\end_inset

, calculated by summing all the individual norms,
\begin_inset Formula 
\begin{equation}
L^{r}=\sum_{e=1}^{n_{e}^{(1)}}\sum_{k=1}^{n_{int}^{(e)}}l_{k,e}^{r}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $n_{e}^{(1)}$
\end_inset

 is the number of element faces on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, 
\begin_inset Formula $n_{int}^{(e)}$
\end_inset

 is the number of integration points on the 
\begin_inset Formula $e\text{th}$
\end_inset

 element face, and 
\begin_inset Formula $l_{k,e}^{r}$
\end_inset

 is the norm of the active Lagrange multiplier at the 
\begin_inset Formula $k\text{th}$
\end_inset

 integration point on the 
\begin_inset Formula $e\text{th}$
\end_inset

 element of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 at augmentation step 
\begin_inset Formula $r$
\end_inset

, defined by
\begin_inset Formula 
\begin{equation}
l_{k,e}^{r}=\begin{cases}
\boldsymbol{\lambda}_{s}^{r}\cdot\boldsymbol{\lambda}_{s}^{r} & \Phi<0,\quad\text{sticking}\\
\left(\lambda_{n}^{r}\right)^{2} & \Phi=0,\quad\text{slipping}
\end{cases}
\end{equation}

\end_inset

The second criterion is a gap tolerance, where augmentations will continue
 until the magnitude of the gap is lower than the specified tolerance 
\begin_inset Formula $G_{tol}$
\end_inset

 at every location.
 Convergence of the augmentations requires
\begin_inset Formula 
\begin{equation}
\text{max}\,\left(\left|\mathbf{g}_{s}\right|,\left|g\right|\right)<G_{tol}
\end{equation}

\end_inset

where 
\begin_inset Formula $\left|\mathbf{g}_{s}\right|$
\end_inset

 is associated with points currently sticking and 
\begin_inset Formula $\left|g\right|$
\end_inset

 with those in slip.
 The tolerance 
\begin_inset Formula $G_{tol}$
\end_inset

 has units of length, allowing enforcement of the non-penetration and stick
 constraints to arbitrarily small precision.
\end_layout

\begin_layout Subsubsection
Stick-Slip Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Stick-Slip-Algorithm"

\end_inset


\end_layout

\begin_layout Standard
Determination of whether stick or slip is active is accomplished by a trial
 state and return map, and follows the same procedure for both penalty and
 augmented Lagrangian regularizations.
 We begin by calculating a trial traction 
\begin_inset Formula $\tilde{\mathbf{t}}^{(1)}$
\end_inset

 assuming stick, utilizing either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_traction"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_stick_traction"

\end_inset

.
 The trial normal and tangential components 
\begin_inset Formula $\tilde{t}_{n}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathbf{t}}_{T}^{(1)}$
\end_inset

 are evaluated from 
\begin_inset Formula $\tilde{\mathbf{t}}^{(1)}$
\end_inset

 and inserted into the slip criterion 
\begin_inset Formula $\Phi$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\Phi=\left|\tilde{\mathbf{t}}_{T}^{(1)}\right|-\mu\left|\tilde{t}_{n}\right|.
\end{equation}

\end_inset

Based on the slip criterion and trial traction vector, we perform a return
 mapping and obtain the traction vector as 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\begin{cases}
\tilde{\mathbf{t}}^{(1)} & \Phi<0\,,\quad\text{sticking}\\
t_{n}(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}) & \Phi=0\,,\quad\text{slipping}
\end{cases}
\end{equation}

\end_inset

where 
\begin_inset Formula $t_{n}$
\end_inset

 is given by either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_tn"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_tn"

\end_inset

.
 In the case of first contact, a trial stick traction cannot be calculated,
 as stick requires a previous intersection point.
 Consequently, first contact is treated as a case of slip in this framework.
 The alternative of treating first contact as frictionless is unsatisfying,
 as the lack of friction at the first iteration can lead to premature failure
 and thus precludes the modeling of certain problems that rely on frictional
 forces for stability (such as load-control analyses).
 After one iteration, the traction can be evaluated via the return map described
 above.
\end_layout

\begin_layout Standard
Computationally, care must be taken to ensure that augmentation does not
 unnecessarily change the stick-slip status.
 For normal contact, the update 
\begin_inset Formula $\lambda_{n}\leftarrow\lambda_{n}+\varepsilon g$
\end_inset

 will augment the normal traction until the non-penetration contact constraint
 is adequately satisfied, with no adverse consequence if 
\begin_inset Formula $\lambda_{n}$
\end_inset

 slightly overshoots the final target value during an intermediate augmentation.
 For tangential contact however, augmentation of the tangential traction
 that overshoots the final target value may cross the boundary between stick
 and slip, thus changing the nature of the solution.
 For example, at the first augmentation step, the stick traction is 
\begin_inset Formula $\mathbf{t}^{(1)}=\varepsilon\mathbf{g}_{s}$
\end_inset

 and the multiplier 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 is augmented from its initial zero value to 
\begin_inset Formula $\boldsymbol{\lambda}_{s}=\varepsilon\mathbf{g}_{s}$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-stick"

\end_inset

.
 Thus, at the start of the next iteration, when 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 has not yet changed, the traction is calculated as 
\begin_inset Formula $\mathbf{t}^{(1)}=\boldsymbol{\lambda}_{s}+\varepsilon\mathbf{g}_{s}=2\varepsilon\mathbf{g}_{s}$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_stick_traction"

\end_inset

, which essentially counts the gap function twice and can in some cases
 shift the contact from stick to slip.
 To circumvent potential error introduced by this step, our implementation
 freezes the stick-slip status until the completion of the first iteration
 following an augmentation step.
 After the first iteration, the gap function has been reduced by the augmentatio
n and the traction is split appropriately between the remaining gap and
 the multiplier.
 In this way, the double-counting of the gap function does not unnecessarily
 shift the contact status, but augmentation is able to modify the stick-slip
 status if accurate enforcement of the contact constraints requires it.
 
\end_layout

\begin_layout Subsubsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Linearization"

\end_inset


\end_layout

\begin_layout Standard
To evaluate the linearization in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dgc"
plural "false"
caps "false"
noprefix "false"

\end_inset

 requires directional derivatives of kinematic quantities, some of which
 are dependent on the stick-slip status.
 In an attempt to simplify the presentation, the continuum linearization
 of only a few kinematic quantities is described below, and the majority
 of the linearization will be deferred until after the discretization presented
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:SE-Discretization"

\end_inset

.
 We note that, as a consequence of the double-loop Uzawa algorithm discussed
 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Augmented-Lagrangian"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the Lagrange multipliers are updated outside of each Newton step and thus
 
\begin_inset Formula $D\lambda_{n}=0$
\end_inset

 and 
\begin_inset Formula $D\boldsymbol{\lambda}_{s}=\mathbf{0}$
\end_inset

 in the following linearizations.
 Furthermore, in forthcoming sections, 
\begin_inset Formula $\Delta\mathbf{u}^{(i)}$
\end_inset

 refers to an increment in displacement in the trial solution 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

.
 All other expressions which employ 
\begin_inset Formula $\Delta$
\end_inset

 are slight abuses of notation, used to compactly denote changes in a quantity
 from the previous time step.
 
\end_layout

\begin_layout Paragraph
Stick
\end_layout

\begin_layout Standard
Parametric coordinates on the primary surface are always invariant since
 they represent material points 
\begin_inset Formula $X^{(1)}$
\end_inset

 where the contact integral is to be evaluated (integration points), and
 in stick the parametric coordinates of contact on the secondary surface
 are similarly fixed by definition.
 Accordingly, directional derivatives of 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{(i)}$
\end_inset

 are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{(1)} & =\Delta\mathbf{u}^{(1)}\,, & D\mathbf{x}^{(2)} & =\Delta\mathbf{u}^{(2)}\\
D\delta\mathbf{v}^{(1)} & =\mathbf{0}\,, & D\delta\mathbf{v}^{(2)} & =\mathbf{0}
\end{aligned}
\label{eq:stick_xv_linearizations}
\end{equation}

\end_inset

From the above expressions and Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basis_vectors"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:da_jeta"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we find directional derivatives of 
\begin_inset Formula $\mathbf{g}_{\alpha}^{(1)}$
\end_inset

 and 
\begin_inset Formula $J_{\eta}^{(1)}$
\end_inset

 to be
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{g}_{\alpha}^{(1)} & =\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{\alpha}}\\
DJ_{\eta}^{(1)} & =\mathbf{n}^{(1)}\cdot\left(\hat{\mathbf{g}}_{1}^{(1)}\cdot\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{2}}-\hat{\mathbf{g}}_{2}^{(1)}\cdot\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{1}}\right)
\end{aligned}
\label{eq:Dgcov_Djeta}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{g}}_{\alpha}^{(1)}$
\end_inset

 is a skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{g}_{\alpha}^{(1)}$
\end_inset

; thus 
\begin_inset Formula $\hat{\mathbf{g}}_{\alpha}^{(1)}\cdot\mathbf{z}=\mathbf{\mathbf{g}}_{\alpha}^{(1)}\times\mathbf{z}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{z}$
\end_inset

.
 Given the definitions of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

, along with the relations of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_xv_linearizations"

\end_inset

, it follows that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
D\mathbf{t}^{(1)}=\varepsilon\left(\Delta\mathbf{u}^{(2)}-\Delta\mathbf{u}^{(1)}\right)\,.\label{eq:Dt_stick}
\end{equation}

\end_inset

The linearization operator may be brought inside the contact integral of
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to find
\begin_inset Formula 
\begin{equation}
\begin{aligned}\begin{aligned}D\delta G_{c}= & \int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}1\\
-1
\end{bmatrix}D\mathbf{t}^{(1)}J_{\eta}^{(1)}\right.\\
 & \left.+\begin{bmatrix}\mathbf{t}^{(1)}\\
-\mathbf{t}^{(1)}
\end{bmatrix}DJ_{\eta}^{(1)}\right)\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\end{aligned}
\label{eq:stick-linearized-2}
\end{equation}

\end_inset

where we recall that 
\begin_inset Formula $D\delta\mathbf{v}^{(1)}=D\delta\mathbf{v}^{(2)}=\mathbf{0}$
\end_inset

 from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_xv_linearizations"

\end_inset

.
 
\end_layout

\begin_layout Paragraph
Slip
\end_layout

\begin_layout Standard
As in stick, the contact integral over 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 is performed over integration points of prescribed parametric coordinates
 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

.
 However, the point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 in contact with 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 has parametric coordinates 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 that change with variations in 
\begin_inset Formula $\mathbf{x}^{(1)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}^{(1)}$
\end_inset

, in accordance with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Thus, directional derivatives of 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{(i)}$
\end_inset

 are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{(1)} & =\Delta\mathbf{u}^{(1)}\,, & D\mathbf{x}^{(2)} & =\Delta\mathbf{u}^{(2)}+\mathbf{g}_{\alpha}^{(2)}D\eta_{(2)}^{\alpha}\\
D\delta\mathbf{v}^{(1)} & =\mathbf{0}\,, & D\delta\mathbf{v}^{(2)} & =\frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}
\end{aligned}
\label{eq:slip_xv_linearizations}
\end{equation}

\end_inset

where we recall that 
\begin_inset Formula $\mathbf{x}^{(2)}$
\end_inset

 is the spatial location of the intersection point 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 at the current time 
\begin_inset Formula $t$
\end_inset

.
 
\end_layout

\begin_layout Standard
We evaluate 
\begin_inset Formula $D\eta_{(2)}^{\alpha}$
\end_inset

 in terms of increments in solid displacements by means of our modification
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

 of a method proposed by Laursen and Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen93"
literal "true"

\end_inset

.
 Briefly, recognizing that 
\begin_inset Formula $\left(\mathbf{x}^{(2)}-\mathbf{x}^{(1)}\right)\cdot\mathbf{g}_{\alpha}^{(1)}=0$
\end_inset

, the directional derivative of this expression is evaluated and the resulting
 linear system is inverted to yield
\begin_inset Formula 
\begin{equation}
D\eta_{(2)}^{\alpha}=\left(\Delta\mathbf{u}^{(1)}-\Delta\mathbf{u}^{(2)}\right)\cdot\bar{\mathbf{g}}_{(2)}^{\alpha}-a^{\alpha\beta}g\mathbf{n}^{(1)}\cdot\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{\beta}}\label{eq:Deta}
\end{equation}

\end_inset

where 
\begin_inset Formula $a^{\alpha\beta}=(A_{\alpha\beta})^{-1}$
\end_inset

, 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{(1)}\cdot\mathbf{g}_{\beta}^{(2)}$
\end_inset

, and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\bar{\mathbf{g}}_{(1)}^{\beta}=a^{\alpha\beta}\mathbf{g}_{\alpha}^{(2)}, & \quad\bar{\mathbf{g}}_{(2)}^{\alpha}=a^{\alpha\beta}\mathbf{g}_{\beta}^{(1)}.\end{aligned}
\end{equation}

\end_inset

In this expression, 
\begin_inset Formula $\bar{\mathbf{g}}_{(i)}^{\alpha}$
\end_inset

 are approximate contravariant basis vectors on 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

.
 In the limit of perfect contact (
\begin_inset Formula $g\to0$
\end_inset

), 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 become true mating surfaces and a number of relations emerge, including
 
\begin_inset Formula $\bar{\mathbf{g}}_{(i)}^{\alpha}\to\mathbf{g}_{(i)}^{\alpha}$
\end_inset

 since 
\begin_inset Formula $a^{\alpha\beta}\to\mathbf{g}_{(2)}^{\alpha}\cdot\mathbf{g}_{(1)}^{\beta}$
\end_inset

 (see the discussion following eq.(40) in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

).
 In the present formulation, this simplification to perfect contact is not
 adopted, as it was determined that retaining all terms provides better
 convergence and stability.
\end_layout

\begin_layout Standard
From eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 it follows that 
\begin_inset Formula 
\begin{equation}
D\mathbf{t}^{(1)}=Dt_{n}\left(\mathbf{n}+\mu\mathbf{s}^{(1)}\right)+t_{n}\left(D\mathbf{n}^{(1)}+\mu D\mathbf{s}^{(1)}\right)\,.\label{eq:Dt_slip}
\end{equation}

\end_inset

By eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $Dt_{n}=\varepsilon Dg$
\end_inset

, and
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dg & =\left(\Delta\mathbf{u}^{(2)}-\Delta\mathbf{u}^{(1)}+\mathbf{g}_{\alpha}^{(2)}D\eta_{(2)}^{\alpha}\right)\cdot\mathbf{n}^{(1)}\end{aligned}
\,.\label{eq:Dg_slip}
\end{equation}

\end_inset

Applying the linearization operator to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 yields
\begin_inset Formula 
\begin{equation}
D\mathbf{s}^{(1)}=\frac{1}{\left|\mathbf{P}_{N}\cdot\mathbf{v}^{r}\right|}(\mathbf{I}-\mathbf{s}^{(1)}\otimes\mathbf{s}^{(1)})\cdot\bigg(D\mathbf{P}_{N}\cdot\mathbf{v}^{r}+\mathbf{P}_{N}\cdot D\mathbf{v}^{r}\bigg)\label{eq:Ds}
\end{equation}

\end_inset

where 
\begin_inset Formula $D\mathbf{v}^{r}=Dg\,\dot{\mathbf{n}}^{(1)}+g\,D\dot{\mathbf{n}}^{(1)}+D\left(\partial\mathbf{x}^{\left(1\right)}/\partial t\right)-D\left(\partial\mathbf{x}^{\left(2\right)}/\partial t\right)$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vr"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
To linearize partial time derivatives of positions 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

, we adopt Euler integration and find 
\begin_inset Formula 
\begin{equation}
\frac{\partial\mathbf{x}^{\left(i\right)}\left(\eta_{\left(i\right)}^{\alpha},t\right)}{\partial t}\approx\frac{\mathbf{x}^{\left(i\right)}\left(\eta_{\left(i\right)}^{\alpha},t\right)-\mathbf{x}^{\left(i\right)}\left(\eta_{\left(i\right)}^{\alpha},t-\Delta t\right)}{\Delta t}=\frac{\Delta\mathbf{x}^{\left(i\right)}}{\Delta t}\label{eq:Euler-integration}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta t$
\end_inset

 represents the time increment and 
\begin_inset Formula $\Delta\mathbf{x}^{(i)}$
\end_inset

 denotes the change in 
\begin_inset Formula $\mathbf{x}^{(i)}$
\end_inset

 from the previous time step.
 Since 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 is kept constant when evaluating the partial time derivative, the linearization
 of this expression reduces to 
\begin_inset Formula 
\begin{equation}
D\left(\frac{\partial\mathbf{x}^{\left(i\right)}\left(\eta_{\left(i\right)}^{\alpha},t\right)}{\partial t}\right)\approx\frac{\Delta\mathbf{u}^{(i)}}{\Delta t}\,.\label{eq:Dx2_velocity}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Finally, linearizing Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:n"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Pn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 produces
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{n}^{(1)} & =\frac{1}{J_{\eta}^{(1)}}\mathbf{P}_{N}\cdot\left(\hat{\mathbf{g}}_{1}^{(1)}\cdot\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{2}}-\hat{\mathbf{g}}_{2}^{(1)}\cdot\frac{\partial\Delta\mathbf{u}^{(1)}}{\partial\eta_{(1)}^{1}}\right)\end{aligned}
\label{eq:Dn}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\mathbf{P}_{N}=-\left(D\mathbf{n}^{(1)}\otimes\mathbf{n}^{(1)}+\mathbf{n}^{(1)}\otimes D\mathbf{n}^{(1)}\right)\,.\label{eq:DPn}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "sec:SE-Discretization"

\end_inset


\end_layout

\begin_layout Standard
Let the continuous variables on the primary and secondary surfaces be interpolat
ed over each element face according to
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{(1)} & =\sum_{a=1}^{m^{(1)}}N_{a}^{(1)}\delta\mathbf{v}_{a}^{(1)}\,, & \delta\mathbf{v}^{(2)} & =\sum_{b=1}^{m_{k}^{(2)}}N_{b}^{(2)}\delta\mathbf{v}_{b}^{(2)}\\
\Delta\mathbf{u}^{(1)} & =\sum_{c=1}^{m^{(1)}}N_{c}^{(1)}\Delta\mathbf{u}_{c}^{(1)}\,, & \Delta\mathbf{u}^{(2)} & =\sum_{d=1}^{m_{k}^{(2)}}N_{d}^{(2)}\Delta\mathbf{u}_{d}^{(2)}
\end{aligned}
\label{eq:u-v-discretization}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}^{(i)}$
\end_inset

 represent interpolation functions on the element faces of 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

, 
\begin_inset Formula $m^{(1)}$
\end_inset

 is the number of nodes and interpolation functions on each primary element
 face, 
\begin_inset Formula $m_{k}^{(2)}$
\end_inset

 is the number of nodes and interpolation functions on the secondary element
 face which is intersected by the ray issued from the 
\begin_inset Formula $k\text{th}$
\end_inset

 integration point on the primary element face, and 
\begin_inset Formula $\delta\mathbf{v}_{a}^{(i)}$
\end_inset

 and 
\begin_inset Formula $\Delta\mathbf{u}_{a}^{(i)}$
\end_inset

 represent respective nodal values of 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 and 
\begin_inset Formula $\Delta\mathbf{u}^{(i)}$
\end_inset

.
 From this point forward, the summation signs will be written simply as
 
\begin_inset Formula $\sum_{a}$
\end_inset

, where it is assumed they have the same meaning described above.
\end_layout

\begin_layout Paragraph
Stick
\end_layout

\begin_layout Standard
Applying the discretization to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the contact integral becomes
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{a}^{(1)}\\
\mathbf{f}_{b}^{(2)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\label{eq:contact-int-discretized}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{(1)} & =N_{a}^{(1)}\mathbf{t}^{(1)}, & \mathbf{f}_{b}^{(2)} & =-N_{b}^{(2)}\mathbf{t}^{(1)}\end{aligned}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 is defined by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the penalty case and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_stick_traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 when augmented Lagrangian regularization is used.
 Individual terms may now be discretized and placed into matrix notation,
 facilitating their substitution into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-linearized-2"

\end_inset

.
 A straightforward application of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-v-discretization"

\end_inset

 to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dgcov_Djeta"

\end_inset


\begin_inset Formula $_{2}$
\end_inset

 yields
\begin_inset Formula 
\begin{equation}
DJ_{\eta}^{(1)}=\begin{bmatrix}\sum_{c}J_{\eta}^{(1)}\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)} & \sum_{d}\mathbf{0}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}\label{eq:Djeta-discretized}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{c}^{(1)}=\frac{1}{J_{\eta}^{(1)}}\left(\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{1}}\hat{\mathbf{g}}_{2}^{(1)}-\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{2}}\hat{\mathbf{g}}_{1}^{(1)}\right)\label{eq:Ac}
\end{equation}

\end_inset

and 
\begin_inset Formula $\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)} & \Delta\mathbf{u}_{d}^{(2)}\end{bmatrix}^{T}$
\end_inset

 is the vector of incremental changes in the degrees of freedom to the 
\begin_inset Formula $c\text{th}$
\end_inset

 node associated with the element face on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, and to the 
\begin_inset Formula $d\text{th}$
\end_inset

 node of the element face on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 associated with the current integration point on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

.
 Furthermore, discretizing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dt_stick"

\end_inset

 produces
\begin_inset Formula 
\begin{equation}
D\mathbf{t}^{(1)}=\begin{bmatrix}\sum_{c}-\varepsilon N_{c}^{(1)}\mathbf{I} & \sum_{d}\varepsilon N_{d}^{(2)}\mathbf{I}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}\,.\label{eq:Dt-stick-discretized}
\end{equation}

\end_inset

Substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Djeta-discretized"

\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dt-stick-discretized"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-linearized-2"

\end_inset

 and applying the discretization of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-v-discretization"

\end_inset

 yields the directional derivative of the virtual work in stick as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}= & \begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\\
 & \cdot\int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\sum_{c}-N_{a}^{(1)}N_{c}^{(1)} & \sum_{d}N_{a}^{(1)}N_{d}^{(2)}\\
\sum_{c}N_{b}^{(2)}N_{c}^{(1)} & \sum_{d}-N_{b}^{(2)}N_{d}^{(2)}
\end{bmatrix}\varepsilon\mathbf{I}\right.\\
 & \left.+\begin{bmatrix}\sum_{c}-N_{a}^{(1)} & \sum_{d}0\\
\sum_{c}N_{b}^{(2)} & \sum_{d}0
\end{bmatrix}\left(-\mathbf{t}^{(1)}\otimes\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}\right)\right)\\
 & \times J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\label{eq:stick-stiffness}
\end{equation}

\end_inset

 An examination of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-stiffness"

\end_inset

 shows that the stiffness matrix associated with this contact formulation
 is not symmetric in stick.
 
\end_layout

\begin_layout Standard
Although the stiffness matrix of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-stiffness"

\end_inset

 can be cast in a more traditional form,
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}= & \begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\\
 & \cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\sum_{c}\mathbf{K}_{ac}^{(1,1)} & \sum_{d}\mathbf{K}_{ad}^{(1,2)}\\
\sum_{c}\mathbf{K}_{bc}^{(2,1)} & \sum_{d}\mathbf{K}_{bd}^{(2,2)}
\end{bmatrix}\,J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\end{equation}

\end_inset

as was done in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

, splitting up like terms is a more natural way to implement the final equations
, and provides some insight into the resulting matrix structure.
 A discussion of how to numerically evaluate the integrals in the above
 equations is deferred until Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Integration-Scheme"

\end_inset

.
\end_layout

\begin_layout Paragraph
Slip
\end_layout

\begin_layout Standard
In the case of slip, the contact integral of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be split into normal and tangential parts, 
\begin_inset Formula $\delta G_{c}=\delta G_{c}^{n}+\delta G_{c}^{t}$
\end_inset

, such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c}= & \int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}t_{n}\mathbf{n}^{(1)}\\
-t_{n}\mathbf{n}^{(1)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\mu t_{n}\mathbf{s}^{(1)}\\
-\mu t_{n}\mathbf{s}^{(1)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:slip-contact-int-split}
\end{equation}

\end_inset

Discretizing this expression yields
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{a}^{(1)}\\
\mathbf{f}_{b}^{(2)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\label{eq:contact-int-discretized-2}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{(1)} & =t_{n}N_{a}^{(1)}\left(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}\right), & \mathbf{f}_{b}^{(2)} & =-t_{n}N_{b}^{(2)}\left(\mathbf{n}^{(1)}+\mu\mathbf{s}^{(1)}\right)\end{aligned}
\end{equation}

\end_inset

and 
\begin_inset Formula $t_{n}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the penalty formulation and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL_tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with augmented Lagrangian regularization.
\end_layout

\begin_layout Standard
For the following linearization and discretization the normal and tangential
 components, representing frictionless and frictional contributions to the
 contact integral, will be treated separately and may then be added together
 as in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-contact-int-split"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Frictionless Terms
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Frictionless-Terms"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the frictionless contribution 
\begin_inset Formula $\delta G_{c}^{n}$
\end_inset

 makes use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_xv_linearizations"

\end_inset

 to find
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}^{n}= & \int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{0} & \frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}}\end{bmatrix}\cdot\begin{bmatrix}t_{n}\mathbf{n}^{(1)}\\
-t_{n}\mathbf{n}^{(1)}
\end{bmatrix}D\eta_{(2)}^{\alpha}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}t_{n}\mathbf{n}^{(1)}\\
-t_{n}\mathbf{n}^{(1)}
\end{bmatrix}DJ_{\eta}^{(1)}\right.\\
 & \left.+\begin{bmatrix}\mathbf{n}^{(1)}\\
-\mathbf{n}^{(1)}
\end{bmatrix}Dt_{n}J_{\eta}^{(1)}+\begin{bmatrix}t_{n}\\
-t_{n}
\end{bmatrix}D\mathbf{n}^{(1)}J_{\eta}^{(1)}\right)\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:frictionless-int-linearization}
\end{equation}

\end_inset

Evaluating eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictionless-int-linearization"

\end_inset

 requires 
\begin_inset Formula $D\mathbf{n}^{(1)}$
\end_inset

, 
\begin_inset Formula $Dt_{n}$
\end_inset

, and 
\begin_inset Formula $D\eta_{(2)}^{\alpha}$
\end_inset

.
 Directly inserting Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_xv_linearizations"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-v-discretization"

\end_inset

 into Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Deta"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dg_slip"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dn"

\end_inset

 yields
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\eta_{(2)}^{\alpha} & =\begin{bmatrix}\sum_{c}N_{c}^{(1)}\bar{\mathbf{g}}_{(2)}^{\alpha}-ga^{\alpha\beta}\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{\beta}}\mathbf{n}^{(1)} & \sum_{d}-N_{d}^{(2)}\bar{\mathbf{g}}_{(2)}^{\alpha}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}\\
Dt_{n} & =\begin{bmatrix}\sum_{c}-\varepsilon N_{c}^{(1)}\bar{\mathbf{N}}^{(1)}\cdot\mathbf{n}^{(1)}-t_{n}\mathbf{N}^{(1)}\cdot\bar{\mathbf{m}}_{c}^{(1)} & \sum_{d}\varepsilon N_{d}^{(2)}\bar{\mathbf{N}}^{(1)}\cdot\mathbf{n}^{(1)}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}\\
D\mathbf{n}^{(1)} & =\begin{bmatrix}\sum_{c}-\mathbf{P}_{N}\cdot\mathbf{A}_{c}^{(1)} & \sum_{d}\mathbf{0}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\label{eq:Deta-Dtn-Dn-discretized}
\end{equation}

\end_inset

with the definitions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{(1)} & =\mathbf{n}^{(1)}\otimes\mathbf{n}^{(1)}, & \bar{\mathbf{N}}^{(1)} & =\mathbf{I}-\mathbf{g}_{\beta}^{(1)}\otimes\bar{\mathbf{g}}_{(1)}^{\beta}\\
\bar{\mathbf{m}}_{c}^{(1)} & =\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{\beta}}\bar{\mathbf{g}}_{(1)}^{\beta}, & \bar{\mathbf{m}}_{b}^{(2)} & =\frac{\partial N_{b}^{(2)}}{\partial\eta_{(2)}^{\alpha}}\bar{\mathbf{g}}_{(2)}^{\alpha}
\end{aligned}
\end{equation}

\end_inset

Applying the discretization in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:u-v-discretization"

\end_inset

 to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictionless-int-linearization"

\end_inset

 and employing the linearizations of Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Djeta-discretized"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Deta-Dtn-Dn-discretized"

\end_inset

 to evaluate the resulting matrix products yields the directional derivative
 of 
\begin_inset Formula $\delta G_{c}^{n}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}^{n}= & \begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\\
 & \cdot\int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\sum_{c}-N_{a}^{(1)}N_{c}^{(1)} & \sum_{d}N_{a}^{(1)}N_{d}^{(2)}\\
\sum_{c}N_{b}^{(2)}N_{c}^{(1)} & \sum_{d}-N_{b}^{(2)}N_{d}^{(2)}
\end{bmatrix}\varepsilon\tilde{\mathbf{N}}^{(1)}\right.\\
 & +\begin{bmatrix}\sum_{c}-N_{a}^{(1)} & \sum_{d}0\\
\sum_{c}N_{b}^{(2)} & \sum_{d}0
\end{bmatrix}t_{n}\left(\mathbf{A}_{c}^{(1)}+\bar{\mathbf{M}}_{c}^{(1)}\cdot\mathbf{N}^{(1)}\right)\\
 & +\begin{bmatrix}\sum_{c}0 & \sum_{d}0\\
\sum_{c}N_{c}^{(1)} & \sum_{d}-N_{d}^{(2)}
\end{bmatrix}t_{n}\bar{\mathbf{M}}_{b}^{(2)}\\
 & \left.+\begin{bmatrix}\sum_{c}0 & \sum_{d}0\\
\sum_{c}G_{bc} & \sum_{d}0
\end{bmatrix}t_{n}\mathbf{N}^{(1)}\right)J_{\eta}^{(1)}\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\label{eq:frictionless-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{\mathbf{N}}^{(1)} & =\mathbf{n}^{(1)}\otimes\bar{\mathbf{N}}^{(1)}\cdot\mathbf{n}^{(1)}\\
\bar{\mathbf{M}}_{c}^{(1)} & =\mathbf{n}^{(1)}\otimes\bar{\mathbf{m}}_{c}^{(1)}\\
\bar{\mathbf{M}}_{b}^{(2)} & =-\mathbf{n}^{(1)}\otimes\bar{\mathbf{m}}_{b}^{(2)}\\
G_{bc} & =ga^{\alpha\beta}\frac{\partial N_{b}}{\partial\eta_{(2)}^{\alpha}}\frac{\partial N_{c}}{\partial\eta_{(1)}^{\beta}}
\end{aligned}
\end{equation}

\end_inset

and it is apparent that the resulting frictionless stiffness matrix is also
 nonsymmetric.
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictionless-stiffness"

\end_inset

 is very similar to that which may be found by reducing our previous frictionles
s biphasic contact algorithm to the case of contact between two nonporous
 solids (eliminating all fluid degrees of freedom) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

, although the present framework is more general, since that previous study
 evaluated expressions in the limit as 
\begin_inset Formula $g\to0$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Frictional Terms
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Frictional-Terms"

\end_inset


\end_layout

\begin_layout Standard
The linearization of the frictional contribution follows from the second
 term of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-contact-int-split"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}^{t}= & \int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{0} & \frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}}\end{bmatrix}\cdot\begin{bmatrix}\mu t_{n}\mathbf{s}^{(1)}\\
-\mu t_{n}\mathbf{s}^{(1)}
\end{bmatrix}D\eta_{(2)}^{\alpha}J_{\eta}^{(1)}\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}\mu t_{n}\mathbf{s}^{(1)}\\
-\mu t_{n}\mathbf{s}^{(1)}
\end{bmatrix}DJ_{\eta}^{(1)}\right.\\
 & \left.+\begin{bmatrix}\mu\mathbf{s}^{(1)}\\
-\mu\mathbf{s}^{(1)}
\end{bmatrix}Dt_{n}J_{\eta}^{(1)}+\begin{bmatrix}\mu t_{n}\\
-\mu t_{n}
\end{bmatrix}D\mathbf{s}^{(1)}J_{\eta}^{(1)}\right)\,d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\end{equation}

\end_inset

The remaining quantity to be determined in this expression is the linearization
 
\begin_inset Formula $D\mathbf{s}^{(1)}$
\end_inset

; according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Ds"

\end_inset

, 
\begin_inset Formula $D\dot{\mathbf{n}}^{(1)}$
\end_inset

 must also be evaluated.
 As 
\begin_inset Formula $\dot{\mathbf{n}}^{(1)}$
\end_inset

 depends on 
\begin_inset Formula $\dot{\mathbf{g}}_{\alpha}^{(1)}$
\end_inset

 via eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:n_dot"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we must first propose a temporal discretization scheme for these rate
 quantities.
 
\end_layout

\begin_layout Standard
In a similar fashion to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Euler-integration"

\end_inset

, let the material time derivative in the material frame of the covariant
 basis vectors of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 be discretized as
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{g}}_{\alpha}^{(1)}\approx\frac{\mathbf{g}_{\alpha}^{(1)}\left(\eta_{(i)}^{\beta},t\right)-\mathbf{g}_{\alpha}^{(1)}\left(\eta_{(i)}^{\beta},t-\Delta t\right)}{\Delta t}=\frac{\Delta\mathbf{g}_{\alpha}^{(1)}}{\Delta t}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta\mathbf{g}_{\alpha}^{(1)}$
\end_inset

 denotes the change in 
\begin_inset Formula $\mathbf{g}_{\alpha}^{(1)}$
\end_inset

 from the previous time step.
 A temporally discretized form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:n_dot"
plural "false"
caps "false"
noprefix "false"

\end_inset

 may now be written as
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{n}}^{(1)}\approx\frac{1}{\Delta t}\mathbf{c}^{(1)}\label{eq:ndot-euler}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{c}^{(1)} & =\frac{1}{J_{\eta}^{(1)}}\mathbf{P}_{N}\cdot\mathbf{m}^{(1)}\\
\mathbf{m}^{(1)} & =\Delta\mathbf{g}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}+\mathbf{g}_{1}^{(1)}\times\Delta\mathbf{g}_{2}^{(1)}
\end{aligned}
\end{equation}

\end_inset

The directional derivative of 
\begin_inset Formula $\dot{\mathbf{n}}^{(1)}$
\end_inset

 may now be evaluated as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\dot{\mathbf{n}}^{(1)}= & \frac{1}{\Delta t}\begin{bmatrix}\sum_{c}\mathbf{Q}^{(1)}\cdot\mathbf{P}_{N}\cdot\mathbf{A}_{c}^{(1)}-\mathbf{P}_{N}\cdot\left(\mathbf{A}_{c}^{(1)}+\bar{\mathbf{A}}_{c}^{(1)}\right)-\mathbf{c}^{(1)}\otimes\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}\\
\sum_{d}\mathbf{0}
\end{bmatrix}^{T}\\
 & \cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{Q}^{(1)}=\frac{1}{J_{\eta}^{(1)}}\left(\left(\mathbf{n}^{(1)}\cdot\mathbf{m}^{(1)}\right)\mathbf{I}+\mathbf{n}^{(1)}\otimes\mathbf{m}^{(1)}\right)
\end{equation}

\end_inset

and 
\begin_inset Formula $\bar{\mathbf{A}}_{c}^{(1)}$
\end_inset

 is defined by analogy with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Ac"

\end_inset

 to be
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{A}}_{c}^{(1)}=\frac{1}{J_{\eta}^{(1)}}\left(\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{1}}\Delta\hat{\mathbf{g}}_{2}^{(1)}-\frac{\partial N_{c}^{(1)}}{\partial\eta_{(1)}^{2}}\Delta\hat{\mathbf{g}}_{1}^{(1)}\right)\,,
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta\hat{\mathbf{g}}_{\alpha}^{(1)}$
\end_inset

 is a skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\Delta\mathbf{g}_{\alpha}^{(1)}$
\end_inset

.
\end_layout

\begin_layout Standard
Utilizing the discrete-time equations Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Euler-integration"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ndot-euler"

\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:vr"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we find 
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{r}\approx\frac{\mathbf{r}^{(1)}}{\Delta t}=\frac{g\mathbf{c}^{(1)}+\Delta\mathbf{x}^{(1)}-\Delta\mathbf{x}^{(2)}}{\Delta t}
\end{equation}

\end_inset

and thus eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Ds"

\end_inset

 may be discretized in time, 
\begin_inset Formula 
\begin{equation}
D\mathbf{s}^{(1)}=\mathbf{P}_{S}\cdot\left(D\mathbf{P}_{N}\cdot\mathbf{r}^{(1)}+\mathbf{P}_{N}\cdot D\mathbf{r}^{(1)}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $D\mathbf{r}^{(1)}=Dg\,\mathbf{c}^{(1)}+g\,D\mathbf{c}^{(1)}+\Delta\mathbf{u}^{(1)}-\Delta\mathbf{u}^{(2)}$
\end_inset

 and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left|\mathbf{P}_{N}\cdot\mathbf{v}^{r}\right| & =\frac{\Delta h}{\Delta t}\\
\mathbf{P}_{S} & =\frac{1}{\Delta h}\left(\mathbf{I}-\mathbf{s}^{(1)}\otimes\mathbf{s}^{(1)}\right)
\end{aligned}
\label{eq:delta-h}
\end{equation}

\end_inset

In eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:delta-h"

\end_inset

, 
\begin_inset Formula $\Delta h$
\end_inset

 is a spatial increment defined to simplify notation and 
\begin_inset Formula $\mathbf{P}_{S}$
\end_inset

 is a projection tensor.
\end_layout

\begin_layout Standard
Defining the tensors
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{R}^{(1)} & =\frac{1}{g}\left(\left(\mathbf{n}^{(1)}\cdot\mathbf{r}^{(1)}\right)\mathbf{I}+\mathbf{n}^{(1)}\otimes\mathbf{r}^{(1)}\right)\\
\mathbf{B}^{(1)} & =\mathbf{P}_{S}\cdot\mathbf{c}^{(1)}\otimes\bar{\mathbf{N}}^{(1)}\cdot\mathbf{n}^{(1)}-\mathbf{P}_{S}\cdot\mathbf{P}_{N}\\
\mathbf{L}^{(1)} & =g\mathbf{P}_{S}\cdot\left(\mathbf{P}_{N}\cdot\mathbf{Q}^{(1)}+\mathbf{R}^{(1)}-\mathbf{I}\right)\cdot\mathbf{P}_{N}\\
\mathbf{J}_{c}^{(1)} & =\mathbf{L}^{(1)}\cdot\mathbf{A}_{c}^{(1)}-g\mathbf{P}_{S}\cdot\mathbf{P}_{N}\cdot\bar{\mathbf{A}}_{c}^{(1)}
\end{aligned}
\end{equation}

\end_inset

and vectors
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{h}_{c+}^{(1)} & =\mathbf{N}^{(1)}\cdot\bar{\mathbf{m}}_{c}^{(1)}+\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}\\
\mathbf{h}_{c-}^{(1)} & =\mathbf{N}^{(1)}\cdot\bar{\mathbf{m}}_{c}^{(1)}-\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}
\end{aligned}
\,,
\end{equation}

\end_inset

the directional derivative 
\begin_inset Formula $D\mathbf{s}^{(1)}$
\end_inset

 may be written fairly compactly as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{s}^{(1)}= & \begin{bmatrix}\sum_{c}-N_{c}^{(1)}\mathbf{B}^{(1)}-g\mathbf{P}_{S}\cdot\mathbf{c}^{(1)}\otimes\mathbf{h}_{c+}^{(1)}+\mathbf{J}_{c}^{(1)} & \sum_{d}N_{d}^{(2)}\mathbf{B}^{(1)}\end{bmatrix}\\
 & \cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\end{equation}

\end_inset

Finally, the tangential stiffness matrix is found to be
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}^{t}= & \begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b}^{(2)}\end{bmatrix}\\
 & \cdot\int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\sum_{c}-N_{a}^{(1)}N_{c}^{(1)} & \sum_{d}N_{a}^{(1)}N_{d}^{(2)}\\
\sum_{c}N_{b}^{(2)}N_{c}^{(1)} & \sum_{d}-N_{b}^{(2)}N_{d}^{(2)}
\end{bmatrix}\mu\left(\varepsilon\tilde{\mathbf{S}}^{(1)}+t_{n}\mathbf{B}^{(1)}\right)\right.\\
 & +\begin{bmatrix}\sum_{c}-N_{a}^{(1)} & \sum_{d}0\\
\sum_{c}N_{b}^{(2)} & \sum_{d}0
\end{bmatrix}\mu t_{n}\Big(\mathbf{s}^{(1)}\otimes\mathbf{h}_{c-}^{(1)}+g\mathbf{P}_{S}\cdot\mathbf{c}^{(1)}\otimes\mathbf{h}_{c+}^{(1)}-\mathbf{J}_{c}^{(1)}\Big)\\
 & +\begin{bmatrix}\sum_{c}0 & \sum_{d}0\\
\sum_{c}N_{c}^{(1)} & \sum_{d}-N_{d}^{(2)}
\end{bmatrix}\mu t_{n}\left(-\mathbf{s}^{(1)}\otimes\bar{\mathbf{m}}_{b}^{(2)}\right)\\
 & \left.+\begin{bmatrix}\sum_{c}0 & \sum_{d}0\\
\sum_{c}G_{bc} & \sum_{d}0
\end{bmatrix}\mu t_{n}\mathbf{S}^{(1)}\right)\,J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\label{eq:frictional-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{S}^{(1)} & =\mathbf{s}^{(1)}\otimes\mathbf{n}^{(1)}\\
\tilde{\mathbf{S}}^{(1)} & =\mathbf{s}^{(1)}\otimes\bar{\mathbf{N}}^{(1)}\cdot\mathbf{n}^{(1)}
\end{aligned}
\end{equation}

\end_inset

The stiffness matrix of the frictional contribution to the virtual work,
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictional-stiffness"

\end_inset

, is nonsymmetric.
 Summing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictionless-stiffness"

\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictional-stiffness"

\end_inset

 produces the total stiffness matrix for the case of frictional slip, which
 is also nonsymmetric.
\end_layout

\begin_layout Subsubsection
Integration Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:SE-Integration-Scheme"

\end_inset


\end_layout

\begin_layout Standard
In this formulation, a Gaussian quadrature integration scheme is adopted.
 The general form of the contact integral (e.g.
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-discretized"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-discretized-2"

\end_inset

) may be integrated numerically as
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum_{e=1}^{n_{e}^{(1)}}\sum_{k=1}^{n_{int}^{(e)}}W_{k}J_{\eta}^{(1)}\begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b,k}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\mathbf{f}_{a}^{(1)}\\
\mathbf{f}_{b,k}^{(2)}
\end{bmatrix}
\end{equation}

\end_inset

where 
\begin_inset Formula $n_{e}^{(1)}$
\end_inset

 is the number of element faces on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, 
\begin_inset Formula $n_{int}^{(e)}$
\end_inset

 is the number of integration points on the 
\begin_inset Formula $e\text{th}$
\end_inset

 element face of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, 
\begin_inset Formula $W_{k}$
\end_inset

 is the weight associated with the 
\begin_inset Formula $k\text{th}$
\end_inset

 integration point, and where it should be understood that terms associated
 with 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 (such as 
\begin_inset Formula $J_{\eta}^{(1)}$
\end_inset

, 
\begin_inset Formula $\delta\mathbf{v}_{a}^{(1)}$
\end_inset

, etc.) are evaluated at the parametric coordinates 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

, associated with the 
\begin_inset Formula $k\text{th }$
\end_inset

 integration point, and terms associated with 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 (such as 
\begin_inset Formula $\mathbf{f}_{b,k}^{(2)}$
\end_inset

) are evaluated at the parametric coordinates of contact 
\begin_inset Formula $\eta_{(2)p}^{\alpha}$
\end_inset

 or 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

, defined by Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for cases of stick and slip, respectively.
 The subscript 
\begin_inset Formula $k$
\end_inset

 appearing in the terms associated with 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 has been added to emphasize that there may be up to 
\begin_inset Formula $n_{int}^{(e)}$
\end_inset

 distinct element faces on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 associated with all the integration points on the 
\begin_inset Formula $e\text{th}$
\end_inset

 element face of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, based on the location of the contact point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 as defined by either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick_x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

 or 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip_x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
In a similar fashion, the contact stiffness may be integrated numerically
 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}= & \sum_{e=1}^{n_{e}^{(1)}}\sum_{k=1}^{n_{int}^{(e)}}W_{k}J_{\eta}^{(1)}\begin{bmatrix}\sum_{a}\delta\mathbf{v}_{a}^{(1)} & \sum_{b}\delta\mathbf{v}_{b,k}^{(2)}\end{bmatrix}\\
 & \cdot\begin{bmatrix}\sum_{c}\mathbf{K}_{ac}^{(1,1)} & \sum_{d}\mathbf{K}_{ad,k}^{(1,2)}\\
\sum_{c}\mathbf{K}_{bc,k}^{(2,1)} & \sum_{d}\mathbf{K}_{bd,k}^{(2,2)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d,k}^{(2)}
\end{bmatrix}
\end{aligned}
\end{equation}

\end_inset

where the matrix of tensors 
\begin_inset Formula $\mathbf{K}_{ab}^{(i,j)}$
\end_inset

 is a general representation of the stiffness terms given explicitly in
 either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-stiffness"

\end_inset

 or Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictionless-stiffness"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictional-stiffness"

\end_inset

.
 In this expression, 
\begin_inset Formula $\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)} & \Delta\mathbf{u}_{d,k}^{(2)}\end{bmatrix}^{T}$
\end_inset

 is the vector of incremental changes in the degrees of freedom of the 
\begin_inset Formula $c\text{th}$
\end_inset

 node of the 
\begin_inset Formula $e\text{th }$
\end_inset

 element face on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, and the 
\begin_inset Formula $d\text{th }$
\end_inset

 node of the element face on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 which contains the contact point 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 associated with the 
\begin_inset Formula $k\text{th }$
\end_inset

 integration point on the 
\begin_inset Formula $e\text{th}$
\end_inset

 element face of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

; the specific form of 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 will be dictated by the stick/slip status.
 A more detailed treatment of Gaussian quadrature, and a discussion of the
 benefits of this scheme versus nodal integration, may be found in our previous
 work 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "true"

\end_inset

.
\end_layout

\begin_layout Section
Biphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Contact"

\end_inset


\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

 for a review of biphasic materials, reference 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

 for additional details on biphasic frictionless contact, and reference
 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21a"
literal "false"

\end_inset

 for biphasic frictional contact.
 The presentation here follows that of 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21a"
literal "false"

\end_inset

.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

 and solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\int_{\gamma^{(1)}}\left(\left(\delta\mathbf{v}^{(1)}-\delta\mathbf{v}^{(2)}\right)\cdot\mathbf{t}^{(1)}+\left(\delta p^{(1)}-\delta p^{(2)}\right)w_{n}\right)da^{(1)}\label{eq:contact-int}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 is the contact traction on the primary surface, which is equal and opposite
 to that on the secondary surface, 
\begin_inset Formula $\mathbf{t}^{(1)}=-\mathbf{t}^{(2)}$
\end_inset

; 
\begin_inset Formula $w_{n}\equiv w_{n}^{(1)}$
\end_inset

 is the outward normal component of the fluid flux 
\begin_inset Formula $\mathbf{w}^{(1)}$
\end_inset

 from the primary surface, 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 are virtual velocities, 
\begin_inset Formula $\delta p^{(i)}$
\end_inset

 are virtual fluid pressures, and 
\begin_inset Formula $da^{(1)}$
\end_inset

 is an elemental area on the primary surface 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

.
 The contact integral is then written over the invariant parametric space
 of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, which is denoted by 
\begin_inset Formula $\Gamma_{\eta}^{(1)}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "false"

\end_inset

, facilitating its linearization as required for use with an iterative solution
 method such as Newton's method.
 The elemental area is given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}da^{(1)} & =J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}, & J_{\eta}^{(1)} & =\left|\mathbf{g}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}\right|\end{aligned}
\label{eq:da-jeta}
\end{equation}

\end_inset

using the covariant basis vectors
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{(i)}=\frac{\partial\mathbf{x}^{(i)}}{\partial\eta_{(i)}^{\alpha}}\label{eq:basis-vectors}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{(i)}\left(\eta_{(i)}^{\alpha},t\right)$
\end_inset

 is the spatial representation of surface 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

 as it deforms in time 
\begin_inset Formula $t$
\end_inset

, in terms of contravariant surface parametric coordinates 
\begin_inset Formula $\eta_{(i)}^{\alpha}$
\end_inset

.
 Casting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int"

\end_inset

 into convenient matrix notation and switching the domain of integration
 to the parametric frame yields the invariant biphasic contact integral
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta p^{(1)}\end{bmatrix}\cdot\begin{bmatrix}\mathbf{t}^{(1)}\\
w_{n}
\end{bmatrix}+\begin{bmatrix}\delta\mathbf{v}^{(2)} & \delta p^{(2)}\end{bmatrix}\cdot\begin{bmatrix}-\mathbf{t}^{(1)}\\
-w_{n}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\label{eq:contact-int-invariant-1}
\end{equation}

\end_inset

Since 
\begin_inset Formula $\Gamma_{\eta}^{(1)}$
\end_inset

 represents an invariant material frame, the linearization of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 can be accomplished by applying the directional derivative operator directly
 to the integrand,
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\int_{\Gamma_{\eta}^{(1)}}D\left(\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta p^{(1)}\end{bmatrix}\cdot\begin{bmatrix}\mathbf{t}^{(1)}\\
w_{n}
\end{bmatrix}J_{\eta}^{(1)}+\begin{bmatrix}\delta\mathbf{v}^{(2)} & \delta p^{(2)}\end{bmatrix}\cdot\begin{bmatrix}-\mathbf{t}^{(1)}\\
-w_{n}
\end{bmatrix}J_{\eta}^{(1)}\right)d\eta_{(1)}^{1}d\eta_{(1)}^{2}\label{eq:D-contact-int}
\end{equation}

\end_inset

where it is understood that for any function 
\begin_inset Formula $f$
\end_inset

 in this biphasic analysis,
\begin_inset Formula 
\begin{equation}
Df\equiv\sum_{i=1}^{2}Df\left[\Delta\mathbf{u}^{(i)}\right]+Df\left[\Delta p^{(i)}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Biphasic Friction Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Frictional-Formulation"

\end_inset


\end_layout

\begin_layout Standard
An examination of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reveals that a contact framework must provide expressions for both the
 normal fluid flux 
\begin_inset Formula $w_{n}$
\end_inset

 and the contact traction 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

.
 For the contact traction, this work implements a Coulomb-like framework
 for frictional contact 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 In this framework the relationship between sticking and slipping, and thus
 the contact traction 
\begin_inset Formula $\mathbf{t}^{(i)}$
\end_inset

 on the opposing surfaces, is described by a slip criterion 
\begin_inset Formula $\Psi$
\end_inset

, where on the primary surface
\begin_inset Formula 
\begin{equation}
\Psi=\left|\mathbf{t}_{T}^{(1)}\right|-\mu_{\text{eff}}\left|t_{n}\right|
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mu_{\text{eff}}=\mu_{\text{eq}}\left[1+\left(1-\varphi\right)\frac{p}{t_{n}}\right]\label{eq:mueff-biphasic}
\end{equation}

\end_inset

Here, 
\begin_inset Formula $t_{n}=\mathbf{t}^{(1)}\cdot\mathbf{n}^{(1)}$
\end_inset

 is the normal component of the contact traction (negative in compression),
 
\begin_inset Formula $\mathbf{t}_{T}^{(1)}=\mathbf{t}^{(1)}-t_{n}\mathbf{n}^{(1)}$
\end_inset

 is the tangential component of the contact traction, and the effective
 friction coefficient 
\begin_inset Formula $\mu_{\text{eff}}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mueff-biphasic"

\end_inset

 with no distinction made between static and kinetic coefficients of friction.
 The user-defined parameter 
\begin_inset Formula $\mu_{\text{eq}}$
\end_inset

 represents the friction coefficient when the fluid pressure has subsided
 (
\begin_inset Formula $p=0$
\end_inset

), whereas the user-defined parameter 
\begin_inset Formula $\varphi$
\end_inset

 represents the fraction of the apparent contact area where solid-on-solid
 contact takes place 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09b"
literal "false"

\end_inset

.
 The ratio 
\begin_inset Formula $-p/t_{n}$
\end_inset

 represents the local fluid load support at each point on the contact surface.
 Since the friction coefficient 
\begin_inset Formula $\mu_{\text{eff}}$
\end_inset

 cannot be negative, the theoretical upper bound on the local fluid load
 support is 
\begin_inset Formula $\left.-p/t_{n}\right|_{\max}=\left(1-\varphi\right)^{-1}$
\end_inset

.
 This upper bound is enforced whenever numerical errors produce a greater
 value of the local fluid load support.
\end_layout

\begin_layout Standard
The value of the slip criterion determines the stick-slip status via
\begin_inset Formula 
\begin{equation}
\Psi\begin{cases}
<0 & \text{sticking}\\
=0 & \text{slipping}
\end{cases}\label{eq:slip-criterion-1}
\end{equation}

\end_inset

Following our prior study 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

, this work treats stick and slip separately, controlled by an exact return
 mapping predicated on the value of the slip criterion.
 The return mapping defines a rule for correcting a calculated stick traction
 which exceeds the slip limit and is thus not permissible.
 Stick is treated as a special case of a tied biphasic interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Tied-Biphasic-Contact"
plural "false"
caps "false"
noprefix "false"

\end_inset

), whereas in slip the traction is directly prescribed as a natural boundary
 condition.
 The formulation of biphasic frictional contact is presented for both penalty
 and augmented Lagrangian regularization schemes.
\end_layout

\begin_layout Subsection
Contact Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Gap-Function"

\end_inset


\end_layout

\begin_layout Subsubsection
Slip Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Slip-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
The kinematics of slip are developed by mapping points between the surfaces
 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

 as they move relative to one another.
 The relationship between spatial points 
\begin_inset Formula $\mathbf{x}^{(i)}\left(\eta_{(i)}^{\alpha},t\right)$
\end_inset

 on each surface is given by
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{(2)}=\mathbf{x}^{(1)}+g\mathbf{n}^{(1)}\label{eq:slip-x2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}^{(1)}$
\end_inset

 is the unit outward normal to 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 given by
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{(1)}=\frac{\mathbf{g}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}}{\left|\mathbf{g}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}\right|}\label{eq:n-1}
\end{equation}

\end_inset

and the gap function 
\begin_inset Formula $g$
\end_inset

 is defined as
\begin_inset Formula 
\begin{equation}
g=\left(\mathbf{x}^{(2)}-\mathbf{x}^{(1)}\right)\cdot\mathbf{n}^{(1)}\label{eq:slip-gap}
\end{equation}

\end_inset

Here we note that 
\begin_inset Formula $\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)$
\end_inset

 is the spatial position of a material point 
\begin_inset Formula $X^{(1)}$
\end_inset

 on the primary surface, and 
\begin_inset Formula $\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)$
\end_inset

 is the corresponding spatial intersection point on the secondary surface,
 through which different material points 
\begin_inset Formula $X^{(2)}$
\end_inset

 identified by parametric coordinates 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 may convect.
 At any given instant, 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 are termed the parametric coordinates of intersection.
\end_layout

\begin_layout Subsubsection
Stick Kinematics
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Stick-Kinematics"

\end_inset


\end_layout

\begin_layout Standard
Implicit in the concept of stick is the assumption that the contact projection
 was previously resolved; thus points are not mapped between surfaces during
 stick.
 Rather, the current contact point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 is given by the parametric coordinates of intersection 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 from the previous time point, now denoted as 
\begin_inset Formula $\eta_{(2)p}^{\alpha}$
\end_inset

 with the subscripted 
\begin_inset Formula $p$
\end_inset

 referring to the previous time.
 The spatial position of the material point 
\begin_inset Formula $X^{(2)}$
\end_inset

 identified by 
\begin_inset Formula $\eta_{(2)p}^{\alpha}$
\end_inset

 is then given by
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{s}^{(2)}=\mathbf{x}^{(2)}\left(\eta_{(2)p}^{\alpha},t\right)=\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)+\mathbf{g}_{s}\label{eq:stick-x2}
\end{equation}

\end_inset

where the vector gap 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 in stick is defined to be
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{s}=\mathbf{x}_{s}^{(2)}-\mathbf{x}^{(1)}\label{eq:stick-gap}
\end{equation}

\end_inset

Here 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 is the vectorial distance, at the current time 
\begin_inset Formula $t$
\end_inset

, between material points which were in contact at the previous time step;
 for perfect stick we must have 
\begin_inset Formula $\mathbf{g}_{s}=\mathbf{0}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Velocities
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Velocities"

\end_inset


\end_layout

\begin_layout Standard
Coulomb's law of kinetic friction requires that the friction force be aligned
 with the relative slip velocity between the two surfaces.
 Despite the name, Coulomb's law is a constitutive relation, and hence must
 obey the Principle of Material-Frame Indifference; this requires a frame-invari
ant relative velocity.
 As points in stick do not experience relative motion, the development of
 velocities below is only concerned with opposing contact points in slip.
\end_layout

\begin_layout Standard
As parametric coordinates 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

 of integration points on the primary surface 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 represent material points, the velocity 
\begin_inset Formula $\mathbf{v}^{(1)}$
\end_inset

 of these points is evaluated from the material time derivative in the material
 frame,
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)=\frac{\partial\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)}{\partial t}\label{eq:v1-1}
\end{equation}

\end_inset

In contrast, different material points 
\begin_inset Formula $X^{(2)}$
\end_inset

 may convect through the intersection point 
\begin_inset Formula $\mathbf{x}^{(2)}$
\end_inset

, and so the velocity 
\begin_inset Formula $\mathbf{v}^{(2)}$
\end_inset

 at the intersection point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 is evaluated from the material time derivative in the spatial frame,
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)=\frac{\partial\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)}{\partial t}+\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}\label{eq:v2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\partial\mathbf{x}^{(2)}/\partial t$
\end_inset

 represents the velocity of the intersection point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

, while 
\begin_inset Formula $\dot{\eta}_{(2)}^{\alpha}$
\end_inset

 are the contravariant components of the convective velocity of material
 passing through the intersection point 
\begin_inset Formula $\mathbf{x}^{(2)}$
\end_inset

.
 The quantity 
\begin_inset Formula $\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}$
\end_inset

 represents the relative slip velocity between the material on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 and that on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

.
 Importantly, by definition 
\begin_inset Formula $\partial\mathbf{x}^{(2)}/\partial t$
\end_inset

 is evaluated while holding 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 constant.
 From these relations, a more practical formulation of the slip velocity
 can be achieved 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 Taking the material time derivative of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-x2"

\end_inset

 and recalling the contact persistency condition 
\begin_inset Formula $\dot{g}=0$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers07"
literal "false"

\end_inset

 produces 
\begin_inset Formula $\mathbf{v}^{(2)}=\mathbf{v}^{(1)}+g\dot{\mathbf{n}}^{(1)}.$
\end_inset

 Substituting Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:v1-1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:v2"

\end_inset

 into this expression yields the desired frame-invariant measure of relative
 velocity between 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier95"
literal "false"

\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{r}\equiv\dot{\eta}_{(2)}^{\alpha}\mathbf{g}_{\alpha}^{(2)}=g\dot{\mathbf{n}}^{(1)}+\frac{\partial\mathbf{x}^{(1)}\left(\eta_{(1)}^{\alpha},t\right)}{\partial t}-\frac{\partial\mathbf{x}^{(2)}\left(\eta_{(2)}^{\alpha},t\right)}{\partial t},
\end{equation}

\end_inset

where 
\begin_inset Formula $\dot{\mathbf{n}}^{(1)}$
\end_inset

 is evaluated from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:n-1"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{n}}^{(1)}=\mathbf{P}_{N}\cdot\frac{\dot{\mathbf{g}}_{1}^{(1)}\times\mathbf{g}_{2}^{(1)}+\mathbf{g}_{1}^{(1)}\times\dot{\mathbf{g}}_{2}^{(1)}}{J_{\eta}^{(1)}}\,.
\end{equation}

\end_inset

Here, 
\begin_inset Formula $\dot{\mathbf{g}}_{\alpha}^{(1)}$
\end_inset

 is the material time derivative of 
\begin_inset Formula $\mathbf{g}_{\alpha}^{(1)}$
\end_inset

 in the material frame, evaluated from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:basis-vectors"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{g}}_{\alpha}^{(1)}\left(\eta_{\left(1\right)}^{\beta},t\right)=\frac{\partial\mathbf{g}_{\alpha}^{(1)}\left(\eta_{\left(1\right)}^{\beta},t\right)}{\partial t}\,,
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{P}_{N}$
\end_inset

 is the tangential plane projection tensor,
\begin_inset Formula 
\begin{equation}
\mathbf{P}_{N}=\mathbf{I}-\mathbf{n}^{(1)}\otimes\mathbf{n}^{(1)}\,.
\end{equation}

\end_inset

A unit vector in the slip direction can then be found by projecting the
 relative velocity 
\begin_inset Formula $\mathbf{v}^{r}$
\end_inset

 onto the tangent plane of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, yielding
\begin_inset Formula 
\begin{equation}
\mathbf{s}^{(1)}=\frac{\mathbf{P}_{N}^{(1)}\cdot\mathbf{v}^{r}}{\left|\mathbf{P}_{N}^{(1)}\cdot\mathbf{v}^{r}\right|}\,.\label{eq:s-def}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Penalty Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
The defining characteristic of frictional stick is a lack of relative motion
 between points which were previously in contact.
 Consequently, the stick traction is obtained by penalizing relative motion
 between such points,
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\varepsilon\mathbf{g}_{s}\,,\label{eq:stick-traction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the contact penalty parameter and we have utilized eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to define the gap vector 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

 during stick.
\end_layout

\begin_layout Standard
During slip, the normal component of the contact traction is first calculated
 by penalizing the normal component 
\begin_inset Formula $g$
\end_inset

 of the gap, given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

,
\begin_inset Formula 
\begin{equation}
t_{n}=\varepsilon g\,.\label{eq:slip-tn}
\end{equation}

\end_inset

The total traction vector in slip is then directly prescribed as
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=t_{n}\left(\mathbf{n}^{(1)}+\mu_{\text{eff}}\mathbf{s}^{(1)}\right)\,,\label{eq:slip-traction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{s}^{(1)}$
\end_inset

 is the unit vector in the slip direction, given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s-def"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We note that eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-traction"

\end_inset

 has the same form as the classical Coulomb friction considered in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Sliding-Elastic"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

, with the standard Coulomb friction coefficient replaced by 
\begin_inset Formula $\mu_{\text{eff}}$
\end_inset

, as evaluated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mueff-biphasic"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A trial state and return map, adapted from Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Stick-Slip-Algorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

 and presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SB-Stick-Slip-Algorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

, is employed to differentiate between stick and slip.
\end_layout

\begin_layout Standard
The jump conditions for a biphasic mixture require continuity of the fluid
 pressure across an interface and therefore an expression for the normal
 fluid flux 
\begin_inset Formula $w_{n}$
\end_inset

 can be obtained by penalizing the fluid pressure gap 
\begin_inset Formula $\pi$
\end_inset

 between contacting points 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "false"

\end_inset

,
\begin_inset Formula 
\begin{equation}
\begin{aligned}w_{n} & =\varepsilon_{p}\pi\,, & t_{n}<0\\
p^{(i)} & =0\,, & t_{n}=0
\end{aligned}
\label{eq:wn}
\end{equation}

\end_inset

where 
\begin_inset Formula $p^{(i)}=0$
\end_inset

 prescribes zero fluid pressure (free-draining conditions) on the portions
 of the boundary where no contact takes place.
 We define the fluid pressure gap as 
\begin_inset Formula 
\begin{equation}
\pi=p^{(1)}-p^{(2)}\label{eq:pi-biphasic-penalty}
\end{equation}

\end_inset

and 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is the pressure penalty parameter which has units of hydraulic permeability
 per unit length (e.g.
 m
\begin_inset Formula $^{3}$
\end_inset

/N
\color black

\begin_inset Formula $\cdot$
\end_inset


\color inherit
s, similar to the hydraulic permeability of a membrane).
 Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"

\end_inset

 is valid for both stick and slip.
 Note that 
\begin_inset Formula $p^{\left(1\right)}=p^{\left(1\right)}\left(\eta_{\left(1\right)}^{\alpha}\right)$
\end_inset

 is evaluated at a point with parametric coordinates 
\begin_inset Formula $\eta_{\left(1\right)}^{\alpha}$
\end_inset

 on the primary surface, whereas the pressure on the secondary surface,
 
\begin_inset Formula $p^{(2)}=p^{(2)}\left(\eta_{(2)}^{\alpha},t\right)$
\end_inset

, is evaluated at the parametric coordinates of the intersection of a ray
 issued from that primary surface point and normal to 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

.
 As detailed previously 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

 and summarized in Section
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Biphasic-Gap-Function"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the parametric coordinates of intersection are dependent on the stick-slip
 status, so care must be taken to evaluate 
\begin_inset Formula $w_{n}$
\end_inset

 from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"

\end_inset

 using the contact kinematics determined by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-criterion-1"

\end_inset

.
 In practice this is accomplished by calculating 
\begin_inset Formula $w_{n}$
\end_inset

 once the stick-slip status has been resolved for each iteration.
\end_layout

\begin_layout Subsection
Augmented Lagrangian Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Augmented-Lagrangian"

\end_inset


\end_layout

\begin_layout Standard
The augmented Lagrangian scheme presented herein was developed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Augmented-Lagrangian"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

 as a modification of the approach proposed by Simo and Laursen 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo92"
literal "false"

\end_inset

.
 Briefly, this is a first-order augmentation scheme that utilizes Uzawa's
 algorithm 
\begin_inset CommandInset citation
LatexCommand citep
key "Bertsekas82"
literal "false"

\end_inset

, where the multipliers are updated outside of the Newton step, producing
 a double loop algorithm 
\begin_inset CommandInset citation
LatexCommand citep
key "Wriggers07"
literal "false"

\end_inset

 and preserving quadratic convergence of Newton's method near solution points.
\end_layout

\begin_layout Standard
During stick, the traction is calculated by augmenting the vector gap 
\begin_inset Formula $\mathbf{g}_{s}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\boldsymbol{\lambda}_{s}+\varepsilon\mathbf{g}_{s}\,,\label{eq:AL-stick-traction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 is the vectorial Lagrange multiplier in stick.
 In slip, the normal component of the contact traction is first calculated
 by augmenting the normal gap 
\begin_inset Formula $g$
\end_inset

,
\begin_inset Formula 
\begin{equation}
t_{n}=\lambda_{n}+\varepsilon g\,,\label{eq:AL-tn}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{n}$
\end_inset

 is the normal Lagrange multiplier.
 The total traction vector in slip is then directly prescribed as 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=t_{n}\left(\mathbf{n}^{(1)}+\mu_{\text{eff}}\mathbf{s}^{(1)}\right)\label{eq:augmented-t}
\end{equation}

\end_inset

where eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-tn"

\end_inset

 has been used.
 The update formulas for the Lagrange multipliers can be found in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Augmented-Lagrangian"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 Here it suffices to note that by augmenting only the normal gap and employing
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:augmented-t"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have ensured an exact mapping to the proper tangential traction in
 slip, which is consistent with the augmented normal traction.
 As in the penalty case, a trial state and return map, presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SB-Stick-Slip-Algorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and controlled by the slip criterion, is used to differentiate between
 stick and slip.
\end_layout

\begin_layout Standard
In this augmentation scheme, the normal fluid flux is given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}w_{n} & =\lambda_{p}+\varepsilon_{p}\pi\,, & t_{n}<0\\
p^{(i)} & =0\,, & t_{n}=0
\end{aligned}
\label{eq:AL-wn}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{p}$
\end_inset

 is the fluid pressure Lagrange multiplier, and the update formula for 
\begin_inset Formula $\lambda_{p}$
\end_inset

 has been detailed in our prior work on frictionless biphasic contact 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "false"

\end_inset

 and is given by
\begin_inset Formula 
\begin{equation}
\lambda_{p}\leftarrow\lambda_{p}+\varepsilon_{p}\pi
\end{equation}

\end_inset

Unlike 
\begin_inset Formula $\boldsymbol{\lambda}_{s}$
\end_inset

 and 
\begin_inset Formula $\lambda_{n}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

, 
\begin_inset Formula $\lambda_{p}$
\end_inset

 is not dependent on the stick-slip status.
 However, as noted before, eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-wn"

\end_inset

 must be evaluated after the stick-slip status has been resolved.
 
\end_layout

\begin_layout Subsection
Stick-Slip Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Stick-Slip-Algorithm"

\end_inset


\end_layout

\begin_layout Standard
Determining whether stick or slip is occurring at a given instant is accomplishe
d by a trial state and return map, and has the same form for both penalty
 and augmented Lagrangian regularization schemes 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 We initially assume stick and calculate a trial traction 
\begin_inset Formula $\tilde{\mathbf{t}}^{(1)}$
\end_inset

, utilizing either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-traction"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-stick-traction"

\end_inset

.
 The trial normal and tangential components 
\begin_inset Formula $\tilde{t}_{n}$
\end_inset

 and 
\begin_inset Formula $\tilde{\mathbf{t}}_{T}^{(1)}$
\end_inset

 are evaluated from 
\begin_inset Formula $\tilde{\mathbf{t}}^{(1)}$
\end_inset

 and inserted into the slip criterion 
\begin_inset Formula $\Psi$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\Psi=\left|\tilde{\mathbf{t}}_{T}^{(1)}\right|-\mu_{\text{eff}}\left|\tilde{t}_{n}\right|.
\end{equation}

\end_inset

Based on the slip criterion and trial traction vector, the traction vector
 is calculated from the return mapping as 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{(1)}=\begin{cases}
\tilde{\mathbf{t}}^{(1)} & \Psi<0\,,\quad\text{sticking}\\
t_{n}(\mathbf{n}^{(1)}+\mu_{\text{eff}}\mathbf{s}^{(1)}) & \Psi=0\,,\quad\text{slipping}
\end{cases}
\end{equation}

\end_inset

where 
\begin_inset Formula $t_{n}$
\end_inset

 is given by either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-tn"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-tn"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\mueff}{\mu_{\text{eff}}}
{\mu_{\text{eff}}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\mueq}{\mu_{\text{eq}}}
{\mu_{\text{eq}}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\mumin}{\mu_{\text{min}}}
{\mu_{\text{min}}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\no}{\mathbf{\mathbf{n}}^{(1)}}
{\mathbf{n}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\so}{\mathbf{s}^{(1)}}
{\text{\mathbf{s}}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\jeta}{J_{\eta}^{(1)}}
{J_{\eta}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\wn}{w_{n}^{(1)}}
{w_{n}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\jn}{j_{n}^{(1)}}
{j_{n}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Na}{N_{a}^{(1)}}
{N_{a}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nb}{N_{b}^{(2)}}
{N_{b}^{(2)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nc}{N_{c}^{(1)}}
{N_{c}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nd}{N_{d}^{(2)}}
{N_{d}^{(2)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\mc}{\bar{\mathbf{m}}_{c}^{(1)}}
{\bar{\mathbf{m}}_{c}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\mb}{\bar{\mathbf{m}}_{b}^{(2)}}
{\bar{\mathbf{m}}_{b}^{(2)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Mb}{\bar{\mathbf{M}}_{b}^{(2)}}
{\bar{\mathbf{M}}_{b}^{(2)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Mc}{\bar{\mathbf{M}}_{c}^{(1)}}
{\bar{\mathbf{M}}_{c}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Ac}{\mathbf{A}_{c}^{(1)}}
{\mathbf{A}_{c}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\No}{\mathbf{N}^{(1)}}
{\mathbf{N}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nbo}{\mathbf{\bar{\mathbf{N}}}^{(1)}}
{\bar{\mathbf{N}}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nt}{\tilde{\mathbf{\mathbf{N}}}^{(1)}}
{\tilde{\mathbf{N}}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\So}{\mathbf{\mathbf{S}}^{(1)}}
{\mathbf{S}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Sb}{\mathbf{\bar{\mathbf{S}}}^{(1)}}
{\bar{\mathbf{S}}^{(1)}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Nh}{\hat{\mathbf{N}}^{(1)}}
{\hat{\mathbf{N}}^{(1)}}
\end_inset


\end_layout

\begin_layout Subsection
Linearization and Discretization Outline
\begin_inset CommandInset label
LatexCommand label
name "subsec:SB-Linearization-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The following sections provide the linearization and discretization of stick
 and slip for biphasic frictional contact, culminating in the final forms
 of the residual vectors and stiffness matrices which have been implemented
 into FEBio.
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:SB-Definitions-Notation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 begins with an important discussion of kinematic definitions and notation
 which is assumed to hold without repetition.
 Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Stick"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Slip"
plural "false"
caps "false"
noprefix "false"

\end_inset

 linearize and discretize biphasic stick and slip, respectively.
 Importantly, Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Stick"
plural "false"
caps "false"
noprefix "false"

\end_inset

 sets up and uses more formal notation and definitions, before we dispense
 of this cumbersome notation for the remainder of the treatment.
 
\end_layout

\begin_layout Subsection
Definitions and Notation
\begin_inset CommandInset label
LatexCommand label
name "sec:SB-Definitions-Notation"

\end_inset


\end_layout

\begin_layout Standard
Evaluating the linearizations of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 requires directional derivatives of kinematic quantities, some of which
 depend on the stick-slip status.
 To simplify the presentation, the continuum linearization is presented
 only for a few select quantities.
 The remainder of the linearization is deferred until after discretization,
 as many expressions are much easier to manipulate in discretized form.
 To keep the equations more manageable, the discretization of slip is split
 into frictionless and frictional terms, and the final form of the stiffness
 matrices follows this split.
 The full model is easily obtained by summing the frictionless and frictional
 contributions.
 Here we emphasize that, as a consequence of the double-loop Uzawa algorithm
 discussed in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SB-Augmented-Lagrangian"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (reprised from 
\begin_inset CommandInset citation
LatexCommand cite
key "Zimmerman18"
literal "false"

\end_inset

), all Lagrange multipliers are updated outside of each Newton step, thus
 
\begin_inset Formula $D\lambda=0$
\end_inset

, where 
\begin_inset Formula $\lambda$
\end_inset

 is any Lagrange multiplier, i.e.
 
\begin_inset Formula $\lambda=\lambda_{n},\boldsymbol{\lambda}_{s},\lambda_{p}$
\end_inset

, etc.
 As a consequence, Lagrange multipliers do not appear in any of the linearized
 or discretized equations.
 In what follows, Greek indices are associated with covariant basis vectors
 on the contacting surfaces, and thus vary from 1 to 2.
 Repeated Greek indices indicate implicit summation over their range.
\end_layout

\begin_layout Standard
Many kinematic quantities remain unchanged from Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Sliding-Elastic"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on elastic frictional contact 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 We thus accept without repetition the definitions of 
\begin_inset Formula $\No$
\end_inset

, 
\begin_inset Formula $\Nbo$
\end_inset

, 
\begin_inset Formula $\mc$
\end_inset

, 
\begin_inset Formula $\mb$
\end_inset

, 
\begin_inset Formula $\Nt$
\end_inset

, 
\begin_inset Formula $\Mc$
\end_inset

, 
\begin_inset Formula $\Mb$
\end_inset

, 
\begin_inset Formula $\mathbf{c}^{(1)}$
\end_inset

, 
\begin_inset Formula $\mathbf{m}^{(1)}$
\end_inset

, 
\begin_inset Formula $\mathbf{Q}^{(1)}$
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{A}}_{c}^{(1)}$
\end_inset

, 
\begin_inset Formula $\Ac$
\end_inset

, 
\begin_inset Formula $\mathbf{P}_{N}$
\end_inset

, 
\begin_inset Formula $\mathbf{P}_{S},$
\end_inset

 
\begin_inset Formula $\mathbf{R}^{(1)}$
\end_inset

, 
\begin_inset Formula $\mathbf{B}^{(1)}$
\end_inset

, 
\begin_inset Formula $\mathbf{L}^{(1)}$
\end_inset

, 
\begin_inset Formula $\mathbf{J}_{c}^{(1)}$
\end_inset

, 
\begin_inset Formula $\So$
\end_inset

, and 
\begin_inset Formula $\tilde{\mathbf{S}}^{(1)}$
\end_inset

.
 These terms are all defined in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictionless-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictional-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 Directional derivatives which will not be duplicated here include 
\begin_inset Formula $D\no$
\end_inset

, 
\begin_inset Formula $D\dot{\mathbf{n}}^{(1)}$
\end_inset

, 
\begin_inset Formula $D\so$
\end_inset

, 
\begin_inset Formula $Dt_{n}=\varepsilon Dg$
\end_inset

, 
\begin_inset Formula $Dg$
\end_inset

, 
\begin_inset Formula $D\jeta$
\end_inset

, 
\begin_inset Formula $D\eta_{(2)}^{\alpha}$
\end_inset

, and 
\begin_inset Formula $D\mathbf{P}_{N}$
\end_inset

 (see Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Linearization"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictionless-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictional-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
The final residual vectors and stiffness matrices presented below are written
 in integral form.
 In the FEBio implementation, a Gaussian quadrature scheme is adopted to
 perform numerical integration.
 A detailed treatment of Gaussian quadrature, and equations for numerically
 integrating the contact integrals and stiffnesses, may be found in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Integration-Scheme"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
As a final implementation detail, we note that multiplying all biphasic
 entries in the residual vector and stiffness matrices by the time step
 leads to better convergence.
 In this context, biphasic refers to all terms which are not purely related
 to solid-solid contact.
 In the residual, this is all terms which are not 
\begin_inset Formula $\mathbf{f}_{m}^{(i)}$
\end_inset

 (see below).
 Similarly, this includes all stiffness entries except the solid-solid 
\begin_inset Formula $\mathbf{K}_{mn}^{(i,j)}$
\end_inset

 terms (see below).
\end_layout

\begin_layout Subsection
Biphasic Stick
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Stick"

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biph-Stick-Linearization"

\end_inset


\end_layout

\begin_layout Standard
In stick parametric coordinates are fixed on both surfaces, hence directional
 derivatives of 
\begin_inset Formula $\mathbf{x}^{(i)}$
\end_inset

, 
\begin_inset Formula $p^{(i)}$
\end_inset

, 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

, and 
\begin_inset Formula $\delta p^{(i)}$
\end_inset

 are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{(1)} & =\Delta\mathbf{u}^{(1)} & D\mathbf{x}^{(2)} & =\Delta\mathbf{u}^{(2)}\\
Dp^{(1)} & =\Delta p^{(1)} & Dp^{(2)} & =\Delta p^{(2)}\\
D\delta\mathbf{v}^{(1)} & =\mathbf{0} & D\delta\mathbf{v}^{(2)} & =\mathbf{0}\\
D\delta p^{(1)} & =0 & D\delta p^{(2)} & =0
\end{aligned}
\label{eq:biphasic-stick-linearization}
\end{equation}

\end_inset

From the definitions of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

, and utilizing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-linearization"

\end_inset

, it follows that
\begin_inset Formula 
\begin{equation}
D\mathbf{t}^{(1)}=\varepsilon\left(\Delta\mathbf{u}^{(2)}-\Delta\mathbf{u}^{(1)}\right)\,.\label{eq:biph-stick-Dt}
\end{equation}

\end_inset

Similarly, application of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-linearization"

\end_inset

 to Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pi-biphasic-penalty"
plural "false"
caps "false"
noprefix "false"

\end_inset

 yields
\begin_inset Formula 
\begin{equation}
Dw_{n}=\varepsilon_{p}\left(\Delta p^{(1)}-\Delta p^{(2)}\right)\label{eq:biph-stick-Dwn}
\end{equation}

\end_inset

The biphasic contact integral of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int"
plural "false"
caps "false"
noprefix "false"

\end_inset

, written over an invariant domain, can then be linearized directly to find
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c}= & \int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}1\\
-1
\end{bmatrix}D\mathbf{t}^{(1)}J_{\eta}^{(1)}+\begin{bmatrix}\mathbf{t}^{(1)}\\
-\mathbf{t}^{(1)}
\end{bmatrix}DJ_{\eta}^{(1)}\right)\right.\\
 & \left.+\begin{bmatrix}\delta p^{(1)} & \delta p^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}1\\
-1
\end{bmatrix}Dw_{n}J_{\eta}^{(1)}+\begin{bmatrix}w_{n}\\
-w_{n}
\end{bmatrix}DJ_{\eta}^{(1)}\right)\right)d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biph-cont-int-linearized}
\end{equation}

\end_inset

Note that for convenience, terms in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-cont-int-linearized"
plural "false"
caps "false"
noprefix "false"

\end_inset

 have been grouped differently than in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:D-contact-int"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biph-Stick-Discretization"

\end_inset


\end_layout

\begin_layout Standard
Let the continuous variables on the primary and secondary surfaces be interpolat
ed over element faces according to 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10,Zimmerman18"
literal "false"

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{(1)} & =\sum_{a=1}^{m^{(1)}}N_{a}^{(1)}\delta\mathbf{v}_{a}^{(1)} & \delta\mathbf{v}^{(2)} & =\sum_{b=1}^{m_{k}^{(2)}}N_{b}^{(2)}\delta\mathbf{v}_{b}^{(2)}\\
\Delta\mathbf{u}^{(1)} & =\sum_{c=1}^{m^{(1)}}N_{c}^{(1)}\Delta\mathbf{u}_{c}^{(1)} & \Delta\mathbf{u}^{(2)} & =\sum_{d=1}^{m_{k}^{(2)}}N_{d}^{(2)}\Delta\mathbf{u}_{d}^{(2)}\\
\delta p^{(1)} & =\sum_{a=1}^{m^{(1)}}N_{a}^{(1)}\delta p_{a}^{(1)} & \delta p^{(2)} & =\sum_{b=1}^{m_{k}^{(2)}}N_{b}^{(2)}\delta p_{b}^{(2)}\\
\Delta p^{(1)} & =\sum_{c=1}^{m^{(1)}}N_{c}^{(1)}\Delta p_{c}^{(1)} & \Delta p^{(2)} & =\sum_{d=1}^{m_{k}^{(2)}}N_{d}^{(2)}\Delta p_{d}^{(2)}
\end{aligned}
\label{eq:biphasic-stick-var-discretization}
\end{equation}

\end_inset

where 
\begin_inset Formula $N_{a}^{(i)}$
\end_inset

 represent interpolation functions on the element faces of 
\begin_inset Formula $\gamma^{(i)}$
\end_inset

, 
\begin_inset Formula $m^{(1)}$
\end_inset

 is the number of nodes and interpolation functions on each primary element
 face, 
\begin_inset Formula $m_{k}^{(2)}$
\end_inset

 is the number of nodes and interpolation functions on the secondary element
 face which is intersected by the ray issued from the 
\begin_inset Formula $k\text{th}$
\end_inset

 integration point on the primary element face, and 
\begin_inset Formula $\delta\mathbf{v}_{a}^{(i)}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{a}^{(i)}$
\end_inset

,
\begin_inset Formula $\delta p_{a}^{(i)}$
\end_inset

, and 
\begin_inset Formula $\Delta p_{a}^{(i)}$
\end_inset

 represent respective nodal values of 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

 , 
\begin_inset Formula $\Delta\mathbf{u}^{(i)}$
\end_inset

, 
\begin_inset Formula $\delta p^{(i)}$
\end_inset

, and 
\begin_inset Formula $\Delta p^{(i)}$
\end_inset

.
 From this point forward the summation signs will be written simply as 
\begin_inset Formula $\sum_{a}$
\end_inset

, where it is assumed they have the same meaning described above.
\end_layout

\begin_layout Standard
Inserting the discretization of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-var-discretization"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 yields
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum_{a}\begin{bmatrix}\delta\mathbf{v}_{a}^{(1)} & \delta p_{a}^{(1)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{a}^{(1)}\\
w_{a}^{(1)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\sum_{b}\begin{bmatrix}\delta\mathbf{v}_{b}^{(2)} & \delta p_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{b}^{(2)}\\
w_{b}^{(2)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biph-stick-int-disc}
\end{equation}

\end_inset

where the residuals are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{(1)}= & N_{a}^{(1)}\mathbf{t}^{(1)}\,, & \mathbf{f}_{b}^{(2)}= & -N_{b}^{(2)}\mathbf{t}^{(1)}\\
w_{a}^{(1)}= & N_{a}^{(1)}w_{n}\,\,, & w_{b}^{(2)}= & -N_{b}^{(2)}w_{n}
\end{aligned}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 is obtained from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the penalty case and from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-stick-traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 if augmented Lagrangian regularization is employed.
 Similarly, 
\begin_inset Formula $w_{n}$
\end_inset

 is calculated from either eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for penalty and augmented Lagrange methods, respectively.
 
\end_layout

\begin_layout Standard
We may now discretize individual terms and place them into matrix notation,
 anticipating their substitution into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-cont-int-linearized"

\end_inset

.
 By placing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-stick-int-disc"

\end_inset

 into Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-stick-Dt"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-stick-Dwn"

\end_inset

 and inserting the resulting linearizations into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-cont-int-linearized"

\end_inset

, we obtain the stiffness matrix for biphasic stick as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c} & =\sum_{a}\begin{bmatrix}\delta\mathbf{v}_{a}^{(1)} & \delta p_{a}^{(1)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{ac}^{(1,1)} & \mathbf{0}\\
\mathbf{g}_{ac}^{(1,1)} & g_{ac}^{(1,1)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{ad}^{(1,2)} & \mathbf{0}\\
\mathbf{g}_{ad}^{(1,2)} & g_{ad}^{(1,2)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\sum_{b}\begin{bmatrix}\delta\mathbf{v}_{b}^{(2)} & \delta p_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{bc}^{(2,1)} & \mathbf{0}\\
\mathbf{g}_{bc}^{(2,1)} & g_{bc}^{(2,1)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{bd}^{(2,2)} & \mathbf{0}\\
\mathbf{g}_{bd}^{(2,2)} & g_{bd}^{(2,2)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biphasic-stick-stiffness}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{(1,1)} & =-\varepsilon_{n}N_{a}^{(1)}N_{c}^{(1)}\mathbf{I}+N_{a}^{(1)}\mathbf{t}^{(1)}\otimes\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}\\
\mathbf{K}_{ad}^{(1,2)} & =\varepsilon_{n}N_{a}^{(1)}N_{d}^{(2)}\mathbf{I}\\
\mathbf{K}_{bc}^{(2,1)} & =\varepsilon_{n}N_{b}^{(2)}N_{c}^{(1)}\mathbf{I}-N_{b}^{(2)}\mathbf{t}^{(1)}\otimes\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)}\\
\mathbf{K}_{bd}^{(2,2)} & =-\varepsilon_{n}N_{b}^{(2)}N_{d}^{(2)}\mathbf{I}
\end{aligned}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{(1,1)} & =N_{a}^{(1)}w_{n}\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)} & g_{ac}^{(1,1)} & =\varepsilon_{p}N_{a}^{(1)}N_{c}^{(1)}\\
\mathbf{g}_{ad}^{(1,2)} & =\mathbf{0} & g_{ad}^{(1,2)} & =-\varepsilon_{p}N_{a}^{(1)}N_{d}^{(2)}\\
\mathbf{g}_{bc}^{(2,1)} & =-N_{b}^{(2)}w_{n}\mathbf{A}_{c}^{(1)}\cdot\mathbf{n}^{(1)} & g_{bc}^{(2,1)} & =-\varepsilon_{p}N_{b}^{(2)}N_{c}^{(1)}\\
\mathbf{g}_{bd}^{(2,2)} & =\mathbf{0} & g_{bd}^{(2,2)} & =\varepsilon_{p}N_{b}^{(2)}N_{d}^{(2)}
\end{aligned}
\end{equation}

\end_inset

In eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-stiffness"

\end_inset

, 
\begin_inset Formula $\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)} & \Delta p_{c}^{(1)}\end{bmatrix}^{T}$
\end_inset

 is the vector of incremental changes in the degrees of freedom of the 
\begin_inset Formula $c$
\end_inset

th node of the current element face on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

.
 Similarly, 
\begin_inset Formula $\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)} & \Delta p_{d}^{(2)}\end{bmatrix}^{T}$
\end_inset

 represents the incremental changes in the degrees of freedom of the 
\begin_inset Formula $d$
\end_inset

th node of the element face on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 which contains the intersection point 
\begin_inset Formula $X^{(2)}$
\end_inset

 associated with the 
\begin_inset Formula $k$
\end_inset

th integration point on the current element face on 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b,Zimmerman18"
literal "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Integration-Scheme"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for a description of the Gaussian quadrature integration scheme used to
 evaluate residuals and stiffness matrices (e.g.
 Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-stick-int-disc"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-stiffness"

\end_inset

).
 Briefly, it should be noted that for all terms associated with 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 (e.g.
 
\begin_inset Formula $\mathbf{K}_{ad}^{(1,2)}$
\end_inset

, 
\begin_inset Formula $\Delta\mathbf{u}_{d}^{(2)}$
\end_inset

, 
\begin_inset Formula $\delta p_{b}^{(2)}$
\end_inset

) there may be 
\begin_inset Formula $k\in\left[1,\,n_{int}^{(e)}\right]$
\end_inset

 distinct element faces on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 associated with all the integration points 
\begin_inset Formula $X^{(1)}$
\end_inset

 on the 
\begin_inset Formula $e$
\end_inset

th element face of 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

, based on the location of 
\begin_inset Formula $X^{(2)}$
\end_inset

 obtained from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:stick-x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
In Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Sliding-Elastic"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on sliding-elastic frictional contact, we split the contact stiffness matrices
 in a different way, which allowed us to clearly separate like terms.
 Here, due to the complexity of the biphasic contact formulation, it was
 determined that the form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-stick-stiffness"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides more clarity.
\end_layout

\begin_layout Subsection
Biphasic Slip
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Slip"

\end_inset


\end_layout

\begin_layout Subsubsection
Linearization
\end_layout

\begin_layout Standard
During slip, the contact integral over 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 is performed over integration points 
\begin_inset Formula $X^{(1)}$
\end_inset

 with prescribed parametric coordinates 
\begin_inset Formula $\eta_{(1)}^{\alpha}$
\end_inset

.
 However, the point on 
\begin_inset Formula $\gamma^{(2)}$
\end_inset

 in contact with 
\begin_inset Formula $\gamma^{(1)}$
\end_inset

 has parametric coordinates 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 which change with variations in 
\begin_inset Formula $\mathbf{x}^{(1)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}^{(1)}$
\end_inset

, in accordance with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Consequently, directional derivatives of 
\begin_inset Formula $\mathbf{x}^{(i)}$
\end_inset

, 
\begin_inset Formula $p^{(i)}$
\end_inset

, 
\begin_inset Formula $\delta\mathbf{v}^{(i)}$
\end_inset

, and 
\begin_inset Formula $\delta p^{(i)}$
\end_inset

 are given by
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{(1)} & =\Delta\mathbf{u}^{(1)} & D\mathbf{x}^{(2)} & =\Delta\mathbf{u}^{(2)}+\mathbf{g}_{\alpha}^{(2)}D\eta_{(2)}^{\alpha}\\
Dp^{(1)} & =\Delta p^{(1)} & Dp^{(2)} & =\Delta p^{(2)}+\frac{\partial p^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}\\
D\delta\mathbf{v}^{(1)} & =\mathbf{0} & D\delta\mathbf{v}^{(2)} & =\frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}\\
D\delta p^{(1)} & =0 & D\delta p^{(2)} & =\frac{\partial\delta p^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}
\end{aligned}
\label{eq:biphasic-slip-linearization}
\end{equation}

\end_inset

where 
\begin_inset Formula $D\eta_{(2)}^{\alpha}$
\end_inset

 is evaluated by our modification 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "false"

\end_inset

 of a method proposed by Laursen and Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen93"
literal "false"

\end_inset

, and may be found in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictionless-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The linearization of the slip traction proceeds as before 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

, with the addition of a term involving the linearization of 
\begin_inset Formula $\mueff$
\end_inset

.
 From eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mueff-biphasic"
plural "false"
caps "false"
noprefix "false"

\end_inset

 it follows that
\begin_inset Formula 
\begin{equation}
D\mueff=\mueq\left(1-\varphi\right)\frac{\Delta p^{(1)}}{t_{n}}-\mueq\left(1-\varphi\right)\frac{p^{(1)}}{t_{n}^{2}}Dt_{n}\label{eq:Dmueff}
\end{equation}

\end_inset

where 
\begin_inset Formula $Dt_{n}=\varepsilon Dg$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

; this term has been provided previously in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dg_slip"
plural "false"
caps "false"
noprefix "false"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

.
 Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dmueff"
plural "false"
caps "false"
noprefix "false"

\end_inset

 was derived by recalling that 
\begin_inset Formula $\mueq$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 are constants.
 We then obtain
\begin_inset Formula 
\begin{equation}
D\mathbf{t}^{(1)}=Dt_{n}\left(\no+\mueff\so\right)+t_{n}\left(D\no+\left(D\mueff\right)\so+\mueff D\so\right)
\end{equation}

\end_inset

Finally, from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (evaluated at 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 determined by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-x2"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-linearization"

\end_inset

 it follows that
\begin_inset Formula 
\begin{equation}
Dw_{n}=\varepsilon_{p}\left(\Delta p^{(1)}-\Delta p^{(2)}-\frac{\partial p^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}\right)\label{eq:Dwn}
\end{equation}

\end_inset

Note that the form of 
\begin_inset Formula $Dw_{n}$
\end_inset

 given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dwn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 contains additional terms not present in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biph-stick-Dwn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 This is because the parametric coordinates of intersection may vary in
 slip, but are invariant in stick; as a consequence, whether or not the
 linearization of 
\begin_inset Formula $p^{(2)}$
\end_inset

 depends on 
\begin_inset Formula $\eta_{(2)}^{\alpha}$
\end_inset

 is determined by the stick-slip status.
 Per the discussion following eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pi-biphasic-penalty"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the main text, the fluid flux must be calculated after the stick-slip
 status has been resolved.
\end_layout

\begin_layout Subsubsection
Discretization
\end_layout

\begin_layout Standard
Let the continuous variables on the primary and secondary surfaces be interpolat
ed over each element face according to
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{(1)} & =\sum_{a}N_{a}^{(1)}\delta\mathbf{v}_{a}^{(1)} & \delta\mathbf{v}^{(2)} & =\sum_{b}N_{b}^{(2)}\delta\mathbf{v}_{b}^{(2)}\\
\Delta\mathbf{u}^{(1)} & =\sum_{c}N_{c}^{(1)}\Delta\mathbf{u}_{c}^{(1)} & \Delta\mathbf{u}^{(2)} & =\sum_{d}N_{d}^{(2)}\Delta\mathbf{u}_{d}^{(2)}\\
\delta p^{(1)} & =\sum_{a}N_{a}^{(1)}\delta p_{a}^{(1)} & \delta p^{(2)} & =\sum_{b}N_{b}^{(2)}\delta p_{b}^{(2)}\\
\Delta p^{(1)} & =\sum_{c}N_{c}^{(1)}\Delta p_{c}^{(1)} & \Delta p^{(2)} & =\sum_{d}N_{d}^{(2)}\Delta p_{d}^{(2)}
\end{aligned}
\label{eq:biphasic-slip-var-discretization}
\end{equation}

\end_inset

In the case of slip, the contact integral of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:contact-int-invariant-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be split into normal and tangential parts, 
\begin_inset Formula $\delta G_{c}=\delta G_{c}^{n}+\delta G_{c}^{t}$
\end_inset

, such that
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c}= & \int_{\Gamma_{\eta}^{(1)}}\left(\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}t_{n}\mathbf{n}^{(1)}\\
-t_{n}\mathbf{n}^{(1)}
\end{bmatrix}+\begin{bmatrix}\delta p^{(1)} & \delta p^{(2)}\end{bmatrix}\cdot\begin{bmatrix}w_{n}\\
-w_{n}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta\mathbf{v}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\mueff t_{n}\mathbf{s}^{(1)}\\
-\mueff t_{n}\mathbf{s}^{(1)}
\end{bmatrix}\,J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biphasic-slip-discretized}
\end{equation}

\end_inset

This split will be useful for the full linearization.
 Discretizing this expression yields
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum_{a}\begin{bmatrix}\delta\mathbf{v}_{a}^{(1)} & \delta p_{a}^{(1)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{a}^{(1)}\\
w_{a}^{(1)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\sum_{b}\begin{bmatrix}\delta\mathbf{v}_{b}^{(2)} & \delta p_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\mathbf{f}_{b}^{(2)}\\
w_{b}^{(2)}
\end{bmatrix}J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{(1)}= & N_{a}^{(1)}\mathbf{t}^{(1)}\,, & \mathbf{f}_{b}^{(2)}= & -N_{b}^{(2)}\mathbf{t}^{(1)}\\
w_{a}^{(1)}= & N_{a}^{(1)}w_{n}\,\,, & w_{b}^{(2)}= & -N_{b}^{(2)}w_{n}
\end{aligned}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{t}^{(1)}$
\end_inset

 is given by Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-traction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the penalty method and Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-tn"
plural "false"
caps "false"
noprefix "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:augmented-t"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for augmented Lagrangian regularization; similarly, 
\begin_inset Formula $w_{n}$
\end_inset

 is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 or eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:AL-wn"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for penalty and augmented Lagrangian schemes, respectively.
 For the following linearization and discretization the normal and tangential
 components, representing frictionless and frictional contributions to the
 contact integral, will be treated separately and may then be added together
 as in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-discretized"

\end_inset

.
 
\end_layout

\begin_layout Paragraph
Frictionless Terms
\end_layout

\begin_layout Standard
The linearization of the frictional part of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-discretized"

\end_inset

 makes use of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-linearization"

\end_inset

 to find
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c} & =\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta p^{(1)}\end{bmatrix}\cdot\left(\begin{bmatrix}t_{n}\mathbf{n}^{(1)}\\
w_{n}
\end{bmatrix}\frac{1}{J_{\eta}^{(1)}}DJ_{\eta}^{(1)}+\begin{bmatrix}t_{n}\\
0
\end{bmatrix}D\mathbf{n}^{(1)}+\begin{bmatrix}\mathbf{n}^{(1)}\\
0
\end{bmatrix}Dt_{n}\right.\\
 & \qquad\qquad\left.+\begin{bmatrix}0\\
1
\end{bmatrix}Dw_{n}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}} & \frac{\partial\delta p^{(2)}}{\partial\eta_{(2)}^{\alpha}}\end{bmatrix}\cdot\begin{bmatrix}-t_{n}\mathbf{n}^{(1)}\\
-w_{n}
\end{bmatrix}D\eta_{(2)}^{\alpha}\,J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(2)} & \delta p^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}-t_{n}\mathbf{n}^{(1)}\\
-w_{n}
\end{bmatrix}\frac{1}{J_{\eta}^{(1)}}DJ_{\eta}^{(1)}+\begin{bmatrix}-t_{n}\\
0
\end{bmatrix}D\mathbf{n}^{(1)}+\begin{bmatrix}-\mathbf{n}^{(1)}\\
0
\end{bmatrix}Dt_{n}\right.\\
 & \qquad\qquad\left.\begin{bmatrix}0\\
-1
\end{bmatrix}Dw_{n}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:Dgc-biph-fricless-slip}
\end{equation}

\end_inset

where we note that the virtual variables on the secondary surface now enter
 the linearization, as parametric coordinates on the secondary surface vary
 during slip according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:slip-gap"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The only linearization which has not been previously discretized is 
\begin_inset Formula $Dw_{n}$
\end_inset

, and it follows from placing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-var-discretization"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dwn"

\end_inset

 that
\begin_inset Formula 
\begin{equation}
Dw_{n}=\sum_{c}\begin{bmatrix}-\varepsilon_{p}\Nc\mathbf{p}^{(2)}+\varepsilon_{p}P_{c}\no & \varepsilon_{p}\Nc\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}+\sum_{d}\begin{bmatrix}\varepsilon_{p}\Nd\mathbf{p}^{(2)} & -\varepsilon_{p}\Nd\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\label{eq:Dwn-discrete}
\end{equation}

\end_inset

where we define
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{p}^{(2)} & =\frac{\partial p^{(2)}}{\partial\eta_{(2)}^{\alpha}}\bar{\mathbf{g}}_{(2)}^{\alpha}\\
P_{c} & =ga^{\alpha\beta}\frac{\partial p^{(2)}}{\partial\eta_{(2)}^{\alpha}}\frac{\partial\Nc}{\partial\eta_{(1)}^{\beta}}
\end{aligned}
\label{eq:def-p-pc}
\end{equation}

\end_inset

and for convenience we note that
\begin_inset Formula 
\begin{equation}
\frac{\partial p^{(2)}}{\partial\eta_{(2)}^{\alpha}}D\eta_{(2)}^{\alpha}=\sum_{c}\begin{bmatrix}\Nc\mathbf{p}^{(2)}-P_{c}\no & 0\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}+\sum_{d}\begin{bmatrix}-\Nd\mathbf{p}^{(2)} & 0\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\label{eq:dp-deta}
\end{equation}

\end_inset

Directional derivatives of virtual variables on the secondary surface will
 lead to expressions of the form 
\begin_inset Formula $\left(\partial\Nb/\partial\eta_{(2)}^{\lambda}\right)D\eta_{(2)}^{\lambda}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\frac{\partial N_{b}^{(2)}}{\partial\eta_{(2)}^{\lambda}}D\eta_{(2)}^{\lambda}=\begin{bmatrix}\sum_{c}N_{c}^{(1)}\bar{\mathbf{m}}_{b}^{(2)}-G_{bc}\mathbf{n}^{(1)} & \sum_{d}-N_{d}^{(2)}\bar{\mathbf{m}}_{b}^{(2)}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta\mathbf{u}_{d}^{(2)}
\end{bmatrix}\label{eq:dNb-deta}
\end{equation}

\end_inset

In eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dNb-deta"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the pressure degrees of freedom do not enter into the linearization.
 In an effort to keep the expression more compact, we have not included
 these variables.
 However, this expression could easily be cast into the form of e.g.
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dp-deta"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by adding zeros where necessary.
 Discretizing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dgc-biph-fricless-slip"

\end_inset

 and making use of linearizations found previously 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

, along with Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dwn-discrete"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:dp-deta"
plural "false"
caps "false"
noprefix "false"

\end_inset

, allows the resulting stiffness matrix to be expressed as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c} & =\sum_{a}\begin{bmatrix}\delta\mathbf{v}_{a}^{(1)} & \delta p_{a}^{(1)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{ac}^{(1,1)} & \mathbf{0}\\
\mathbf{g}_{ac}^{(1,1)} & g_{ac}^{(1,1)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{ad}^{(1,2)} & \mathbf{0}\\
\mathbf{g}_{ad}^{(1,2)} & g_{ad}^{(1,2)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\sum_{b}\begin{bmatrix}\delta\mathbf{v}_{b}^{(2)} & \delta p_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{bc}^{(2,1)} & \mathbf{0}\\
\mathbf{g}_{bc}^{(2,1)} & g_{bc}^{(2,1)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{bd}^{(2,2)} & \mathbf{0}\\
\mathbf{g}_{bd}^{(2,2)} & g_{bd}^{(2,2)}
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biphasic-fricless-slip-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{(1,1)} & =-N_{a}^{(1)}N_{c}^{(1)}\left(\varepsilon\Nt\right)-\Na\left(t_{n}\Ac+t_{n}\Mc\cdot\No\right)\\
\mathbf{K}_{ad}^{(1,2)} & =N_{a}^{(1)}N_{d}^{(2)}\left(\varepsilon\Nt\right)\\
\mathbf{K}_{bc}^{(2,1)} & =N_{b}^{(2)}N_{c}^{(1)}\left(\varepsilon\Nt\right)+N_{b}^{(2)}\left(t_{n}\Ac+t_{n}\Mc\cdot\No\right)\\
 & \qquad\qquad+\Nc\left(t_{n}\Mb\right)+G_{bc}\left(t_{n}\No\right)\\
\mathbf{K}_{bd}^{(2,2)} & =-N_{b}^{(2)}N_{d}^{(2)}\left(\varepsilon\Nt\right)-\Nd\left(t_{n}\Mb\right)
\end{aligned}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{(1,1)} & =-N_{a}^{(1)}N_{c}^{(1)}\left(\varepsilon_{p}\mathbf{p}^{(2)}\right)+N_{a}^{(1)}\left(w_{n}\Ac\cdot\no+\varepsilon_{p}P_{c}\no\right)\\
\mathbf{g}_{ad}^{(1,2)} & =N_{a}^{(1)}N_{d}^{(2)}\left(\varepsilon_{p}\mathbf{p}^{(2)}\right)\\
\mathbf{g}_{bc}^{(2,1)} & =N_{b}^{(2)}N_{c}^{(1)}\left(\varepsilon_{p}\mathbf{p}^{(2)}\right)-N_{b}^{(2)}\left(w_{n}\Ac\cdot\no+\varepsilon_{p}P_{c}\no\right)-N_{c}^{(1)}\left(w_{n}\mb\right)+G_{bc}\left(w_{n}\no\right)\\
\mathbf{g}_{bd}^{(2,2)} & =-N_{b}^{(2)}N_{d}^{(2)}\left(\varepsilon_{p}\mathbf{p}^{(2)}\right)+N_{d}^{(2)}\left(w_{n}\mb\right)
\end{aligned}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{(1,1)} & =-N_{a}^{(1)}N_{c}^{(1)}\left(-\varepsilon_{p}\right)\\
g_{ad}^{(1,2)} & =N_{a}^{(1)}N_{d}^{(2)}\left(-\varepsilon_{p}\right)\\
g_{bc}^{(2,1)} & =N_{b}^{(2)}N_{c}^{(1)}\left(-\varepsilon_{p}\right)\\
g_{bd}^{(2,2)} & =-N_{b}^{(2)}N_{d}^{(2)}\left(-\varepsilon_{p}\right)
\end{aligned}
\end{equation}

\end_inset

The expressions above are very similar to those which can be found in our
 frictionless biphasic contact paper 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10"
literal "false"

\end_inset

, although the present framework is more general, as that previous study
 evaluated expressions in the limit as 
\begin_inset Formula $g\to0$
\end_inset

 (see Zimmerman and Ateshian 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman18"
literal "false"

\end_inset

 for a detailed discussion of this assumption and the benefits of relaxing
 it).
\end_layout

\begin_layout Paragraph
Frictional Terms
\end_layout

\begin_layout Standard
Linearizing the frictional contribution follows from the second term of
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-discretized"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c} & =\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(1)} & \delta p^{(1)}\end{bmatrix}\cdot\left(\begin{bmatrix}t_{n}\so\\
0
\end{bmatrix}D\mueff+\begin{bmatrix}\mueff\so\\
0
\end{bmatrix}Dt_{n}\right.\\
 & \left.+\begin{bmatrix}\mueff t_{n}\\
0
\end{bmatrix}D\so+\begin{bmatrix}\mueff t_{n}\so\\
0
\end{bmatrix}\frac{1}{\jeta}D\jeta\right)\jeta d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\delta\mathbf{v}^{(2)} & \delta p^{(2)}\end{bmatrix}\cdot\left(\begin{bmatrix}-t_{n}\so\\
0
\end{bmatrix}D\mueff+\begin{bmatrix}-\mueff\so\\
0
\end{bmatrix}Dt_{n}\right.\\
 & \left.+\begin{bmatrix}-\mueff t_{n}\\
0
\end{bmatrix}D\so+\begin{bmatrix}-\mueff t_{n}\so\\
0
\end{bmatrix}\frac{1}{\jeta}D\jeta\right)\jeta d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\int_{\Gamma_{\eta}^{(1)}}\begin{bmatrix}\frac{\partial\delta\mathbf{v}^{(2)}}{\partial\eta_{(2)}^{\alpha}} & \frac{\partial\delta p^{(2)}}{\partial\eta_{(2)}^{\alpha}}\end{bmatrix}\cdot\begin{bmatrix}-\mueff t_{n}\so\\
0
\end{bmatrix}D\eta_{(2)}^{\alpha}\jeta d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:Dgc-biph-fric-slip}
\end{equation}

\end_inset

The remaining quantity in this expression to be determined is the discretization
 of 
\begin_inset Formula $D\mueff$
\end_inset

; from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dmueff"

\end_inset

 and eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-var-discretization"

\end_inset

 it follows that
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mueff & =\sum_{c}\begin{bmatrix}\varepsilon\Nc\mueq\Gamma_{p}\frac{1}{t_{n}^{2}}\Nbo\cdot\no+\mueq\Gamma_{p}\frac{1}{t_{n}}\No\cdot\mc & \Nc\mueq\left(1-\varphi\right)\frac{1}{t_{n}}\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{\mathbf{u}}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\\
 & +\sum_{d}\begin{bmatrix}-\varepsilon_{n}\Nd\mueq\Gamma_{p}\frac{1}{t_{n}^{2}}\Nbo\cdot\no & 0\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{\mathbf{u}}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}
\end{aligned}
\label{eq:Dmueff-discrete}
\end{equation}

\end_inset

where we made the definition 
\begin_inset Formula 
\begin{equation}
\Gamma_{p}=\left(1-\varphi\right)p^{(1)}
\end{equation}

\end_inset

just to be used in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dmueff-discrete"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for space considerations.
 Finally, inserting Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-slip-var-discretization"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dmueff-discrete"

\end_inset

 into eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dgc-biph-fric-slip"

\end_inset

 yields the stiffness matrix for the frictional terms 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G_{c} & =\sum_{a}\begin{bmatrix}\delta\mathbf{v}_{a}^{(1)} & \delta p_{a}^{(1)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{ac}^{(1,1)} & \mathbf{k}_{ac}^{(1,1)}\\
\mathbf{0} & 0
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{ad}^{(1,2)} & \mathbf{k}_{ad}^{(1,2)}\\
\mathbf{0} & 0
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}\\
 & +\sum_{b}\begin{bmatrix}\delta\mathbf{v}_{b}^{(2)} & \delta p_{b}^{(2)}\end{bmatrix}\cdot\int_{\Gamma_{\eta}^{(1)}}\left(\sum_{c}\begin{bmatrix}\mathbf{K}_{bc}^{(2,1)} & \mathbf{k}_{bc}^{(2,1)}\\
\mathbf{0} & 0
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{c}^{(1)}\\
\Delta p_{c}^{(1)}
\end{bmatrix}\right.\\
 & \qquad\qquad\qquad\left.+\sum_{d}\begin{bmatrix}\mathbf{K}_{bd}^{(2,2)} & \mathbf{k}_{bd}^{(2,2)}\\
\mathbf{0} & 0
\end{bmatrix}\cdot\begin{bmatrix}\Delta\mathbf{u}_{d}^{(2)}\\
\Delta p_{d}^{(2)}
\end{bmatrix}\right)J_{\eta}^{(1)}d\eta_{(1)}^{1}d\eta_{(1)}^{2}
\end{aligned}
\label{eq:biphasic-fric-slip-stiffness}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{(1,1)} & =-N_{a}^{(1)}N_{c}^{(1)}\left(\varepsilon\mueq\tilde{\mathbf{S}}^{(1)}+\mueff t_{n}\mathbf{B}^{(1)}\right)-N_{a}^{(1)}\left(t_{n}\so\otimes\bar{\mathbf{h}}_{c-}^{(1)}\right.\\
 & \qquad\qquad\left.+\mueff t_{n}g\mathbf{P}_{S}\cdot\mathbf{c}^{(1)}\otimes\mathbf{h}_{c+}^{(1)}-\mueff t_{n}\mathbf{J}_{c}^{(1)}\right)\\
\mathbf{K}_{ad}^{(1,2)} & =N_{a}^{(1)}N_{d}^{(2)}\left(\varepsilon\mueq\tilde{\mathbf{S}}^{(1)}+\mueff t_{n}\mathbf{B}^{(1)}\right)\\
\mathbf{K}_{bc}^{(2,1)} & =N_{b}^{(2)}N_{c}^{(1)}\left(\varepsilon\mueq\tilde{\mathbf{S}}^{(1)}+\mueff t_{n}\mathbf{B}^{(1)}\right)+N_{b}^{(2)}\left(t_{n}\so\otimes\bar{\mathbf{h}}_{c-}^{(1)}\right.\\
 & \qquad\qquad\left.+\mueff t_{n}g\mathbf{P}_{S}\cdot\mathbf{c}^{(1)}\otimes\mathbf{h}_{c+}^{(1)}-\mueff t_{n}\mathbf{J}_{c}^{(1)}\right)\\
 & \qquad\qquad+\Nc\left(-\mueff t_{n}\so\otimes\mb\right)+G_{bc}\left(\mueff t_{n}\So\right)\\
\mathbf{K}_{bd}^{(2,2)} & =-N_{b}^{(2)}N_{d}^{(2)}\left(\varepsilon\mueq\tilde{\mathbf{S}}^{(1)}+\mueff t_{n}\mathbf{B}^{(1)}\right)-\Nd\left(-\mueff t_{n}\so\otimes\mb\right)
\end{aligned}
\label{eq:biphasic-fric-slip-solid-stiffness}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ac}^{(1,1)} & =-N_{a}^{(1)}N_{c}^{(1)}\left(-\mueq\left(1-\varphi\right)\so\right)\\
\mathbf{k}_{ad}^{(1,2)} & =\mathbf{0}\\
\mathbf{k}_{bc}^{(2,1)} & =N_{b}^{(2)}N_{c}^{(1)}\left(-\mueq\left(1-\varphi\right)\so\right)\\
\mathbf{k}_{bd}^{(2,2)} & =\mathbf{0}
\end{aligned}
\label{eq:biphasic-fric-slip-pressure-stiffness}
\end{equation}

\end_inset

In eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fric-slip-solid-stiffness"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have defined
\begin_inset Formula 
\begin{equation}
\begin{aligned}\bar{\mathbf{h}}_{c-}^{(1)} & =\mueq\No\cdot\mc-\mueff\Ac\cdot\no\end{aligned}
\label{eq:h-bar-c-minus}
\end{equation}

\end_inset

by analogy with our definitions for 
\begin_inset Formula $\mathbf{h}_{c+}^{(1)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{h}_{c-}^{(1)}$
\end_inset

 in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SE-Frictional-Terms"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The stiffness matrix of the frictional contribution to the virtual work,
 given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fric-slip-stiffness"

\end_inset

, is nonsymmetric.
 Summing Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fricless-slip-stiffness"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fric-slip-stiffness"

\end_inset

 produces the total stiffness matrix for the case of frictional biphasic
 slip; this total stiffness matrix is also nonsymmetric.
 However, as noted before 
\begin_inset CommandInset citation
LatexCommand cite
key "Ateshian10"
literal "false"

\end_inset

, the stiffness matrix for biphasic materials is nonsymmetric by construction,
 so there is no expectation that the contact stiffness matrices be symmetric.
\end_layout

\begin_layout Standard
Equation
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fric-slip-solid-stiffness"
plural "false"
caps "false"
noprefix "false"

\end_inset

 contains the solid-solid stiffness terms.
 Comparing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:biphasic-fric-slip-solid-stiffness"
plural "false"
caps "false"
noprefix "false"

\end_inset

 with eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:frictional-stiffness"
plural "false"
caps "false"
noprefix "false"

\end_inset

 shows that the same form of the equations is recovered.
 Interestingly, however, some of the terms in sliding-elastic (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Sliding-Elastic"
plural "false"
caps "false"
noprefix "false"

\end_inset

) which were multiplied by the friction coefficient 
\begin_inset Formula $\mu$
\end_inset

 are now multiplied by 
\begin_inset Formula $\mueff$
\end_inset

, which indicates certain terms which are important in biphasic contact.
 Of course, in the absence of pressurized fluid, 
\begin_inset Formula $\mueff\to\mu$
\end_inset

 and we recover the sliding-elastic formulation.
\end_layout

\begin_layout Section
Biphasic-Solute Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Solute-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Solute-Material"

\end_inset

 for a review of biphasic-solute materials.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)j_{n}^{\left(1\right)}\,da^{\left(1\right)}\,.
\end{aligned}
\label{eq625}
\end{equation}

\end_inset

In the current implementation, only frictionless contact is taken into considera
tion, so that the contact traction has only a normal component, 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}=t_{n}\mathbf{n}^{\left(i\right)}$
\end_inset

.
 To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq626}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}.\label{eq627}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)t_{n}\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)j_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\;,
\end{aligned}
\label{eq628}
\end{equation}

\end_inset

and the linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{c}^{\left(i\right)}\right]\,.\label{eq629}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The gap function 
\begin_inset Formula $g$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(2\right)}=\mathbf{x}^{\left(1\right)}+g\mathbf{n}^{\left(1\right)},\quad g=\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\cdot\mathbf{n}^{\left(1\right)}\,.\label{eq630}
\end{equation}

\end_inset

The linearization of variables associated with motion, pressure, and concentrati
on, is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)} & =\Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{p}^{\left(1\right)} & =\Delta\tilde{p}^{\left(1\right)} & D\tilde{p}^{\left(2\right)} & =\Delta\tilde{p}^{\left(2\right)}+\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{c}^{\left(1\right)} & =\Delta\tilde{c}^{\left(1\right)} & D\tilde{c}^{\left(2\right)} & =\Delta\tilde{c}^{\left(2\right)}+\frac{\partial\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\mathbf{v}^{\left(2\right)} & =\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{p}^{\left(1\right)} & =0 & D\delta\tilde{p}^{\left(2\right)} & =\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{c}^{\left(1\right)} & =0 & D\delta\tilde{c}^{\left(2\right)} & =\frac{\partial\delta\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}
\end{aligned}
\,,\label{eq631}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\Delta\eta_{\left(2\right)}^{\alpha}=\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\cdot a^{\alpha\beta}\mathbf{g}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\mathbf{n}^{\left(1\right)}\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\beta}}\,,\label{eq632}
\end{equation}

\end_inset

with 
\begin_inset Formula $a^{\alpha\beta}=\left(A_{\alpha\beta}\right)^{-1}$
\end_inset

 and 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\mathbf{g}_{\beta}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the normal component of the contact traction be described by the penalty
 function, 
\begin_inset Formula 
\begin{equation}
t_{n}=\begin{cases}
\varepsilon_{n}g & g<0\\
0 & g\geqslant0
\end{cases}\,,\label{eq633}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $t_{n}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
\begin{cases}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{p}^{\left(i\right)}=\tilde{p}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq634}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{cases}
j_{n}=\varepsilon_{c}\chi=\varepsilon_{c}\left(\tilde{c}^{\left(1\right)}-\tilde{c}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{c}^{\left(i\right)}=\tilde{c}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq635}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 are penalty factors associated with 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $j_{n}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dt_{n} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\right)\cdot\mathbf{n}^{\left(1\right)}\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}-\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)\\
Dj_{n} & =\varepsilon_{c}\left(\Delta\tilde{c}^{\left(1\right)}-\Delta\tilde{c}^{\left(2\right)}-\frac{\partial\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)
\end{aligned}
\,.\label{eq636}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}t_{n}\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\cdot\left(\mathbf{n}^{\left(2\right)}\otimes\mathbf{g}_{\left(2\right)}^{\alpha}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq637}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}\left[\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+w_{n}\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq638}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & D\left(j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\left(\Delta\tilde{c}^{\left(1\right)}-\Delta\tilde{c}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}\left[\varepsilon_{c}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\frac{\partial\tilde{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+j_{n}\frac{\partial\delta\tilde{c}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\times\mathbf{g}_{2}^{\left(1\right)}+\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq639}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:BS-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{n}^{\left(1\right)}+w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)+j_{n}\left(\delta\tilde{c}^{\left(1\right)}-\delta\tilde{c}^{\left(2\right)}\right)\right]\,.\label{eq640}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{p}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\left(1\right)} & \delta\tilde{c}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\left(2\right)}\\
\Delta\tilde{c}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\left(1\right)} & \Delta\tilde{c}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq641}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta\tilde{p}_{b,k}^{\left(1\right)} & \delta\tilde{c}_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}\\
j_{b,k}^{\left(1\right)}
\end{array}\right]\right)\,,
\end{aligned}
\label{eq642}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}t_{n}\mathbf{n}^{\left(1\right)} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}t_{n}\mathbf{n}^{\left(1\right)}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}\\
j_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}j_{n} & j_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}j_{n}
\end{aligned}
\,.\label{eq643}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{ac}^{\left(1,1\right)} & g_{ac}^{\left(1,1\right)} & 0\\
\mathbf{h}_{ac}^{\left(1,1\right)} & 0 & h_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & g_{ad,k}^{\left(1,2\right)} & 0\\
\mathbf{h}_{ad,k}^{\left(1,2\right)} & 0 & h_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{bc,k}^{\left({2,1}\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & g_{bc,k}^{\left(2,1\right)} & 0\\
\mathbf{h}_{bc,k}^{\left(2,1\right)} & 0 & h_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{ccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0} & \mathbf{0}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & g_{bd,k}^{\left(2,2\right)} & 0\\
\mathbf{h}_{bd,k}^{\left(2,2\right)} & 0 & h_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq644}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{A}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{N}^{\left(1\right)}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{c}^{\left(1\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)-t_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq645}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{p}N_{c}^{\left(1\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{p}^{\left(1\right)}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}+w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+w_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq646}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
g_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
g_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
g_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq647}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{h}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{c}N_{c}^{\left(1\right)}\mathbf{q}^{\left(1\right)}-j_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{h}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{q}^{\left(1\right)}\\
\mathbf{h}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{c}N_{b}^{\left(2\right)}\mathbf{q}^{\left(1\right)}+j_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+j_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{h}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{c}N_{b}^{\left(2\right)}\mathbf{q}^{\left(1\right)}-j_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq648}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}h_{ac}^{\left(1,1\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
h_{ad,k}^{\left(1,2\right)} & =\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
h_{bc,k}^{\left(2,1\right)} & =\varepsilon_{c}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
h_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{c}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq649}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{\left(1\right)} & =\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\\
\mathbf{A}_{c}^{\left(1\right)} & =\frac{1}{J_{\eta}^{\left(1\right)}}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\mathbf{g}_{2}^{\left(1\right)}-\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\mathbf{g}_{1}^{\left(1\right)}\right\} \\
\mathbf{M}_{b}^{\left(2\right)} & =\mathbf{n}^{\left(2\right)}\otimes\mathbf{m}_{b}^{\left(2\right)}\\
\mathbf{m}_{b}^{\left(2\right)} & =\frac{\partial N_{b}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\\
\mathbf{p}^{\left(1\right)} & =\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}\\
\mathbf{q}^{\left(1\right)} & =\frac{\partial\tilde{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}
\end{aligned}
\,.\label{eq650}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Multiphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Multiphasic-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"

\end_inset

 for a review of multiphasic materials.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\alpha\left(i\right)}$
\end_inset

 for solute 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

, may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\sum\limits _{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\,da^{\left(1\right)}
\end{aligned}
\,.\label{eq651}
\end{equation}

\end_inset

In the current implementation, only frictionless contact is taken into considera
tion, so that the contact traction has only a normal component, 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}=t_{n}\mathbf{n}^{\left(i\right)}$
\end_inset

.
 To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq652}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}.\label{eq653}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)t_{n}\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\sum\limits _{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq654}
\end{equation}

\end_inset

and the linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+\sum\limits _{\alpha}D\delta G_{c}\left[\Delta\tilde{c}^{\alpha\left(i\right)}\right]\,.\label{eq655}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The gap function 
\begin_inset Formula $g$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(2\right)}=\mathbf{x}^{\left(1\right)}+g\mathbf{n}^{\left(1\right)},\quad g=\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\cdot\mathbf{n}^{\left(1\right)}\,.\label{eq656}
\end{equation}

\end_inset

The linearization of variables associated with motion, pressure, and concentrati
on, is given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)}= & \Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{p}^{\left(1\right)}= & \Delta\tilde{p}^{\left(1\right)} & D\tilde{p}^{\left(2\right)} & =\Delta\tilde{p}^{\left(2\right)}+\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\tilde{c}^{\gamma\left(1\right)}= & \Delta\tilde{c}^{\gamma\left(1\right)} & D\tilde{c}^{\gamma\left(2\right)} & =\Delta\tilde{c}^{\gamma\left(2\right)}+\frac{\partial\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\mathbf{v}^{\left(2\right)} & =\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{p}^{\left(1\right)} & =0 & D\delta\tilde{p}^{\left(2\right)} & =\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\\
D\delta\tilde{c}^{\gamma\left(1\right)} & =0 & D\delta\tilde{c}^{\gamma\left(2\right)} & =\frac{\partial\delta\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}
\end{aligned}
\,,\label{eq657}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\Delta\eta_{\left(2\right)}^{\alpha}=\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\cdot a^{\alpha\beta}\mathbf{g}_{\beta}^{\left(1\right)}-a^{\alpha\beta}g\mathbf{n}^{\left(1\right)}\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\beta}}\,,\label{eq658}
\end{equation}

\end_inset

with 
\begin_inset Formula $a^{\alpha\beta}=\left(A_{\alpha\beta}\right)^{-1}$
\end_inset

 and 
\begin_inset Formula $A_{\alpha\beta}=\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\mathbf{g}_{\beta}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the normal component of the contact traction be described by the penalty
 function, 
\begin_inset Formula 
\begin{equation}
t_{n}=\begin{cases}
\varepsilon_{n}g & g<0\\
0 & g\geqslant0
\end{cases}\,,\label{eq659}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $t_{n}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
\begin{cases}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right) & t_{n}<0\\
\tilde{p}^{\left(i\right)}=\tilde{p}^{\ast} & t_{n}=0
\end{cases}\,,\label{eq660}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{cases}
j_{n}^{\alpha}=\varepsilon_{c}\chi^{\alpha}=\varepsilon_{c}\left(\tilde{c}^{\alpha\left(1\right)}-\tilde{c}^{\alpha\left(2\right)}\right) & t_{n}<0\\
\tilde{c}^{\alpha\left(i\right)}=\tilde{c}^{\alpha\ast} & t_{n}=0
\end{cases}\,,\label{eq661}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 are penalty factors associated with 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $j_{n}^{\alpha}\equiv j_{n}^{\alpha\left(1\right)}$
\end_inset

, respectively.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}Dt_{n} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}+\mathbf{g}_{\alpha}^{\left(2\right)}\Delta\eta_{\left(2\right)}^{\alpha}\right)\cdot\mathbf{n}^{\left(1\right)}\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}-\frac{\partial\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)\\
Dj_{n}^{\gamma} & =\varepsilon_{c}\left(\Delta\tilde{c}^{\gamma\left(1\right)}-\Delta\tilde{c}^{\gamma\left(2\right)}-\frac{\partial\tilde{c}^{\gamma\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\Delta\eta_{\left(2\right)}^{\alpha}\right)
\end{aligned}
\,.\label{eq662}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right)=\\
 & J_{\eta}^{\left(1\right)}\varepsilon_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & -J_{\eta}^{\left(1\right)}t_{n}\frac{\partial\delta\mathbf{v}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\cdot\left(\mathbf{n}^{\left(2\right)}\otimes\mathbf{g}_{\left(2\right)}^{\alpha}\right)\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq665}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}\left[\varepsilon_{p}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}+w_{n}\frac{\partial\delta\tilde{p}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\right]\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq666}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\left(\Delta\tilde{c}^{\gamma\left(1\right)}-\Delta\tilde{c}^{\gamma\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}\varepsilon_{c}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\frac{\partial\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +J_{\eta}^{\left(1\right)}j_{n}^{\gamma}\frac{\partial\delta\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\alpha}^{\left(1\right)}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\label{eq667}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:MP-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[t_{n}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{n}^{\left(1\right)}+w_{n}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)+\sum\limits _{\gamma}j_{n}^{\gamma}\left(\delta\tilde{c}^{\gamma\left(1\right)}-\delta\tilde{c}^{\gamma\left(2\right)}\right)\right]\,.\label{eq668}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{p}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\gamma\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\gamma\left(1\right)} & \delta\tilde{c}^{\gamma\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\gamma\left(2\right)}\\
\Delta\tilde{c}^{\gamma\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\gamma\left(1\right)} & \Delta\tilde{c}^{\gamma\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\gamma\left(2\right)}
\end{aligned}
\,.\label{eq669}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{a}^{\alpha\left(1\right)}\\
j_{a}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\sum\limits _{b=1}^{m^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b}^{\left(2\right)} & \delta\tilde{p}_{b}^{\left(2\right)} & \delta\tilde{c}_{b}^{\alpha\left(2\right)} & \delta\tilde{c}_{b}^{\beta\left(2\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(2\right)}\\
w_{b,k}^{\left(2\right)}\\
j_{b,k}^{\alpha\left(2\right)}\\
j_{b,k}^{\beta\left(2\right)}
\end{array}\right]\right)\,,
\end{aligned}
\label{eq670}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =t_{n}N_{a}^{\left(1\right)}\mathbf{n}^{\left(1\right)} & \mathbf{f}_{b,k}^{\left(2\right)} & =-t_{n}N_{b}^{\left(2\right)}\mathbf{n}^{\left(1\right)}\\
w_{a}^{\left(1\right)} & =w_{n}N_{a}^{\left(1\right)} & w_{b,k}^{\left(2\right)} & =-w_{n}N_{b}^{\left(2\right)}\\
j_{a}^{\gamma\left(1\right)} & =j_{n}^{\gamma}N_{a}^{\left(1\right)} & j_{b,k}^{\gamma\left(2\right)} & =-j_{n}^{\gamma}N_{b}^{\left(2\right)}
\end{aligned}
\,.\label{eq671}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\right.\\
 & \left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & 0 & 0 & 0\\
\mathbf{g}_{ac}^{\left(1,1\right)} & g_{ac}^{\left(1,1\right)} & 0 & 0\\
\mathbf{h}_{ac}^{\alpha\left(1,1\right)} & 0 & h_{ac}^{\alpha\alpha\left(1,1\right)} & 0\\
\mathbf{h}_{ac}^{\beta\left(1,1\right)} & 0 & 0 & h_{ac}^{\beta\beta\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & 0 & 0 & 0\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & g_{ad,k}^{\left(1,2\right)} & 0 & 0\\
\mathbf{h}_{ad,k}^{\alpha\left(1,2\right)} & 0 & h_{ad,k}^{\alpha\alpha\left(1,2\right)} & 0\\
\mathbf{h}_{ad,k}^{\beta\left(1,2\right)} & 0 & 0 & h_{ad,k}^{\beta\beta\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(2\right)} & \delta\tilde{c}_{b,k}^{\beta\left(2\right)}\end{array}\right]\cdot\\
 & \left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & 0 & 0 & 0\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & g_{bc,k}^{\left(2,1\right)} & 0 & 0\\
\mathbf{h}_{bc,k}^{\alpha\left(2,1\right)} & 0 & h_{bc,k}^{\alpha\alpha\left(2,1\right)} & 0\\
\mathbf{h}_{bc,k}^{\beta\left(2,1\right)} & 0 & 0 & h_{bc,k}^{\beta\beta\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & 0 & 0 & 0\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & g_{bd,k}^{\left(2,2\right)} & 0 & 0\\
\mathbf{h}_{bd,k}^{\alpha\left(2,2\right)} & 0 & h_{bd,k}^{\alpha\alpha\left(2,2\right)} & 0\\
\mathbf{h}_{bd,k}^{\beta\left(2,2\right)} & 0 & 0 & h_{bd,k}^{\beta\beta\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq672}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{A}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{N}^{\left(1\right)}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{c}^{\left(1\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)-t_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{n}N_{b}^{\left(2\right)}\mathbf{N}^{\left(1\right)}+t_{n}\mathbf{M}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq673}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{g}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{p}N_{c}^{\left(1\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{g}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{p}^{\left(1\right)}\\
\mathbf{g}_{bc,k}^{\left(2,1\right)} & =N_{c}^{\left(1\right)}\left(-\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}+w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)+w_{n}N_{b}^{\left(2\right)}\mathbf{A}_{c}^{\left(1\right)}\cdot\mathbf{n}^{\left(1\right)}\\
\mathbf{g}_{bd,k}^{\left(2,2\right)} & =N_{d}^{\left(2\right)}\left(\varepsilon_{p}N_{b}^{\left(2\right)}\mathbf{p}^{\left(1\right)}-w_{n}\mathbf{m}_{b}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq674}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}g_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)} & g_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
g_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)} & g_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq675}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{h}_{ac}^{\gamma\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(N_{c}^{\left(1\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}-\mathbf{A}_{c}^{\left(1\right)}\cdot j_{n}^{\gamma}\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{h}_{ad,k}^{\gamma\left(1,2\right)} & =-N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}\\
\mathbf{h}_{bc,k}^{\gamma\left(2,1\right)} & =N_{b}^{\left(2\right)}\left(-N_{c}^{\left(1\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}+\mathbf{A}_{c}^{\left(1\right)}\cdot j_{n}^{\gamma}\mathbf{n}^{\left(1\right)}\right)+N_{c}^{\left(1\right)}j_{n}^{\gamma}\mathbf{m}_{b}^{\left(2\right)}\\
\mathbf{h}_{bd,k}^{\gamma\left(2,2\right)} & =N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\varepsilon_{c}\mathbf{q}^{\gamma\left(1\right)}-N_{d}^{\left(2\right)}j_{n}^{\gamma}\mathbf{m}_{b}^{\left(2\right)}
\end{aligned}
\,,\label{eq676}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}h_{ac}^{\gamma\gamma\left(1,1\right)} & =-\varepsilon_{c}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
h_{ad,k}^{\gamma\gamma\left(1,2\right)} & =\varepsilon_{c}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
h_{bc,k}^{\gamma\gamma\left(2,1\right)} & =\varepsilon_{c}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
h_{bd,k}^{\gamma\gamma\left(2,2\right)} & =-\varepsilon_{c}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq677}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{N}^{\left(1\right)} & =\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)} & \mathbf{A}_{c}^{\left(1\right)} & =\frac{1}{J_{\eta}^{\left(1\right)}}\boldsymbol{\mathcal{A}}\left\{ \frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\mathbf{g}_{2}^{\left(1\right)}-\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\mathbf{g}_{1}^{\left(1\right)}\right\} \\
\mathbf{M}_{b}^{\left(2\right)} & =\mathbf{n}^{\left(2\right)}\otimes\mathbf{m}_{b}^{\left(2\right)} & \mathbf{m}_{b}^{\left(2\right)} & =\frac{\partial N_{b}^{\left(2\right)}}{\partial\eta_{\left(2\right)}^{\alpha}}\mathbf{g}_{\left(2\right)}^{\alpha}\\
\mathbf{p}^{\left(1\right)} & =\frac{\partial\tilde{p}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha} & \mathbf{q}^{\gamma\left(1\right)} & =\frac{\partial\tilde{c}^{\gamma\left(1\right)}}{\partial\eta_{\left(1\right)}^{\alpha}}\mathbf{g}_{\left(1\right)}^{\alpha}
\end{aligned}
\,.\label{eq678}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Contact"

\end_inset


\end_layout

\begin_layout Standard
In some situations it is useful to connect two non-conforming meshes together.
 This can be done by defining a tied contact interface.
 In FEBio, the tied contact works very similar to the sliding contact interface.
 We need to define a slave surface and a master surface, where it is assumed
 that the slave surface nodes will be tied to the master surface faces.
\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
Just as in sliding contact, we need to define a gap function that measures
 the distance between the slave and master surface.
 In order to do that, we first define the projection of a slave node to
 the master surface.
 
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{Y}}\left(\mathbf{X}\right)=\arg\min\limits _{\mathbf{Y}\in\Gamma^{\left(2\right)}}\left\Vert \mathbf{X}-\mathbf{Y}\right\Vert \,.\label{eq679}
\end{equation}

\end_inset

This definition is similar to that of the sliding interface, except that
 now the projection is done in the material reference frame.
 This implies that the projection only needs to be calculated once, at the
 beginning of the analysis.
 We can now proceed to the definition of the gap function.
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}\left(\mathbf{X}\right)=\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\,.\label{eq680}
\end{equation}

\end_inset

An important observation is that the gap function is now a vector quantity
 since the gap needs to be closed in all direction, not just the normal
 direction as is the case in sliding contact.
\end_layout

\begin_layout Subsection
Tied Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
With the definition of the gap function at hand (equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq680"

\end_inset

), we can define the contribution to the virtual work equation from the
 tied contact reaction forces.
 
\begin_inset Formula 
\begin{equation}
W_{t}=\int\limits _{\Gamma_{c}}\mathbf{T}\cdot\delta\mathbf{g}\,d\Gamma\,.\label{eq681}
\end{equation}

\end_inset

Here, 
\series bold

\begin_inset Formula $\mathbf{T}$
\end_inset

 
\series default
is the reaction force that enforces the constraint 
\begin_inset Formula $\mathbf{g}\left(\mathbf{X}\right)=0$
\end_inset

.
 Since we anticipate the use of an augmented Lagrangian formalism, we can
 write this reaction force as follows,
\begin_inset Formula 
\begin{equation}
\mathbf{T}=\boldsymbol{\lambda}+\varepsilon\mathbf{g}\,.\label{eq682}
\end{equation}

\end_inset

The vector quantity 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is the Lagrangian multiplier and 
\begin_inset Formula $\varepsilon$
\end_inset

 is a penalty factor.
\end_layout

\begin_layout Subsection
Linearization of the Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Linearization"

\end_inset


\end_layout

\begin_layout Standard
Since equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq681"

\end_inset

 is nonlinear we need to calculate the linearization.
 For tied contact, this is simply given by the following equation.
 
\begin_inset Formula 
\begin{equation}
\Delta W_{t}=\int\limits _{\Gamma_{c}}\varepsilon\Delta\mathbf{g}\cdot\delta\mathbf{g}\,d\Gamma\,.\label{eq683}
\end{equation}

\end_inset

Where 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{g}=\mathbf{w}^{\left(1\right)}-\mathbf{w}^{\left(2\right)}\label{eq684}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{g}=\Delta\boldsymbol{\varphi}^{\left(1\right)}\left(\mathbf{X}\right)-\Delta\boldsymbol{\varphi}^{\left(2\right)}\left(\mathbf{\bar{Y}}\left(\mathbf{X}\right)\right)\,.\label{eq685}
\end{equation}

\end_inset

We also introduced the notation 
\begin_inset Formula $\mathbf{w}^{\left(i\right)}=\delta\boldsymbol{\varphi}^{\left(i\right)}$
\end_inset

.
\end_layout

\begin_layout Standard
The discretization of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq683"

\end_inset

 will lead to a contribution to the stiffness matrix.
 Notice that due to symmetry between 
\begin_inset Formula $\delta\mathbf{g}$
\end_inset

 and
\begin_inset Formula $\Delta\mathbf{g}$
\end_inset

 this matrix will be symmetric.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Contact-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq681"

\end_inset

 can be discretized as follows.
 First, we split the integration over all the slave surface elements.
 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\int\limits _{\Gamma_{c}^{\left(e\right)}}\mathbf{T}\cdot\delta\mathbf{g}\,d\Gamma^{\left(e\right)}\,.\label{eq686}
\end{equation}

\end_inset

The integration can be approximated by a quadrature rule, 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\mathbf{T}\left(\xi_{i}\right)\cdot\delta\mathbf{g}\left(\xi_{i}\right)\,.\label{eq687}
\end{equation}

\end_inset

If we use a nodally integrated elements, we have 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w}^{\left(1\right)}\left(\xi_{i}\right) & =\mathbf{c}_{i}^{\left(1\right)}\,,\\
\mathbf{w}^{\left(2\right)}\left(\xi_{i}\right) & =\sum\limits _{j}N_{j}\left(\bar{\xi}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\,,
\end{aligned}
\label{eq688}
\end{equation}

\end_inset

so that, 
\begin_inset Formula 
\begin{equation}
\delta\mathbf{g}\left(\xi_{i}\right)=\mathbf{c}_{i}^{\left(1\right)}-\sum\limits _{j}N_{j}\left(\bar{\xi}_{i}\right)\mathbf{c}_{j}^{\left(2\right)}\,.\label{eq689}
\end{equation}

\end_inset

We can now write the contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq686"

\end_inset

 in its final form, 
\begin_inset Formula 
\begin{equation}
W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\left(\mathbf{N}\left(\xi_{i}\right)\mathbf{T}\left(\xi_{i}\right)\right)\cdot\delta\boldsymbol{\Phi}\,,\label{eq690}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\delta\boldsymbol{\Phi}^{T}\left(\xi_{i}\right)=\left[\begin{array}{ccccc}
\mathbf{c}_{i}^{\left(1\right)} & \mathbf{c}_{1}^{\left(2\right)} & \mathbf{c}_{2}^{\left(2\right)} & \cdots & \mathbf{c}_{n}^{\left(2\right)}\end{array}\right]\,,\label{eq691}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{N}\left(\xi_{i}\right)=\left[\begin{array}{cccc}
\mathbf{I} & -\mathbf{N}_{1} & \cdots & -\mathbf{N}_{n}\end{array}\right]\,,\label{eq692}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{N}_{i}=\left[\begin{array}{ccc}
N_{i} & 0 & 0\\
0 & N_{i} & 0\\
0 & 0 & N_{i}
\end{array}\right]\,.\label{eq693}
\end{equation}

\end_inset

For the linearized tied contact integral 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq683"

\end_inset

, a similar discretization procedure leads to, 
\begin_inset Formula 
\begin{equation}
\Delta W_{t}=\sum\limits _{e=1}^{nel}\sum\limits _{i=1}^{N_{int}^{\left(e\right)}}w^{i}j\left(\xi_{i}\right)\Delta\boldsymbol{\Phi}\cdot\mathbf{K}_{c}\delta\boldsymbol{\Phi}\,,\label{eq694}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{K}_{c}=\varepsilon\mathbf{N}^{T}\mathbf{N}\,.\label{eq695}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Biphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Biphasic-Contact"

\end_inset

 
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Material"

\end_inset

 for a review of biphasic materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

 for additional details on biphasic contact.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

 and solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}^{\left(1\right)}da^{\left(1\right)}\,.
\end{aligned}
\label{eq696}
\end{equation}

\end_inset

To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)w_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}\equiv\mathbf{t}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta p^{\left(i\right)}\right]\,.\label{eq700}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\,.\label{eq701}
\end{equation}

\end_inset

The premise of a tied interface is that the parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once, in the reference configuration, by shooting a ray from
 the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 It follows from this premise that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(1\right)} & =\Delta\mathbf{u}^{\left(1\right)} & D\mathbf{x}^{\left(2\right)} & =\Delta\mathbf{u}^{\left(2\right)}\\
Dp^{\left(1\right)} & =\Delta p^{\left(1\right)} & Dp^{\left(2\right)} & =\Delta p^{\left(2\right)}\\
D\delta\mathbf{v}^{\left(1\right)} & =\mathbf{0} & D\delta\mathbf{v}^{\left(2\right)} & =\mathbf{0}\\
D\delta p^{\left(1\right)} & =0 & D\delta p^{\left(2\right)} & =0
\end{aligned}
\,.\label{eq702}
\end{equation}

\end_inset

If 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are not initially conforming, continuity of fluid pressure and normal flux
 will only be enforced within the contact interface; unlike the sliding
 biphasic contact interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Contact"

\end_inset

), free-draining conditions are not set automatically on regions of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 where a solution for 
\begin_inset Formula $\mathbf{g}$
\end_inset

 was not found.
 Therefore, these regions naturally enforce zero fluid flux (impermeable
 boundary), unless an explicit boundary condition on the pressure 
\begin_inset Formula $p$
\end_inset

 is prescribed over those regions.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the tied contact traction be described by the penalty function, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\varepsilon_{n}\mathbf{g}\,,\label{eq703}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(p^{\left(1\right)}-p^{\left(2\right)}\right)\,,\label{eq704}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $w_{n}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}\right)\,,\\
Dw_{n} & =\varepsilon_{p}\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}\right)\,.
\end{aligned}
\label{eq705}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\right)=\\
 & \left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\varepsilon_{n}J_{\eta}^{\left(1\right)}\mathbf{I}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\otimes\left[\left(\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}-\left(\mathbf{g}_{2}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\right]
\end{aligned}
\,,\label{eq706}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left(\Delta p^{\left(1\right)}-\Delta p^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}+w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\right]\,.\label{eq708}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta p^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta p_{a}^{\left(1\right)} & \delta p^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta p_{b}^{\left(2\right)}\\
\Delta p^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta p_{c}^{\left(1\right)} & \Delta p^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta p_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq709}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta p_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq710}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}
\end{aligned}
\,.\label{eq711}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta p_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0}\\
\mathbf{k}_{ac}^{\left(1,1\right)} & k_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta p_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & k_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta p_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta p_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq712}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{I}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\mathbf{I}
\end{aligned}
\,,\label{eq713}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}
\end{aligned}
\,,\label{eq714}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq715}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{c}^{\left(1\right)}=\frac{1}{J_{\eta}^{\left(1\right)}}\mathbf{n}^{\left(1\right)}\times\left(\mathbf{g}_{2}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)\,.\label{eq716}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Multiphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Multiphasic-Contact"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"

\end_inset

 for a review of multiphasic materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian12"
literal "true"

\end_inset

 for additional details on contact interfaces involving solutes.
 The contact interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the traction and fluxes, the external
 virtual work resulting from contact tractions 
\begin_inset Formula $\mathbf{t}^{\left(i\right)}$
\end_inset

, solvent fluxes 
\begin_inset Formula $w_{n}^{\left(i\right)}$
\end_inset

 and solute fluxes 
\begin_inset Formula $j_{n}^{\alpha\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the contact integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}^{\left(1\right)}\,da^{\left(1\right)}\\
 & +\sum_{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha\left(1\right)}\,da^{\left(1\right)}\,.
\end{aligned}
\label{eq696-1}
\end{equation}

\end_inset

Note that the summation in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq696-1"

\end_inset

 is performed only over solutes that are present on both sides of the contact
 interface.
 No special treatment is needed for solutes that only belong to one side,
 since the natural boundary condition for these solutes enforces zero normal
 flux across the contact interface.
\end_layout

\begin_layout Standard
To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698-1}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{p}^{\left(1\right)}-\delta\tilde{p}^{\left(2\right)}\right)w_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\sum_{\alpha}\int_{\gamma^{\left(1\right)}}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)j_{n}^{\alpha}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}\equiv\mathbf{t}^{\left(1\right)}$
\end_inset

, 
\begin_inset Formula $w_{n}\equiv w_{n}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $j_{n}^{\alpha}\equiv j_{n}^{\alpha\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{u}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta\tilde{p}^{\left(i\right)}\right]+\sum_{\alpha}D\delta G_{c}\left[\Delta\tilde{c}^{\alpha\left(i\right)}\right]\,.\label{eq700-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Function
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-MP-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the distance between the contact surfaces, is defined by
 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\,.\label{eq701-1}
\end{equation}

\end_inset

The premise of a tied interface is that the parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once, in the reference configuration, by shooting a ray from
 the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 It follows from this premise that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{x}^{\left(i\right)} & =\Delta\mathbf{u}^{\left(i\right)} & D\delta\mathbf{v}^{\left(i\right)} & =\mathbf{0}\\
D\tilde{p}^{\left(i\right)} & =\Delta\tilde{p}^{\left(i\right)} & D\delta\tilde{p}^{\left(i\right)} & =0\\
D\tilde{c}^{\alpha\left(i\right)} & =\Delta\tilde{c}^{\alpha\left(i\right)} & D\delta\tilde{c}^{\alpha\left(i\right)} & =0
\end{aligned}
\quad i=1,2\,.\label{eq702-1}
\end{equation}

\end_inset

If 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are not initially conforming, continuity of effective fluid pressure and
 solute concentration, as well as normal fluid and solute fluxes, will only
 be enforced within the contact interface; unlike the sliding multiphasic
 contact interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multiphasic-Contact"

\end_inset

), ambient conditions are not set automatically on regions of 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 where a solution for 
\begin_inset Formula $\mathbf{g}$
\end_inset

 was not found.
 Therefore, these regions naturally enforce zero fluid and solute flux (impermea
ble boundary), unless an explicit boundary condition on the effective pressure
 
\begin_inset Formula $\tilde{p}$
\end_inset

 or solute concentrations 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 are prescribed over those regions.
\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-MP-Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
Let the tied contact traction be described by the penalty function, 
\begin_inset Formula 
\begin{equation}
\mathbf{t}=\varepsilon_{n}\mathbf{g}\,,\label{eq703-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}$
\end_inset

.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
w_{n}=\varepsilon_{p}\pi=\varepsilon_{p}\left(\tilde{p}^{\left(1\right)}-\tilde{p}^{\left(2\right)}\right)\,,\label{eq704-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{p}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $w_{n}$
\end_inset

, and
\begin_inset Formula 
\begin{equation}
j_{n}^{\alpha}=\varepsilon_{c}\chi^{\alpha}=\varepsilon_{c}^{\alpha}\left(\tilde{c}^{\alpha\left(1\right)}-\tilde{c}^{\alpha\left(2\right)}\right)\,,\label{eq704-1b}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{c}^{\alpha}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $j_{n}^{\alpha}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t} & =\varepsilon_{n}\left(\Delta\mathbf{u}^{\left(2\right)}-\Delta\mathbf{u}^{\left(1\right)}\right)\,,\\
Dw_{n} & =\varepsilon_{p}\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\,,\\
Dj_{n}^{\alpha} & =\varepsilon_{c}^{\alpha}\left(\Delta\tilde{c}^{\alpha\left(1\right)}-\Delta\tilde{c}^{\alpha\left(2\right)}\right)\,.
\end{aligned}
\label{eq705-1}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\right)=\\
 & \left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\varepsilon_{n}J_{\eta}^{\left(1\right)}\mathbf{I}\cdot\left(\Delta\mathbf{u}^{\left(1\right)}-\Delta\mathbf{u}^{\left(2\right)}\right)\\
 & +\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}\otimes\left[\left(\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}-\left(\mathbf{g}_{2}^{\left(1\right)}\times\mathbf{n}^{\left(1\right)}\right)\cdot\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}\right]
\end{aligned}
\,,\label{eq706-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\varepsilon_{p}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\left(\Delta\tilde{p}^{\left(1\right)}-\Delta\tilde{p}^{\left(2\right)}\right)\\
 & +w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=\\
 & -J_{\eta}^{\left(1\right)}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\varepsilon_{c}^{\alpha}\left(\Delta\tilde{c}^{\alpha\left(1\right)}-\Delta\tilde{c}^{\alpha\left(2\right)}\right)\\
 & +j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\mathbf{n}^{\left(1\right)}\cdot\left(\mathbf{g}_{2}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\times\frac{\partial\Delta\mathbf{u}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)
\end{aligned}
\,,\label{eq707-1b}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization-1"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}+w_{n}\left(\delta p^{\left(1\right)}-\delta p^{\left(2\right)}\right)+\sum_{\alpha}j_{n}^{\alpha}\left(\delta\tilde{c}^{\alpha\left(1\right)}-\delta\tilde{c}^{\alpha\left(2\right)}\right)\right]\,.\label{eq708-1}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{u}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{u}_{c}^{\left(1\right)} & \Delta\mathbf{u}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\delta\tilde{p}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{p}_{a}^{\left(1\right)} & \delta p^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{p}_{b}^{\left(2\right)}\\
\Delta\tilde{p}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{p}_{c}^{\left(1\right)} & \Delta\tilde{p}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{p}_{d}^{\left(2\right)}\\
\delta\tilde{c}^{\alpha\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta c^{\alpha\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\tilde{c}_{b}^{\alpha\left(2\right)}\\
\Delta\tilde{c}^{\alpha\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\tilde{c}_{c}^{\alpha\left(1\right)} & \Delta\tilde{c}^{\alpha\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\tilde{c}_{d}^{\alpha\left(2\right)}
\end{aligned}
\,.\label{eq709-1}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}^{\alpha\left(1\right)} & \delta\tilde{c}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
w_{a}^{\left(1\right)}\\
j_{n}^{\alpha\left(1\right)}\\
j_{n}^{\beta\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta\tilde{p}_{b,k}^{\left(1\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(1\right)} & \delta\tilde{c}_{b,k}^{\beta\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
w_{b,k}^{\left(1\right)}\\
j_{b,k}^{\alpha\left(1\right)}\\
j_{b,k}^{\beta\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq710-1}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}\\
w_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}w_{n} & w_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}w_{n}\\
j_{a}^{\gamma\left(1\right)} & =N_{a}^{\left(1\right)}j_{n}^{\gamma} & j_{b,k}^{\gamma\left(2\right)} & =-N_{b}^{\left(2\right)}j_{n}^{\gamma}
\end{aligned}
\,.\label{eq711-1}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\tilde{p}_{a}^{\left(1\right)} & \delta\tilde{c}_{a}^{\alpha\left(1\right)} & \delta\tilde{c}_{a}^{\beta\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{ac}^{\left(1,1\right)} & k_{ac}^{\left(1,1\right)} & 0 & 0\\
\mathbf{k}_{ac}^{\alpha\left(1,1\right)} & 0 & k_{ac}^{\alpha\alpha\left(1,1\right)} & 0\\
\mathbf{k}_{ac}^{\beta\left(1,1\right)} & 0 & 0 & k_{ac}^{\beta\beta\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}\\
\Delta\tilde{c}_{c}^{\beta\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)} & 0 & 0\\
\mathbf{0} & 0 & k_{ad,k}^{\alpha\alpha\left(1,2\right)} & 0\\
\mathbf{0} & 0 & 0 & k_{ad,k}^{\beta\beta\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta\tilde{p}_{b,k}^{\left(2\right)} & \delta\tilde{c}_{b,k}^{\alpha\left(2\right)} & \delta\tilde{c}_{b,k}^{\beta\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & k_{bc,k}^{\left(2,1\right)} & 0 & 0\\
\mathbf{k}_{bc,k}^{\alpha\left(2,1\right)} & 0 & k_{bc,k}^{\alpha\alpha\left(2,1\right)} & 0\\
\mathbf{k}_{bc,k}^{\beta\left(2,1\right)} & 0 & 0 & k_{bc,k}^{\beta\beta\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{c}^{\left(1\right)}\\
\Delta\tilde{p}_{c}^{\left(1\right)}\\
\Delta\tilde{c}_{c}^{\alpha\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cccc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)} & 0 & 0\\
\mathbf{0} & 0 & k_{bd,k}^{\alpha\alpha\left(2,2\right)} & 0\\
\mathbf{0} & 0 & 0 & k_{bd,k}^{\beta\beta\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{u}_{d}^{\left(2\right)}\\
\Delta\tilde{p}_{d}^{\left(2\right)}\\
\Delta\tilde{c}_{d}^{\alpha\left(2\right)}\\
\Delta\tilde{c}_{d}^{\beta\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq712-1}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\mathbf{I}\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}\left(\varepsilon_{n}N_{c}^{\left(1\right)}\mathbf{I}+\mathbf{t}\otimes\mathbf{a}_{c}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\mathbf{I}
\end{aligned}
\,,\label{eq713-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{k}_{ac}^{\left(1,1\right)} & =N_{a}^{\left(1\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\left(2,1\right)} & =-N_{b}^{\left(2\right)}w_{n}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{ac}^{\alpha\left(1,1\right)} & =N_{a}^{\left(1\right)}j_{n}^{\alpha}\mathbf{a}_{c}^{\left(1\right)}\\
\mathbf{k}_{bc,k}^{\alpha\left(2,1\right)} & =-N_{b}^{\left(2\right)}j_{n}^{\alpha}\mathbf{a}_{c}^{\left(1\right)}
\end{aligned}
\,,\label{eq714-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-\varepsilon_{p}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =\varepsilon_{p}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =\varepsilon_{p}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-\varepsilon_{p}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,,\label{eq715-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\gamma\gamma\left(1,1\right)} & =-\varepsilon_{c}^{\gamma}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\gamma\gamma\left(1,2\right)} & =\varepsilon_{c}^{\gamma}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\gamma\gamma\left(2,1\right)} & =\varepsilon_{c}^{\gamma}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\gamma\gamma\left(2,2\right)} & =-\varepsilon_{c}^{\gamma}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\label{eq715-1b}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\mathbf{a}_{c}^{\left(1\right)}=\frac{1}{J_{\eta}^{\left(1\right)}}\mathbf{n}^{\left(1\right)}\times\left(\mathbf{g}_{2}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{1}}-\mathbf{g}_{1}^{\left(1\right)}\frac{\partial N_{c}^{\left(1\right)}}{\partial\eta_{\left(1\right)}^{2}}\right)\,.\label{eq716-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Tied Fluid Interface
\begin_inset CommandInset label
LatexCommand label
name "sec:Tied-Fluid-Interface"

\end_inset

 
\end_layout

\begin_layout Standard
Under isothermal conditions which preclude any heat flux and for which the
 entropy is zero, the interface jump conditions derived from mass, linear
 momentum and energy balance across an interface 
\begin_inset Formula $\Gamma$
\end_inset

 which is permeable to the fluid are
\begin_inset Formula 
\begin{equation}
\left[\left[\rho\mathbf{u}^{\Gamma}\right]\right]\cdot\mathbf{n}^{\Gamma}=0\,,\label{eq:jump-mass}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\left[\left[\boldsymbol{\sigma}-\rho\mathbf{u}^{\Gamma}\otimes\mathbf{u}^{\Gamma}\right]\right]\cdot\mathbf{n}^{\Gamma}=\mathbf{0}\,,\label{eq:jump-linear-momentum}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\left[\left[\rho\left(\psi+\frac{1}{2}\mathbf{u}^{\Gamma}\cdot\mathbf{u}^{\Gamma}\right)\mathbf{u}^{\Gamma}-\boldsymbol{\sigma}^{T}\cdot\mathbf{u}^{\Gamma}\right]\right]\cdot\mathbf{n}^{\Gamma}=0\label{eq:jump-energy}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{u}^{\Gamma}\equiv\mathbf{v}-\mathbf{v}^{\Gamma}\label{eq:Gamma-diffusive-velocity}
\end{equation}

\end_inset

 
\begin_inset Formula $\rho$
\end_inset

, 
\begin_inset Formula $\mathbf{v}$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 and 
\begin_inset Formula $\psi$
\end_inset

 are the mass density, velocity, stress tensor and specific free energy
 of the fluid, respectively, and 
\begin_inset Formula $\mathbf{v}^{\Gamma}$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}^{\Gamma}$
\end_inset

 are the velocity of, and outward unit normal to 
\begin_inset Formula $\Gamma$
\end_inset

, respectively.
 A tied fluid interface 
\begin_inset Formula $\Gamma$
\end_inset

, which allows fluid to cross 
\begin_inset Formula $\Gamma$
\end_inset

, must enforce these continuity requirements.
 For fluid analyses, we let
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\tau}
\]

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure and 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous shear stress.
 Susbtituting this relation into the energy jump of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jump-energy"
plural "false"
caps "false"
noprefix "false"

\end_inset

, neglecting the contribution of 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 relative to that of 
\begin_inset Formula $p$
\end_inset

, and making use of the jump condition from mass balance in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jump-mass"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we find that
\begin_inset Formula 
\begin{equation}
\left[\left[\psi+\frac{p}{\rho}+\frac{1}{2}\mathbf{u}^{\Gamma}\cdot\mathbf{u}^{\Gamma}\right]\right]=0\,.\label{eq:jump-energy-redux}
\end{equation}

\end_inset

Since 
\begin_inset Formula $\psi$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 are functions of state that only depend on the fluid volume ratio 
\begin_inset Formula $J$
\end_inset

 (in an isothermal analysis, see eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:elastic-pressure"
plural "false"
caps "false"
noprefix "false"

\end_inset

), letting 
\begin_inset Formula $J$
\end_inset

 be continuous across 
\begin_inset Formula $\Gamma$
\end_inset

 implies from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-integrated"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that 
\begin_inset Formula $\rho$
\end_inset

 is continuous across 
\begin_inset Formula $\Gamma$
\end_inset

; thus, from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mass-balance-integrated"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we conclude that 
\begin_inset Formula $\mathbf{u}^{\Gamma}\cdot\mathbf{n}$
\end_inset

 is continuous, hence eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jump-energy-redux"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is satisfied.
 In other words, letting 
\begin_inset Formula $\left[\left[J\right]\right]=0$
\end_inset

 is a sufficient (but not necessary) condition to satisfy the jump conditions
 from mass and energy balance, as long as we also enforce 
\begin_inset Formula $\left[\left[\mathbf{u}^{\Gamma}\right]\right]\cdot\mathbf{n}=0$
\end_inset

.
 For a viscous fluid, we also assume that the no-slip condition holds, implying
 that our jump requirement for the fluid velocity is even more stringent,
 namely 
\begin_inset Formula $\left[\left[\mathbf{u}^{\Gamma}\right]\right]=\mathbf{0}$
\end_inset

 (or equivalently, 
\begin_inset Formula $\left[\left[\mathbf{v}\right]\right]=\mathbf{0}$
\end_inset

).
 According to the above relations between the stress and pressure, and recognizi
ng that 
\begin_inset Formula $\left[\left[J\right]\right]=0$
\end_inset

 implies 
\begin_inset Formula $\left[\left[p\right]\right]=0$
\end_inset

, we may also simplify the linear momentum jump condition of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jump-linear-momentum"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to 
\begin_inset Formula $\left[\left[\boldsymbol{\tau}\right]\right]\cdot\mathbf{n}^{\Gamma}=\mathbf{0}$
\end_inset

.
 Therefore, the jump conditions that we need to enforce for a tied fluid
 interface 
\begin_inset Formula $\Gamma$
\end_inset

 are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left[\left[J\right]\right] & =0\\
\left[\left[\mathbf{v}\right]\right] & =\mathbf{0}\\
\left[\left[\boldsymbol{\tau}\right]\right]\cdot\mathbf{n}^{\Gamma} & =\mathbf{0}
\end{aligned}
\,.\label{eq:jump-tied-fluid}
\end{equation}

\end_inset

These jump conditions are consistent with the choice of nodal degrees of
 freedom for fluid analyses (namely, 
\begin_inset Formula $\mathbf{v}$
\end_inset

 and 
\begin_inset Formula $J$
\end_inset

).
 On a tied (or sliding) fluid interface, we don't have continuity of the
 mesh, therefore we can only enforce continuity of 
\begin_inset Formula $J$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 by enforcing continuity of the fluid pressure 
\begin_inset Formula $p$
\end_inset

 and viscous traction 
\begin_inset Formula $\mathbf{t}^{\tau}\equiv\boldsymbol{\tau}\cdot\mathbf{n}^{\Gamma}$
\end_inset

.
 However, in our fluid finite element formulation, 
\begin_inset Formula $p$
\end_inset

 is not a natural boundary condition since it is calculated directly from
 
\begin_inset Formula $J$
\end_inset

.
 Instead, as explained in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Computational-Fluid-Dynamics"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the natural boundary condition for the fluid dilatation governing equation
 is continuity of 
\begin_inset Formula $v_{n}$
\end_inset

 across 
\begin_inset Formula $\Gamma$
\end_inset

, thus 
\begin_inset Formula $\left[\left[\mathbf{v}\right]\right]\cdot\mathbf{n}^{\Gamma}=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Contact Integral
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Fluid-Contact-Integral"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluid-Mechanics"

\end_inset

 for a review of fluid materials, and 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian18"
literal "true"

\end_inset

 for additional details on the FEBio fluid solver.
 The tied fluid interface is defined between surfaces 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 Due to continuity requirements on the viscous traction and normal fluid
 velocity, the external virtual work resulting from tractions 
\begin_inset Formula $\mathbf{t}^{\tau\left(i\right)}$
\end_inset

 and normal velocities 
\begin_inset Formula $v_{n}^{\left(i\right)}$
\end_inset

 (
\begin_inset Formula $i=1,2)$
\end_inset

 may be combined into the tied interface integral 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau\left(1\right)}da^{\left(1\right)}\\
 & -\int_{\gamma^{\left(1\right)}}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}^{\left(1\right)}da^{\left(1\right)}\,.
\end{aligned}
\label{eq696-2}
\end{equation}

\end_inset

To evaluate and linearize 
\begin_inset Formula $\delta G_{c}$
\end_inset

, define the covariant basis vectors on each surface as 
\begin_inset Formula 
\begin{equation}
\mathbf{g}_{\alpha}^{\left(i\right)}=\frac{\partial\mathbf{x}^{\left(i\right)}}{\partial\eta_{\left(i\right)}^{\alpha}},\quad\alpha=1,2,\label{eq697-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 represents the spatial position of points on 
\begin_inset Formula $\gamma^{\left(i\right)}$
\end_inset

, and 
\begin_inset Formula $\eta_{\left(i\right)}^{\alpha}$
\end_inset

 represent the parametric coordinates of that point.
 The unit outward normal on each surface is then given by 
\begin_inset Formula 
\begin{equation}
\mathbf{n}^{\left(i\right)}=\frac{\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}}{\left|\mathbf{g}_{1}^{\left(i\right)}\times\mathbf{g}_{2}^{\left(i\right)}\right|}\,.\label{eq698-2}
\end{equation}

\end_inset

Now the contact integral may be rewritten as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\int_{\gamma^{\left(1\right)}}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}\,\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}\\
 & +\int_{\gamma^{\left(1\right)}}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|\,d\eta_{\left(1\right)}^{1}d\eta_{\left(1\right)}^{2}
\end{aligned}
\,,\label{eq699-2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}^{\tau}\equiv\mathbf{t}^{\tau\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $v_{n}\equiv v_{n}^{\left(1\right)}$
\end_inset

.
 The linearization 
\begin_inset Formula $D\delta G_{c}$
\end_inset

 of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 has the form 
\begin_inset Formula 
\begin{equation}
D\delta G_{c}=\sum\limits _{i=1}^{2}D\delta G_{c}\left[\Delta\mathbf{v}^{\left(i\right)}\right]+D\delta G_{c}\left[\Delta J^{\left(i\right)}\right]\,.\label{eq700-2}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Gap Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Fluid-Gap-Function"

\end_inset


\end_layout

\begin_layout Standard
The premise of a tied interface is that the parametric coordinates of coincident
 points 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 and 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

 are both invariants (i.e., they are determined in the reference configuration
 and remain unchanged over time).
 The parametric coordinates of 
\begin_inset Formula $\mathbf{x}^{\left(1\right)}$
\end_inset

 correspond to the integration points on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

, and those of 
\begin_inset Formula $\mathbf{x}^{\left(2\right)}$
\end_inset

 are evaluated once by shooting a ray from the integration point on 
\begin_inset Formula $\gamma^{\left(1\right)}$
\end_inset

 to intersect 
\begin_inset Formula $\gamma^{\left(2\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The vector gap function 
\begin_inset Formula $\mathbf{g}$
\end_inset

, representing the difference between velocities across the interface, is
 defined by 
\begin_inset Formula 
\begin{equation}
\mathbf{g}=\mathbf{v}^{\left(2\right)}-\mathbf{v}^{\left(1\right)}\,,\label{TFI-vt-gap}
\end{equation}

\end_inset

We may similarly define the scalar gap function 
\begin_inset Formula $\pi$
\end_inset

, representing the difference between fluid dilatations (or volume ratios)
 across the interface,
\begin_inset Formula 
\begin{equation}
\pi=J^{\left(2\right)}-J^{\left(1\right)}\,.\label{eq:TFI-e-gap}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Penalty Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Penalty-Method-1"

\end_inset


\end_layout

\begin_layout Standard
Let the tied interface viscous traction be described by the penalty function,
 
\begin_inset Formula 
\begin{equation}
\mathbf{t}^{\tau}=\varepsilon_{t}\mathbf{g}\,,\label{eq:TFI-t-penalty}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{t}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

.
 The penalty factor 
\begin_inset Formula $\varepsilon_{t}$
\end_inset

 is expressed in units of viscosity per length.
 Therefore, in an auto-penalty scheme, it may be scaled to the ratio of
 fluid viscosity to element thickness.
 Similarly, let 
\begin_inset Formula 
\begin{equation}
v_{n}=\varepsilon_{n}\pi=\varepsilon_{n}\left(J^{\left(2\right)}-J^{\left(1\right)}\right)\,,\label{eq:TFI-v-penalty}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 is a penalty factor associated with 
\begin_inset Formula $v_{n}$
\end_inset

.
 Note that 
\begin_inset Formula $\varepsilon_{n}$
\end_inset

 has units of velocity.
 It follows that 
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\mathbf{t}^{\tau} & =\varepsilon_{t}\left(\Delta\mathbf{v}^{\left(2\right)}-\Delta\mathbf{v}^{\left(1\right)}\right)\,,\\
Dv_{n} & =\varepsilon_{n}\left(\Delta J^{\left(2\right)}-\Delta J^{\left(1\right)}\right)\,.
\end{aligned}
\label{eq:TFI-penalty-linearization}
\end{equation}

\end_inset

Given these relations, it can be shown that the directional derivatives
 of the various terms appearing in the integrand of 
\begin_inset Formula $\delta G_{c}$
\end_inset

 are 
\begin_inset Formula 
\begin{equation}
\begin{aligned} & -D\left(J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}\right)=\\
 & \varepsilon_{t}J_{\eta}^{\left(1\right)}\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\left(\Delta\mathbf{v}^{\left(1\right)}-\Delta\mathbf{v}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq:TFI-G-linearization-v}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
D\left(v_{n}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)J_{\eta}^{\left(1\right)}\right)=-\varepsilon_{n}J_{\eta}^{\left(1\right)}\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)\left(\Delta J^{\left(1\right)}-\Delta J^{\left(2\right)}\right)\,,\label{eq:TFI-G-linearization-e}
\end{equation}

\end_inset

where 
\begin_inset Formula $J_{\eta}^{\left(1\right)}=\left|\mathbf{g}_{1}^{\left(1\right)}\times\mathbf{g}_{2}^{\left(1\right)}\right|$
\end_inset

.
\end_layout

\begin_layout Subsection
Discretization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-BP-Discretization-2"

\end_inset


\end_layout

\begin_layout Standard
The contact integral may be discretized as 
\begin_inset Formula 
\begin{equation}
\delta G_{c}=\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left[\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{t}^{\tau}-\left(\delta J^{\left(1\right)}-\delta J^{\left(2\right)}\right)v_{n}\right]\,.\label{eq:TFI-discrete-1}
\end{equation}

\end_inset

The variables may be interpolated over each element face according to 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta\mathbf{v}_{a}^{\left(1\right)} & \delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta\mathbf{v}_{b}^{\left(2\right)}\\
\Delta\mathbf{v}^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta\mathbf{v}_{c}^{\left(1\right)} & \Delta\mathbf{v}^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\delta J^{\left(1\right)} & =\sum\limits _{a=1}^{m^{\left(1\right)}}N_{a}^{\left(1\right)}\delta J_{a}^{\left(1\right)} & \delta J^{\left(2\right)} & =\sum\limits _{b=1}^{m^{\left(2\right)}}N_{b}^{\left(2\right)}\delta J_{b}^{\left(2\right)}\\
\Delta J^{\left(1\right)} & =\sum\limits _{c=1}^{m^{\left(1\right)}}N_{c}^{\left(1\right)}\Delta J_{c}^{\left(1\right)} & \Delta J^{\left(2\right)} & =\sum\limits _{d=1}^{m^{\left(2\right)}}N_{d}^{\left(2\right)}\Delta J_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq:TFI-discrete-2}
\end{equation}

\end_inset

Then, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta J_{a}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{a}^{\left(1\right)}\\
v_{a}^{\left(1\right)}
\end{array}\right]\right.\\
 & \left.+\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(1\right)} & \delta J_{b,k}^{\left(1\right)}\end{array}\right]\cdot\left[\begin{array}{c}
\mathbf{f}_{b,k}^{\left(1\right)}\\
v_{b,k}^{\left(1\right)}
\end{array}\right]\right)
\end{aligned}
\,,\label{eq:TFI-discrete-3}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{f}_{a}^{\left(1\right)} & =N_{a}^{\left(1\right)}\mathbf{t}^{\tau} & \mathbf{f}_{b,k}^{\left(2\right)} & =-N_{b}^{\left(2\right)}\mathbf{t}^{\tau}\\
w_{a}^{\left(1\right)} & =-N_{a}^{\left(1\right)}v_{n} & w_{b,k}^{\left(2\right)} & =N_{b}^{\left(2\right)}v_{n}
\end{aligned}
\,.\label{eq:TFI-discrete-4}
\end{equation}

\end_inset

Similarly, 
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G_{c} & =\sum\limits _{e=1}^{n_{e}^{\left(1\right)}}\sum\limits _{k=1}^{n_{\mbox{int}}^{\left(e\right)}}W_{k}J_{\eta}^{\left(1\right)}\\
 & \times\left(\sum\limits _{a=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{a}^{\left(1\right)} & \delta J_{a}^{\left(1\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ac}^{\left(1,1\right)} & \mathbf{0}\\
\mathbf{0} & k_{ac}^{\left(1,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{c}^{\left(1\right)}\\
\Delta J_{c}^{\left(1\right)}
\end{array}\right]\right.\right.\\
 & +\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{ad,k}^{\left(1,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{ad,k}^{\left(1,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\Delta J_{d}^{\left(2\right)}
\end{array}\right]\right)\\
 & +\sum\limits _{b=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\delta\mathbf{v}_{b,k}^{\left(2\right)} & \delta J_{b,k}^{\left(2\right)}\end{array}\right]\cdot\left(\sum\limits _{c=1}^{m^{\left(1\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bc,k}^{\left(2,1\right)} & \mathbf{0}\\
\mathbf{0} & k_{bc,k}^{\left(2,1\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{c}^{\left(1\right)}\\
\Delta J_{c}^{\left(1\right)}
\end{array}\right]\right.\\
 & +\left.\left.\sum\limits _{d=1}^{m_{k}^{\left(2\right)}}\left[\begin{array}{cc}
\mathbf{K}_{bd,k}^{\left(2,2\right)} & \mathbf{0}\\
\mathbf{0} & k_{bd,k}^{\left(2,2\right)}
\end{array}\right]\cdot\left[\begin{array}{c}
\Delta\mathbf{v}_{d}^{\left(2\right)}\\
\Delta J_{d}^{\left(2\right)}
\end{array}\right]\right)\right)\,,
\end{aligned}
\label{eq:TFI-discrete-5}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{K}_{ac}^{\left(1,1\right)} & =\varepsilon_{t}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{K}_{ad,k}^{\left(1,2\right)} & =-\varepsilon_{t}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)\\
\mathbf{K}_{bc,k}^{\left(2,1\right)} & =-\varepsilon_{t}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\left(\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\\
\mathbf{K}_{bd,k}^{\left(2,2\right)} & =\varepsilon_{t}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}\left(\mathbf{I}-\mathbf{n}^{\left(2\right)}\otimes\mathbf{n}^{\left(2\right)}\right)
\end{aligned}
\,,\label{eq:TFI-discrete-6}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\begin{aligned}k_{ac}^{\left(1,1\right)} & =-K\varepsilon_{n}N_{a}^{\left(1\right)}N_{c}^{\left(1\right)}\\
k_{ad,k}^{\left(1,2\right)} & =K\varepsilon_{n}N_{a}^{\left(1\right)}N_{d}^{\left(2\right)}\\
k_{bc,k}^{\left(2,1\right)} & =K\varepsilon_{n}N_{b}^{\left(2\right)}N_{c}^{\left(1\right)}\\
k_{bd,k}^{\left(2,2\right)} & =-K\varepsilon_{n}N_{b}^{\left(2\right)}N_{d}^{\left(2\right)}
\end{aligned}
\,.\label{eq:TFI-discrete-7}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Rigid Connectors
\begin_inset CommandInset label
LatexCommand label
name "sec:Rigid-Connectors"

\end_inset


\end_layout

\begin_layout Standard
A 
\emph on
rigid connector
\emph default
 connects two rigid bodies denoted by 
\begin_inset Formula $\left(1\right)$
\end_inset

 and 
\begin_inset Formula $\left(2\right)$
\end_inset

.
 The connector origin (e.g., its insertion point) on rigid body 
\begin_inset Formula $\left(i\right)$
\end_inset

 is located at
\begin_inset Formula 
\begin{equation}
\mathbf{x}^{\left(i\right)}=\mathbf{r}^{\left(i\right)}+\boldsymbol{\Lambda}^{\left(i\right)}\cdot\mathbf{Z}^{\left(i\right)}=\mathbf{r}^{\left(i\right)}+\mathbf{z}^{\left(i\right)}\,,\label{eq:rc-origin-positions}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{z}^{\left(i\right)}$
\end_inset

 is the connector origin position relative to the center of mass at the
 current time, whereas 
\begin_inset Formula $\mathbf{Z}^{\left(i\right)}$
\end_inset

 is its relative position in the reference configuration, when the rotation
 tensor 
\begin_inset Formula $\boldsymbol{\Lambda}^{\left(i\right)}$
\end_inset

 is equal to the identity tensor.
 The connector is exerting a reaction force 
\begin_inset Formula $\mathbf{f}^{\left(i\right)}$
\end_inset

 at 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 and a reaction moment 
\begin_inset Formula $\mathbf{m}^{\left(i\right)}$
\end_inset

 on rigid body 
\begin_inset Formula $\left(i\right)$
\end_inset

, such that 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}+\mathbf{f}^{\left(2\right)}=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}+\mathbf{m}^{\left(2\right)}=\mathbf{0}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Rigid body joints, such as spherical, revolute, prismatic, cylindrical and
 planar joints, are a special category of rigid connectors that have a large
 stiffness spring connecting the joint origins on each rigid body, in a
 manner that only allows relative motion along the joint translational degree(s)
 of freedom.
 Similarly, a large stiffness torsional spring connects the rigid bodies
 in a manner that only allows relative rotation along the joint rotational
 degree(s) of freedom.
\end_layout

\begin_layout Standard
Other connectors include springs, dampers, and contractile forces that may
 connect rigid bodies.
 Optionally, a joint may include a linear damper connecting its origins,
 and an angular damper restricting its relative rotation.
\end_layout

\begin_layout Subsection
Virtual Work
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Connector-Virtual-Work"

\end_inset


\end_layout

\begin_layout Standard
The virtual work of a connector represents the work of external forces on
 the rigid body; it is given by
\begin_inset Formula 
\begin{equation}
\delta G=\sum_{i=1}^{2}\delta\mathbf{v}^{\left(i\right)}\cdot\mathbf{f}^{\left(i\right)}+\delta\boldsymbol{\theta}^{\left(i\right)}\cdot\mathbf{m}^{\left(i\right)}\,,\label{eq:rc-virtual-work}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta\mathbf{v}^{\left(i\right)}$
\end_inset

 is the virtual velocity of the joint origin and 
\begin_inset Formula $\delta\boldsymbol{\theta}^{\left(i\right)}$
\end_inset

 is the virtual angular velocity of rigid body 
\begin_inset Formula $\left(i\right)$
\end_inset

.
 Using the above relations for 
\begin_inset Formula $\mathbf{f}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\mathbf{m}^{\left(i\right)}$
\end_inset

, it reduces to
\begin_inset Formula 
\begin{equation}
\delta G=\left(\delta\mathbf{v}^{\left(1\right)}-\delta\mathbf{v}^{\left(2\right)}\right)\cdot\mathbf{f}^{\left(1\right)}+\left(\delta\boldsymbol{\theta}^{\left(1\right)}-\delta\boldsymbol{\theta}^{\left(2\right)}\right)\cdot\mathbf{m}^{\left(1\right)}\,.\label{eq:rc-virtual-work-redux}
\end{equation}

\end_inset

The analysis thus returns the values of the reaction force and moment acting
 on rigid body 
\begin_inset Formula $\left(1\right)$
\end_inset

.
 The virtual velocities at the joint may be evaluated from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-origin-positions"

\end_inset

 as
\begin_inset Formula 
\begin{equation}
\delta\mathbf{v}^{\left(i\right)}=\delta\mathbf{r}^{\left(i\right)}-\hat{\mathbf{z}}^{\left(i\right)}\cdot\delta\boldsymbol{\theta}^{\left(i\right)}\,,\label{eq:rc-origin-virtual-displacement}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\mathbf{z}}$
\end_inset

 is the skew-symmetric tensor whose dual vector is 
\begin_inset Formula $\mathbf{z}$
\end_inset

, such that 
\begin_inset Formula $\hat{\mathbf{z}}\cdot\mathbf{v}=\mathbf{z}\times\mathbf{v}$
\end_inset

 for any vector 
\begin_inset Formula $\mathbf{v}$
\end_inset

.
 Substituting this expression into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-virtual-work-redux"

\end_inset

 allows us to express the virtual work in terms of the virtual velocities
 of the centers of mass and the virtual angular velocities of the rigid
 bodies,
\begin_inset Formula 
\begin{equation}
\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\theta}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\theta}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}^{\left(1\right)}\\
\hat{\mathbf{z}}^{\left(1\right)}\cdot\mathbf{f}^{\left(1\right)}+\mathbf{m}^{\left(1\right)}\\
-\mathbf{f}^{\left(1\right)}\\
-\hat{\mathbf{z}}^{\left(2\right)}\cdot\mathbf{f}^{\left(1\right)}-\mathbf{m}^{\left(1\right)}
\end{array}\right]\,.\label{eq:rc-virtual-work-final}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
When using time discretization in the interval 
\begin_inset Formula $\left[t_{n},t_{n+1}\right]$
\end_inset

, the external forces and moments may be evaluated at the intermediate time
 point 
\begin_inset Formula $t_{n+\alpha}$
\end_inset

 using
\begin_inset Formula 
\[
\begin{aligned}\mathbf{f}_{n+\alpha}^{\left(1\right)} & =\alpha\mathbf{f}_{n+1}^{\left(1\right)}+\left(1-\alpha\right)\mathbf{f}_{n}^{\left(1\right)}\\
\left(\hat{\mathbf{z}}^{\left(1\right)}\cdot\mathbf{f}^{\left(1\right)}\right)_{n+\alpha} & =\alpha\hat{\mathbf{z}}_{n+1}^{\left(1\right)}\cdot\mathbf{f}_{n+1}^{\left(1\right)}+\left(1-\alpha\right)\hat{\mathbf{z}}_{n}^{\left(1\right)}\cdot\mathbf{f}_{n}^{\left(1\right)}\\
\mathbf{m}_{n+\alpha}^{\left(1\right)} & =\alpha\mathbf{m}_{n+1}^{\left(1\right)}+\left(1-\alpha\right)\mathbf{m}_{n}^{\left(1\right)}
\end{aligned}
\]

\end_inset

We solve for 
\begin_inset Formula $\delta G=0$
\end_inset

 using Newton's method in the usual manner, by evaluating the linearization
 of 
\begin_inset Formula $\delta G$
\end_inset

 along increments in the rigid body degrees of freedom at 
\begin_inset Formula $t_{n+1}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\delta G+\sum_{i=1}^{2}D\delta G\left[\Delta\mathbf{r}^{\left(i\right)}\right]+D\delta G\left[\Delta\boldsymbol{\theta}^{\left(i\right)}\right]\approx0\,.\label{eq:rc-Newton-method}
\end{equation}

\end_inset

Assuming that
\begin_inset Formula 
\begin{equation}
D\mathbf{f}_{n+1}^{\left(1\right)}=\left[\begin{array}{cccc}
\mathbf{K}_{fr}^{\left(1\right)} & \mathbf{K}_{f\theta}^{\left(1\right)} & \mathbf{K}_{fr}^{\left(2\right)} & \mathbf{K}_{f\theta}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rc-Df}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\mathbf{m}_{n+1}^{\left(1\right)}=\left[\begin{array}{cccc}
\mathbf{K}_{mr}^{\left(1\right)} & \mathbf{K}_{m\theta}^{\left(1\right)} & \mathbf{K}_{mr}^{\left(2\right)} & \mathbf{K}_{m\theta}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rc-Dm}
\end{equation}

\end_inset

it follows that
\begin_inset Formula 
\begin{equation}
\begin{aligned}D\delta G= & \left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\theta}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\theta}^{\left(2\right)}\end{array}\right]\times\\
 & \alpha\left[\begin{array}{cccc}
\mathbf{K}_{fr}^{\left(1\right)} & \mathbf{K}_{f\theta}^{\left(1\right)} & \mathbf{K}_{fr}^{\left(2\right)} & \mathbf{K}_{f\theta}^{\left(2\right)}\\
\hat{\mathbf{z}}_{n+1}^{\left(1\right)}\cdot\mathbf{K}_{fr}^{\left(1\right)}+\mathbf{K}_{mr}^{\left(1\right)} & \hat{\mathbf{z}}_{n+1}^{\left(1\right)}\cdot\mathbf{K}_{f\theta}^{\left(1\right)}+\mathbf{K}_{m\theta}^{\left(1\right)} & \hat{\mathbf{z}}_{n+1}^{\left(1\right)}\cdot\mathbf{K}_{fr}^{\left(2\right)}+\mathbf{K}_{mr}^{\left(2\right)} & \hat{\mathbf{z}}_{n+1}^{\left(1\right)}\cdot\mathbf{K}_{f\theta}^{\left(2\right)}+\mathbf{K}_{m\theta}^{\left(2\right)}\\
-\mathbf{K}_{fr}^{\left(1\right)} & -\mathbf{K}_{f\theta}^{\left(1\right)} & -\mathbf{K}_{fr}^{\left(2\right)} & -\mathbf{K}_{f\theta}^{\left(2\right)}\\
-\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\cdot\mathbf{K}_{fr}^{\left(1\right)}-\mathbf{K}_{mr}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\cdot\mathbf{K}_{f\theta}^{\left(1\right)}-\mathbf{K}_{m\theta}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\cdot\mathbf{K}_{fr}^{\left(2\right)}-\mathbf{K}_{mr}^{\left(2\right)} & -\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\cdot\mathbf{K}_{f\theta}^{\left(2\right)}-\mathbf{K}_{m\theta}^{\left(2\right)}
\end{array}\right]\\
 & \times\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]
\end{aligned}
\label{eq:rc-linearized-work}
\end{equation}

\end_inset

It becomes immediately apparent that the stiffness matrix for a rigid connector
 is not symmetric.
 Therefore, rigid body dynamics should be analyzed using non-symmetric solvers.
\end_layout

\begin_layout Subsection
Joint Axes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Axes"

\end_inset


\end_layout

\begin_layout Standard
Joint axes are used to define the directions of degrees of freedom in rigid
 joints, which represent one of the major categories of rigid connectors.
 The axes are defined with respect to a body-based coordinate system centered
 at the origin of a joint, given by the orthonormal triad 
\begin_inset Formula $\left\{ \mathbf{e}_{1}^{\left(i\right)},\mathbf{e}_{2}^{\left(i\right)},\mathbf{e}_{3}^{\left(i\right)}\right\} $
\end_inset

 for rigid body 
\begin_inset Formula $i$
\end_inset

 (
\begin_inset Formula $i=1,2$
\end_inset

).
 In the reference configuration, the bases coincide on both rigid bodies,
 
\begin_inset Formula $\mathbf{e}_{j}^{\left(1\right)}=\mathbf{e}_{j}^{\left(2\right)}\equiv\mathbf{E}_{j}$
\end_inset

 (
\begin_inset Formula $j=1,2,3$
\end_inset

), where 
\begin_inset Formula $\mathbf{E}_{j}$
\end_inset

 is the 
\begin_inset Formula $j-$
\end_inset

th basis vector in the reference configuration.
 Thus, at any time 
\begin_inset Formula $t$
\end_inset

, we may evaluate the basis vectors as
\begin_inset Formula 
\begin{equation}
\mathbf{e}_{j}^{\left(i\right)}=\boldsymbol{\Lambda}^{\left(i\right)}\cdot\mathbf{E}_{j}\label{eq:ja-basis-currnet-time}
\end{equation}

\end_inset

Using this relation, the linearization of a basis vector along increments
 in the rigid body motion is given by
\begin_inset Formula 
\begin{equation}
D\mathbf{e}_{j}^{\left(i\right)}=-\hat{\mathbf{e}}_{j}^{\left(i\right)}\cdot\Delta\boldsymbol{\theta}^{\left(i\right)}\,,\label{eq:ja-basis-vector-linearization}
\end{equation}

\end_inset

which shows a dependence only on 
\begin_inset Formula $\Delta\boldsymbol{\theta}^{\left(i\right)}$
\end_inset

.
\end_layout

\begin_layout Subsection
Relative Joint Motion
\begin_inset CommandInset label
LatexCommand label
name "subsec:Relative-Joint-Motion"

\end_inset


\end_layout

\begin_layout Standard
The position of a joint in each rigid body 
\begin_inset Formula $i$
\end_inset

 is given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-origin-positions"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The relative motion across a joint is given by the relative translation
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\,,\label{eq:rjm-relative-translation}
\end{equation}

\end_inset

and the relative rotation
\begin_inset Formula 
\begin{equation}
\mathbf{Q}=\boldsymbol{\Lambda}^{\left(2\right)}\cdot\left(\boldsymbol{\Lambda}^{\left(1\right)}\right)^{T}\equiv\exp\left[\hat{\boldsymbol{\theta}}\right]\,,\label{eq:rjm-relative-rotation}
\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\boldsymbol{\theta}}=-\boldsymbol{\mathcal{E}}\cdot\boldsymbol{\theta}$
\end_inset

 is the skew-symmetric tensor with dual vector 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

.
 As usual, 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 is a vector whose direction represents the axis of rotation and whose magnitude
 is the angle of (counter-clockwise) rotation about that axis.
 To report the relative motion of a joint, we may project 
\begin_inset Formula $\mathbf{x}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset

 along the basis vectors 
\begin_inset Formula $\mathbf{e}_{j}^{\left(1\right)}=\boldsymbol{\Lambda}^{\left(1\right)}\cdot\mathbf{E}_{j}$
\end_inset

 of the first rigid body.
 Thus,
\begin_inset Formula 
\begin{equation}
\begin{aligned}x_{j} & =\mathbf{x}\cdot\mathbf{e}_{j}^{\left(1\right)}\\
\theta_{j} & =\boldsymbol{\theta}\cdot\mathbf{e}_{j}^{\left(1\right)}
\end{aligned}
\,.\label{eq:rjm-projected-motion}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Joint Reaction Forces and Moments
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Forces-Moments"

\end_inset


\end_layout

\begin_layout Standard
Reaction forces are used to constrain the degrees of freedom of a joint
 that connects two rigid bodies.
 Typically, these forces are generated by very stiff springs and dampers
 that only allow unrestricted motion along the joint degrees of freedom.
\end_layout

\begin_layout Subsubsection
Reaction Forces from Springs
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Springs"

\end_inset


\end_layout

\begin_layout Standard
The reaction force 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}$
\end_inset

 generated by a spring acting on rigid body 
\begin_inset Formula $\left(1\right)$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}^{\left(1\right)}=\boldsymbol{\lambda}+\varepsilon_{c}\mathbf{P}\cdot\mathbf{g}}\,,\label{eq:jf-spring-force}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{g}=\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}}\label{eq:jf-gap-function}
\end{equation}

\end_inset

is a gap function that represents the vector distance between the joint
 origins, 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is the (optional) Lagrange multiplier used when invoking the augmented
 Lagrangian method, and 
\begin_inset Formula $\varepsilon_{c}$
\end_inset

 is a penalty parameter that represents the spring stiffness.
 The tensor 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a projection that limits the reaction force to the directions that are
 not free to move.
 In general, there are three possible options for 
\begin_inset Formula $\mathbf{P}$
\end_inset

:
\begin_inset Formula 
\begin{equation}
\mathbf{P}=\begin{cases}
\mathbf{P}_{1}=\mathbf{I} & \text{constrain relative translation along all directions}\\
\mathbf{P}_{2}=\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)} & \text{constrain relative translation within plane normal to }\mathbf{n}^{\left(1\right)}\\
\mathbf{P}_{3}=\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)} & \text{constrain relative translation along }\mathbf{n}^{\left(1\right)}
\end{cases}\,.\label{eq:jf-P-projection}
\end{equation}

\end_inset

For example, 
\begin_inset Formula $\mathbf{P}_{1}=\mathbf{I}$
\end_inset

 in a spherical or revolute joint, whereas 
\begin_inset Formula $\mathbf{P}_{2}=\mathbf{I}-\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}$
\end_inset

 in an unconstrained prismatic joint, with 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

 representing the axis of motion; and 
\begin_inset Formula $\mathbf{P}_{3}=\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}$
\end_inset

 in an unconstrained planar joint, with 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

 representing the normal to the plane.
 Note that in all cases we choose to define the axis in the basis of rigid
 body 
\begin_inset Formula $\left(1\right)$
\end_inset

.
 If the constraint is enforced properly, then 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

 should be the same as 
\begin_inset Formula $\mathbf{n}^{\left(2\right)}$
\end_inset

, within a user-defined numerical tolerance.
 In practice, we let 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}\equiv\mathbf{e}_{1}^{\left(1\right)}$
\end_inset

.
\end_layout

\begin_layout Standard
The linearization of 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jf-spring-force"

\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
D\mathbf{f}^{\left(1\right)}=\varepsilon_{c}\left(\mathbf{P}\cdot D\mathbf{g}+D\mathbf{P}\cdot\mathbf{g}\right)\,.\label{eq:jf-linearized-spring-force}
\end{equation}

\end_inset

The linearization of the gap function produces
\begin_inset Formula 
\begin{equation}
\mathbf{P}\cdot D\mathbf{g}=\left[\begin{array}{cccc}
-\mathbf{P} & \mathbf{P}\cdot\hat{\mathbf{z}}^{\left(1\right)} & \mathbf{P} & -\mathbf{P}\cdot\hat{\mathbf{z}}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,,\label{eq:jf-linearization-1st}
\end{equation}

\end_inset

whereas the linearization of the three possible projections yields
\begin_inset Formula 
\begin{equation}
D\mathbf{P}\cdot\mathbf{g}=\mathbf{Q}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\,,\label{eq:jf-linearization-2nd}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{Q}=\begin{cases}
\mathbf{Q}_{1} & =\mathbf{0}\\
\mathbf{Q}_{2} & =\left[\left(\mathbf{n}^{\left(1\right)}\cdot\mathbf{g}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\mathbf{g}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}\\
\mathbf{Q}_{3} & =-\left[\left(\mathbf{n}^{\left(1\right)}\cdot\mathbf{g}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\mathbf{g}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}
\end{cases}\,.\label{eq:jf-linearization-Q}
\end{equation}

\end_inset

Therefore, in the expression for 
\begin_inset Formula $D\mathbf{f}^{\left(1\right)}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-Df"

\end_inset

, we have
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{fr}^{\left(1\right)} & =-\varepsilon_{c}\mathbf{P}\\
\mathbf{K}_{f\theta}^{\left(1\right)} & =\varepsilon_{c}\left(\mathbf{P}\cdot\hat{\mathbf{z}}^{\left(1\right)}+\mathbf{Q}\right)\\
\mathbf{K}_{fr}^{\left(2\right)} & =\varepsilon_{c}\mathbf{P}\\
\mathbf{K}_{f\theta}^{\left(2\right)} & =-\varepsilon_{c}\mathbf{P}\cdot\hat{\mathbf{z}}^{\left(2\right)}
\end{aligned}
}\,.\label{eq:jf-spring-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Reaction Moments from Torsional Springs
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Torsional-Springs"

\end_inset


\end_layout

\begin_layout Standard
The reaction moment 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}$
\end_inset

 generated by a torsional spring acting on rigid body 
\begin_inset Formula $\left(1\right)$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{m}^{\left(1\right)}=\boldsymbol{\mu}+\varepsilon_{r}\boldsymbol{\gamma}}\label{eq:jm-joint-moment}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boxed{\boldsymbol{\gamma}=\frac{1}{2}\sum_{j=1}^{k}\mathbf{e}_{j}^{\left(1\right)}\times\mathbf{e}_{j}^{\left(2\right)}}\label{eq:jm-angular-gap}
\end{equation}

\end_inset

is the angular gap function between the bases of rigid bodies 
\begin_inset Formula $\left(1\right)$
\end_inset

 and 
\begin_inset Formula $\left(2\right)$
\end_inset

, 
\begin_inset Formula $\boldsymbol{\mu}$
\end_inset

 is the (optional) Lagrange multiplier used when invoking the augmented
 Lagrangian method, and 
\begin_inset Formula $\varepsilon_{r}$
\end_inset

 is a penalty parameter representing the torsional spring stiffness.
 We consider three cases for the choice of 
\begin_inset Formula $\boldsymbol{\gamma}$
\end_inset

: 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\gamma}=\begin{cases}
k=3 & \text{constrain relative rotation along all directions}\\
k=1 & \text{maintain free relative rotation along }\mathbf{e}_{1}^{\left(i\right)}\\
k=0 & \text{maintain free relative rotation along all directions}
\end{cases}\label{eq:jm-cases}
\end{equation}

\end_inset

For example, 
\begin_inset Formula $k=3$
\end_inset

 is used to model the reaction moment in a prismatic joint, whereas 
\begin_inset Formula $k=1$
\end_inset

 is used with revolute, cylindrical and planar joints.
\end_layout

\begin_layout Standard
Now, the linearization produces
\begin_inset Formula 
\[
D\mathbf{m}^{\left(1\right)}=\varepsilon_{r}D\boldsymbol{\gamma}\,,
\]

\end_inset

where
\begin_inset Formula 
\[
D\boldsymbol{\gamma}=\mathbf{W}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}-\mathbf{W}^{T}\cdot\Delta\boldsymbol{\theta}^{\left(2\right)}
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}\mathbf{W} & =\frac{1}{2}\sum_{j=1}^{k}\hat{\mathbf{e}}_{j}^{\left(2\right)}\cdot\hat{\mathbf{e}}_{j}^{\left(1\right)}\end{aligned}
\,.
\]

\end_inset

Therefore, in the expression for 
\begin_inset Formula $D\mathbf{m}^{\left(1\right)}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-Dm"

\end_inset

, we have
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{mr}^{\left(1\right)} & =\mathbf{0}\\
\mathbf{K}_{m\theta}^{\left(1\right)} & =\varepsilon_{r}\mathbf{W}\\
\mathbf{K}_{mr}^{\left(2\right)} & =\mathbf{0}\\
\mathbf{K}_{m\theta}^{\left(2\right)} & =-\varepsilon_{r}\mathbf{W}^{T}
\end{aligned}
}\,.\label{eq:jm-spring-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Reaction Forces from Dampers
\begin_inset CommandInset label
LatexCommand label
name "subsec:Linear-Dampers"

\end_inset


\end_layout

\begin_layout Standard
The reaction force 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}$
\end_inset

 on a damper is
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{f}^{\left(1\right)}=\chi_{c}\mathbf{P}\cdot\dot{\mathbf{g}}}\,,\label{eq:df-damper-force}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dot{\mathbf{g}}$
\end_inset

 is the time rate of change of the gap function,
\begin_inset Formula 
\begin{equation}
\boxed{\dot{\mathbf{g}}=\mathbf{v}^{\left(2\right)}-\mathbf{v}^{\left(1\right)}}\,,\label{eq:df-relative-velocity}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{P}$
\end_inset

 represents a projection as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Joint-Springs"

\end_inset

.
 In particular, 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 is used with spherical and revolute joints; 
\begin_inset Formula $\mathbf{P}_{2}$
\end_inset

 is used with prismatic and cylindrical joints; and 
\begin_inset Formula $\mathbf{P}_{3}$
\end_inset

 is used with planar joints.
 The parameter 
\begin_inset Formula $\chi_{c}$
\end_inset

 represents the damping coefficient.
\end_layout

\begin_layout Standard
The velocities of the insertion points are given by 
\begin_inset Formula $\mathbf{v}^{\left(i\right)}=\dot{\mathbf{r}}^{\left(i\right)}+\boldsymbol{\omega}^{\left(i\right)}\times\mathbf{z}^{\left(i\right)}$
\end_inset

, where 
\begin_inset Formula $\boldsymbol{\omega}^{\left(i\right)}$
\end_inset

 is the rigid body angular velocity.
 The linearization of 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\mathbf{f}^{\left(1\right)}=\varepsilon_{c}\left(\mathbf{P}\cdot D\dot{\mathbf{g}}+D\mathbf{P}\cdot\dot{\mathbf{g}}\right)\,,\label{eq:df-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{P}\cdot D\dot{\mathbf{g}}=\left[\begin{array}{cccc}
-\mathbf{A} & \mathbf{B}^{\left(1\right)} & \mathbf{A} & -\mathbf{B}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,,\label{eq:df-linearization-1st}
\end{equation}

\end_inset

with
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{A} & =\frac{\gamma}{\beta\Delta t}\mathbf{P}\\
\mathbf{B}^{\left(i\right)} & =\mathbf{P}\cdot\left(\frac{\gamma}{\beta\Delta t}\hat{\mathbf{z}}^{\left(i\right)}\cdot\mathbf{T}^{T}\left(\boldsymbol{\theta}^{\left(i\right)}\right)+\hat{\boldsymbol{\omega}}\cdot\hat{\mathbf{z}}^{\left(i\right)}\right)
\end{aligned}
\,.\label{eq:df-A-B}
\end{equation}

\end_inset

Recall that 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

 are the Newmark parameters, and 
\begin_inset Formula $\mathbf{T}\left(\boldsymbol{\theta}\right)$
\end_inset

 is given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:td-T-Theta-relation"

\end_inset

.
 Similarly,
\begin_inset Formula 
\begin{equation}
D\mathbf{P}\cdot\dot{\mathbf{g}}=\mathbf{V}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\,,\label{eq:df-linearization-2nd}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{V}=\begin{cases}
\mathbf{V}_{1} & =\mathbf{0}\\
\mathbf{V}_{2} & =\left[\left(\mathbf{n}^{\left(1\right)}\cdot\dot{\mathbf{g}}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\dot{\mathbf{g}}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}\\
\mathbf{V}_{3} & =-\left[\left(\mathbf{n}^{\left(1\right)}\cdot\dot{\mathbf{g}}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\dot{\mathbf{g}}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}
\end{cases}\,.\label{eq:df-linearization-V}
\end{equation}

\end_inset

Combining these results produces
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{fr}^{\left(1\right)} & =-\chi_{c}\mathbf{A}\\
\mathbf{K}_{f\theta}^{\left(1\right)} & =\chi_{c}\left(\mathbf{B}^{\left(1\right)}+\mathbf{V}\right)\\
\mathbf{K}_{fr}^{\left(2\right)} & =\chi_{c}\mathbf{A}\\
\mathbf{K}_{f\theta}^{\left(2\right)} & =-\chi_{c}\mathbf{B}^{\left(2\right)}
\end{aligned}
}\label{eq:df-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Reaction Moments from Torsional Dampers
\begin_inset CommandInset label
LatexCommand label
name "subsec:Torsional-Dampers"

\end_inset


\end_layout

\begin_layout Standard
The reaction moment 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}$
\end_inset

 arising from a torsional damper is 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{m}^{\left(1\right)}=\chi_{r}\mathbf{P}\cdot\boldsymbol{\omega}}\,,\label{eq:td-moment}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\boldsymbol{\omega}=\boldsymbol{\omega}^{\left(2\right)}-\boldsymbol{\omega}^{\left(1\right)}\label{eq:td-relative-velocity}
\end{equation}

\end_inset

is the angular velocity of body 
\begin_inset Formula $\left(2\right)$
\end_inset

 relative to body 
\begin_inset Formula $\left(1\right)$
\end_inset

, and 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is the projection used in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Joint-Springs"

\end_inset

.
 In particular, 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 is used for joints that cannot undergo relative rotations along any direction,
 such as prismatic joints; 
\begin_inset Formula $\mathbf{P}_{2}$
\end_inset

 is used for joints that can rotate freely along a single axis, such as
 revolute, cylindrical and planar joints; in addition, 
\begin_inset Formula $\mathbf{P}=\mathbf{0}$
\end_inset

 for spherical joints.
 The linearization of 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\mathbf{m}^{\left(1\right)}=\chi_{r}\left(\mathbf{P}\cdot D\boldsymbol{\omega}+D\mathbf{P}\cdot\boldsymbol{\omega}\right)\,,\label{eq:td-linearization}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{P}\cdot D\boldsymbol{\omega}=\mathbf{C}^{\left(2\right)}\cdot\Delta\boldsymbol{\theta}^{\left(2\right)}-\mathbf{C}^{\left(1\right)}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\label{eq:td-linearization-1st}
\end{equation}

\end_inset

with
\begin_inset Formula 
\begin{equation}
\mathbf{C}^{\left(i\right)}=\frac{\gamma}{\beta\Delta t}\mathbf{P}\cdot\mathbf{T}^{T}\left(\boldsymbol{\theta}^{\left(i\right)}\right)\,,\label{eq:td-B}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
D\mathbf{P}\cdot\boldsymbol{\omega}=\mathbf{W}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\,,\label{eq:td-linearization-2nd}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{W}=\begin{cases}
\mathbf{W}_{1} & =\mathbf{0}\\
\mathbf{W}_{2} & =\left[\left(\mathbf{n}^{\left(1\right)}\cdot\boldsymbol{\omega}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\boldsymbol{\omega}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}\\
\mathbf{W}_{3} & =-\left[\left(\mathbf{n}^{\left(1\right)}\cdot\boldsymbol{\omega}\right)\mathbf{I}+\mathbf{n}^{\left(1\right)}\otimes\boldsymbol{\omega}\right]\cdot\hat{\mathbf{n}}^{\left(1\right)}
\end{cases}\,.\label{eq:td-W}
\end{equation}

\end_inset

Combining these results now produces
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{mr}^{\left(1\right)} & =\mathbf{0}\\
\mathbf{K}_{m\theta}^{\left(1\right)} & =\chi_{r}\left(-\mathbf{C}^{\left(1\right)}+\mathbf{W}\right)\\
\mathbf{K}_{mr}^{\left(2\right)} & =\mathbf{0}\\
\mathbf{K}_{m\theta}^{\left(2\right)} & =\chi_{r}\mathbf{C}^{\left(2\right)}
\end{aligned}
}\,.\label{eq:td-stiffness}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Summary of Reaction Forces and Moment in Joints
\begin_inset CommandInset label
LatexCommand label
name "subsec:Summary-Forces-Moments-Joints"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="7">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spherical
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Revolute
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prismatic
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cylindrical
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Planar
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lock
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear spring
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\mathbf{P}_{1},\mathbf{Q}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{1},\mathbf{Q}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{Q}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{Q}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{3},\mathbf{Q}_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\mathbf{P}_{1},\mathbf{Q}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
torsional spring
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $k=3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear damper
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\mathbf{P}_{1},\mathbf{V}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{1},\mathbf{V}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{V}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{V}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{3},\mathbf{V}_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $\mathbf{P}_{1},\mathbf{V}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
torsional damper
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{0},\mathbf{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{W}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{1},\mathbf{W}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{W}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{2},\mathbf{W}_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{P}_{1},\mathbf{W}_{1}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsection
Prescribed Joint Forces and Moments
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Joint-Forces"

\end_inset


\end_layout

\begin_layout Subsubsection
Prescribed Force at Joint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Prescribed-Force"

\end_inset


\end_layout

\begin_layout Standard
When a joint has a translational degree of freedom along 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

, there may be a need to prescribe the force 
\begin_inset Formula $f$
\end_inset

 along that direction.
 This means that the reaction force 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}$
\end_inset

 may be supplemented with the force 
\begin_inset Formula $f\,\mathbf{n}^{\left(1\right)}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{\left(1\right)}=f\mathbf{n}^{\left(1\right)}\,,\label{eq:pfj-1}
\end{equation}

\end_inset

and the linearization produces
\begin_inset Formula 
\begin{equation}
D\mathbf{f}^{\left(1\right)}=-f\,\hat{\mathbf{n}}^{\left(1\right)}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\,.\label{eq:pfj-2}
\end{equation}

\end_inset

Thus,
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{f\theta}^{\left(1\right)}=-f\,\hat{\mathbf{n}}^{\left(1\right)}}\,,\label{eq:pfj-3}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{fr}^{\left(1\right)}=\mathbf{K}_{fr}^{\left(2\right)}=\mathbf{K}_{f\theta}^{\left(2\right)}=\mathbf{0}}\,.\label{eq:pfj-4}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Prescribed Moment at Joint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Prescribed-Moment"

\end_inset


\end_layout

\begin_layout Standard
When a joint has a rotational degree of freedom along 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

, there may be a need to prescribe the moment 
\begin_inset Formula $m$
\end_inset

 along that direction.
 This means that the reaction moment 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}$
\end_inset

 may be supplemented with the moment 
\begin_inset Formula $m\,\mathbf{n}^{\left(1\right)}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{m}^{\left(1\right)}=m\,\mathbf{n}^{\left(1\right)}\,,\label{eq:pmj-1}
\end{equation}

\end_inset

and the linearization produces
\begin_inset Formula 
\begin{equation}
D\mathbf{m}^{\left(1\right)}=-m\,\hat{\mathbf{n}}^{\left(1\right)}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\,.\label{eq:pmj-2}
\end{equation}

\end_inset

Thus,
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{m\theta}^{\left(1\right)}=-m\,\hat{\mathbf{n}}^{\left(1\right)}}\,,\label{eq:pmj-3}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{mr}^{\left(1\right)}=\mathbf{K}_{mr}^{\left(2\right)}=\mathbf{K}_{m\theta}^{\left(2\right)}=\mathbf{0}}\,.\label{eq:pmj-4}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Prescribed Joint Motion
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Joint-Motion"

\end_inset


\end_layout

\begin_layout Subsubsection
Prescribed Displacement at Joint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Prescribed-Displacement"

\end_inset


\end_layout

\begin_layout Standard
When a joint has a translational degree of freedom along 
\begin_inset Formula $\mathbf{n}^{\left(1\right)}$
\end_inset

, there may be a need to prescribe the relative displacement 
\begin_inset Formula $d$
\end_inset

 along that direction.
 This can be achieved by supplementing the joint reaction force with a force
 that closes the gap between the current and desired translation,
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{\left(1\right)}=\varepsilon_{c}\left[\left(\mathbf{n}^{\left(1\right)}\otimes\mathbf{n}^{\left(1\right)}\right)\cdot\mathbf{g}-d\,\mathbf{n}^{\left(1\right)}\right]=\varepsilon_{c}\left(\mathbf{P}_{3}\cdot\mathbf{g}-d\,\mathbf{n}^{\left(1\right)}\right)\,,\label{eq:pdj-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{P}_{3}$
\end_inset

 is given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:jf-P-projection"

\end_inset

.
 Then,
\begin_inset Formula 
\begin{equation}
D\mathbf{f}^{\left(1\right)}=D\mathbf{P}_{3}\cdot\mathbf{g}+\mathbf{P}_{3}\cdot D\mathbf{g}+d\,\hat{\mathbf{n}}^{\left(1\right)}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}\label{eq:pdj-2}
\end{equation}

\end_inset

Using the results of Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Joint-Springs"

\end_inset

, the stiffnesses are supplemented with
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{fr}^{\left(1\right)} & =-\varepsilon_{c}\mathbf{P}_{3}\\
\mathbf{K}_{f\theta}^{\left(1\right)} & =\varepsilon_{c}\left(\mathbf{P}_{3}\cdot\hat{\mathbf{z}}^{\left(1\right)}+\mathbf{Q}+d\,\hat{\mathbf{n}}^{\left(1\right)}\right)\\
\mathbf{K}_{fr}^{\left(2\right)} & =\varepsilon_{c}\mathbf{P}_{3}\\
\mathbf{K}_{f\theta}^{\left(2\right)} & =-\varepsilon_{c}\mathbf{P}_{3}\cdot\hat{\mathbf{z}}^{\left(2\right)}
\end{aligned}
}\,.\label{eq:pdj-3}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Prescribed Rotation at Joint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Joint-Prescribed-Rotation"

\end_inset


\end_layout

\begin_layout Standard
The relative rotation between the rigid bodies is
\begin_inset Formula 
\begin{equation}
\mathbf{Q}=\boldsymbol{\Lambda}^{\left(2\right)}\cdot\boldsymbol{\Lambda}^{\left(1\right)T}=\sum_{j}\mathbf{e}_{j}^{\left(2\right)}\otimes\mathbf{e}_{j}^{\left(1\right)}\,.\label{eq:prj-1}
\end{equation}

\end_inset

We want it to be equal to a rotation by 
\begin_inset Formula $\boldsymbol{\chi}$
\end_inset

 as expressed in the basis 
\begin_inset Formula $\mathbf{e}_{j}^{\left(1\right)}$
\end_inset

,
\begin_inset Formula 
\begin{equation}
\mathbf{A}=\exp\left[\boldsymbol{\chi}\right]\,.\label{eq:prj-2}
\end{equation}

\end_inset

We enforce this constraint by requiring that
\begin_inset Formula 
\begin{equation}
\mathbf{A}\cdot\mathbf{Q}^{T}=\mathbf{I}\,.\label{eq:prj-3}
\end{equation}

\end_inset

We may thus evaluate
\begin_inset Formula 
\begin{equation}
\mathbf{R}=\mathbf{A}\cdot\mathbf{Q}^{T}\,,\label{eq:prj-4}
\end{equation}

\end_inset

and expect that 
\begin_inset Formula $\mathbf{R}=\mathbf{I}$
\end_inset

 when the constraint is enforced.
 Note that 
\begin_inset Formula $\mathbf{R}^{T}\cdot\mathbf{R}=\mathbf{I}$
\end_inset

 because of the orthogonality of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}$
\end_inset

, i.e., 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is always orthogonal, even when the constraint is not enforced.
 The axial vector of 
\begin_inset Formula $\mathbf{R}$
\end_inset

 may be denoted by 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

, i.e., 
\begin_inset Formula $\mathbf{R}=\exp\left[\boldsymbol{\xi}\right]$
\end_inset

, and the constraint is enforced when 
\begin_inset Formula $\boldsymbol{\xi}=\mathbf{0}$
\end_inset

.
 Therefore, a moment 
\begin_inset Formula $\varepsilon_{r}\boldsymbol{\xi}$
\end_inset

 needs to be prescribed,
\begin_inset Formula 
\begin{equation}
\mathbf{m}^{\left(1\right)}=\varepsilon_{r}\boldsymbol{\xi}\,.\label{eq:prj-5}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is orthogonal, we can linearize it along an increment 
\begin_inset Formula $\Delta\boldsymbol{\xi}$
\end_inset

, 
\begin_inset Formula $D\mathbf{R}\left[\Delta\boldsymbol{\xi}\right]=\Delta\hat{\boldsymbol{\xi}}\cdot\mathbf{R}$
\end_inset

, from which it follows that 
\begin_inset Formula $\Delta\hat{\boldsymbol{\xi}}=D\mathbf{R}\cdot\mathbf{R}^{T}$
\end_inset

 with
\begin_inset Formula 
\begin{equation}
D\mathbf{R}=\mathbf{A}\cdot D\mathbf{Q}^{T}=\mathbf{A}\cdot\left(\Delta\hat{\boldsymbol{\theta}}^{\left(1\right)}\cdot\mathbf{Q}^{T}-\mathbf{Q}^{T}\cdot\Delta\hat{\boldsymbol{\theta}}^{\left(2\right)}\right)\,,\label{eq:prj-6}
\end{equation}

\end_inset

so that
\begin_inset Formula 
\begin{equation}
\Delta\hat{\boldsymbol{\xi}}=\mathbf{A}\cdot\Delta\hat{\boldsymbol{\theta}}^{\left(1\right)}\cdot\mathbf{A}^{T}-\mathbf{R}\cdot\Delta\hat{\boldsymbol{\theta}}^{\left(2\right)}\cdot\mathbf{R}^{T}\,.\label{eq:prj-7}
\end{equation}

\end_inset

From this expression we get
\begin_inset Formula 
\begin{equation}
\Delta\boldsymbol{\xi}=\mathbf{A}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}-\mathbf{R}\cdot\Delta\boldsymbol{\theta}^{\left(2\right)}\,.\label{eq:prj-8}
\end{equation}

\end_inset

Thus,
\begin_inset Formula 
\begin{equation}
D\mathbf{m}^{\left(1\right)}=\varepsilon_{r}\left(\mathbf{A}\cdot\Delta\boldsymbol{\theta}^{\left(1\right)}-\mathbf{R}\cdot\Delta\boldsymbol{\theta}^{\left(2\right)}\right)\,.\label{eq:prj-9}
\end{equation}

\end_inset

It follows that
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{K}_{mr}^{\left(1\right)}=\mathbf{K}_{mr}^{\left(2\right)}=\mathbf{0}}\,,\label{eq:prj-10}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{K}_{m\theta}^{\left(1\right)} & =\varepsilon_{r}\mathbf{A}\\
\mathbf{K}_{m\theta}^{\left(2\right)} & =-\varepsilon_{r}\mathbf{R}
\end{aligned}
}\,.\label{eq:prj-11}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Other Rigid Connectors
\begin_inset CommandInset label
LatexCommand label
name "subsec:Other-Rigid-Connectors"

\end_inset


\end_layout

\begin_layout Subsubsection
Spring Between Rigid Bodies
\begin_inset CommandInset label
LatexCommand label
name "subsec:Spring-Between-Rigid-Bodies"

\end_inset


\end_layout

\begin_layout Standard
Consider a spring between points 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 on rigid bodies 
\begin_inset Formula $\left(1\right)$
\end_inset

 and 
\begin_inset Formula $\left(2\right)$
\end_inset

.
 The spring force is oriented along 
\begin_inset Formula $\mathbf{n}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}}{\left|\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right|}\,.\label{eq:rbs-1}
\end{equation}

\end_inset

We may write
\begin_inset Formula 
\begin{equation}
L=\left|\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right|\,,\quad L_{0}=\left|\mathbf{X}^{\left(2\right)}-\mathbf{X}^{\left(2\right)}\right|\,.\label{eq:rbs-2}
\end{equation}

\end_inset

Then, the spring force acting on body 
\begin_inset Formula $\left(1\right)$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{\left(1\right)}=k\left(L-L_{0}\right)\mathbf{n}=k\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}-L_{0}\mathbf{n}\right)\,,\label{eq:rbs-3}
\end{equation}

\end_inset

where 
\begin_inset Formula $k$
\end_inset

 is the spring constant.
 It is understood that the special case 
\begin_inset Formula $L_{0}=0$
\end_inset

 produces 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}=k\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)$
\end_inset

.
 We do not need to use the augmented Lagrangian method here, therefore 
\begin_inset Formula $\mathbf{f}^{\left(1\right)}=k\mathbf{c}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\mathbf{c}=\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}-L_{0}\frac{\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}}{\left|\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}\right|}\,.\label{eq:rbs-4}
\end{equation}

\end_inset

Since the spring may freely pivot about its insertion point, we let 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}=\mathbf{0}$
\end_inset

.
 Thus,
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{f}^{\left(1\right)} & =k\left(\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}-L_{0}\frac{\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}}{\left|\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}\right|}\right)\\
\mathbf{m}^{\left(1\right)} & =\mathbf{0}
\end{aligned}
}\label{eq:rbs-5}
\end{equation}

\end_inset

and the virtual work associated with this spring is
\begin_inset Formula 
\begin{equation}
\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}^{\left(1\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{f}^{\left(1\right)}\\
-\mathbf{f}^{\left(1\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{f}^{\left(1\right)}
\end{array}\right]\,.\label{eq:rbs-6}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 may be expressed as
\begin_inset Formula 
\begin{equation}
-D\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\left[\mathbf{K}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rbs-7}
\end{equation}

\end_inset

where the stiffness matrix is
\begin_inset Formula 
\begin{equation}
\left[\mathbf{K}\right]=k\alpha\left[\begin{array}{cccc}
\mathbf{P} & -\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & -\mathbf{P} & \mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P} & \hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
-\mathbf{P} & \mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & \mathbf{P} & -\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rbs-8}
\end{equation}

\end_inset

with
\begin_inset Formula 
\begin{equation}
\mathbf{P}=\left(1-\frac{L_{0}}{L_{n+\alpha}}\right)\mathbf{I}+\frac{L_{0}}{L_{n+\alpha}}\mathbf{n}_{n+\alpha}\otimes\mathbf{n}_{n+\alpha}\,.\label{eq:rbs-9}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Damper Between Rigid Bodies
\end_layout

\begin_layout Standard
Consider a damper (e.g., a dashpot) inserted between points on two rigid bodies.
 The force generated by this dashpot is
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{\left(1\right)}=\varepsilon_{c}\dot{\mathbf{c}}\,.\label{eq:rbd-1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\dot{\mathbf{c}}$
\end_inset

 is the relative velocity between insertion points,
\begin_inset Formula 
\begin{equation}
\dot{\mathbf{c}}=\mathbf{v}_{n+\alpha}^{\left(2\right)}-\mathbf{v}_{n+\alpha}^{\left(1\right)}\,.\label{eq:rbd-2}
\end{equation}

\end_inset

This relative velocity is related to the rigid body degrees of freedom by
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{x}_{n+\alpha}^{\left(i\right)} & =\mathbf{r}_{n+\alpha}^{\left(i\right)}+\mathbf{z}_{n+\alpha}^{\left(i\right)}\\
\mathbf{v}_{n}^{\left(i\right)} & =\dot{\mathbf{r}}_{n}^{\left(i\right)}+\boldsymbol{\omega}_{n}\times\mathbf{z}_{n}^{\left(i\right)}\\
\mathbf{v}_{n+1}^{\left(i\right)} & =\dot{\mathbf{r}}_{n+1}^{\left(i\right)}+\boldsymbol{\omega}_{n+1}\times\mathbf{z}_{n+1}^{\left(i\right)}\\
\mathbf{v}_{n+\alpha}^{\left(i\right)} & =\alpha\mathbf{v}_{n+1}^{\left(i\right)}+\left(1-\alpha\right)\mathbf{v}_{n}^{\left(i\right)}
\end{aligned}
\,.\label{eq:rbd-3}
\end{equation}

\end_inset

Since the dashpot may freely rotate about its insertion points, we set 
\begin_inset Formula $\mathbf{m}^{\left(1\right)}=\mathbf{0}$
\end_inset

.
 It follows that
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{f}^{\left(1\right)} & =\varepsilon_{c}\left(\mathbf{v}_{n+\alpha}^{\left(2\right)}-\mathbf{v}_{n+\alpha}^{\left(1\right)}\right)\\
\mathbf{m}^{\left(1\right)} & =\mathbf{0}
\end{aligned}
}\,,\label{eq:rbd-4}
\end{equation}

\end_inset

and the virtual work resulting from the dashpot is
\begin_inset Formula 
\begin{equation}
\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}^{\left(1\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{f}^{\left(1\right)}\\
-\mathbf{f}^{\left(1\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{f}^{\left(1\right)}
\end{array}\right]\,.\label{eq:rbd-5}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta G$
\end_inset

 may be written as
\begin_inset Formula 
\begin{equation}
\begin{aligned}-D\delta G & =\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\varepsilon_{c}\alpha\left[\begin{array}{cccc}
\mathbf{A} & -\mathbf{B}^{\left(1\right)} & -\mathbf{A} & \mathbf{B}^{\left(2\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{A} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{B}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{A} & \hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{B}^{\left(2\right)}\\
-\mathbf{A} & \mathbf{B}^{\left(1\right)} & \mathbf{A} & -\mathbf{B}^{\left(2\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{A} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{B}^{\left(1\right)} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{A} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{B}^{\left(2\right)}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\end{aligned}
\,,\label{eq:rbd-6}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\left[\mathbf{K}\right]=\varepsilon_{c}\alpha\left[\begin{array}{cccc}
\mathbf{A} & -\mathbf{B}^{\left(1\right)} & -\mathbf{A} & \mathbf{B}^{\left(2\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{A} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{B}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{A} & \hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{B}^{\left(2\right)}\\
-\mathbf{A} & \mathbf{B}^{\left(1\right)} & \mathbf{A} & -\mathbf{B}^{\left(2\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{A} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{B}^{\left(1\right)} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{A} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{B}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rbd-7}
\end{equation}

\end_inset

and
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{A} & =\frac{\gamma}{\beta\Delta t}\mathbf{I}\\
\mathbf{B}^{\left(i\right)} & =\frac{\gamma}{\beta\Delta t}\hat{\mathbf{z}}_{n+1}^{\left(i\right)}\cdot\mathbf{T}^{T}\left(\boldsymbol{\theta}^{\left(i\right)}\right)+\hat{\boldsymbol{\omega}}_{n+1}\cdot\hat{\mathbf{z}}_{n+1}^{\left(i\right)}
\end{aligned}
\,.\label{eq:rbd-8}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Contractile Force Between Rigid Bodies
\begin_inset CommandInset label
LatexCommand label
name "subsec:Contractile-Force-Rigid"

\end_inset


\end_layout

\begin_layout Standard
Consider a contractile force between points 
\begin_inset Formula $\mathbf{x}^{\left(i\right)}$
\end_inset

 on rigid bodies 
\begin_inset Formula $\left(1\right)$
\end_inset

 and 
\begin_inset Formula $\left(2\right)$
\end_inset

.
 The force is oriented along 
\begin_inset Formula $\mathbf{n}$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\mathbf{n}=\frac{\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}}{\left|\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right|}\,.\label{eq:rcf-1}
\end{equation}

\end_inset

Let 
\begin_inset Formula $L=\left|\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right|$
\end_inset

 and 
\begin_inset Formula $L_{0}=\left|\mathbf{X}^{\left(2\right)}-\mathbf{X}^{\left(2\right)}\right|$
\end_inset

, so that the contractile force acting on body 
\begin_inset Formula $\left(1\right)$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{\left(1\right)}=f_{0}\mathbf{n}=\frac{f_{0}}{L}\left(\mathbf{x}^{\left(2\right)}-\mathbf{x}^{\left(1\right)}\right)\,.\label{eq:rcf-2}
\end{equation}

\end_inset

We do not need to use the augmented Lagrangian method here, thus
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{\begin{aligned}\mathbf{f}^{\left(1\right)} & =f_{0}\frac{\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}}{\left|\mathbf{x}_{n+\alpha}^{\left(2\right)}-\mathbf{x}_{n+\alpha}^{\left(1\right)}\right|}\\
\mathbf{m}^{\left(1\right)} & =\mathbf{0}
\end{aligned}
}\label{eq:rcf-3}
\end{equation}

\end_inset

where we assume that the contractile force pivots freely at the rigid body
 insertiones.
 The virtual work resulting from this contractile force is thus
\begin_inset Formula 
\begin{equation}
\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}^{\left(1\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{f}^{\left(1\right)}\\
-\mathbf{f}^{\left(1\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{f}^{\left(1\right)}
\end{array}\right]\,,\label{eq:rcf-4}
\end{equation}

\end_inset

and its linearization is
\begin_inset Formula 
\begin{equation}
-D\delta G=\left[\begin{array}{cccc}
\delta\mathbf{r}^{\left(1\right)} & \delta\boldsymbol{\omega}^{\left(1\right)} & \delta\mathbf{r}^{\left(2\right)} & \delta\boldsymbol{\omega}^{\left(2\right)}\end{array}\right]\left[\mathbf{K}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{\left(1\right)}\\
\Delta\boldsymbol{\theta}^{\left(1\right)}\\
\Delta\mathbf{r}^{\left(2\right)}\\
\Delta\boldsymbol{\theta}^{\left(2\right)}
\end{array}\right]\,.\label{eq:rcf-5}
\end{equation}

\end_inset

Here, the stiffness matrix is given by
\begin_inset Formula 
\begin{equation}
\left[\mathbf{K}\right]=\alpha\frac{f_{0}}{L_{n+\alpha}}\left[\begin{array}{cccc}
\mathbf{P} & -\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & -\mathbf{P} & \mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P} & \hat{\mathbf{z}}_{n+\alpha}^{\left(1\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
-\mathbf{P} & \mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & \mathbf{P} & -\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}\\
-\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(1\right)} & \hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P} & -\hat{\mathbf{z}}_{n+\alpha}^{\left(2\right)}\cdot\mathbf{P}\cdot\hat{\mathbf{z}}_{n+1}^{\left(2\right)}
\end{array}\right]\,,\label{eq:rcf-6}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{P}=\mathbf{I}-\mathbf{n}_{n+\alpha}\otimes\mathbf{n}_{n+\alpha}\,.\label{eq:rcf-7}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Rigid-Deformable Coupling
\begin_inset CommandInset label
LatexCommand label
name "sec:Rigid-Deformable-Coupling"

\end_inset


\end_layout

\begin_layout Standard
In FEBio deformable bodies can be coupled with rigid bodies 
\begin_inset CommandInset citation
LatexCommand citep
key "Maker95"
literal "true"

\end_inset

.
 At these rigid-deformable interfaces, the coupling of nodal degrees of
 freedom of deformable elements that attach to rigid bodies requires a modificat
ion of the global stiffness matrix and residual vector.
 This section describes the coupling between rigid and deformable bodies.
\end_layout

\begin_layout Standard
The position of a node shared by any number of deformable finite elements
 is denoted by 
\begin_inset Formula $\mathbf{x}$
\end_inset

 in the current configuration.
 If the node belongs to one or more deformable elements but is not connected
 to a rigid body, then 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is given in terms of the nodal displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq34"

\end_inset

; the corresponding nodal virtual velocity is 
\begin_inset Formula $\delta\mathbf{v}$
\end_inset

 and the linearization of 
\begin_inset Formula $\mathbf{x}$
\end_inset

 along an incremental displacement is denoted by 
\begin_inset Formula $\Delta\mathbf{u}$
\end_inset

.
\end_layout

\begin_layout Standard
The contribution to the virtual work of the nodal force 
\begin_inset Formula $\mathbf{f}^{a}$
\end_inset

 at node 
\begin_inset Formula $a$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
\delta G=\delta\mathbf{v}^{a}\cdot\mathbf{f}_{n+\alpha}^{a}\,,\label{eq:rdc-virtual-work}
\end{equation}

\end_inset

whera 
\begin_inset Formula $\delta\mathbf{v}^{a}$
\end_inset

 is the virtual velocity of node 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $\mathbf{f}_{n+\alpha}^{a}$
\end_inset

 is the global nodal force, evaluated at the intermediate time 
\begin_inset Formula $t_{n+\alpha}$
\end_inset

 as 
\begin_inset Formula $\mathbf{f}_{n+\alpha}^{a}=\alpha\mathbf{f}_{n+1}^{a}+\left(1-\alpha\right)\mathbf{f}_{n}^{a}$
\end_inset

.
 The linearization of this virtual work along the incremental displacement
 
\begin_inset Formula $\Delta\mathbf{u}^{b}$
\end_inset

 of node 
\begin_inset Formula $b$
\end_inset

 is
\begin_inset Formula 
\begin{equation}
D\delta G=-\alpha\delta\mathbf{v}^{a}\cdot\mathbf{K}^{ab}\cdot\Delta\mathbf{u}^{b},\label{eq:rdc-linearization-vw}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{K}^{ab}=\left(\partial\mathbf{f}^{a}/\partial\mathbf{x}^{b}\right)_{n+1}$
\end_inset

 is the contribution to the global stiffness matrix from the interactions
 of the degrees of freedom of nodes 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Standard
Now we consider the cases when either node 
\begin_inset Formula $a$
\end_inset

, or node 
\begin_inset Formula $b$
\end_inset

, or both, are attached to a rigid body.
 Our objective is to determine how to modify the global residual vector
 and stiffness matrix to account for the coupling of deformable and rigid
 body degrees of freedom.
\end_layout

\begin_layout Standard
When node 
\begin_inset Formula $a$
\end_inset

 is attached to rigid body 
\begin_inset Formula $a$
\end_inset

, its position is given in terms of that rigid body's degrees of freedom
 by the general relation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rbm-position"

\end_inset

.
 The corresponding virtual velocity is given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rc-origin-virtual-displacement"

\end_inset

, reproduced here as
\begin_inset Formula 
\begin{equation}
\delta\mathbf{v}^{a}=\delta\mathbf{r}^{a}-\hat{\mathbf{z}}_{n+\alpha}^{a}\cdot\delta\boldsymbol{\theta}^{a}\,,\label{eq:rdc-rb-virtual-velocity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{z}_{n+\alpha}^{a}=\boldsymbol{\Lambda}_{n+\alpha}^{a}\cdot\mathbf{Z}^{a}$
\end_inset

 is the position of node 
\begin_inset Formula $a$
\end_inset

 relative to the center of mass of rigid body 
\begin_inset Formula $a$
\end_inset

, at the intermediate time 
\begin_inset Formula $t_{n+\alpha}$
\end_inset

.
 Now, the contribution of the global nodal force 
\begin_inset Formula $\mathbf{f}_{n+\alpha}^{a}$
\end_inset

 to 
\begin_inset Formula $\delta G$
\end_inset

 must be modified from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rdc-virtual-work"

\end_inset

 according to
\begin_inset Formula 
\begin{equation}
\delta G=\delta\mathbf{v}^{a}\cdot\mathbf{f}_{n+\alpha}^{a}=\left[\begin{array}{cc}
\delta\mathbf{r}^{a} & \delta\boldsymbol{\theta}^{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{f}_{n+\alpha}^{a}\\
\hat{\mathbf{z}}_{n+\alpha}^{a}\cdot\mathbf{f}_{n+\alpha}^{a}
\end{array}\right]\,.\label{eq:rdc-rb-virtual-work}
\end{equation}

\end_inset

In other words, the displacement degrees of freedom of node 
\begin_inset Formula $a$
\end_inset

 should be eliminated from the global system of equations and replaced with
 the translation and rotation degrees of freedom of rigid body 
\begin_inset Formula $a$
\end_inset

.
 The force vector 
\begin_inset Formula $\mathbf{f}_{n+\alpha}^{a}$
\end_inset

 should be made to contribute to the translation degrees of freedom of the
 center of mass of rigid body 
\begin_inset Formula $a$
\end_inset

, whereas the moment 
\begin_inset Formula $\mathbf{z}_{n+\alpha}^{a}\times\mathbf{f}_{n+\alpha}^{a}$
\end_inset

 should contribute to the rotation degrees of freedom of the rigid body.
\end_layout

\begin_layout Standard
When node 
\begin_inset Formula $b$
\end_inset

 is connected to rigid body 
\begin_inset Formula $b$
\end_inset

, the incremental displacement 
\begin_inset Formula $\Delta\mathbf{u}^{b}$
\end_inset

 should be replaced with the rigid body incremental motions,
\begin_inset Formula 
\begin{equation}
\Delta\mathbf{u}^{b}=\Delta\mathbf{r}^{b}-\hat{\mathbf{z}}_{n+1}^{b}\cdot\Delta\boldsymbol{\theta}^{b}\,.\label{eq:rdc-rb-incremental-disp}
\end{equation}

\end_inset

Now, the contribution 
\begin_inset Formula $\mathbf{K}^{ab}$
\end_inset

 to the global stiffness matrix needs to be modified from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rdc-linearization-vw"

\end_inset

 according to the three possible cases:
\end_layout

\begin_layout Itemize
Node 
\begin_inset Formula $a$
\end_inset

 belongs to rigid body 
\begin_inset Formula $a$
\end_inset

, node 
\begin_inset Formula $b$
\end_inset

 belongs to flexible elements only,
\begin_inset Formula 
\begin{equation}
D\delta G=-\alpha\left[\begin{array}{cc}
\delta\mathbf{r}^{a} & \delta\boldsymbol{\theta}^{a}\end{array}\right]\left[\begin{array}{c}
\mathbf{K}^{ab}\\
\hat{\mathbf{z}}_{n+\alpha}^{a}\cdot\mathbf{K}^{ab}
\end{array}\right]\left[\Delta\mathbf{u}^{b}\right]\,.\label{eq:rdc-arigid-bflex}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Node 
\begin_inset Formula $b$
\end_inset

 belongs to rigid body 
\begin_inset Formula $b$
\end_inset

, node 
\begin_inset Formula $a$
\end_inset

 belongs to flexible elements only,
\begin_inset Formula 
\begin{equation}
D\delta G=-\alpha\left[\delta\mathbf{v}^{a}\right]\left[\begin{array}{cc}
\mathbf{K}^{ab} & -\mathbf{K}^{ab}\cdot\hat{\mathbf{z}}_{n+1}^{b}\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{b}\\
\Delta\boldsymbol{\theta}^{b}
\end{array}\right]\,.\label{eq:rdc-aflex-brigid}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Node 
\begin_inset Formula $a$
\end_inset

 belongs to rigid body 
\begin_inset Formula $a$
\end_inset

, node 
\begin_inset Formula $b$
\end_inset

 belongs to rigid body 
\begin_inset Formula $b$
\end_inset

,
\begin_inset Formula 
\begin{equation}
D\delta G=-\alpha\left[\begin{array}{cc}
\delta\mathbf{r}^{a} & \delta\boldsymbol{\theta}^{a}\end{array}\right]\left[\begin{array}{cc}
\mathbf{K}^{ab} & -\mathbf{K}^{ab}\cdot\hat{\mathbf{z}}_{n+1}^{b}\\
\hat{\mathbf{z}}_{n+\alpha}^{a}\cdot\mathbf{K}^{ab} & -\hat{\mathbf{z}}_{n+\alpha}^{a}\cdot\mathbf{K}^{ab}\cdot\hat{\mathbf{z}}_{n+1}^{b}
\end{array}\right]\left[\begin{array}{c}
\Delta\mathbf{r}^{b}\\
\Delta\boldsymbol{\theta}^{b}
\end{array}\right]\,.\label{eq:rdc-arigid-brigid}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Nonlinear Constraints
\begin_inset CommandInset label
LatexCommand label
name "sec:Nonlinear-Constraints"

\end_inset


\end_layout

\begin_layout Standard
Nonlinear constraints are equations of the form 
\begin_inset Formula $f\left(x_{i}\right)=0$
\end_inset

, where 
\begin_inset Formula $x_{i}$
\end_inset

 represent nodal degrees of freedom.
 These constraints may be enforced using the penalty method, with or without
 augmented Lagrangian, or the method of Lagrange multipliers.
 Each method has its own advantages and disadvantages.
\end_layout

\begin_layout Subsection
Penalty Method with Augmented Lagrangian
\begin_inset CommandInset label
LatexCommand label
name "subsec:Penalty-Method"

\end_inset


\end_layout

\begin_layout Standard
The penalty method employs the penalty parameter 
\begin_inset Formula $\varepsilon$
\end_inset

 to add 
\begin_inset Formula $W_{p}=\frac{1}{2}\varepsilon f^{2}$
\end_inset

 to the total work, where 
\begin_inset Formula $\varepsilon$
\end_inset

 serves as the 'stiffness' or spring constant in the 'spring' whose 'elongation'
 is 
\begin_inset Formula $f$
\end_inset

, such that 
\begin_inset Formula $W_{p}$
\end_inset

 represents the stored energy in the spring.
 The contribution to the virtual work for this type of analysis is 
\begin_inset Formula $\delta W_{p}=\varepsilon f\,\delta f$
\end_inset

, where
\begin_inset Formula 
\begin{equation}
\delta f=\sum_{i}\frac{\partial f}{\partial x_{i}}\delta x_{i}\label{eq:nlc-virtual-force}
\end{equation}

\end_inset

If we are concerned that the value of 
\begin_inset Formula $\varepsilon$
\end_inset

 may become too large to produce good numerical convergence, we may augment
 this expression by using 
\begin_inset Formula $\delta W_{p}=\left(\lambda+\varepsilon f\right)\delta f$
\end_inset

, where 
\begin_inset Formula $\lambda$
\end_inset

 is the Lagrangian augmentation parameter, which gets updated at each iteration
 to help us avoid using a value of 
\begin_inset Formula $\varepsilon$
\end_inset

 that's too large.
 We may let 
\begin_inset Formula $c=\lambda+\varepsilon f$
\end_inset

 represent the constraint that needs to be satisfied.
 Substituing eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:nlc-virtual-force"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into this relation allows us to express 
\begin_inset Formula $\delta W_{p}$
\end_inset

 in matrix form,
\begin_inset Formula 
\begin{equation}
\delta W_{p}=\left[\begin{array}{ccc}
\delta x_{1} & \cdots & \delta x_{n}\end{array}\right]\left[\begin{array}{c}
c\frac{\partial f}{\partial x_{1}}\\
\vdots\\
c\frac{\partial f}{\partial x_{n}}
\end{array}\right]=\delta\boldsymbol{\mathbf{r}}\cdot\mathbf{\boldsymbol{f_{\mathit{p}}}}\,.\label{eq:nlc-pm-virtual-work}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{p}$
\end_inset

 along increments 
\begin_inset Formula $\Delta x_{i}$
\end_inset

 of the degrees of freedom employs
\begin_inset Formula 
\begin{equation}
Df=\sum_{j}\frac{\partial f}{\partial x_{j}}\Delta x_{j}\label{eq:nlc-pm-f-linearization}
\end{equation}

\end_inset

and takes the form
\begin_inset Formula 
\begin{equation}
D\delta W_{p}=\left[\begin{array}{ccc}
\delta x_{1} & \cdots & \delta x_{n}\end{array}\right]\left[\begin{array}{ccc}
\varepsilon\left(\frac{\partial f}{\partial x_{1}}\right)^{2}+c\frac{\partial^{2}f}{\partial x_{1}^{2}} & \cdots & \varepsilon\frac{\partial f}{\partial x_{1}}\frac{\partial f}{\partial x_{n}}+c\frac{\partial^{2}f}{\partial x_{1}\partial x_{n}}\\
\vdots & \ddots & \vdots\\
\varepsilon\frac{\partial f}{\partial x_{n}}\frac{\partial f}{\partial x_{1}}+c\frac{\partial^{2}f}{\partial x_{1}\partial x_{n}} & \cdots & \varepsilon\left(\frac{\partial f}{\partial x_{n}}\right)^{2}+c\frac{\partial^{2}f}{\partial x_{n}^{2}}
\end{array}\right]\left[\begin{array}{c}
\Delta x_{1}\\
\vdots\\
\Delta x_{n}
\end{array}\right]=\delta\boldsymbol{\mathbf{r}}\cdot\mathbf{\boldsymbol{K_{\mathit{p}}}\boldsymbol{\Delta r}}\,,\label{eq:nlc-pm-stiffness}
\end{equation}

\end_inset

The stiffness matrix for the penalty constraint is symmetric.
\end_layout

\begin_layout Standard
Lagrangian augmentation is performed after the (quasi-)Newton method has
 converged.
 At that time, the augmented Lagrangians are updated as follows
\begin_inset Formula 
\begin{equation}
\lambda^{\left(k+1\right)}\leftarrow\lambda^{\left(k\right)}+\varepsilon f\label{eq:nlc-pm-augment}
\end{equation}

\end_inset

The penalty method with augmented Lagrangian does not increase the number
 of equations that need to be solved globally.
 However, it does require users to specify the parameter 
\begin_inset Formula $\varepsilon$
\end_inset

, and to provide a convergence tolerance for Lagrange augmentation.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Linear-Constraints-Penalty"

\end_inset

For linear constraints of the form
\begin_inset Formula 
\begin{equation}
f=a_{0}+\sum_{j}a_{j}x_{j}=0\label{eq:nlc-linear-constraint}
\end{equation}

\end_inset

we find that 
\begin_inset Formula $\frac{\partial f}{\partial x_{i}}=a_{i}$
\end_inset

 and the second derivatives are all zero, so that the constributions to
 the global system of equations take the form
\begin_inset Formula 
\begin{equation}
\mathbf{f}_{\mathit{p}}=\left[\begin{array}{c}
ca_{1}\\
\vdots\\
ca_{n}
\end{array}\right],\;\mathbf{K}_{\mathit{p}}=\left[\begin{array}{ccc}
\varepsilon a_{1}^{2} & \cdots & \varepsilon a_{1}a_{n}\\
\vdots & \ddots & \vdots\\
\varepsilon a_{n}a_{1} & \cdots & \varepsilon a_{n}^{2}
\end{array}\right].\label{eq:nlc-pm-linear}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Method of Lagrange Multipliers
\begin_inset CommandInset label
LatexCommand label
name "subsec:Lagrange-Multipliers"

\end_inset


\end_layout

\begin_layout Standard
When using the method of Lagrange multipliers we have to include equations
 that solve for the multipliers.
 We let the work done by the constraint be represented by 
\begin_inset Formula $W_{c}=\lambda f$
\end_inset

, where 
\begin_inset Formula $\lambda$
\end_inset

 is the multiplier (if 
\begin_inset Formula $f$
\end_inset

 is a vector equation, we can use 
\begin_inset Formula $W_{c}=\boldsymbol{\lambda}\cdot\mathbf{f}$
\end_inset

).
 The total work is then 
\begin_inset Formula $\widetilde{W}=W+W_{c}$
\end_inset

 where 
\begin_inset Formula $W$
\end_inset

 is the work of the unconstrained problem (i.e.
 the contributions from the internal and external forces.) Then, we evaulate
 the first varition of 
\begin_inset Formula $\delta\widetilde{W}=\delta W+\delta W_{c}=0$
\end_inset

, where 
\begin_inset Formula $\delta W_{c}=\delta f+\delta\lambda\,f$
\end_inset

.
 Since 
\begin_inset Formula $\delta f$
\end_inset

 is given as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:nlc-virtual-force"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\delta W_{c}$
\end_inset

 may be written in matrix form as
\begin_inset Formula 
\begin{equation}
\delta W_{c}=\left[\begin{array}{cccc}
\delta x_{1} & \cdots & \delta x_{n} & \delta\lambda\end{array}\right]\left[\begin{array}{c}
\lambda\frac{\partial f}{\partial x_{1}}\\
\vdots\\
\lambda\frac{\partial f}{\partial x_{n}}\\
f
\end{array}\right]=\delta\boldsymbol{r\cdot}\mathbf{f}_{c}\,.\label{eq:nlc-lm-virtual-work}
\end{equation}

\end_inset

The linearization of 
\begin_inset Formula $\delta W_{c}$
\end_inset

 along increments 
\begin_inset Formula $\Delta x_{j}$
\end_inset

 and 
\begin_inset Formula $\Delta\lambda$
\end_inset

 takes the form
\begin_inset Formula 
\begin{equation}
D\delta W_{c}=\sum_{i}\delta x_{i}\frac{\partial f}{\partial x_{i}}\Delta\lambda+\sum_{i}\delta x_{i}\sum_{j}\lambda\frac{\partial^{2}f}{\partial x_{i}\partial x_{j}}\Delta x_{j}+\delta\lambda\,\sum_{j}\frac{\partial f}{\partial x_{j}}\Delta x_{j}\,.\label{eq:nlc-lm-linearization}
\end{equation}

\end_inset

The corresponding stiffness matrix is
\begin_inset Formula 
\begin{equation}
D\delta W_{c}=\left[\begin{array}{cccc}
\delta x_{1} & \cdots & \delta x_{n} & \delta\lambda\end{array}\right]\left[\begin{array}{cccc}
\lambda\frac{\partial^{2}f}{\partial x_{1}^{2}} & \cdots & \lambda\frac{\partial^{2}f}{\partial x_{1}\partial x_{n}} & \frac{\partial f}{\partial x_{1}}\\
\vdots & \ddots & \vdots & \vdots\\
\lambda\frac{\partial^{2}f}{\partial x_{n}\partial x_{1}} & \cdots & \lambda\frac{\partial^{2}f}{\partial x_{n}^{2}} & \frac{\partial f}{\partial x_{n}}\\
\frac{\partial f}{\partial x_{1}} & \cdots & \frac{\partial f}{\partial x_{n}} & 0
\end{array}\right]\left[\begin{array}{c}
\Delta x_{1}\\
\vdots\\
\Delta x_{n}\\
\Delta\lambda
\end{array}\right]=\delta\boldsymbol{r\cdot}\mathbf{K}_{c}\boldsymbol{\Delta r}\,,\label{eq:nlc-lm-stiffness}
\end{equation}

\end_inset

This resulting system of equations requires 
\begin_inset Formula $\lambda$
\end_inset

 to part of the solution, and to be updated at each iteration 
\begin_inset Formula $k$
\end_inset

 according to 
\begin_inset Formula $\lambda^{\left(k+1\right)}\leftarrow\lambda^{\left(k\right)}+\Delta\lambda$
\end_inset

.
 The stiffness matrix is symmetric for this analysis.
\end_layout

\begin_layout Standard
The method of Lagrange multipliers increases the number of equations that
 need to be solved globally.
 However, it does not require users to specify additional parameters.
 Note that the contribution to the stiffness matrix introduces a zero coefficien
t on the diagonal of the stiffness matrix for the equation corresponding
 to 
\begin_inset Formula $\Delta\lambda$
\end_inset

.
 This means that these equations can only be solved with linear solvers
 that support pivoting.
 (Most linear solvers in FEBio, including the default pardiso solver, can
 handle zero-diagonal elements.) 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Linear-System-Multiplier"

\end_inset

For linear constraints of the form
\begin_inset Formula 
\[
f=a_{0}+\sum_{j}a_{j}x_{j}=0
\]

\end_inset

we find that 
\begin_inset Formula $\frac{\partial f}{\partial x_{i}}=a_{i}$
\end_inset

 and second derivatives are all zero, so that the contributions to the global
 residual and stiffness matrix take the form
\begin_inset Formula 
\begin{equation}
\mathbf{f}_{c}=\left[\begin{array}{c}
\lambda a_{1}\\
\vdots\\
\lambda a_{n}\\
f
\end{array}\right],\:\boldsymbol{\mathbf{K}_{c}}=\left[\begin{array}{cccc}
0 & \cdots & 0 & a_{1}\\
\vdots & \ddots & \vdots & \vdots\\
0 & \cdots & 0 & a_{n}\\
a_{1} & \cdots & a_{n} & 0
\end{array}\right]\label{eq:nlc-lm-linear}
\end{equation}

\end_inset


\end_layout

\begin_layout Chapter
Optimization
\end_layout

\begin_layout Standard
This chapter describes the theoretical framework of FEBio's optimization
 module.
 This module can be used to optimize model parameters (like material parameters,
 or load values) in order to achieve an objective.
 The objective is generally the minimization of the 
\emph on
objective function
\emph default
, to be introduced below.
 
\end_layout

\begin_layout Section
The Objective Function
\end_layout

\begin_layout Standard
The objective function, which is to be minimized, can be defined as follows,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\varphi\left(\mathbf{a}\right)=\sum\limits _{i=1}^{n}\left[y_{i}-f\left(x_{i};\mathbf{a}\right)\right]^{2}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here, the 
\begin_inset Formula $\left(x_{i},y_{i}\right)$
\end_inset

 are user-defined data pairs and 
\begin_inset Formula $f\left(x;\mathbf{a}\right)$
\end_inset

 is the function that extracts the corresponding data from the model.
 The optimization module tries to find the model parameters 
\series bold
a
\series default
 that minimize the function 
\begin_inset Formula $\varphi$
\end_inset

.
 It does this by repeatedly evaluating the function 
\begin_inset Formula $y$
\end_inset

, which will usually call FEBio to solve a forward FE problem.
 
\end_layout

\begin_layout Section
The Levenberg-Marquardt Method
\end_layout

\begin_layout Standard
One of the methods that is currently implemented in FEBio's optimization
 method is the constrained Levenberg-Marquardt method via the 
\emph on
levmar 
\emph default
library.
 (see 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://users.ics.forth.gr/~lourakis/levmar/}
\end_layout

\end_inset

 for more information on this library.)
\end_layout

\begin_layout Standard
The Levenberg-Marquardt method is a numerical algorithm that minimizes a
 function that is defined as a sum of squares of nonlinear functions, i.e.
 the objective function as defined above.
 It combines the steepest-descent method with a Gauss-Newton method to find
 the parameters that minimize the objective function.
 
\end_layout

\begin_layout Standard
The LM method requires a set of measured values 
\begin_inset Formula $(x_{i},y_{i})$
\end_inset

 and an initial guess for the 
\series bold
a
\series default
 vector.
 It then tries to find a better estimate for 
\series bold
a 
\series default
by replacing it with 
\begin_inset Formula $\mathbf{a}+\delta$
\end_inset

.
 The function 
\begin_inset Formula $f(x_{i};\mathbf{a}+\delta)$
\end_inset

 is linearly approximated.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f\left(x_{i};\mathbf{a}+\delta\right)\approx f\left(x_{i};\mathbf{a}\right)+\mathbf{J}_{i}\delta
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\mathbf{J}_{i}$
\end_inset

is the Jacobian of 
\emph on

\begin_inset Formula $f$
\end_inset


\emph default
 with respect to 
\begin_inset Formula $\delta$
\end_inset

.
 Substituting this in the objective function and minimizing with respect
 to 
\begin_inset Formula $\delta$
\end_inset

 leads to,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(\mathbf{J^{\mathrm{T}}J\mathrm{)\delta=}J^{\mathrm{T}}\mathrm{(\mathbf{y}-\mathbf{f}(\boldsymbol{a}))}}
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\series bold
y
\series default
 is the vector of 
\begin_inset Formula $y_{i},$
\end_inset

and 
\series bold
f
\series default
 is the vector of 
\begin_inset Formula $f(x_{i};\boldsymbol{a})$
\end_inset

.
 
\end_layout

\begin_layout Standard
The main idea of the LM method is to replace this linear equation with the
 following.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(\mathbf{J^{\mathrm{T}}J\mathrm{+\mu(\mathbf{J}^{\mathrm{T}}\mathbf{J})_{\mathit{ii}})\delta=}J^{\mathrm{T}}\mathrm{(\mathbf{y}-\mathbf{f}(\boldsymbol{a}))}}
\]

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $\mu$
\end_inset

is a damping parameter that is controlled by the algorithm.
 When 
\begin_inset Formula $\mu$
\end_inset

is small, the method approximates Gauss-Newton, when 
\begin_inset Formula $\mu$
\end_inset

is large it is closer to a steepdest-descent method.
 The algorithm will modify try to modify 
\begin_inset Formula $\mu$
\end_inset

such that an improvement to the parameter vector 
\series bold
a
\series default
 can be found in each iteration.
 The method will terminate when the value of the objective function falls
 below a user-specified tolerance (the 
\emph on
obj_tol
\emph default
 parameter in FEBio).
 
\end_layout

\begin_layout Standard
The evaluation of the Jacobian requires evaluating the derivatives of 
\begin_inset Formula $f$
\end_inset

 with respect to 
\series bold
a
\series default
.
 These derivatives are approximated via forward difference formulas.
 For example, the 
\begin_inset Formula $k$
\end_inset

-th component of the gradient is approximated as follows.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial f}{\partial a_{k}}\approx\frac{1}{\delta a_{k}}\left[f\left(a_{1},\cdots,a_{k}+\delta a_{k},\cdots,a_{m}\right)-f\left(a_{1},\cdots,a_{k},\cdots,a_{m}\right)\right]
\]

\end_inset

The value for 
\begin_inset Formula $\delta a_{k}$
\end_inset

is determined from the following formula.
 
\begin_inset Formula 
\[
\delta a_{k}=\varepsilon\left(1+a_{k}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
where, 
\begin_inset Formula $\varepsilon$
\end_inset

 is the forward difference scale factor (the 
\shape italic
fdiff_scale 
\shape default
option in FEBio).
 In FEBio, the initial value for the damping parameter 
\begin_inset Formula $\mu$
\end_inset

can be set with the 
\emph on
tau 
\emph default
parameter.
\end_layout

\begin_layout Chapter
\start_of_appendix
Tensor Calculus
\end_layout

\begin_layout Section
Second-Order Tensors
\end_layout

\begin_layout Subsection
Definition
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{T}$
\end_inset

 be a transformation, which transforms any vector into another vector, e.g.,
 
\begin_inset Formula 
\[
\mathbf{T}\cdot\mathbf{a}=\mathbf{b}\quad\mathbf{T}\cdot\mathbf{c}=\mathbf{d}
\]

\end_inset

 If 
\begin_inset Formula $\mathbf{T}$
\end_inset

 has the following properties, 
\begin_inset Formula 
\begin{equation}
\mathbf{T}\cdot\left(\mathbf{a}+\mathbf{c}\right)=\mathbf{T}\cdot\mathbf{a}+\mathbf{T}\cdot\mathbf{c}\label{eq6-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{T}\cdot\left(\alpha\mathbf{a}\right)=\alpha\mathbf{T}\cdot\mathbf{a}\label{eq7-1}
\end{equation}

\end_inset

 where 
\begin_inset Formula $\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{c}$
\end_inset

 are arbitrary vectors, and 
\begin_inset Formula $\alpha$
\end_inset

 is an arbitrary scalar, then 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is called a 
\shape italic
linear transformation
\shape default
, a 
\shape italic
second-order tensor
\shape default
, or simply a 
\shape italic
tensor
\shape default
.
 Vectors are first-order tensors and scalars are zeroth-order tensors.
 
\end_layout

\begin_layout Subsection
Cartesian Components of a Tensor
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 form an orthonormal basis in a Cartesian coordinate system 
\begin_inset Formula $x_{1},x_{2},x_{3}$
\end_inset

.
 Then the Cartesian components of 
\begin_inset Formula $\mathbf{a}$
\end_inset

 are 
\begin_inset Formula 
\[
a_{1}=\mathbf{e}_{1}\cdot\mathbf{a},\quad a_{2}=\mathbf{e}_{2}\cdot\mathbf{a},\quad a_{3}=\mathbf{e}_{3}\cdot\mathbf{a}
\]

\end_inset

 or equivalently, 
\begin_inset Formula 
\begin{equation}
\boxed{a_{j}=\mathbf{e}_{j}\cdot\mathbf{a}}\label{eq7b}
\end{equation}

\end_inset

 (Recall that 
\begin_inset Formula $\mathbf{a}=a_{i}\mathbf{e}_{i}$
\end_inset

, thus 
\begin_inset Formula $\mathbf{a}\cdot\mathbf{e}_{j}=a_{i}\mathbf{e}_{i}\cdot\mathbf{e}_{j}=a_{i}\delta_{ij}=a_{j}$
\end_inset

.) 
\end_layout

\begin_layout Standard
The Cartesian components of a tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 are obtained as follows.
 Let 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{a}=\mathbf{b}$
\end_inset

.
 The components of 
\begin_inset Formula $\mathbf{b}$
\end_inset

 are given by 
\begin_inset Formula $b_{i}=\mathbf{e}_{i}\cdot\mathbf{b}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{a}$
\end_inset

.
 But 
\begin_inset Formula $\mathbf{a}=a_{j}\mathbf{e}_{j}$
\end_inset

, so 
\begin_inset Formula $b_{i}=a_{j}\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}$
\end_inset

.
 Note that 
\begin_inset Formula $\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}$
\end_inset

 is the component along 
\begin_inset Formula $\mathbf{e}_{i}$
\end_inset

 of the vector 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{e}_{j}$
\end_inset

.
 By convention, we denote this component as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boxed{T_{ij}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}}\quad\text{components of tensor }\mathbf{T}\label{eq7c}
\end{equation}

\end_inset

 components of tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
\end_layout

\begin_layout Standard
Thus, 
\begin_inset Formula $\mathbf{b}=\mathbf{T}\cdot\mathbf{a}=a_{j}\mathbf{T}\cdot\mathbf{e}_{j}=b_{k}\mathbf{e}_{k}$
\end_inset

.
 Taking the dot product on both sides with 
\begin_inset Formula $\mathbf{e}_{i}$
\end_inset

 yields 
\begin_inset Formula $a_{j}\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}=a_{j}T_{ij}=b_{k}\mathbf{e}_{i}\cdot\mathbf{e}_{k}=b_{k}\delta_{ik}=b_{i}$
\end_inset

, or
\begin_inset Formula 
\[
\boxed{b_{i}=T_{ij}a_{j}}
\]

\end_inset

 in indicial form.
 In matrix form, 
\begin_inset Formula 
\[
\left[\begin{array}{c}
b_{1}\\
b_{2}\\
b_{3}
\end{array}\right]=\left[\begin{array}{ccc}
T_{11} & T_{12} & T_{13}\\
T_{21} & T_{22} & T_{23}\\
T_{31} & T_{32} & T_{33}
\end{array}\right]\left[\begin{array}{c}
a_{1}\\
a_{2}\\
a_{3}
\end{array}\right]
\]

\end_inset

 The matrix of tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 with respect to 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 can also be denoted by 
\begin_inset Formula $\left[\mathbf{T}\right]$
\end_inset

 or 
\begin_inset Formula $\left[T_{ij}\right]$
\end_inset

.
 The columns of 
\begin_inset Formula $\left[\mathbf{T}\right]$
\end_inset

 are given by 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{e}_{i}$
\end_inset

, e.g., 
\begin_inset Formula 
\[
\left[\mathbf{T}\cdot\mathbf{e}_{2}\right]=\left[T_{j2}\mathbf{e}_{2}\right]=\left[\begin{array}{ccc}
T_{11} & T_{12} & T_{13}\\
T_{21} & T_{22} & T_{23}\\
T_{31} & T_{32} & T_{33}
\end{array}\right]\left[\begin{array}{c}
0\\
1\\
0
\end{array}\right]=\left[\begin{array}{c}
T_{12}\\
T_{22}\\
T_{32}
\end{array}\right]
\]

\end_inset

 This result, when generalized, leads to the useful identity 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{T}\cdot\mathbf{e}_{i}=T_{ji}\mathbf{e}_{j}}=T_{1i}\mathbf{e}_{1}+T_{2i}\mathbf{e}_{2}+T_{3i}\mathbf{e}_{3}\label{eq8-1}
\end{equation}

\end_inset

 
\end_layout

\begin_layout Example
Scaling transformation
\end_layout

\begin_layout Example
A scaling transformation 
\begin_inset Formula $\mathbf{T}$
\end_inset

 with different scale factors along 
\begin_inset Formula $x_{1},x_{2},x_{3}$
\end_inset

 should satisfy the following relations by definition:
\begin_inset Formula 
\[
\mathbf{T}\cdot\mathbf{a}=s_{1}\left(\mathbf{a}\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\mathbf{a}\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\mathbf{a}\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}
\]

\end_inset

Verify that 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is a tensor.
 Also find the matrix of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 in 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

.
\end_layout

\begin_layout Example

\shape italic
Solution
\shape default
.
 Is 
\begin_inset Formula $\mathbf{T}$
\end_inset

 a tensor? Let any 
\begin_inset Formula $\mathbf{a}=a_{i}\mathbf{e}_{i}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}=b_{i}\mathbf{e}_{i}$
\end_inset

, then
\begin_inset Formula 
\[
\begin{aligned}\mathbf{T}\cdot\left(\alpha\mathbf{a}\right) & =s_{1}\left(\alpha\mathbf{a}\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\alpha\mathbf{a}\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\alpha\mathbf{a}\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}\\
 & =\alpha\left(s_{1}\left(\mathbf{a}\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\mathbf{a}\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\mathbf{a}\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}\right)\\
 & =\alpha\mathbf{T}\cdot\mathbf{a}
\end{aligned}
\]

\end_inset

and
\begin_inset Formula 
\[
\begin{aligned}\mathbf{T}\cdot\left(\mathbf{a}+\mathbf{b}\right) & =s_{1}\left(\left(\mathbf{a}+\mathbf{b}\right)\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\left(\mathbf{a}+\mathbf{b}\right)\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\left(\mathbf{a}+\mathbf{b}\right)\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}\\
 & =s_{1}\left(\mathbf{a}\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\mathbf{a}\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\mathbf{a}\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}\\
 & +s_{1}\left(\mathbf{b}\cdot\mathbf{e}_{1}\right)\mathbf{e}_{1}+s_{2}\left(\mathbf{b}\cdot\mathbf{e}_{2}\right)\mathbf{e}_{2}+s_{3}\left(\mathbf{b}\cdot\mathbf{e}_{3}\right)\mathbf{e}_{3}\\
 & =\mathbf{T}\cdot\mathbf{a}+\mathbf{T}\cdot\mathbf{b}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Example
Now that we have demonstrated that 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is a tensor, its components are given by 
\begin_inset Formula $T_{ij}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}$
\end_inset

, thus 
\begin_inset Formula 
\[
\begin{gathered}\left[T_{i1}\right]=\left[\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{1}\right]=\left[\mathbf{e}_{i}\cdot s_{1}\mathbf{e}_{1}\right]=\left[s_{1}\delta_{i1}\right]=\left[\begin{array}{c}
s_{1}\\
0\\
0
\end{array}\right]\\
\left[T_{i2}\right]=\left[\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{2}\right]=\left[\mathbf{e}_{i}\cdot s_{2}\mathbf{e}_{2}\right]=\left[s_{2}\delta_{i2}\right]=\left[\begin{array}{c}
0\\
s_{2}\\
0
\end{array}\right]\\
\left[T_{i3}\right]=\left[\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{3}\right]=\left[\mathbf{e}_{i}\cdot s_{3}\mathbf{e}_{3}\right]=\left[s_{3}\delta_{i3}\right]=\left[\begin{array}{c}
0\\
0\\
s_{3}
\end{array}\right]
\end{gathered}
\]

\end_inset

 Then, the matrix of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 is given by 
\begin_inset Formula 
\[
\left[\mathbf{T}\right]=\left[\begin{array}{ccc}
s_{1} & 0 & 0\\
0 & s_{2} & 0\\
0 & 0 & s_{3}
\end{array}\right]
\]

\end_inset

 
\end_layout

\begin_layout Subsection
Sum of Tensors
\end_layout

\begin_layout Standard
The sum of two tensors 
\begin_inset Formula $\mathbf{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is denoted by 
\begin_inset Formula $\mathbf{T}+\mathbf{S}$
\end_inset

 and defined by 
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{T}+\mathbf{S}\right)\cdot\mathbf{a}=\mathbf{T}\cdot\mathbf{a}+\mathbf{S}\cdot\mathbf{a}}\label{eq9-1}
\end{equation}

\end_inset

 for any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

.
 Thus 
\begin_inset Formula $\mathbf{T}+\mathbf{S}$
\end_inset

 is also a tensor, whose components are 
\begin_inset Formula 
\[
\left(\mathbf{T}+\mathbf{S}\right)_{ij}=\mathbf{e}_{i}\cdot\left(\mathbf{T}+\mathbf{S}\right)\cdot\mathbf{e}_{j}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}+\mathbf{e}_{i}\cdot\mathbf{S}\cdot\mathbf{e}_{j}=T_{ij}+S_{ij}
\]

\end_inset

 In matrix notation, 
\begin_inset Formula $\left[\mathbf{T}+\mathbf{S}\right]=\left[\mathbf{T}\right]+\left[\mathbf{S}\right]$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Dyadic Product of Vectors
\end_layout

\begin_layout Standard
The dyadic product of two vectors 
\begin_inset Formula $\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is denoted by 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}$
\end_inset

 (or 
\begin_inset Formula $\mathbf{ab}$
\end_inset

) and defined as the transformation which satisfies 
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\mathbf{c}=\left(\mathbf{b}\cdot\mathbf{c}\right)\mathbf{a}}\label{eq10-1}
\end{equation}

\end_inset

 For any 
\begin_inset Formula $\mathbf{c}$
\end_inset

, 
\begin_inset Formula $\mathbf{d}$
\end_inset

, 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

, we have 
\begin_inset Formula 
\[
\begin{gathered}\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\left(\alpha\mathbf{c}+\beta\mathbf{d}\right)=\left(\mathbf{b}\cdot\left(\alpha\mathbf{c}+\beta\mathbf{d}\right)\right)\mathbf{a}=\left(\mathbf{b}\cdot\alpha\mathbf{c}\right)\mathbf{a}+\left(\mathbf{b}\cdot\beta\mathbf{d}\right)\mathbf{a}\\
=\alpha\left(\mathbf{b}\cdot\mathbf{c}\right)\mathbf{a}+\beta\left(\mathbf{b}\cdot\mathbf{d}\right)\mathbf{a}=\alpha\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\mathbf{c}+\beta\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\mathbf{d}
\end{gathered}
\]

\end_inset

 thus 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}$
\end_inset

 is a tensor.
 Its Cartesian components with respect to 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are 
\begin_inset Formula 
\[
\left(\mathbf{a}\otimes\mathbf{b}\right)_{ij}=\mathbf{e}_{i}\cdot\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\mathbf{e}_{j}=\mathbf{e}_{i}\cdot\left(\mathbf{b}\cdot\mathbf{e}_{j}\right)\mathbf{a}=b_{j}\mathbf{e}_{i}\cdot\mathbf{a}=a_{i}b_{j}
\]

\end_inset

 In matrix form, 
\begin_inset Formula 
\[
\left[\mathbf{a}\otimes\mathbf{b}\right]=\left[\begin{array}{ccc}
a_{1}b_{1} & a_{1}b_{2} & a_{1}b_{3}\\
a_{2}b_{1} & a_{2}b_{2} & a_{2}b_{3}\\
a_{3}b_{1} & a_{3}b_{2} & a_{3}b_{3}
\end{array}\right]=\left[\begin{array}{c}
a_{1}\\
a_{2}\\
a_{3}
\end{array}\right]\left[\begin{array}{ccc}
b_{1} & b_{2} & b_{3}\end{array}\right]=\left[\mathbf{a}\right]\left[\mathbf{b}\right]^{T}
\]

\end_inset

 Note that in general, 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}\ne\mathbf{b}\otimes\mathbf{a}$
\end_inset

, i.e., the dyadic product is 
\shape italic
not commutative
\shape default
.
 Also note that 
\begin_inset Formula 
\[
\left[\mathbf{e}_{1}\otimes\mathbf{e}_{1}\right]=\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 0 & 0\\
0 & 0 & 0
\end{array}\right],\quad\left[\mathbf{e}_{1}\otimes\mathbf{e}_{2}\right]=\left[\begin{array}{ccc}
0 & 1 & 0\\
0 & 0 & 0\\
0 & 0 & 0
\end{array}\right],\quad\left[\mathbf{e}_{1}\otimes\mathbf{e}_{3}\right]=\left[\begin{array}{ccc}
0 & 0 & 1\\
0 & 0 & 0\\
0 & 0 & 0
\end{array}\right]\quad\text{etc.}
\]

\end_inset

thus it is possible to represent a second-order tensor in terms of its Cartesian
 components in 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 as 
\begin_inset Formula $\mathbf{T}=T_{11}\mathbf{e}_{1}\otimes\mathbf{e}_{1}+T_{12}\mathbf{e}_{1}\otimes\mathbf{e}_{2}+T_{13}\mathbf{e}_{1}\otimes\mathbf{e}_{3}+\ldots+T_{33}\mathbf{e}_{3}\otimes\mathbf{e}_{3}$
\end_inset

, or 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{T}=T_{ij}\mathbf{e}_{i}\otimes\mathbf{e}_{j}}\label{eq11-1}
\end{equation}

\end_inset

This turns out to be an important result that can be generalized to higher
 order tensors, e.g., third-order tensors can be represented in terms of their
 Cartesian components as 
\begin_inset Formula $\mathbb{T}=T_{ijk}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}$
\end_inset

, and similarly for higher orders.
 
\end_layout

\begin_layout Example
The scaling transformation derived in a previous example can be represented
 as 
\begin_inset Formula 
\[
\mathbf{T}=s_{1}\mathbf{e}_{1}\otimes\mathbf{e}_{1}+s_{2}\mathbf{e}_{2}\otimes\mathbf{e}_{2}+s_{3}\mathbf{e}_{3}\otimes\mathbf{e}_{3}
\]

\end_inset


\end_layout

\begin_layout Subsection
Trace of a Second-Order Tensor
\end_layout

\begin_layout Standard
The trace of any dyad 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}$
\end_inset

 is defined by 
\begin_inset Formula 
\[
\boxed{\tr\left(\mathbf{a}\otimes\mathbf{b}\right)=\mathbf{a}\cdot\mathbf{b}}
\]

\end_inset

 and 
\begin_inset Formula 
\[
\boxed{\tr\left(\alpha\mathbf{a}\otimes\mathbf{b}+\beta\mathbf{c}\otimes\mathbf{d}\right)=\alpha\tr\left(\mathbf{a}\otimes\mathbf{b}\right)+\beta\tr\left(\mathbf{c}\otimes\mathbf{d}\right)}
\]

\end_inset

The trace operator yields a scalar function.
 In component form, 
\begin_inset Formula 
\[
\tr\left(a_{i}b_{j}\right)=a_{i}b_{i}
\]

\end_inset

 For any tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

, we can write 
\begin_inset Formula $\mathbf{T}=T_{ij}\mathbf{e}_{i}\otimes\mathbf{e}_{j}$
\end_inset

, thus 
\begin_inset Formula 
\[
\tr\mathbf{T}=T_{ij}\tr\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)=T_{ij}\mathbf{e}_{i}\cdot\mathbf{e}_{j}=T_{ij}\delta_{ij}=T_{ii}=T_{11}+T_{22}+T_{33}
\]

\end_inset

 The trace of a tensor is the sum of its diagonal components.
 
\end_layout

\begin_layout Subsection
Product of Two Tensors
\end_layout

\begin_layout Standard
The products of two tensors 
\begin_inset Formula $\mathbf{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}$
\end_inset

 are denoted by 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{S}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}\cdot\mathbf{T}$
\end_inset

 and defined respectively by 
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{T}\cdot\mathbf{S}\right)\cdot\mathbf{a}=\mathbf{T}\cdot\left(\mathbf{S}\cdot\mathbf{a}\right)}\label{eq12-1}
\end{equation}

\end_inset

 and 
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{S}\cdot\mathbf{T}\right)\cdot\mathbf{a}=\mathbf{S}\cdot\left(\mathbf{T}\cdot\mathbf{a}\right)}\label{eq12b}
\end{equation}

\end_inset

Clearly, 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{S}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}\cdot\mathbf{T}$
\end_inset

 are tensors as well.
 Their components in 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are given by 
\begin_inset Formula 
\[
\left(\mathbf{T}\cdot\mathbf{S}\right)_{ij}=\mathbf{e}_{i}\cdot\left(\mathbf{T}\cdot\mathbf{S}\right)\cdot\mathbf{e}_{j}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\left(\mathbf{S}\cdot\mathbf{e}_{j}\right)=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\left(S_{kj}\mathbf{e}_{k}\right)=S_{kj}\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{k}=T_{ik}S_{kj}
\]

\end_inset

 In matrix form, 
\begin_inset Formula $\left[\mathbf{T}\cdot\mathbf{S}\right]=\left[\mathbf{T}\right]\left[\mathbf{S}\right]$
\end_inset

.
 Similarly, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(\mathbf{S}\cdot\mathbf{T}\right)_{ij}=S_{ik}T_{kj}\quad\text{and}\quad\left[\mathbf{S}\cdot\mathbf{T}\right]=\left[\mathbf{S}\right]\left[\mathbf{T}\right]
\]

\end_inset

 In general, 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{S}\ne\mathbf{S}\cdot\mathbf{T}$
\end_inset

, however 
\begin_inset Formula $\left(\mathbf{T}\cdot\mathbf{S}\right)\cdot\mathbf{V}=\mathbf{T}\cdot\left(\mathbf{S}\cdot\mathbf{V}\right)$
\end_inset

, i.e., the tensor product is 
\shape italic
associative
\shape default
 but 
\shape italic
not commutative
\shape default
.
 
\end_layout

\begin_layout Subsection
Identity Tensor and Tensor Inverse
\end_layout

\begin_layout Standard
The identity tensor, denoted by 
\begin_inset Formula $\mathbf{I}$
\end_inset

, is defined by 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{I}\cdot\mathbf{a}=\mathbf{a}}\label{eq13-1}
\end{equation}

\end_inset

 for any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

.
 The Cartesian components o f 
\begin_inset Formula $\mathbf{I}$
\end_inset

 in 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are given by 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
I_{ij}=\mathbf{e}_{i}\cdot\mathbf{I}\cdot\mathbf{e}_{j}=\mathbf{e}_{i}\cdot\mathbf{e}_{j}=\delta_{ij}
\]

\end_inset

 or 
\begin_inset Formula 
\[
\left[\mathbf{I}\right]=\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{array}\right]
\]

\end_inset

Given 
\begin_inset Formula $\mathbf{T}$
\end_inset

, if 
\begin_inset Formula $\mathbf{S}$
\end_inset

 exists such that 
\begin_inset Formula $\mathbf{S}\cdot\mathbf{T}=\mathbf{I}$
\end_inset

, we call 
\begin_inset Formula $\mathbf{S}$
\end_inset

 the 
\emph on
inverse
\emph default
 of 
\begin_inset Formula $\mathbf{T}$
\end_inset

, and 
\begin_inset Formula $\mathbf{S}=\mathbf{T}^{-1}$
\end_inset

.
 The inverse exists as long as 
\begin_inset Formula $\det\mathbf{T}\neq0$
\end_inset

.
 Also note that 
\begin_inset Formula $\left(\mathbf{T}^{-1}\right)^{-1}=\mathbf{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{T}^{-1}\cdot\mathbf{T}=\mathbf{T}\cdot\mathbf{T}^{-1}=\mathbf{I}$
\end_inset

.
 Also note that
\begin_inset Formula 
\[
\boxed{\left(\mathbf{U}\cdot\mathbf{V}\right)^{-1}=\mathbf{V}^{-1}\cdot\mathbf{U}^{-1}}\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
Transpose of a Tensor
\end_layout

\begin_layout Standard
Given a tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

, its transpose is denoted by 
\begin_inset Formula $\mathbf{T}^{T}$
\end_inset

 which is defined by 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{a}\cdot\left(\mathbf{T}\cdot\mathbf{b}\right)=\mathbf{b}\cdot\left(\mathbf{T}^{T}\cdot\mathbf{\mathbf{a}}\right)}\label{eq14-1}
\end{equation}

\end_inset

 In component form, 
\begin_inset Formula 
\[
T_{ij}^{T}=\mathbf{e}_{i}\cdot\mathbf{T}^{T}\cdot\mathbf{e}_{j}=\mathbf{e}_{j}\cdot\mathbf{T}\cdot\mathbf{e}_{i}=T_{ji}
\]

\end_inset

 Also note that 
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{S}\cdot\mathbf{T}\right)^{T}=\mathbf{T}^{T}\cdot\mathbf{S}^{T}}\label{eq15-1}
\end{equation}

\end_inset

and 
\begin_inset Formula $\left(\mathbf{S}^{T}\right)^{T}=\mathbf{S}$
\end_inset

 and
\begin_inset Formula $\left(\mathbf{S}+\mathbf{T}\right)^{T}=\mathbf{S}^{T}+\mathbf{T}^{T}$
\end_inset

.
\end_layout

\begin_layout Subsection
Double Product of Tensors
\end_layout

\begin_layout Standard
The double product of tensors is analogous to the dot product of vectors.
 Given two tensors 
\begin_inset Formula $\mathbf{S}$
\end_inset

 and 
\begin_inset Formula $\mathbf{T}$
\end_inset

, the double product (or 
\shape italic
double contraction
\shape default
) is defined as 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{S}:\mathbf{T}=\tr\left(\mathbf{S}^{T}\cdot\mathbf{T}\right)}\label{eq16-1}
\end{equation}

\end_inset

 Thus, for any tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

, 
\begin_inset Formula $\tr\mathbf{T}=\mathbf{I}:\mathbf{T}$
\end_inset

.
 In component form, 
\begin_inset Formula 
\[
\mathbf{S}:\mathbf{T}=S_{ij}T_{ij}
\]

\end_inset

The double product of second order tensors is commutative.
 
\end_layout

\begin_layout Example
Show that 
\begin_inset Formula $\mathbf{a}\cdot\mathbf{T}\cdot\mathbf{b}=\mathbf{T}:\left(\mathbf{a}\otimes\mathbf{b}\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathbf{a}\otimes\mathbf{b}\right):\left(\mathbf{c}\otimes\mathbf{d}\right)=\left(\mathbf{a}\cdot\mathbf{c}\right)\left(\mathbf{b}\cdot\mathbf{d}\right)$
\end_inset

.
 
\end_layout

\begin_layout Example
Using indicial notation, 
\begin_inset Formula 
\[
\mathbf{a}\cdot\mathbf{T}\cdot\mathbf{b}=a_{i}T_{ij}b_{j}=T_{ij}a_{i}b_{j}=\mathbf{T}:\left(\mathbf{a}\otimes\mathbf{b}\right)\,,
\]

\end_inset

and
\begin_inset Formula 
\[
\left(\mathbf{a}\otimes\mathbf{b}\right):\left(\mathbf{c}\otimes\mathbf{d}\right)=a_{i}b_{j}c_{i}d_{j}=\left(a_{i}c_{i}\right)\left(b_{j}d_{j}\right)=\left(\mathbf{a}\cdot\mathbf{c}\right)\left(\mathbf{b}\cdot\mathbf{d}\right)\,.
\]

\end_inset


\end_layout

\begin_layout Subsection
Determinant of a Tensor
\begin_inset CommandInset label
LatexCommand label
name "subsubsec:determinant"

\end_inset


\end_layout

\begin_layout Standard
The determinant of a tensor is equal to the determinant of its components
 in 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\det\mathbf{T}=\det\left[\mathbf{T}\right]_{\mathbf{e}_{i}}=\left|\begin{array}{ccc}
T_{11} & T_{12} & T_{13}\\
T_{21} & T_{22} & T_{23}\\
T_{31} & T_{32} & T_{33}
\end{array}\right|=\left(\mathbf{T}\cdot\mathbf{e}_{1}\times\mathbf{T}\cdot\mathbf{e}_{2}\right)\cdot\mathbf{T}\cdot\mathbf{e}_{3}=\varepsilon_{ijk}T_{i1}T_{j2}T_{k3}\label{eq17-1}
\end{equation}

\end_inset

 In particular, the determinant of a diagonal matrix is the product of the
 diagonal components, 
\begin_inset Formula 
\begin{equation}
\det\left[\mathbf{T}\right]_{\mathbf{e}_{i}}=\left|\begin{array}{ccc}
T_{11} & 0 & 0\\
0 & T_{22} & 0\\
0 & 0 & T_{33}
\end{array}\right|=\varepsilon_{123}T_{11}T_{22}T_{33}=T_{11}T_{22}T_{33}\label{eq18-1}
\end{equation}

\end_inset

 The determinant satisfies the following relations, 
\begin_inset Formula 
\begin{equation}
\det\mathbf{T}^{-1}=\frac{1}{\det\mathbf{T}}\label{eq19-1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\det\left(\mathbf{S}\cdot\mathbf{T}\right)=\left(\det\mathbf{S}\right)\left(\det\mathbf{T}\right)\label{eq20-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Orthogonal Tensor
\end_layout

\begin_layout Standard
An orthogonal tensor 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is a linear transformation which preserves the length of a vector and the
 angle between vectors.
 Thus, by definition, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left|\mathbf{Q}\cdot\mathbf{a}\right|=\left|\mathbf{a}\right|\quad\text{and}\quad\cos\left(\mathbf{Q}\cdot\mathbf{a},\mathbf{Q}\cdot\mathbf{b}\right)=\cos\left(\mathbf{a},\mathbf{b}\right)
\]

\end_inset

 for any vectors 
\begin_inset Formula $\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}$
\end_inset

.
 It follows from this definition and the definition of the dot product of
 vectors (
\begin_inset Formula $\mathbf{a}\cdot\mathbf{b}=\left|\mathbf{a}\right|\left|\mathbf{b}\right|\cos\left(\mathbf{a},\mathbf{b}\right))$
\end_inset

, that 
\begin_inset Formula 
\[
\left(\mathbf{Q}\cdot\mathbf{a}\right)\cdot\left(\mathbf{Q}\cdot\mathbf{b}\right)=\mathbf{a}\cdot\mathbf{b}
\]

\end_inset

 But 
\begin_inset Formula $\left(\mathbf{Q}\cdot\mathbf{a}\right)\cdot\left(\mathbf{Q}\cdot\mathbf{b}\right)=\mathbf{b}\cdot\left(\mathbf{Q}^{T}\cdot\mathbf{Q}\right)\mathbf{a}=\mathbf{a}\cdot\mathbf{b}=\mathbf{b}\cdot\mathbf{I}\cdot\mathbf{a}$
\end_inset

, which implies that 
\begin_inset Formula $\mathbf{b}\cdot\left(\mathbf{Q}^{T}\cdot\mathbf{Q}-\mathbf{I}\right)\cdot\mathbf{a}=0$
\end_inset

.
 Since 
\begin_inset Formula $\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{b}$
\end_inset

 are arbitrary, an orthogonal tensor must satisfy 
\begin_inset Formula $\mathbf{Q}^{T}\cdot\mathbf{Q}=\mathbf{I}$
\end_inset

.
 In indicial form, 
\begin_inset Formula $Q_{im}^{T}Q_{mj}=Q_{mi}Q_{mj}=\delta_{ij}$
\end_inset

, and in matrix form, 
\begin_inset Formula $\left[\mathbf{Q}\right]^{T}\left[\mathbf{Q}\right]=\left[\mathbf{I}\right]$
\end_inset

.
 
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\mathbf{Q}^{T}\cdot\mathbf{Q}=\mathbf{I}$
\end_inset

 implies that 
\begin_inset Formula $\mathbf{Q}^{T}=\mathbf{Q}^{-1}$
\end_inset

, i.e., the transpose of an orthogonal tensor is equal to its inverse, since
 
\begin_inset Formula $\mathbf{Q}^{-1}\cdot\mathbf{Q}=\mathbf{Q}\cdot\mathbf{Q}^{-1}=\mathbf{I}$
\end_inset

.
 It follows that 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbf{Q}^{T}\cdot\mathbf{Q}=\mathbf{Q}\cdot\mathbf{Q}^{T}=\mathbf{I}}\label{eq21-1}
\end{equation}

\end_inset

 The determinant of an orthogonal tensor is given by 
\begin_inset Formula 
\[
\det\mathbf{Q}=\left(\mathbf{Q}\cdot\mathbf{e}_{1}\times\mathbf{Q}\cdot\mathbf{e}_{2}\right)\cdot\mathbf{Q}\cdot\mathbf{e}_{3}=\left(\mathbf{e}'_{1}\times\mathbf{e}'_{2}\right)\cdot\mathbf{e}'_{3}=\pm\mathbf{e}'_{3}\cdot\mathbf{e}'_{3}=\pm1
\]

\end_inset

 Here, 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 is the orthonormal basis resulting from the transformation of 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 by 
\begin_inset Formula $\mathbf{Q}$
\end_inset

.
 If 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 maintains the handedness of 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 (e.g., if both 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 form a right-handed basis), then 
\begin_inset Formula $\det\mathbf{Q}=+1$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is called a 
\shape italic
proper
\shape default
 orthogonal transformation (also equivalent to a rigid body rotation).
 Otherwise, in the case of a reflection which reverses the handedness of
 the basis vectors, 
\begin_inset Formula $\det\mathbf{Q}=-1$
\end_inset

 and 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is called 
\shape italic
improper
\shape default
 (e.g., 
\begin_inset Formula $\mathbf{e}'_{1}=\mathbf{e}_{1},\,\mathbf{e}'_{2}=-\mathbf{e}_{2},\,\mathbf{e}'_{3}=\mathbf{e}_{3}$
\end_inset

).
 
\end_layout

\begin_layout Subsection
Transformation Laws for Cartesian Components of Vectors and Tensors
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigOrthoBases.png
	lyxscale 50
	width 1.39in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Orthonormal bases 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig3"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Let 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 be two orthogonal bases in a Cartesian coordinate system.
 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 could be made to coincide with 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 through a rigid body rotation (i.e., a transformation that preserves vector
 length and angles), 
\begin_inset Formula 
\[
\mathbf{e}'_{i}=\mathbf{Q}\cdot\mathbf{e}_{i}=Q_{mi}\mathbf{e}_{m}
\]

\end_inset

 where 
\begin_inset Formula $Q_{mi}Q_{mj}=Q_{im}Q_{jm}=\delta_{ij}$
\end_inset

.
 Since 
\begin_inset Formula $Q_{mi}=\mathbf{e}_{m}\cdot\mathbf{Q}\cdot\mathbf{e}_{i}=\mathbf{e}_{m}\cdot\mathbf{e}'_{i}=\cos\left(\mathbf{e}_{m},\mathbf{e}'_{i}\right)$
\end_inset

, the components of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 are direction cosines between 
\begin_inset Formula $\mathbf{e}_{m}$
\end_inset

 and 
\begin_inset Formula $\mathbf{e}'_{i}$
\end_inset

.
 
\end_layout

\begin_layout Example
Rotation about 
\begin_inset Formula $x_{3}$
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigRotationAboutX3.png
	lyxscale 50
	width 2.58in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Rotation about 
\begin_inset Formula $x_{3}$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig36"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Formula 
\[
\left[\mathbf{Q}\right]=\left[\begin{array}{ccc}
\cos\theta & -\sin\theta & 0\\
\sin\theta & \cos\theta & 0\\
0 & 0 & 1
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Example
Reflection about 
\begin_inset Formula $x_{2}-x_{3}$
\end_inset

 plane, 
\begin_inset Formula $\mathbf{e}'_{1}=\mathbf{Q}\cdot\mathbf{e}_{1}=-\mathbf{e}_{1},\,\mathbf{e}'_{2}=\mathbf{Q}\cdot\mathbf{e}_{2}=\mathbf{e}_{2},\,\mathbf{e}'_{3}=\mathbf{Q}\cdot\mathbf{e}_{3}=\mathbf{e}_{3}$
\end_inset

.
\begin_inset Formula 
\[
\left[\mathbf{Q}\right]=\left[\begin{array}{ccc}
-1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & 1
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
For any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

, its components with respect to 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 are 
\begin_inset Formula $a_{i}=\mathbf{e}_{i}\cdot\mathbf{a}$
\end_inset

 and 
\begin_inset Formula $a'_{i}=\mathbf{e}'_{i}\cdot\mathbf{a}$
\end_inset

, respectively.
 Using the above relation, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
a'_{i}=\mathbf{e}'_{i}\cdot\mathbf{a}=\mathbf{a}\cdot\mathbf{Q}\cdot\mathbf{e}_{i}=Q_{mi}\mathbf{a}\cdot\mathbf{e}_{m}=Q_{mi}a_{m},
\]

\end_inset

 or 
\begin_inset Formula 
\begin{equation}
\boxed{a'_{i}=Q_{mi}a_{m}}\label{eq22-1}
\end{equation}

\end_inset

 In matrix form, 
\begin_inset Formula 
\[
\left[\begin{array}{c}
a'_{1}\\
a'_{2}\\
a'_{3}
\end{array}\right]_{\mathbf{e'}_{i}}=\left[\begin{array}{ccc}
Q_{11} & Q_{21} & Q_{31}\\
Q_{12} & Q_{22} & Q_{32}\\
Q_{13} & Q_{23} & Q_{33}
\end{array}\right]\left[\begin{array}{c}
a_{1}\\
a_{2}\\
a_{3}
\end{array}\right]_{\mathbf{e}_{i}}
\]

\end_inset

or 
\begin_inset Formula 
\[
\left[\mathbf{a}\right]^{\prime}=\left[\mathbf{Q}\right]^{T}\left[\mathbf{a}\right]\quad\text{or}\quad\left[\mathbf{a}\right]_{\mathbf{e'}_{i}}=\left[\mathbf{Q}\right]^{T}\left[\mathbf{a}\right]_{\mathbf{e}_{i}}
\]

\end_inset

Here 
\begin_inset Formula $\left[\mathbf{a}\right]^{\prime}$
\end_inset

 and 
\begin_inset Formula $\left[\mathbf{a}\right]$
\end_inset

 are matrices of the 
\shape italic
same
\shape default
 vector, expressed in two different coordinate systems.
 This is 
\shape italic
not the same
\shape default
 as 
\begin_inset Formula $\mathbf{a}'=\mathbf{Q}^{T}\cdot\mathbf{a}$
\end_inset

, where 
\begin_inset Formula $\mathbf{a}'$
\end_inset

 is the linear transformation of 
\begin_inset Formula $\mathbf{a}$
\end_inset

 by 
\begin_inset Formula $\mathbf{Q}^{T}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Now consider a tensors 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
 Its components with respect to 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}'_{1},\mathbf{e}'_{2},\mathbf{e}'_{3}\right\} $
\end_inset

 are given by 
\begin_inset Formula $T_{ij}=\mathbf{e}_{i}\cdot\mathbf{T}\cdot\mathbf{e}_{j}$
\end_inset

 and 
\begin_inset Formula $T'_{ij}=\mathbf{e}'_{i}\cdot\mathbf{T}\cdot\mathbf{e}'_{j}$
\end_inset

, respectively.
 Thus, 
\begin_inset Formula $T'_{ij}=\left(\mathbf{Q}\cdot\mathbf{e}_{i}\right)\cdot\mathbf{T}\cdot\left(\mathbf{Q}\cdot\mathbf{e}_{j}\right)=Q_{mi}\mathbf{e}_{m}\cdot\mathbf{T}\cdot Q_{nj}\mathbf{e}_{n}=Q_{mi}Q_{nj}\mathbf{e}_{m}\cdot\mathbf{T}\cdot\mathbf{e}_{n}=Q_{mi}Q_{nj}T_{mn}$
\end_inset

, or 
\begin_inset Formula 
\begin{equation}
\boxed{T'_{ij}=Q_{mi}Q_{nj}T_{mn}}\label{eq23-1}
\end{equation}

\end_inset

 In matrix form, 
\begin_inset Formula $\left[\mathbf{T}\right]^{\prime}=\left[\mathbf{Q}\right]^{T}\left[\mathbf{T}\right]\left[\mathbf{Q}\right]$
\end_inset

, or 
\begin_inset Formula 
\[
\left[\begin{array}{ccc}
T'_{11} & T'_{12} & T'_{13}\\
T'_{21} & T'_{22} & T'_{23}\\
T'_{31} & T'_{32} & T'_{33}
\end{array}\right]=\left[\begin{array}{ccc}
Q_{11} & Q_{21} & Q_{31}\\
Q_{12} & Q_{22} & Q_{32}\\
Q_{13} & Q_{23} & Q_{33}
\end{array}\right]\left[\begin{array}{ccc}
T_{11} & T_{12} & T_{13}\\
T_{21} & T_{22} & T_{23}\\
T_{31} & T_{32} & T_{33}
\end{array}\right]\left[\begin{array}{ccc}
Q_{11} & Q_{12} & Q_{13}\\
Q_{21} & Q_{22} & Q_{23}\\
Q_{31} & Q_{32} & Q_{33}
\end{array}\right]
\]

\end_inset

 Equivalently, we can show that 
\begin_inset Formula 
\begin{equation}
\boxed{T_{ij}=Q_{im}Q_{jn}T'_{mn}}\label{eq24-1}
\end{equation}

\end_inset

 or 
\begin_inset Formula $\left[\mathbf{T}\right]=\left[\mathbf{Q}\right]\left[\mathbf{T}\right]^{\prime}\left[\mathbf{Q}\right]^{T}$
\end_inset

.
 As for vectors, we note that 
\begin_inset Formula $\left[\mathbf{T}\right]$
\end_inset

 and 
\begin_inset Formula $\left[\mathbf{T}\right]^{\prime}$
\end_inset

 are the matrices of the 
\shape italic
same
\shape default
 tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

, with respect to two different coordinate systems.
 This is 
\shape italic
not the same
\shape default
 as 
\begin_inset Formula $\mathbf{T}'=\mathbf{Q}^{T}\cdot\mathbf{T}\cdot\mathbf{Q}$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Symmetric and Antisymmetric Tensors
\begin_inset CommandInset label
LatexCommand label
name "subsubsec:symmetric"

\end_inset


\end_layout

\begin_layout Standard
A 
\shape italic
symmetric
\shape default
 tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 satisfies 
\begin_inset Formula $\mathbf{T}^{T}=\mathbf{T}$
\end_inset

, i.e., 
\begin_inset Formula $T_{ji}=T_{ij}$
\end_inset

, or in matrix form, 
\begin_inset Formula 
\[
\left[\mathbf{T}\right]=\left[\begin{array}{ccc}
T_{11} & T_{12} & T_{13}\\
T_{12} & T_{22} & T_{23}\\
T_{13} & T_{23} & T_{33}
\end{array}\right]
\]

\end_inset

 An 
\shape italic
antisymmetric
\shape default
 (or 
\shape italic
skew-symmetric
\shape default
) tensor 
\begin_inset Formula $\boldsymbol{\Omega}$
\end_inset

 satisfies 
\begin_inset Formula $\boldsymbol{\Omega}^{T}=-\boldsymbol{\Omega}$
\end_inset

, i.e., 
\begin_inset Formula $\Omega_{ji}=-\Omega_{ij}$
\end_inset

 and thus 
\begin_inset Formula $\Omega_{11}=\Omega_{22}=\Omega_{33}=0$
\end_inset

, 
\begin_inset Formula 
\[
\left[\boldsymbol{\Omega}\right]=\left[\begin{array}{ccc}
0 & \Omega_{12} & -\Omega_{31}\\
-\Omega_{12} & 0 & \Omega_{23}\\
\Omega_{31} & -\Omega_{23} & 0
\end{array}\right]
\]

\end_inset

Any tensor can be written as the sum of a symmetric and antisymmetric tensor,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{T}=\mathbf{T}^{S}+\mathbf{T}^{A}\quad\text{where}\quad\mathbf{T}^{S}=\frac{1}{2}\left(\mathbf{T}+\mathbf{T}^{T}\right)\quad\text{and}\quad\mathbf{T}^{A}=\frac{1}{2}\left(\mathbf{T}-\mathbf{T}^{T}\right)
\]

\end_inset

This is a unique decomposition.
 It can be checked that 
\begin_inset Formula $\mathbf{T}^{S}$
\end_inset

 is symmetric and 
\begin_inset Formula $\mathbf{T}^{A}$
\end_inset

 is antisymmetric.
 
\end_layout

\begin_layout Standard
The 
\shape italic
dual vector
\shape default
 
\begin_inset Formula $\boldsymbol{\omega}$
\end_inset

 of an antisymmetric tensor 
\begin_inset Formula $\boldsymbol{\Omega}$
\end_inset

 satisfies 
\begin_inset Formula 
\begin{equation}
\boxed{\boldsymbol{\Omega}\cdot\mathbf{a}=\boldsymbol{\omega}\times\mathbf{a}}\label{eq25-1}
\end{equation}

\end_inset

 for any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

.
 Thus 
\begin_inset Formula $\Omega_{ij}=\mathbf{e}_{i}\cdot\boldsymbol{\Omega}\cdot\mathbf{e}_{j}=\mathbf{e}_{i}\cdot\left(\boldsymbol{\omega}\times\mathbf{e}_{j}\right)=\omega_{k}\mathbf{e}_{i}\cdot\left(\mathbf{e}_{k}\times\mathbf{e}_{j}\right)=\omega_{k}\mathbf{e}_{i}\cdot\varepsilon_{kjl}\mathbf{e}_{l}=\omega_{k}\varepsilon_{kjl}\delta_{il}$
\end_inset

 or 
\begin_inset Formula 
\begin{equation}
\boxed{\Omega_{ij}=-\varepsilon_{ijk}\omega_{k}}\label{eq26-1}
\end{equation}

\end_inset

In matrix form, 
\begin_inset Formula 
\[
\left[\boldsymbol{\Omega}\right]=\left[\begin{array}{ccc}
0 & -\omega_{3} & \omega_{2}\\
\omega_{3} & 0 & -\omega_{1}\\
-\omega_{2} & \omega_{1} & 0
\end{array}\right]
\]

\end_inset

Conversely, it can also be shown that 
\begin_inset Formula 
\begin{equation}
\boxed{\omega_{i}=-\frac{1}{2}\varepsilon_{ijk}\Omega_{jk}}\label{eq27-1}
\end{equation}

\end_inset

As a homework problem, it may be shown that 
\begin_inset Formula $\varepsilon_{ijk}T_{jk}=\varepsilon_{ijk}T_{jk}^{A}$
\end_inset

, since 
\begin_inset Formula $\varepsilon_{ijk}T_{jk}^{S}=0$
\end_inset

 for any symmetric tensor 
\begin_inset Formula $\mathbf{T}^{S}$
\end_inset

.
\end_layout

\begin_layout Subsection
Eigenvalues and Eigenvectors of Real Symmetric Tensors
\end_layout

\begin_layout Standard
A second-order tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 has three pairs of eigenvalues 
\begin_inset Formula $\lambda$
\end_inset

 and eigenvectors 
\begin_inset Formula $\mathbf{v}$
\end_inset

 that each satisfy
\begin_inset Formula 
\begin{equation}
\mathbf{T}\cdot\mathbf{v}=\lambda\mathbf{v}\label{eq:eigen-def}
\end{equation}

\end_inset

The eigenvalues 
\begin_inset Formula $\lambda$
\end_inset

 are the roots of the characteristic equation of 
\begin_inset Formula $\mathbf{T}$
\end_inset

, which is the cubic polynomial produced by setting 
\begin_inset Formula $\det\left(\mathbf{T}-\lambda\mathbf{I}\right)=0$
\end_inset

,
\begin_inset Formula 
\begin{equation}
-\lambda^{3}+I_{1}\lambda^{2}-I_{2}\lambda+I_{3}=0\label{eq:eigen-char-eqn}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\begin{aligned}I_{1} & =\tr\mathbf{T}\\
I_{2} & =\frac{1}{2}\left(I_{1}^{2}-\tr\mathbf{T}^{2}\right)\\
I_{3} & =\det\mathbf{T}
\end{aligned}
\label{eq:eigen-invariants}
\end{equation}

\end_inset

are called 
\emph on
invariants
\emph default
 of 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
\end_layout

\begin_layout Standard
According to the Cayley-Hamilton theorem, a tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 satisfies its own characteristic equation,
\begin_inset Formula 
\begin{equation}
-\mathbf{T}^{3}+I_{1}\mathbf{T}^{2}-I_{2}\mathbf{T}+I_{3}\mathbf{I}=\mathbf{0}\label{eq:Cayley-Hamilton-theorem}
\end{equation}

\end_inset

Therefore, the cubic power of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 can be expressed in terms of its lower powers according to 
\begin_inset Formula $\mathbf{T}^{3}=I_{1}\mathbf{T}^{2}-I_{2}\mathbf{T}+I_{3}\mathbf{I}$
\end_inset

.
 Taking the trace of this equation allows us to solve for 
\begin_inset Formula $I_{3}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\begin{aligned}I_{3} & =\frac{1}{3}\left(\tr\mathbf{T}^{3}-I_{1}\tr\mathbf{T}^{2}+I_{2}\tr\mathbf{T}\right)\\
 & =\frac{1}{3}\left(\tr\mathbf{T}^{3}-I_{1}^{3}+3I_{1}I_{2}\right)
\end{aligned}
\label{eq:eigen-I3-soln}
\end{equation}

\end_inset

Multiplying eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Cayley-Hamilton-theorem"
plural "false"
caps "false"
noprefix "false"

\end_inset

 by 
\begin_inset Formula $\mathbf{T}^{-1}$
\end_inset

 also produces 
\begin_inset Formula 
\[
I_{3}\mathbf{T}^{-1}=\mathbf{T}^{2}-I_{1}\mathbf{T}+I_{2}\mathbf{I}
\]

\end_inset

Using all these relations, we may differentiate the three invariants of
 
\begin_inset Formula $\mathbf{T}$
\end_inset

 with respect to 
\begin_inset Formula $\mathbf{T}$
\end_inset

 to get
\begin_inset Formula 
\begin{equation}
\begin{aligned}\frac{\partial I_{1}}{\partial\mathbf{T}} & =\mathbf{I}\\
\frac{\partial I_{2}}{\partial\mathbf{T}} & =I_{1}\mathbf{I}-\mathbf{T}^{T}\\
\frac{\partial I_{3}}{\partial\mathbf{T}} & =I_{3}\mathbf{T}^{-T}
\end{aligned}
\label{eq:eigen-dinv-dT}
\end{equation}

\end_inset


\end_layout

\begin_layout Theorem*
The eigenvalues of real symmetric tensors are real (proof not provided here).
 
\end_layout

\begin_deeper
\begin_layout Theorem*
If the eigenvalues of a real symmetric tensor are all distinct, the eigenvectors
 are orthogonal to each other.
 
\end_layout

\end_deeper
\begin_layout Standard

\shape italic
Proof:
\shape default
 Given 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{v}_{1}=\lambda_{1}\mathbf{v}_{1}$
\end_inset

, 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{v}_{2}=\lambda_{2}\mathbf{v}_{2}$
\end_inset

, 
\begin_inset Formula $\lambda_{1}\ne\lambda_{2}$
\end_inset

 , then 
\begin_inset Formula $\mathbf{v}_{2}\cdot\mathbf{T}\cdot\mathbf{v}_{1}=\lambda_{1}\mathbf{v}_{1}\cdot\mathbf{v}_{2}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}_{1}\cdot\mathbf{T}\cdot\mathbf{v}_{2}=\lambda_{2}\mathbf{v}_{1}\cdot\mathbf{v}_{2}=\mathbf{v}_{2}\cdot\mathbf{T}^{T}\cdot\mathbf{v}_{1}=\mathbf{v}_{2}\cdot\mathbf{T}\cdot\mathbf{v}_{1}$
\end_inset

 , 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Rightarrow\lambda_{1}\mathbf{v}_{1}\cdot\mathbf{v}_{2}=\lambda_{2}\mathbf{v}_{1}\cdot\mathbf{v}_{2}\quad\text{or}\quad\left(\lambda_{1}-\lambda_{2}\right)\mathbf{v}_{1}\cdot\mathbf{v}_{2}=0\quad\Rightarrow\mathbf{v}_{1}\cdot\mathbf{v}_{2}=0
\]

\end_inset


\end_layout

\begin_layout Standard
When two of the eigenvalues are repeated (a double root of the characteristic
 equation), the resulting eigenvectors are not necessarily orthogonal to
 each other; however, they remain orthogonal to the third eigenvector.
 This means that any vector lying in the plane normal to the third eigenvector
 is an eigenvector corresponding to the double root.
 Similarly, when all three eigenvalues are repeated (a triple root), any
 vector becomes an eigenvector of 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
 
\end_layout

\begin_layout Example
In hydrostatics the stress tensor is 
\begin_inset Formula $\mathbf{T}=-p\mathbf{I}$
\end_inset

, where 
\begin_inset Formula $p$
\end_inset

 is the hydrostatic pressure.
 In this case, 
\begin_inset Formula $-p$
\end_inset

 is a triple root of the characteristic equation of 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
 Any vector 
\begin_inset Formula $\mathbf{v}$
\end_inset

 satisfies 
\begin_inset Formula $\mathbf{T}\cdot\mathbf{v}=-p\mathbf{v}$
\end_inset

, and is thus an eigenvector of 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
\end_layout

\begin_layout Standard
In continuum mechanics the eigenvectors 
\begin_inset Formula $\mathbf{v}$
\end_inset

 of a tensor are generally normalized,
\begin_inset Formula 
\[
\mathbf{n}\equiv\frac{\mathbf{v}}{\left|\mathbf{v}\right|}
\]

\end_inset

Thus, we can always find a set of three orthonormal eigenvectors 
\begin_inset Formula $\left\{ \mathbf{n}_{1},\mathbf{n}_{2},\mathbf{n}_{3}\right\} $
\end_inset

 for any real symmetric tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

, even when the eigenvalues are repeated.
 Given a tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 with eigenvalues 
\begin_inset Formula $\lambda_{1},\lambda_{2},\lambda_{3}$
\end_inset

 and eigenvectors 
\begin_inset Formula $\mathbf{n}_{1},\mathbf{n}_{2},\mathbf{n}_{3}$
\end_inset

, the components of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 in the orthonormal basis 
\begin_inset Formula $\left\{ \mathbf{n}_{1},\mathbf{n}_{2},\mathbf{n}_{3}\right\} $
\end_inset

 can be obtained from 
\begin_inset Formula 
\[
T_{i1}=\mathbf{v}_{i}\cdot\mathbf{T}\cdot\mathbf{n}_{1}=\lambda_{1}\mathbf{n}_{i}\cdot\mathbf{n}_{1}=\lambda_{1}\delta_{i1}\quad T_{i2}=\lambda_{2}\delta_{i2}T_{i3}=\lambda_{3}\delta_{i3}
\]

\end_inset

 Thus, 
\begin_inset Formula 
\[
\left[\mathbf{T}\right]_{\mathbf{n}_{i}}=\left[\begin{array}{ccc}
\lambda_{1} & 0 & 0\\
0 & \lambda_{2} & 0\\
0 & 0 & \lambda_{3}
\end{array}\right]=\left[\begin{array}{ccc}
T_{1} & 0 & 0\\
0 & T_{2} & 0\\
0 & 0 & T_{3}
\end{array}\right]
\]

\end_inset

 Since 
\begin_inset Formula $\mathbf{T}=T_{ij}\mathbf{n}_{i}\otimes\mathbf{n}_{j}=T_{i1}\mathbf{n}_{i}\otimes\mathbf{n}_{1}+T_{i2}\mathbf{n}_{i}\otimes\mathbf{n}_{2}+T_{i3}\mathbf{n}_{i}\otimes\mathbf{n}_{3}$
\end_inset

, we find that 
\begin_inset Formula 
\begin{equation}
\mathbf{T}=\lambda_{1}\mathbf{n}_{1}\otimes\mathbf{n}_{1}+\lambda_{2}\mathbf{n}_{2}\otimes\mathbf{n}_{2}+\lambda_{3}\mathbf{n}_{3}\otimes\mathbf{n}_{3}\label{eq:eigen-spectral-rep}
\end{equation}

\end_inset

 This is known as the 
\shape italic
spectral representation
\shape default
 of the tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

.
 In particular, since the eigenvalues of the identity tensor are 
\begin_inset Formula $\lambda_{1}=\lambda_{2}=\lambda_{3}=1$
\end_inset

, and since any vector is an eigenvector of 
\begin_inset Formula $\mathbf{I}$
\end_inset

, we can select the basis vectors 
\begin_inset Formula $\mathbf{e}_{1},\,\mathbf{e}_{2},\,\mathbf{e}_{3}$
\end_inset

 so that the spectral representation of 
\begin_inset Formula $\mathbf{I}$
\end_inset

 may be given by
\begin_inset Formula 
\begin{equation}
\mathbf{I}=\mathbf{e}_{i}\otimes\mathbf{e}_{i}=\mathbf{e}_{1}\otimes\mathbf{e}_{1}+\mathbf{e}_{2}\otimes\mathbf{e}_{2}+\mathbf{e}_{3}\otimes\mathbf{e}_{3}\label{eq:eigen-identity-spectral}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Orthogonal Transformation of Tensors
\end_layout

\begin_layout Standard
An orthogonal transformation 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 transforms any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

 into the vector 
\begin_inset Formula $\mathbf{Q}\cdot\mathbf{a}$
\end_inset

, which we may denote as
\begin_inset Formula 
\begin{equation}
\mathbf{a}^{*}=\mathbf{Q}\cdot\mathbf{a}\label{eq:OT-vector}
\end{equation}

\end_inset

Recall that a tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 may be expressed in its spectral representation as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:eigen-spectral-rep"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Each of its eigenvectors 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is transformed by 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 into 
\begin_inset Formula $\mathbf{n}^{*}=\mathbf{Q}\cdot\mathbf{n}$
\end_inset

.
 Since eigenvalues of 
\begin_inset Formula $\mathbf{T}$
\end_inset

 are invariant to orthogonal transformations, it follows that
\begin_inset Formula 
\[
\begin{aligned}\mathbf{T}^{*} & =\lambda_{1}\mathbf{n}_{1}^{*}\otimes\mathbf{n}_{1}^{*}+\lambda_{2}\mathbf{n}_{2}^{*}\otimes\mathbf{n}_{2}^{*}+\lambda_{3}\mathbf{n}_{3}^{*}\otimes\mathbf{n}_{3}^{*}\\
 & =\lambda_{1}\left(\mathbf{Q}\cdot\mathbf{n}_{1}\right)\otimes\left(\mathbf{Q}\cdot\mathbf{n}_{1}\right)+\lambda_{2}\left(\mathbf{Q}\cdot\mathbf{n}_{2}\right)\otimes\left(\mathbf{Q}\cdot\mathbf{n}_{2}\right)+\lambda_{3}\left(\mathbf{Q}\cdot\mathbf{n}_{3}\right)\otimes\left(\mathbf{Q}\cdot\mathbf{n}_{3}\right)\\
 & =\mathbf{Q}\cdot\left(\lambda_{1}\mathbf{n}_{1}\otimes\mathbf{n}_{1}+\lambda_{2}\mathbf{n}_{2}\otimes\mathbf{n}_{2}+\lambda_{3}\mathbf{n}_{3}\otimes\mathbf{n}_{3}\right)\cdot\mathbf{Q}^{T}\\
 & =\mathbf{Q}\cdot\mathbf{T}\cdot\mathbf{Q}^{T}
\end{aligned}
\]

\end_inset

Thus, the transformation of the second-order tensor 
\begin_inset Formula $\mathbf{T}$
\end_inset

 by 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is 
\begin_inset Formula $\mathbf{T}^{*}=\mathbf{Q}\cdot\mathbf{T}\cdot\mathbf{Q}^{T}$
\end_inset

.
\end_layout

\begin_layout Section
Higher Order Tensors
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\mathbf{a}\cdot\mathbf{T}\cdot\mathbf{b}=\mathbf{a}\otimes\mathbf{b}:\mathbf{T}=\mathbf{T}:\mathbf{a}\otimes\mathbf{b}$
\end_inset

, and 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}:\mathbf{c}\otimes\mathbf{d}=\left(\mathbf{a}\cdot\mathbf{c}\right)\left(\mathbf{b}\cdot\mathbf{d}\right)$
\end_inset

.
 Similarly, 
\begin_inset Formula $\left(\mathbf{a}\otimes\mathbf{b}\right)\cdot\left(\mathbf{c}\otimes\mathbf{d}\right)=\left(\mathbf{b}\cdot\mathbf{c}\right)\mathbf{a}\otimes\mathbf{d}$
\end_inset

.
 We will be using generalizations of these relations when examining higher
 order tensors.
\end_layout

\begin_layout Subsection
Third-Order Tensors
\end_layout

\begin_layout Standard
A third-order tensor 
\begin_inset Formula $\mathbb{T}$
\end_inset

 is a linear transformation that transforms any vector 
\begin_inset Formula $\mathbf{a}$
\end_inset

 into a second-order tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset

, 
\begin_inset Formula 
\begin{equation}
\boxed{\mathbb{T}\cdot\mathbf{a}=\mathbf{S}}\label{eq62-1}
\end{equation}

\end_inset

In general, the dyadic product of three vectors is a third-order tensor
 which satisfies
\begin_inset Formula 
\begin{equation}
\boxed{\left(\mathbf{a}\otimes\mathbf{b}\otimes\mathbf{c}\right)\cdot\left(\alpha\mathbf{u}+\beta\mathbf{v}\right)=\left(\alpha\mathbf{c}\cdot\mathbf{u}+\beta\mathbf{c}\cdot\mathbf{v}\right)\left(\mathbf{a}\otimes\mathbf{b}\right)}\quad\forall\,\mathbf{u},\mathbf{v}\,.\label{eq62b}
\end{equation}

\end_inset

Any third-order tensor 
\begin_inset Formula $\mathbb{T}$
\end_inset

 can be expressed in terms of its Cartesian components 
\begin_inset Formula $T_{ijk}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\boxed{\mathbb{T}=T_{ijk}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}}\label{eq62d}
\end{equation}

\end_inset

and the Cartesian components of a third-order tensor may be evaluated from
\begin_inset Formula 
\begin{equation}
\boxed{T_{ijk}=\mathbf{e}_{i}\cdot\left(\mathbb{T}\cdot\mathbf{e}_{k}\right)\cdot\mathbf{e}_{j}}\label{eq62c}
\end{equation}

\end_inset

It follows from Eqs.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq62b"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq62d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that
\begin_inset Formula 
\[
\mathbb{T}\cdot\mathbf{a}=T_{ijk}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}\right)\cdot\mathbf{a}=T_{ijk}\left(\mathbf{e}_{k}\cdot\mathbf{a}\right)\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)=T_{ijk}a_{k}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)=\mathbf{S}=S_{ij}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)
\]

\end_inset

so that the indicial form of eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq62-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is
\begin_inset Formula 
\begin{equation}
T_{ijk}a_{k}=S_{ij}\label{eq62e}
\end{equation}

\end_inset

In particular,
\begin_inset Formula 
\begin{equation}
\mathbb{T}\cdot\mathbf{e}_{k}=T_{ijk}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\label{eq62f}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The double dot product of a third-order tensor with a second-order tensor
 is defined by
\begin_inset Formula 
\[
\boxed{\left(\mathbf{a}\otimes\mathbf{b}\otimes\mathbf{c}\right):\left(\mathbf{d}\otimes\mathbf{e}\right)=\left(\mathbf{b}\cdot\mathbf{d}\right)\left(\mathbf{c}\cdot\mathbf{e}\right)\mathbf{a}}\,,
\]

\end_inset

and
\begin_inset Formula 
\[
\boxed{\left(\mathbf{a}\otimes\mathbf{b}\right):\left(\mathbf{c}\otimes\mathbf{d}\otimes\mathbf{e}\right)=\left(\mathbf{a}\cdot\mathbf{c}\right)\left(\mathbf{b}\cdot\mathbf{d}\right)\mathbf{e}}\,.
\]

\end_inset

Therefore, the double dot product of a third-order tensor with a second-order
 tensor is a vector given by
\begin_inset Formula 
\begin{equation}
\mathbb{T}:\left(\mathbf{a}\otimes\mathbf{b}\right)=\left(\mathbb{T}\cdot\mathbf{b}\right)\cdot\mathbf{a}\,.\label{eq63f}
\end{equation}

\end_inset

Proof: Using 
\begin_inset Formula $\mathbb{T}\cdot\mathbf{b}=T_{ijk}b_{k}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)$
\end_inset

, we find that 
\begin_inset Formula $\left(\mathbb{T}\cdot\mathbf{b}\right)\cdot\mathbf{a}=T_{ijk}b_{k}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right)\cdot\mathbf{a}=T_{ijk}b_{k}\left(\mathbf{a}\cdot\mathbf{e}_{j}\right)\mathbf{e}_{i}=T_{ijk}a_{j}b_{k}\mathbf{e}_{i}$
\end_inset

.
 Similarly, 
\begin_inset Formula $\mathbb{T}:\left(\mathbf{a}\otimes\mathbf{b}\right)=T_{ijk}\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}\right):\left(\mathbf{a}\otimes\mathbf{b}\right)=T_{ijk}\left(\mathbf{e}_{j}\cdot\mathbf{a}\right)\left(\mathbf{e}_{k}\cdot\mathbf{b}\right)\mathbf{e}_{i}=T_{ijk}a_{j}b_{k}\mathbf{e}_{i}$
\end_inset

, thus completing the proof.
 
\end_layout

\begin_layout Standard
For any second-order tensor 
\begin_inset Formula $\mathbf{S}$
\end_inset

, it also follows that
\begin_inset Formula 
\[
\mathbb{T}:\mathbf{S}=T_{ijk}S_{jk}\mathbf{e}_{i}\,.
\]

\end_inset


\end_layout

\begin_layout Example
If we introduce the notation 
\begin_inset Formula $\mathbb{E}$
\end_inset

 as the third-order (pseudo-)tensor of Cartesian components 
\begin_inset Formula $\varepsilon_{ijk}$
\end_inset

, the relation between an antisymmetric tensor and its dual vector can also
 be written as
\begin_inset Formula 
\begin{equation}
\boxed{\boldsymbol{\Omega}=-\mathbb{E}\cdot\boldsymbol{\omega}}\label{eq26b}
\end{equation}

\end_inset

Similarly,
\begin_inset Formula 
\begin{equation}
\boxed{\boldsymbol{\omega}=-\frac{1}{2}\mathbb{E}:\boldsymbol{\Omega}}\label{eq27b}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Fourth-Order Tensors
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fourth-Order-Tensors"

\end_inset


\end_layout

\begin_layout Standard
The dyadic product of four vectors is a fourth-order tensor 
\begin_inset Formula $\mathbf{a}\otimes\mathbf{b}\otimes\mathbf{c}\otimes\mathbf{d}$
\end_inset

, defined as
\begin_inset Formula 
\begin{equation}
\left(\mathbf{a}\otimes\mathbf{b}\otimes\mathbf{c}\otimes\mathbf{d}\right)\cdot\mathbf{v}=\left(\mathbf{d}\cdot\mathbf{v}\right)\left(\mathbf{a}\otimes\mathbf{b}\otimes\mathbf{c}\right)\label{eq:63g}
\end{equation}

\end_inset

The Cartesian components of a fourth-order tensor 
\begin_inset Formula $\mathcal{T}$
\end_inset

 are given by
\begin_inset Formula 
\begin{equation}
T_{ijkl}=\left(\mathbf{e}_{i}\otimes\mathbf{e}_{j}\right):\mathcal{T}:\left(\mathbf{e}_{k}\otimes\mathbf{e}_{l}\right)\label{eq:63h}
\end{equation}

\end_inset

such that
\begin_inset Formula 
\begin{equation}
\mathcal{T}=T_{ijkl}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}\otimes\mathbf{e}_{l}\label{eq:63i}
\end{equation}

\end_inset

Therefore, a fourth-order tensor transforms a vector into a third-order
 tensor,
\begin_inset Formula 
\begin{equation}
\mathcal{T}\cdot\mathbf{a}=\left(T_{ijkl}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}\otimes\mathbf{e}_{l}\right)\cdot\mathbf{a}=T_{ijkl}a_{l}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}\equiv S_{ijk}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\otimes\mathbf{e}_{k}=\mathbb{S}\label{eq:63j}
\end{equation}

\end_inset

The double dot product of a fourth-order tensor with a second-order tensor
 is a second-order tensor defined as
\begin_inset Formula 
\begin{equation}
\boxed{\mathcal{T}:\left(\mathbf{a}\otimes\mathbf{b}\right)=\left(\mathcal{T}\cdot\mathbf{b}\right)\cdot\mathbf{a}}\label{eq:63k}
\end{equation}

\end_inset

from which it can be shown that
\begin_inset Formula 
\begin{equation}
\mathcal{T}:\mathbf{S}=T_{ijmn}S_{mn}\mathbf{e}_{i}\otimes\mathbf{e}_{j}\label{eq:63l}
\end{equation}

\end_inset

or equivalently, 
\begin_inset Formula $\left(\mathcal{T}:\mathbf{S}\right)_{ij}=T_{ijkl}S_{kl}$
\end_inset

.
\end_layout

\begin_layout Standard
A fourth-order tensor can exhibit three levels of symmetry, which can be
 represented using Cartesian components as
\begin_inset Formula 
\begin{equation}
\begin{aligned}T_{ijkl} & =T_{jikl} & \text{left minor symmetry}\\
T_{ijkl} & =T_{ijlk} & \text{right minor symmetry}\\
T_{ijkl} & =T_{klij} & \text{major symmetry}
\end{aligned}
\label{eq:tens4-symmetries}
\end{equation}

\end_inset

Whereas a general fourth-order tensor may have 81 distinct components, a
 tensor with one minor symmetry has 54 distinct components; a tensor with
 both minor symmetries has 36 distinct components; and a tensor with minor
 and major symmetries has 21distinct components.
 We may represent the major symmetry of 
\begin_inset Formula $\mathcal{T}$
\end_inset

 as 
\begin_inset Formula $\mathcal{T}=\mathcal{T}^{T}$
\end_inset

, whose Cartesian representation is provided above.
 It follows from this definition that
\begin_inset Formula 
\[
\begin{aligned}\mathbf{S}:\mathcal{T} & =\mathcal{T}^{T}:\mathbf{S}\\
\left(\mathbf{S}:\mathcal{T}\right)_{ij} & =S_{kl}T_{klij}=T_{ijkl}^{T}S_{kl}
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Subsection
Additional Tensor Products
\end_layout

\begin_layout Standard
Earlier we saw that the dyadic product of vectors can produce tensors.
 Similarly, we can define dyadic products of tensors which produce higher-order
 tensors.
 In particular, the following products of second-order tensors 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{B}$
\end_inset

 produce fouth-order tensors, satisfying
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left(\mathbf{A}\otimes\mathbf{B}\right):\mathbf{S} & =\left(\mathbf{B}:\mathbf{S}\right)\mathbf{A}\\
\left(\mathbf{A}\oslash\mathbf{B}\right):\mathbf{S} & =\mathbf{A}\cdot\mathbf{S}\cdot\mathbf{B}^{T}\\
\left(\mathbf{A}\obslash\mathbf{B}\right):\mathbf{S} & =\mathbf{A}\cdot\mathbf{S}^{T}\cdot\mathbf{B}^{T}\\
\left(\mathbf{A}\odot\mathbf{B}\right):\mathbf{S} & =\frac{1}{2}\left(\mathbf{A}\oslash\mathbf{B}+\mathbf{A}\obslash\mathbf{B}\right):\mathbf{S}=\frac{1}{2}\left(\mathbf{A}\cdot\mathbf{S}\cdot\mathbf{B}^{T}+\mathbf{A}\cdot\mathbf{S}^{T}\cdot\mathbf{B}^{T}\right)
\end{aligned}
\label{eq:tensor-products}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is any second-order tensor.
 Using Cartesian components of tensors, the indicial form of these tensor
 products are
\begin_inset Formula 
\begin{equation}
\begin{aligned}\left(\mathbf{A}\otimes\mathbf{B}\right)_{ijkl} & =A_{ij}B_{kl}\\
\left(\mathbf{A}\oslash\mathbf{B}\right)_{ijkl} & =A_{ik}B_{jl}\\
\left(\mathbf{A}\obslash\mathbf{B}\right)_{ijkl} & =A_{il}B_{jk}\\
\left(\mathbf{A}\odot\mathbf{B}\right)_{ijkl} & =\frac{1}{2}\left(A_{ik}B_{jl}+A_{il}B_{jk}\right)
\end{aligned}
\label{eq:tensor-products-Cartesian}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "FEBio3"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
