#LyX 2.4 created this file. For more info see https://www.lyx.org/
\lyxformat 620
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass extbook
\begin_preamble
\usepackage{latexsym}
\hypersetup{colorlinks=true,citecolor=blue,filecolor=blue,urlcolor=blue,linkcolor=blue}
\end_preamble
\use_default_options false
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children no
\language english
\language_package none
\inputencoding auto-legacy
\fontencoding auto
\font_roman "default" "default"
\font_sans "helvet" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family sfdefault
\use_non_tex_fonts false
\font_sc false
\font_roman_osf false
\font_sans_osf false
\font_typewriter_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 0
\use_package esint 0
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type numerical
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_formatted_ref 0
\use_minted 0
\use_lineno 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tablestyle default
\tracking_changes false
\output_changes false
\change_bars false
\postpone_fragile_content false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\docbook_table_output 0
\docbook_mathml_prefix 1
\end_header

\begin_body

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Dev}{\operatorname{Dev}}
{\text{Dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\dev}{\operatorname{dev}}
{\text{dev}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\grad}{\operatorname{grad}}
{\text{grad}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\divg}{\operatorname{div}}
{\text{div}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\Ei}{\operatorname{Ei}}
{\text{Ei}}
\end_inset


\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\text{tr}}
\end_inset


\end_layout

\begin_layout Title
\begin_inset Graphics
	filename Figures/FigFEBioTitle.png
	width 4.88in

\end_inset


\series bold

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

User's Manual Version 4.7
\end_layout

\begin_layout Date

\series bold
Last Updated:
 July 20,
 2024
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Paragraph*
Contributors
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Steve Maas (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:steve.maas@utah.edu}{steve.maas@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Jeffrey Weiss (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:jeff.weiss@utah.edu}{jeff.weiss@utah.edu}
\end_layout

\end_inset

)
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Dr.
 Gerard Ateshian (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:ateshian@columbia.edu}{ateshian@columbia.edu}
\end_layout

\end_inset

)
\end_layout

\begin_layout Paragraph*
Contact address
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Musculoskeletal Research Laboratories,
 University of Utah
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

72 S.
 Central Campus Drive,
 Room 2646
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

Salt Lake City,
 Utah
\end_layout

\begin_layout Paragraph*
Website
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Weiss Lab:
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{https://weisslabutah.org}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset

FEBio:
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://febio.org}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Forum
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{https://forums.febio.org/}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Acknowledgments
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Development of the FEBio project is supported in part by a grant from the U.S.
 National Institutes of Health (R01GM083925).
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename Figures/NIHlogo.png
	lyxscale 25
	special height=0.75in

\end_inset


\end_layout

\begin_layout Standard

\series bold
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Introduction
\begin_inset CommandInset label
LatexCommand label
name "chap:introduction"

\end_inset


\end_layout

\begin_layout Section
Overview of FEBio
\begin_inset CommandInset label
LatexCommand label
name "sec:overview"

\end_inset


\end_layout

\begin_layout Standard
FEBio is a nonlinear finite element solver that is specifically designed for biomechanical applications.
 It offers modeling scenarios,
 constitutive models and boundary conditions that are relevant to many research areas in biomechanics,
 thus offering a powerful tool for solving 3D problems in computational biomechanics.
 The software is open-source and the source code,
 as well as pre-compiled executables for Windows,
 OS-X and Linux platforms are available for download at 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://febio.org}
\end_layout

\end_inset

.
 This chapter presents a brief overview of the available features of FEBio.
\end_layout

\begin_layout Standard
FEBio is a multi-physics code and can solve problems in structural mechanics,
 biphasic and multiphasic physics,
 fluid mechanics,
 and fluid-solid interaction (FSI).
 Both (quasi-) static (or steady-state) and dynamic (or transient) analyses can be performed in each of the different physics modules.
 For instance,
 in the structural mechanics module,
 the (quasi-) static response of the system is sought in a quasi-static analysis and the effects of inertia are ignored.
 In a dynamic analysis,
 the inertial effects are included in the governing equations to calculate the time dependent response of the system.
 In the biphasic module,
 a coupled solid-fluid problem is solved.
 In a transient biphasic analysis the time dependent response of both the solid and the fluid phase is determined.
 For the steady-state analysis the final relaxed state is recovered.
 Similarly,
 for multiphasic problems,
 both the time dependent transient response as well as the steady-state response can be determined.
 For fluid analyses,
 dynamic and steady-state responses may be specified.
\end_layout

\begin_layout Standard
Many nonlinear constitutive models are available,
 allowing the user to model the often complicated biological tissue behavior.
 Several isotropic constitutive models are supported such as Neo-Hookean,
 Mooney-Rivlin,
 Ogden,
 Arruda-Boyce and Veronda-Westmann.
 All these models have a nonlinear stress-strain response and are objective for large deformations.
 In addition to the isotropic models there are several transversely isotropic and orthotropic constitutive models available.
 These models exhibit anisotropic behavior in a single or multiple preferred directions and are useful for representing biological tissues such as tendons,
 muscles,
 cartilage and other tissues that contain fibers.
 FEBio also contains a 
\shape italic
rigid body 
\shape default
constitutive model.
 This model can be used to represent materials or structures whose deformation is negligible compared to that of other materials in the overall model.
 Several constitutive models are available for representing the solid phase of biphasic and multiphasic materials,
 which are materials that contain both a solid phase and a fluid phase.
 For incompressible materials FEBio employs special algorithms for enforcing the incompressibility constraint.
 A three-field formulation is used for tri-linear hexahedral and wedge elements.
 This algorithm allows the user to capture the accurate response of highly incompressible materials.
\end_layout

\begin_layout Standard
FEBio can now also solve first-order computational homogenization problems.
 In such problems,
 the response of the macro-model is determined by the averaged local response of a representative volume element (RVE).
 The deformation of the macro-model,
 and more specifically the local deformation gradient,
 is applied to a RVE model which in turns determines the stress (and tangent) of the macro-model.
\end_layout

\begin_layout Standard
FEBio supports a wide range of boundary conditions and loads to model interactions between materials that are relevant to problems in biomechanics.
 Deformable models can be connected to rigid bodies.
 With this feature,
 the user can model prescribed rotations and torques for rigid segments,
 thereby allowing the coupling of rigid body mechanics with deformable continuum mechanics.
 FEBio provides the ability to represent frictionless and frictional contact between rigid and/or deformable materials using sliding interfaces.
 A sliding surface is defined between two surfaces that are allowed to separate and slide across each other but are not allowed to penetrate.
 Variations of the sliding interface,
 such as tied interfaces,
 tied-sliding (tension-compression) and rigid walls,
 are available as well.
 As of version 1.2 it is also possible to model the fluid flow across two contacting biphasic materials.
 Finally,
 the user may specify a body force to model the effects such as,
 gravity,
 base acceleration or centripetal acceleration.
\end_layout

\begin_layout Standard
FEBio has a large library of element formulations.
 These include linear and quadratic tetrahedral,
 hexahedral and pentahedral (wedge) elements.
 FEBio also supports triangular quadrilateral shell elements,
 with linear and quadratic interpolations.
\end_layout

\begin_layout Standard
FEBio is a nonlinear implicit FE solver and does not have mesh generation capabilities.
 The finite element mesh,
 as well as all constitutive parameters and loading is defined in an input file,
 the format of which is described in detail in this document.
 This input file needs to be generated by preprocessing software.
 The preferred preprocessor for FEBio is called 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/febio-studio/}{
\backslash
emph{FEBioStudio}}
\end_layout

\end_inset

.
 FEBioStudio can convert some other formats to the FEBio input specification.
 For instance,
 NIKE3D 
\begin_inset CommandInset citation
LatexCommand citep
key "Maker95"
literal "true"

\end_inset

 and Abaqus input files can be imported in FEBioStudio and can be exported as a FEBio input file.
 
\end_layout

\begin_layout Section
About this document
\begin_inset CommandInset label
LatexCommand label
name "sec:about"

\end_inset


\end_layout

\begin_layout Standard
This document is part of a set of three manuals that accompany FEBio:
 the User's Manual,
 describing how to use FEBio (this manual),
 a 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://help.febio.org/doxygen/html/index.html}{
\backslash
emph{Developer's Manual}}
\end_layout

\end_inset

 for users who wish to modify or add features to the code,
 and a 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

,
 which describes the theory behind the FEBio algorithms.
\begin_inset Foot
status open

\begin_layout Plain Layout
The User and Theory manuals are also available in pdf form,
 but the Developer's manual is only available online.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This document discusses how to use FEBio and describes the input file format in detail.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:running-FEBio"
nolink "false"

\end_inset

 describes how to run FEBio and explains the various command line options.
 It also discusses the different files that are required and created by FEBio.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Free-Format-Input"
nolink "false"

\end_inset

 describes the format of the FEBio input file.
 An XML-based format is used,
 organizing the data in a convenient hierarchical structure.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Materials"
nolink "false"

\end_inset

 gives a detailed overview of the available constitutive models.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Restart-Input-file"
nolink "false"

\end_inset

 discusses the restart capabilities of FEBio.
 The restart feature allows the user to interrupt a run and continue it at a later time,
 optionally making changes to the problem data.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Multi-step-Analysis"
nolink "false"

\end_inset

 describes the multi-step analysis feature,
 which allows the user to split up the entire analysis into several steps.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Parameter-Optimization"
nolink "false"

\end_inset

 explains how to setup and run a parameter optimization problem using FEBio's optimization module.
 Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Troubleshooting"
nolink "false"

\end_inset

 provides helpful information for troubleshooting an FEBio model and offers guidelines that help users avoid common problems.
\end_layout

\begin_layout Section
FEBio Basics
\end_layout

\begin_layout Standard
This section provides a brief overview of how FEBio works.
 For more details regarding the algorithms in FEBio,
 please consult the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
When FEBio starts,
 first it will load the configuration file where it will find instructions on what linear solver to use,
 what plugins to load,
 etc.
 Please see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Configuration-File"
nolink "false"

\end_inset

 for more information regarding the configuration file.
 
\end_layout

\begin_layout Standard
Usually FEBio will read the input file that was specified on the command line next.
 The input file contains all the information that FEBio needs to build the FE Model and solve it.
 At the very least the input file will define the mesh,
 the materials,
 boundary conditions,
 time stepping,
 and analysis parameters.
 This document describes the structure of the FEBio input file in detail.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Free-Format-Input"
nolink "false"

\end_inset

and 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Materials"
nolink "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Next,
 FEBio will start solving the model defined by the input file and proceed as follows:
\end_layout

\begin_layout Enumerate

\series bold
Loop over all analysis steps
\series default
.
 A model can define multiple analysis steps.
 In each step the boundary conditions,
 time stepping,
 and analysis parameters can be modified (e.g.
 a two-step analysis where a model is loaded statically in the first step.
 In the second step the load is released and the dynamic response is sought.)
\end_layout

\begin_layout Enumerate

\series bold
For each analysis step,
 loop over all time steps
\series default
:
 In each analysis step,
 loads are usually applied incrementally for stability reasons over a period of time.
 The time parameter can represent the actual physical time (e.g.
 in dynamic simulations),
 or a pseudo-time (e.g.
 quasi-static loading of an elastic model.).
 For more on time stepping see 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Control-Section"
nolink "false"

\end_inset

.
 
\end_layout

\begin_layout Enumerate

\series bold
Solve each time step
\series default
:
 for each time step FEBio will solve the corresponding finite element equations.
 Usually they are nonlinear and thus are solved with a nonlinear solution strategy.
 In FEBio this is a variation of the Newton method.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Control-Section"
nolink "false"

\end_inset

for more information.
 
\end_layout

\begin_layout Enumerate

\series bold
Check convergence
\series default
:
 Since Newton's method is an iterative method convergence is determined by comparing the norms of the solution and residual to the user-defined values in the input file.
 What norms are used will depend on the physics of the problem,
 as well as on several user control parameters.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Control-Section"
nolink "false"

\end_inset

.
 
\end_layout

\begin_layout Enumerate

\series bold
Augmentation
\series default
:
 In models that define some type of constraint (e.g.
 contact,
 rigid joints,
 etc.),
 FEBio will do an additional calculation after a time step converges,
 called an augmentation.
 This is because FEBio does not calculate the exact Lagrange multiplier that enforce the constraints,
 but instead uses an iterative algorithm (called augmented Lagrangian method) to approximate the Lagrange multipliers.
 During the augmentation,
 FEBio updates the approximate Lagrange multipliers.
 If the updates to the multipliers are small,
 FEBio will terminate the time step,
 otherwise it will restart the time step with the updated multipliers.
 
\end_layout

\begin_layout Standard
See the figure below for an overview of the basic FEBio flow.
 
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename Figures/FEBio flow.png
	scale 50

\end_inset


\end_layout

\begin_layout Section
Units in FEBio
\begin_inset CommandInset label
LatexCommand label
name "sec:units"

\end_inset


\end_layout

\begin_layout Standard
FEBio does not assume a specific unit system.
 It is up to the user to enter numbers that are defined in consistent units.
 For example,
 when entering material parameters in SI units,
 the user must enter all loads,
 contact parameters,
 and other boundary conditions in SI units as well.
 The units of all the parameters are given when they are defined in this manual.
 We use a generic designation of units for all the parameters using the following symbols.
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
Symbol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\emph on
Name
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
SI unit
\series default
\shape default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
L
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Length
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
meter (m)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
M
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kilogram (kg)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
t
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Time
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second (s)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
T
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Temperature
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kelvin (K)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
n
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Amount of substance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mole (mol)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Newton (kg
\begin_inset Formula $\cdot$
\end_inset

m/s
\begin_inset Formula $^{2}$
\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
P
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure,
 stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pascal (Pa=N/m
\begin_inset Formula $^{2}$
\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Electric charge
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coulomb (C=A
\begin_inset Formula $\cdot$
\end_inset

s)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Units are given using the bracket notation.
 For instance,
 the unit for density is [
\series bold
M/L
\series default

\begin_inset Formula $^{3}$
\end_inset

] and the unit for permeability is [
\series bold
L
\series default

\begin_inset Formula $^{4}$
\end_inset


\series bold
/F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t].

\series default
 When using SI units,
 this corresponds to units of kg/m
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

 for density and m
\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/N.s for permeability,
 respectively.
 Unitless parameters are designated by empty brackets (
\series bold
[ ]
\series default
).
 The units for angles are either [
\series bold
deg
\series default
] for degrees or [
\series bold
rad
\series default
] for radians.
\end_layout

\begin_layout Standard
When adopting a consistent set of units,
 first choose a primary set of units,
 and then determine the remaining derived units.
 For example,
 in typical problems in solid mechanics,
 the primary set consists of three units.
 If you choose [
\series bold
M
\series default
]=kg,
 [
\series bold
L
\series default
]=m,
 and [
\series bold
t
\series default
]=s,
 then [
\series bold
F
\series default
]=N and [
\series bold
P
\series default
]=Pa.
 Alternatively,
 if you choose [
\series bold
L
\series default
]=mm,
 [
\series bold
F
\series default
]=N and [
\series bold
T
\series default
]=s as the primary set,
 then [
\series bold
P
\series default
]=MPa (since 1 N/mm
\begin_inset Formula $^{\mathrm{2}}=$
\end_inset

 10
\begin_inset Formula $^{\mathrm{6}}$
\end_inset

N/m
\begin_inset Formula $^{\mathrm{2}}=$
\end_inset

 1 MPa) and [
\series bold
M
\series default
]=tonne (tonne = N 
\begin_inset Formula $\cdot$
\end_inset

s
\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/mm).
 The primary set of units must be independent.
 For instance,
 in the last example,
 you cannot choose [
\series bold
P
\series default
] as a primary unit as it can be expressed in terms of [
\series bold
F
\series default
] and [
\series bold
L
\series default
] (i.e.
 [
\series bold
P
\series default
]=[
\series bold
F/L
\series default

\begin_inset Formula $^{\mathrm{\mathbf{2}}}$
\end_inset

]).
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="16" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Primary Units
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
s
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
length
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
amount of substance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmol
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
charge
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
temperature
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
K
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Derived Units
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/mm
\begin_inset Formula $^{2}$
\end_inset

,
 MPa
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
permeability
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\begin_inset Formula $^{4}$
\end_inset

/N
\begin_inset Formula $\cdot$
\end_inset

s,
 mm
\begin_inset Formula $^{2}$
\end_inset

/Pa
\begin_inset Formula $\cdot$
\end_inset

s
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\begin_inset Formula $^{2}$
\end_inset

/s
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
concentration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmol/mm
\begin_inset Formula $^{3}$
\end_inset

,
 mM
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
charge density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nEq/mm
\begin_inset Formula $^{3}$
\end_inset

,
 mEq/L
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
voltage
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mV
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A/mm
\begin_inset Formula $^{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Chapter
Running FEBio
\begin_inset CommandInset label
LatexCommand label
name "chap:running-FEBio"

\end_inset


\end_layout

\begin_layout Standard
FEBio is a command line application which means it does not have its own Graphical User Interface (GUI) and must be run from a shell or command line.
 FEBio runs on several different computing platforms including Windows,
 Mac OSX,
 and many versions of Linux.
 The command line input and output options are described in this chapter.
\end_layout

\begin_layout Section
Running FEBio on Windows
\begin_inset CommandInset label
LatexCommand label
name "sec:running-FEBio-Windows"

\end_inset


\end_layout

\begin_layout Standard
There are several ways to run FEBio on Windows.
 The easiest way is by simply selecting the FEBio program from the Programs menu or by double-clicking the FEBio icon in the installation folder.
 However,
 this runs FEBio with the installation folder as the working folder,
 and unless the FEBio input files are in this folder,
 you will need to know the relative or absolute path to your input files.
 A more practical approach is to run FEBio from a command prompt.
 Before you can do this,
 you need to know two things:
 how to open a command prompt and how to add the FEBio installation folder to your PATH environment variable so that you can run FEBio from any folder on your system.
\begin_inset Foot
status open

\begin_layout Plain Layout
The current FEBio installers should automatically setup the environment path so that FEBio can be run from anywhere on the file system.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Windows
\begin_inset CommandInset label
LatexCommand label
name "subsec:windows"

\end_inset


\end_layout

\begin_layout Standard
In order to run FEBio from a command prompt,
 the path to the FEBio executable must be set in the PATH environment variable.
 The environment variables,
 including the PATH variable,
 are specified in the Environment Variables dialog box.
 There are a few different ways to get to this dialog box.
 The easiest way is to write 
\begin_inset Quotes eld
\end_inset

environment
\begin_inset Quotes erd
\end_inset

 in the Windows search bar,
 and select the 
\begin_inset Quotes eld
\end_inset

Edit the system's environment variables
\begin_inset Quotes erd
\end_inset

 suggestion.
 This will open the 
\begin_inset Quotes eld
\end_inset

System Properties
\begin_inset Quotes erd
\end_inset

 dialog box.
 On the Advanced tab,
 click the Environment variables button.
 This will open the Environment Variables dialog box.
 Find the 
\shape italic
path
\shape default
 variable and click the 
\shape italic
Edit
\shape default
 button.
 On older versions of Windows a semicolon delimited text string appears.
 At the end of that string (don't delete the current value) type a semi-colon and then the absolute path to the FEBio installation folder (e.g.
 C:/Program Files/FEBio/bin/).
 On Windows 10 or newer,
 the values are displayed in a list.
 Either click New or double-click on the first empty slot in the list and type the path the febio executable.
 Then click the 
\shape italic
OK
\shape default
-button on all open dialog boxes.
\end_layout

\begin_layout Standard
To open a command prompt,
 type 
\emph on
cmd
\emph default
 in the Windows search and press Enter.
 A command prompt window should appear.
 You can now use the 
\shape italic
cd 
\shape default
(change directory) command to navigate to the folder that contains the FEBio input files.
 To run FEBio,
 simply type 
\shape italic
febio4 
\shape default
(with or without additional arguments) and press 
\shape italic
Enter
\shape default
.
 Note that if you already had a command prompt open when changing the PATH environment variable,
 you'll nee to close this window and reopen it after the changes to the environment variables are applied.
  
\end_layout

\begin_layout Subsection
Running FEBio from Explorer
\begin_inset CommandInset label
LatexCommand label
name "subsec:running-Explorer"

\end_inset


\end_layout

\begin_layout Standard
A third method of running FEBio,
 which often is very convenient,
 is to run FEBio from Windows Explorer.
 To do this,
 first open Explorer and browse to the folder that contains your FEBio input files.
 Next,
 right-click on the input file and select 
\shape italic
Open With
\shape default
.
 Now select 
\shape italic
Choose default program
\shape default
.
 A dialog box appears with a list of programs to open the input file.
 If FEBio is not on this list yet,
 click the 
\shape italic
Browse
\shape default
 button.
 Locate the FEBio executable (e.g.
 in C:/Program Files/FEBio2/bin),
 select it and press the 
\shape italic
Open
\shape default
 button.
 Now select FEBio in the 
\shape italic
Open With
\shape default
 dialog box and press Ok.
\end_layout

\begin_layout Standard
After you have done this once,
 the process simplifies.
 After you right-click the input file,
 FEBio should now show up in the 
\shape italic
Open With 
\shape default
menu item and can be selected immediately without having to go through all the previous steps.
\end_layout

\begin_layout Section
Running FEBio on Linux or MAC
\begin_inset CommandInset label
LatexCommand label
name "sec:Running-Linux-MAC"

\end_inset


\end_layout

\begin_layout Standard
Running FEBio on Linux or Mac is as easy as opening up a shell window and typing FEBio on the command line.
 However,
 you may need to define an alias to the folder that contains the FEBio executable if you want to run FEBio from any folder on your system.
 Since this depends on your shell,
 you need to consult your Linux documentation on how to do this.
 E.g.
 if you are using c-shell,
 you can define an alias as follows:
\end_layout

\begin_layout LyX-Code
alias febio '/path/to/febio/executable/'
\end_layout

\begin_layout Standard
If you don't want to define this alias every time you open a shell window,
 you can place it in your shell start up file (e.g.
 
\shape italic
.cshrc
\shape default
 for c-shell).
\end_layout

\begin_layout Section
The Command Line
\begin_inset CommandInset label
LatexCommand label
name "sec:Command-Line"

\end_inset


\end_layout

\begin_layout Standard
FEBio is started from a shell window (or the 
\shape italic
command prompt
\shape default
 in Windows).
 The command line is the same for all platforms:
\end_layout

\begin_layout LyX-Code
febio4 [-o1 [arg1] | -o2 [arg2] | ...
 ]
\end_layout

\begin_layout Standard
Where -o1,
 -o2 are options and 
\shape italic
arg1
\shape default
,
 
\shape italic
arg2
\shape default
,
 ...
 are additional arguments.
 The different options (of which most are optional) are given by the following list:
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="18" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
command line option
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
argument
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-i
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the FEBio input file.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
feb file name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-r
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the FEBio restart file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
restart file or dump file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-g,-g1,-g2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Debug flags
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-p
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify name of the FEBio plot file.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot file name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-o
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the name of the FEBio log file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log file name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-s
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the optimization input file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optimization input file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-d
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Run an FEBio diagnostic
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diagnostic input file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-break
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set a breakpoint where FEBio will pause the run.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
breakpoint
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-dump[=
\emph on
n
\emph default
]
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activate restart option and (optionally) set dump file name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dump file name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-dump_stride[=n]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the dump interval.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-config
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the FEBio configuration file to use.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
configuration file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-noconfig
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't read configuration file.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-nosplash
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't print the splash window to the screen on startup.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-import
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Import a plugin file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plugin file name
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-silent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Run FEBio in silent mode,
 which suppresses screen output.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-task[=
\emph on
name
\emph default
]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Run an FEBio task
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
task input file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-info
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print febio version information to screen or file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(optional) output file name
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
List of command line options.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
A more detailed description of these options follows.
\end_layout

\begin_layout Description

\series bold
-i
\series default
 The -i option is used to specify the name of the input file.
 The input file is expected to follow the format specifications as described in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Free-Format-Input"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 
\series bold
-i input.feb
\end_layout

\begin_layout Standard
This is the most common way to start an FEBio run.
 However,
 FEBio allows the omission of the -i when only a filename is given.
\end_layout

\begin_layout LyX-Code
> febio4 input.feb
\end_layout

\begin_layout Standard
On Windows,
 this allows for starting FEBio by double-clicking on an input file (assuming you have chosen FEBio as the default program to open .feb files).
 Note that if additional options are specified on the command line the -i must be present.
\end_layout

\begin_layout Standard
It is also allowed to omit the .feb extension for FEBio input files.
 If no extension is given,
 FEBio will assume that .feb is the file extension.
 Thus,
 the following command will run the file input.feb:
\end_layout

\begin_layout LyX-Code
> febio4 input
\end_layout

\begin_layout Description

\series bold
-r
\series default
 The -r option allows you to restart a previous analysis.
 The filename that must follow this option is an FEBio 
\shape italic
restart input file 
\shape default
or a 
\shape italic
dump file
\shape default
.
 The restart input file and dump file are described in more detail in 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Restarting-a-Run"
nolink "false"

\end_inset

.
 The -i and -r options are mutually exclusive;
 only one of them may appear on the command line.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 
\series bold
-r file.feb
\end_layout

\begin_layout Description

\series bold
-g,-g1,-g2
\series default
 The g options run FEBio in 
\shape italic
debug mode
\shape default
,
 in which case FEBio will print more information to the log and plot files.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Debugging-a-Run"
nolink "false"

\end_inset

 for more information on running FEBio in debug mode.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
g
\end_layout

\begin_layout Description

\series bold
-p
\series default
 The p option allows the user to specify the name of the 
\shape italic
plot file
\shape default
.
 The plot file is a binary file that contains the main results of the analysis.
 FEBio usually provides a default name for this file;
 however,
 the user can override the default name using this option.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:FEBio-Output"
nolink "false"

\end_inset

 for more details on the output files generated by FEBio.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
p out.xplt
\end_layout

\begin_layout Description

\series bold
-o 
\series default
The o option allows the user to set the name of the 
\shape italic
log file
\shape default
.
 The log file will contain a record of the screen output that was generated during a run.
 FEBio usually provides a default name for this file (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:FEBio-Output"
nolink "false"

\end_inset

),
 but the user can override it with this command line option.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
o out.log
\end_layout

\begin_layout Description

\series bold
-s
\series default
 This option instructs FEBio to run a material parameter optimization on the specified input file.
 The optimization module is described in detail in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Parameter-Optimization"
nolink "false"

\end_inset

.
 The s option is followed by the optimization control file which contains among other things the parameters that need to be optimized.
 Note that the restart feature does not work with the optimization module.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 i file.feb 
\series bold
s control.opt
\end_layout

\begin_layout Description

\series bold
-d
\series default
 This option will run a FEBio diagnostics.
 A diagnostic is a special type of test that can be used to verify an implementation.
 For example,
 the 
\shape italic
tangent diagnostic 
\shape default
allows users to check the consistency between the material's stress and tangent implementations.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 
\series bold
d diagnostic.feb
\end_layout

\begin_layout Description

\series bold
-break
\series default
 With this option a break point can be set which sets a time point at which FEBio will interrupt the run and show the FEBio prompt.
 The following example sets a break point at time 1.0.
 FEBio will interrupt the run after the time step at time 1.0 is reached (i.e.
 has converged).
 (See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Setting-break-points"
nolink "false"

\end_inset

 for more informations on setting break points.)
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 i file.feb 
\series bold
break 1.0
\end_layout

\begin_layout Description

\series bold
-dump
\series default
 It is possible to restart a previous run using the restart capability in FEBio.
 This is useful when a run terminates unexpectedly.
 If that happens,
 the user can restart the analysis from the last converged timestep.
 Before this feature can be used,
 the user must request the creation of a 
\shape italic
dump file
\shape default
.
 This file will store all the information that FEBio will need to restart the analysis.
 FEBio will usually provide a default name for the dump file,
 but the 
\emph on
dump
\emph default
 command line option allows the user to override the default name for the dump file.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Restarting-a-Run"
nolink "false"

\end_inset

 and Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Restart-Input-file"
nolink "false"

\end_inset

 for more details on how to use the restart feature.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
dump out.dmp
\end_layout

\begin_layout Description
-dump_stride Sets the interval between writing dump files.
 The default is 1 (although the dump level may affect this as well.) The following example will write a dump file after every 10 timesteps.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb dump out.dmp 
\series bold
-dump_stride=10
\end_layout

\begin_layout Description

\series bold
-config
\series default
 As of version 1.2,
 FEBio uses a 
\shape italic
configuration file
\shape default
 to store platform specific settings.
 Usually FEBio assumes that the location for this configuration file is the same as the executable.
 However,
 the user can specify a different location and filename using the config command line option.
 If the user does not have a configuration file or does not wish to use one,
 this can be specified using the noconfig option.
 More details on the configuration file can be found in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Configuration-file"
nolink "false"

\end_inset

 and Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Configuration-File"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
config C:
\begin_inset Formula $\backslash$
\end_inset

path
\begin_inset Formula $\backslash$
\end_inset

to
\begin_inset Formula $\backslash$
\end_inset

febio.xml
\end_layout

\begin_layout Description

\series bold
-noconfig
\series default
 Do not read and process the FEBio configuration file.
 FEBio will start with its default configuration.
 
\end_layout

\begin_layout Description

\series bold
-nosplash
\series default
 When the nosplash command is entered on the command line,
 FEBio will not print the welcome message to the screen.
 This is useful when calling FEBio from another application and when the user wishes to suppress any screen output from FEBio.
 Other options for suppressing output can be set in the control section of the FEBio input file (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Control-Parameters"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
nosplash
\end_layout

\begin_layout Description
-import This command will load the plugin that is specified following this command line option.
 Although it is more convienient to list plugins in the FEBio configuration file,
 this option allows users to load a plugin from the command line,
 if such a need would arise.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 
\series bold
import myplugin.dll
\end_layout

\begin_layout Description

\series bold
-silent
\series default
 When the silence option is specified on the command line,
 FEBio will not generate any output to the screen.
 Unless explicitly instructed not to,
 FEBio will still create a log file which will have the convergence information.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
silent
\end_layout

\begin_layout Description

\series bold
-task
\series default
 FEBio will always run a 
\emph on
task
\emph default
.
 The default task is to solve a forward model defined by the input file specified using the -i command line option.
 However,
 other tasks are available,
 such as optimization and restart,
 as well as user-created tasks created in FEBio plugins.
 The name of the task is defined after an equal sign (=).
 An optional task control file can be specified as well.
 For instance,
 an alternative way for running an optimization problem is as follows.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio4 -i input.feb 
\series bold
task=optimize control.opt
\end_layout

\begin_layout Section
The FEBio Prompt
\begin_inset CommandInset label
LatexCommand label
name "sec:FEBio-prompt"

\end_inset


\end_layout

\begin_layout Standard
The FEBio prompt is shown when you start FEBio without any command arguments (referred to 
\emph on
interactive mode
\emph default
),
 or when a run is interrupted either by the user (using ctrl+c 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
This feature does not work on some Linux platforms and may abruptly terminate the run.
\end_layout

\end_inset

;
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Interrupting-a-Run"
nolink "false"

\end_inset

 for more details),
 or by reaching a breakpoint (referred to as 
\emph on
break mode
\emph default
).
 The FEBio prompt will look something like this:
\end_layout

\begin_layout LyX-Code
febio>
\end_layout

\begin_layout Standard
You can now enter one of the following commands.
 Note that some commands are only available in a specific mode (either 
\emph on
interactive 
\emph default
or 
\emph on
break
\emph default
 mode).
 Also see additional comments below.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="23" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
command line option
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
argument
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
interactive
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Add a breakpoint,
 which stops FEBio at a particular point.(1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
breakpoint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
breaks
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print a list of breakpoints.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
clear
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Clears one or more breakpoints.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
breakpoint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
config
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Load (or reload) configuration file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
configuration file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cont
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Continue the current task
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
conv
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force conversion of the current time step.
 (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
debug
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Toggle debug mode (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[on/off]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force the current time step to fail.
 (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
help
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print a list of available commans
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
import
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Import a plugin file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plugin file name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
out
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output to file the current stiffness matrix and right-hand side
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[-txt]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Write the current model state to the plot file.
 (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plugins
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print a list of plugins.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print the value of an internal variable.
 (6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
quit
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stop the current model or exit of no model is running
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
restart
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Toggle the restart flag.
 (7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
run
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Run a febio input file.
 (8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(command line options)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
set
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sets certain model and configuration variables.
 (9)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
variable name (space) value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
svg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Write the sparse matrix profile to an svg file.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
svg file name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print progress time statistics.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unload
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unload a plugin from FEBio.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plugin name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
version
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print version information.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
List of options for the FEBio command prompt.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
A breakpoint is a particular time point or an event at which FEBio will pause the run.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Setting-break-points"
nolink "false"

\end_inset

 for more details on break points.
\end_layout

\begin_layout Enumerate
The 
\emph on
force
\emph default
 command is useful,
 for example,
 when a time step is having difficulty satisfying the convergence criteria.
 The user can then manually force the convergence of the time step.
 However,
 if the convergence difficulties are due to instabilities,
 forcing a time step to converge could cause the solution to become unstable or even incorrect.
 Also be aware that even if the solution recovers on later timesteps,
 the manually converged step might be incorrect.
\end_layout

\begin_layout Enumerate
The 
\emph on
debug 
\emph default
command toggles the debug flag.
 Adding 
\shape italic
on 
\shape default
(
\shape italic
off
\shape default
) will turn the debug mode on (resp.
 off).
 In debug mode,
 FEBio will store additional information to the log and plot file that could be useful in debugging the run.
 It is important to note that since FEBio will store all non-converged states to the plot file,
 this file may become very large in a short number of time steps.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Debugging-a-Run"
nolink "false"

\end_inset

 for more details on debugging.
\end_layout

\begin_layout Enumerate
If the current time step is not converging and if the auto-time stepper is enabled,
 the fail command will stop the current time step and retry it with a smaller time step size.
 If the auto-time stepper is not enabled,
 the fail command will simply exit the application.
\end_layout

\begin_layout Enumerate
The 
\emph on
plot 
\emph default
command is useful when you want to store the non-converged state at the current iteration.
 Note that this command only stores the state at the current iteration.
 If you turn on debug mode,
 all the iterations are stored to the plot file.
\end_layout

\begin_layout Enumerate
The following variables can be printed.
 
\end_layout

\begin_deeper
\begin_layout Description
nnz Number of nonzeroes in global stiffness matrix.
\end_layout

\begin_layout Description
time The current simulation time
\end_layout

\begin_layout Description
neq The number of equations 
\end_layout

\end_deeper
\begin_layout Enumerate
When the restart flag is set,
 FEBio will create a dump file at the end of each converged time step.
 This dump file can then later be used to restart the analysis from the last converged time step.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Restarting-a-Run"
nolink "false"

\end_inset

 and Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Restart-Input-file"
nolink "false"

\end_inset

 for more details on FEBio's restart feature.
\end_layout

\begin_layout Enumerate
The 
\emph on
run 
\emph default
command is used to start an FEBio task.
 This command takes the same options that you can enter on the command line.
 For example,
 to run a file named 
\shape italic
test.feb 
\shape default
from the FEBio prompt,
 type the following:
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
run i test.feb
\end_layout

\end_deeper
\begin_layout Enumerate
The following configuration file settings can be set from the febio command prompt.
 
\end_layout

\begin_deeper
\begin_layout Description
output_negative_jacobians turn on or off the detailed output when negative jacobians are encountered.
\end_layout

\begin_layout Description
print_model_params turn on or off the output of the parameter values of parameters that are load controlled.
 
\end_layout

\begin_layout Description
show_warnings_and_errors turn on or off the printing of warning and error messages.
 
\end_layout

\begin_layout Standard
To turn the option on (off),
 follow the set command by the variable name and then a value of 1 (0).
 For example,
 
\end_layout

\begin_layout LyX-Code
set output_negative_jacobians 1
\end_layout

\begin_layout Standard
If you enter the set command without any additional options,
 a list will be printed of the current configuration settings.
 
\end_layout

\end_deeper
\begin_layout LyX-Code

\end_layout

\begin_layout Section
The Configuration File
\begin_inset CommandInset label
LatexCommand label
name "sec:Configuration-file"

\end_inset


\end_layout

\begin_layout Standard
As of version 1.2,
 FEBio uses a 
\shape italic
configuration file 
\shape default
to store platform-specific settings,
 such as the default linear solver and the list of plugins that need to be loaded at startup.
 The configuration file uses an xml format to store data and is detailed in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Configuration-File"
nolink "false"

\end_inset

.
 For backward compatibility,
 it is still possible to run FEBio without the configuration file.
 In that case,
 the default settings prior to version 1.2 are used.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio i myfile.feb -noconfig
\end_layout

\begin_layout Standard
The default configuration file needs to be stored in the same location as the executable and named 
\shape italic
febio.xml
\shape default
.
 Alternatively,
 the location and the name of the file can also be specified on the command line using the config option.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
> febio -i myfile.feb config /home/my/folder/FEBio/febio.xml
\end_layout

\begin_layout Section
Using Multiple Processors
\begin_inset CommandInset label
LatexCommand label
name "sec:Using-Multiple-Processors"

\end_inset


\end_layout

\begin_layout Standard
As of version 2.0,
 FEBio uses OpenMP to parallellize several of the finite element calculations,
 improving the performance considerably.
 Both the right-hand-side and the stiffness matrix evaluations for many types of problems have been parallelized.
 On a system with four processors,
 a speedup of 2-3 can be expected,
 depending on the size and type of model.
 Models with complex material behavior (such as EFD-type materials,
 biphasic,
 multiphasic materials,
 etc.) will benefit most from these parallelization efforts.
 In addition,
 FEBio implements the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{http://software.intel.com/en-us/intel-mkl/}{
\backslash
emph{MKL}}
\end_layout

\end_inset

 version of the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{http://www.pardiso-project.org/}{
\backslash
emph{PARDISO}}
\end_layout

\end_inset

 linear solver,
 which is a parallel linear solver that uses OpenMP.
\end_layout

\begin_layout Standard
To use multiple processors,
 set the environment variable OMP_NUM_THREADS to the number of desired threads.
 You should set the number of threads to be equal or less than the number of processors on your system (Setting it higher may actually decrease performance).
 For example,
 on a system with four processors you can set the environment as follows.
 On Linux using the Bash shell,
 execute:
\end_layout

\begin_layout LyX-Code
> export OMP_NUM_THREADS=4
\end_layout

\begin_layout Standard
Using the c-shell,
 execute:
\end_layout

\begin_layout LyX-Code
> setenv OMP_NUM_THREADS 4
\end_layout

\begin_layout Standard
Or at a Windows command prompt:
\end_layout

\begin_layout LyX-Code
> set OMP_NUM_THREADS=4
\end_layout

\begin_layout Standard
On Windows,
 you can add this environment variable as well from the System Properties dialog box.
\end_layout

\begin_layout Paragraph

\series bold
A note on repeatability
\end_layout

\begin_layout Standard
Ideally,
 when the same model is run repeatedly,
 either on the same machine or on different machines,
 it should produce the same convergence statistics and results.
 However,
 in practice this is not always the case and sometimes the convergence stats and even the results can differ.
 In most cases,
 the discrepancies should be small,
 however in some cases,
 and especially in models that are prone to ill-conditioning (e.g.
 contact),
 the discrepancies may be more significant.
 The underlying reason is that in different compute environments it can not be guaranteed that all calculations are executed in the exact same order and,
 due to numerical round-off,
 the results of these calculations will not always be the same.
 On a single machine,
 this can happen when the model is run using multiple processors.
 (However,
 running the same model on a machine with a single processor should always produce the exact same results.) This behavior can also be observed when running the same model on different machines,
 especially if these machines have different OS.
 
\end_layout

\begin_layout Standard
Similarly,
 although FEBio aims to be backward compatible,
 running the same model with different versions of FEBio,
 may also show discrepancies for similar reasons.
 In this case,
 the discrepancies are likely caused by algorithmic optimizations or changes in compiler settings.
 
\end_layout

\begin_layout Section
FEBio Output
\begin_inset CommandInset label
LatexCommand label
name "sec:FEBio-Output"

\end_inset


\end_layout

\begin_layout Subsection
Screen output
\end_layout

\begin_layout Standard
By default,
 FEBio will print convergence and progress information to the screen that informs users how the analysis is progressing.
 The output depends on the particular module and solver that was chosen in the FEBio input file,
 as well as some user-defined settings,
 but in general provides the following information.
 
\end_layout

\begin_layout Itemize

\series bold
Time stepping
\series default
 
\series bold
information
\series default
:
 The current time step that FEBio is solving and a notification when the time step completed (or an error message why the time step failed to complete)
\end_layout

\begin_layout Itemize

\series bold
Convergence information
\series default
:
 for each time step,
 FEBio usually has to solve a nonlinear problem for which an iterative nonlinear solver is used.
 Several 
\begin_inset Quotes eld
\end_inset

norms
\begin_inset Quotes erd
\end_inset

 are printed to inform the user how FEBio is progressing toward the solution of the nonlinear problem.
 
\end_layout

\begin_layout Itemize

\series bold
Summary:
 
\series default
At the end of the analysis a summary is printed with heuristics that inform the user how well the model ran.
 
\end_layout

\begin_layout Standard
By default,
 all screen output will also be printed to the log file.
 
\end_layout

\begin_layout Standard
The summary printed at the end of a run also provides some useful timing information.
 Below follows an explanation of the different reported timings.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
timing
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Input time
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time it took to process the FEBio input file.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initialization time
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to initialize and check the model
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solve time
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The total time it took to solve the model.
 This is the sum of the following timings:
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IO-time
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to write the output files (i.e.
 the plot,
 dump,
 and data files)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reforming stiffness
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to reform the stiffness matrix (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
evaluating stiffness
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to evaluate the stiffness matrix (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
evaluating residual
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to evaluate the residual (3)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
model update
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to update the model (4)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
QN updates
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time to evaluate the Quasi-Newton updates (5)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time in linear solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The time spent in the linear solver (6)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Table listing descriptions of the different timings reported at the end of an FEBio job.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Comments:
\end_layout

\begin_layout Enumerate
Internally,
 FEBio uses a sparse-matrix storage format to store the global stiffness matrix efficiently.
 A matrix reformation refers to the process of calculating the structure of this sparse matrix.
 The structure depends mostly on the nodal connectivity and for many problems this only needs to be calculated once at the start of the run.
 However,
 for some problems the connectivity may change during an analysis and this may require a reformation of the global stiffness matrix.
 (For instance,
 changes in contacting facets.) 
\end_layout

\begin_layout Enumerate
The global stiffness matrix needs to be evaluated often as it is needed by the Newton solver for finding the solution.
 The total time to evaluate this stiffness matrix may often be a significant portion of the total runtime,
 however,
 there are several parameters that affect this.
 For instance,
 the max_ups parameter sets the number of quasi-Newton updates.
 During these updates,
 the full stiffness is not re-evaluated.
 Instead,
 a rank-one update is performed,
 which often significantly reduces the time to evaluate the stiffness matrices.
 
\end_layout

\begin_layout Enumerate
The residual,
 which is the difference between 
\begin_inset Quotes eld
\end_inset

internal
\begin_inset Quotes erd
\end_inset

 forces (i.e.
 stresses) and external forces,
 is evaluated during each quasi-Newton iteration.
 Although the residual is calculated many times during an analysis,
 its evaluation rarely takes up a significant time of the total run time.
 
\end_layout

\begin_layout Enumerate
During the model update,
 all quantities that depend on the solution variables will be updated.
 This includes nodal positions,
 element stress,
 etc.
 This update is also called for each quasi-Newton iteration.
 Although the update is usually fast,
 the fact that it is required for every iteration may cause the total time spent in the model update to be significant.
 
\end_layout

\begin_layout Enumerate
The QN update refers to the process of calculating a rank-one update of the stiffness matrix.
 This is usually a fast process and does not take up a signifcant amount of time.
 
\end_layout

\begin_layout Enumerate
The time in the linear solver usually takes up most of the total runtime.
 Most of this time is spent calculating the factorization of the global stiffness matrix.
 
\end_layout

\begin_layout Subsection
Output files
\end_layout

\begin_layout Standard
After running FEBio,
 two or three files are created:
 the 
\shape italic
log file
\shape default
,
 the 
\shape italic
plot file,

\shape default
 and optionally the 
\shape italic
dump file
\shape default
.
 The log file is a text file that contains the same output (and usually more) that was written to the screen.
 The 
\shape italic
plot file
\shape default
 contains the results of the analysis.
 Since this is a binary file,
 the results must be analyzed using post processing software such as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/febio-studio/}{
\backslash
emph{FEBio Studio}}
\end_layout

\end_inset

.
 In some cases,
 the user may wish to request the creation of a 
\shape italic
dump file
\shape default
.
 This file contains temporary results of the run.
 If an analysis terminates unexpectedly or with an error,
 this file can be used to restart the analysis from the last converged time step.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Restarting-a-Run"
nolink "false"

\end_inset

 and Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Restart-Input-file"
nolink "false"

\end_inset

 for more details.
 The names of these files can be specified with the command options p (plot file),
 -a (dump file),
 -o (log file).
 If one or more of the file names following these flags are omitted,
 then the omitted file name(s) will be given a default name.
 The default file names are derived from the input file name.
 For example,
 if the input file name is 
\shape italic
input.feb 
\shape default
the logfile will have the name 
\shape italic
input.log
\shape default
,
 the plot file is called 
\shape italic
input.xplt
\shape default
 and the dump file is called 
\shape italic
input.dmp
\shape default
.
\end_layout

\begin_layout Standard

\emph on
Note 1.

\emph default
 The name of the log and plot file can also be specified in the FEBio input file.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:LoadData-Section"
nolink "false"

\end_inset

 for more information.
\end_layout

\begin_layout Standard

\emph on
Note 2.

\emph default
 When running an optimization problem the name of the log file is derived from the optimization control file.
 See Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Parameter-Optimization"
nolink "false"

\end_inset

 for more information on running optimization problems with FEBio.
\end_layout

\begin_layout Section
Advanced Options
\begin_inset CommandInset label
LatexCommand label
name "sec:Advanced-Options"

\end_inset


\end_layout

\begin_layout Subsection
Interrupting a Run
\begin_inset CommandInset label
LatexCommand label
name "subsec:Interrupting-a-Run"

\end_inset


\end_layout

\begin_layout Standard
The user can pause the run by pressing ctrl+c.
 This will bring up the FEBio prompt,
 and the user can enter a command.
 The FEBio prompt will also be shown when FEBio reaches a break point.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:FEBio-prompt"
nolink "false"

\end_inset

 for a list of available commands.
 Note that it may take a while before the FEBio prompt is displayed after the user requests a ctrl+c interruption.
 This may be because the program is in the middle of a call to the linear solver or another time-consuming part of the analysis procedure that cannot be interrupted.
 NOTE:
 This feature may not work properly on all systems,
 although it should always work on Windows systems.
\end_layout

\begin_layout Subsection
Debugging a Run
\begin_inset CommandInset label
LatexCommand label
name "subsec:Debugging-a-Run"

\end_inset


\end_layout

\begin_layout Standard
As stated in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Command-Line"
nolink "false"

\end_inset

,
 FEBio can be run in debug-mode by specifying the g option on the command line.
 When running in debug mode,
 FEBio performs additional checks and prints out more information to the screen and to the plot file.
 It will also store all non-converged states to the plot file.
 These non-converged states can be very useful for determining the cause of non-convergence or slow convergence.
 Because of this additional work,
 the problem may run slightly slower.
 Note that debug mode can be turned on/off while running an analysis by first interrupting the run with ctrl+c and then using the 
\shape italic
debug 
\shape default
command to toggle the debug mode on or off.
 It is important to note that since FEBio will store all non-converged states to the plot file,
 this file may become very large in a short number of time steps.
 An alternative approach is to use the 
\shape italic
plot
\shape default
 command to write out select non-converged states.
\end_layout

\begin_layout Subsection
Setting break points
\begin_inset CommandInset label
LatexCommand label
name "subsec:Setting-break-points"

\end_inset


\end_layout

\begin_layout Standard
Although ctrl+c can be used to interrupt a run,
 it might sometimes be difficult to interrupt a run at a desired point.
 For this reason,
 you can set break points that will pause the execution and bring up the FEBio prompt.
 Breakpoints are set on the command line using the 
\series bold
-break
\series default
 option,
 followed by the break condition.
 In addition,
 breakpoints can also be set via the FEBio prompt using the 
\series bold
break 
\series default
option.
 
\end_layout

\begin_layout Standard
To break at a particular time point,
 simply add the value of the time after the 
\emph on
-break
\emph default
 option.
 This example will pause the run after time 0.45 completed (or the first time point past 0.45):
 
\end_layout

\begin_layout LyX-Code
>febio -i input.feb -break 0.45
\end_layout

\begin_layout Standard
Instead of pausing at a particular time,
 you can also interrupt the run when a certain event happens.
 To break at an event,
 specify the event name at which to pause the run.
 The following list of events are defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Event
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ALWAYS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break on any event
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
INIT
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after model initialization
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STEP_ACTIVE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after step activation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MAJOR_ITERS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after major iteration (i.e.
 time step) converged
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MINOR_ITERS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after minor iteration (i.e.
 Newton iteration)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SOLVED
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after the model is solved
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UPDATE_TIME
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break before time is incremented
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AUGMENT
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break before augmentation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STEP_SOLVED
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after step is solved
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REFORM
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break after global matrix and right hand side is reformed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MATRIX_SOLVE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
break right before the linear system solve
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to pause the execution after a matrix reformation (and right-hand-side evaluation),
 enter the following command line.
\end_layout

\begin_layout LyX-Code
>febio -i input.feb -break REFORM
\end_layout

\begin_layout Standard
Once the code reaches a breakpoint,
 the febio prompt will be presented.
 There are several commands that relate to breakpoints.
 
\end_layout

\begin_layout Description
break Add a breakpoint
\end_layout

\begin_layout Description
breaks Prints list of current breakpoints.
\end_layout

\begin_layout Description
clear Clear one or all breakpoints.
\end_layout

\begin_layout Subsection
Restarting a Run
\begin_inset CommandInset label
LatexCommand label
name "subsec:Restarting-a-Run"

\end_inset


\end_layout

\begin_layout Standard
When the creation of a restart dump file is requested,
 the analysis can be restarted from the last converged timestep.
 This is useful when the run terminated unexpectedly or when the user wishes to modify some parameters during the analysis.
 To request the creation of a dump file,
 simply add the
\emph on
 -dump
\emph default
 flag on the command line.
 This will generate a 
\shape italic
\emph on
dump
\emph default
 
\shape default
file which then can be used to restart the analysis.
 You can specify an optional dump level,
 which sets how often the dump file is created,
 and an optional dump file name.
 
\end_layout

\begin_layout LyX-Code
> febio -i input.feb -dump
\end_layout

\begin_layout Standard
With the optional arguments,
 the complete syntax would be:
\end_layout

\begin_layout LyX-Code
>febio -i input.feb -dump=1 out.dmp
\end_layout

\begin_layout Standard
The dump level can be set to 1 (= write dump file after each converged time step),
 2 (= write dump file after each completed analysis step),
  or 3 (= write dump file after each converged
\shape italic
 must-point 
\shape default
 ).
\end_layout

\begin_layout Standard
To restart an analysis,
 use the -r command line option.
 This option requires a filename as a parameter,
 and this name can be either the name of a dump file or the name of a restart input file.
 The latter case is a text file that allows the user to redefine some parameters when restarting the run.
 The format of this file is described in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Restart-Input-file"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Section
FEBio File Conventions
\end_layout

\begin_layout Standard
Although users are free to choose file names and file extensions,
 it might be beneficial to adhere to the following file naming conventions.
 
\end_layout

\begin_layout Description
feb FEBio input file.
 
\end_layout

\begin_layout Description
xplt FEBio plot file.
\end_layout

\begin_layout Description
log FEBio log file.
 
\end_layout

\begin_layout Description
dmp FEBio dump file (for restarts).
 
\end_layout

\begin_layout Description
opt FEBio optimization control file.
 
\end_layout

\begin_layout Description
rst FEBio restart input file.
 
\end_layout

\begin_layout Chapter
Free Format Input
\begin_inset CommandInset label
LatexCommand label
name "chap:Free-Format-Input"

\end_inset


\end_layout

\begin_layout Standard
This chapter describes the XML-based input format used by FEBio.
 Since this format follows standard XML conventions,
 the files can be viewed with any file viewer that supports XML files.
 Since the free format input file is a text file,
 it can be edited with any text editor.
\end_layout

\begin_layout Standard
An XML file is composed of a hierarchical list of 
\shape italic
elements
\shape default
.
 The first element is called the 
\shape italic
root element
\shape default
.
 Elements can have multiple 
\shape italic
child elements
\shape default
.
 All elements are enclosed by two 
\shape italic
tags:

\shape default
 a tag defining the element and an 
\shape italic
end tag
\shape default
.
 A simple example of an XML file might look like this:
\end_layout

\begin_layout LyX-Code
<root>
\end_layout

\begin_layout LyX-Code
  <child>
\end_layout

\begin_layout LyX-Code
    <subchild> ...
 </subchild>
\end_layout

\begin_layout LyX-Code
  </child>
\end_layout

\begin_layout LyX-Code
</root>
\end_layout

\begin_layout Standard
The 
\shape italic
value
\shape default
 of an element is enclosed between the name and the end tag.
\end_layout

\begin_layout LyX-Code
<element> here is the value </element>
\end_layout

\begin_layout Standard
Note that the XML format is case-sensitive.
\end_layout

\begin_layout Standard
XML elements can also have 
\shape italic
attributes
\shape default
 in name/value pairs.
 The attribute value must always be quoted using quotation marks (") or apostrophes (')
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 Support for apostrophes was not added until FEBio version 2.1.
\end_layout

\end_inset

.
\end_layout

\begin_layout LyX-Code
<element attr="value">...</element>
\end_layout

\begin_layout LyX-Code
<element attr='value'>...</element>
\end_layout

\begin_layout Standard
If an XML element has no value,
 an abbreviated syntax can be used.
 The following two lines are identical.
\end_layout

\begin_layout LyX-Code
<element [attribute list]></element>
\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout LyX-Code
<element [attribute list]/>
\end_layout

\begin_layout Standard
Comments can be added as follows.
\end_layout

\begin_layout LyX-Code
<!-- This is a comment -->
\end_layout

\begin_layout Standard
The first line in the document  the XML declaration  defines the XML version and the character encoding used in the document.
 An example can be:
\end_layout

\begin_layout LyX-Code
<?xml version="1.0" encoding="ISO-8859-1"?>
\end_layout

\begin_layout Section
Free Format Overview
\begin_inset CommandInset label
LatexCommand label
name "sec:Free-Format-Overview"

\end_inset


\end_layout

\begin_layout Standard
The free format organizes the FEBio input data into hierarchical XML elements.
 The root element is called 
\shape italic
febio_spec
\shape default
.
 This root element also defines the format version number (Note that FEBio and the input format specification follow different version numberings).
 This document describes version 4.0 of the FEBio specification
\begin_inset Foot
status open

\begin_layout Plain Layout
FEBio continues to read some older formats,
 but they are considered to be obsolete.
\end_layout

\end_inset

 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Format-Specification-Versions"
nolink "false"

\end_inset

 below for more details on the different input specification formats).
 The root element will therefore be defined as follows:
\end_layout

\begin_layout LyX-Code
<febio_spec version="4.0">
\end_layout

\begin_layout LyX-Code
<!-- contents of file -->
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard
The different sections introduced in this chapter are child elements of this root element.
 The following sections are currently defined:
\end_layout

\begin_layout Description

\shape italic
\emph on
Module
\shape default
\emph default
 defines the physics module for solving the model.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Globals
\shape default
\emph default
 Defines the global variables in the model
\end_layout

\begin_layout Description

\shape italic
\emph on
Control
\shape default
\emph default
 specifies control and solver parameters.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Material
\shape default
\emph default
 Specifies the materials used in the problem and the material parameters.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Mesh
\shape default
\emph default
 Defines the mesh of the problem,
 including nodal coordinates and element connectivity.
 
\end_layout

\begin_layout Description
MeshDomains Assigns materials and other formulation attributes to element sets.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
MeshData
\shape default
\emph default
 Defines element,
 facet,
 edge or nodal data that can be mapped to material parameters or certain boundary conditions and loads.
 
\end_layout

\begin_layout Description
MeshAdaptor Defines mesh adaptors that modify the mesh.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Initial
\shape default
\emph default
 Defines initial conditions for dynamic problems,
 such as initial velocities,
 and for transient quasi-static problems.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Boundary
\shape default
\emph default
 Defines the boundary conditions that are applied on the geometry.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Loads
\shape default
\emph default
 Defines the loads applied to the model.
 This includes nodal loads,
 boundary loads and volume loads (or sources for heat transfer problems).
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Contact
\shape default
\emph default
 This section defines all contact interfaces.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Constraints
\shape default
\emph default
 This section defines rigid and nonlinear constraints.
 
\end_layout

\begin_layout Description
Rigid This sections defines rigid components,
 such as rigid constraints,
 rigid loads,
 and rigid connectors.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Discrete
\shape default
\emph default
 This section defines all the discrete elements (i.e.
 springs).
\end_layout

\begin_layout Description

\shape italic
\emph on
LoadData
\shape default
\emph default
 Defines the load controllers,
 which can control model parameters as a function of time.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Step
\shape default
\emph default
 Defines different analysis steps,
 where in each analysis the boundary,
 loads,
 contact and initial conditions can be redefined.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Ouput
\shape default
\emph default
 Defines additional data that needs to be stored to file.
 
\end_layout

\begin_layout Standard
Although there is some flexibility in the order in which these sections can be listed,
 it is recommended to list them in the same order as given above.
 Not all sections are required.
 Empty sections can be omitted.
 A minimal file must contain at least the Module,
 Control,
 Material,
 Mesh,
 and MeshDomains sections.
 The rest of this chapter describes each of these sections in more detail.
\end_layout

\begin_layout Subsection
Format Specification Versions
\begin_inset CommandInset label
LatexCommand label
name "sec:Format-Specification-Versions"

\end_inset


\end_layout

\begin_layout Standard
This document describes version 4.0 of the FEBio input specification.
 This format differs in several aspects from the previous versions of the input specification.
 This section describes the major changes between the different versions.
\end_layout

\begin_layout Itemize

\series bold
Version 4.0
\series default
:
 The latest and recommended version of the FEBio input specification described in this document.
 The main motivation for this format was to improve consistency between the feb file structure and the way the FEBio model is constructed in FEBio Studio.
 This format is very similar to version 3.0 and only differs in a few sections:
 Some solver parameters have moved.
 The Rigid section was restructured.
 Node and element sets can be specified more concisely.
 
\end_layout

\begin_layout Itemize

\series bold
Version 3.0
\series default
:
 The major focus of this revision was adding support for FEBio 3.0's features for modeling heterogeneous parameters.
 Heterogeneous parameters can be created via mathematical expressions or via the MeshData section.
 It also introduces a more consistent way for referencing model parameters.
 The 
\emph on
Geometry 
\emph default
section was replaced with the 
\emph on
Mesh 
\emph default
and 
\emph on
MeshDomains 
\emph default
sections in order to further separate the definition of the mesh and its physical attributes (e.g.
 material assignments).
 This format is 
\series bold
still supported
\series default
 but considered obsolete.
\end_layout

\begin_layout Itemize

\series bold
Version 2.5
\series default
:
 This format differs from its predecessor in some important aspects:
 all nodesets,
 surfaces,
 etc.,
 that are used by boundary conditions,
 loads,
 contact,
 etc.,
 must be defined in the Geometry section.
 Boundary conditions,
 loads,
 contact,
 etc.,
 are now defined by referencing the sets in the Geometry section.
 This format also adds the 
\shape italic
MeshData 
\shape default
section and reformats the 
\shape italic
Discrete 
\shape default
section.
 Rigid node sets and prescribed rigid degrees of freedom are moved to the 
\shape italic
Boundary
\shape default
 section.
 This format is 
\series bold
still supported
\series default
 but considered obsolete.
 
\end_layout

\begin_layout Itemize

\series bold
Version 2.0
\series default
:
 This is the first major revision of the input file format and redefines many of the file sections:
 The 
\shape italic
Elements 
\shape default
section uses a different organization.
 Elements are now grouped by material and element type.
 Multiple 
\shape italic
Elements 
\shape default
sections can now be defined to create multiple parts.
 Surfaces can now be defined in the 
\shape italic
Geometry 
\shape default
section and referenced by boundary conditions and contact definitions.
 A new 
\shape italic
Contact
\shape default
 section contains all the contact definitions.
 A new 
\shape italic
Discrete 
\shape default
section was defined that contains all the materials and definitions of the discrete elements (e.g.
 springs).
 The 
\shape italic
Boundary 
\shape default
section is also redesigned.
 This format is 
\series bold
still supported 
\series default
but considered obsolete.
 
\end_layout

\begin_layout Itemize

\series bold
Version 1.3
\series default
:
 This was an experimental version that redefined the 
\shape italic
Geometry 
\shape default
section,
 but was later abandoned in favor of version 2.0.
 This version is 
\series bold
no longer supported
\series default
.
 
\end_layout

\begin_layout Itemize

\series bold
Version 1.2
\series default
:
 A 
\shape italic
Loads 
\shape default
section was added and all surface and body loads are now defined in this section instead of the 
\shape italic
Boundary 
\shape default
section.
 This version is 
\series bold
mostly supported
\series default
 but considered obsolete.
 
\end_layout

\begin_layout Itemize

\series bold
Version 1
\series default
.
\series bold
1
\series default
:
 Rigid body constraints are no longer defined in the rigid material definition but instead placed in a new 
\shape italic
Constraints 
\shape default
section.
 This version is 
\series bold
no longer supported
\series default
.
 
\end_layout

\begin_layout Itemize

\series bold
Version 1.0
\series default
:
 The original input format specification.
 This version is 
\series bold
no longer supported
\series default
.
 
\end_layout

\begin_layout Standard
As of FEBio 4.0,
 only versions 1.2,
 2.0,
 2.5,
 and 3.0 are supported.
 Versions 1.2 and 2.0 are considered obsolete and it is highly recommended to convert older files to the newest specification for use with newer versions of FEBio.
 This can be done for instance using FEBioStudio.
\end_layout

\begin_layout Subsection

\series bold
Notes on backward compatibility
\end_layout

\begin_layout Standard
Some features that were available in versions prior to 4.0 are no longer supported or require a different syntax.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
Parameters 
\emph default
section is no longer supported.
 This section allowed users to define file parameters that could be used as parameter values.
 This section was removed since it was difficult to support in FEBio Studio and a better mechanism was implemented for defining model-level parameters.
 (See the 
\emph on

\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:User-Variables"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 
\emph default
section.) 
\end_layout

\begin_layout Enumerate
Some fiber materials defined the 
\emph on
theta
\emph default
 and 
\emph on
phi
\emph default
 parameters for setting the fiber orientation.
 These parameters are no longer supported.
 Instead,
 the fiber direction should be specified via the 
\emph on
fiber
\emph default
 property,
 or if the 
\emph on
fiber 
\emph default
property is not available,
 the 
\emph on
mat_axis 
\emph default
property.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<fiber type="angles">
\end_layout

\begin_layout LyX-Code
  <theta>90</theta>
\end_layout

\begin_layout LyX-Code
  <phi>0</phi>
\end_layout

\begin_layout LyX-Code
</fiber>
\end_layout

\end_deeper
\begin_layout Subsection
Multiple Input Files
\begin_inset CommandInset label
LatexCommand label
name "sec:Multiple-Input-Files"

\end_inset


\end_layout

\begin_layout Standard
FEBio supports distributing the model definition across multiple input files.
 This can greatly facilitate defining large,
 complex models and allows the re-use of model input files without the need to create the entire model input file from scratch.
 When using multiple input files to define a model,
 you must create a control input file that may reference other input files.
 This control file will be used to run the model in FEBio.
 There are two ways of including a file into the control file:
 The 
\emph on
Include 
\emph default
section,
 and the 
\emph on
from 
\emph default
attribute
\emph on
.
\end_layout

\begin_layout Standard
Note that all input files must start with the 
\emph on
febio_spec
\emph default
 tag and use the same format specification.
 
\end_layout

\begin_layout Subsubsection
Include Keyword
\begin_inset CommandInset label
LatexCommand label
name "subsec:Include-Keyword"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Include 
\shape default
keyword
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Supported from FEBio version 2.3 and up.
\end_layout

\end_inset

 can be used to include the contents of another FEBio input file.
 The filename is entered as the value of the tag.
\end_layout

\begin_layout LyX-Code
<Include>example.feb</Include>
\end_layout

\begin_layout Standard
The included file must be a valid FEBio file in that it must begin with the 
\shape italic
febio_spec 
\shape default
tag and contain sections defined in this document.
 However,
 the included file does not need to define a complete model definition.
 For instance,
 it can contain only the 
\shape italic
Mesh
\shape default
 section.
\end_layout

\begin_layout Standard
Note that the contents of the entire file will be included.
 This is different from the 
\shape italic
from 
\shape default
attribute discussed below,
 which can be used to include only certain sections from files.
\end_layout

\begin_layout Subsubsection
The 'from' Attribute
\begin_inset CommandInset label
LatexCommand label
name "subsec:The-'from'-Attribute"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
from 
\shape default
attribute can be used to include sections from other files.
 All the main sections defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Free-Format-Overview"
nolink "false"

\end_inset

 support the 
\shape italic
from 
\shape default
attribute which can be used to load the section from another input file.
 For example,
 to load the 
\shape italic
Material
\shape default
 section from the file mat.feb,
 defining the 
\shape italic
Material
\shape default
 section in the control input file as follows.
\end_layout

\begin_layout LyX-Code
<Material from="mat.feb"/>
\end_layout

\begin_layout Standard
FEBio will now read the 
\shape italic
Material
\shape default
 section from this child file.
 The child file must be a valid FEBio input file,
 meaning it must begin with the 
\shape italic
febio_spec
\shape default
 root section,
 but does not have to be complete.
 For example,
 the file mat.feb only needs to define the Material section.
 However,
 the child file may contain other sections.
 In that case,
 only the section referenced in the control file will be read from the child file.
 For example,
 if the file 
\shape italic
in.feb 
\shape default
contains both the 
\shape italic
Material
\shape default
 and the 
\shape italic
Mesh
\shape default
 section,
 the control file can read both these sections as follows.
\end_layout

\begin_layout LyX-Code
<Material from="in.feb"/>
\end_layout

\begin_layout LyX-Code
<Mesh from="in.feb"/>
\end_layout

\begin_layout Standard
To give a more concrete example,
 assume that the 
\shape italic
Material
\shape default
,
 
\shape italic
Mesh
\shape default
,
 and 
\shape italic
Boundary
\shape default
 sections are defined in the files 
\shape italic
mat.feb
\shape default
,
 
\shape italic
geom.feb
\shape default
,
 and 
\shape italic
bc.feb
\shape default
 respectively.
 The control input file could then look like the following.
\end_layout

\begin_layout LyX-Code
<febio_spec version="4.0">
\end_layout

\begin_layout LyX-Code
  <Module type="solid"/>
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
    <time_steps>10</time_steps>
\end_layout

\begin_layout LyX-Code
    <step_size>0.1</step_size>
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
  <Material from="mat.feb"/>
\end_layout

\begin_layout LyX-Code
  <Mesh from="geom.feb"/>
\end_layout

\begin_layout LyX-Code
  <Boundary from="bc.feb"/>
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard
Notice that the 
\shape italic
Control 
\shape default
section is still defined in the control file.
 The control file can contain a combination of explicit section definitions and referenced sections using the 
\shape italic
from 
\shape default
attribute.
 As mentioned above,
 the control file is used to run the model in FEBio.
 So,
 if the control file is called 
\shape italic
model.feb
\shape default
 then the model is run as follows.
\end_layout

\begin_layout LyX-Code
>febio i model.feb
\end_layout

\begin_layout Standard
When FEBio parses the control file it will automatically parse the referenced child files it encounters in the control input file.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Module Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Module-Section"

\end_inset


\end_layout

\begin_layout Standard
The module section defines the type of analysis to perform with FEBio.
 This section must be defined as the first section in the input file.
 It takes on the following format:
\end_layout

\begin_layout LyX-Code
<Module type="[type]"/>
\end_layout

\begin_layout Standard
where 
\shape italic
type
\shape default
 can be any of the following values:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Structural mechanics analysis:
 quasi-static or dynamic,
 implicit and explicit solver available 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
biphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Biphasic analysis:
 steady-state or transient
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solute
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Biphasic analysis including solute transport:
 steady-state or transient
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
multiphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Multiphasic analysis including solute transport and chemical reactions
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
heat
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Heat transfer analysis:
 steady-state or transient (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid mechanics analysis:
 steady-state or dynamic
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid-FSI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid mechanics with fluid-structure interactions:
 steady-state or dynamic
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The module tag can also be used to specify the units of the model.
 Although FEBio doesn't care about units,
 if the user specifies the unit system,
 the proper units of variables are stored in the plot file and visible in FEBio Studio when opening the plot file.
 
\end_layout

\begin_layout Standard
To specify units,
 use the following syntax:
 
\end_layout

\begin_layout LyX-Code
<Module type="[type]">
\end_layout

\begin_layout LyX-Code
  <units>[unit system]</units>
\end_layout

\begin_layout LyX-Code
</Module>
\end_layout

\begin_layout Standard
where 
\emph on
unit system
\emph default
 can be any of the following values.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
units
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Units follow the standard definition of the international SI unit system.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm-N-s
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Millimeter-Newton-seconds unit system
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm-kg-s
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Millimeter-kilogram-seconds unit system
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
um-nN-s
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Micron-nanoNewton-seconds unit system
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CGS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Centimeter-gram-seconds unit system
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
If the units are not defined,
 FEBio will not output any units for plot variables.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example:
\end_layout

\begin_layout LyX-Code
<febio_spec version="4.0">
\end_layout

\begin_layout LyX-Code
  
\series bold
<Module type="solid"/>
\end_layout

\begin_layout LyX-Code
  <!-- rest of file -->
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard
The following example defines the model's units explicitly.
 
\end_layout

\begin_layout LyX-Code
<febio_spec version="4.0">
\end_layout

\begin_layout LyX-Code
  
\series bold
<Module type="solid">
\end_layout

\begin_layout LyX-Code

\series bold
    <units>SI</units>
\end_layout

\begin_layout LyX-Code

\series bold
  </Module>
\end_layout

\begin_layout LyX-Code
  <!-- rest of file -->
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
The heat module requires the FEBioHeat plugin.
 
\end_layout

\begin_layout Standard

\emph on
Notes
\emph default
:
\end_layout

\begin_layout Enumerate
In version 1.2 the Module section was optional.
 If omitted it was assumed that the 
\shape italic
solid 
\shape default
module was used.
 Since version 2.0 the Module section is required and must be the first section in the file.
\end_layout

\begin_layout Enumerate
Older versions of FEBio (format specification 1.2 and before) allowed you to run a poroelastic (now called biphasic) problem by simply defining a poroelastic material.
 This is no longer possible.
 You need to define the proper Module section to run a biphasic analysis.
 If you have a file that no longer works as of version 1.4 of FEBio,
 you'll need to insert the following Module section in the file as the first section of the file.
\end_layout

\begin_layout LyX-Code
<febio_spec version="1.2">
\end_layout

\begin_layout LyX-Code
  <Module type="biphasic"/>
\end_layout

\begin_layout LyX-Code
  <!-- rest of the file unaltered -->
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Control Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Control-Section"

\end_inset


\end_layout

\begin_layout Standard
The control section is defined by the 
\shape italic
Control 
\shape default
element.
 This section defines all parameters that are used to control the evolution of the solution as well as parameters for the nonlinear solution procedure.
 These parameters are defined as child elements of the 
\shape italic
Control
\shape default
 element and depend somewhat on the analysis as defined by the 
\shape italic
Module
\shape default
 section.
 The control section defines the control parameters,
 the solver parameters,
 and optionally,
 the time_stepper parameters.
 
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<Control>
\end_layout

\begin_layout LyX-Code
    <analysis>STATIC</analysis>
\end_layout

\begin_layout LyX-Code
    <time_steps>50</time_steps>
\end_layout

\begin_layout LyX-Code
    <step_size>0.02</step_size>
\end_layout

\begin_layout LyX-Code
    <solver>
\end_layout

\begin_layout LyX-Code
        <max_refs>25</max_refs>
\end_layout

\begin_layout LyX-Code
        <diverge_reform>1</diverge_reform>
\end_layout

\begin_layout LyX-Code
        <reform_each_time_step>1</reform_each_time_step>
\end_layout

\begin_layout LyX-Code
        <dtol>0.001</dtol>
\end_layout

\begin_layout LyX-Code
        <etol>0.01</etol>
\end_layout

\begin_layout LyX-Code
        <rtol>0</rtol>
\end_layout

\begin_layout LyX-Code
        <lstol>0.9</lstol>
\end_layout

\begin_layout LyX-Code
        <min_residual>1e-20</min_residual>
\end_layout

\begin_layout LyX-Code
        <qn_method type="BFGS"/>
\end_layout

\begin_layout LyX-Code
            <max_ups>10</max_ups>
\end_layout

\begin_layout LyX-Code
        <rhoi>-2</rhoi>
\end_layout

\begin_layout LyX-Code
    </solver>
\end_layout

\begin_layout LyX-Code
    <time_stepper>
\end_layout

\begin_layout LyX-Code
        <dtmin>0.0002</dtmin>
\end_layout

\begin_layout LyX-Code
        <dtmax>0.02</dtmax>
\end_layout

\begin_layout LyX-Code
        <max_retries>5</max_retries>
\end_layout

\begin_layout LyX-Code
        <opt_iter>6</opt_iter>
\end_layout

\begin_layout LyX-Code
    </time_stepper>
\end_layout

\begin_layout LyX-Code
</Control>
\end_layout

\begin_layout Subsection
Control Parameters
\begin_inset CommandInset label
LatexCommand label
name "subsec:Control-Parameters"

\end_inset


\end_layout

\begin_layout Standard
The following parameters are common for all analysis types.
 If not specified they are assigned default values,
 which are found in the last column.
 An asterisk (*) after the name indicates a required parameter.
 The numbers behind the description refer to the comments following the table.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
analysis
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the analysis type (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
static 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time_steps*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total number of time steps.
 (= 
\shape italic
ntime
\shape default
)(2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
step_size*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The initial time step size.
 (= 
\shape italic
dt
\shape default
) (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the level of state dumps to the plot file (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PLOT_MAJOR_ITRS 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot_range
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the range of the states that will be stored to the plot file (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0,-1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot_stride
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the stride of the states that will be stored to the plot file (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot_zero_state
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that controls whether the 
\begin_inset Quotes eld
\end_inset

zero
\begin_inset Quotes erd
\end_inset

 state will be written to the plot file,
 even if it is not defined in the range (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the amount of output that is generated on screen (5)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_MINOR_ITRS 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
output_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Controls when to output data to file (6)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_MAJOR_ITRS 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments
\shape default
:
\end_layout

\begin_layout Enumerate
The 
\shape italic
analysis 
\shape default
element sets the analysis type.
 The text value of this element is tdetermined by the module,
 but the numeric value should be 0 for (quasi-)static or steady-state analysis and 1 for dynamic or transient analysis.
 In a quasi-static analysis,
 inertial effects are ignored and an equilibrium solution is sought.
 Note that in this analysis mode it is still possible to simulate time dependant effects such as viscoelasticity.
 In a dynamic analysis the inertial effects are included.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
static
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(quasi-) static analysis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
steady-state
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
steady-state response of a transient (quasi-static) biphasic,
 biphasic-solute,
 multiphasic,
 fluid or fluid-FSI analysis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dynamic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dynamic analysis for solid,
 fluid and fluid-FSI analyses
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The total simulation time of the analysis is determined by 
\shape italic
ntime 
\shape default
* 
\shape italic
dt
\shape default
.
 Note that when the auto-time stepper is enabled (see below),
 the actual number of time steps and time step size may be different than specified in the input file.
 However,
 the total simulation time will always be determined by 
\shape italic
ntime 
\shape default
* 
\shape italic
dt.
\end_layout

\begin_layout Enumerate
The 
\shape italic
plot_level 
\shape default
allows the user to control exactly when the solution is to be saved to the plot file.
 The following values are allowed:
 
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PLOT_NEVER
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't save the solution 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PLOT_MAJOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Save the solution after each converged timestep 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PLOT_MINOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Save the solution for every quasi-Newton iteration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PLOT_MUST_POINTS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only save the solution at the must points 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The PLOT_MUST_POINTS option must be used in conjunction of a 
\shape italic
must-point 
\shape default
curve.
 See the comments on the 
\shape italic
dtmax 
\shape default
parameter for more information on must-point curves.
 When the 
\shape italic
plot_level 
\shape default
option is set to PLOT_MUST_POINTS,
 only the time-points defined in the must-point curve are stored to the plotfile.
\end_layout

\end_deeper
\begin_layout Enumerate
When using the fixed time stepper,
 several parameters control which time steps are stored to the plot file.
 
\end_layout

\begin_deeper
\begin_layout Standard
The 
\shape italic
plot_range 
\shape default
parameter sets the range of the states that will be stored to the plot file.
 The range is defined by two values that specify the first and last time step that will be stored to the plot file.
 The value 
\begin_inset Quotes eld
\end_inset

0
\begin_inset Quotes erd
\end_inset

 refers to the initial time step,
 usually time zero,
 and negative values count backwards from the final time step (as defined by the 
\shape italic
time_steps
\shape default
 parameter).
 For instance,
 the default values,
\end_layout

\begin_layout LyX-Code
<plot_range>0,-1</plot_range>
\end_layout

\begin_layout Standard
store all time steps to the plot file,
 including the initial 
\begin_inset Quotes eld
\end_inset

zero
\begin_inset Quotes erd
\end_inset

 time step.
 As another example,
 to store only the last five time steps,
 set
\end_layout

\begin_layout LyX-Code
<plot_range>-5,-1</plot_range>
\end_layout

\begin_layout Standard
By default,
 all time steps within the range will be stored to the plot file.
 Time steps can be skipped using the 
\shape italic
plot_stride 
\shape default
parameter.
 For instance,
 to store only every 10 steps,
 set
\end_layout

\begin_layout LyX-Code
<plot_stride>10</plot_stride>
\end_layout

\begin_layout Standard
Note that the first and last time step defined by the range will always be stored,
 regardless of the plot stride.
\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

zero
\begin_inset Quotes erd
\end_inset

 time step refers to the initial state of the model,
 before any calculations are done.
 This state will only be stored to the plot file if the minimal value of the plot range is set to zero.
 To force storing this state to the plot file,
 set the 
\shape italic
plot_zero_state 
\shape default
parameter to one.
\end_layout

\begin_layout LyX-Code
<plot_zero_state>1</plot_zero_state>
\end_layout

\begin_layout Standard
This will store the zero time step to the plot file,
 even when it is not specified inside the plot range.
\end_layout

\begin_layout Standard
Again,
 the 
\shape italic
plot_range
\shape default
,
 
\shape italic
plot_stride
\shape default
,
 and 
\shape italic
plot_zero_state
\shape default
 parameters are only used by the fixed time stepper.
 Currently,
 these parameters are not used with the auto time stepper.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
print_level 
\shape default
allows the user to control exactly how much output is written to the screen.
 The following values are allowed:
 
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_NEVER
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't generate any output 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_PROGRESS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only print a progress bar 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_MAJOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only print the converged solution 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_MINOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print convergence information during equilibrium iterations 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_MINOR_ITRS_EXP
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print additional convergence info during equilib.
 iterations 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
output_level
\shape default
 can be used to control when FEBio outputs the data files.
 The following values are supported.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_NEVER
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't generate any output
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_MUST_POINTS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only output at must points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_MAJOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output at end of each time step
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_MINOR_ITRS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output at each iteration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUTPUT_FINAL
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only output the data at the last converged time step.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Time Stepper parameters
\end_layout

\begin_layout Standard
The optional 
\emph on
time_stepper 
\emph default
element sets the parameters that control the FEBio auto-time stepper.
 This auto-time stepper will adjust the time step size depending on the convergence stats of the previous time step.
 It defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dtmin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum time step size (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dtmax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum time step size (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
opt_iter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optimal,
 or desired,
 number of iterations per time step (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_retries
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of times a time step is restarted.
 (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aggressiveness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Algorithm for cutting the time step size after a failed time step (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cutback
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Time step scale factor,
 used when aggressiveness = 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
The 
\shape italic
dtmin 
\shape default
and 
\shape italic
dtmax
\shape default
 values are used to constrain the range of possible time step values.
 The 
\shape italic
opt_iter 
\shape default
defines the estimated optimal number of quasi-Newton iterations.
 If the actual number of iterations is less than or equal to this value the time step size is increased,
 otherwise it is decreased.
\end_layout

\begin_layout Enumerate
When a time step fails (e.g.
 due to a negative jacobian),
 FEBio will retry the time step with a smaller time step size.
 The 
\shape italic
max_retries 
\shape default
parameter determines the maximum number of times a timestep may be retried before FEBio error terminates.
 The new time step size is determined by the ratio of the previous time step size and 
\shape italic
max_retries+1
\shape default
.
 For example,
 if the last time step size is 0.1 and 
\shape italic
max_retries 
\shape default
is set to 4,
 then the time step size is adjusted by 0.02:
 The first retry will have a step size of 0.08;
 the next will be 0.06,
 and so on.
\end_layout

\begin_layout Enumerate
The user can specify a load curve for the 
\shape italic
dtmax 
\shape default
parameter.
 This load curve is referred to as the 
\shape italic
must-point 
\shape default
curve and serves two purposes.
 Firstly,
 it defines the value of the 
\shape italic
dtmax 
\shape default
parameter as a function of time.
 This can be useful,
 for instance,
 to enforce smaller time steps during rapid loading or larger time steps when approaching steady-state in a transient analysis.
 Secondly,
 the time points of the 
\shape italic
dtmax 
\shape default
loadcurve define so-called 
\shape italic
must-points
\shape default
.
 A must-point is a time point where FEBio must pass through.
 This is useful for synchronizing the auto-time stepper with the loading scenario.
 For instance,
 when loading starts at time 0.5,
 adding a must-point at this time will guarantee that the timestepper evaluates the model at that time.
 In conjunction with the PLOT_MUST_POINT value of the 
\shape italic
plot_level 
\shape default
parameter,
 this option can also be used to only write results to the plotfile at the specified time points.
 Consider the following example.
\end_layout

\begin_deeper
\begin_layout LyX-Code
<dtmax lc="1">0.1</dtmax>
\end_layout

\begin_layout LyX-Code
...
\end_layout

\begin_layout LyX-Code
<loadcontroller id="1" type="loadcurve">
\end_layout

\begin_layout LyX-Code
  <interpolate>STEP</interpolate>
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <point>0,0</point>
\end_layout

\begin_layout LyX-Code
      <point>0.5,
 0.1</point>
\end_layout

\begin_layout LyX-Code
      <point>1.0,
 0.2</point>
\end_layout

\begin_layout LyX-Code
    </points>
\end_layout

\begin_layout LyX-Code
</loadcontroller>
\end_layout

\begin_layout Standard
This example defines load curve 1 as the 
\shape italic
must-point 
\shape default
curve.
 This curve defines three points where FEBio will pass through (namely 0,
 0.5 and 1.0).
 The values of each time point is the value of the maximum time-step size (
\shape italic
dtmax
\shape default
).
 Since the curve is defined as a step-function,
 each value is valid up to the corresponding time-point.
 Thus,
 between time 0 and time 0.5,
 the maximum time step value is 0.1.
 Between 0.5 and 1.0 the maximum time step value is 0.2.
 If the 
\shape italic
plot_level 
\shape default
parameter is set to PLOT_MUST_POINTS,
 then only the three defined time points will be stored to the plotfile.
\end_layout

\end_deeper
\begin_layout Enumerate
When FEBio fails to converge a time step,
 the time step size is reduced and then FEBio tries to solve the time step again.
 The algorithm for determining the reduced time step size,
 depends on the 
\emph on
aggressiveness 
\emph default
parameter.
 
\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
aggressiveness = 0
\emph default
 (default):
 
\begin_inset Formula $\Delta t_{k+1}=\Delta t_{k}-(\Delta t_{k}/m_{r})$
\end_inset

,
 where 
\begin_inset Formula $m_{r}$
\end_inset

is the max numer of retries (set by the 
\emph on
max_retries 
\emph default
parameter).
\end_layout

\begin_layout Enumerate

\emph on
aggressiveness = 1:
 
\emph default

\begin_inset Formula $\Delta t_{k+1}=\gamma\Delta t_{k}$
\end_inset

,
 where 
\begin_inset Formula $\gamma$
\end_inset

 is the cutback factor (i.e.
 the 
\emph on
cutback 
\emph default
parameter).
 
\end_layout

\end_deeper
\begin_layout Subsection
Common Solver Parameters
\end_layout

\begin_layout Standard
Many of the solvers define the same parameters.
 They are listed in the table below.
 Additional parameters that are only defined for a specific type of analysis are listed in the following sections.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
etol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Convergence tolerance on energy (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rtol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Convergence tolerance on residual (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (disabled)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lstol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Convergence tolerance on line search (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lsmin
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum line search step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lsiter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of line search iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_refs
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Max number of stiffness reformations (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
qn_method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quasi-Newton update method (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BFGS
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_ups
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Max number of BFGS/Broyden stiffness updates (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cmax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the max condition number for the stiffness matrix (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e
\begin_inset Formula $+$
\end_inset

5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diverge_reform
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag for reforming stiffness matrix when the solution diverges (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
min_residual
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets minimal value for residual tolerance (6)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-20
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use symmetric stiffness matrix flag (7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
equation_scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the equation allocation scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
equation_order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the equation allocation ordering
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optimize_bw
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optimize bandwidth of stiffness matrix (5)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear_solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the preferred linear solver to use.
 (8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(default)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
FEBio determines convergence of a time step based on three convergence criteria:
 displacement,
 residual and energy (that is,
 residual multiplied by displacement).
 Each of these criteria requires a tolerance value that will determine convergence when the relative change will drop below this value.
 For example,
 a displacement tolerance of 
\begin_inset Formula $\varepsilon$
\end_inset

 means that the ratio of the displacement increment (i.e.
 the solution of the linearized FE equations,
 
\begin_inset Formula $\Delta\mathbf{U}=-\mathbf{K}_{k}^{-1}\mathbf{R}_{k})$
\end_inset

 norm at the current iteration 
\begin_inset Formula $k+$
\end_inset


\shape italic
1
\shape default
 to the norm of the total displacement (
\begin_inset Formula $\mathbf{U}_{k+1}=\mathbf{U}_{k}+\Delta\mathbf{U})$
\end_inset

 must be less than 
\begin_inset Formula $\varepsilon$
\end_inset

:
\begin_inset Formula 
\[
\frac{\left\Vert \Delta\mathbf{U}\right\Vert }{\left\Vert \mathbf{U}_{k+1}\right\Vert }<\varepsilon
\]

\end_inset

For the residual and energy norms,
 it is the ratio of the current residual norm (resp.
 energy norm) to the initial one that needs to be less than the specified convergence tolerance.
\end_layout

\begin_deeper
\begin_layout Standard
To disable a specific convergence criterion,
 set the corresponding tolerance to zero.
 For example,
 by default,
 the residual tolerance is zero,
 so that this convergence criterion is not used.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
lstol
\shape default
 parameter controls the scaling of the vector direction obtained from the line search.
 A line search method is used to improve the convergence of the nonlinear (quasi-) Newton solution algorithm.
 After each BFGS or Newton iteration,
 this algorithm searches in the direction of the displacement increment for a solution that has less energy (that is,
 residual multiplied with the displacement increment) than the previous iteration.
 In many problems this will automatically be the case.
 However,
 in some problems that are very nonlinear (e.g.
 contact),
 the line search can improve convergence significantly.
 The line search can be disabled by setting the 
\shape italic
lstol
\shape default
 parameter to zero,
 although this is not recommended.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
qn_method
\emph default
 property determines the quasi-Newton update method.
 The particular method is set via the 
\emph on
type 
\emph default
attribute.
 Additional parameters are then specified as child elements of this tag.

\shape italic
\emph on
 
\shape default
\emph default
See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Quasi-Newton-Solver-Parameters"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details.
\end_layout

\begin_layout Enumerate
When the condition number of the stiffness matrix becomes too large,
 inversions of the stiffness matrix become inaccurate.
 This will negatively affect the convergence of the quasi-Newton or Newton solution algorithm.
 FEBio monitors the condition number of the BFGS stiffness update and when it exceeds 
\shape italic
cmax 
\shape default
it reforms the stiffness matrix.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<cmax>1e5</cmax>
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
optimize_bw
\shape default
 parameter enables bandwidth minimization for the global stiffness matrix.
 This can drastically decrease the memory requirements and running times when using the skyline solver.
 It is highly recommended when using the skyline solver.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<optimize_bw>1</optimize_bw>
\end_layout

\begin_layout Standard
When using a different linear solver (e.g.,
 pardiso or SuperLU),
 the bandwidth optimization can still be performed if so desired.
 However,
 for these solvers there will be little or no effect since these solvers are not as sensitive to the bandwidth as the skyline solver.
\end_layout

\end_deeper
\begin_layout Enumerate
If no force is acting on the model,
 then convergence might be problematic due to numerical noise in the calculations.
 For example,
 this can happen in a displacement driven contact problem where one of the contacting bodies is moved before initial contact is made.
 When this happens,
 the residual norm will be very small.
 When it drops below the tolerance set by 
\shape italic
min_residual
\shape default
,
 FEBio will assume that there is no force acting on the system and will converge the time step.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
symmetric_stiffness 
\emph default
flag is used to set the symmetry of the global stiffness matrix.
 Only specify this flag if you want to override the default symmetry,
 which depends somewhat on the analysis type.
 Forcing a symmetric matrix when the problem is non-symmetric may have negative impact on convergence.
 The values for this parameter are:
\begin_inset Newline newline
\end_inset

- 0 = unsymmetic
\begin_inset Newline newline
\end_inset

- 1 = symmetric
\begin_inset Newline newline
\end_inset

- 2 = structurally symmetric
\end_layout

\begin_layout Enumerate
For portability reasons,
 the preferred method of setting the linear solver is in the FEBio configuration file,
 but it can also be specified in the solver section.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Configuring-Linear-Solvers"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details on configuring linear solvers.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<linear_solver type="pardiso"/>
\end_layout

\end_deeper
\begin_layout Subsection
Quasi-Newton Solver Parameters
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quasi-Newton-Solver-Parameters"

\end_inset


\end_layout

\begin_layout Standard
Most solvers in FEBio use the quasi-Newton method for solving the nonlinear FE equations.
 Several different QN algorithms are implemented as described below.
 The specific QN method is selected using the 
\emph on
qn_method
\emph default
 property of the 
\emph on
solver
\emph default
.
 The following QN methods are supported.
 
\end_layout

\begin_layout Description
BFGS The Broyden-Fletcher-G-S method.
 (default if qn_method is not specified).
 This method assumes the global stiffness matrix is symmetric.
 It can still be used with nonsymmetric matrices,
 but the convergence might be compromised.
 
\end_layout

\begin_layout Description
Broyden The Broyden method is similar to BFGS,
 but works with both symmetric and non-symmetric matrices.
 Therefore,
 it is the recommended method for problems that generate a non-symmetric stiffness matrix,
 such as (some) contact formulations,
 biphasic,
 multi-phasic,
 fluid,
 fluid FSI.
 
\end_layout

\begin_layout Description
JFNK This is an implementation of the Jacobian-Free-Newton-Krylov method.
 When using this option,
 you must also use an iterative linear solver such as FGMRES.
 
\end_layout

\begin_layout Standard
Both the BFGS and Broyden methods calculate the global stiffness matrix at the beginning of each time step.
 For each iteration,
 a matrix update is then done.
 The maximum number of such updates is set with 
\shape italic
max_ups
\shape default
.
 When FEBio reaches this number,
 or if the solution diverges and 
\emph on
diverge_reform
\emph default
 is set to 1,
 it reforms the global stiffness matrix (that is,
 it recalculates it) and factorizes it,
 essentially taking a "full Newton" iteration.
 Then FEBio continues with BFGS/Broyden iterations.
 The 
\shape italic
max_refs 
\shape default
parameter is used to set the maximum of such reformations FEBio can do,
 before it fails the timestep.
 In that case,
 FEBio will either terminate or,
 if the auto-time stepper is enabled,
 retry with a smaller time step size.
 
\end_layout

\begin_layout Standard
The BFGS and Broyden take the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_ups
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
\emph on
This is the maximum number of updates between stiffness matrix reformations.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Note that when max_ups is set to 0,
 FEBio effectively will use a Full-Newton method since the stiffness matrix is reformed each iteration.
 In this case it is recommended to increase the number of 
\shape italic
max_refs 
\shape default
(to e.g.
 50),
 since the default value might cause FEBio to terminate prematurely when convergence is slow.
\end_layout

\begin_layout Subsection
Solver Parameters for a Structural Mechanics Analysis
\begin_inset CommandInset label
LatexCommand label
name "subsec:Parameters-Solid-Analysis"

\end_inset


\end_layout

\begin_layout Standard
A structural mechanics analysis is defined by using the 
\shape italic
solid 
\shape default
type in Module section.
 The solver parameters are given in the table below:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dtol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance on displacement
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
When using the 
\begin_inset Quotes eld
\end_inset

CG-solid
\begin_inset Quotes erd
\end_inset

 solver,
 the following parameters are defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cgmethod
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Select solution algorithm (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
preconditioner
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Select the preconditioner (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lsiter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of line search iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The solution algorithm can be:
\end_layout

\begin_deeper
\begin_layout Enumerate
0 :
 Hager-Zhang conjugate gradient (This is the default and should be preferred since its faster.)
\end_layout

\begin_layout Enumerate
1 :
 steepest descent
\end_layout

\end_deeper
\begin_layout Enumerate
Set 0 for no preconditioner,
 1 for diagonal stiffness preconditioner.
 The diagonal stiffness preconditioner greatly improves convergence when there are different size elements,
 mixed materials,
 or quadratic elements with midside nodes.
 
\end_layout

\begin_layout LyX-Code
<solver type="CG-solid">
\end_layout

\begin_layout LyX-Code
  <cgmethod>0</cgmethod>
\end_layout

\begin_layout LyX-Code
  <preconditioner>1</preconditioner>
\end_layout

\begin_layout LyX-Code
  <lsiter>10</lsiter>
\end_layout

\begin_layout LyX-Code
</solver>
\end_layout

\begin_layout Subsection
Solver Parameters for Biphasic Analysis
\begin_inset CommandInset label
LatexCommand label
name "subsec:Parameters-Biphasic-Analysis"

\end_inset


\end_layout

\begin_layout Standard
A biphasic analysis is defined by using the 
\shape italic
biphasic 
\shape default
type in Module section.
 Since a biphasic analysis couples a fluid problem to a solid mechanics problem,
 all control parameters above can be used in a biphasic analysis.
 In addition,
 the following parameters can be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ptol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the fluid pressure convergence tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Solver Parameters for Solute and Multiphasic Analyses
\begin_inset CommandInset label
LatexCommand label
name "subsec:Parameters-Solute-Analysis"

\end_inset


\end_layout

\begin_layout Standard
When the type attribute of the Module section is set to 
\shape italic
solute
\shape default
 or 
\emph on
multiphasic
\emph default
,
 an analysis is solved that includes solute transport.
 All parameters for a biphasic analysis can be used (including the ones for a structural mechanics analysis).
 In addition,
 the following parameters can be specified:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ctol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the concentration convergence tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Solver Parameters for Heat Analysis
\begin_inset CommandInset label
LatexCommand label
name "subsec:Parameters-Heat-Analysis"

\end_inset


\end_layout

\begin_layout Standard
A heat analysis uses the parameters defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Control-Parameters"
nolink "false"

\end_inset

.
 However,
 not all parameters have an effect.
 In particular,
 any parameter related to the auto-time stepping capability of FEBio or the nonlinear solution strategy is ignored.
\end_layout

\begin_layout Subsection
Solver Parameters for Fluid and Fluid-FSI Analyses
\end_layout

\begin_layout Standard
A fluid analysis is defined by using the 
\emph on
fluid
\emph default
 type in Module section (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Module-Section"
nolink "false"

\end_inset

).
 In addition to the common parameters,
 the following parameters can be specified:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vtol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance on velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ftol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance on dilatation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rhoi
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spectral radius parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reform_each_time_step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag for reforming stiffness matrix at the start of each time step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
A fluid-structure interaction analysis is defined by using the 
\emph on
fluid-FSI
\emph default
 type in Module section.
 It uses the parameters of 
\emph on
solid
\emph default
 and 
\emph on
fluid
\emph default
 analyses.
\end_layout

\begin_layout Standard
Transient fluid and fluid-FSI analyses may often run very efficiently using Broyden's method (
\emph on
qnmethod
\emph default
 set to 1) with 
\emph on
max_ups
\emph default
 set to 50;
 efficiency may be further increased by setting 
\emph on
reform_each_time_step
\emph default
 to 0,
 which will postpone reforming the stiffness matrix at subsequent time steps until 
\emph on
max_ups
\emph default
 updates have been exhausted.
 When using Broyden's method with fluid and fluid-FSI analyses,
 set 
\emph on
rtol
\emph default
 to a non-zero value to ensure an accurate solution,
 for example 
\emph on
rtol
\emph default
=0.001 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Control-Parameters"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
The spectral radius parameter 
\begin_inset Formula $\rho_{\infty}$
\end_inset

 determines the time integration scheme:
 Values in the range 
\begin_inset Formula $0\le\rho_{\infty}\le1$
\end_inset

 use the generalized 
\begin_inset Formula $\alpha-$
\end_inset

method (see 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

).
 With 
\begin_inset Formula $\rho_{\infty}=0$
\end_inset

,
 damping of higher frequency components (such as those produced by a step increase in velocity) occurs theoretically within a single time step;
 in contrast,
 with 
\begin_inset Formula $\rho_{\infty}=1$
\end_inset

,
 no damping occurs,
 potentially leading to instability in the solution process.
 When solving transient flows that exhibit eddies or shed vorticies,
 a value of 
\begin_inset Formula $\rho_{\infty}=0.5$
\end_inset

 represents a good balance between too much and too little numerical damping.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Globals Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Globals-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Globals
\shape default
 section is used to define some global variables,
 such as global constants,
 solute data and solid bound molecule data,
 as well user-defined global variables.
\end_layout

\begin_layout Subsection
Constants
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constants"

\end_inset


\end_layout

\begin_layout Standard
Global constants are predefined variables that some modules may rely on and currently include the universal gas constant 
\begin_inset Formula $R$
\end_inset

 [
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default
/
\series bold
n
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
T
\series default
],
 absolute temperature 
\begin_inset Formula $\theta$
\end_inset

 [
\series bold
T
\series default
],
 and Faraday constant 
\begin_inset Formula $F_{c}$
\end_inset

 [
\series bold
Q
\series default
/
\series bold
n
\series default
].
 These constants must be expressed in units consistent with the rest of the analysis:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-6</R>
\end_layout

\begin_layout LyX-Code
    <T>298</T>
\end_layout

\begin_layout LyX-Code
    <Fc>96485e-9</Fc>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Subsection
Solutes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solutes"

\end_inset


\end_layout

\begin_layout Standard
In biphasic-solute,
 triphasic,
 and multiphasic analyses,
 a unique identifier must be associated with each solute in order to enforce consistent nodal degrees of freedom across boundaries of different materials.
 This unique identification is achieved by listing each solute species that appears in the entire finite element model and associating it with a unique 
\shape italic
id
\shape default
,
 
\shape italic
name
\emph on
,
 and providing its
\shape default
\emph default
 charge number 
\begin_inset Formula $z^{\alpha}$
\end_inset

,
 molar mass 
\begin_inset Formula $M^{\alpha}$
\end_inset

,
 and density 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Solutes>
\end_layout

\begin_layout LyX-Code
    <solute id="1" name="Na">
\end_layout

\begin_layout LyX-Code
      <charge_number>1</charge_number>
\end_layout

\begin_layout LyX-Code
      <molar_mass>22.99</molar_mass>
\end_layout

\begin_layout LyX-Code
      <density>0.97</density>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
    <solute id="2" name="Cl">
\end_layout

\begin_layout LyX-Code
      <charge_number>-1</charge_number>
\end_layout

\begin_layout LyX-Code
      <molar_mass>35.45</molar_mass>
\end_layout

\begin_layout LyX-Code
      <density>3.21</density>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
    <solute id="3" name="Glc">
\end_layout

\begin_layout LyX-Code
      <charge_number>0</charge_number>
\end_layout

\begin_layout LyX-Code
      <molar_mass>180.16</molar_mass>
\end_layout

\begin_layout LyX-Code
      <density>1.54</density>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
  </Solutes>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
These solute identification numbers should be referenced in the 
\shape italic
sol
\shape default
 attribute of solutes when defining a biphasic-solute (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-BS-Materials"
nolink "false"

\end_inset

),
 triphasic or multiphasic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Multiphasic-Mat"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
The molar mass and density of solutes are needed only when solutes are involved in chemical reactions.
 When not specified,
 default values for these properties are set to 1.
\end_layout

\begin_layout Subsection
Solid-Bound Molecules
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-Bound-Molecules"

\end_inset


\end_layout

\begin_layout Standard
In multiphasic analyses with chemical reactions involving solid-bound molecules,
 a unique identifier must be associated with each such molecule in order to enforce consistent properties across the entire model.
 This unique identification is achieved by listing each solid-bound species that appears in the entire finite element model and associating it with a unique 
\shape italic
id
\shape default
,
 
\shape italic
name,

\shape default
 charge number,
 molar mass and density:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <SolidBoundMolecules>
\end_layout

\begin_layout LyX-Code
    <solid_bound id="1" name="CS">
\end_layout

\begin_layout LyX-Code
      <charge_number>-2</charge_number>
\end_layout

\begin_layout LyX-Code
      <molar_mass>463.37</molar_mass>
\end_layout

\begin_layout LyX-Code
      <density>1.5<density>
\end_layout

\begin_layout LyX-Code
    </solid_bound >
\end_layout

\begin_layout LyX-Code
  </SolidBoundMolecules >
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
The 
\shape italic
id
\shape default
 number should be referenced in the 
\shape italic
sbm
\shape default
 attribute of solid-bound molecules when included in the definition of a multiphasic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
nolink "false"

\end_inset

).
 The charge number is used in the calculation of the fixed charge density contributed by this solid-bound molecule to the overall solid matrix fixed-charge density.
 The density is used in the calculation of the contribution of this molecule to the referential solid volume fraction.
 The density and molar mass are used in the calculation of the molar volume of this molecule in chemical reactions.
\end_layout

\begin_layout Subsection
User Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:User-Variables"

\end_inset


\end_layout

\begin_layout Standard
Users can define custom,
 global variables,
 that can be referenced in other model parameters.
 This offers a convenient way to parameterize a model.
 Global user variables can also be used in optimizations.
 Currently,
 only scalar values can be defined.
 User variables are defined in the 
\emph on
Variables 
\emph default
child element.
 
\end_layout

\begin_layout Standard
To define a global variable,
 specify the 
\emph on
var 
\emph default
element,
 add the 
\emph on
name 
\emph default
attribute to name the variable,
 and specify the variable's value as the tag's value.
 
\end_layout

\begin_layout Standard
The following example defines a global variable,
 called A,
 and assigns the value 1.23 to it.
 
\end_layout

\begin_layout LyX-Code
<Variables>
\end_layout

\begin_layout LyX-Code

\series bold
  <var name="A">1.23</var>
\end_layout

\begin_layout LyX-Code
</Variables>
\end_layout

\begin_layout Standard
As mentioned,
 these global variables can be used to define other model variables,
 for example,
 in variables that are defined with mathematical expressions.
 To use a global variable,
 prefix the name with 'fem.'.
 
\end_layout

\begin_layout LyX-Code
<Material>
\end_layout

\begin_layout LyX-Code
  <material name="mymat" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code

\series bold
    <E type="math">3*fem.A</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </material>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Material Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Material-Section"

\end_inset


\end_layout

\begin_layout Standard
The material section is defined by the 
\shape italic
Material
\shape default
 element.
 This section defines all the materials and material parameters that are used in the model.
 A material is defined by the 
\shape italic
material
\shape default
 child element.
 This element has two attributes:
 
\shape italic
id,

\shape default
 which specifies a number that is used to reference the material,
 and 
\shape italic
type
\shape default
,
 which specifies the type of the material.
 The 
\shape italic
material
\shape default
 element can also have a third optional attribute called 
\shape italic
name
\shape default
,
 which can be used to identify the material by a text description.
 A material definition might look like this:
\end_layout

\begin_layout LyX-Code
<material id="1" type="isotropic elastic">
\end_layout

\begin_layout Standard
Or,
 if the optional 
\shape italic
name
\shape default
 attribute is present:
\end_layout

\begin_layout LyX-Code
<material id="2" type="rigid body" name="femur">
\end_layout

\begin_layout Standard
The material parameters that have to be entered depend on the material type.
 A complete list of available materials is provided in Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Mesh Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Geometry-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
Mesh 
\emph default
section contains all the mesh data,
 including nodal coordinates and element connectivity.
 It has the following sub-sections:
\end_layout

\begin_layout Description
Nodes defines the nodal coordinates of the mesh
\end_layout

\begin_layout Description

\series bold
Elements 
\series default
defines the elements of the mesh
\end_layout

\begin_layout Description

\shape italic
\emph on
NodeSet
\shape default
\emph default
 defines a node set 
\end_layout

\begin_layout Description

\shape italic
\emph on
Edge
\shape default
\emph default
 defines an edge,
 i.e.
 a set of line elements 
\end_layout

\begin_layout Description

\shape italic
\emph on
Surface
\shape default
\emph default
 defines a surface,
 i.e.
 a set of facets 
\end_layout

\begin_layout Description

\shape italic
\emph on
DiscreteSet
\emph default
 
\shape default
defines a set of discrete elements (e.g.
 springs) 
\end_layout

\begin_layout Description

\shape italic
\emph on
ElementSet
\shape default
\emph default
 defines an element set 
\end_layout

\begin_layout Description

\shape italic
\emph on
SurfacePair
\emph default
 
\shape default
define a surface pair that can be used by a contact definition.
 
\end_layout

\begin_layout Standard
At least one 
\emph on
Nodes 
\emph default
must be defined and one 
\emph on
Elements
\emph default
 section.
 The other sections are optional.
 The 
\shape italic
NodeSet
\shape default
,
 
\shape italic
Edge
\shape default
,
 
\shape italic
Surface
\shape default
,
 
\shape italic
DiscreteSet
\shape default
,
 
\shape italic
ElementSet
\shape default
,
 and 
\shape italic
SurfacePair 
\shape default
sections define sets of nodes,
 edges,
 facets,
 discrete elements,
 elements,
 and surface pairs,
 respectively,
 and can be referenced by other sections of the model file.
 For instsance,
 boundary conditions can be defined by referencing the sets to which the boundary condition will be applied.
\end_layout

\begin_layout Subsection
Nodes Section
\end_layout

\begin_layout Standard
The 
\shape italic
Nodes 
\shape default
section contains nodal coordinates.
 It has an optional attribute called 
\shape italic
name
\shape default
.
 If this attribute is defined,
 the 
\shape italic
Nodes 
\shape default
section also defines a node set.
\end_layout

\begin_layout LyX-Code
<Nodes [name="<set name>"]>
\end_layout

\begin_layout Standard
The nodes are defined using the 
\shape italic
node 
\shape default
tag which is a child of the 
\shape italic
Nodes 
\shape default
section.
 Repeat the following XML-element for each node:
\end_layout

\begin_layout LyX-Code
<node id="n">x,y,z</node>
\end_layout

\begin_layout Standard
The 
\shape italic
id
\shape default
 attribute is the global identifier of the node and must be a unique number within the model definition.
 This 
\shape italic
id
\shape default
 is used as a reference in the element connectivity section.
\end_layout

\begin_layout Standard
Multiple 
\shape italic
Nodes 
\shape default
sections can be defined,
 but each node can only be defined once.
 For example:
\end_layout

\begin_layout LyX-Code
<Nodes name="set01">
\end_layout

\begin_layout LyX-Code
  <node id="1">0,0,0</node>
\end_layout

\begin_layout LyX-Code
  ...
\end_layout

\begin_layout LyX-Code
  <node id="101">1,1,1</node>
\end_layout

\begin_layout LyX-Code
</Nodes>
\end_layout

\begin_layout LyX-Code
<Nodes name ="set02">
\end_layout

\begin_layout LyX-Code
  <node id="102">2,1,1</node>
\end_layout

\begin_layout LyX-Code
  ...
\end_layout

\begin_layout LyX-Code
  <node id="999">2,2,2</node>
\end_layout

\begin_layout LyX-Code
</Nodes>
\end_layout

\begin_layout Subsection
Elements Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elements-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Elements
\shape default
 sections contain a list of the element connectivity data.
 Multiple 
\shape italic
Elements 
\shape default
sections can be defined.
 The 
\shape italic
Elements 
\shape default
section has the following attributes.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Attribute
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element type 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
name
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unique name that identifies this domain 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Each 
\shape italic
Elements 
\shape default
section contains multiple 
\shape italic
elem 
\shape default
elements that define the element connectivities.
 Each 
\shape italic
elem 
\shape default
tag has a 
\shape italic
id 
\shape default
attribute that defines the element number.
 For example,
 the following 
\shape italic
Elements
\shape default
 section defines a list of hexahedral elements:
\end_layout

\begin_layout LyX-Code
<Elements type="hex8" name="part1">
\end_layout

\begin_layout LyX-Code
  <elem id="1">1,2,3,4,5,6,7,8</elem>
\end_layout

\begin_layout LyX-Code
  <elem id="2">9,10,11,12,13,14,15,16</elem>
\end_layout

\begin_layout LyX-Code
  ...
\end_layout

\begin_layout LyX-Code
</Elements>
\end_layout

\begin_layout Standard
FEBio classifies elements in two categories,
 namely 
\shape italic
solids 
\shape default
and 
\shape italic
shells
\shape default
.
\end_layout

\begin_layout Subsubsection
Solid Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-Elements"

\end_inset


\end_layout

\begin_layout Standard
The following solid element types are defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hex8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8-node trilinear hexahedral element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hex20
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20-node quadratic hexahedral elements 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hex27
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27-node quadratic hexahedral elements 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penta6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-node linear pentahedral (wedge) element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penta15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15-node quadratic pentahedral (wedge) element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pyra5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5-node linear pyramidal element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pyra13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13-node quadratic pyramidal element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tet4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node linear tetrahedral element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tet10
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10-node quadratic tetrahedral element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tet15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15-node quadratic tetrahedral element 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The node numbering has to be defined as in the figure below.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigNodeNumberingSolidElements.png
	lyxscale 50
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Node numbering for solid elements
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Shell Elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shell-Elements"

\end_inset


\end_layout

\begin_layout Standard
FEBio currently supports the following shell elements:
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tri3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3-node linear triangular shell element (compatible strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tri6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-node quadratic triangular shell element (compatible strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
quad4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node linear quadrilateral shell element (compatible strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
quad8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8-node quadratic quadrilateral shell element (compatible strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
quad9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9-node quadratic quadrilateral shell element (compatible strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q4ans
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node linear quadrilateral shell element (assumed natural strain)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q4eas
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node linear quadrilateral shell element (enhanced assumed strain)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For shell elements that use a 
\emph on
compatible strain
\emph default
 formulation,
 the calculation of strain components is based on nodal displacements,
 similar to hexahedral or pentrahedral elements.
 Users should be aware that this compatible strain formulation is very susceptible to element locking when the shell thickness is much smaller than the shell size (e.g.,
 when the aspect ratio is less than 0.01).
 Therefore,
 these shell formulations should be used with caution,
 keeping in mind this important constraint.
 Conversely,
 these shell elements perform very well when they are attached to solid elements (e.g.,
 skin over muscle),
 or sandwiched between shell elements (e.g.,
 cell membrane separating cytoplasm from extra-cellular matrix),
 as described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou18"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigNodeNumberingShellElements.png
	lyxscale 50
	scale 75

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
Node numbering for shell elements
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The element-locking limitation of compatible strain shell formulations has motivated the development of specialized shell formulations that attempt to overcome locking.
 The FE literature on this subject is rather extensive and we refer the reader to the excellent review chapter by Bischoff et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Bischoff18"
literal "true"

\end_inset

 on this topic.
 Methods for overcoming locking include the assumed natural strain (ANS) formulation for transverse shear strains 
\begin_inset CommandInset citation
LatexCommand citep
key "MacNeal78,Bathe86"
literal "true"

\end_inset

 and transverse normal strains 
\begin_inset CommandInset citation
LatexCommand citep
key "Betsch95,Bischoff97"
literal "true"

\end_inset

.
 The ANS formulation may be supplemented with the enhanced assumed strain (EAS) method 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo90"
literal "true"

\end_inset

 and extended to large deformations 
\begin_inset CommandInset citation
LatexCommand citep
key "Klinkel99,Vu-Quoc03,Simo93"
literal "true"

\end_inset

.
 FEBio includes the ANS (
\emph on
q4ans
\emph default
) and EAS (
\emph on
q4eas
\emph default
) quadrilateral shell element formulations of Vu-Quoc and Tan 
\begin_inset CommandInset citation
LatexCommand citep
key "Vu-Quoc03"
literal "true"

\end_inset

,
 using a seven-parameter EAS interpolation,
 which is otherwise substantially similar to the five-parameter interpolation presented in an earlier study by Klinkel et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Klinkel99"
literal "true"

\end_inset

.
 These shell elements are not suitable for attachment to a solid element,
 nor sandwiching between two solid elements.
 Since they don't experience element locking,
 they should be loaded more slowly than compatible strain shell elements.
 The most accurate of these shell formulation is 
\emph on
q4eas
\emph default
.
\end_layout

\begin_layout Standard
By default,
 the nodes of a shell element define its 
\emph on
front
\emph default
 face.
 The location of the shell element 
\emph on
back
\emph default
 face is calculated from the nodal values of the shell thickness,
 along the opposite direction of nodal normals.
 The nodal normal is evaluated by averaging the front face normal of all shell elements sharing that node.
 When a shell element is attached to a solid element (e.g.,
 when the shell nodes also represent the nodes of one face of the solid element),
 FEBio automatically accounts for the shell thickness,
 reducing the height of the solid element in the direction of the shell normal.
 It is the user's responsibility to ensure that the shell thickness is less than that of the solid element;
 otherwise,
 a negative Jacobian error will be automatically generated.
\end_layout

\begin_layout Standard
Prior to FEBio 2.6,
 the nodes of a shell element defined its 
\emph on
middle
\emph default
 face (halfway between front and back,
 such that the shell element extends above and below the face defined by the shell nodes).
 This older formulation can be recovered by setting 
\emph on
shell_formulation
\emph default
 to 0 in the 
\emph on
Control
\emph default
 section.
 This setting only works with compatible strain shell formulations.
\end_layout

\begin_layout Standard
When shell domains intersect such that three or more shell elements share the same edge,
 as in a T-connection,
 users should set 
\emph on
shell_normal_nodal
\emph default
 to 0 in the 
\emph on
Control
\emph default
 section.
 This setting ensures that the back face of a shell element is calculated using the front face normal,
 instead of nodal normals,
 since the latter would be ill-defined for nodes belonging to such an edge.
\end_layout

\begin_layout Standard
Finally,
 please note that shell elements cannot be stacked in FEBio.
\end_layout

\begin_layout Subsection
NodeSet Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:NodeSet-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
NodeSet 
\shape default
section allows users to define node sets.
 These node sets can then later be used in the definition of the fixed and prescribed boundary conditions.
 A node set is defined by the 
\shape italic
NodeSet 
\shape default
tag.
 This tag takes one required attribute,
 
\shape italic
name
\shape default
,
 which defines the name of the node set.
 A node set definition is followed by a list of node IDs.
 For example,
\end_layout

\begin_layout LyX-Code
<NodeSet name="nodeset1">1,
 2,
 101,
 102</NodeSet>
\end_layout

\begin_layout Standard
For larger nodesets,
 it is recommended to split the list across several lines.
 
\end_layout

\begin_layout LyX-Code
<NodeSet name="nodeset1">
\end_layout

\begin_layout LyX-Code
   1,
 2,
 3,
 4,
\end_layout

\begin_layout LyX-Code
   5,
 6,
 7,
 8,
\end_layout

\begin_layout LyX-Code
   9,
 10,
 11,
 12
\end_layout

\begin_layout LyX-Code
</NodeSet>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Subsection
Edge Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Edge-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Edge 
\shape default
section allows users to define a set of edges.
 These edges can be used to define boundary conditions or load.s
\end_layout

\begin_layout LyX-Code
<Edge name="edge1">
\end_layout

\begin_layout LyX-Code
  <line2 lid="1">1,2</line2>
\end_layout

\begin_layout LyX-Code
  <line2 lid="2">2,3</line2>
\end_layout

\begin_layout LyX-Code
</Edge>
\end_layout

\begin_layout Standard
Here,
 the 
\shape italic
lid 
\shape default
attribute defines the 
\shape italic
local 
\shape default
id of the edge,
 local with respect to the edge definition.
 The local ids must begin at 1 and defined sequentially.
\end_layout

\begin_layout Standard
The edge elements are defined by using a tag that depends on the type of the edge element.
 The following edge elements are currently supported.
\end_layout

\begin_layout Description

\shape italic
line2
\shape default
 2-node line element 
\end_layout

\begin_layout Description

\shape italic
line3
\shape default
 3-node line element 
\end_layout

\begin_layout Subsection
Surface Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Surface-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Surface 
\shape default
section allows users to define surfaces.
 These surfaces can then later be used to define the boundary conditions and contact definitions.
 A surface definition is followed by a list of surface elements,
 following the format described below.
\end_layout

\begin_layout LyX-Code
<Surface name="named_surface">
\end_layout

\begin_layout LyX-Code
  <quad4 id="1">1,2,3,4</quad4>
\end_layout

\begin_layout LyX-Code
  <...>
\end_layout

\begin_layout LyX-Code
</Surface>
\end_layout

\begin_layout Standard
The 
\shape italic
Surface 
\shape default
takes one required attribute,
 namely the 
\shape italic
name
\shape default
.
 This attribute sets the name of the surface.
 This name will be used later to refer back to this surface.
\end_layout

\begin_layout Standard
The following surface elements are available:
\end_layout

\begin_layout Description

\shape italic
quad4
\shape default
 4-node quadrilateral element 
\end_layout

\begin_layout Description

\shape italic
quad8
\shape default
 8-node serendipity quadrilater element 
\end_layout

\begin_layout Description

\shape italic
tri3
\shape default
 3-node triangular element 
\end_layout

\begin_layout Description

\shape italic
tri6
\shape default
 6-node quadratic triangular element 
\end_layout

\begin_layout Description

\shape italic
tri7
\shape default
 7-node quadratic triangular element 
\end_layout

\begin_layout Standard
The value for the surface element is the nodal connectivity:
\end_layout

\begin_layout LyX-Code
<quad4 id="n">n1,n2,n3,n4</quad4>
\end_layout

\begin_layout LyX-Code
<tri3 id="n">n1,n2,n3</tri3>
\end_layout

\begin_layout Standard
Surface elements cannot overlap element boundaries.
 That is,
 the surface element must belong to a specific element.
 Surface elements do not contribute to the total number of elements in the mesh.
 They are also not to be confused with shell elements.
\end_layout

\begin_layout Subsection
ElementSet Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:ElementSet-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
ElementSet 
\shape default
section can be used to define an element set.
 Element sets can be used to output data for only a subset of elements.
 An element set is defined through the 
\shape italic
ElementSet 
\shape default
tag,
 which takes one attribute,
 namely 
\shape italic
name
\shape default
 that specifies the name of the element set.
 The value of the tag is the list of element IDs.
 For example,
\end_layout

\begin_layout LyX-Code
<ElementSet name="set01">
\end_layout

\begin_layout LyX-Code
  1,
 2,
 3,
 4
\end_layout

\begin_layout LyX-Code
  5,
 6,
 7,
 8
\end_layout

\begin_layout LyX-Code
</ElementSet>
\end_layout

\begin_layout Subsection
DiscreteSet Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:DiscreteSet-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
DiscreteSet 
\shape default
section defines sets of discrete elements.
 These sets can then be used to define e.g.
 springs.
\end_layout

\begin_layout LyX-Code
<DiscreteSet name="springs">
\end_layout

\begin_layout LyX-Code
  <delem>1,2</delem>
\end_layout

\begin_layout LyX-Code
  <delem>3,4</delem>
\end_layout

\begin_layout LyX-Code
</DiscreteSet>
\end_layout

\begin_layout Subsection
SurfacePair Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:SurfacePair-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
SurfacePair 
\shape default
section defines a pair of surfaces that can be used to define surface-to-surface interactions (e.g.
 contact).
\end_layout

\begin_layout LyX-Code
<SurfacePair name="contact1">
\end_layout

\begin_layout LyX-Code
  <primary>surface1</primary>
\end_layout

\begin_layout LyX-Code
  <secondary>surface2</secondary>
\end_layout

\begin_layout LyX-Code
</SurfacePair>
\end_layout

\begin_layout Standard
The surfaces (i.e.
 
\shape italic
surface1 
\shape default
and 
\shape italic
surface2
\shape default
) are surfaces defined in the 
\shape italic
Surface 
\shape default
section.
 Because surfaces must already be defined before they can be referenced in the 
\shape italic
SurfacePair 
\shape default
section,
 the 
\shape italic
Surface 
\shape default
must be defined before the 
\shape italic
SurfacePair 
\shape default
section.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
MeshDomains Section
\end_layout

\begin_layout Standard
The 
\emph on
MeshDomains 
\emph default
section assigns various physical attributes to the element sets of the mesh.
 For each of the 
\emph on
Elements 
\emph default
sections in the 
\emph on
Mesh 
\emph default
section,
 define a 
\emph on
SolidDomain 
\emph default
or a 
\emph on
ShellDomain 
\emph default
section,
 depending on whether the elements are solid or shells.
 Each domain also requires a material name that defines the material properties of the domain.
 
\end_layout

\begin_layout Subsection
SolidDomain Section
\end_layout

\begin_layout Standard
Use the 
\emph on
SolidDomain 
\emph default
section to define a solid domain.
 This section takes the following parameters:
 
\end_layout

\begin_layout Description

\series bold
name 
\series default
The name of the element set (defined via an 
\emph on
Elements 
\emph default
section).
 This element set must only contain solid elements.
 
\end_layout

\begin_layout Description
mat The name of the material that will be assigned to this domain
\end_layout

\begin_layout Description
type (optional) the specific formulation used for this domain.
 
\end_layout

\begin_layout Standard
The optional 
\series bold
type 
\series default
attribute can be added to specify a specific solid formulation.
 If omitted,
 FEBio will determine the proper domain type by inspecting the material and element types used.
 However,
 users can explicitly set the type attribute.
 The following solid domain types are defined.
 
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic-solid
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
standard solid formulation (default for most materials) (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
three-field-solid
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A three-field formulation used for modeling (nearly) incompressible materials.
 (default for uncoupled materials) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid-solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid solid domain.
 (default for rigid materials.)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
udg-hex
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
uniform deformation gradient hex formulation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sri-solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Formulation that uses a selective reduced integration rule
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
remodeling-solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Formulation used for elastic remodeling problems.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ut4-solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uniform nodal strain tetrahedron.
 (2)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Standard
1.
 For the elastic-solid domain,
 the elem_type attribute can be specified to further specialize the integration rule.
 The values of the rule depend on the specific element type.
 The tables below show the available integration rules for the different element types.
 The values marked with an asterisk (*) are the default.
\end_layout

\begin_layout Itemize
For the 
\shape italic
hex8 
\shape default
element,
 the following values are defined.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
hex8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS8*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration using 2x2x2 integration points.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
POINT6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alternative integration rule for bricks using 6 integration point
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
hex20 
\shape default
element,
 the following values are defined.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
hex20
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration using 2x2x2 integration points.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS27*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration using 3x3x3 integration points.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
tet4 
\shape default
element,
 the following values are allowed.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
tet4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 4 integration points.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS1*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using one integration point.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
tet10 
\shape default
element,
 the following integration rules are supported.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
tet10
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS4*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 4 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 8 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOBATTO11
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gauss-Lobatto integration rule using 11 integration points
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Lobatto integration rule differs from a regular Gauss integration rule in that it includes the vertices of the tetrahedral element.
 The 
\shape italic
Lobatto11
\shape default
 integration rule uses the 10 tetrahedral nodes,
 plus one integration rule located at the center of the element.
\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
tet15
\shape default
 element,
 the following integration rules are defined.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
tet15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 8 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS11
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 11 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration rule using 15 integration points
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
penta15 
\shape default
element,
 the following values are defined.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
penta15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration using 2x2x2 integration points.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS21*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration using 3x7 integration points.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
tri3 
\shape default
element,
 the following integration rules are supported.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
tri3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration with one integration point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS3*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Guassian integration with three integration rules.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
For the 
\shape italic
tri6 
\shape default
element,
 the following integration rules are supported.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
tri6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS3*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration with 3 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration with 6 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration with 4 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GAUSS7
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gaussian integration with 7 integration points
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOBATTO7
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gauss-Lobatto integration with 7 integration points.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The GAUSS6 rule has only nonzero weights at the edge nodes,
 which effectively reduces this rule to a 3-node rule.
\end_layout

\end_deeper
\begin_layout Standard
2.
 The ut4-solid is a special formulation for tetrahedral elements that uses a nodally averaged integration rule,
 as proposed by Gee et al 
\begin_inset CommandInset citation
LatexCommand citep
key "Gee09"
literal "true"

\end_inset

.
 This formulation requires additional parameters.
 To override the default values,
 use the following alternative syntax:
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_deeper
\begin_layout LyX-Code
<SolidDomain name="Part1" 
\series bold
type="ut4-solid"
\series default
 mat="material1">
\end_layout

\begin_layout LyX-Code
  <alpha>0.05</alpha>
\end_layout

\begin_layout LyX-Code
  <iso_stab>0</iso_stab>
\end_layout

\begin_layout LyX-Code
</SolidDomain>
\end_layout

\end_deeper
\begin_layout Standard
The 
\shape italic
alpha 
\shape default
parameter defines the amount of 
\begin_inset Quotes eld
\end_inset

blending
\begin_inset Quotes erd
\end_inset

 between the regular tet-contribution and the nodally integrated contribution.
 The value must be between 0 and 1,
 where 0 means no contribution from the regular tet and 1 means no contribution from the nodally averaged tet.
 The 
\shape italic
iso_stab 
\shape default
parameter is a flag that chooses between two slightly different formulations of the nodally integrated tet.
 When set to 0,
 the stabilization is applied to the entire virtual work,
 whereas when set to 1 the stabilization is applied only to the isochoric part.
 See the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

 for a detailed description of this formulation.
\end_layout

\begin_layout Subsection
ShellDomain Section
\end_layout

\begin_layout Standard
Use the 
\emph on
ShellDomain 
\emph default
section to define a shell domain.
 This section takes two parameters:
 
\end_layout

\begin_layout Description

\series bold
name 
\series default
The name of the element set (defined via an 
\emph on
Elements 
\emph default
section).
 This element set must only contain shell elements.
 
\end_layout

\begin_layout Description
mat The name of the material that will be assigned to this domain
\end_layout

\begin_layout Description
type (optional) the specific shell formulation 
\end_layout

\begin_layout Standard
Similar to solid domains,
 the particular shell formulation can be requested via the 
\series bold
type
\series default
 attribute.
 If omitted,
 FEBio will determine the formulation from the material and shell element types.
 The following shell domain types are available.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic-shell
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
standard shell formulation (default for most materials) (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
three-field-shell
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A three-field formulation used for modeling (nearly) incompressible materials.
 (default for uncoupled materials)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid-shell
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid shell domain.
 (default for rigid materials.)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic-shell-old
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The 
\begin_inset Quotes eld
\end_inset

old
\begin_inset Quotes erd
\end_inset

 shell formulation,
 used in FEBio version 2.0 and older.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic-shell-eas
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Enhanced-Assumed-Strain shell;
 an alternative shell formulation for incompressible shells.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic-shell-ans
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Assumed-Natural-Strain shell;
 an alternative shell formulation for incompressible shells.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The default shell thickness can be specified as a parameter of the ShellDomain section.
 
\end_layout

\begin_layout LyX-Code
<ShellDomain name="skin">
\end_layout

\begin_layout LyX-Code
  <shell_thickness>0.01</shell_thickness>
\end_layout

\begin_layout LyX-Code
</ShellDomain>
\end_layout

\begin_layout Standard
If the shell thickness parameter is not specified,
 the initial shell thickness is set to zero,
 and it is assumed that the actual shell thickness is specified in the MeshData section.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
MeshData Section
\begin_inset CommandInset label
LatexCommand label
name "sec:MeshData-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
MeshData 
\shape default
section is where data is specified that can be mapped to the mesh.
 The data can then be applied to a parameter of the model,
 e.g.
 a material parameter,
 or a pressure load.
 
\end_layout

\begin_layout Standard
To define a mesh data section add one of the following tags.
\end_layout

\begin_layout Description
NodeData Define data on a node set
\end_layout

\begin_layout Description
SurfaceData Define data on a surface
\end_layout

\begin_layout Description
ElementData Define data on an element set
\end_layout

\begin_layout Standard
The following attributes can be added.
\end_layout

\begin_layout Description
name All mesh data sections require a name,
 which can be specified with the 
\emph on
name 
\emph default
attribute.
 This name will be used by model parameters to reference the particular mesh data.
 
\end_layout

\begin_layout Standard
Data maps can be defined in two ways:
 1) explicitly,
 where the value of each node (face,
 element) can be specified,
 or 2) implicitly,
 via data generators that define the values of each node (face,
 element) procedurally.
 
\end_layout

\begin_layout Standard
When mesh data maps are defined explicitly,
 the following attributes should be specified in addition to the name attribute.
 
\end_layout

\begin_layout Description

\series bold
data_type 
\series default
defines the type of data 
\end_layout

\begin_layout Standard
The following table lists the supported data types.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
data type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scalar
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A single floating point value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vec2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A 2D vector defined as 
\begin_inset Formula $x$
\end_inset

,
 
\begin_inset Formula $y$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vec3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A 3D vector defined as 
\begin_inset Formula $x$
\end_inset

,
 
\begin_inset Formula $y$
\end_inset

,
 
\begin_inset Formula $z$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mat3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A 3x3 tensor,
 row major sorted
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mat3s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A symmetric 3x3 tensor,
 defined as 
\begin_inset Formula $xx$
\end_inset

,
 
\begin_inset Formula $yy$
\end_inset

,
 
\begin_inset Formula $zz,xy,yz,xz$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
If the data type is not defined,
 the 
\shape italic
scalar 
\shape default
data type is assumed.
\end_layout

\begin_layout Subsection
Data Generators
\begin_inset CommandInset label
LatexCommand label
name "subsec:generator"

\end_inset


\end_layout

\begin_layout Standard
Data generators can be used to populate the values of a data map procedurally.
 To use a data generator,
 specify the 
\emph on
type
\emph default
 attribute.
 If the 
\emph on
type
\emph default
 attribute is defined,
 the child tags must be the parameters of the generator.
 For example,
\end_layout

\begin_layout LyX-Code
<MeshData>
\end_layout

\begin_layout LyX-Code
  <NodeData name="E_map" 
\series bold
type="math"
\series default
>
\end_layout

\begin_layout LyX-Code
    <math>X*X + Y*Y + Z*Z</math>
\end_layout

\begin_layout LyX-Code
  <NodeData>
\end_layout

\begin_layout LyX-Code
</MeshData>
\end_layout

\begin_layout Standard
Data generators that can be used for a specific mesh data are described in the sections below.
 
\end_layout

\begin_layout Subsection
ElementData
\begin_inset CommandInset label
LatexCommand label
name "subsec:ElementData"

\end_inset


\end_layout

\begin_layout Standard
This section defines data that can be mapped to the elements of an element set.
 The element set is specified via the 
\emph on
elem_set 
\emph default
attribute.
 
\end_layout

\begin_layout Description

\series bold
Defining
\begin_inset space ~
\end_inset

maps
\series default
 A map is defined by using the 
\emph on
name
\emph default
 attribute to give the map a name.
 This name can then be used in mapped parameters (see Appendix A).
\end_layout

\begin_layout LyX-Code
<MeshData>
\end_layout

\begin_layout LyX-Code
  <ElementData 
\series bold
name="my_map"
\series default
 elem_set="part1">
\end_layout

\begin_layout LyX-Code
    <elem lid="1">1.23</elem>
\end_layout

\begin_layout LyX-Code
    <elem lid="2">1.25</elem>
\end_layout

\begin_layout LyX-Code
  </ElementData>
\end_layout

\begin_layout LyX-Code
</MeshData>
\end_layout

\begin_layout Standard
The following data generators are available for element data sections.
 
\end_layout

\begin_layout Description
surface-to-surface_map The 
\begin_inset Quotes eld
\end_inset


\emph on
surface-to-surface map
\emph default

\begin_inset Quotes erd
\end_inset

 generator defines a data field on the domain bounded by two surfaces.
 The data values are interpolated using a user-defined function between the surfaces.
 
\end_layout

\begin_layout LyX-Code
<MeshData>
\end_layout

\begin_layout LyX-Code
  <ElementData name="Emap" 
\series bold
generator="surface-to-surface map"
\series default
 elem_set="Part1">
\end_layout

\begin_layout LyX-Code
    <function type="math">x*x+1</function>
\end_layout

\begin_layout LyX-Code
    <bottom_surface surface="surface1"/>
\end_layout

\begin_layout LyX-Code
    <top_surface surface="surface2"/>
\end_layout

\begin_layout LyX-Code
  <ElementData>
\end_layout

\begin_layout LyX-Code
</MeshData>
\end_layout

\begin_layout Description

\series bold
special
\begin_inset space ~
\end_inset

generators
\series default
 A few special data generators do not generate maps,
 but instead modify model data in a more direct way.
 The following table lists the currently supported special generators.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Property
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Data type/format
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify a local fiber direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vec3/const
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mat_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify local element material axes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vec3/const
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell thickness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the shell element thickness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
float/shape
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to assign shell thicknesses to an element set,
 use the following syntax.
 
\end_layout

\begin_layout LyX-Code
<MeshData>
\end_layout

\begin_layout LyX-Code
  <ElementData 
\series bold
type="shell thickness"
\series default
 elem_set="part1">
\end_layout

\begin_layout LyX-Code
    <elem lid="1">1.0,
 1.0,
 1.0,
 1.0</elem>
\end_layout

\begin_layout LyX-Code
    <elem lid="2">1.0,
 1.0,
 1.0,
 1.0</elem>
\end_layout

\begin_layout LyX-Code
  </ElementData>
\end_layout

\begin_layout LyX-Code
</MeshData>
\end_layout

\begin_layout Subsection
SurfaceData
\begin_inset CommandInset label
LatexCommand label
name "subsec:SurfaceData"

\end_inset


\end_layout

\begin_layout Standard
This section allows users to define data that can be mapped to the surfaces of certain boundary conditions and loads.
 This section only defines user-defined data maps,
 i.e.
 the 
\shape italic
name
\shape default
,
 
\shape italic
data_type 
\shape default
and 
\shape italic
data_format 
\shape default
attributes must be used.
 The surface is defined via the 
\shape italic
surface 
\shape default
attribute.
\end_layout

\begin_layout LyX-Code
<SurfaceData name="values" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <face lid="1">1.23</face>
\end_layout

\begin_layout LyX-Code
  <face lid="2">3.45</face>
\end_layout

\begin_layout LyX-Code
</SurfaceData>
\end_layout

\begin_layout Standard
The surface definition is defined in the 
\shape italic
Mesh 
\shape default
section.
 Note that the ids refer to the local ids of the surface facets.
 By default,
 the 
\shape italic
scalar 
\shape default
data type and 
\shape italic
const 
\shape default
data format are assumed so only one value per facet is expected.
 Other data types and formats can be specified with the 
\shape italic
data_type 
\shape default
and 
\shape italic
data_format 
\shape default
attributes.
\end_layout

\begin_layout LyX-Code
<SurfaceData name="data" data_type="vec3" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <face lid="1">0.0,
 1.0,
 0.0</face>
\end_layout

\begin_layout LyX-Code
  <face lid="2">0.0,
 2.0,
 0.0</face>
\end_layout

\begin_layout LyX-Code
</SurfaceData>
\end_layout

\begin_layout Standard
Optionally,
 the surface data may be described with a data generator.
 The data generator is specified via the 
\emph on
type 
\emph default
attribute.
 The following data generators are available for surface data.
 
\end_layout

\begin_layout Description
parabolic_map The 
\begin_inset Quotes eld
\end_inset


\emph on
parabolic map
\emph default

\begin_inset Quotes erd
\end_inset

 defines a scalar data field with a parabolic profile on a surface.
 The data is determined by solving a heat-type problem with a constant source and homogeneous boundary conditions on the edge of the surface.
 
\end_layout

\begin_layout LyX-Code
<MeshData>
\end_layout

\begin_layout LyX-Code
  <SurfaceData name="pressure" 
\series bold
type="parabolic map"
\series default
 surface="surface1">
\end_layout

\begin_layout LyX-Code
    <value>1.0</value>
\end_layout

\begin_layout LyX-Code
  <SurfaceData>
\end_layout

\begin_layout LyX-Code
</MeshData>
\end_layout

\begin_layout Subsection
EdgeData
\begin_inset CommandInset label
LatexCommand label
name "subsec:EdgeData"

\end_inset


\end_layout

\begin_layout Standard
This section allows users to define user-defined data maps that will be mapped to an edge defined in the Mesh section.
\end_layout

\begin_layout LyX-Code
<EdgeData name="data" edge="edge1">
\end_layout

\begin_layout LyX-Code
  <edge lid="1">1.0</edge>
\end_layout

\begin_layout LyX-Code
  <edge lid="2">2.0</edge>
\end_layout

\begin_layout LyX-Code
</EdgeData>
\end_layout

\begin_layout Standard
Notice that the 
\shape italic
local 
\shape default
IDs are required here.
\end_layout

\begin_layout Subsection
NodeData
\begin_inset CommandInset label
LatexCommand label
name "subsec:NodeData"

\end_inset


\end_layout

\begin_layout Standard
This section allows users to define data that will be mapped to node sets.
\end_layout

\begin_layout LyX-Code
<NodeData name="data" node_set="set1">
\end_layout

\begin_layout LyX-Code
  <node lid="1">1.0</node>
\end_layout

\begin_layout LyX-Code
  <node lid="2">2.0</node>
\end_layout

\begin_layout LyX-Code
</NodeData>
\end_layout

\begin_layout Standard
For node data the 
\shape italic
data_format 
\shape default
attribute,
 if specified,
 will be ignored.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Mesh Adaptor Section
\end_layout

\begin_layout Standard
The FEBio Adaptive Mesh Refinement framework (FEAMR,
 pronounced femur) allows users to make modifications to the mesh during the analysis of the model.
 There are currently two mesh adaptor applications supported,
 namely mesh erosion,
 which removes elements from the mesh,
 and remeshing,
 which can be used to adaptively refine or coarsen the mesh based on the solution.
 The mesh adaptors are controlled via user-defined criteria that determine the conditions under which to modify the mesh.
\end_layout

\begin_layout Standard
A mesh adaptor is applied at the end of a timestep,
 after the Newton-iterations and augmentations have converged.
 If the mesh adaptor modifies the mesh,
 then the timestep is solved again,
 using the new mesh.
 Several adaptors define the 
\emph on
criterion
\emph default
 property,
 which evaluates the variable or metric that is used by the adaptor,
 and optionally,
 can be used to filter the elements to which the adaptor will be applied.
 How the criterion is used,
 depends on the adaptor.
 For instance,
 the erosion adaptor uses it to identify the elements to deactivate.
 Remeshing adaptors will use it to set the new element size.
 It is allowed to use several mesh adaptors in a single model,
 but keep in mind that the order in which the mesh adaptors are listed in the input file is important.
 For instance,
 if two mesh adaptors are defined,
 the second adaptor will operate on the mesh created by the first adaptor.
 Mesh adaptors used for adaptive refinement will also map data between the old mesh and the new mesh.
 User data,
 defined in the MeshData section,
 is always mapped between meshes.
 If the model is history-dependent,
 it might be important to map additional data.
 For instance,
 a visco-elastic material needs to map stress-history variables.
 By default,
 mapping data (except for user-data) is not done unless the user sets a specific flag (map_data).
 New mesh adaptors and adaptor criteria can be defined via the plugin framework.
 
\end_layout

\begin_layout Subsection
The MeshAdaptor Section
\end_layout

\begin_layout Standard
Mesh adaptors are added to the FEBio Input file (version 3.0 and above) in a new section,
 called 
\series bold
MeshAdaptor
\series default
.
 This section must appear after the Mesh and MeshDomains sections.
 The MeshAdaptor section may also be defined in a 
\emph on
step
\emph default
 section in order to apply the adaptor only during that step.
 Inside the MeshAdaptor section,
 each mesh adaptor is defined via the 
\series bold
mesh_adaptor
\series default
 tag.
 This tag allows the following attributes:
 
\end_layout

\begin_layout Standard
 
\series bold
type
\series default
:
 set the type of the mesh adaptor (1).
 [Required] 
\end_layout

\begin_layout Standard
 
\series bold
elem_set
\series default
:
 The element set to apply the adaptor to (2).
 [Optional] 
\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
 
\end_layout

\begin_layout Enumerate
The 
\series bold
type 
\series default
attribute defines the mesh adaptor.
 It must be one of the mesh adaptors defined in Table 1,
 below.
 
\end_layout

\begin_layout Enumerate
The 
\series bold
elem_set 
\series default
attribute is optional,
 but can be used to apply the adaptor to only a part of the mesh.
 This is useful to limit the effect of an adaptor to a part of the mesh.
 The element set must reference a domain (i.e.
 defined via Elements) of a mesh,
 or a set of domains.
 It cannot be an element set defined through the ElementSet tag.
 (Note that not all mesh adaptors support this attribute.) If omitted,
 the adaptor is applied to the entire mesh.
 
\end_layout

\begin_layout Standard
The sections below list the properties of the available mesh adaptors and the adaptor criteria.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
erosion
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The erosion adaptor removes elements from a mesh.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mmg_remesh
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Adaptive mesh refinement of tetrahedral mesh using the MMG library.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hex_refine2d
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Refine a 2D hexahedral mesh.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tet_refine
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Refine a linear tetrahedral mesh (Whole mesh refinement only)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hex_refine
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Refine a hexahedral mesh.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
The erosion adaptor
\end_layout

\begin_layout Standard
The erosion adaptor can be used to deactivate elements in a mesh,
 based on a user-defined criterion.
 It defines the following properties:
 
\end_layout

\begin_layout Itemize

\series bold
max_iters
\series default
:
 Set the max number of adaption iterations,
 for each time step.
 
\end_layout

\begin_layout Itemize

\series bold
remove_islands
\series default
:
 If true,
 removes small element sets that have become disconnected from the main mesh.
 
\end_layout

\begin_layout Itemize

\series bold
max_elems
\series default
:
 Set the max number of elements to erode,
 per adaptation.
 
\end_layout

\begin_layout Itemize

\series bold
sort
\series default
:
 sort the element values returned by the criterion.
 
\end_layout

\begin_layout Itemize

\series bold
criterion
\series default
:
 Set the criterion that determines the element metric to evaluate and which elements to erode.
\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
 
\end_layout

\begin_layout Standard
In this example,
 elements that have an (integration point averaged) effective stress larger than 0.3,
 are eroded.
 Only three elements are eroded per adaptation cycle.
\end_layout

\begin_layout LyX-Code
<mesh_adaptor type="erosion"> 
\end_layout

\begin_layout LyX-Code
  <max_iters>1</max_iters>
\end_layout

\begin_layout LyX-Code
  <max_elems>3</max_elems>
\end_layout

\begin_layout LyX-Code
  <sort>1</sort>
\end_layout

\begin_layout LyX-Code
  <criterion type="min-max filter">
\end_layout

\begin_layout LyX-Code
    <min>0.3</min>
\end_layout

\begin_layout LyX-Code
    <clamp>0</clamp>
\end_layout

\begin_layout LyX-Code
    <data type="stress"/>
\end_layout

\begin_layout LyX-Code
  </criterion>
\end_layout

\begin_layout LyX-Code
</mesh_adaptor> 
\end_layout

\begin_layout Subsubsection
The mmg_remesh adaptor
\end_layout

\begin_layout Standard
The mmg_remesh adaptor can be used for adaptive mesh refinement of linear tetrahedral meshes.
 
\end_layout

\begin_layout Itemize

\series bold
max_iters
\series default
:
 The maximum number of adaption iterations per time step.
 
\end_layout

\begin_layout Itemize

\series bold
max_elements
\series default
:
 The maximum number of elements.
 If the number of elements of the mesh is larger,
 the adaptor is not applied.
 
\end_layout

\begin_layout Itemize

\series bold
min_element_size
\series default
:
 Set the desired minimal element size.
 
\end_layout

\begin_layout Itemize

\series bold
hausdorff
\series default
:
 The Hausdorff distance.
 This is used to preserve curved sections.
 (default = 0.01).
 
\end_layout

\begin_layout Itemize

\series bold
gradation
\series default
:
 This parameter sets the spatial gradient of element size.
 (default = 1.3).
 Value should be larger than 1.
 
\end_layout

\begin_layout Itemize

\series bold
mesh_coarsen
\series default
:
 Allow mesh-coarsening 
\end_layout

\begin_layout Itemize

\series bold
normalize_data
\series default
:
 normalize the element values returned by the criterion between 0 and 1.
 
\end_layout

\begin_layout Itemize

\series bold
relative_size
\series default
:
 Sets whether the size function is to be interpreted as a relative size function (i.e.
 a scale function to the current element size),
 or an absolute element size metric.
\end_layout

\begin_layout Itemize

\series bold
criterion
\series default
:
 The metric used to assign values to elements.
 (See section 4) 
\end_layout

\begin_layout Itemize

\series bold
size_function
\series default
:
 set the mesh size function.
 This function is applied to the (optionally normalized) element values returned by the criterion.
 
\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
 
\end_layout

\begin_layout LyX-Code
<mesh_adaptor type="mmg_remesh">
\end_layout

\begin_layout LyX-Code
  <max_iters>1</max_iters>
\end_layout

\begin_layout LyX-Code
  <criterion type="stress"/>
\end_layout

\begin_layout LyX-Code
  <relative_size>1</relative_size>
\end_layout

\begin_layout LyX-Code
  <normalize_data>0</normalize_data>
\end_layout

\begin_layout LyX-Code
  <mesh_coarsen>0</mesh_coarsen>
\end_layout

\begin_layout LyX-Code
  <size_function type="step">
\end_layout

\begin_layout LyX-Code
    <x0>10</x0>
\end_layout

\begin_layout LyX-Code
    <left_val>1</left_val>
\end_layout

\begin_layout LyX-Code
    <right_val>0.5</right_val>
\end_layout

\begin_layout LyX-Code
  </size_function>
\end_layout

\begin_layout LyX-Code
</mesh_adaptor> 
\end_layout

\begin_layout Subsection
Mesh Adaptor Criteria
\end_layout

\begin_layout Standard
The purpose of the mesh adaptor criteria is to assign values to elements.
 Some adaptors also act as filters that limit the effect of the adaptor to certain elements.
 These values will then be used by the mesh adaptor to modify the mesh.
 How these values are used depends on the adaptor.
 For instance,
 the erosion uses it to decide which elements to erode.
 The mesh refinement adaptors use it to define the size function.
 
\end_layout

\begin_layout Standard
The following criteria are currently available.
 A detailed description of these adaptor criteria is given below.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_variable
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluates average of elements nodal values of a model primary variable.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element_selection
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the element selection to which the adaptor should be applied (only for erosion)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stress
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluate the (integration point average) effective stress of each element.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
damage
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluate the (integration point average) damage value.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative error
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluate a relative error measure.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
spring force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluate the axial force of the spring.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
spring stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Evaluate the stretch of a spring.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
math
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the element value based on a mathematical expression.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
min-max filter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Selects elements whose value falls within a min-max range.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact gap
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Select elements that are in contact.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
max_variable
\end_layout

\begin_layout Standard
The max_variable criterion evaluates elements based on a primary variables degrees of freedom.
 
\end_layout

\begin_layout Itemize

\series bold
dof
\series default
:
 The degree of freedom that defines the variable to inspect.
 
\end_layout

\begin_layout Subsubsection
element_selection
\end_layout

\begin_layout Standard
Sets the selected elements directly.
 
\end_layout

\begin_layout Itemize

\series bold
element_list:

\series default
 a comma-separated list of element indices.
 
\end_layout

\begin_layout Subsubsection
math
\end_layout

\begin_layout Standard
Sets the scale factor for each element.
 
\end_layout

\begin_layout Itemize

\series bold
scale
\series default
:
 the scale factor to use.
 This can be a constant,
 or a mathematical expression of position (use X,
 Y,
 Z for the nodal coordinates),
 or a scalar map defined in the MeshData section.
\end_layout

\begin_layout Standard
Example:
 
\end_layout

\begin_layout LyX-Code
<mesh_adaptor type="mmg_remesh">
\end_layout

\begin_layout LyX-Code
  <max_iters>1</max_iters>
\end_layout

\begin_layout LyX-Code
  <criterion type="math">
\end_layout

\begin_layout LyX-Code
    <math>1*(1 - (X^2+Y^2)) + (X^2+Y^2)*(0.5*(Z-1)^2 - Z*(Z - 2))</math>
\end_layout

\begin_layout LyX-Code
  </criterion>
\end_layout

\begin_layout LyX-Code
</mesh_adaptor> 
\end_layout

\begin_layout Subsubsection
stress
\end_layout

\begin_layout Standard
This criterion selects elements that exceed a maximum stress value.
 
\end_layout

\begin_layout Itemize

\series bold
metric
\series default
:
 The stress measure to use:
 0=effective stress,
 1=max principal stress.
 
\end_layout

\begin_layout Subsubsection
max_damage
\end_layout

\begin_layout Standard
This criterion evaluates the maximum damage value for each element.
 This can only be used with materials that define the damage property.
\end_layout

\begin_layout Subsubsection
relative error
\end_layout

\begin_layout Standard
This criterion evaluates a relative error metric for each element.
 
\end_layout

\begin_layout Itemize

\series bold
error:

\series default
 If nonzero,
 this criterion will evaluate a relative size metric for each element.
 Otherwise,
 the actual relative error is evaluated.
 
\end_layout

\begin_layout Itemize

\series bold
data:

\series default
 Specify the metric to evaluate the element values.
 Any of the other criteria defined above can be used.
 
\end_layout

\begin_layout Subsubsection
min-max filter
\end_layout

\begin_layout Standard
This criterion evaluates a metric for each element,
 but then filters out the elements that have values within a min-max range.
 
\end_layout

\begin_layout Itemize

\series bold
min
\series default
:
 set the minimum value of the filter 
\end_layout

\begin_layout Itemize

\series bold
max
\series default
:
 set the maximum value of the filter 
\end_layout

\begin_layout Itemize

\series bold
clamp
\series default
:
 If true,
 the element values will be clamped to the range.
 
\end_layout

\begin_layout Itemize

\series bold
data
\series default
:
 Specify the metric to evaluate the element values.
 Any of the other criteria defined above can be used.
 
\end_layout

\begin_layout Subsubsection
contact gap
\end_layout

\begin_layout Standard
This criterion evaluates the contact gap for all elements that are in contact.
 
\end_layout

\begin_layout Itemize

\series bold
gap
\series default
:
 contact gap threshold value.
\end_layout

\begin_layout Subsection
Limitations
\end_layout

\begin_layout Standard
Please take into account the following limitations of the FEAMR framework.
 
\end_layout

\begin_layout Enumerate
Although contact can be used with the FEAMR framework,
 currently no contact data is mapped from the old mesh to the new mesh.
 It is advised to only use penalty-based contact interfaces.
 
\end_layout

\begin_layout Enumerate
It is not advised to erode elements that are in contact,
 since this will not produce the correct result.
 
\end_layout

\begin_layout Enumerate
Mapping history-data is supported (if the proper flag is set),
 but can be very time consuming since FEBio maps all material point data between meshes.
\end_layout

\begin_layout Enumerate
The FEAMR framework does not work with the auto time-stepper.
 It is advised to use fixed time stepping when using mesh adaptation.
 
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Initial Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Initial-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Initial
\shape default
 section defines all initial conditions that may be applied to the analysis.
 An initial condition is defined via the 
\shape italic
ic 
\shape default
element and requires the 
\shape italic
type 
\shape default
attribute and 
\shape italic
node_set 
\shape default
attribute.
 The 
\emph on
type
\emph default
 attribute defines the particular initial condition that will be applied.
 The 
\shape italic
node_set 
\shape default
attribute defines the set of nodes that this initial condition affects.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
init_dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial value of a specific degree of freedom.
 (obsolete)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial value for the nodal velocities.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial value for the shell (back) nodal velocities.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
initial fluid velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial values for the fluid velocity (in fluid analysis)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
prestrain
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Used to initialize the prestrain analysis.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<ic type="init_dof" node_set="set1">
\end_layout

\begin_layout LyX-Code
  <dof>x</dof>
\end_layout

\begin_layout LyX-Code
  <value>1.0</value>
\end_layout

\begin_layout LyX-Code
</ic>
\end_layout

\begin_layout Subsection
The Prestrain Initial Condition
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prestrain-Initial-Condition"

\end_inset


\end_layout

\begin_layout Standard
The prestrain initial condition can be used to accomplish one of two things.
 It can be used to convert a forward analysis in an equivalent prestrain analysis.
 Or it can be used to fix the prestrain gradient.
 In either case the current geometry is used as the new reference geometry of the following analysis step.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
initial value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
init
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initialize prestrain field
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 (=true)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
reset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Make current geometry the reference geometry of the following steps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 (=true)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The following example shows how a forward analysis can be converted to a prestrain analysis.
 
\end_layout

\begin_layout LyX-Code
<ic type="prestrain">
\end_layout

\begin_layout LyX-Code
  <init>1</init>
\end_layout

\begin_layout LyX-Code
  <reset>1</reset>
\end_layout

\begin_layout LyX-Code
</ic> 
\end_layout

\begin_layout Standard
Note that this in itself may not be sufficient to define the equivalent prestrain analysis.
 For instance,
 if the forward model applied prescribed displacements,
 then these boundary conditions must be replaced with fixed boundary conditions.
\end_layout

\begin_layout Standard
If the 
\emph on
init
\emph default
 parameter is set to 0 (false),
 then the prestrain gradient will be fixated in the current geometry.
 This means that any remaining distortion will be applied to the prestrain correction factor before the current geometry is converted to the new reference geometry.
 
\end_layout

\begin_layout Subsection
Fluid Pressure Initial Condition
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Pressure-IC"

\end_inset


\end_layout

\begin_layout Standard
The fluid pressure initial condition can be used in biphasic and multiphasic analyses,
 and in fluid,
 fluid-FSI,
 and fluid-solutes analyses.
 In all cases it sets the initial value of the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

.
 If the analysis includes solutes (multiphasic or fluid-solutes),
 it is the user's responsibility to evaluate 
\begin_inset Formula $\tilde{p}$
\end_inset

 using eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 knowing the values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 and absolute temperature 
\begin_inset Formula $T$
\end_inset

 specified in the Globals section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Globals-Section"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 and the values of initial effective solute concentrations 
\begin_inset Formula $\tilde{c}$
\end_inset

 in the given multiphasic or fluid-solutes domain.
\end_layout

\begin_layout Standard
In biphasic and multiphasic analyses the value of 
\begin_inset Formula $\tilde{p}$
\end_inset

 is prescribed directly as a nodal degree of freedom.
 In a fluid,
 fluid-FSI,
 or fluid-solutes analysis,
 the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 is converted internally to the corresponding initial value of the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

,
 based on the constitutive models presented in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Boundary Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Boundary-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Boundary
\shape default
 section defines all fixed and prescribed boundary conditions that may be applied to the geometry.
 Individual boundary conditions are defined via the 
\emph on
bc 
\emph default
tag and the particular boundary condition is defined via the 
\emph on
type 
\emph default
attribute.
 The following boundary condition types are currently supported.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="18" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
module
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
zero displacement
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix the x,
 y,
 or z displacement degree of freedom
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
zero shell displacement
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix the x,
 y,
 or z shell (back) displacement dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
zero fluid pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix the biphasic or multiphasic effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
biphasic
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
zero concentration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix the effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

 (multiphasic or fluid-solutes)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solute
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
zero fluid dilatation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed displacement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the x,
 y,
 or z displacement dof 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed shell displacement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the x,
 y,
 or z shell (back) displacement dof 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed deformation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the motion via a deformation gradient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed fluid pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the biphasic or multiphasic effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
biphasic
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed concentration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solute
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prescribed fluid dilatation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
normal displacement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the motion normal to a surface (in reference configuration)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
rigid deformation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the motion via a rigid motion
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The nodes are attached to a rigid body
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
fluid pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe the actual fluid pressure 
\begin_inset Formula $p$
\end_inset

 on a surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
multiple
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
fluid resistance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribe a fluid resistance 
\begin_inset Formula $R$
\end_inset

 such that 
\begin_inset Formula $p=Rq$
\end_inset

,
 
\begin_inset Formula $q=$
\end_inset

volumetric flux
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
multiple
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
linear constraint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The motion is constrained to satisfy a linear constraint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(all)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Most of these boundary conditions require the node set to which to apply the boundary condition to.
 That nodeset can be defined via the 
\emph on
node_set 
\emph default
attribute.
 The value of this attribute should be set to the name of a nodeset defined in the Mesh section.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:NodeSet-Section"
nolink "false"

\end_inset

 for more information on how to define node sets.
 Nodesets can also be defined via surfaces or element sets.
 To define a node set via a surface,
 use the following syntax.
 
\end_layout

\begin_layout LyX-Code
node_set="@surface:surface1"
\end_layout

\begin_layout Standard
Here,
 
\emph on
surface1 
\emph default
is a surface defined in the 
\emph on
Mesh
\emph default
 section.
 Similarly,
 defining a node set via an element set is done using 
\emph on
@elem_set:.
\end_layout

\begin_layout Subsection
Zero Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Zero-Displacement"

\end_inset


\end_layout

\begin_layout Standard
To fix the nodal displacement degrees of freedom (dof) use the 
\shape italic
zero displacement
\shape default
 boundary condition.
 This element has two required attributes:
 the 
\emph on
type 
\emph default
is set to 
\begin_inset Quotes eld
\end_inset

zero displacement
\begin_inset Quotes erd
\end_inset

 and the node set to which this boundary condition applies is defined vua 
\shape italic
node_set
\shape default
.
 The optional 
\emph on
name 
\emph default
attribute can be used to give the boundary condition a name.
 
\end_layout

\begin_layout Standard
This boundary condition has three parameters,
 one for each degree of freedom.
 Set the value of each parameter to 1 to constrain the corresponding dof.
 
\end_layout

\begin_layout LyX-Code
<bc type="zero displacement" node_set="nodeset1">
\end_layout

\begin_layout LyX-Code
  <x_dof>1</x_dof>
\end_layout

\begin_layout LyX-Code
  <y_dof>1</y_dof>
\end_layout

\begin_layout LyX-Code
  <z_dof>1</z_dof>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Subsection
Zero Shell Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Zero-Shell-Displacement"

\end_inset


\end_layout

\begin_layout Standard
To fix the nodal back-displacement degrees of freedom (dof) of a shell use the 
\shape italic
zero 
\shape default
\emph on
shell displacement
\emph default
 boundary condition.
 This element has two required attributes:
 the 
\emph on
type 
\emph default
is set to 
\begin_inset Quotes eld
\end_inset

zero shell displacement
\begin_inset Quotes erd
\end_inset

 and the node set to which this boundary condition applies is defined vua 
\shape italic
node_set
\shape default
.
 The optional 
\emph on
name 
\emph default
attribute can be used to give the boundary condition a name.
 
\end_layout

\begin_layout Standard
This boundary condition has three parameters,
 one for each degree of freedom.
 Set the value of each parameter to 1 to constrain the corresponding dof.
 
\end_layout

\begin_layout LyX-Code
<bc type="zero shell displacement" node_set="nodeset1">
\end_layout

\begin_layout LyX-Code
  <sx_dof>1</sx_dof>
\end_layout

\begin_layout LyX-Code
  <sy_dof>1</sy_dof>
\end_layout

\begin_layout LyX-Code
  <sz_dof>1</sz_dof>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
This boundary condition can only be applied to nodes that belong to shells.
 
\end_layout

\begin_layout Subsection
Zero Fluid Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Zero-Fluid-Pressure"

\end_inset


\end_layout

\begin_layout Standard
To fix the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 in a biphasic or multiphasic analysis,
 use the 
\emph on
zero fluid pressure
\emph default
 boundary condition.
\end_layout

\begin_layout LyX-Code
<bc node_set="set01" type="zero fluid pressure"/>
\end_layout

\begin_layout Subsection
Zero Concentration
\begin_inset CommandInset label
LatexCommand label
name "subsec:Zero-Concentration"

\end_inset


\end_layout

\begin_layout Standard
To fix an effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

 degree of freedom (c_dof) in a multiphasic or fluid-solutes analysis,
 use the 
\emph on
zero concentration
\emph default
 boundary conditions.
\end_layout

\begin_layout LyX-Code
<bc node_set="set01" type="zero concentration">
\end_layout

\begin_layout LyX-Code
  <c_dof>c1</c_dof>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Subsection
Zero Fluid Dilatation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Zero-Dilatation"

\end_inset


\end_layout

\begin_layout Standard
To fix the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 in a fluid or fluid-FSI or fluid-solutes analysis,
 use the 
\emph on
zero fluid dilatation
\emph default
 boundary condition.
\end_layout

\begin_layout LyX-Code
<bc node_set="set01" type="zero fluid dilatation"/>
\end_layout

\begin_layout Standard
Zero fluid dilatation is the same as setting the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 to zero in fluid analyses.
 If you want to set the actual fluid pressure 
\begin_inset Formula $p$
\end_inset

 to some value (such as zero) in a fluid analysis,
 use the 
\emph on
fluid pressure
\emph default
 boundary condition (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Pressure-BC"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Prescribed Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Displacement"

\end_inset


\end_layout

\begin_layout Standard
The prescribed displacement boundary condition can be used to prescribe the value of the nodal displacement degrees of freedom.
 This boundary condition takes the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The displacement dof to prescribe,
 x,
 y,
 or z
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
relative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that defines whether the value is absolute or relative (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
If the relative flag is set to 1,
 then the value is relative with respect to the current position of the node at the time the boundary condition becomes active.
 This only has an effect in multi-step analyses.
 
\end_layout

\begin_layout LyX-Code
<bc type="prescribed displacement" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <dof>x</dof>
\end_layout

\begin_layout LyX-Code
  <value lc="1">1.0</value>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Standard
Although the 
\shape italic
prescribe displacement 
\shape default
element with a value of zero can also be used to fix a certain nodal degree of freedom,
 the user should use the 
\emph on
zero displacement
\emph default
 boundary condition whenever possible,
 since this option causes the equation corresponding to the constrained degree of freedom to be removed from the linear system of equations.
 This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
\end_layout

\begin_layout Subsection
Prescribed Shell Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Shell-Displacement"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
prescribed shell displacement
\emph default
 boundary condition can be used to prescribe the value of the nodal back-displacement degrees of freedom of a shell.
 This boundary condition takes the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The displacement dof to prescribe,
 sx,
 sy,
 or sz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
relative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that defines whether the value is absolute or relative (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
If the relative flag is set to 1,
 then the value is relative with respect to the current position of the node at the time the boundary condition becomes active.
 This only has an effect in multi-step analyses.
 
\end_layout

\begin_layout LyX-Code
<bc type="prescribed shell displacement" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <dof>sx</dof>
\end_layout

\begin_layout LyX-Code
  <value lc="1">1.0</value>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Standard
Although the 
\shape italic
prescribe shell displacement 
\shape default
element with a value of zero can also be used to fix a certain nodal degree of freedom,
 the user should use the 
\emph on
zero shell displacement
\emph default
 boundary condition whenever possible,
 since this option causes the equation corresponding to the constrained degree of freedom to be removed from the linear system of equations.
 This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
\end_layout

\begin_layout Subsection
Prescribed Fluid Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Fluid-Pressure"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
prescribed fluid pressure
\emph default
 boundary condition can be used to prescribe the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 on the boundary of a biphasic or multiphasic material.
 This boundary condition takes the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
relative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that defines whether the value is absolute or relative (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
If the relative flag is set to 1,
 then the value is relative with respect to the current position of the node at the time the boundary condition becomes active.
 This only has an effect in multi-step analyses.
 
\end_layout

\begin_layout LyX-Code
<bc type="prescribed fluid pressure" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <value lc="1">1.0</value>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Standard
Although the 
\shape italic
prescribed 
\shape default
\emph on
fluid pressure
\shape italic
\emph default
 
\shape default
element with a value of zero can also be used to fix the effective fluid pressure,
 the user should use the 
\emph on
zero fluid pressure
\emph default
 boundary condition whenever possible,
 since this option causes the equation corresponding to that degree of freedom to be removed from the linear system of equations.
 This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
\end_layout

\begin_layout Subsection
Prescribed Concentration
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Concentration"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
prescribed concentration
\emph default
 boundary condition can be used to prescribe the value of the effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

 in a multiphasic or fluid-solutes analysis.
 This boundary condition takes the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The solute concentration dof to prescribe,
 c1,
 c2,
 etc.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
relative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that defines whether the value is absolute or relative (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
If the relative flag is set to 1,
 then the value is relative with respect to the current effective solute concentration at the time the boundary condition becomes active.
 This only has an effect in multi-step analyses.
 
\end_layout

\begin_layout LyX-Code
<bc type="prescribed concentration" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <dof>c1</dof>
\end_layout

\begin_layout LyX-Code
  <value lc="1">1.0</value>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Standard
Although the 
\shape italic
prescribed concentration 
\shape default
element with a value of zero can also be used to fix that degree of freedom,
 the user should use the 
\emph on
zero concentration
\emph default
 boundary condition whenever possible,
 since this option causes the equation corresponding to the constrained degree of freedom to be removed from the linear system of equations.
 This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
\end_layout

\begin_layout Subsection
Prescribed Deformation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Deformation"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
prescribed deformation 
\emph default
boundary condition can be used to prescribe the displacement of a node using the following equation.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}=s\left(\boldsymbol{F}-\boldsymbol{I}\right)\boldsymbol{X}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\boldsymbol{u}$
\end_inset

 is the displacement vector,
 
\begin_inset Formula $\boldsymbol{X}$
\end_inset

 the reference position vector,
 
\begin_inset Formula $\boldsymbol{F}$
\end_inset

a 
\begin_inset Quotes eld
\end_inset

deformation gradient
\begin_inset Quotes erd
\end_inset

,
 
\begin_inset Formula $\boldsymbol{I}$
\end_inset

 the identity tensor,
 and 
\begin_inset Formula $s$
\end_inset

 a scale factor.
 
\end_layout

\begin_layout Standard
The following parameters are defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
scale
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The scale factor 
\begin_inset Formula $s$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
F
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The deformation gradient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\boldsymbol{I}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout LyX-Code
<bc type="prescribed deformation" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">0.1</scale>
\end_layout

\begin_layout LyX-Code
  <F>2,0,0,
 0,2,0,
 0,0.25,0</F>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Subsection
Prescribed Fluid Dilatation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Fluid-Dilatation"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
prescribed fluid dilatation
\emph default
 boundary condition can be used to prescribe the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 on the boundary of a fluid,
 fluid-FSI or fluid-solutes material.
 This boundary condition takes the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
relative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag that defines whether the value is absolute or relative (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
If the relative flag is set to 1,
 then the value is relative with respect to the current position of the node at the time the boundary condition becomes active.
 This only has an effect in multi-step analyses.
 
\end_layout

\begin_layout LyX-Code
<bc type="prescribed fluid dilatation" node_set="
\shape italic
\emph on
set1
\shape default
\emph default
">
\end_layout

\begin_layout LyX-Code
  <value lc="1">-1e-8</value>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Standard
Although the 
\shape italic
prescribed 
\shape default
\emph on
fluid dilatation
\shape italic
\emph default
 
\shape default
element with a value of zero can also be used to fix the effective fluid pressure,
 the user should use the 
\emph on
zero fluid dilatation
\emph default
 boundary condition whenever possible,
 since this option causes the equation corresponding to that degree of freedom to be removed from the linear system of equations.
 This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
\end_layout

\begin_layout Subsection
Normal Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Normal-Displacement"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
normal displacement 
\emph default
boundary condition prescribes the displacement of a node along the normal vector to the surface on which the node lies.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}=s\boldsymbol{N}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\boldsymbol{u}$
\end_inset

 is the displacement vector,
 
\begin_inset Formula $\boldsymbol{N}$
\end_inset

 is the normal to the surface in the reference configuration,
 and 
\begin_inset Formula $s$
\end_inset

 is a scale factor.
 
\end_layout

\begin_layout Standard
Note that this boundary condition requires a 
\emph on
surface 
\emph default
attribute,
 instead of the 
\emph on
node_set 
\emph default
attribute.
 The following parameters are defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
scale
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The scale factor 
\begin_inset Formula $s$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
surface_hint
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag indicating the type of surface (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The 
\emph on
surface_hint 
\emph default
parameter indicates the shape of the surface.
 Set this value to 1 if the surface is spherical.
 This will calculate a more accurate normal vector.
 
\end_layout

\begin_layout LyX-Code
<bc type="normal displacement" surface="surf1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">0.1</scale>
\end_layout

\begin_layout LyX-Code
  <surface_hint>1</surface_hint>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Subsection
Rigid Deformation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Deformation"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
rigid deformation 
\emph default
boundary condition can be used to prescribe the motion of a nodeset via a rigid transformation.
 The displacement is given by the following equation.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}=\boldsymbol{Q}\left(\boldsymbol{X}-\boldsymbol{r}_{0}\right)+\boldsymbol{r}_{t}-\boldsymbol{X}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\boldsymbol{u}$
\end_inset

 is the displacement vector,
 
\begin_inset Formula $\boldsymbol{Q}$
\end_inset

 is a rotation tensor,
 
\begin_inset Formula $\boldsymbol{X}$
\end_inset

 is the initial position of the node,
 and 
\begin_inset Formula $\boldsymbol{r}_{0}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{r}_{t}$
\end_inset

 are the reference and current position respectively of the rigid coordinate system.
 The following parameters are defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
pos
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Position vector of the rigid coordinate system
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,0,0}
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
rot
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rotation vector of the rigid coordinate system (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
{0,0,0}
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The rotation of the rigid coordinate system is given by a rotation vector.
 The direction of this vector defines the (instantaneous) axis or rotation,
 and the magnitude is the rotation angle (in radians) around this axis.
 
\end_layout

\begin_layout Subsection
Rigid 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid"

\end_inset


\end_layout

\begin_layout Standard
A node set can be attached to a rigid body using the 
\shape italic
rigid 
\shape default
boundary condition.
 Rigid nodes are not assigned degrees of freedom.
\end_layout

\begin_layout LyX-Code
<bc type="rigid" node_set="set1">
\end_layout

\begin_layout LyX-Code
  <rb>2</rb>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
The 
\shape italic
rb 
\shape default
parameter defines the material (which must be a 
\begin_inset Quotes eld
\end_inset

rigid body
\begin_inset Quotes erd
\end_inset

 material) that in turn defines the rigid body.
 The node set must be defined in the 
\emph on
Mesh
\shape italic
\emph default
 
\shape default
section.
\end_layout

\begin_layout Subsection
Multiphasic Fluid Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Multiphasic-Fluid-Pressure"

\end_inset


\end_layout

\begin_layout Standard
In a multiphasic mixture the nodal degree of freedom for fluid pressure represents the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

,
 which is related to the actual fluid pressure 
\begin_inset Formula $p$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 One may assign the value of 
\begin_inset Formula $p$
\end_inset

 directly on a boundary,
 by using the 
\emph on
actual fluid pressure 
\emph default
boundary condition.
\end_layout

\begin_layout LyX-Code
<bc surface="FluidPressure1" type="actual fluid pressure">
\end_layout

\begin_layout LyX-Code
  <pressure>0</pressure>
\end_layout

\begin_layout LyX-Code
  <shell_bottom>0</shell_bottom>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
This surface load evaluates 
\begin_inset Formula $p$
\end_inset

 from nodal values of 
\begin_inset Formula $\tilde{p}$
\end_inset

 on the surface,
 and using the average values of 
\begin_inset Formula $\Phi$
\end_inset

 and 
\begin_inset Formula $c^{\alpha}$
\end_inset

 at the integration points of the underlying element.
 This surface load is particularly useful when the effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 are not prescribed as boundary conditions on that surface,
 but evolve with the analysis solution.
 the 
\emph on
shell_bottom
\emph default
 boolean flag (0=false,
 1=true) should be set to true when prescribing this pressure on the bottom of a multiphasic shell domain.
\end_layout

\begin_layout Subsection
Fluid Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Pressure-BC"

\end_inset


\end_layout

\begin_layout Standard
To set the actual fluid pressure 
\begin_inset Formula $p$
\end_inset

 in a fluid,
 fluid-FSI,
 or fluid-solutes analysis,
 use the 
\emph on
fluid pressure
\emph default
 boundary condition.
\end_layout

\begin_layout LyX-Code
<bc type="fluid pressure" surface="FluidPressure1">
\end_layout

\begin_layout LyX-Code
  <pressure lc="1">100</pressure>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
The optional 
\shape italic
lc 
\shape default
parameter associates a load curve (a user-defined scale factor that evolves with time) which multiplies the value of <pressure>.
 The surface must be defined in the 
\emph on
Mesh
\shape italic
\emph default
 
\shape default
section.
 For a biphasic analysis the actual fluid pressure is equal to the effective fluid pressure (
\begin_inset Formula $p=\tilde{p}$
\end_inset

),
 in which case use 
\emph on
prescribed fluid pressure
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Fluid-Pressure"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Fluid Resistance
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Resistance"

\end_inset


\end_layout

\begin_layout Standard
In a fluid,
 fluid-FSI or fluid-solutes analysis,
 this boundary condition prescribes an elastic pressure 
\begin_inset Formula $p=R\,q+p_{d}$
\end_inset

 on a surface,
 where 
\begin_inset Formula $R$
\end_inset

 is the flow resistance and 
\begin_inset Formula $q$
\end_inset

 is the volumetric flow rate across the surface (calculated internally);
 
\begin_inset Formula $p_{d}$
\end_inset

 is an optional offset pressure.
 The pressure 
\begin_inset Formula $p$
\end_inset

 is converted to a dilatation and prescribed as an essential boundary condition at the nodes of the facets.
\end_layout

\begin_layout LyX-Code
<bc type="fluid resistance" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <R lc="1">7.93e+07</R>
\end_layout

\begin_layout LyX-Code
  <pressure_offset lc="2">10640</pressure_offset>
\end_layout

\begin_layout LyX-Code
<bc>
\end_layout

\begin_layout Subsection
Fluid RCR
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-RCR"

\end_inset


\end_layout

\begin_layout Standard
This surface load models a three-element Windkessel outflow condition on a surface in a fluid,
 fluid-FSI or fluid-solutes analysis,
 as described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Vignon-Clementel06"
literal "false"

\end_inset

.
 It prescribes an elastic pressure 
\begin_inset Formula $p$
\end_inset

 on a surface,
 which satisfies the ordinary differential equation
\begin_inset Formula 
\[
p+\tau\frac{dp}{dt}=\left(R_{d}+R\right)q+R\tau\frac{dq}{dt}+p_{d}+\tau\frac{dp_{d}}{dt},\quad\tau=R_{d}C
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is the upstream flow resistance (series resistance),
 
\begin_inset Formula $R_{d}$
\end_inset

 is the downstream flow resistance and 
\begin_inset Formula $C$
\end_inset

 is the downstream flow capacitance (parallel 
\begin_inset Formula $R_{d}C$
\end_inset

 element downstream of 
\begin_inset Formula $R$
\end_inset

),
 whereas 
\begin_inset Formula $q$
\end_inset

 is the volumetric flow rate across the surface (calculated internally);
 
\begin_inset Formula $p_{d}$
\end_inset

 is an optional downstream offset pressure,
 which may be associated with a loadcurve to produce a function of time.
 The actual pressure 
\begin_inset Formula $p$
\end_inset

 obtained by solving this differential equation is converted to a dilatation and prescribed as an essential boundary condition at the nodes of the facets.
 Since the pressure is the solution of an ordinary differential equation,
 the user may also optionally specify the initial condition for the pressure.
\end_layout

\begin_layout LyX-Code
<bc name="FluidRCR1" type="fluid RCR" surface="FluidRCR1">
\end_layout

\begin_layout LyX-Code
  <R>1</R>
\end_layout

\begin_layout LyX-Code
  <Rd>10</Rd>
\end_layout

\begin_layout LyX-Code
  <capacitance>0.5</capacitance>
\end_layout

\begin_layout LyX-Code
  <pressure_offset>0</pressure_offset>
\end_layout

\begin_layout LyX-Code
  <initial_pressure>0</initial_pressure>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
By setting 
\begin_inset Formula $C=0$
\end_inset

 we recover the fluid resistance surface load described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Resistance"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 with flow resistance equal to 
\begin_inset Formula $R_{d}+R$
\end_inset

.
 By setting 
\begin_inset Formula $R$
\end_inset

 to zero we can have simulate a parallel 
\begin_inset Formula $R_{d}C$
\end_inset

 circuit.
\end_layout

\begin_layout Standard
Internally,
 the ordinary differential equation presented above is solved numerically using a standard finite difference scheme,
\begin_inset Formula 
\[
p_{n+1}=\left(\frac{R_{d}}{1+\frac{\tau}{\Delta t}}+R\right)q_{n+1}+\frac{\tau}{\Delta t+\tau}\left(p_{n}-p_{d,n}-Rq_{n}\right)+p_{d,n+1}
\]

\end_inset

where 
\begin_inset Formula $f_{n+1}$
\end_inset

 is the value of any function 
\begin_inset Formula $f\left(t\right)$
\end_inset

 at the current time step 
\begin_inset Formula $t_{n+1}$
\end_inset

,
 
\begin_inset Formula $f_{n}$
\end_inset

 is its value at the previous time step 
\begin_inset Formula $t_{n}$
\end_inset

,
 and 
\begin_inset Formula $\Delta t=t_{n+1}-t_{n}$
\end_inset

 is the time increment.
\end_layout

\begin_layout Subsection
Linear Constraints
\end_layout

\begin_layout Standard
A linear constraint can be used to couple nodal degrees of freedom.
 The linear constraint has one dependent degree of freedom 
\begin_inset Formula $u^{*}$
\end_inset

,
 and several independent degrees of freedom 
\begin_inset Formula $u_{i}$
\end_inset

.
 The linear constraint is defined as follows:
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u^{*}=c_{0}+c_{1}u_{1}+\ldots+c_{n}u_{n}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 the 
\begin_inset Formula $c_{i}$
\end_inset

 are user-specified scale factors and 
\begin_inset Formula $c_{0}$
\end_inset

can be used to specified an offset.
 
\end_layout

\begin_layout Standard
The dependent degree of freedom 
\begin_inset Formula $u^{*}$
\end_inset

will be removed from the linear system of equations.
 Consequently,
 this nodal degree of freedom should not be used in any other boundary condition.
 
\end_layout

\begin_layout Standard
To define a linear constraint,
 set the 
\emph on
type 
\emph default
attribute to 
\emph on
linear constraint
\emph default
.
 The dependent degree of freedom,
 i.e.
 the dof that will be removed,
 is specified via a node number and a dof identifier.
 Each child dof is defined via the 
\emph on
child_dof 
\emph default
tag and similarly requires the corresponding node and dof identifier,
 as well as the value parameter.
 
\end_layout

\begin_layout LyX-Code
<bc type="linear constraint">
\end_layout

\begin_layout LyX-Code
  <node>5</node>
\end_layout

\begin_layout LyX-Code
  <dof>x</dof>
\end_layout

\begin_layout LyX-Code
  <child_dof>
\end_layout

\begin_layout LyX-Code
    <node>8</node>
\end_layout

\begin_layout LyX-Code
    <dof>x</dof>
\end_layout

\begin_layout LyX-Code
    <value>1.0</value>
\end_layout

\begin_layout LyX-Code
  </child_dof>
\end_layout

\begin_layout LyX-Code
  <child_dof>
\end_layout

\begin_layout LyX-Code
    <node>9</node>
\end_layout

\begin_layout LyX-Code
    <dof>x</dof>
\end_layout

\begin_layout LyX-Code
    <value>-1.0</value>
\end_layout

\begin_layout LyX-Code
  </child_dof>
\end_layout

\begin_layout LyX-Code
</bc>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Rigid Section
\end_layout

\begin_layout Standard
The 
\emph on
Rigid
\emph default
 section is used to define all rigid constraints,
 rigid body initial kinematics,
 and rigid connectors.
 The motion of a point 
\begin_inset Formula $\mathbf{x}$
\end_inset

 connected to a rigid body is given by
\begin_inset Formula 
\begin{equation}
\mathbf{x}=\mathbf{r}\left(t\right)+\mathbf{R}\left(t\right)\cdot\mathbf{Z}=\mathbf{r}\left(t\right)+\mathbf{z}\left(t\right)\label{eq:rbm-position}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{r}\left(t\right)$
\end_inset

 is the position of the rigid body center of mass and 
\begin_inset Formula $\mathbf{R}\left(t\right)$
\end_inset

 is the body's (proper orthogonal) rotation tensor,
 which satisfies 
\begin_inset Formula $\mathbf{R}\left(t_{0}\right)=\mathbf{I}$
\end_inset

 at the initial time 
\begin_inset Formula $t_{0}$
\end_inset

;
 here,
 
\begin_inset Formula $\mathbf{z}\left(t\right)=\mathbf{R}\left(t\right)\cdot\mathbf{Z}$
\end_inset

 is the position vector of the point relative to the body's center of mass,
 and 
\begin_inset Formula $\mathbf{X}=\mathbf{r}\left(t_{0}\right)+\mathbf{Z}$
\end_inset

 is the initial position.
 In FEBio,
 the rotation is evaluated as 
\begin_inset Formula $\mathbf{R}\left(t\right)=\exp\left[\boldsymbol{\xi}\left(t\right)\right]$
\end_inset

,
 where 
\begin_inset Formula $\boldsymbol{\xi}\left(t\right)$
\end_inset

 is the material rotation of the rigid body from its reference configuration.
 In practice,
 
\begin_inset Formula $\boldsymbol{\xi}$
\end_inset

 is stored as a quaternion to facilitate the multiplication of rotation tensors.
 The exponential map 
\begin_inset Formula $\exp\left[\boldsymbol{\xi}\left(t\right)\right]$
\end_inset

 is given in full form as
\begin_inset Formula 
\begin{equation}
\mathbf{R}\left(t\right)=\exp\left[\boldsymbol{\xi}\left(t\right)\right]=\cos\xi\,\mathbf{I}-\sin\xi\,\boldsymbol{\mathcal{E}}\cdot\mathbf{n}+\left(1-\cos\xi\right)\mathbf{n}\otimes\mathbf{n}\label{eq:rbr-rotation-tensor}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{\mathcal{E}}$
\end_inset

 is the third-order permutation pseudo-tensor with rectangular components 
\begin_inset Formula $\varepsilon_{ijk}$
\end_inset

 (permutation symbol).
 Here,
 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the unit vector along the axis of rotation and 
\begin_inset Formula $\xi$
\end_inset

 is the angle of rotation about 
\begin_inset Formula $\mathbf{n}$
\end_inset

,
 such that 
\begin_inset Formula $\boldsymbol{\xi}=\xi\mathbf{n}$
\end_inset

.
 Both 
\begin_inset Formula $\xi$
\end_inset

 and 
\begin_inset Formula $\mathbf{n}$
\end_inset

 may evolve over time.
 Either none or all the components of 
\begin_inset Formula $\boldsymbol{\xi}\left(t\right)$
\end_inset

 must be prescribed (or fixed) for a rigid body.
\end_layout

\begin_layout Standard
The Rigid section can contain the following subsections.
 
\end_layout

\begin_layout Description
rigid_bc Define a rigid constraint.
 
\end_layout

\begin_layout Description
rigid_ic Define a rigid initial condition.
\end_layout

\begin_layout Description
rigid_load Define a load on a rigid body.
\end_layout

\begin_layout Description
rigid_connector Define a connection or joint between two rigid bodies.
 
\end_layout

\begin_layout Subsection
Rigid Constraints
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Constraints"

\end_inset


\end_layout

\begin_layout Standard
The rigid constraints section allows users to prescribe the kinematics applied to a single rigid body.
 The particular constraint is defined via the 
\emph on
type 
\emph default
attribute.
 
\end_layout

\begin_layout Standard
The following rigid constraints can be defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_fixed
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fix one or more rigid degrees of freedom.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_prescribed
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed the value of a rigid degree of freedom
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Rigid_fixed Constraint
\end_layout

\begin_layout Standard
The 
\emph on
rigid_fixed 
\emph default
constraint fixes one or multiple rigid degrees of freedom.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Rx_dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix x-displacement degree of freedom
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Ry_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix y-displacement degree of freedom
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Rz_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix z-displacement degree of freedom
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Ru_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix x-rotational degree of freedom
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Rv_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix y-rotational degree of freedom
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Rw_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fix z-rotational degree of freedom
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The name of the rigid material defined in the Material section.
 
\end_layout

\begin_layout Standard
The following example fixes the displacement degrees of freedom.
 
\end_layout

\begin_layout LyX-Code
<rigid_bc type="rigid_fixed">
\end_layout

\begin_layout LyX-Code
  <rb>1</rb>
\end_layout

\begin_layout LyX-Code
  <Rx_dof>1</Rx_dof>
\end_layout

\begin_layout LyX-Code
  <Ry_dof>1</Ry_dof>
\end_layout

\begin_layout LyX-Code
  <Rz_dof>1</Rz_dof>
\end_layout

\begin_layout LyX-Code
</rigid_bc>
\end_layout

\begin_layout Subsubsection
Rigid_displacement Constraint
\end_layout

\begin_layout Standard
The 
\emph on
rigid_displacement
\emph default
 constraint prescribes the value of a rigid displacement degree of freedom.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid degree of freedom to prescribe.
 (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines the value as relative or absolute.
 (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the name attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Enumerate
The values allowed for the 
\emph on
dof 
\emph default
parameter are:
 x,
 y,
 or z.
 
\end_layout

\begin_layout Enumerate
If the relative flag is set,
 the value is taken relative to the dof value at the start of the step.
\end_layout

\begin_layout Standard
The following example prescribes the x-displacement degree of freedom.
 
\end_layout

\begin_layout LyX-Code
<rigid_bc type="rigid_displacement">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <dof>x</dof>
\end_layout

\begin_layout LyX-Code
  <value lc="1">3.14</value>
\end_layout

\begin_layout LyX-Code
</rigid_bc>
\end_layout

\begin_layout Subsubsection
Rigid_rotation Constraint
\end_layout

\begin_layout Standard
The 
\emph on
rigid_rotation
\emph default
 constraint prescribes the value of a rigid rotational degree of freedom.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid degree of freedom to prescribe.
 (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines the value as relative or absolute.
 (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the name attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Enumerate
The values allowed for the 
\emph on
dof 
\emph default
parameter are:
 Ru,
 Rv,
 or Rw.
 
\end_layout

\begin_layout Enumerate
If the relative flag is set,
 the value is taken relative to the dof value at the start of the step.
\end_layout

\begin_layout Standard
The following example prescribes a rotation around the x-axis.
 
\end_layout

\begin_layout LyX-Code
<rigid_bc type="rigid_rotation">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <dof>Ru</dof>
\end_layout

\begin_layout LyX-Code
  <value lc="1">3.14</value>
\end_layout

\begin_layout LyX-Code
</rigid_bc>
\end_layout

\begin_layout Subsubsection
Rigid_rotation_vector Constraint
\end_layout

\begin_layout Standard
The 
\emph on
rigid_rotation_vector 
\emph default
constraint allows the user to prescribe the rotation of a rigid body using a rotation vector.
 In essence,
 this combines the effect of using three separate rigid rotation constraints,
 one for each component of the rotation vector,
 and thus might be a more convenient choice if the rotation of the rigid body is fully prescribed.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
vx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of the rotation vector
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
vy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of the rotation vector
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
vz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of the rotation vector
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the name attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Standard
The following example prescribes a rotation around the z-axis using a load controller.
 
\end_layout

\begin_layout LyX-Code
<rigid_bc type="rigid_rotation_vector">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <vx>0</vx>
\end_layout

\begin_layout LyX-Code
  <vy>0</vy>
\end_layout

\begin_layout LyX-Code
  <vz lc="1">3.14</vz>
\end_layout

\begin_layout LyX-Code
</rigid_bc>
\end_layout

\begin_layout Subsubsection
Rigid_euler_angles Constraint
\end_layout

\begin_layout Standard
The 
\emph on
rigid_euler_angles 
\emph default
constraint allows the user to prescribe the rotation of a rigid body using three Euler angles.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Ex
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
X Euler angle (degrees)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Ey
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Y Euler angle (degrees)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
Ez
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Z Euler angle (degrees)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the name attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Standard
The following example prescribes a rotation around the z-axis using a load controller.
 
\end_layout

\begin_layout LyX-Code
<rigid_bc type="rigid_euler_vector">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <vx>0</vx>
\end_layout

\begin_layout LyX-Code
  <vy>0</vy>
\end_layout

\begin_layout LyX-Code
  <vz lc="1">180.0</vz>
\end_layout

\begin_layout LyX-Code
</rigid_bc>
\end_layout

\begin_layout Subsection
Rigid Initial Conditions
\end_layout

\begin_layout Standard
The 
\emph on
rigid_ic 
\emph default
section defines the initial conditions on rigid bodies.
 The following rigid initial conditions can be applied.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
initial_rigid_velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial value for the rigid body velocity.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
initial_rigid_angular_velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the initial value for the rigid body angular velocity.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Initial Rigid Velocity
\end_layout

\begin_layout Standard
In dynamic analysis,
 the initial velocity of a rigid body can be set via the 
\emph on
initial_rigid_velocity
\emph default
 rigid constraint.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The initial velocity vector
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Standard
The following example defines an initial velocity for a rigid body.
 
\end_layout

\begin_layout LyX-Code
<rigid_ic type="initial_rigid_velocity">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <value>1,0,0</value>
\end_layout

\begin_layout LyX-Code
</rigid_ic>
\end_layout

\begin_layout Subsubsection
Initial Rigid Angular Velocity
\end_layout

\begin_layout Standard
In dynamic analysis,
 the initial angular velocity of a rigid body can be set via the 
\emph on
initial_rigid_angular_velocity
\emph default
 rigid constraint.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name.
 (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The initial angular velocity vector
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Standard
The following example defines an initial angular velocity for a rigid body.
 
\end_layout

\begin_layout LyX-Code
<rigid_ic type="initial_rigid_angular_velocity">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <value>1,0,0</value>
\end_layout

\begin_layout LyX-Code
</rigid_ic>
\end_layout

\begin_layout Subsection
Rigid Loads
\end_layout

\begin_layout Standard
The 
\emph on
rigid_load 
\emph default
section can be used to applied loads to a rigid body.
 The following rigid loads can be defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Apply a force to the center of the rigid body
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_axial_force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An axial force between two rigid bodies.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_follower_force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A force that follows the motion of the rigid body.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_follower_moment
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A moment that follows the motion of the rigid body.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_cable
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A force applied through a 
\begin_inset Quotes eld
\end_inset

cable
\begin_inset Quotes erd
\end_inset

 that connects multiple rigid bodies.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Rigid_force Load
\end_layout

\begin_layout Standard
The 
\emph on
rigid_force
\emph default
 load applies a load directly to the rigid degree of freedom.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid degree of freedom to prescribe.
 (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed force value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
load_type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines the type of load.
 (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Enumerate
The values allowed for the 
\emph on
dof 
\emph default
parameter are:
 Rx,
 Ry,
 Rz.
 
\end_layout

\begin_layout Enumerate
The load_type allows the following values:
\end_layout

\begin_deeper
\begin_layout Enumerate
0 = a load (force/moment) is applied directly to the degree of freedom.
 
\end_layout

\begin_layout Enumerate
1 = a follower load applied is applied to the rigid body.
 The load is applied in the rigid body's coordinate system,
 so it rotates with the rigid body.
 This only works for Rx,
 Ry,
 Rz.
 
\end_layout

\begin_layout Enumerate
2 = target load.
 The load's value is ramped up from its initial value at the start of the step,
 and ramped up linearly to the value specified in the 
\emph on
value 
\emph default
parameter.
 
\end_layout

\end_deeper
\begin_layout Standard
The following example applies a force in the x-direction.
 
\end_layout

\begin_layout LyX-Code
<rigid_load type="rigid_force">
\end_layout

\begin_layout LyX-Code
  <rb>1</rb>
\end_layout

\begin_layout LyX-Code
  <dof>Rx</dofs>
\end_layout

\begin_layout LyX-Code
  <value lc="1">3.14</value>
\end_layout

\begin_layout LyX-Code
</rigid_load>
\end_layout

\begin_layout Subsubsection
Rigid_moment Load
\end_layout

\begin_layout Standard
The 
\emph on
rigid_moment
\emph default
 load applies a moment about a partical coordinate axis.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
dof
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid degree of freedom to prescribe.
 (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed moment value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines the type of load.
 (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Enumerate
The values allowed for the 
\emph on
dof 
\emph default
parameter are:
 Ru,
 Rv,
 Rw.
 
\end_layout

\begin_layout Enumerate
The relative flag indicates whether the applied value should be absolute or relative to the value at the end of the previous analysis step.
\end_layout

\begin_layout Standard
The following example applies a moment about the x-axis.
 
\end_layout

\begin_layout LyX-Code
<rigid_load type="rigid_moment">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <dof>Ru</dofs>
\end_layout

\begin_layout LyX-Code
  <value lc="1">3.14</value>
\end_layout

\begin_layout LyX-Code
</rigid_load>
\end_layout

\begin_layout Subsubsection
Rigid_follower_force Load
\end_layout

\begin_layout Standard
The 
\emph on
rigid_follower_force
\emph default
 load applies a force in the local rigid body coortinate system.
 The direction of the force in global coordinates therefore depends on orientation of the rigid body.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Location where the force is applied.
 (2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The vector force value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Relative flag (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Enumerate
This is the position in the reference coordinate system of the point where the force is applied.
 
\end_layout

\begin_layout Enumerate
The relative flag indicates whether the applied value should be absolute or relative to the value at the end of the previous analysis step.
\end_layout

\begin_layout Standard
The following example applies a moment about the x-axis.
 
\end_layout

\begin_layout LyX-Code
<rigid_load type="rigid_follower_force">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <insertion>1,2,3</dofs>
\end_layout

\begin_layout LyX-Code
  <force>100,0,0</force>
\end_layout

\begin_layout LyX-Code
</rigid_load>
\end_layout

\begin_layout Subsubsection
Rigid_follower_moment Load
\end_layout

\begin_layout Standard
The 
\emph on
rigid_follower_
\emph default
moment load applies a moment in the local rigid body coortinate system.
 The direction of the moment in global coordinates therefore depends on orientation of the rigid body.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rb
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rigid body's material name (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The vector moment value
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
This is the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute assigned to the corresponding rigid body material as defined in the Material section.
\end_layout

\begin_layout Standard
The following example applies a moment about the x-axis.
 
\end_layout

\begin_layout LyX-Code
<rigid_load type="rigid_follower_moment">
\end_layout

\begin_layout LyX-Code
  <rb>rigid</rb>
\end_layout

\begin_layout LyX-Code
  <moment>100,0,0</force>
\end_layout

\begin_layout LyX-Code
</rigid_load>
\end_layout

\begin_layout Subsubsection
Rigid_cable Load
\end_layout

\begin_layout Standard
The 
\emph on
rigid_cable
\emph default
 load emulates the effect of a force applied on one end of a cable that is connected to one or more rigid bodies.
 It requires the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The scalar force magnitude
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force_direction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The unit vector defining the force direction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0,0,0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indicates whether the through-points are defined in global or relative coordinates (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid_cable_point
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A point on a rigid body that the cable runs through.
 (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The 
\emph on
relative 
\emph default
flag indicates whether the location of the cable's via-points are defined in global coordinates (relative=0) or in the local coordinates of the corresponding rigid body (relative=1).
 
\end_layout

\begin_layout Enumerate
One or more rigid cable points must be defined that define the points that the cable runs through.
 The first point defined is the anchor,
 where the cable is attached to.
 The other points define the via points,
 i.e.
 a point where the cable runs through.
 Each cable point is defined by the rigid body that it connects to and a point on the rigid body that the cable runs through.
 The point's coordinates are either in the global or the local coordinate system of the rigid body,
 as determined by the 
\emph on
relative 
\emph default
flag.
 
\end_layout

\begin_layout Standard
The following example illustrates a rigid cable setup.
 
\end_layout

\begin_layout LyX-Code
<rigid_load type="rigid_cable">
\end_layout

\begin_layout LyX-Code
  <force lc="1">100</force>
\end_layout

\begin_layout LyX-Code
  <force_direction>1,0,0</force_direction>
\end_layout

\begin_layout LyX-Code
  <relative>1</relative>
\end_layout

\begin_layout LyX-Code
  <rigid_cable_point>
\end_layout

\begin_layout LyX-Code
    <rigid_body_id>rigid1</rigid_body_id>
\end_layout

\begin_layout LyX-Code
    <position>0,
 -1,
 1</position>
\end_layout

\begin_layout LyX-Code
  </rigid_cable_point>
\end_layout

\begin_layout LyX-Code
  <rigid_cable_point>
\end_layout

\begin_layout LyX-Code
    <rigid_body_id>rigid2</rigid_body_id>
\end_layout

\begin_layout LyX-Code
    <position>0,
 1,
 1</position>
\end_layout

\begin_layout LyX-Code
  </rigid_cable_point>
\end_layout

\begin_layout LyX-Code
</rigid_load>
\end_layout

\begin_layout Subsection
Rigid Connectors
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Connectors"

\end_inset


\end_layout

\begin_layout Standard
The rigid connector section allows users to define different type of connections between two rigid bodies.
 The specific connector is defined via the 
\emph on
type 
\emph default
attribute.
 
\end_layout

\begin_layout Standard
The rigid connectors fall into two categories.
 The first category define different joints that contstrain the relative motion of one rigid body with respect to the second one.
 
\end_layout

\begin_layout Standard
Rigid joints produce nonlinear constraints between rigid bodies,
 which prevent relative motion except along the degrees of freedom of the joint.
 The term `rigid' refers to the bodies,
 not to the joints.
 Each rigid joint needs to define two rigid bodies (
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b)$
\end_inset

,
 a joint origin common to both bodies,
 and a set of axes that determine the relative orientation of the joint degrees of freedom.
 These axes define orthonormal basis vectors 
\begin_inset Formula $\left\{ \mathbf{e}_{1}^{a},\mathbf{e}_{2}^{a},\mathbf{e}_{3}^{a}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mathbf{e}_{1}^{b},\mathbf{e}_{2}^{b},\mathbf{e}_{3}^{b}\right\} $
\end_inset

 on each rigid body,
 with both bases being coincident,
 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

,
 at the start of the analysis,
 and given in world coordinates.
\end_layout

\begin_layout Standard
The rigid joint nonlinear constraints produce reaction forces and moments that are enforced with penalty parameters and Lagrange multipliers.
 The penalty parameters,
 
\emph on
force_penalty
\emph default
 and 
\emph on
moment_penalty
\emph default
,
 may be conceptualized as stiffnesses of linear/torsional springs that prevent relative translations/rotations of the rigid bodies along degrees of freedom that must remain constrained for that joint.
 The penalty values should be selected based on a rough estimation of the maximum reactions forces and moments acting at these joints,
 divided by the maximum amount of linear/angular separation that your analysis can tolerate for that joint.
 Alternatively,
 set the 
\emph on
force_penalty
\emph default
 and 
\emph on
moment_penalty
\emph default
 parameters to 1 and turn on the 
\emph on
auto_penalty
\emph default
;
 this setting will automatically adjust the 
\emph on
force_penalty
\emph default
 and 
\emph on
moment_penalty
\emph default
 to an appropriate value.
\end_layout

\begin_layout Standard
The augmented Lagrangian method is used by default,
 where the joint reaction force and moment are treated as Lagrange multipliers,
 augmented at each time step by the product of the force/moment penalty parameter and the linear/angular gap.
 Use the parameter 
\emph on
maxaug
\emph default
 to control the maximum allowable number of augmentations at each time step (
\emph on
maxaug
\emph default
=0 produces the penalty method);
 use a non-zero value for the parameter 
\emph on
minaug
\emph default
 to ensure a minimum number of augmentations.
 Augmentations will proceed until the relative change in the reaction force/moment magnitude is less than 
\emph on
tolerance
\emph default
,
 and/or the linear gap is less than 
\emph on
gaptol
\emph default
,
 and/or the angular gap is less than 
\emph on
angtol
\emph default
.
 Setting any of these parameters to zero disables that check.
\end_layout

\begin_layout Standard
The nonlinear constraints that enforce these joints produce a non-symmetric stiffness matrix.
 Therefore,
 when using rigid joints,
 use the analysis setting for a non-symmetric formulation,
 see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Parameters-Solid-Analysis"
nolink "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The following rigid joints can be defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid spherical joint
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Connect rigid bodies at point.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid revolute joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rotation about a single prescribed axis
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid prismatic joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Translation along a single prescribed axis.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid cylindrical joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rotation and translation about prescribed axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid planar joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2D plane translation and rotation about normal.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid lock
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prevent any relative motion between rigid bodies.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The second category of connectors apply a force on the rigid bodies that is proportional to some relative motion.
 The term `rigid' refers to the bodies,
 not to the connectors.
\end_layout

\begin_layout Standard
The following rigid connectors can be defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid spring
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applies a spring that connects the two rigid bodies.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid damper
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applies a damper based on relative linear velocity.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid angular damper
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applies a damper based on relative angular velocity.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid contractile force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Constant contractile force between rigid bodies.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid planar joint
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2D plane translation and rotation about normal.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rigid lock
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prevent any relative motion between rigid bodies.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
All of these joints and connectors define two parameters that reference the two rigid bodies.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
body_a
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The first rigid body in the connector
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
body_b
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The second rigid body in the connector
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In addition,
 the joints definde above are all based on the Augmented Lagrangian method,
 and consequently,
 also share the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
laugon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Augmentation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specifies the augmentation tolerance
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
minaug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The minimum number of augmentations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
maxaug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum number of augmentations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
gaptol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gap tolerance
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
angtol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Angular separation tolerance
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Penalty factor applied to force augmentations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Penalty factor applied to moment augmentations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
auto_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag to calculate penalty factor automatically.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Additional parameters,
 unique to a specific connector,
 are defined in the sections below.
 
\end_layout

\begin_layout Subsubsection
Rigid Spherical Joint
\end_layout

\begin_layout Standard
A rigid spherical joint connects rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at a point in space,
 allowing three degrees of freedom for rotation about that point.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The prescribed rotation flag.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation_x
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The x-component of the prescribed rotation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation_y
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The y-component of the prescribed rotation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation_z
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The z-component of the prescribed rotation.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment_x
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
X-component of applied moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment_y
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Y-component of applied moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment_z
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Z-component of applied moment 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 Setting either of these elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
rotation_axis 
\shape default
element defines the orientation of the joint rotation axis in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard
Optionally,
 the rotation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
<prescribed_rotation>1</prescribed_rotation>
\end_layout

\begin_layout LyX-Code
<rotation_x lc="1">1</rotation_x>
\end_layout

\begin_layout LyX-Code
<rotation_y lc="2">1</rotation_y>
\end_layout

\begin_layout LyX-Code
<rotation_z>0</rotation_z>
\end_layout

\begin_layout Standard
The 
\shape italic
prescribed_rotation
\shape default
 element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed,
 0 for free).
 The 
\shape italic
rotation_x
\shape default
,
 
\shape italic
rotation_y
\shape default
 and 
\shape italic
rotation_z
\shape default
 elements specify the components 
\begin_inset Formula $\left(\theta_{1},\theta_{2},\theta_{3}\right)$
\end_inset

 of rotation (with units of radians),
 with optional associated load curves.
 The rotation occurs about the axis directed along 
\begin_inset Formula $\theta_{1}\mathbf{e}_{1}^{a}+\theta_{2}\mathbf{e}_{2}^{a}+\theta_{3}\mathbf{e}_{3}^{a}$
\end_inset

,
 with a magnitude 
\begin_inset Formula $\sqrt{\theta_{1}^{2}+\theta_{2}^{2}+\theta_{3}^{2}}$
\end_inset

.
 Either all or none of the rotation components must be prescribed,
 since all rotation components are needed to define a rotation tensor.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces tracking of the prescribed rotations between the two bodies.
\end_layout

\begin_layout Standard
Optionally,
 moments may be prescribed on body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

,
 about the world coordinate axes,
 using the additional tag
\end_layout

\begin_layout LyX-Code
<moment_x lc="3">1.e-3</moment_x>
\end_layout

\begin_layout LyX-Code
<moment_y lc="4">3.e-3</moment_y>
\end_layout

\begin_layout LyX-Code
<moment_z lc="5">2.e-3</moment_z>
\end_layout

\begin_layout Standard
The 
\shape italic
moment
\shape default
 elements specify the components of the moment vector in world coordinates,
 with optional associated load curves.
 The 
\shape italic
moment
\shape default
 elements should not be used simultaneously with a prescribed rotation.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid spherical joint" name="Joint01">
\end_layout

\begin_layout LyX-Code
  <tolerance>0.1</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>0</gaptol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>0,0,0</joint_origin>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Revolute Joint
\end_layout

\begin_layout Standard
The rigid revolute joint connector allows the user to connect two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at a point in space and allow rotation about a single prescribed axis.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The rotation axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The transverse axis.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation around axis.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applied moment about axis.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 The 
\shape italic
angtol
\shape default
 element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians).
 Setting any of these three elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint origin (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
rotation_axis 
\shape default
element defines the orientation of the joint rotation axis 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard
Optionally,
 the rotation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_rotation>1</prescribed_rotation>
\end_layout

\begin_layout LyX-Code
<rotation lc="1">3.14159</rotation>
\end_layout

\begin_layout Standard
The 
\shape italic
prescribed_rotation
\shape default
 element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed,
 0 for free).
 The 
\shape italic
rotation
\shape default
 element specifies the amount of rotation (with units of radians) with an optional associated load curve.
\end_layout

\begin_layout Standard
Optionally,
 a moment may be prescribed on body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

,
 about the joint axis,
 using the additional tag
\end_layout

\begin_layout LyX-Code
<moment lc="1">5.e-3</moment>
\end_layout

\begin_layout Standard
The 
\shape italic
moment
\shape default
 element specifies the magnitude of the moment,
 with an optional associated load curve.
 The 
\shape italic
moment
\shape default
 element should not be used simultaneously with a prescribed rotation.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid revolute joint" name="Joint 1">
\end_layout

\begin_layout LyX-Code
  <tolerance>0</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>1e-4</gaptol>
\end_layout

\begin_layout LyX-Code
  <angtol>1e-4</angtol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>3</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>-150,0,2</joint_origin>
\end_layout

\begin_layout LyX-Code
  <rotation_axis>0,0,1</rotation_axis>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Prismatic Joint
\end_layout

\begin_layout Standard
The rigid prismatic joint connector allows the user to connect two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at a point in space and allow translation along a single prescribed axis.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The translation axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The transverse axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_translation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation along axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applied force along axis.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 The 
\shape italic
angtol
\shape default
 element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians).
 Setting any of these three elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
translation_axis 
\shape default
element defines the orientation 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 of the joint translation axis in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard
Optionally,
 the translation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_translation>1</prescribed_translation>
\end_layout

\begin_layout LyX-Code
<translation lc="1">5.0</translation>
\end_layout

\begin_layout Standard
The 
\shape italic
prescribed_translation
\shape default
 element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed,
 0 for free).
 The 
\shape italic
translation
\shape default
 element specifies the amount of translation (with units of length) with an optional associated load curve.
\end_layout

\begin_layout Standard
Optionally,
 a force may be prescribed on body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

,
 along the joint axis using the additional tag
\end_layout

\begin_layout LyX-Code
<force lc="1">5.e-3</force>
\end_layout

\begin_layout Standard
The 
\shape italic
force
\shape default
 element specifies the magnitude of the force,
 with an optional associated load curve.
 The 
\shape italic
force
\shape default
 element should not be used simultaneously with a prescribed translation.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid prismatic joint" name="Joint02 ">
\end_layout

\begin_layout LyX-Code
  <tolerance>0</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>1e-4</gaptol>
\end_layout

\begin_layout LyX-Code
  <angtol>1e-4</angtol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>4</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>1</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>-150,0,2</joint_origin>
\end_layout

\begin_layout LyX-Code
  <translation_axis>1,0,0</translation_axis>
\end_layout

\begin_layout LyX-Code
  <prescribed_translation>150</prescribed_translation>
\end_layout

\begin_layout LyX-Code
  <translation lc="1">1</translation>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Cylindrical Joint
\end_layout

\begin_layout Standard
A rigid cylindrical joint connects rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at a point in space,
 allowing one degree of freedom for rotation about an axis through that point,
 and another degree of freedom for translation along that axis.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The joint axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
transverse_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The transverse axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_translation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation along axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applied force along axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation around axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
moment
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Applied moment about axis.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 The 
\shape italic
angtol
\shape default
 element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians).
 Setting any of these three elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
joint_axis 
\shape default
element defines the orientation 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 of the joint rotation and translation axis in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard
Optionally,
 the rotation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_rotation>1</prescribed_rotation>
\end_layout

\begin_layout LyX-Code
<rotation lc="1">1.570796327</rotation>
\end_layout

\begin_layout Standard
The 
\shape italic
prescribed_rotation
\shape default
 element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed,
 0 for free).
 The 
\shape italic
rotation
\shape default
 element specifies the amount of rotation (with units of radians) with an optional associated load curve.
\end_layout

\begin_layout Standard
Optionally,
 the translation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_translation>1</prescribed_translation>
\end_layout

\begin_layout LyX-Code
<translation lc="2">10.0</translation>
\end_layout

\begin_layout Standard
Optionally,
 a moment may be prescribed about the joint axis using the additional tag
\end_layout

\begin_layout LyX-Code
<moment lc="1">5.e-3</moment>
\end_layout

\begin_layout Standard
The 
\shape italic
moment
\shape default
 element specifies the magnitude of the moment,
 with an optional associated load curve.
 The 
\shape italic
moment
\shape default
 element should not be used simultaneously with a prescribed rotation.
\end_layout

\begin_layout Standard
Optionally,
 a force may be prescribed along the joint axis using the additional tag
\end_layout

\begin_layout LyX-Code
<force lc="1">2.0</force>
\end_layout

\begin_layout Standard
The 
\shape italic
force
\shape default
 element specifies the magnitude of the force,
 with an optional associated load curve.
 The 
\shape italic
force
\shape default
 element should not be used simultaneously with a prescribed translation.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid cylindrical joint" name="Joint03">
\end_layout

\begin_layout LyX-Code
  <tolerance>0</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>1e-4</gaptol>
\end_layout

\begin_layout LyX-Code
  <angtol>1e-4</angtol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>0,0,0</joint_origin>
\end_layout

\begin_layout LyX-Code
  <joint_axis>0,0,1</joint_axis>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Planar Joint
\end_layout

\begin_layout Standard
A rigid planar joint connects rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

,
 allowing one degree of freedom for rotation about the axis 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 through that point,
 and two degrees of freedom for translations in the plane perpendicular to that axis,
 along 
\begin_inset Formula $\mathbf{e}_{2}^{a}$
\end_inset

 and 
\begin_inset Formula $\mathbf{e}_{3}^{a}$
\end_inset

.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The joint axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation_axis_1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The first translation axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
rotation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed rotation around axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_translation_1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation 1 flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation_1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation along axis 1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
prescribed_translation_2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation 2 flag
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
translation_2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed translation along axis 2
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 The 
\shape italic
angtol
\shape default
 element defines the tolerance for angular separation of the joint axes on the two bodies (in units of radians).
 Setting any of these three elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating along the rotation axis.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint rotation axis on the two bodies.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
rotation_axis 
\shape default
element defines the orientation of the joint rotation axis 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 in world coordinates at the start of the analysis.
 The 
\shape italic
translation_axis_1
\shape default
 element defines the orientation of the joint translation axis 
\begin_inset Formula $\mathbf{e}_{2}^{a}$
\end_inset

 in the plane perpendicular to the joint rotation axis,
 in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard
Optionally,
 the rotation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_rotation>1</prescribed_rotation>
\end_layout

\begin_layout LyX-Code
<rotation lc="1">1.570796327</rotation>
\end_layout

\begin_layout Standard
The 
\shape italic
prescribed_rotation
\shape default
 element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed,
 0 for free).
 The 
\shape italic
rotation
\shape default
 element specifies the amount of rotation (with units of radians) with an optional associated load curve.
\end_layout

\begin_layout Standard
Optionally,
 the translation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed along 
\begin_inset Formula $\mathbf{e}_{2}^{a}$
\end_inset

 using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_translation_1>1</prescribed_translation_1>
\end_layout

\begin_layout LyX-Code
<translation_1 lc="2">10.0</translation_1>
\end_layout

\begin_layout Standard
Optionally,
 the translation of body 
\begin_inset Formula $b$
\end_inset

 relative to body 
\begin_inset Formula $a$
\end_inset

 may be prescribed along 
\begin_inset Formula $\mathbf{e}_{3}^{a}$
\end_inset

 using the additional tags
\end_layout

\begin_layout LyX-Code
<prescribed_translation_2>1</prescribed_translation_2>
\end_layout

\begin_layout LyX-Code
<translation_2 lc="2">10.0</translation_2>
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid planar joint" name="Joint01">
\end_layout

\begin_layout LyX-Code
  <tolerance>0</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>1e-4</gaptol>
\end_layout

\begin_layout LyX-Code
  <angtol>1e-4</angtol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>0,0,0</joint_origin>
\end_layout

\begin_layout LyX-Code
  <rotation_axis>0,-0.5,0.8660254</rotation_axis>
\end_layout

\begin_layout LyX-Code
  <translation_axis_1>1,0,0</translation_axis_1>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Lock Joint
\end_layout

\begin_layout Standard
A rigid lock connects rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

,
 preventing relative motion between them.
 It requires the specification of a joint origin and two orthgonal axes 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{e}_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
joint_origin
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The position of the joint.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
first_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The first axis.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
second_axis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The second axis.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
tolerance 
\shape default
element defines the augmentation tolerance.
 That is,
 when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value.
 The 
\shape italic
gaptol
\shape default
 element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length).
 The 
\shape italic
angtol
\shape default
 element defines the tolerance for angular separation of the joint axes on the two bodies (in units of radians).
 Setting any of these three elements to zero disables the enforcement of that tolerance.
 The 
\shape italic
force_penalty
\shape default
 parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating along the rotation axis.
 The 
\shape italic
moment_penalty
\shape default
 parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint rotation axis on the two bodies.
 The 
\shape italic
body_a
\shape default
 and 
\shape italic
body_b 
\shape default
elements are the material numbers of the two rigid bodies.
 The 
\shape italic
joint_origin 
\shape default
element defines the position of the joint (the origin of the basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )$
\end_inset

 in world coordinates at the start of the analysis.
 Note that this point does not have to be inside or on the surface of either of the two bodies.
 The 
\shape italic
first_axis 
\shape default
element defines the orientation of the axis 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 in world coordinates at the start of the analysis.
 The 
\shape italic
second_axis
\shape default
 element defines the orientation of the second axis 
\begin_inset Formula $\mathbf{e}_{2}$
\end_inset

 in world coordinates at the start of the analysis.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid lock" name="Joint01">
\end_layout

\begin_layout LyX-Code
  <tolerance>0</tolerance>
\end_layout

\begin_layout LyX-Code
  <gaptol>1e-4</gaptol>
\end_layout

\begin_layout LyX-Code
  <angtol>1e-4</angtol>
\end_layout

\begin_layout LyX-Code
  <force_penalty>1e0</force_penalty>
\end_layout

\begin_layout LyX-Code
  <moment_penalty>1e0</moment_penalty>
\end_layout

\begin_layout LyX-Code
  <auto_penalty>1</auto_penalty>
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <joint_origin>0,0,0</joint_origin>
\end_layout

\begin_layout LyX-Code
  <first_axis>1,0,0</first_axis>
\end_layout

\begin_layout LyX-Code
  <second_axis>0,1,0</second_axis>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Spring
\end_layout

\begin_layout Standard
The rigid spring applies a linear spring that connects two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at arbitrary points (not necessarily nodes).
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
spring constant (in units of force per length)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insertion point of the spring on body a
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_b
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insection point of the spring on body b
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
free_length
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The length of the unloaded spring (1) 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
If the free_length parameter is zero,
 then the initial length of the spring,
 as defined by the two insertion points,
 is taken as the free length.
 
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid spring">
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <insertion_a>0,0,1</insertion_a>
\end_layout

\begin_layout LyX-Code
  <insertion_b>0,0,3</insertion_b>
\end_layout

\begin_layout LyX-Code
  <k>1</k>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Damper
\end_layout

\begin_layout Standard
The rigid damper applies a linear damper that connects two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 at arbitrary points (not necessarily nodes).
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
c
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Damping constant
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insertion point of the spring on body a
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_b
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insection point of the spring on body b
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid damper">
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <insertion_a>0,0,1</insertion_a>
\end_layout

\begin_layout LyX-Code
  <insertion_b>0,0,3</insertion_b>
\end_layout

\begin_layout LyX-Code
  <c>1e-7</c>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Angular Damper
\end_layout

\begin_layout Standard
The rigid angular damper applies an angular damper that connects two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
c
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Angular damping constant
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid angular damper">
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <c>1e-3</c>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Subsubsection
Rigid Contractile Force
\end_layout

\begin_layout Standard
The rigid contractile force applies an actuator force between arbitrary points (not necessarily nodes) on two rigid bodies 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Standard
In addition to the shared parameters above,
 it defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
f0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The applied force (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insertion point of the spring on body a
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\emph on
insertion_b
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Insection point of the spring on body b
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The f0 parameter represents the actuator force (positive for contraction).
 Optionally,
 it may be associated with a load curve.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<rigid_connector type="rigid contractile force">
\end_layout

\begin_layout LyX-Code
  <body_a>1</body_a>
\end_layout

\begin_layout LyX-Code
  <body_b>2</body_b>
\end_layout

\begin_layout LyX-Code
  <insertion_a>0,0,1</insertion_a>
\end_layout

\begin_layout LyX-Code
  <insertion_b>0,0,3</insertion_b>
\end_layout

\begin_layout LyX-Code
  <f0 lc="1">1</f0>
\end_layout

\begin_layout LyX-Code
</rigid_connector>
\end_layout

\begin_layout Section
Loads Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Loads-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Loads 
\shape default
section defines all nodal,
 edge,
 surface,
 and body loads that can be applied to the model.
\end_layout

\begin_layout Subsection
Nodal Loads
\begin_inset CommandInset label
LatexCommand label
name "subsec:Nodal-Loads"

\end_inset


\end_layout

\begin_layout Standard
Nodal loads are applied by the 
\shape italic
nodal_load 
\shape default
element.
 The nodal load is defined by the 
\emph on
type 
\emph default
attribute.
 The following table lists the available nodal loads.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal_load
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A load that is added to the corresponding's dofs in the global force vector.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal_force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A force applied to each node of a node set
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
nodal_load
\end_layout

\begin_layout Standard
The nodal_load adds a value directly to the corresponding degrees of freedom in the global external load vector.
 When the loads are applied to displacement degrees of freedom,
 the forces always point in the same direction and do not deform with the geometry (i.e.
 they are non-follower forces).
 For other degrees of freedom they define a constant normal flux.
\end_layout

\begin_layout LyX-Code
<nodal_load type="nodal_load" node_set="set1">
\end_layout

\begin_layout LyX-Code
  <dof>x</dof>
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
</nodal_load>
\end_layout

\begin_layout Standard
The 
\shape italic
dof
\shape default
 parameter defins the degree of freedom.
 The following values are allowed:
\end_layout

\begin_layout Description
x apply force in 
\begin_inset Formula $x$
\end_inset

-direction
\end_layout

\begin_layout Description
y apply force in 
\begin_inset Formula $y$
\end_inset

-direction
\end_layout

\begin_layout Description
z apply force in 
\begin_inset Formula $z$
\end_inset

-direction
\end_layout

\begin_layout Description
p apply normal volumetric fluid flow rate
\end_layout

\begin_layout Description
c
\begin_inset Formula $n$
\end_inset

 apply normal molar solute flow rate
\end_layout

\begin_layout Description
t apply normal heat flux (heat transfer analysis)
\end_layout

\begin_layout Standard
For solutes,
 replace 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $n$
\end_inset


\begin_inset Quotes erd
\end_inset

 with the solute id from the global solute table (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

);
 for example,
 
\begin_inset Quotes eld
\end_inset

c2
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Standard
An optional 
\shape italic
loadcurve
\shape default
 can be specified for the 
\shape italic
scale 
\shape default
parameter with the 
\shape italic
lc
\shape default
 attribute.
\end_layout

\begin_layout Subsubsection
nodal_force
\end_layout

\begin_layout Standard
This nodal load defines a force that is applied to each node in the node set.
 The 
\emph on
value 
\emph default
parameter sets the force vector.
 An optional load curve can be defined to scale the vector.
 
\end_layout

\begin_layout LyX-Code
<nodal_load type="nodal_force" node_set="set1">
\end_layout

\begin_layout LyX-Code
  <value lc="1">1,0,0</scale>
\end_layout

\begin_layout LyX-Code
</nodal_load>
\end_layout

\begin_layout Subsection
Surface Loads
\begin_inset CommandInset label
LatexCommand label
name "subsec:Surface-Loads"

\end_inset


\end_layout

\begin_layout Standard
A surface load can be applied using the 
\shape italic
surface_load 
\shape default
element.
 This element takes two attributes,
 namely 
\shape italic
type
\shape default
,
 which defines the type of surface load that will be applied,
 and 
\shape italic
surface 
\shape default
which defines the surface that this load will be applied to.
\end_layout

\begin_layout Subsubsection
Pressure Load
\begin_inset CommandInset label
LatexCommand label
name "subsec:Pressure-Load"

\end_inset


\end_layout

\begin_layout Standard
Pressure loads are applied to the surface of the geometry and are defined by the 
\shape italic
surface_load 
\shape default
element with the type attribute set to 
\shape italic
pressure
\shape default
.
 These pressure forces are also known as 
\shape italic
follower forces
\shape default
;
 they change direction as the body is deformed and,
 in this case,
 are always oriented along the local surface normal.
 The sign convention is so that a positive pressure will act opposite to the normal,
 so it will compress the material.
 The surface that the load is applied to is specified with the 
\emph on
surface 
\emph default
attribute.The surface must be defined in the 
\emph on
Mesh
\shape italic
\emph default
 
\shape default
section.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The applied pressure values (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 [
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric stiffness flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear flag (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell_bottom
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell bottom flag (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The 
\shape italic
pressure 
\shape default
element defines the pressure value [
\series bold
P
\series default
].
 The optional parameter 
\shape italic
lc
\shape default
 defines a loadcurve for the pressure evolution.
 If 
\shape italic
lc
\shape default
 is not defined a constant pressure is applied.
\end_layout

\begin_layout Enumerate
The optional 
\emph on
symmetric_stiffness
\emph default
 parameter (0 or 1) determines whether to use the exact form of the stiffness matrix for this surface load (0=non-symmetric),
 or the symmetric form (1=default).
 The non-symmetric form is numerically more robust,
 but it may also require using a globally non-symmetric stiffness matrix (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Parameters-Solid-Analysis"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Enumerate
If the optional 
\emph on
linear 
\emph default
parameter is set to 1,
 a constant,
 deformation independent pressure load is applied.
 This is not recommend for large deformations.
 
\end_layout

\begin_layout Enumerate
When the 
\emph on
shell_bottom
\emph default
 flag is set to 1,
 the surface is assumed to be a shell surface and the pressure is applied to the bottom part of the shell surface.
 
\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
\end_layout

\begin_layout LyX-Code
<surface_load type="pressure" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <pressure lc="1">1.0</pressure>
\end_layout

\begin_layout LyX-Code
  <symmetric_stiffness>0</symmetric_stiffness>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsubsection
Traction Load
\begin_inset CommandInset label
LatexCommand label
name "subsec:Traction-Load"

\end_inset


\end_layout

\begin_layout Standard
A traction load applies a traction to a surface.
 The direction of the traction remains unchanged as the mesh deforms.
\end_layout

\begin_layout LyX-Code
<surface_load type="traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <traction>0,0,1</traction>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The traction vector is determined by two quantities.
 The direction and magnitude is defined by the 
\shape italic
traction 
\shape default
element.
 In addition,
 the magnitude can be scaled using the 
\shape italic
scale 
\shape default
element.
 An optional load curve can be defined for the 
\shape italic
scale 
\shape default
element using the 
\shape italic
lc 
\shape default
attribute.
 This allows the traction load to become time dependent.
 If the 
\shape italic
lc 
\shape default
attribute is omitted a constant traction load is applied.
\end_layout

\begin_layout Subsubsection
Surface Force
\begin_inset CommandInset label
LatexCommand label
name "subsec:Surface-Force"

\end_inset


\end_layout

\begin_layout Standard
A surface force applies an equivalent uniform traction load to a surface.
 The direction of the force remains unchanged as the mesh deforms.
\end_layout

\begin_layout LyX-Code
<surface_load type="force" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <force>0,0,1</force>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The force vector is determined by two quantities.
 The direction and magnitude is defined by the 
\shape italic
force 
\shape default
element.
 In addition,
 the magnitude can be scaled using the 
\shape italic
scale 
\shape default
element.
 An optional load curve can be defined for the 
\shape italic
scale 
\shape default
element using the 
\shape italic
lc 
\shape default
attribute.
 This allows the surface force to become time dependent.
 If the 
\shape italic
lc 
\shape default
attribute is omitted a constant force is applied.
\end_layout

\begin_layout Subsubsection
Bearing Load
\begin_inset CommandInset label
LatexCommand label
name "subsec:Bearing-Load"

\end_inset


\end_layout

\begin_layout Standard
A bearing load can be applied on a cylindrical surface that represents a bearing journal,
 or the portion of a shaft that is supported by a bearing journal.
 This load gets prescribed as a non-uniform compressive pressure distribution on that surface,
 representing the radial component of the bearing load.
 (The axial component of a bearing load may be prescribed using the surface force presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Surface-Force"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.) The non-uniform pressure distribution may be sinusoidal or parabolic.
 It gets distributed over a 90 degree arc relative to the loading direction,
 which is specified as a force vector.
 The user is expected to specify the bearing force in a plane perpendicular to the axis of the cylindrical bearing surface.
 Otherwise,
 only the projection of the bearing force onto that plane will be prescribed as the radial bearing load.
 For example,
 a bearing load may be specified as
\end_layout

\begin_layout Standard
<surface_load type="bearing load" surface="BearingSurface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1000.0</scale>
\end_layout

\begin_layout LyX-Code
  <force>0.707107,0.707107,0</force>
\end_layout

\begin_layout LyX-Code
  <profile>1</profile>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
In this example the bearing load is in the xy-plane,
 oriented at 45 degrees from the x-axis.
 The surface 
\emph on
BearingSurface1
\emph default
 should be a cylinder with its axis along the z-direction.
 The pressure distribution is parabolic (profile=1),
 and the alternative option is sinusoidal (profile=0).
 In general,
 a parabolic distribution produces a higher (often more realistic) central peak pressure on the bearing surface.
 An optional loadcurve can be associated with the 
\emph on
scale
\emph default
 as shown in this example,
 to scale the prescribed bearing force as a function of time.
 Alternatively,
 the user may assign a loadcurve to the 
\emph on
force
\emph default
.
 
\end_layout

\begin_layout Standard
Additional options are available for a bearing load,
 including 
\emph on
symmetric_stiffness
\emph default
,
 
\emph on
linear
\emph default
 and 
\emph on
shell_bottom
\emph default
 as outlined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Pressure-Load"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 When the 
\emph on
linear
\emph default
 flag is set to false,
 the pressure prescribed on the bearing surface is adjusted to account for the change in area and orientation of each face,
 caused by the finite deformation of the bearing surface.
 However,
 the bearing radial force direction remains unchanged with deformation.
 It is recommended to set the 
\emph on
symmetric_stiffness
\emph default
 flag to false when performing a finite deformation analysis.
\end_layout

\begin_layout Standard
The bearing load is always prescribed as a compressive load on the selected bearing surface.
 Therefore,
 it is recommended to select a complete cylindrical surface on which the bearing load is prescribed;
 the solver automatically determines which faces of the selected surface must be loaded in compression and which of those have zero pressure prescribed on them,
 based on the vectorial orientation of the bearing 
\emph on
force
\emph default
.
 If the user selects a semi-cylindrical surface as the bearing surface,
 it becomes the user's responsibility to ensure that the prescribed bearing force bisects the 180 degree arc of that surface.
 Otherwise,
 the analysis may produce unexpected results,
 due to unevenness of the pressure distribution about the force's line of action.
 If the user selects a surface with a smaller arc than 90 degrees,
 the pressure will not reduce to zero at the straight edges of the surface,
 though the pressure will be scaled to produce the prescribed force magnitude along the bearing force direction.
 
\end_layout

\begin_layout Subsubsection
Mixture Normal Traction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mixture-Normal-Traction"

\end_inset


\end_layout

\begin_layout Standard
This section applies to biphasic,
 biphasic-solute,
 triphasic and multiphasic analyses.
 In a mixture of intrinsically incompressible solid and fluid constituents,
 the formulation adopted in FEBio implies that the total traction is a natural boundary condition (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://help.febio.org/docs/FEBioTheory-4-5/TM45-Section-3.2.html}{
\backslash
emph{FEBio Theory 
\end_layout

\begin_layout Plain Layout

Manual}}
\end_layout

\end_inset

).
 If this boundary condition is not explicitly prescribed,
 the code automatically assumes that it is equal to zero.
 Therefore,
 boundaries of mixtures are traction-free by default.
\end_layout

\begin_layout Standard
The 
\shape italic
mixture traction 
\shape default

\begin_inset Formula $\mathbf{t}$
\end_inset

 is the traction vector corresponding to the mixture (or total) stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

;
 thus 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the outward unit normal to the boundary surface.
 Since 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}$
\end_inset

,
 where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the 
\shape italic
effective stress
\shape default
 resulting from strains in the solid matrix,
 it is also possible to represent the total traction as 
\begin_inset Formula $\mathbf{t}=-p\mathbf{n}+\mathbf{t}^{e}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{t}^{e}=\boldsymbol{\sigma}^{e}\cdot\mathbf{n}$
\end_inset

 is the 
\shape italic
effective traction
\shape default
.
 Currently,
 FEBio allows the user to specify only the normal component of the traction,
 either 
\begin_inset Formula $t_{n}=\mathbf{t}\cdot\mathbf{n}$
\end_inset

 (the normal component of the mixture traction) or 
\begin_inset Formula $t_{n}^{e}=\mathbf{t}^{e}\cdot\mathbf{n}$
\end_inset

 (the normal component of the effective traction):
\end_layout

\begin_layout Standard
A mixture normal traction is defined by the 
\shape italic
surface_load 
\shape default
element using 
\shape italic
normal_traction 
\shape default
for the type attribute.
\end_layout

\begin_layout LyX-Code
<surface_load type="normal_traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <traction [lc="1"]>1.0</traction>
\end_layout

\begin_layout LyX-Code
  <effective>1</effective>
\end_layout

\begin_layout LyX-Code
  <linear>0</linear>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The 
\shape italic
traction 
\shape default
element defines the magnitude of the traction force.
 The optional attribute 
\shape italic
lc 
\shape default
defines a loadcurve that controls the time dependency of the traction force magnitude.
 If omitted a constant traction is applied.
\end_layout

\begin_layout Standard
The 
\shape italic
effective 
\shape default
element defines whether the traction is applied as an effective traction or a total mixture traction.
\end_layout

\begin_layout Standard
The 
\shape italic
linear 
\shape default
element defines whether the traction remains normal to the deformed surface or the reference surface.
 If set to true the traction remains normal to the reference surface.
 When false it defines a follower force that remains normal to the deformed surface.
\end_layout

\begin_layout Standard
The 
\shape italic
surface 
\shape default
element defines the surface to which the traction is applied.
 It consists of child elements defining the individual surface facets.
\end_layout

\begin_layout Standard
Unlike the mixture and effective traction,
 the fluid pressure 
\begin_inset Formula $p$
\end_inset

 is a nodal variable (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Zero-Displacement"
nolink "false"

\end_inset

).
 There may be common situations where the user must apply a combination of related fluid pressure and traction boundary conditions.
 For example,
 if a biphasic surface is subjected to a non-zero fluid pressure 
\begin_inset Formula $p_{0}$
\end_inset

,
 the corresponding boundary conditions are 
\begin_inset Formula $p=p_{0}$
\end_inset

 and 
\begin_inset Formula $t_{n}=-p_{0}$
\end_inset

 (or 
\begin_inset Formula $t_{n}^{e}=0$
\end_inset

).
 In FEBio,
 both boundary conditions must be applied.
 For example:
\end_layout

\begin_layout LyX-Code
<Boundary>
\end_layout

\begin_layout LyX-Code
  <prescribed bc="p" node_set="set1">
\end_layout

\begin_layout LyX-Code
    <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  </prescribed>
\end_layout

\begin_layout LyX-Code
  <surface_load type="normal_traction" surface="surf1">
\end_layout

\begin_layout LyX-Code
    <traction lc="1">-1.0</traction>
\end_layout

\begin_layout LyX-Code
    <effective>0</effective>
\end_layout

\begin_layout LyX-Code
    <linear>0</linear>
\end_layout

\begin_layout LyX-Code
  </surface_load>
\end_layout

\begin_layout LyX-Code
</Boundary>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcontroller id="1" type="loadcurve">
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <loadpoint>0,0</loadpoint>
\end_layout

\begin_layout LyX-Code
      <loadpoint>1,2.0</loadpoint>
\end_layout

\begin_layout LyX-Code
    </points>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout Subsubsection
Fluid Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Flux"

\end_inset


\end_layout

\begin_layout Standard
In a biphasic mixture of intrinsically incompressible solid and fluid constituents,
 the 
\begin_inset Formula $\mathbf{u}-p$
\end_inset

 formulation adopted in FEBio implies that the normal component of the relative fluid flux is a natural boundary condition.
 If this boundary condition is not explicitly prescribed,
 the code automatically assumes that it is equal to zero.
 Therefore,
 biphasic boundaries are impermeable by default.
 (To implement a free-draining boundary,
 the fluid pressure nodal degrees of freedom should be set to zero.)
\end_layout

\begin_layout Standard
The flux of fluid relative to the solid matrix is given by the vector 
\begin_inset Formula $\mathbf{w}$
\end_inset

.
 Since viscosity is not explicitly modeled in a biphasic material,
 the tangential component of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 on a boundary surface may not be prescribed.
 Only the normal component of the relative fluid flux,
 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

,
 represents a natural boundary condition.
 To prescribe a value for 
\begin_inset Formula $w_{n}$
\end_inset

 on a surface,
 use:
\end_layout

\begin_layout LyX-Code
<surface_load type="fluidflux" surface="surf1">
\end_layout

\begin_layout LyX-Code
  <flux lc="1">1.0</flux>
\end_layout

\begin_layout LyX-Code
  <linear>0</linear>
\end_layout

\begin_layout LyX-Code
  <mixture>1</mixture>
\end_layout

\begin_layout LyX-Code
</fluidflux>
\end_layout

\begin_layout Standard
The 
\shape italic
flux 
\shape default
parameter defines the flux that will be applied to the surface.
 The optional parameter 
\shape italic
lc
\shape default
 defines a loadcurve for the normal flux evolution.
 If omitted a constant fluid flux is applied.
\end_layout

\begin_layout Standard
When 
\shape italic
linear 
\shape default
is set to zero (default) it means that the flux matches the prescribed value even if the surface on which it is applied changes in area as it deforms.
 Therefore,
 the net volumetric flow rate across the surface changes with changes in area.
 This type of boundary condition is useful if the fluid flux is known in the current configuration.
\end_layout

\begin_layout Standard
When 
\shape italic
linear 
\shape default
is set to non-zero it means that the prescribed flux produces a volumetric flow rate based on the undeformed surface area in the reference configuration.
 Therefore,
 the flux in the current configuration does not match the prescribed value.
 This type of boundary condition is useful if the net volumetric flow rate across the surface is known.
 For example:
 Let 
\begin_inset Formula $Q$
\end_inset

 be the known volumetric flow rate,
 let 
\begin_inset Formula $A_{\mathrm{0}}$
\end_inset

 be the surface area in the reference configuration (a constant).
 Using 
\shape italic

\begin_inset Quotes eld
\end_inset

linear
\begin_inset Quotes erd
\end_inset


\shape default
 means that the user prescribes 
\begin_inset Formula $Q$
\end_inset

/
\begin_inset Formula $A_{\mathrm{0}}$
\end_inset

 as the flux boundary condition.
 (However,
 regardless of the 
\shape italic
type
\shape default
,
 the fluid flux saved in the output file has a normal component equal to 
\begin_inset Formula $Q$
\end_inset

/
\begin_inset Formula $A$
\end_inset

,
 where 
\begin_inset Formula $A=$
\end_inset

area in current configuration.)
\end_layout

\begin_layout Standard
Prescribing 
\begin_inset Formula $w_{n}$
\end_inset

 on a free surface works only if the nodal displacements of the corresponding faces are also prescribed.
 If the nodal displacements are not known a priori,
 the proper boundary condition calls for prescribing the normal component of the mixture velocity,
 
\begin_inset Formula $v_{n}=\left(\mathbf{v}^{s}+\mathbf{w}\right)\cdot\mathbf{n}$
\end_inset

.
 To prescribe the value of 
\begin_inset Formula $v_{n}$
\end_inset

 on a surface,
 use
\end_layout

\begin_layout LyX-Code
<surface_load type="fluidflux" surface="surf1">
\end_layout

\begin_layout LyX-Code
  <flux lc="1">1.0</flux>
\end_layout

\begin_layout LyX-Code
  <linear>0</linear>
\end_layout

\begin_layout LyX-Code
  <mixture>1</mixture>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
For example,
 this boundary condition may be used when modeling a permeation problem through a biphasic material,
 when the upstream fluid velocity is prescribed,
 
\begin_inset Formula $v_{n}=v_{0}$
\end_inset

.
 If the upstream face is free,
 the companion boundary condition would be to let 
\begin_inset Formula $t_{n}^{e}=0$
\end_inset

 on that face as well.
\end_layout

\begin_layout Subsubsection
Multiphasic Solute Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solute-Flux"

\end_inset


\end_layout

\begin_layout Standard
In biphasic-solute and multiphasic analyses the molar flux of a solute 
\begin_inset Formula $\iota$
\end_inset

,
 given by the vector 
\begin_inset Formula $\mathbf{j}^{\iota}=\varphi^{w}c^{\iota}\left(\mathbf{v}^{\iota}-\mathbf{v}^{s}\right)$
\end_inset

,
 is evaluated relative to the solid matrix;
 it includes a diffusive component as well as a convective component contributed by the fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 relative to the solid,
 see eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-fluxes-w-j"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Since solute viscosity is not explicitly modeled,
 the tangential component of 
\begin_inset Formula $\mathbf{j}^{\iota}$
\end_inset

 on a boundary surface may not be prescribed.
 Only the normal component of the relative solute flux,
 
\begin_inset Formula $j_{n}^{\iota}=\mathbf{j}^{\iota}\cdot\mathbf{n}$
\end_inset

,
 represents a natural boundary condition.
 Since a multiphasic mixture may contain electrically charged solutes,
 the solute flux that must be prescribed as a boundary condition is the effective solute flux 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=j_{n}^{\iota}+\sum_{\gamma}z^{\gamma}j_{n}^{\gamma}$
\end_inset

,
 as explained in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Effective-Solute-Flux"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 To prescribe a value for 
\begin_inset Formula $\tilde{j}_{n}^{\iota}$
\end_inset

 on a surface,
 use:
\end_layout

\begin_layout LyX-Code
<surface_load type="soluteflux" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <flux lc="1">1.0</flux>
\end_layout

\begin_layout LyX-Code
  <linear>0</linear>
\end_layout

\begin_layout LyX-Code
  <solute_id>solute_name</solute_id>
\end_layout

\begin_layout LyX-Code
  <shell_bottom>0</shell_bottom>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The parameter 
\shape italic
solute_id
\shape default
 specifies to which solute this flux condition applies,
 referencing the corresponding list of solute names in the Globals section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
The 
\shape italic
flux 
\shape default
element defines the flux magnitude.
 The optional parameter 
\shape italic
lc
\shape default
 defines a loadcurve for the normal flux evolution.
 If omitted a constant flux is applied.
\end_layout

\begin_layout Standard
When 
\shape italic
linear 
\shape default
is set to 0 (default) it means that the flux matches the prescribed value even if the surface on which it is applied changes in area as it deforms.
 Therefore,
 the net molar flow rate across the surface changes with changes in area.
 This type of boundary condition is useful if the solute molar flux is known in the current configuration.
\end_layout

\begin_layout Standard
When 
\shape italic
linear 
\shape default
is set to non-zero it means that the prescribed flux produces a molar flow rate based on the undeformed surface area in the reference configuration.
 Therefore,
 the flux in the current configuration does not match the prescribed value.
 This type of boundary condition is useful if the net molar flow rate across the surface is known.
 For example:
 Let 
\begin_inset Formula $Q$
\end_inset

 be the known molar flow rate (in units of moles per time [
\series bold
n
\series default
/
\series bold
t
\series default
]),
 let 
\begin_inset Formula $A_{\mathrm{0}}$
\end_inset

 be the surface area in the reference configuration (a constant).
 Using 
\shape italic
linear
\shape default
 means that the user prescribes 
\begin_inset Formula $Q$
\end_inset

/
\begin_inset Formula $A_{\mathrm{0}}$
\end_inset

 as the flux boundary condition (in units of moles per area per time [
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}\cdot$
\end_inset


\series bold
t
\series default
]).
 However,
 regardless of the 
\shape italic
type
\shape default
,
 the solute molar flux saved in the output file has a normal component equal to 
\begin_inset Formula $Q$
\end_inset

/
\begin_inset Formula $A$
\end_inset

,
 where 
\begin_inset Formula $A=$
\end_inset

area in current configuration.
 The 
\emph on
shell_bottom
\emph default
 tag should be set to 1 (true) when prescribing the flux on the bottom surface of a multiphasic shell.
\end_layout

\begin_layout Subsubsection
Solute Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solute-Flux-1"

\end_inset


\end_layout

\begin_layout Standard
In fluid-solutes analyses the molar flux of solute 
\begin_inset Formula $\iota$
\end_inset

,
 given by the vector 
\begin_inset Formula $\mathbf{j}^{\iota}=c^{\iota}\left(\mathbf{v}^{\iota}-\mathbf{v}^{f}\right)$
\end_inset

,
 is evaluated relative to the solvent (fluid);
 it only includes a diffusive contribution relative to the solvent.
 Since solute viscosity is not explicitly modeled,
 the tangential component of 
\begin_inset Formula $\mathbf{j}^{\iota}$
\end_inset

 on a boundary surface may not be prescribed.
 Only the normal component of the relative solute flux,
 
\begin_inset Formula $j_{n}^{\iota}=\mathbf{j}^{\iota}\cdot\mathbf{n}$
\end_inset

,
 represents a natural boundary condition.
 Since a fluid-solutes mixture may contain electrically charged solutes,
 the solute flux that must be prescribed as a boundary condition is the effective solute flux 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=j_{n}^{\iota}+\sum_{\gamma}z^{\gamma}j_{n}^{\gamma}$
\end_inset

,
 such as that in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:normal-effective-solute-flux"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 To prescribe a value for 
\begin_inset Formula $\tilde{j}_{n}^{\iota}$
\end_inset

 on a surface,
 use:
\end_layout

\begin_layout LyX-Code
<surface_load type="solute flux" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <flux lc="1">1.0</flux>
\end_layout

\begin_layout LyX-Code
  <solute_id>solute_name</solute_id>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The parameter 
\shape italic
solute_id
\shape default
 specifies to which solute this flux condition applies,
 referencing the corresponding list of solute names in the Globals section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
The 
\shape italic
flux 
\shape default
element defines the flux magnitude.
 The optional parameter 
\shape italic
lc
\shape default
 defines a loadcurve for the normal flux evolution.
 If omitted a constant flux is applied.
\end_layout

\begin_layout Subsubsection
Multiphasic Solute Natural Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solute-Natural-Flux"

\end_inset


\end_layout

\begin_layout Standard
This surface load can be prescribed on a multiphasic boundary where a natural solute flux is desired.
 On this boundary,
 the solute is convected with the solvent according to 
\begin_inset Formula $j_{n}=cw_{n}$
\end_inset

.
 The implication of this surface load is that there is no diffusive hindrance to solute transport on the external side of the boundary.
 Here,
 
\begin_inset Formula $c$
\end_inset

 is the average solute concentration and 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is the average solvent volumetric flux in the finite element connected to the boundary face on which this surface load is prescribed.
 The normal solvent flux 
\begin_inset Formula $w_{n}$
\end_inset

 is evaluated as 
\begin_inset Formula $\mathbf{w}\cdot\mathbf{n}$
\end_inset

 using the normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 on the boundary.
 There are no user-specified parameters in this surface load (other than specifying the solute for which it applies,
 and whether the boundary is the bottom of a shell domain).
 To prescribe a solute natural flux on a surface,
 use:
\end_layout

\begin_layout LyX-Code
<surface_load type="solute natural flux" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <solute_id>solute_name</solute_id>
\end_layout

\begin_layout LyX-Code
  <shell_bottom>0</shell_bottom>
\end_layout

\begin_layout LyX-Code
  <update>0</update>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The parameter 
\shape italic
solute_id
\shape default
 specifies to which solute this flux condition applies,
 referencing the corresponding list of solute names in the Globals section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

).
 The parameter 
\emph on
update
\emph default
 is a boolean flag (0=
\emph on
false
\emph default
,
 1=
\emph on
true
\emph default
,
 default is 
\emph on
false
\emph default
) which,
 when set to 
\emph on
true
\emph default
,
 initializes the effective solute concentration of surface nodes to the average value of concentrations within the underlying elements,
 at each iteration.
 You may set this flag to 
\emph on
true
\emph default
 when the iterative numerical solution fails to converge.
 This surface load is only needed for biphasic-solute and multiphasic analyses,
 since 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=0$
\end_inset

 is the natural boundary condition for fluid-solutes analyses.
\end_layout

\begin_layout Subsubsection
Heat Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Heat-Flux"

\end_inset


\end_layout

\begin_layout Standard
A heat flux can be defined for heat transfer analyses using the 
\shape italic
surface_load 
\shape default
element with type set to 
\shape italic
heatflux 
\shape default
element.
\end_layout

\begin_layout LyX-Code
<surface_load type="heatflux" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <flux lc="1">1.0</flux>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The heat flux element takes two parameters,
 namely 
\shape italic
flux
\shape default
 which defines the flux that will be applied.
 It has an optional 
\shape italic
lc 
\shape default
attribute which defines the load curve for this parameter.
 If omitted,
 a constant heat flux will be applied.
 The other (optional) parameter is the 
\shape italic
value 
\shape default
parameter which can be used to define a different flux value for each surface facet.
\end_layout

\begin_layout Subsubsection
Convective Heat Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Convective-Heat-Flux"

\end_inset


\end_layout

\begin_layout Standard
A convective heat flux can be defined to a surface that is cooled (or heated) by exposure to an ambient temperature.
\end_layout

\begin_layout LyX-Code
<surface_load type="convective_heatflux" surface="surf1">
\end_layout

\begin_layout LyX-Code
  <Ta lc="1">1.0</Ta>
\end_layout

\begin_layout LyX-Code
  <hc>1.0</hc>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
The 
\shape italic
hc 
\shape default
parameter defines the heat transfer coefficient.
 The ambient temperature is defined by the 
\shape italic
Ta 
\shape default
parameter.
 It takes an optional load curve defined through the 
\shape italic
lc 
\shape default
attribute.
 The 
\shape italic
value 
\shape default
parameter with the 
\shape italic
surface_data 
\shape default
attribute can be defined to define a different temperature value for each surface facet (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:generator"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsubsection
Fluid Traction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Traction"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 the Cauchy stress is given by 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\tau}$
\end_inset

,
 where 
\begin_inset Formula $p$
\end_inset

 is the elastic pressure and 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress.
 The traction on a fluid surface with outward normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is given by 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}=-p\mathbf{n}+\mathbf{t}^{\tau}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the viscous component of the traction.
 The 
\emph on
fluid traction
\emph default
 surface load prescribes 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 on a boundary surface.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <traction>0,0,1</traction>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsubsection
Fluid Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Pressure"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 the Cauchy stress is given by 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\tau}$
\end_inset

,
 where 
\begin_inset Formula $p$
\end_inset

 is the elastic pressure and 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress.
 The 
\emph on
fluid pressure
\emph default
 surface load prescribes 
\begin_inset Formula $p$
\end_inset

 on a boundary surface.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid pressure" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <pressure>0.05</pressure>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
This boundary condition internally solves for the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 for the user-prescribed pressure 
\begin_inset Formula $p$
\end_inset

,
 using the user-selected equation of state from the list given in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Then 
\begin_inset Formula $e^{f}$
\end_inset

is prescribed as an essential boundary condition on the selected surface.
\end_layout

\begin_layout Subsubsection
Fluid Normal Traction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Normal-Traction"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 the normal component 
\begin_inset Formula $t_{n}^{\tau}=\mathbf{t}^{\tau}\cdot\mathbf{n}$
\end_inset

 of the viscous traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Traction"
nolink "false"

\end_inset

) may be prescribed on a boundary surface in a fluid analysis.
 The
\emph on
 fluid normal traction
\emph default
 surface load prescribes 
\begin_inset Formula $t_{n}^{\tau}$
\end_inset

 on a boundary surface.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <traction>1</traction>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsubsection
Fluid Backflow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Backflow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 this boundary condition prescribes the normal component of the viscous traction (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Traction"
nolink "false"

\end_inset

),
 
\begin_inset Formula $t_{n}^{\tau}=\mathbf{t}^{\tau}\cdot\mathbf{n}$
\end_inset

,
 such that it opposes backflow,
 i.e.,
 when 
\begin_inset Formula $v_{n}=\mathbf{v}\cdot\mathbf{n}$
\end_inset

 is negative.
 Specifically,
 
\begin_inset Formula $t_{n}^{\tau}=\beta\rho_{r}v_{n}^{2}$
\end_inset

 when 
\begin_inset Formula $v_{n}<0$
\end_inset

 and 
\begin_inset Formula $0$
\end_inset

 otherwise,
 where 
\begin_inset Formula $\beta$
\end_inset

 is a unitless user-defined parameter (typical values may range from 0 to 1) and 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the referential fluid density.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid backflow stabilization" surface="surface1">
\end_layout

\begin_layout LyX-Code
	<beta lc="1">1</beta>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsubsection
Fluid Tangential Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Tangential-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 this boundary condition prescribes the tangential component of the viscous traction (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Traction"
nolink "false"

\end_inset

),
 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{t}^{\tau}$
\end_inset

,
 such that it opposes the tangential fluid flow 
\begin_inset Formula $\mathbf{v}_{t}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{v}$
\end_inset

 on the selected boundary surface,
 with 
\begin_inset Formula $\mathbf{n}$
\end_inset

 representing the outward normal to this surface.
 Specifically,
 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=-\beta\rho_{r}\left|\mathbf{v}_{t}\right|\mathbf{v}_{t}$
\end_inset

,
 where 
\begin_inset Formula $\beta$
\end_inset

 is a unitless user-defined parameter (typical values may range from 0 to 1) and 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the referential fluid density.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid tangential stabilization" surface="surface1">
\end_layout

\begin_layout LyX-Code
	<beta lc="1">1</beta>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsubsection
Fluid Normal Velocity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Normal-Velocity"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis the fluid velocity relative to the mesh,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

,
 on a boundary surface with outward normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 may be decomposed into the normal component,
 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

,
 and tangential component,
 
\begin_inset Formula $\mathbf{w}_{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{w}=\mathbf{w}-w_{n}\mathbf{n}$
\end_inset

.
 The surface load 
\emph on
fluid normal velocity
\emph default
 may be used to prescribe a desired value of 
\begin_inset Formula $w_{n}$
\end_inset

 on a boundary surface.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <value lc="1">1.0</value>
\end_layout

\begin_layout LyX-Code
  <velocity>1</velocity>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
Optionally,
 FEBio can generate a parabolic velocity profile over the named surface,
 This option can be turned on using the 
\emph on
parabolic
\emph default
 element (0=default,
 1=parabolic).
 In this case,
 the 
\emph on
velocity
\emph default
 element provides the average value of this parabolic velocity profile,
 while 
\emph on
value
\emph default
 remains a scale factor optionally tied to a loadcurve.
 The parabolic profile is calculated under the assumption of steady Poiseuille flow in an infinite tube whose cross-section has the shape of the named surface.
 The parabolic velocity distribution reduces to zero only on portions of the boundary curve of the named surface where the user has fixed all three components of the fluid velocity (no-slip condition).
 On remaining portions of this boundary curve,
 symmetry conditions are assumed for the three-dimensional parabolic normal velocity profile.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <velocity lc="1">-1.0</velocity>
\end_layout

\begin_layout LyX-Code
  <parabolic>1</parabolic>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
If an arbitrary distribution with different scalar value needs to be specified for each facet,
 use the following syntax,
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <value surface_data="inlet"/>
\end_layout

\begin_layout LyX-Code
  <velocity lc="1">-1.0</value>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
and provide the facet values in a user-defined 
\emph on
SurfaceData
\emph default
 map with 
\emph on
name="inlet"
\emph default
 and 
\emph on
data_type="scalar"
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:generator"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
By default,
 this condition only prescribes the natural boundary condition 
\begin_inset Formula $w_{n}$
\end_inset

,
 leaving 
\begin_inset Formula $\mathbf{w}_{\tau}$
\end_inset

 free.
 Optionally,
 it is possible to also enforce 
\begin_inset Formula $\mathbf{w}_{\tau}=\mathbf{0}$
\end_inset

 by prescribing essential boundary conditions on the wx,
 wy and wz components of 
\begin_inset Formula $\mathbf{w}=w_{n}\mathbf{n}$
\end_inset

 at the nodes of each facet,
 based on the value of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 at each node (obtained by averaging 
\begin_inset Formula $\mathbf{n}$
\end_inset

 from adjoining facets).
 This option may be turned on using the 
\emph on
prescribe_nodal_velocities
\emph default
 element (0=default,
 1=prescribed),
 for example,
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <velocity>-1.0</velocity>
\end_layout

\begin_layout LyX-Code
  <prescribe_nodal_velocities>1</prescribe_nodal_velocities>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
When the fluid is prescribed on a surface boundary,
 better numerical convergence is achieved if the fluid dilatation is also prescribed on the rim (the boundary curve) of that surface boundary.
 While this can be done explicitly,
 a better option is to set the fluid dilatation on the rim to match the average pressure on the surface boundary,
 calculated during the analysis.
 To select this option,
 use the 
\emph on
prescribe_rim_pressure
\emph default
 element (0=default,
 1=prescribed),
 for example,
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid normal velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <velocity>-1.0</velocity>
\end_layout

\begin_layout LyX-Code
  <parabolic>1</parabolic>
\end_layout

\begin_layout LyX-Code
  <prescribe_nodal_velocities>1</prescribe_nodal_velocities>
\end_layout

\begin_layout LyX-Code
  <prescribe_rim_pressure>1</prescribe_rim_pressure>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
Note that this 
\emph on
prescribe_rim_pressure 
\emph default
option will not work if the mesh of the boundary surface has no internal nodes.
\end_layout

\begin_layout Subsubsection
Fluid Velocity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Velocity"

\end_inset


\end_layout

\begin_layout Standard
In a fluid or fluid-FSI analysis,
 this boundary condition prescribes the fluid velocity vector relative to the mesh,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

,
 on a named surface,
 simultaneously satisfying the natural boundary condition for 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 and prescribing essential boundary conditions on the wx,
 wy and wz components of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 at the nodes of each facet,
 based on the value of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 at each node (obtained by averaging 
\begin_inset Formula $\mathbf{n}$
\end_inset

 from adjoining facets).
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <velocity>0,0,1</velocity>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
If a different vector value needs to be specified for each facet,
 use the following syntax,
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid velocity" surface="surface1">
\end_layout

\begin_layout LyX-Code
  <scale lc="1">1.0</scale>
\end_layout

\begin_layout LyX-Code
  <velocity surface_data="inlet"/>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
and provide the facet values in a user-defined 
\emph on
SurfaceData
\emph default
 map with 
\emph on
name="inlet"
\emph default
 and 
\emph on
data_type="vec3"
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:generator"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsubsection
Fluid Rotational Velocity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Rotational-Velocity"

\end_inset


\end_layout

\begin_layout Standard
This boundary condition prescribes a rotational velocity on an axisymmetric surface.
 It is the user's responsibility to ensure that the surface is axisymmetric.
 The angular velocity 
\begin_inset Formula $\boldsymbol{\omega}=\omega\mathbf{n}$
\end_inset

 is prescribed by specifying the angular speed 
\begin_inset Formula $\omega$
\end_inset

 and the unit vector along the axis of rotation (axis of symmetry) 
\begin_inset Formula $\mathbf{n}$
\end_inset

.
 The user-defined vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is automatically normalized.
 If the axis does not pass through the origin,
 the user may specify any point 
\begin_inset Formula $\mathbf{p}$
\end_inset

 on the axis.
 The fluid velocity relative to the mesh,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

,
 for nodes on the selected surface is evaluated from 
\begin_inset Formula $\mathbf{w}=\boldsymbol{\omega}\times\mathbf{r}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{r}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\left(\mathbf{x}-\mathbf{p}\right)$
\end_inset

 is the shortest vector from the axis to the node and 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is the nodal position.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid rotational velocity" surface="FluidRotationalVelocity01">
\end_layout

\begin_layout LyX-Code
	<angular_speed lc="1">1</angular_speed>
\end_layout

\begin_layout LyX-Code
	<axis>0,0,1</axis>
\end_layout

\begin_layout LyX-Code
	<origin>0,0,0</origin>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Standard
Though this boundary condition may be used in fluid-FSI analyses,
 it is most relevant for standard fluid analyses where the mesh is stationary.
\end_layout

\begin_layout Subsubsection
Fluid-FSI Traction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-FSI-Traction"

\end_inset


\end_layout

\begin_layout Standard
In a fluid-FSI analysis,
 the fluid traction across an interface between a 
\emph on
fluid-FSI
\emph default
 material and a solid domain must be prescribed explicitly as a traction boundary condition on the solid domain.
 Otherwise,
 the solid domain cannot sense the fluid pressure and viscous traction.
 Users must identify each surface on which this FSI surface load must be prescribed.
 There are no user-defined parameters for this surface load.
\end_layout

\begin_layout LyX-Code
<surface_load type="fluid-FSI traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
<surface_load>
\end_layout

\begin_layout Standard
This surface load must also be prescribed on free fluid surfaces (such as the surface of the fluid in open channel flow) to allow those surfaces to deform in response to the fluid stresses (e.g.,
 producing surface waves).
 (Do not apply this surface load on inlet or outlet boundaries through which fluid flows.)
\end_layout

\begin_layout Subsubsection
Biphasic-FSI Traction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-FSI-Traction"

\end_inset


\end_layout

\begin_layout Standard
In a fluid-FSI analysis,
 the fluid traction across an interface between a 
\emph on
biphasic-FSI
\emph default
 material and a solid domain must be prescribed explicitly as a traction boundary condition on the solid domain.
 Otherwise,
 the solid domain cannot sense the fluid pressure and viscous traction.
 Users must identify each surface on which this FSI surface load must be prescribed.
 There are no user-defined parameters for this surface load.
\end_layout

\begin_layout LyX-Code
<surface_load type="biphasic-FSI traction" surface="surface1">
\end_layout

\begin_layout LyX-Code
<surface_load>
\end_layout

\begin_layout Standard
This surface load must also be prescribed on free fluid surfaces (such as the surface of the fluid in open channel flow) to allow those surfaces to deform in response to the fluid stresses (e.g.,
 producing surface waves).
 (Do not apply this surface load on inlet or outlet boundaries through which fluid flows.)
\end_layout

\begin_layout Subsubsection
Solute Backflow Stabilization
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solute-Backflow-Stabilization"

\end_inset


\end_layout

\begin_layout Standard
In a fluid-solutes analysis this surface load checks for the presence of solvent (fluid) backflow,
 i.e.,
 when 
\begin_inset Formula $v_{n}^{f}=\mathbf{v}^{f}\cdot\mathbf{n}$
\end_inset

 is negative.
 When this condition is encountered,
 the effective concentration of the selected solute (
\emph on
solute_id
\emph default
) is set to its converged value from the previous time step.
 Otherwise,
 the natural boundary condition 
\begin_inset Formula $\tilde{j}_{n}=0$
\end_inset

 (zero diffusive solute flux relative to the solvent) prevails.
\end_layout

\begin_layout LyX-Code
<surface_load type="solute backflow stabilization" surface="surface1">
\end_layout

\begin_layout LyX-Code
	<solute_id>neutral</solute_id>
\end_layout

\begin_layout LyX-Code
</surface_load>
\end_layout

\begin_layout Subsection
Body Loads
\begin_inset CommandInset label
LatexCommand label
name "subsec:Body-Loads"

\end_inset


\end_layout

\begin_layout Standard
A body load can be used to define a source term to the model.
 The following sections define the different type of body loads that can be applied.
 In the case of body forces,
 these body loads represent the body force per mass,
 
\begin_inset Formula $\mathbf{b}$
\end_inset

,
 which appears in the momentum balance as
\begin_inset Formula 
\[
\rho\mathbf{a}=\divg\boldsymbol{\sigma}+\rho\mathbf{b}\,,
\]

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the mass density,
 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the acceleration (set to zero in quasi-static analyses),
 and 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

 is the Cauchy stress tensor.
\end_layout

\begin_layout Subsubsection
Constant Body Force
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Body-Force"

\end_inset


\end_layout

\begin_layout Standard
This constant body force per mass 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is defined as a 3D vector.
 Each component can be associated with a load curve to define a time dependent body force.
 Only the non-zero components need to be defined.
 This type of body force is spatially homogeneous,
 though it may vary with time when associated with a load curve:
\end_layout

\begin_layout LyX-Code
<body_load type="const">
\end_layout

\begin_layout LyX-Code
  <x lc="1">1.0</x>
\end_layout

\begin_layout LyX-Code
  <y lc="2">1.0</y>
\end_layout

\begin_layout LyX-Code
  <z lc="3">1.0</z>
\end_layout

\begin_layout LyX-Code
</body_load>
\end_layout

\begin_layout Standard
The 
\shape italic
lc 
\shape default
attribute defines the load curve to use for the corresponding component.
 The values of the components can be used to define scale factors for the load values.
\end_layout

\begin_layout Subsubsection
Non-Constant Body Force
\begin_inset CommandInset label
LatexCommand label
name "subsec:Non-Constant-Body-Force"

\end_inset


\end_layout

\begin_layout Standard
This body force per mass 
\begin_inset Formula $\mathbf{b}$
\end_inset

 may be spatially inhomogeneous.
 The spatial inhomogeneity may be specified using a formula with variables X,
 Y,
 Z.
 For example:
\end_layout

\begin_layout LyX-Code
<body_load type="non-const">
\end_layout

\begin_layout LyX-Code
  <x>X+Y+Z</x>
\end_layout

\begin_layout LyX-Code
  <y>X-Y-Z</y>
\end_layout

\begin_layout LyX-Code
  <z>X*X+Z</z>
\end_layout

\begin_layout LyX-Code
</body_load>
\end_layout

\begin_layout Subsubsection
Centrifugal Body Force
\begin_inset CommandInset label
LatexCommand label
name "subsec:Centrifugal-Force"

\end_inset


\end_layout

\begin_layout Standard
A centrifugal body force per mass 
\begin_inset Formula $\mathbf{b}=\omega^{2}r\mathbf{e}_{r}$
\end_inset

 may be used for bodies undergoing steady-state rotation with angular speed 
\begin_inset Formula $\omega$
\end_inset

 about a rotation axis directed along 
\begin_inset Formula $\mathbf{n}$
\end_inset

 and passing through the rotation center 
\begin_inset Formula $\mathbf{c}$
\end_inset

.
 Here,
 
\begin_inset Formula $r$
\end_inset

 represents the distance of each material point from the axis of rotation,
 and 
\begin_inset Formula $\mathbf{e}_{r}$
\end_inset

 is the radial unit vector from the axis of rotation,
 both of which are calculated internally from the knowledge of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{c}$
\end_inset

.
\end_layout

\begin_layout LyX-Code
<body_load type="centrifugal">
\end_layout

\begin_layout LyX-Code
  <angular_speed>1.0</angular_speed>
\end_layout

\begin_layout LyX-Code
  <rotation_axis>0.707,0.707,0</rotation_axis>
\end_layout

\begin_layout LyX-Code
  <rotation_center>0,0,0</rotation_center>
\end_layout

\begin_layout LyX-Code
</body_load>
\end_layout

\begin_layout Subsubsection
Heat Source
\begin_inset CommandInset label
LatexCommand label
name "subsec:Heat-Source"

\end_inset


\end_layout

\begin_layout Standard
A heat source can be defined using the 
\shape italic
heat_source 
\shape default
type.
\end_layout

\begin_layout LyX-Code
<body_load type="heat_source">
\end_layout

\begin_layout LyX-Code
  <Q>1.0</Q>
\end_layout

\begin_layout LyX-Code
</body_load>
\end_layout

\begin_layout Subsubsection
Surface Attraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Surface-Attraction"

\end_inset


\end_layout

\begin_layout Standard
A surface attraction body force can be used to attract a mesh toward a boundary surface,
 for the purpose of creating a mesh bias.
 This can be useful for fluid analyses where a finer mesh is needed in the vicinity of a no-slip boundary.
 The benefit of this tool over other existing tools for creating a biased mesh is its ability to work with structured and unstructured meshes,
 as well as linear and higher-order elements.
\end_layout

\begin_layout Standard
For each element in the mesh,
 its shortest distance 
\begin_inset Formula $r$
\end_inset

 to the selected boundary surface is evaluated using a surface projection algorithm.
 Then,
 an attractive body force per mass,
\begin_inset Formula 
\[
\mathbf{b}=s\exp\left(-\frac{r}{\rho}\right)\mathbf{n}
\]

\end_inset

is evaluated along the unit vector 
\begin_inset Formula $\mathbf{n}$
\end_inset

 directed along the shortest projection distance.
 Here,
 
\begin_inset Formula $\rho$
\end_inset

 is a characteristic boundary layer thickness (
\emph on
blt
\emph default
) and 
\begin_inset Formula $s$
\end_inset

 is a scale factor for the body force (
\emph on
bsf
\emph default
),
 whose value may be adjusted relative to account for the stiffness of the elastic solid material assigned to the mesh.
\end_layout

\begin_layout LyX-Code
<body_load type="surface attraction" elem_set="EB1" surface="PressureLoad1">
\end_layout

\begin_layout LyX-Code
    <blt>0.5</blt>
\end_layout

\begin_layout LyX-Code
    <bsf lc="1">20</bsf>
\end_layout

\begin_layout LyX-Code
    <search_radius>0.1</search_radius>
\end_layout

\begin_layout LyX-Code
    <search_tol>0.01</search_tol>
\end_layout

\begin_layout LyX-Code
</body_load>
\end_layout

\begin_layout Standard
Note that this body force requires the specification of an attractive surface;
 optionally,
 it also accepts the specification of the element set subjected to this attractive body force.
 The 
\emph on
search_radius
\emph default
 and 
\emph on
search_tol
\emph default
 parameters are used for the projection algorithm.
 They have the same meaning as in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Sliding-Interfaces"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Moving frame
\end_layout

\begin_layout Standard
The 
\emph on
moving frame 
\emph default
load can be used to model the effects of being embedded in an accelerating and rotating coordinate system.
 Whereas the 
\emph on
centrifual body force 
\emph default
only emulates the effect of a centrifugal force and assumes a static analysis,
 the moving frame load includes Coriolos effect and the effects of an accelerating coordinate system and can be used in a dynamic analysis.
 
\end_layout

\begin_layout Standard
The motion of the moving frame is decomposed into a translation and a rotation.
 The position of a material point 
\series bold
r
\series default
 in the fixed inertial frame can then be related to the position in the rotating frame 
\series bold
r'
\series default
 via,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{r}=\mathbf{Y}+\mathbf{R}\mathbf{r\mathit{'}}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\series bold
Y
\series default
 is the position of the origin of the moving frame and 
\series bold
R
\series default
 is the rotation matrix.
 
\end_layout

\begin_layout Standard
Substituting this into the equations of motion (i.e.
 the balance of linear momentum),
 results in a modified equation of motion where the effects of the moving frame can be combined into a single body load.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{f}=\varrho\left(\mathbf{R}^{T}\mathbf{A}+\mathbf{\dot{W}}\times\mathbf{r}'+\mathbf{W}\times\left(\mathbf{W}\times\mathbf{r}'\right)+2\mathbf{W}\times\mathbf{v}'\right)
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\series bold
A
\series default
 is the linear acceleration of the moving frame,
 
\series bold
W
\series default
 is the angular velocity of the moving frame,
 measured in the moving frame (i.e.
 
\begin_inset Formula $\mathbf{W}=\mathbf{R}^{T}\mathbf{w},$
\end_inset

where 
\series bold
w
\series default
 is the angular velocity in the fixed frame),
 and 
\series bold
v
\series default
' is the velocity of the material point,
 measured in the moving frame.
 
\end_layout

\begin_layout Standard
The moving frame is defined via the two vectors,
 the angular velocity of the rotating frame 
\series bold
w
\series default
,
 and the linear acceleration of the rotating frame's origin 
\series bold
A
\series default
.
 The components of both vectors may be defined via load curves to make them time-dependent.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of angular velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of angular velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of angular velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of linear acceleration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ay
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of linear acceleration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
az
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of linear acceleration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Note that if you wish to include the effect of gravity,
 do not add a separate body force load.
 Instead,
 modify the linear acceleration to include gravity:
 
\begin_inset Formula $\boldsymbol{a=}A-\boldsymbol{g}.$
\end_inset


\end_layout

\begin_layout Standard
Example:
\end_layout

\begin_layout LyX-Code
<Loads>
\end_layout

\begin_layout LyX-Code
  <body_load type="moving frame">
\end_layout

\begin_layout LyX-Code
    <wx>0</wx>
\end_layout

\begin_layout LyX-Code
    <wy>0</wy>
\end_layout

\begin_layout LyX-Code
    <wz lc="1">1</wz>
\end_layout

\begin_layout LyX-Code
    <ax>0</ax>
\end_layout

\begin_layout LyX-Code
    <ay>0</ay>
\end_layout

\begin_layout LyX-Code
    <az>0</az>
\end_layout

\begin_layout LyX-Code
  </body_load>
\end_layout

\begin_layout LyX-Code
</Loads> 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Contact Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Contact-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
Contact 
\shape default
section defines all the contact interfaces.
 Contact boundary conditions are defined with the 
\shape italic
contact
\shape default
 sub-element.
 The 
\shape italic
type
\shape default
 attribute specifies the type of contact interface that is defined.
 The 
\shape italic
surface_pair 
\shape default
attribute defines the surface pair to use for this contact definition.
 The surface pair is defined the the 
\emph on
Mesh
\shape italic
\emph default
 
\shape default
section.
 For example:
\end_layout

\begin_layout LyX-Code
<contact type="sliding-elastic" surface_pair="contact1">
\end_layout

\begin_layout LyX-Code
  <!-- parameter go here -->
\end_layout

\begin_layout LyX-Code
</contact>
\end_layout

\begin_layout Standard
The 
\shape italic
type
\shape default
 can be one of the following options:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="2in">
<column alignment="left" valignment="top" width="3in">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sliding-node-on-facet,
 sliding-facet-on-facet,
 sliding-elastic,
 sliding-biphasic,
 sliding-biphasic-solute,
 sliding-multiphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A sliding interface that may separate (with biphasic contact for 
\shape italic
sliding
\shape default
-biphasic,
 biphasic-solute contact for 
\shape italic
sliding-biphasic-s
\shape default
olute,
 and multiphasic contact for 
\shape italic
sliding-multiphasic
\shape default
) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid_wall
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A sliding interface with rigid wall as secondary surface 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid_joint
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A joint between two rigid bodies 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tied,sticky,
 tied-biphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A tied interface (solid-solid,
 solid-rigid,
 solid-biphasic,
 rigid-biphasic) or tied-biphasic interface (biphasic-biphasic).
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact potential
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A potential based sliding contact interface 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\series bold
A note on auto-contact
\end_layout

\begin_layout Standard
The two surfaces that participate in the contact are specified via a surface
 pair.
 These surface pairs are defined in the SurfacePair subsection of the Mesh
 section of the input file.
 Typically the surfaces are chosen based on the user's knowledge of where
 the contact will occur.
 However, for complex geometries it might not be clear where the contact
 will occur, or identifying the surfaces may be cumbersome.
 For this reason, FEBio supports an auto-contact option, where users only
 need to specify the parts of the primary and secondary surfaces.
 From these part lists, FEBio will extract the surfaces automatically.
 To use the auto-contact, simply specify a part list instead of the surface
 names when defining the surface pair.
 
\end_layout

\begin_layout LyX-Code
<PartList name="SlidingElastic1Primary">Part1</PartList>
\end_layout

\begin_layout LyX-Code
<PartList name="SlidingElastic1Secondary">Part2</PartList> 
\end_layout

\begin_layout LyX-Code
<SurfacePair name="SlidingElastic1">
\end_layout

\begin_layout LyX-Code
   <primary>
\series bold
@part_list:SlidingElastic1Primary
\series default
</primary>
\end_layout

\begin_layout LyX-Code
   <secondary>
\series bold
@part_list:SlidingElastic1Secondary
\series default
</secondary>
\end_layout

\begin_layout LyX-Code
</SurfacePair> 
\end_layout

\begin_layout Standard
Note the 
\series bold
@part_list:
\series default
 prefix in front of the part list name.
 
\end_layout

\begin_layout Standard
Although using the auto-contact can greatly simply defining contact between
 parts, it is important to keep in mind that there are a few drawbacks.
 First and foremost, the surfaces extracted from parts will likely be much
 larger than the contact area and this will result in a performance cost.
 Second, for complex geometries the extract surfaces may have a complex
 topology that may confuse some of the contact detection algorithms.
 In those situations it might be beneficial to decrease the search_radius
 parameter (for contact algorihtms that define this parameter).
 
\end_layout

\begin_layout Subsection
Sliding Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sliding-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A sliding interface can be used to setup a non-penetration constraint between two surfaces.
 As of version 1.2,
 three different sliding contact algorithms are available.
 Although all three are based on the same contact enforcement method,
 they all differ slightly in their implementation and have been shown to give different performance for different contact scenarios.
 Each sliding contact implementation is identified by a different 
\shape italic
type 
\shape default
attribute.
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-node-on-facet
\begin_inset space ~
\end_inset

(N2F)
\shape default
\emph default
 This is FEBio's original implementation of sliding contact.
 It is based on Laursen's contact formulation 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen95"
literal "true"

\end_inset

 which poses the contact problem as a nonlinear constrained optimization problem.
 In FEBio,
 the Lagrange multipliers that enforce the contact constraints are computed either using a penalty method or the augmented Lagrangian method.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-facet-on-facet
\begin_inset space ~
\end_inset

(F2F)
\shape default
\emph default
 This implementation is identical to the 
\shape italic
sliding-node-on-facet
\shape default
 implementation but uses a more accurate integration rule:
 where the former method uses nodal integration,
 this method uses Gaussian quadrature to integrate the contact equations.
 This method has been demonstrated to give additional stability and often converges when the former method does not.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-elastic
\begin_inset space ~
\end_inset

(SE)
\shape default
\emph default
 This sliding contact interface also uses facet-on-facet contact but differs in the linearization of the contact forces,
 which results in a different contact stiffness matrix compared to the previous two methods.
 It can be used for frictionless or frictional contact.
 It may optionally be set to sustain tension to prevent contact surfaces from separating along the direction normal to the interface,
 while still allowing tangential sliding.
 This method sometimes performs better than the previous two methods for problems that are dominated by compression.
 However,
 the formulation is inherently non-symmetric and therefore will require additional memory and running time.
 A symmetrized version of this implementation is available (see below),
 but the symmetric version does not converge as well as the non-symmetric version.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-biphasic
\begin_inset space ~
\end_inset

(SBP)
\shape default
\emph default
 This method extends the 
\emph on
sliding-elastic
\emph default
 algorithm to support frictionless biphasic contact (see the next section).
 This method is described in detail in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b"
literal "true"

\end_inset

 for the frictionless case,
 and in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21a"
literal "true"

\end_inset

 for the frictional algorithm.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-biphasic-solute
\begin_inset space ~
\end_inset

(SBS)
\shape default
\emph default
 This method is similar to 
\shape italic
sliding-biphasic
\shape default
.
 This contact implementation supports biphasic-solute contact (see the next section) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian12"
literal "true"

\end_inset

.
 When using biphasic-solute materials,
 the non-symmetric version must be used.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
sliding-multiphasic
\begin_inset space ~
\end_inset

(SMP)
\shape default
\emph default
 This method is similar to 
\shape italic
sliding-biphasic-solute
\shape default
.
 This contact implementation supports multiphasic contact (see the next section) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian12"
literal "true"

\end_inset

.
 When using multiphasic materials,
 the non-symmetric version must be used.
 
\end_layout

\begin_layout Description
contact 
\series bold
potential
\series default
 
\series bold
(CP)
\series default
 The 
\begin_inset Quotes eld
\end_inset

contact potential
\begin_inset Quotes erd
\end_inset

 contact interface implements the method by 
\begin_inset CommandInset citation
LatexCommand citep
key "KAMENSKY2018522"
literal "false"

\end_inset

.
 This method defines a contact potential that generates a (repulsing) force that prevents penetration from occurring.
 This contact formulation is not based on the augmented Lagrangian formulation and does not have any of the parameters in the table below.
 Instead,
 please see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:contact-potential"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details on this method.
 
\end_layout

\begin_layout Standard
The following table lists the properties that are defined for sliding interfaces (except contact potential).
 It is important to note that the three different sliding implementations cannot be used interchangeably:
 not all features are available for each method.
 The third,
 fourth and fifth column indicate if a parameter is available for a particular implementation.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="26" columns="8">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="2in">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0.38in">
<column alignment="center" valignment="top" width="0.38in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
N2F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
F2F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
SE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
SBP
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
SBS SMP
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
normal penalty scale factor (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto_penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
updated auto-penalty calculation at each step (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two_pass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two-pass flag (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmented Lagrangian flag (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aug.
 Lagrangian convergence tolerance (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gaptol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance for gap value (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 (off) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minaug
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum number of augmentations (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maxaug
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of augmentations (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fric_coeff
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
frictional coefficient (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fric_penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tangential penalty factor (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ktmult
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tangential stiffness multiplier (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
seg_up
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of segment updates (6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smooth_aug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smoothed Lagrangian augmentation (7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smooth_fls
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smoothed fluid load support for friction calculation (7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact_frac
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid-on-solid contact area fraction for friction calculation (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric stiffness matrix flag (8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Projection search tolerance (9)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_radius
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search radius (10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tension
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tension flag (11)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
flip_primary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
flip normal on primary surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
flip_secondary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
flip normal on secondary surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell_bottom_primary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact with back of shell on primary surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell_bottom_secondary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact with back of shell on secondary surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
offset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
offset distance between contacting surfaces (12)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

$
\backslash
bullet$
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments:
\end_layout

\begin_layout Enumerate
If the augmented Lagrangian flag is turned off (see comment 4),
 the penalty method is used to enforce the contact constraint.
 In this method,
 the contact traction is determined by the gap (i.e.
 penetration distance) multiplied by the user-defined 
\shape italic
penalty
\shape default
 factor.
 In the augmented Lagrangian method,
 the 
\shape italic
penalty
\shape default
 parameter is also used but has a slightly different meaning.
 In this case,
 it scales the Lagrange multiplier increment.
 Due to the different meanings,
 the user might have to adjust the penalty factor when switching between penalty method and augmented Lagrangian method.
 In general the penalty method requires a larger penalty factor to reach the same gap than the augmented Lagrangian method.
 See comment 4 for more information on when to use which method.
 
\end_layout

\begin_layout Enumerate
Choosing a good initial penalty parameter can often be a difficult task,
 since this parameter depends on material properties as well as on mesh dimensions.
 For this reason,
 an algorithm has been implemented in FEBio that attempts to calculate a good initial value for the penalty factor 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

for a particular node/integration piont 
\begin_inset Formula $i$
\end_inset

 on the contact interface:
 
\begin_inset Formula 
\[
\varepsilon_{i}=\frac{EA}{V}.
\]

\end_inset

Here,
 
\begin_inset Formula $A$
\end_inset

 is the area of the element the integration point belongs to,
 
\begin_inset Formula $V$
\end_inset

 is the element volume and 
\begin_inset Formula $E$
\end_inset

 is a measure of the elasticity modulus,
 which is calculated from the elasticity tensor of the element.
 Although the meaning of 
\begin_inset Formula $E$
\end_inset

 depends on the precise material formulation,
 in general one can regard it as a measure of the small strain Young's modulus of the material,
 when 
\emph on
update_penalty
\emph default
 is 0.
 If update_penalty is set to 1,
 
\begin_inset Formula $E$
\end_inset

 is recalculated at each iteration to account for the current deformation.
\end_layout

\begin_deeper
\begin_layout Standard
To use this feature,
 add the following element to the contact section:
\end_layout

\begin_layout LyX-Code
<auto_penalty>1</auto_penalty>
\end_layout

\begin_layout Standard
When the auto-penalty flag is on,
 the value of the 
\shape italic
penalty 
\shape default
parameter serves as a scale factor for the automatically-calculated penalty factor.
\end_layout

\end_deeper
\begin_layout Enumerate
Each sliding interface consists of a 
\emph on
primary
\emph default
 surface and a 
\emph on
secondary 
\emph default
surface.
 The primary surface is the surface over which the contact equations are integrated and on which the contact tractions are calculated.
 The secondar surface is used to measure the gap function and to define the necessary kinematic quantities such as surface normals and tangents.
 This approach is usually referred to as the 
\shape italic
single-pass 
\shape default
method.
 When using the single-pass algorithm,
 the results can be influenced by the choice of primary and secondary surfaces.
 It is best to use the most tessellated surface as the primary and the coarsest as the secondary surface.
 To resolve the bias issue,
 one can also use a 
\shape italic
two-pass
\shape default
 algorithm for enforcement of the contact constraint.
 In this case,
 a single pass is performed first,
 after which the primary and secondary surfaces are swapped and another pass is performed.
 When using the two-pass method,
 the definition of primary and secondary surfaces is arbitrary.
 In most problems,
 the single pass is sufficient to enforce contact;
 with a judicious choice of primary-secondary pair and contact parameters,
 good results can be obtained.
 If however,
 the single pass does not give good answers,
 for example,
 when due to the geometry's curvature the gap cannot be small enough with a single pass,
 the two-pass method can be used,
 although at the expense of more calculations.
 
\end_layout

\begin_deeper
\begin_layout Standard
If one of the contacting surfaces is rigid,
 a slightly different approach is recommended.
 In this case,
 it is best to pick the rigid surface as the secondary surface and to use a single pass algorithm.
 The reason is that the nodal degrees of freedom on the rigid surface are condensed to the rigid degrees of freedom and if the rigid surface is the primary surface,
 the reaction forces may not propagate correctly to the secondary surface.
 This is especially true if the rigid degrees of freedom are fixed.
\end_layout

\end_deeper
\begin_layout Enumerate
In the presence of a sliding interface (and other contact interfaces),
 FEBio needs to calculate the contact tractions that prevent the two participating surfaces from penetrating.
 In general these tractions can be found using the method of Lagrange multipliers.
 However,
 the direct calculation of these multipliers has several computational disadvantages and therefore FEBio approximates the multipliers using one of two alternative methods:
 the penalty method and the augmented Lagrangian method.
 In the former method,
 the multipliers are approximated by the gap (i.e.
 penetration distance) scaled by a suitably chosen penalty factor.
 In many cases,
 this method is sufficient to get good results.
 Since the correctness of a contact solution is directly determined by the amount of penetration at the converged state,
 the user has direct control over the quality of the solution.
 By increasing the penalty factor,
 the penetration is reduced.
 However,
 in some cases,
 especially in large compression problems,
 the penalty factor required to achieve an acceptable amount of penetration has to be so large that it causes numerical instabilities in the non-linear solution algorithm due to ill-conditioning of the stiffness matrix.
 In these cases,
 the augmented Lagrangian method might be a better choice.
 In this method,
 the multipliers are determined iteratively where,
 in each iteration,
 the multiplier's increments are determined with a penalty-like method.
 The advantage of this method is twofold:
 due to the iterative nature,
 the method will work with a smaller penalty factor,
 and in the limit,
 the exact Lagrange multipliers can be recovered.
 
\end_layout

\begin_deeper
\begin_layout Standard
To turn on the augmented Lagrangian method,
 simply add the following line to the contact section:
\end_layout

\begin_layout LyX-Code
<laugon>1</laugon>
\end_layout

\begin_layout Standard
To turn off the augmented Lagrangian method,
 either set the value to 0 or remove the parameter altogether.
 The convergence tolerance is set as follows:
\end_layout

\begin_layout LyX-Code
<tolerance>0.01</tolerance>
\end_layout

\begin_layout Standard
With this parameter set,
 the augmented Lagrangian method will iterate until the relative increment in the multipliers is less than the tolerance.
 For instance,
 setting the tolerance parameter to 0.01 implies that the augmented Lagrangian method will converge when there is less than a 1
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

%
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 change in the L2 norm of the augmented Lagrangian multiplier vector between successive augmentations.
 Alternatively,
 the user can also specify a tolerance for the gap value.
 In this case,
 the iterations will terminate when the gap norm,
 which is defined as the averaged L2 norm,
 (
\begin_inset Formula $\sqrt{\sum\nolimits_{i}<g_{i}>^{2}}/N$
\end_inset

,
 
\begin_inset Formula $<\cdot>$
\end_inset

the Macauley Bracket) is less than the user-specified value:
\end_layout

\begin_layout LyX-Code
<gaptol>0.001</gaptol>
\end_layout

\begin_layout Standard
However,
 one must be careful when specifying a gap tolerance.
 First note that the gap tolerance is an absolute value (unlike the 
\shape italic
tolerance 
\shape default
which is a relative value),
 so this parameter depends on the dimensions of the model.
 Also,
 there are cases when a gap tolerance simply cannot be reached due to the geometry of the model in which case the augmentations may never converge.
\end_layout

\begin_layout Standard
Note that both convergence parameters may be defined at once.
 In that case,
 FEBio will try to satisfy both convergence criteria.
 On the other hand,
 setting a value of zero will turn off the convergence criteria.
 For example,
 the default value for 
\shape italic
gaptol
\shape default
 is zero,
 so that FEBio will not check the gap norm by default.
\end_layout

\begin_layout Standard
Finally,
 the 
\shape italic
minaug 
\shape default
and 
\shape italic
maxaug
\shape default
 can be used to set a minimum and maximum number of augmentations.
 When the 
\shape italic
maxuag 
\shape default
value is reached,
 FEBio will move on to the next timestep,
 regardless of whether the force and gap tolerances have been met.
 When specifying a value for 
\shape italic
minaug
\shape default
,
 FEBio will perform at least minaug augmentations.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
sliding-node-on-facet,
 
\shape default
\emph on
sliding-elastic
\emph default
,
 and 
\emph on
sliding-biphasic 
\emph default
contact implementations support friction.
 For 
\emph on
node-on-facet
\emph default
,
 three parameters control the frictional response:
 
\shape italic
fric_coeff 
\shape default
is the material's friction coefficient and its value must be in the range from 0.0 to 1.0;
 
\shape italic
fric_penalty 
\shape default
is the penalty factor that regulates the tangential traction forces,
 much like the 
\shape italic
penalty 
\shape default
parameter regulates the normal traction force component;
 the parameter 
\shape italic
ktmult 
\shape default
is a scale factor for the tangential stiffness matrix.
 It is default to 1.0,
 but it is observed that reducing this value might sometimes improve convergence.
 For 
\emph on
sliding-elastic
\emph default
 and 
\emph on
sliding-biphasic
\emph default
 only 
\emph on
fric_coeff
\emph default
 is needed to use frictional contact.
 In addition,
 for 
\emph on
sliding-biphasic
\emph default
,
 the friction algorithm requires the specification of the solid-on-solid contact area fraction,
 which is a number between 0 and 1 (see 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

).
 Frictional contact is inherently dissipative and thus history-dependent.
 The solution may vary with the size of time increments,
 the cycle of loading,
 or Lagrangian augmentations (when 
\emph on
laugon
\emph default
=1).
\end_layout

\begin_layout Enumerate
In a contact problem,
 FEBio calculates the projection of each node of the primary surface onto the secondary surface.
 As a node slides across the secondary surface,
 the corresponding surface facet can change.
 However,
 in some cases,
 switching facets is undesirable since it might cause instabilities in the solution process or a state in which the node oscillates continuously between two adjacent facets and thus prevents FEBio from meeting the displacement convergence tolerance.
 The parameter 
\shape italic
seg_up 
\shape default
allows the user to control the number of segment updates FEBio will perform during each time step.
 For example,
 a value of 4 tells FEBio it can do the segment updates during the first four iterations.
 After that,
 nodes will not be allowed to switch to new segments.
 The default value is 0,
 which means that FEBio will do a segment update each iteration of each timestep.
 
\end_layout

\begin_layout Enumerate
The augmented Lagrangian method may produce a non-smooth contact pressure distribution at the contact surface,
 even though stresses within the underlying elements may remain relatively smoother.
 Turning this flag on changes the method of updating the Lagrange multiplier to use the projection of the element stress to the corresponding contact face.
 This feature only works with some element types (HEX8G8,
 HEX8G1,
 TET4G4,
 TET4G1,
 PENTA6G6,
 TET10G1,
 TET10G4,
 TET10G8,
 TET10GL11,
 TET15G4,
 TET15G8,
 TET15G11,
 TET15G15,
 PYRA5G8,
 PYRA13G8).
\end_layout

\begin_deeper
\begin_layout Standard
In the 
\emph on
sliding-biphasic
\emph default
 friction algorithm the friction coefficient depends on the fluid pressure and load support.
 Smoothing this fluid load support may produce a smoother distribution of the friction coefficient over the contact interface.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
sliding-elastic,
 sliding-biphasic
\shape default
,
 
\shape italic
sliding-biphasic-solute
\shape default
 and 
\shape italic
sliding-multiphasic
\shape default
 contact implementations for sliding contact are inherently non-symmetric formulations.
 Symmetrized versions of these algorithms do not perform as well as the nonsymmetric version so it is recommended to use the latter.
 The following line in the 
\emph on
contact
\emph default
 element controls which version of the algorithm is used.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<symmetric_stiffness>0</symmetric_stiffness>
\end_layout

\begin_layout Standard
A value of 1 uses the symmetric version,
 whereas a value of 0 uses the non-symmetric version.
 A similar line may be included in the 
\emph on
Control
\emph default
 element to use a non-symmetric global stiffness matrix.
 In some cases,
 a non-symmetric contact stiffness may converge well even when the global stiffness matrix is symmetric.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
search_tol
\shape default
 parameter defines the search tolerance of the algorithm that projects nodes of the primary surface onto facets of the secondary syrface.
 A node that falls outside an element,
 but whose distance to the closest element's edge is less than the search tolerance is still considered inside.
 This can alleviate convergence problems when nodes are projected onto edges of elements and due to numerical error may be projected outside the surface.
 
\end_layout

\begin_layout Enumerate
The 
\shape italic
search_radius
\shape default
 is a dimensional search radius used by the algorithm that projects points onto facets.
 When the distance between the point and the facet exceeds the dimensional search radius,
 that projection is ignored.
 This can alleviate convergence problems when surfaces have multiple folds and the projection produces multiple solutions,
 only one of which (the closest distance) is valid.
\end_layout

\begin_layout Enumerate
The 
\shape italic
tension
\shape default
 flag determines whether the contact interface can sustain tension and compression (
\shape italic
tension
\shape default
=1) or only compression (
\shape italic
tension
\shape default
=0).
 
\end_layout

\begin_layout Enumerate
The 
\emph on
offset
\emph default
 distance makes it possible to maintain the contact surfaces at a distance.
 This option is useful,
 for example,
 in fluid-structure interaction problems,
 where solid structures separated by a fluid domain are pushed against each other.
 Specifying a contact interface between the (internal) surfaces of the solid structures would prevent them from overlapping,
 but adding an offset distance will also prevent the fluid mesh from getting squished too thin or from inverting.
 These internal surfaces would also typically have FSI Traction interfaces defined on them (see Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-FSI-Traction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Biphasic-FSI-Traction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Biphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Contact"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
sliding-biphasic 
\shape default
implementation for sliding interfaces can deal with biphasic contact surfaces (including biphasic-on-biphasic,
 biphasic-on-elastic,
 biphasic-on-rigid) 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10b,Zimmerman21a"
literal "true"

\end_inset

.
 It allows for the possibility to track fluid flow across the contact interface.
 In other words,
 fluid can flow from one side of the contact interface to the other when both contact surfaces are biphasic.
 To use this feature,
 the user must define an additional contact parameter,
 namely:
\end_layout

\begin_layout LyX-Code
<pressure_penalty>1.0</pressure_penalty>
\end_layout

\begin_layout Standard
In the same way that the 
\shape italic
penalty 
\shape default
parameter controls the contact tractions,
 this parameter controls the penalty value that is used to calculate the Lagrange multipliers for the pressure constraint.
 If the 
\shape italic
laugon 
\shape default
flag is set,
 the augmented Lagrangian method is used to enforce the pressure constraint.
 And if the 
\shape italic
auto_penalty 
\shape default
flag is defined (which is the recommended approach),
 an initial guess for the pressure penalty is calculated automatically using the following formula:
\begin_inset Formula 
\[
\varepsilon_{p}=\frac{kA}{V},
\]

\end_inset

where 
\begin_inset Formula $A$
\end_inset

 is the element's area,
 
\begin_inset Formula $V$
\end_inset

 is the element's volume and 
\begin_inset Formula $k$
\end_inset

 is a measure of the permeability which is defined as one third of the trace of the material's initial permeability tensor.
\end_layout

\begin_layout Standard
When either contact surface is biphasic,
 the surface outside the contact area(s) is automatically set to free-draining conditions (equivalent to setting the fluid pressure to zero).
\end_layout

\begin_layout Standard
As detailed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21a"
literal "true"

\end_inset

 and the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

,
 the 
\emph on
sliding-biphasic
\emph default
 contact algorithm can include frictional contact.
 The effective friction coefficient 
\begin_inset Formula $\mu_{\text{eff}}$
\end_inset

 in this frictional contact algorithm depends on the temporally evolving local fluid load support (the ratio of fluid pressure 
\begin_inset Formula $p$
\end_inset

 to the normal component of the mixture contact traction 
\begin_inset Formula $t_{n}$
\end_inset

),
 according to
\begin_inset Formula 
\[
\mu_{\text{eff}}=\mu_{\text{eq}}\left(1+\left(1-\varphi\right)\frac{p}{t_{n}}\right)\,.
\]

\end_inset

Recall that 
\begin_inset Formula $t_{n}$
\end_inset

 is negative whereas 
\begin_inset Formula $p$
\end_inset

 is positive in compression.
 Here,
 
\begin_inset Formula $\mu_{\text{eq}}$
\end_inset

 (
\emph on
fric_coeff
\emph default
) is the friction coefficient in the limit when the fluid load support has reduced to zero,
 and 
\begin_inset Formula $\varphi$
\end_inset

 (
\emph on
contact_frac
\emph default
) is the fraction of the apparent contact area over which the solid matrix of the primary surface contacts that of the secondary surface.
 Thus,
 
\begin_inset Formula $1-\varphi$
\end_inset

 is the fraction of the apparent contact area where fluid contacts fluid or solid.
 For perfectly smooth contact surfaces one may assume that 
\begin_inset Formula $\varphi=\varphi_{1}^{s}\varphi_{2}^{s}$
\end_inset

,
 where 
\begin_inset Formula $\varphi_{1}^{s}$
\end_inset

 and 
\begin_inset Formula $\varphi_{2}^{s}$
\end_inset

 are the solid area (or volume) fractions of the primary and secondary contact surfaces,
 respectively.
 For example,
 when both contact surfaces are non-porous (
\begin_inset Formula $\varphi_{1}^{s}=\varphi_{2}^{s}=1$
\end_inset

),
 the effective friction coefficient reduces to 
\begin_inset Formula $\mu_{\text{eff}}=\mu_{\text{eq}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
When performing biphasic-on-rigid contact a two-pass analysis should not be used;
 the rigid surface should be the secondary surface.
\end_layout

\begin_layout Subsection
Biphasic-Solute and Multiphasic Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:Biphasic-Solute-Multiphasic-Contact"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
sliding-biphasic-solute 
\shape default
implementation for sliding interfaces can deal with biphasic-solute contact surfaces (including biphasic-solute-on-biphasic-solute,
 biphasic-solute-on-biphasic,
 biphasic-solute-on-elastic,
 biphasic-solute-on-rigid) and the 
\shape italic
sliding-multiphasic
\shape default
 contact interface can similarly deal with multiphasic contact surfaces.
 These contact interfaces allow for the possibility to track fluid and solute flow across the contact interface 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian12"
literal "true"

\end_inset

.
 In other words,
 fluid and solute can flow from one side of the contact interface to the other.
 To use this feature,
 the user must define additional contact parameters,
 namely:
\end_layout

\begin_layout LyX-Code
<pressure_penalty>1.0</pressure_penalty>
\end_layout

\begin_layout LyX-Code
<concentration_penalty>1.0</concentration_penalty>
\end_layout

\begin_layout LyX-Code
<ambient_pressure>0</ambient_pressure>
\end_layout

\begin_layout LyX-Code
<ambient_concentration>0</ambient_concentration> (for sliding-biphasic-solute)
\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout LyX-Code
<ambient_concentration sol="id">0</ambient_concentration> (for sliding-multiphasic)
\end_layout

\begin_layout Standard
In the same way that the 
\shape italic
penalty 
\shape default
parameter controls the contact tractions,
 these penalty parameters control the penalty values that are used to calculate the Lagrange multipliers for the pressure and concentration constraints.
 If the 
\shape italic
laugon 
\shape default
flag is set,
 the augmented Lagrangian method is used to enforce the pressure and concentration constraints.
 And if the 
\shape italic
auto_penalty 
\shape default
flag is defined,
 an initial guess for the pressure and concentration penalty is calculated automatically using the following formulas:
 
\begin_inset Formula 
\[
\varepsilon_{p}=\frac{k\cdot A}{V}\,,\quad\varepsilon_{c}=\frac{d\cdot A}{V}\,,
\]

\end_inset

where 
\begin_inset Formula $A$
\end_inset

 is the element's area,
 
\begin_inset Formula $V$
\end_inset

 is the element's volume,
 
\begin_inset Formula $k$
\end_inset

 is a measure of the fluid permeability which is defined as one third of the trace of the material's initial permeability tensor,
 and 
\begin_inset Formula $d$
\end_inset

 is a measure of the solute diffusivity which is defined as one third of the trace of the material's initial diffusivity tensor.
\end_layout

\begin_layout Standard
When either contact surface is biphasic-solute or multiphasic,
 the surface outside the contact area(s) is automatically set to ambient conditions (equivalent to setting the effective fluid pressure and effective solute concentration to the <ambient_pressure> and <ambient_concentration> values,
 respectively).
 Ambient conditions may also be associated with a load curve,
 for example:
\end_layout

\begin_layout LyX-Code
<ambient_pressure lc="2">1.0</ambient_pressure>
\end_layout

\begin_layout LyX-Code
<ambient_concentration lc="3">1.0</ambient_concentration>
\end_layout

\begin_layout Standard
When performing biphasic-solute-on-rigid or multiphasic-on-rigid contact,
 a two-pass analysis should not be used;
 the rigid surface should be the secondary surface.
\end_layout

\begin_layout Subsection
Rigid Wall Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-Wall-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A rigid wall interface is similar to a sliding interface,
 except that the secondary surface is a rigid wall.
 The following properties are defined for rigid wall interfaces:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Augmented Lagrangian flag
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmentation tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty factor
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plane
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the plane equation for the rigid wall
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/A 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
offset
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the normal offset of the plane defined by the 
\shape italic
plane 
\shape default
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
plane 
\shape default
property defines the reference plane for the rigid wall.
 Its value is an array of four values:
\begin_inset Formula $a,b,c,d_{0}$
\end_inset

.
 The actual plane is defined by specifying the 
\shape italic
offset 
\shape default
to the reference plane.
 The offset parameter takes a loadcurve as an optional attribute to define the motion of the plane as a function of time.
 The loadcurve defines the offset 
\begin_inset Formula $h$
\end_inset

 from the initial position in the direction of the plane normal:
 
\begin_inset Formula 
\[
\begin{array}{cc}
ax+by+cz+d\left(t\right)=0, & d\left(t\right)=d_{0}+h\left(t\right)\end{array}
\]

\end_inset

So,
 for example,
 a rigid wall that initially lies in the xy-coordinate plane and moves in the z-direction would be specified as follows:
\end_layout

\begin_layout LyX-Code
<plane>0,0,1,0</plane>
\end_layout

\begin_layout LyX-Code
<offset lc="1">1.0</offset>
\end_layout

\begin_layout Subsection
Tied Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A tied interface can be used to connect two non-conforming meshes 
\begin_inset CommandInset citation
LatexCommand citep
key "Laursen93"
literal "true"

\end_inset

.
 A tied interface requires the definition of both a primary and a secondary surface.
 It is assumed that the nodes of the primary surface are connected to the faces of the secondary surface.
 The following control parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<penalty>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty factor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tolerance>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmentation tolerance 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Tied Elastic Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Elastic-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A tied elastic interface is similar to the tied interface.
 It may be used for tying solid materials.
 It enforces continuity of the displacement across the interface.
 The following control parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
normal penalty scale factor (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure penalty scale factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto_penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two_pass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two-pass flag (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmented Lagrangian flag (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aug.
 Lagrangian convergence tolerance (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gaptol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance for gap value (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 (off)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric stiffness matrix flag (7)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Projection search tolerance (8)
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_radius
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search radius (10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Tied Biphasic Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Biphasic-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A tied biphasic interface is similar to the tied interface.
 It may be used for tying any combination of solid,
 biphasic,
 and rigid materials.
 It enforces continuity of the fluid pressure across the interface when both materials are biphasic.
 The following control parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
normal penalty scale factor (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure penalty scale factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto_penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two_pass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two-pass flag (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmented Lagrangian flag (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aug.
 Lagrangian convergence tolerance (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gaptol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance for gap value (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 (off) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric stiffness matrix flag (7)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Projection search tolerance (8)
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_radius
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search radius (10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Tied Multiphasic Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tied-Multiphasic-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A tied multiphasic interface is similar to the tied biphasic interface.
 It may be used for tying any combination of solid,
 biphasic,
 multiphasic and rigid materials.
 It enforces continuity of the effective fluid pressure and effective solute concentrations across the interface when both materials are biphasic or multiphasic.
 The following control parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
normal penalty scale factor (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure penalty scale factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
concentration_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
concentration penalty scale factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto_penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update_penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update auto-penalty calculation flag (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two_pass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
two-pass flag (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmented Lagrangian flag (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aug.
 Lagrangian convergence tolerance (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gaptol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance for gap value (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 (off) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric_stiffness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric stiffness matrix flag (7)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Projection search tolerance (8)
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_radius
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search radius (10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Sticky Interfaces
\begin_inset CommandInset label
LatexCommand label
name "subsec:Sticky-Interfaces"

\end_inset


\end_layout

\begin_layout Standard
A sticky interface is similar to a tied interface except that it allows for initial separation of the tied surfaces and breaking of the tie after a user-defined normal traction is exceeded.
 The tie is only applied when the surfaces contact and sustained as long as the normal traction is less than the threshold.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmentation flag 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty factor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augmentation tolerance 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minaug
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum number of required augmentations 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maxaug
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of augmentations 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search_tolerance
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tolerance for nodal projection onto secondary surface facet 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_traction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
threshold for normal traction (1) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
snap_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum distance for tie activation (2) 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The contact surfaces are defined as in the 
\shape italic
tied 
\shape default
interface (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Tied-Interfaces"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Comments:
\end_layout

\begin_layout Enumerate
The 
\shape italic
max_traction 
\shape default
parameter can be used to break the tied interface after the normal traction exceeds the specified value.
 Initially,
 this value is set to zero,
 in which case FEBio will ignore this value and the tie cannot be broken.
 
\end_layout

\begin_layout Enumerate
The 
\shape italic
snap_tol 
\shape default
parameter is used in determining the minimum distance that a primary surface node must have approached the secondary surface facet in order to snap onto the secondary surface.
 The initial value is zero,
 meaning a node must have penetrated the secondary surface before it will be tied to it.
 
\end_layout

\begin_layout Subsection
Contact Potential
\begin_inset CommandInset label
LatexCommand label
name "subsec:contact-potential"

\end_inset


\end_layout

\begin_layout Standard
The contact potential method is based on the formulation by 
\begin_inset CommandInset citation
LatexCommand citep
key "KAMENSKY2018522"
literal "false"

\end_inset

.
 In this formulation,
 a repulsive potential is defined between two opposing surfaces.
 A force is generated that aims to prevent physical contact between the two surfaces.
 As a result,
 there will always be a small gap between the contacting surfaces.
 Note that this is the opposite of what happens for the other sliding contact interfaces,
 which require physical contact (and even a little bit of penetration) before a contact force can be generated.
 
\end_layout

\begin_layout Standard
The type attribute for this sliding interface is 
\begin_inset Quotes eld
\end_inset


\emph on
contact potential
\emph default

\begin_inset Quotes erd
\end_inset

 amd the following parameters can be defined.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kc
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
force scale factor (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
order of polynomial that defines the potential (2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R_in
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inner radius (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R_out
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Outer radius (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R0_min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum separation in reference frame
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
w_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
threshold for angle criterion
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments:
\end_layout

\begin_layout Enumerate
The 
\emph on
kc 
\emph default
parameter defines the scale factor for the force.
 This has a similar purpose as the penalty factor in other sliding contact interfaces.
 
\end_layout

\begin_layout Enumerate
The parameter 
\emph on
p 
\emph default
defines the order of the potential.
 The paper discusses why the value 4 is in a sense an optimal value so it is recommend to use the default value.
\end_layout

\begin_layout Enumerate
The potential is divided in an 
\begin_inset Quotes eld
\end_inset

inner
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

outer
\begin_inset Quotes erd
\end_inset

 region.
 If 
\emph on
r 
\emph default
is the distance from a point on the primary contact surface to the opposing secondary surface,
 then the 
\begin_inset Quotes eld
\end_inset

inner
\begin_inset Quotes erd
\end_inset

 region is defined by the criterion 
\begin_inset Formula $0<r<R_{in}$
\end_inset

and the 
\begin_inset Quotes eld
\end_inset

outer
\begin_inset Quotes erd
\end_inset

 region is defined by 
\begin_inset Formula $R_{in}<r<R_{out}$
\end_inset

.
 The contact force is stronger in the inner region.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
R0_min
\emph default
 parameter defines the minimum distance between two potential contacting points in the reference configuration.
 In other words,
 two points whose initial distance was smaller than 
\emph on
R0_min
\emph default
 will not be considered as a valid contact pair.
 This parameter is important in self-contact to avoid neighboring points from generating contact forces.
 The default value of 0 indicates that this criterion is not used.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
w_tol 
\emph default
parameter defines a local normal criterion for a potential pair:
 If the absolute value of the cosine of the angle between the two local normals is 
\series bold
less
\series default
 than w_tol,
 the two points are 
\series bold
not
\series default
 considered in contact.
 In other words,
 the two normals have to point in the 
\begin_inset Quotes eld
\end_inset

same direction
\begin_inset Quotes erd
\end_inset

 in order for the two contacting points to be in contact.
 This criterion can be useful in cases of self-contact in order to avoid invalid contact pairs.
 A value of 0 effectively ignores this criterion.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<contact type="contact potential" name="FacetOnFacetSliding1" surface_pair="FacetOnFacetSliding1">
\end_layout

\begin_layout LyX-Code
    <kc>1e-6</kc>
\end_layout

\begin_layout LyX-Code
    <p>4</p>
\end_layout

\begin_layout LyX-Code
    <R_in>0.01</R_in>
\end_layout

\begin_layout LyX-Code
    <R_out>0.05</R_out>
\end_layout

\begin_layout LyX-Code
</contact>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Constraints Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Constraints-Section"

\end_inset


\end_layout

\begin_layout Standard
The Constraints section allows the user to enforce additional constraints to the model.
\end_layout

\begin_layout Subsection
Symmetry Plane
\begin_inset CommandInset label
LatexCommand label
name "subsec:Symmetry-Plane"

\end_inset


\end_layout

\begin_layout Standard
A symmetry plane enforces zero solid displacement normal to a user-selected plane.
 This constraint is prescribed on a deformable surface of the model and is enforced for every node on that surface.
 It is the user's responsibility to select only planar surfaces.
\end_layout

\begin_layout LyX-Code
<constraint type="symmetry plane" surface="SymmetryPlane01">
\end_layout

\begin_layout LyX-Code
	<laugon>1</laugon>
\end_layout

\begin_layout LyX-Code
	<penalty>1e6</penalty>
\end_layout

\begin_layout LyX-Code
	<tol>1e-6</tol>
\end_layout

\begin_layout LyX-Code
	<minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
	<maxaug>50</maxaug>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
The 
\emph on
surface
\emph default
 (SymmetryPlane01 in this example),
 is defined in the 
\emph on
Mesh
\emph default
 section.
 Let 
\begin_inset Formula $\mathbf{u}$
\end_inset

 denote the nodal displacement vector and let 
\begin_inset Formula $\mathbf{n}$
\end_inset

 denote the unit normal to the plane;
 the symmetry plane constraint enforces 
\begin_inset Formula $u_{n}\equiv\mathbf{u}\cdot\mathbf{n}=0$
\end_inset

 using a penalty method,
 optionally with augmented Lagrangian.
 The reaction force needed to enforce this constraint is evaluated as 
\begin_inset Formula $\varepsilon u_{n}$
\end_inset

,
 where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the user-specified 
\emph on
penalty
\emph default
 parameter (with units of force per length).
 To use the augmented Lagrangian method,
 set 
\emph on
laugon
\emph default
 to 1,
 and the Lagrange multiplier 
\begin_inset Formula $\lambda$
\end_inset

 will be augmented as 
\begin_inset Formula $\lambda\leftarrow\lambda+\varepsilon u_{n}$
\end_inset

.
 Augmentations terminate when the relative change in 
\begin_inset Formula $\lambda$
\end_inset

 is less than the user-specified tolerance 
\emph on
tol
\emph default
,
 or when the number of augmentations exceeds 
\emph on
maxaug
\emph default
.
\end_layout

\begin_layout Subsection
Frictionless Fluid Wall
\begin_inset CommandInset label
LatexCommand label
name "subsec:Frictionless-Fluid-Wall"

\end_inset


\end_layout

\begin_layout Standard
One of the natural boundary conditions for fluid analyses is to enforce zero fluid velocity normal to a boundary,
 implying that this boundary is a frictionless fluid wall.
 In some analyses however,
 this natural boundary condition may not be enforced sufficiently well.
 In such cases,
 use this frictionless fluid wall linear constraint to produce a more strict enforcement of this condition.
\end_layout

\begin_layout LyX-Code
<constraint type="frictionless fluid wall" name="FrictionlessFluidWall1" surface="FrictionlessFluidWall1">
\end_layout

\begin_layout LyX-Code
	<laugon>0</laugon>
\end_layout

\begin_layout LyX-Code
	<tol>0.2</tol>
\end_layout

\begin_layout LyX-Code
	<penalty>1</penalty>
\end_layout

\begin_layout LyX-Code
	<minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
	<maxaug>10</maxaug>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
In fluid-structure interaction analyses,
 this constraint may be used in conjunction with the 
\emph on
symmetry plane
\emph default
 described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Symmetry-Plane"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 using a lower value of the 
\emph on
penalty
\emph default
 parameter,
 as may be necessary in practice.
\end_layout

\begin_layout Subsection
Fixed Normal Displacement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fixed-Normal-Displacement"

\end_inset


\end_layout

\begin_layout Standard
A fixed normal displacement constraint enforces zero solid displacement normal to a user-selected surface.
 This constraint is prescribed on a deformable surface of the model and is enforced for every node on that surface.
 It uses the local surface normal in the selected surface's reference configuration.
 If the selected surface is planar,
 the functionality of this constraint is equivalent to the Symmetry Plane constraint described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Symmetry-Plane"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout LyX-Code
<constraint type="fixed normal displacement" surface="FixedNormalDisplacement01">
\end_layout

\begin_layout LyX-Code
	<laugon>0</laugon>
\end_layout

\begin_layout LyX-Code
	<penalty>1000</penalty>
\end_layout

\begin_layout LyX-Code
	<tol>0.2</tol>
\end_layout

\begin_layout LyX-Code
	<minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
	<maxaug>10</maxaug>
\end_layout

\begin_layout LyX-Code
	<shell_bottom>0</shell_bottom>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
The 
\emph on
surface
\emph default
 (FixedNormalDisplacement01 in this example),
 is defined in the 
\emph on
Mesh
\emph default
 section.
 Let 
\begin_inset Formula $\mathbf{u}$
\end_inset

 denote the nodal displacement vector and let 
\begin_inset Formula $\mathbf{n}$
\end_inset

 denote the unit normal at each node of the surface;
 the fixed normal displacement constraint enforces 
\begin_inset Formula $u_{n}\equiv\mathbf{u}\cdot\mathbf{n}=0$
\end_inset

 using a penalty method,
 optionally with augmented Lagrangian.
 The reaction force needed to enforce this constraint is evaluated as 
\begin_inset Formula $\varepsilon u_{n}$
\end_inset

,
 where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the user-specified 
\emph on
penalty
\emph default
 parameter (with units of force per length).
 To use the augmented Lagrangian method,
 set 
\emph on
laugon
\emph default
 to 1,
 and the Lagrange multiplier 
\begin_inset Formula $\lambda$
\end_inset

 will be augmented as 
\begin_inset Formula $\lambda\leftarrow\lambda+\varepsilon u_{n}$
\end_inset

.
 Augmentations terminate when the relative change in 
\begin_inset Formula $\lambda$
\end_inset

 is less than the user-specified tolerance 
\emph on
tol
\emph default
,
 or when the number of augmentations exceeds 
\emph on
maxaug
\emph default
.
\end_layout

\begin_layout Standard
For example,
 this constraint may be used on a cylindrical shaft,
 over the portion of the shaft which is supported by a bearing journal.
\end_layout

\begin_layout Subsection
Normal Fluid Velocity Constraint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Normal-Fluid-Velocity"

\end_inset


\end_layout

\begin_layout Standard
A normal fluid velocity constraint forces the fluid velocity to remain normal to the selected surface.
 It is enforced for every node on that surface.
\end_layout

\begin_layout LyX-Code
<constraint type="normal fluid velocity" surface="NormalFlowSurface01">
\end_layout

\begin_layout LyX-Code
	<laugon>1</laugon>
\end_layout

\begin_layout LyX-Code
	<penalty>1e6</penalty>
\end_layout

\begin_layout LyX-Code
	<tol>1e-6</tol>
\end_layout

\begin_layout LyX-Code
	<minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
	<maxaug>50</maxaug>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
The 
\emph on
surface
\emph default
 (NormalFlowSurface01 in this example),
 is defined in the 
\emph on
Mesh
\emph default
 section.
 Let 
\begin_inset Formula $\mathbf{v}$
\end_inset

 denote the nodal fluid velocity vector and let 
\begin_inset Formula $\mathbf{n}$
\end_inset

 denote the unit normal at each node;
 the normal flow constraint enforces 
\begin_inset Formula $\mathbf{v}=\left(\mathbf{v}\cdot\mathbf{n}\right)\mathbf{n}$
\end_inset

,
 or equivalently,
 
\begin_inset Formula $\mathbf{v}_{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{v}=\mathbf{0}$
\end_inset

,
 using a penalty method,
 optionally with augmented Lagrangian.
 The reaction force needed to enforce this constraint is evaluated as 
\begin_inset Formula $\varepsilon\mathbf{v}_{\tau}$
\end_inset

,
 where 
\begin_inset Formula $\varepsilon$
\end_inset

 is the user-specified 
\emph on
penalty
\emph default
 parameter (with units of force per velocity).
 To use the augmented Lagrangian method,
 set 
\emph on
laugon
\emph default
 to 1,
 and the vectorial Lagrange multiplier 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 will be augmented as 
\begin_inset Formula $\boldsymbol{\lambda}\leftarrow\boldsymbol{\lambda}+\varepsilon\mathbf{v}_{\tau}$
\end_inset

.
 Augmentations terminate when the relative change in 
\begin_inset Formula $\boldsymbol{\lambda}$
\end_inset

 is less than the user-specified tolerance 
\emph on
tol
\emph default
,
 or when the number of augmentations exceeds 
\emph on
maxaug
\emph default
.
\end_layout

\begin_layout Standard
This constraint should only be used on a surface where the fluid pressure or dilatation has been fixed or prescribed.
 It is not compatible with boundary conditions that prescribe the fluid velocity.
 To prescribe a fluid velocity that remains normal to the selected surface,
 use the surface load 
\emph on
fluid normal velocity
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Normal-Velocity"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Uniform Fluid Velocity Constraint
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uniform-Fluid-Velocity"

\end_inset


\end_layout

\begin_layout Standard
When an inlet boundary is subjected to a prescribed fluid pressure,
 the profile of the inlet fluid velocity remains unconstrained,
 and this lack of constraint often leads to poor numerical performance due to the production of velocity spikes.
 To avoid this problem,
 use this uniform fluid velocity constraint to help stabilize inlet conditions along the direction normal to the bondary.
 This constraint evaluates the average fluid velocity normal to the selected boundary,
 
\begin_inset Formula $\bar{v}_{n}$
\end_inset

,
 then prescribes a linear constraint at every node such that 
\begin_inset Formula $\mathbf{v}\cdot\mathbf{n}=\bar{v}_{n}$
\end_inset

 is enforced.
 For example,
\end_layout

\begin_layout LyX-Code
<constraint name="UniformFluidFlow1" surface="UniformFluidFlow1" type="uniform fluid flow">
\end_layout

\begin_layout LyX-Code
	<laugon>0</laugon>
\end_layout

\begin_layout LyX-Code
	<tol>0.1</tol>
\end_layout

\begin_layout LyX-Code
	<penalty>10000</penalty>
\end_layout

\begin_layout LyX-Code
	<minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
	<maxaug>50</maxaug>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
If a very strong enforcement of this constraint is desired,
 increase the 
\emph on
penalty
\emph default
 and/or turn Lagrange augmentation on (
\emph on
laugon
\emph default
=1).
 This constraint is not compatible with boundary conditions that prescribe the normal component of the fluid velocity on that same boundary.
\end_layout

\begin_layout Subsection
The Prestrain Update Rules
\begin_inset CommandInset label
LatexCommand label
name "subsec:The-Prestrain-Update"

\end_inset


\end_layout

\begin_layout Standard
The prestrain update rules for are implemented via non-linear constraints in FEBio.
 This is done because non-linear constraints automatically participate in FEBios augmentation mechanism,
 which allows the user to update and rerun the time step.
 The following section details how to setup the update rules in the FEBio input file and discusses the currently supported rules.
\end_layout

\begin_layout Subsubsection
Using Update rules
\end_layout

\begin_layout Standard
In order to apply an update rule,
 a constraint definition must be added to the Constraints section of the input file.
 The type attribute is used to specify which update rule to use.
\end_layout

\begin_layout LyX-Code
<Constraints>
\end_layout

\begin_layout LyX-Code
  <constraint type="[name of update rule]">
\end_layout

\begin_layout LyX-Code
    <!-- parameters go here -->
\end_layout

\begin_layout LyX-Code
  </constraint>
\end_layout

\begin_layout LyX-Code
</Constraints> 
\end_layout

\begin_layout Standard
The following table lists the available update rules.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prestrain
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Eliminate distortion due to incompatibility
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
in-situ stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Enforce the given in-situ fiber stretches
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Below,
 the supported update rules are presented in more detail.
 All of them share parameters for controlling the convergence of the update algorithm and these shared parameters are listed in the following table.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
initial value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
update
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
update flag (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
min_iters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum number of iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
max_iters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-1 (i.e.
 ignored)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
 
\end_layout

\begin_layout Enumerate
By specifying a loadcurve for the update flag,
 the update can be delayed.
 This can be useful if,
 for instance,
 the prestrain is applied incrementally and the update rule should not be applied until the full prestrain field is applied.
 In that case,
 specifying a loadcurve for the update flag that is zero while the prestrain is applied,
 will delay the update process.
 
\end_layout

\begin_layout Subsubsection
prestrain update rule
\end_layout

\begin_layout Standard
The idea behind this rule is to eliminate the distortion induced by the incompatibility of the initial prestrain gradient with the reference geometry.
 Thus,
 we retain the original reference geometry at the cost of an altered effective prestain field.
 The update rule is given by the following equation.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{G^{\mathit{k+1}}}=\mathbf{G^{\mathit{k}}}\cdot\mathbf{F_{\mathit{c}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This update rule does not define any additional parameters aside the ones from above.
\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
\end_layout

\begin_layout LyX-Code
<constraint type="prestrain">
\end_layout

\begin_layout LyX-Code
  <tolerance>0.01</tolerance>
\end_layout

\begin_layout LyX-Code
</constraint> 
\end_layout

\begin_layout Subsubsection
The in-situ stretch update rule
\end_layout

\begin_layout Standard
The idea behind this update rule is to enforce the fiber stretch induced by the initial prestrain gradient.
 As with the in-situ stretch generator option,
 this rule has an isochoric version and an uniaxial version for the update rule.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{G}_{iso}=\mathbf{Q}\left[\begin{array}{ccc}
\lambda^{-1}\\
 & \lambda^{1/2}\\
 &  & \lambda^{1/2}
\end{array}\right]\mathbf{Q^{\mathrm{\mathit{T}}}},\qquad\mathbf{G}_{uni}=\mathbf{Q}\left[\begin{array}{ccc}
\lambda^{-1}\\
 & 1\\
 &  & 1
\end{array}\right]\mathbf{Q^{\mathit{T}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\lambda^{2}=\mathbf{a}_{0}\cdot\mathbf{C}^{k}\cdot\mathbf{a}_{0}$
\end_inset

,
 is the fiber stretch induced by the distortion.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
initial value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isochoric
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Choose the isochoric update rule or not
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1(=true)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
\end_layout

\begin_layout LyX-Code
<constraint type="in-situ stretch">
\end_layout

\begin_layout LyX-Code
  <tolerance>0.01</tolerance>
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
</constraint> 
\end_layout

\begin_layout Subsection
Node Distance
\end_layout

\begin_layout Standard
A 
\begin_inset Quotes eld
\end_inset

node distance
\begin_inset Quotes erd
\end_inset

 constraint can be used to enforce a user-defined distance between two nodes.
 The target distance can be defined as a distance relative to the initial
 seperation between the two nodes, or as an absolute distance.
 This constraint takes the following parameters.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
initial value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
laugon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Turn on augmented Lagrangian flag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0(=false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
augtol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Augmentation tolerance.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Penalty factor for constrtaint enforcement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
node
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IDs of the two nodes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[-1,-1] (invalid)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minaug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimum nr of augmentations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maxaug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum nr of augmentations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
target
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Target distance between two nodes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use relative or absolute distance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 (=true)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The default configuration of this constraint is such that the initial distance
 between the two nodes is preserved.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Example
\emph default
:
\end_layout

\begin_layout Standard
This example illustrates how the 
\emph on
node distance
\emph default
 constraint can be used to reduce the distance between two nodes to zero:
 the target is set to zero and the relative flag is off so that the target
 is interpreted as an absolute distance.
 
\end_layout

\begin_layout LyX-Code
<constraint name="NodeDistance3" type="node distance">
\end_layout

\begin_layout LyX-Code
  <laugon>0</laugon>
\end_layout

\begin_layout LyX-Code
  <augtol>0.01</augtol>
\end_layout

\begin_layout LyX-Code
  <penalty lc="1">1</penalty>
\end_layout

\begin_layout LyX-Code
  <node>17,158</node>
\end_layout

\begin_layout LyX-Code
  <minaug>0</minaug>
\end_layout

\begin_layout LyX-Code
  <maxaug>10</maxaug>
\end_layout

\begin_layout LyX-Code
  <target>0</target>
\end_layout

\begin_layout LyX-Code
  <relative>0</relative>
\end_layout

\begin_layout LyX-Code
</constraint>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Discrete Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Discrete-Section"

\end_inset


\end_layout

\begin_layout Standard
This section defines the materials used by the discrete elements and assigns these materials to the discrete elements sets defined in the 
\emph on
Mesh
\emph default
 section.
 The materials are defined via the 
\shape italic
discrete_material 
\shape default
element and the materials are assigned to discrete element sets using the 
\shape italic
discrete 
\shape default
element.
\end_layout

\begin_layout LyX-Code
<Discrete>
\end_layout

\begin_layout LyX-Code
  <discrete_material id="1" type="nonlinear spring">
\end_layout

\begin_layout LyX-Code
    <force lc="1">1.0</force>
\end_layout

\begin_layout LyX-Code
  </discrete_material>
\end_layout

\begin_layout LyX-Code
  <discrete_material id="2" type="linear spring">
\end_layout

\begin_layout LyX-Code
    <E>2.0</E>
\end_layout

\begin_layout LyX-Code
  </discrete_material>
\end_layout

\begin_layout LyX-Code
  <discrete dmat="1" discrete_set="springs1"/>
\end_layout

\begin_layout LyX-Code
  <discrete dmat="2" discrete_set="springs2">
\end_layout

\begin_layout LyX-Code
</Discrete>
\end_layout

\begin_layout Standard
The 
\shape italic
discrete_material 
\shape default
and the 
\shape italic
discrete 
\shape default
elemens are defined in more detail below.
\end_layout

\begin_layout Subsection
Discrete Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discrete-Materials"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
discrete_material 
\shape default
section defines a material that can be assigned to a discrete element set.
 The 
\shape italic
id 
\shape default
attribute defines the material ID and the 
\shape italic
type 
\shape default
attribute defines the material type.
 The following types are currently supported.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
linear spring
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
spring that has a linear force-displacement relation 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nonlinear spring
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
user defines the force-displacement relation 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hill
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
discrete material that defines a Hill-type muscle model
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Linear Spring
\end_layout

\begin_layout Standard
The linear spring requires the E parameter that defines the spring constant.
\end_layout

\begin_layout Subsubsection
Nonlinear spring
\end_layout

\begin_layout Standard
The nonlinear spring requires the 
\shape italic
force
\shape default
 parameter,
 which defines the loadcurve that will be used for the force-displacement relation.
\end_layout

\begin_layout Subsubsection
Hill
\end_layout

\begin_layout Standard
The Hill discrete material defines the following parameters.
 
\end_layout

\begin_layout Itemize

\emph on
Vmax
\emph default
:
 maximum shortening velocity
\end_layout

\begin_layout Itemize

\emph on
ac
\emph default
:
 activation level
\end_layout

\begin_layout Itemize

\emph on
Fmax
\emph default
:
 maximum force
\end_layout

\begin_layout Itemize

\emph on
Ksh
\emph default
:
 shape parameter
\end_layout

\begin_layout Itemize

\emph on
Lmax
\emph default
:
 strain (i.e.
 stretch - 1) at which Fmax occurs.
 
\end_layout

\begin_layout Itemize

\emph on
L0
\emph default
:
 initial reference length
\end_layout

\begin_layout Itemize

\emph on
Sv
\emph default
:
 max velocity scale
\end_layout

\begin_layout Itemize

\emph on
Ftl
\emph default
:
 normalized tension-length curve
\end_layout

\begin_layout Itemize

\emph on
Ftv
\emph default
:
 normalized tension-velocity curve
\end_layout

\begin_layout Standard
The force in the Hill discrete element is the sum of the passive element and the active element.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
F=F_{p}+F_{a}
\]

\end_inset


\end_layout

\begin_layout Standard
The passive force is given by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
F_{p}=\begin{cases}
Fmax\left(\exp\left(Ksh\left(l-1\right)/Lmax-1\right)/\exp\left(Ksh-1\right)\right) & ,l>1\\
0 & ,l\leqslant1
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
where l is the relative stretch defined by,
 
\begin_inset Formula $l=lm/l0$
\end_inset

 and 
\begin_inset Formula $lm$
\end_inset

is the discrete element length and 
\begin_inset Formula $l0$
\end_inset

is either the L0 parameter,
 or the initial discrete element length (if L0 is set to zero).
 
\end_layout

\begin_layout Standard
The active force is given by,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Fa=ac*Fmax*Ftl\left(l\right)*Ftv\left(v\right)
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $v$
\end_inset

,
 a measure of the relative discrete element's growth speed,
 is defined by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v=vm/\left(Vmax*Sv\left(ac\right)\right)
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $vm$
\end_inset

is the actual discrete element's growth speed.
 
\end_layout

\begin_layout Standard
The properties Sv,
 Ftl,
 and Ftv,
 are optional and will evaluate to 1 if omitted.
 They can be defined as load curves.
 See the exampe below.
 
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<discrete_material id="1" name="test" type="Hill">
\end_layout

\begin_layout LyX-Code
  <Vmax>1</Vmax>
\end_layout

\begin_layout LyX-Code
  <ac>0.1</ac>
\end_layout

\begin_layout LyX-Code
  <Fmax>50</Fmax>
\end_layout

\begin_layout LyX-Code
  <Ksh>5</Ksh>
\end_layout

\begin_layout LyX-Code
  <Lmax>1.5</Lmax>
\end_layout

\begin_layout LyX-Code
  <L0>10</L0>
\end_layout

\begin_layout LyX-Code
  <Ftl type="point">
\end_layout

\begin_layout LyX-Code
    <interpolate>smooth</interpolate> 				
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <pt>0.0,	0</pt>
\end_layout

\begin_layout LyX-Code
      <pt>0.1,	0.000258139</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.2,	0.00161616</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.3,	0.00740118</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.4,	0.0272783</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.5,	0.0820396</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.6,	0.201851</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.7,	0.406524</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.8,	0.670275</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>0.9,	0.904792</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.0,	0.999955</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.1,	0.904792</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.2,	0.670275</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.3,	0.406524</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.4,	0.201851</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.5,	0.0820396</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.6,	0.0272783</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.7,	0.00740118</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.8,	0.00161616</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>1.9,	0.000258139</pt>
\end_layout

\begin_layout LyX-Code
  	<pt>2.0,	0</pt>
\end_layout

\begin_layout LyX-Code
	</points>
\end_layout

\begin_layout LyX-Code
  </Ftl> 
\end_layout

\begin_layout LyX-Code
</discrete_material> 
\end_layout

\begin_layout Subsection
Discrete Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Discrete-Section"

\end_inset


\end_layout

\begin_layout Standard
After the discrete materials are defined,
 the materials are assigned to the discrete element sets that are defined in the 
\emph on
Mesh
\emph default
 section using the 
\shape italic
discrete 
\shape default
element.
 This element requires two attributes:
\end_layout

\begin_layout Description

\series bold
dmat
\series default
 discrete material ID 
\end_layout

\begin_layout Description

\series bold
discrete_set
\series default
 discrete element set defined in the 
\emph on
Mesh
\emph default
 section 
\end_layout

\begin_layout Subsection
Rigid Cable
\end_layout

\begin_layout Standard
A rigid cable can be used to apply a load to a series of rigid bodies that are connected at fixed points (fixed with respect to the rigid body).
 The cable runs through these points and the user can prescribe the force at the end of the cable.
 The rigid cable requires the following parameters.
\end_layout

\begin_layout Description
force The magnitude of the force applied at the end of the cable.
\end_layout

\begin_layout Description
force_direction The direction of the force (FEBio will normalize this vector if needed.)
\end_layout

\begin_layout Description
relative If set to 1 the coordinates of the fixed points are relative to the rigid body frame of reference,
 otherwise they are in global coordinates.
\end_layout

\begin_layout Description
point For each fixed point,
 enter the coordinates of the point.
 This tag requires the rb attribute to denote the rigid body it is attached to.
 
\end_layout

\begin_layout Standard
The following shows an example.
 
\end_layout

\begin_layout LyX-Code
<rigid_cable>
\end_layout

\begin_deeper
\begin_layout LyX-Code
<force lc="1">1000</force>
\end_layout

\begin_layout LyX-Code
<force_direction>0,0,-1</force_direction>
\end_layout

\begin_layout LyX-Code
<relative>1</relative>
\end_layout

\begin_layout LyX-Code
<point rb="1">0,0,0</point>
\end_layout

\begin_layout LyX-Code
<point rb="2">0,0,0</point>
\end_layout

\end_deeper
\begin_layout LyX-Code
</rigid_cable>
\end_layout

\begin_layout Standard
This example defines a cable that runs through the centers of mass of two rigid bodies.
 The force is applied in the -z direction at the end of the cable (i.e.
 point 2).
 
\end_layout

\begin_layout LyX-Code
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Step Section
\end_layout

\begin_layout Standard
The analysis can be divided into separate steps,
 where in each step,
 different boundary and loading conditions can be applied.
 Each analysis step is defined via a 
\emph on
step 
\emph default
section.
 In each step,
 the following sections can be defined:
 
\end_layout

\begin_layout Itemize
Control
\end_layout

\begin_layout Itemize
Initial
\end_layout

\begin_layout Itemize
Boundary
\end_layout

\begin_layout Itemize
Loads
\end_layout

\begin_layout Itemize
Constraints
\end_layout

\begin_layout Itemize
Contact
\end_layout

\begin_layout Itemize
Rigid
\end_layout

\begin_layout Standard
When a boundary condition,
 (load,
 constraint,
 contact,
 etc.,) is applied to a step,
 then this boundary condition (load,
 constraint,
 contact,
 etc.) is only active during that step.
 Boundary conditions (loads,
 constraints,
 contacts,
 etc.) that are defined in the main body of the file will persist through all the step.
 
\end_layout

\begin_layout LyX-Code
<!-- main body of file -->
\end_layout

\begin_layout LyX-Code
 ...
\end_layout

\begin_layout LyX-Code
<Step> 
\end_layout

\begin_layout LyX-Code
 <step id="1"> 
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
     
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
 </step>
\end_layout

\begin_layout LyX-Code
 <step id="2">
\end_layout

\begin_layout LyX-Code
   <Control>
\end_layout

\begin_layout LyX-Code
     
\end_layout

\begin_layout LyX-Code
   </Control>
\end_layout

\begin_layout LyX-Code
 </step> 
\end_layout

\begin_layout LyX-Code
   
\end_layout

\begin_layout LyX-Code
</Step>
\end_layout

\begin_layout LyX-Code
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
LoadData Section
\begin_inset CommandInset label
LatexCommand label
name "sec:LoadData-Section"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
LoadData
\shape default
 section is used to define load controllers.
 A load controller allows users to manipulate the value of most model parameters as an explicit or implicit function of time.
 Use the 
\emph on
type
\emph default
 attribute to define a particular controller.
 Currently the following load controllers are available:
\end_layout

\begin_layout Itemize

\series bold
loadcurve
\series default
:
 the controller is a load curve,
 which is a tabulated list of time-value pairs.
 The user can set how the points are interpolated and how to extend the curve outside of its specified interval.
\end_layout

\begin_layout Itemize

\series bold
math
\series default
:
 the math controller allows the user to specify a mathematical expression that defines a function of time.
 Other model parameters can be used in the mathematical expression.
\end_layout

\begin_layout Itemize

\series bold
math-interval
\series default
:
 Similar to the math controller,
 but the math expression is defined only over a time interval.
 The behavior outside the interval can be specified separately.
 
\end_layout

\begin_layout Itemize

\series bold
PID
\series default
:
 a PID controller,
 which allows the value of a model parameter to be dependent on the values and their time history of other model parameters.
 
\end_layout

\begin_layout Subsection
The loadcurve controller
\end_layout

\begin_layout Standard
A loadcurve controller is defined by the 
\shape italic
loadcurve 
\shape default
type.
 Each loadcurve is defined by repeating the 
\shape italic
point 
\shape default
element for all data points:
\end_layout

\begin_layout LyX-Code
<load_controller id="1" 
\series bold
type="loadcurve"
\series default
>
\end_layout

\begin_layout LyX-Code
  <interpolate>LINEAR</interpolate>
\end_layout

\begin_layout LyX-Code
  <extend>CONSTANT</extend>
\end_layout

\begin_layout LyX-Code
  <points>
\end_layout

\begin_layout LyX-Code
    <point> 0,
 0 </point>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
    <point> 1,
 1 </point>
\end_layout

\begin_layout LyX-Code
  </points>
\end_layout

\begin_layout LyX-Code
</loadcurve>
\end_layout

\begin_layout Standard
For a loadcurve,
 the type is optional,
 since it is the default controller if the type attribute is omitted.
 
\end_layout

\begin_layout Standard
The 
\shape italic
id 
\shape default
attribute is the loadcurve number and is used in other sections of the input file as a means to reference this curve.
\end_layout

\begin_layout Standard
The optional parameters 
\shape italic
interpolate 
\shape default
and 
\shape italic
extend 
\shape default
define how the value of the loadcurve is interpolated from the data points.
 The interpolate defines the interpolation function and 
\shape italic
extend 
\shape default
defines how the values of the loadcurve are determined outside of the interval defined by the first and last data point.
 The following tables list the possible values.
 The default values are marked with an asterisk (*).
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
interpolate
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STEP
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use a step interpolation function 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LINEAR*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use a linear interpolation function 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SMOOTH
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The values are interpolated using a cubic polynomial.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigLoadCurveTypes.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
The different values for the 
\emph on
interpolate
\emph default
 parameter of load curves
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Extend
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CONSTANT*
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The value of the curve is the value of the closest endpoint 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
EXTRAPOLATE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The value is extrapolated linearly from the endpoints 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REPEAT
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The curve is repeated 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REPEAT OFFSET
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The curve is repeated but offset from the endpoints 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigLoadCurveExtend.png
	lyxscale 50
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
The different values for the 
\emph on
extend
\emph default
 parameter of the load curve.
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
The math controller
\end_layout

\begin_layout Standard
Use the 
\begin_inset Quotes eld
\end_inset

math
\begin_inset Quotes erd
\end_inset

 value for the 
\emph on
type
\emph default
 attribute to define a math controller.
 This controller allows users to use a mathematical expression that defines a function of time.
 Use the 
\begin_inset Quotes eld
\end_inset

t
\begin_inset Quotes erd
\end_inset

 parameter to reference time.
\end_layout

\begin_layout LyX-Code
<load_controller id="1" 
\series bold
type="math"
\series default
>
\end_layout

\begin_layout LyX-Code
    <math>2.0*sin(pi*t)</math>
\end_layout

\begin_layout LyX-Code
</load_controller>
\end_layout

\begin_layout Subsection
The PID controller
\end_layout

\begin_layout Standard
The PID controller allows users to create simple control systems where the value of one model parameter is used to control the output of another model parameter.
 The PID controller calculates the output value as a sum of three terms:
 a term proportional to the error (i.e.
 the difference between a user-defined target value and the measurement),
 a derivative term,
 and an integral term.
 
\end_layout

\begin_layout Standard
This controller requires the following parameters:
\end_layout

\begin_layout Itemize

\series bold
var
\series default
:
 specify the model parameter that is used as process variable,
 i.e.
 the measurement.
\end_layout

\begin_layout Itemize

\series bold
target
\series default
:
 the target value for the process variable.
 
\end_layout

\begin_layout Itemize

\series bold
Kp
\series default
:
 weight factor for the proportional term.
\end_layout

\begin_layout Itemize

\series bold
Kd
\series default
:
 weight factor for the derivative term
\end_layout

\begin_layout Itemize

\series bold
Ki
\series default
:
 weight factor for the integral term.
 
\end_layout

\begin_layout Standard
For example:
\end_layout

\begin_layout LyX-Code
<load_controller id="1" 
\series bold
type="PID"
\series default
>
\end_layout

\begin_layout LyX-Code
    <var>fem.rigid_body[1].euler.z</var>
\end_layout

\begin_layout LyX-Code
    <target>1.5708</target>
\end_layout

\begin_layout LyX-Code
    <Kp>5</Kp>
\end_layout

\begin_layout LyX-Code
    <Kd>1</Kd>
\end_layout

\begin_layout LyX-Code
    <Ki>4</Ki>
\end_layout

\begin_layout LyX-Code
</load_controller>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Output Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Output-Section"

\end_inset


\end_layout

\begin_layout Standard
FEBio usually splits the output in two files:
 the 
\shape italic
logfile,

\shape default
 which contains the same information that was written to the screen during the analysis,
 and the 
\shape italic
plotfile,

\shape default
 which contains the results.
 The contents of these output files can be customized in the 
\shape italic
Output
\shape default
 section.
\end_layout

\begin_layout Subsection
Logfile
\begin_inset CommandInset label
LatexCommand label
name "subsec:Logfile"

\end_inset


\end_layout

\begin_layout Standard
The logfile records the same output that is printed to the screen.
 In addition,
 the user can request FEBio to output additional data to the logfile.
 This feature is called 
\shape italic
data logging
\shape default
.
 To use this feature,
 simply define the following element in the 
\shape italic
Output
\shape default
 section of the input file:
\end_layout

\begin_layout LyX-Code
<Output>
\end_layout

\begin_layout LyX-Code
  <logfile [file="<log file>"]>
\end_layout

\begin_layout LyX-Code
    <node_data [attributes]>item list</node_data>
\end_layout

\begin_layout LyX-Code
    <element_data [attributes]>item list</element_data>
\end_layout

\begin_layout LyX-Code
    <rigid_body_data [attributes]>item list</rigid_body_data>
\end_layout

\begin_layout LyX-Code
  </logfile>
\end_layout

\begin_layout LyX-Code
</Output>
\end_layout

\begin_layout Standard
The optional attribute 
\shape italic
file 
\shape default
defines the name of the logfile.
 If omitted,
 a default name is used that is derived from the FEBio input file.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:FEBio-Output"
nolink "false"

\end_inset

 for details on default naming conventions for output files.
\end_layout

\begin_layout Standard
Additional data is stored to the logfile by adding one or more of the following elements:
\end_layout

\begin_layout Description

\shape italic
\emph on
node_data
\shape default
\emph default
 request nodal data 
\end_layout

\begin_layout Description
face_data request surface data
\end_layout

\begin_layout Description

\shape italic
\emph on
element_data
\shape default
\emph default
 request element data 
\end_layout

\begin_layout Description

\shape italic
\emph on
rigid_body_data
\shape default
\emph default
 request rigid body data 
\end_layout

\begin_layout Standard
Each of these data classes takes the following attributes:
\end_layout

\begin_layout Description

\shape italic
\emph on
data
\shape default
\emph default
 an expression defining the data that is to be stored 
\end_layout

\begin_layout Description

\shape italic
\emph on
name
\shape default
\emph default
 a descriptive name for the data (optional;
 default = data expression) 
\end_layout

\begin_layout Description

\shape italic
\emph on
file
\shape default
\emph default
 the name of the output file where the data is stored.
 (optional;
 default = logfile) 
\end_layout

\begin_layout Description

\shape italic
\emph on
delim
\shape default
\emph default
 the delimiter used to separate data in multi-column format (optional;
 default = space) 
\end_layout

\begin_layout Description

\shape italic
\emph on
format
\shape default
\emph default
 an optional format string (optional;
 default = not used) 
\end_layout

\begin_layout Standard
The 
\shape italic
data 
\shape default
attribute is the most important one and is mandatory.
 It contains a list of variable names,
 separated by a semi-colon.
 The available variable names depend on the data class and are defined below.
 For example,
 the data expression:
\end_layout

\begin_layout LyX-Code
data="x;y;z"
\end_layout

\begin_layout Standard
will store the variables 
\begin_inset Formula $x$
\end_inset

,
 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $z$
\end_inset

 in separate columns.
 See below for more examples.
\end_layout

\begin_layout Standard
The optional 
\shape italic
name 
\shape default
attribute is a descriptive name for the data.
 It is used in the logfile to refer to this data and can be used to quickly find the data record in the logfile.
 If omitted,
 the data expression is used as the name.
\end_layout

\begin_layout Standard
The
\shape italic
 file 
\shape default
attribute defines the name of the output file where the data is to be stored.
 This attribute is optional and when not specified the data will be stored in the logfile.
\end_layout

\begin_layout Standard
The optional 
\shape italic
delim
\shape default
 attribute defines the delimiter that is used in multi-column format.
 As described above,
 data can be stored in multiple columns and the delimiter is used to separate the columns.
 The default is a single space.
\end_layout

\begin_layout Standard
The optional 
\shape italic
format 
\shape default
attribute defines a format string that will be used to format the output.
 If this attribute is present,
 the 
\shape italic
delim 
\shape default
attribute will be ignored.
 The format string is composed of literal characters and special formatting characters.
 The special formatting characters are preceded by the percentage character (%).
 The following formatting characters are currently defined.
\end_layout

\begin_layout Description
%i replace with the index of the corresponding item (i.e.
 node numbers for node data) 
\end_layout

\begin_layout Description
%g replace with a data value.
 Use a %g for each data item.
 
\end_layout

\begin_layout Description
%t insert tab character in output.
 
\end_layout

\begin_layout Description
%n insert newline character in output.
 
\end_layout

\begin_layout Standard
The following example,
\end_layout

\begin_layout LyX-Code
<node_data data="x;y;z" format='<node id="%i">%g,%g,%g</node>'></node_data>
\end_layout

\begin_layout Standard
will print the following output (e.g.
 for node 1).
\end_layout

\begin_layout LyX-Code
<node id="1">0.1,0.2,0.3</node>
\end_layout

\begin_layout Standard
Notice the use of the apostrophe (') in the format string.
 This is necessary in order to include the quotation marks as part of the format string.
 Also note that each data string will automatically be printed on a new line,
 so there is no need to end the format string with a newline character.
\end_layout

\begin_layout Standard
The value of the data elements is a list of items for which the data is to be stored.
 For example,
 for the 
\shape italic
node_data 
\shape default
element the value is a list of nodes,
 for the 
\shape italic
element_data 
\shape default
element it is a list of FE elements and for the 
\shape italic
rigid_body 
\shape default
element it is a list of rigid bodies.
 The value may be omitted in which case the data for all items will be stored.
 For instance,
 omitting the value for the 
\shape italic
node_data 
\shape default
element will store the data for all nodes.
\end_layout

\begin_layout Standard
As stated above,
 the data is either stored in the logfile or in a separate file.
 In any case,
 a record is made in the logfile.
 When storing the data in the logfile,
 the following entry will be found in the logfile at the end of each converged timestep for each data element:
\end_layout

\begin_layout LyX-Code
Data Record #<n>
\end_layout

\begin_layout LyX-Code
Step = <time step>
\end_layout

\begin_layout LyX-Code
Time = <time value>
\end_layout

\begin_layout LyX-Code
Data = <data name>
\end_layout

\begin_layout LyX-Code
<actual data goes here>
\end_layout

\begin_layout Standard
The record number 
\begin_inset Formula $n$
\end_inset

 corresponds to the 
\begin_inset Formula $n$
\end_inset

th data element in the input file.
 The 
\shape italic
Step 
\shape default
value is the current time step.
 The 
\shape italic
Time 
\shape default
value is the current solution time.
 The 
\shape italic
Data 
\shape default
value is the name of the data element as provided by the 
\shape italic
name 
\shape default
attribute (or the 
\shape italic
data 
\shape default
attribute if 
\shape italic
name 
\shape default
is omitted).
 The actual data immediately follows this record.
 If multiple column output is used,
 the columns are separated by the 
\shape italic
delim 
\shape default
attribute of the data element.
\end_layout

\begin_layout Standard
When storing the data in a separate file,
 the format is slightly different:
\end_layout

\begin_layout LyX-Code
Data Record #<n>
\end_layout

\begin_layout LyX-Code
Step = <time step>
\end_layout

\begin_layout LyX-Code
Time = <time value>
\end_layout

\begin_layout LyX-Code
Data = <data name>
\end_layout

\begin_layout LyX-Code
File = <file name>
\end_layout

\begin_layout Standard
The 
\shape italic
File 
\shape default
value is the name of the physical file.
 Note that this is the name to which the time step number is appended.
 In addition,
 the physical file that stores the data contains the following header:
\end_layout

\begin_layout LyX-Code
*Step = <time step>
\end_layout

\begin_layout LyX-Code
*Time = <time value>
\end_layout

\begin_layout LyX-Code
*Data = <data name>
\end_layout

\begin_layout LyX-Code
<actual data goes here>
\end_layout

\begin_layout Standard
In either case,
 the actual data is a multi-column list,
 separated by the delimiter specified with the 
\shape italic
delim 
\shape default
attribute (or a space when omitted).
 The first column always contains the item number.
 For example,
 the following data element:
\end_layout

\begin_layout LyX-Code
<node_data
\end_layout

\begin_layout LyX-Code
data="x;y;z" name="nodal coordinates" delim=",">1:4:1</node_data>
\end_layout

\begin_layout Standard
will result in the following record in the logfile:
\end_layout

\begin_layout LyX-Code
Data Record #1
\end_layout

\begin_layout LyX-Code
Step = 1
\end_layout

\begin_layout LyX-Code
Time = 0.1
\end_layout

\begin_layout LyX-Code
Data = "nodal coordinates"
\end_layout

\begin_layout LyX-Code
1,0.000,0.000,0.000
\end_layout

\begin_layout LyX-Code
2,1.000,0.000,0.000
\end_layout

\begin_layout LyX-Code
3,1.000,1.000,0.000
\end_layout

\begin_layout LyX-Code
4,0.000,1.000,0.000
\end_layout

\begin_layout Standard
This data record is repeated for each converged time step.
 The following sections define the data variables that are available for each of the data classes.
\end_layout

\begin_layout Subsubsection
Node_Data Class
\begin_inset CommandInset label
LatexCommand label
name "subsec:Node_Data-Class"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
node_data 
\shape default
class defines a set of nodal variables.
 The data is stored for each node that is listed in the item list of the 
\shape italic
node_data 
\shape default
element or for all nodes if no list is defined.
 The following nodal variables are defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="16" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Node variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of current nodal position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of current nodal position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of current nodal position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ux
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of nodal displacement 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
uy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of nodal displacement 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
uz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of nodal displacement 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of nodal velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of nodal velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of nodal velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of nodal acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ay
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of nodal acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
az
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of nodal acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of nodal reaction force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ry
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of nodal reaction force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of nodal reaction force 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For analyses using biphasic,
 biphasic-solute,
 and triphasic materials,
 the following additional variables can be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Node variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective fluid pressure 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of solid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of solid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of solid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c[n]
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective concentration of solute n,
 with n from 1 to 8 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For heat transfer problems the following nodal variables are available.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Node variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
T
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nodal temperature 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For fluid analyses,
 the following variables can be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Node variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to store the current nodal positions of all nodes,
 use the following 
\shape italic
node_data 
\shape default
element:
\end_layout

\begin_layout LyX-Code
<node_data data="x;y;z"></node_data>
\end_layout

\begin_layout Standard
You can store the total nodal displacement for nodes 1 through 100,
 and all even numbered nodes 200 through 400 as follows:
\end_layout

\begin_layout LyX-Code
<node_data data="ux;uy;uz">1:100:1,200:400:2</node_data>
\end_layout

\begin_layout Subsubsection
Face_Data Class 
\end_layout

\begin_layout Standard
The 
\emph on
face_data 
\emph default
class defines a set of surface variables.
 This item requires the 
\emph on
surface 
\emph default
attribute,
 which defines the surface that will be used to extract the data from.
 The surface must be defined in the 
\emph on
Mesh
\emph default
 section.
 The data is stored for each surface facet that is listed in the item list,
 or for all facets of the surface if no list is defined.
 
\end_layout

\begin_layout Standard
The following surface variables are defined.
 Note that the actual value is the average over the facet's integration points values (if applicable).
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Element variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact gap
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The gap (separation) of the contact interface this surface belongs to.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The normal contact pressure of the contact interface this surface belongs to.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout Standard
This example stores the contact gap and contact pressure of all the facets of surface 
\begin_inset Quotes eld
\end_inset

FacetOnFacetSliding1_primary
\begin_inset Quotes erd
\end_inset

.
 The surface is defined in the Mesh section.
 
\end_layout

\begin_layout LyX-Code
<logfile>
\end_layout

\begin_layout LyX-Code
  <face_data data="contact gap;contact pressure" surface="FacetOnFacetSliding1_primary"/>
\end_layout

\begin_layout LyX-Code
</logfile> 
\end_layout

\begin_layout Subsubsection
Element_Data Class
\begin_inset CommandInset label
LatexCommand label
name "subsec:Element_Data-Class"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
element_data 
\shape default
class defines a set of element variables.
 The data is stored for each element that is listed in the item list of the 
\shape italic
element_data 
\shape default
element or for all nodes if no list is defined.
 The following element variables are defined.
 Note that the actual value is the average over the element's integration points values (if applicable).
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="98" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Element variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of current element centroid position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of current element centroid position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of current element centroid position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
syz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
s1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of Cauchy stress tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
s2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of Cauchy stress tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
s3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of Cauchy stress tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ex
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ey
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ez
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Eyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the Green-Lagrange strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of Green-Lagrange strain tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of Green-Lagrange strain tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of Green-Lagrange strain tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ex
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ey
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ez
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
eyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the infinitesimal strain 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ux
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the right stretch tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of right stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the left stretch tensor 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of left stretch tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of right Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the rileft Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
h1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
first eigenvalue of left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
h2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
second eigenvalue of left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
h3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
third eigenvalue of left Hencky strain
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fxx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fyy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fzz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fyx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yx-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fzy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zy-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fzx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of the deformation gradient 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
J
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative volume (determinant of deformation gradient) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxxx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxxx component of spatial elasticity tensor (a.k.a.
 c11) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxyy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxyy component of spatial elasticity tensor (a.k.a.
 c12) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyyyy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yyyy component of spatial elasticity tensor (a.k.a.
 c22) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxzz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxzz component of spatial elasticity tensor (a.k.a.
 c13) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyyzz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yyzz component of spatial elasticity tensor (a.k.a.
 c23) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
czzzz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zzzz component of spatial elasticity tensor (a.k.a.
 c33) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxxy component of spatial elasticity tensor (a.k.a.
 c14) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyyxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yyxy component of spatial elasticity tensor (a.k.a.
 c24) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
czzxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zzxy component of spatial elasticity tensor (a.k.a.
 c34) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxyxy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xyxy component of spatial elasticity tensor (a.k.a.
 c44) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxyz component of spatial elasticity tensor (a.k.a.
 c15) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyyyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yyyz component of spatial elasticity tensor (a.k.a.
 c25) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
czzyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zzyz component of spatial elasticity tensor (a.k.a.
 c35) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxyyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xyyz component of spatial elasticity tensor (a.k.a.
 c45) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyzyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yzyz component of spatial elasticity tensor (a.k.a.
 c55) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxxxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xxxz component of spatial elasticity tensor (a.k.a.
 c16) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyyxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yyxz component of spatial elasticity tensor (a.k.a.
 c26) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
czzxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zzxz component of spatial elasticity tensor (a.k.a.
 c36) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxyxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xyxz component of spatial elasticity tensor (a.k.a.
 c46) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cyzyz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yzyz component of spatial elasticity tensor (a.k.a.
 c56) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cxzxz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xzxz component of spatial elasticity tensor (a.k.a.
 c66) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sed
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strain energy density 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
devsed
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
deviatoric strain energy density 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
damage variable (or sum of damage variables in solid mixtures)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For analyses using biphasic,
 biphasic-solute,
 and triphasic materials,
 the following additional variables can be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Element variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
actual fluid pressure 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c
\begin_inset Formula $n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
actual concentration of solute 
\begin_inset Formula $n$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of fluid flux 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of fluid flux 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
wz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of fluid flux 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
j
\begin_inset Formula $n$
\end_inset

x
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of flux of solute 
\begin_inset Formula $n$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
j
\begin_inset Formula $n$
\end_inset

y
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of flux of solute 
\begin_inset Formula $n$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
j
\begin_inset Formula $n$
\end_inset

z
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of flux of solute 
\begin_inset Formula $n$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For fluid analyses,
 the following additional variables can be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="29" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Element variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of element centroid position
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of element centroid position
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z--coordinate of element centroid position
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fp
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid pressure 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fvx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fvy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fvz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of fluid velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fJ
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid volume ratio
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fd
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid density
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid stress power
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of fluid acceleration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fay
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of fluid acceleration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
faz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of fluid acceleration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fwx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of fluid vorticity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fwy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of fluid vorticity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fwz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of fluid vorticity
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsxx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsyy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fszz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fsxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of fluid Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdxx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xx-component of fluid rate of deformation 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdyy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yy-component of fluid rate of deformation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdzz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zz-component of fluid rate of deformation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdxy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xy-component of fluid rate of deformation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdyz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yz-component of fluid rate of deformation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fdxz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xz-component of fluid rate of deformation
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to store the (average) Cauchy stress for all elements,
 define the following data element:
\end_layout

\begin_layout LyX-Code
<element_data data="sx;sy;sz;sxy;syz;sxz" name="element stresses"> </element_data>
\end_layout

\begin_layout Subsubsection
Rigid_Body_Data Class
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid_Body_Data-Class"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
rigid_body_data 
\shape default
class defines a set of variables for each rigid body.
 The data is stored for each rigid body that is listed in the item list of the 
\shape italic
rigid_body_data 
\shape default
element or for all rigid bodies if no list is defined.
 The following variables are defined.
 Note that the item referenced in the item list is the material number of the rigid body.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="33" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Rigid body variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-coordinate of center of mass position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-coordinate of center of mass position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-coordinate of center of mass position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of center of mass velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of center of mass velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of center of mass velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of center of mass acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ay
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of center of mass acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
az
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of center of mass acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
thx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rotation pseudo-vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
thy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rotation pseudo-vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
thz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rotation pseudo-vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
omx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of angular velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
omy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of angular velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
omz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of angular velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
alx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of angular acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
aly
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of angular acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
alz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of angular acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
qx 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rotation quaternion 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
qy 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rotation quaternion 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
qz 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rotation quaternion 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
qw 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
w-component of rotation quaternion 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fx 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of the rigid body reaction force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fy 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of the rigid body reaction force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fz 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of the rigid body reaction force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mx 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of the rigid body reaction torque 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
My 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of the rigid body reaction torque 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mz 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of the rigid body reaction torque 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
KE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kinetic energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
EulerX
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
X-Euler angle
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
EulerY
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Y-Euler angle
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
EulerZ
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Z-Euler angle
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to store the rigid body reaction force of rigid body 2 and 4 add the following data element.
 Note that the 2 and 4 refer to the rigid body material number as defined in the 
\shape italic
Material
\shape default
 section of the input file:
\end_layout

\begin_layout LyX-Code
<rigid_body_data data="Fx;Fy;Fz">2,4</rigid_body_data>
\end_layout

\begin_layout Subsubsection
Rigid_Connector_Data Class
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid_Connector_Data-Class"

\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
rigid_connector_data 
\shape default
class defines a set of variables for each rigid joint or rigid connector.
 The data is stored for each rigid joint or rigid connector that is listed in the item list of the 
\shape italic
rigid_connector_data 
\shape default
element or for all rigid connectors if no list is defined.
 The following variables are defined.
 Note that the item referenced in the item list is the rigid connector number in the order in which rigid connectors appear in the input file.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Rigid body variables
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCFx 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rigid connector force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCFy 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rigid connector force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCFz 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rigid connector force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCMx
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rigid connector moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCMy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rigid connector moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCMz
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rigid connector moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rigid connector translation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rigid connector translation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rigid connector translation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCthx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x-component of rigid connector rotation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCthy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y-component of rigid connector rotation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RCthz
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z-component of rigid connector rotation
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
 to store the reaction forces and moments at rigid joints 2 and 4 add the following data element:
\end_layout

\begin_layout LyX-Code
<rigid_connector_data data="RCFx;RCFy;RCFz;RCMx;RCMy;RCMz">2,4</rigid_connector_data>
\end_layout

\begin_layout Standard
The rigid connector translation and rotation variables return relative motions of the rigid bodies connected by rigid joints and other rigid connectors (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Rigid-Connectors"
nolink "false"

\end_inset

).
 The rotation components represent the components of a vector whose direction is along the axis of rotation,
 and whose magnitude is the (counter-clockwise) angle of rotation.
 These relative motions are calculated as the motion of 
\emph on
body_b
\emph default
 relative to 
\emph on
body_a
\emph default
,
 expressed in the local Cartesian basis of 
\emph on
body_a
\emph default
,
 whose initial origin is at 
\emph on
joint_origin
\emph default
.
 This Cartesian basis (which generally moves with 
\emph on
body_a
\emph default
) has its first axis along 
\emph on
rotation_axis
\emph default
 (for revolute and planar joints) or 
\emph on
translation_axis
\emph default
 (for prismatic joints) or 
\emph on
joint_axis
\emph default
 (for cylindrical joints);
 the second axis is along the 
\emph on
transverse_axis
\emph default
 (for revolute,
 prismatic and cylindrical joints) or 
\emph on
translation_axis_1
\emph default
 (for planar joints).
 For spherical joints,
 springs,
 dampers,
 angular dampers and contractile forces,
 the axes are always aligned with the global Cartesian basis.
\end_layout

\begin_layout Standard
For springs,
 dampers and contractile forces,
 the returned translation components represent the relative position vector between insertion points on 
\emph on
body_b
\emph default
 and 
\emph on
body_a
\emph default
.
 The magnitude of this vector represents the distance between those points.
\end_layout

\begin_layout Subsection
Plotfile
\begin_inset CommandInset label
LatexCommand label
name "subsec:Plotfile"

\end_inset


\end_layout

\begin_layout Standard
By default,
 all the results are stored in a binary database,
 referred to as the 
\shape italic
plotfile
\shape default
.
 The preferred storage format is the FEBio binary database format (referred to as the 
\shape italic
xplt 
\shape default
format)
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 As of FEBio version 2.0,
 the LSDYNA database is no longer supported.
 The FEBio database format is the only format that will be supported from now on.
\end_layout

\end_inset

.
 This section describes how to customize the data that is stored to the plotfile.
\end_layout

\begin_layout Standard
To define the contents of the plotfile the 
\shape italic
plotfile 
\shape default
element needs to be added in the 
\emph on
Output 
\emph default
section of the FEBio input file.
\end_layout

\begin_layout LyX-Code
<plotfile [type="febio"] [file="name.xplt"]/>
\end_layout

\begin_layout Standard
The 
\emph on
type 
\emph default
attribute defines the output format.
 As of version 4.4,
 the user can choose between 
\begin_inset Quotes eld
\end_inset

febio
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

vtk
\begin_inset Quotes erd
\end_inset

.
 When choosing 
\begin_inset Quotes eld
\end_inset

febio
\begin_inset Quotes erd
\end_inset

,
 which is the default,
 the results will be stored in the standard binary 
\emph on
xplt 
\emph default
format.
 When choosing 
\begin_inset Quotes eld
\end_inset

vtk
\begin_inset Quotes erd
\end_inset

,
 the output is stored as individual VTK (legacy format) files,
 one for each completed time step.
 Note that due to limitations of the vtk format,
 not all plot variables can be exported to VTK file.
 
\end_layout

\begin_layout Standard
The 
\shape italic
file
\shape default
 attribute is also optional and allows the user to define the file name of the plotfile.
 If this attribute is omitted,
 FEBio will use a default file name for the plotfile.
\end_layout

\begin_layout Standard
By default,
 FEBio will store the most common data variables to the plot file.
 However,
 it is advised to always specify the specific contents of the plotfile.
 This can be done by adding 
\shape italic
var 
\shape default
elements in the 
\shape italic
plotfile 
\shape default
section as described in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Plotfile-Variables"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Plotfile Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:Plotfile-Variables"

\end_inset


\end_layout

\begin_layout Standard
Plotfile variables are defined using the 
\shape italic
var 
\shape default
keyword.
 This tag takes one attribute,
 namely the 
\shape italic
type
\shape default
 of the variable.
 The 
\emph on
type
\emph default
 defines the specific output variable that will be stored to the plot file.
 
\end_layout

\begin_layout LyX-Code
<var type="
\emph on
name
\emph default
"/>
\end_layout

\begin_layout Standard
where 
\shape italic
name 
\shape default
is the name of the output variable.
 (For a complete list of supported output variables,
 please see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:List-of-Plotfile"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\begin_layout Standard
As of FEBio 2.4,
 additional information can be added in the type attribute of the variable definition.
 The general format is as follows.
\end_layout

\begin_layout LyX-Code
<var type="
\emph on
name
\emph default
[
\emph on
filter
\emph default
]=
\emph on
alias
\emph default
"/>
\end_layout

\begin_layout Standard
The filter is defined by appending the name of the plot variable with the filter inside square brackets.
 The filter can be either an integer,
 or a string.
 If the filter is a string,
 it must be surrounded by single quotes.
\end_layout

\begin_layout LyX-Code
<var type="
\emph on
name
\emph default
['
\emph on
filter
\emph default
 string']=
\emph on
alias
\emph default
"/>
\end_layout

\begin_layout Standard
The optional alias can be used to rename the variable.
 The alias will be used as the name of the plot variable in the plot file,
 and this is the name that will show up in post-processing software such as FEBio Studio.
 
\end_layout

\begin_layout Standard
Some plot variables use filters to resolve possible ambiguities.
 For example,
\end_layout

\begin_layout LyX-Code
<var type="solute concentration['solute1']"/>
\end_layout

\begin_layout Standard
This example will store the solute concentration of a solute named 'solute1' to the plot file.
\end_layout

\begin_layout Standard
In addition,
 an alias can be used to define a more descriptive name of the plot variable.
\end_layout

\begin_layout LyX-Code
<var type="solute concentration['Na']=Na concentration"/>
\end_layout

\begin_layout Standard
This variable will store the solute concentration of a solute named 'Na' to the plot file using the name 'Na concentration'.
\end_layout

\begin_layout Standard
The following example shows how to export a particular fiber vector from a solid mixture.
 Since solid mixtures can have several fiber distributions associated,
 it is necessary to specify which component of the mixture the plot variable refers to.
 
\end_layout

\begin_layout LyX-Code
<var type="fiber vector['solid[0]']=v1"/>
\end_layout

\begin_layout LyX-Code
<var type="fiber vector['solid[1]']=v2"/>
\end_layout

\begin_layout Standard
Some plot variables require the specification of a named surface (* in table below).
 For example,
\end_layout

\begin_layout LyX-Code
<var type="fluid surface force" surface="airfoil"/>
\end_layout

\begin_layout Standard
The named surface should be described in a 
\emph on
Surface
\emph default
 element (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Surface-Section"
nolink "false"

\end_inset

) within 
\emph on
Mesh
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Geometry-Section"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
The following example shows a complete definition of the plotfile section and stores nodal displacements and element stresses.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<plotfile type="febio">
\end_layout

\begin_layout LyX-Code
  <var type="displacement"/>
\end_layout

\begin_layout LyX-Code
  <var type="stress"/>
\end_layout

\begin_layout LyX-Code
</plotfile>
\end_layout

\begin_layout Subsubsection
List of Plotfile Variables
\begin_inset CommandInset label
LatexCommand label
name "subsec:List-of-Plotfile"

\end_inset


\end_layout

\begin_layout Standard
There are four categories of plot file variables:
\end_layout

\begin_layout Itemize

\series bold
Nodal:

\series default
 These typically correspond to data that is directly available at nodes.
 For instance,
 the primary solution variables are usually stored as nodal variables.
 (E.g.
 
\begin_inset Quotes eld
\end_inset

displacement
\begin_inset Quotes erd
\end_inset

) 
\end_layout

\begin_layout Itemize

\series bold
Element:

\series default
 These quantities correspond to data that is typically stored on the elements (e.g.
 stress).
 In FEBio,
 element data is usually stored at the integration points during the solution phase.
 Since this is often not a convenient format for post-processing,
 element data is processed before export and will be written to the plot file as either a constant,
 element-averaged value,
 or projected to the nodes of the element.
 
\end_layout

\begin_layout Itemize

\series bold
Surface:

\series default
 These quantities correspond to data that is only available at the surface of the mesh (e.g.
 contact traction).
 If the surface data is defined at the nodes of the surface,
 it will be written directly to the plot file.
 However,
 if the data is associated with the surface facets - or more accurately,
 with the integration points of the surface facet - then it will be processed before export,
 and a constant,
 facet-averaged value,
 will be written to the plot file.
 
\end_layout

\begin_layout Itemize

\series bold
Rigid body:

\series default
 These are quantities that correspond to data stored on rigid bodies.
 
\end_layout

\begin_layout Standard
The following table lists the possible values for the 
\emph on
type
\emph default
 attribute of the plot file variable tag.
 
\end_layout

\begin_layout Standard
An asterisk (*) in the Category column denotes that the attribute is required and must be included in the definition of the plot variable.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="139" columns="3">
<features islongtable="true" longtabularalignment="center">
<column alignment="left" valignment="top" width="2in">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top" width="3in">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Category
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Acceleration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element accelerations 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact area
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Net contact area across contact interface.
 Evaluated by integrating the surface area at integration points where the contact pressure is not zero.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Net contact force across contact interface.
 Evaluated by integrating the contact traction over the contact surface.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact gap
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact gap distance,
 evaluated at contact surface faces 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact penalty
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact penalty value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact pressure,
 evaluated at contact surface faces
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact stick
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stick status in stick-slip frictional contact (1=stick,
 0=slip).
 Values between 0 and 1 imply that a fraction of that face is in stick mode.
 Currently works only with sliding-tension-compression.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contact traction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact traction vectors,
 evaluated at contact surface faces 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Electric current density,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-electric-current-density"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current element angular momentum
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The element's total angular momentum at the current configuration.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current element center of mass
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The element's center of mass at the current configuration.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current element kinetic energy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The element's total kinetic energy at the current configuration.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current element linear momentum
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The element's total linear momentum at the current configuration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current element strain energy
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The element's total strain energy at the current configuration.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
damage
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Damage variable 
\begin_inset Formula $D$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
nolink "false"

\end_inset

) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The current density 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
deviatoric strain energy density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Deviatoric strain energy density 
\begin_inset Formula $\tilde{\Psi}\left(\mathbf{\tilde{C}}\right)$
\end_inset

,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq1"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
displacement
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nodal displacements 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective elasticity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The elasticity of the elastic material in a biphasic/triphasic/multiphasic material.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective fluid pressure 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid pressure for biphasic,
 biphasic-solute,
 triphasic,
 and multiphasic materials.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective shell fluid pressure 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid pressure for biphasic,
 biphasic-solute,
 triphasic,
 and multiphasic materials of shell domains.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective shell solute concentration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Effective solute concentration for biphasic-solute,
 triphasic,
 and multiphasic materials of shell domains.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective solute concentration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Effective solute concentration for biphasic-solute,
 triphasic,
 and multiphasic materials.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective fluid pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid pressure 
\begin_inset Formula $p$
\end_inset

 for biphasic materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bp-stress"
nolink "false"

\end_inset

,
 or 
\begin_inset Formula $\tilde{p}$
\end_inset

 for biphasic-solute,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-effective-p-c"
nolink "false"

\end_inset

 and triphasic/multiphasic materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective friction coefficient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Effective friction coefficient at a biphasic contact interface
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective solute concentration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

 for biphasic-solute materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-effective-p-c"
nolink "false"

\end_inset

,
 and triphasic/multiphasic materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elasticity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spatial elasticity tensor components 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
electric potential
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Electric potential 
\begin_inset Formula $\psi$
\end_inset

 in triphasic/multiphasic materials,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element angular momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element total angular momentum 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element center of mass 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element center of mass 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element kinetic energy 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element total kinetic energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element linear momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element total linear momentum 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element strain energy 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element total strain energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element stress power 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element total stress power 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
enclosed volume
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Volume enclosed by named surface
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
enclosed volume change
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Change in volume enclosed by named surface
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Euler angle 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body Euler angles 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber stretch 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element's average fiber stretch 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Material fiber vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
field
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output the nodal values of a field variable.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fixed charge density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fixed charge density 
\begin_inset Formula $c^{F}$
\end_inset

 in current configuration,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-CFD-mass-balance"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid acceleration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid acceleration (material time derivative of fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid density
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid density 
\begin_inset Formula $\rho^{f}$
\end_inset

 in fluid and fluid-FSI materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cfd-density"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid dilatation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid dilatation 
\begin_inset Formula $e$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid element angular momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total angular momentum of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid element center of mass 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Center of mass of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid element kinetic energy 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total kinetic energy of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid element linear momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total linear momentum of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid element strain energy 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total strain energy of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid energy density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average energy density of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid flow rate 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface* 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Volumetric fluid flow rate 
\begin_inset Formula $Q=\int_{A}\mathbf{w}\cdot\mathbf{n}\,dA$
\end_inset

 across a named surface (biphasic and multiphasic analyses)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid flux
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid flux 
\begin_inset Formula $\mathbf{w}$
\end_inset

 in biphasic,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bp-flux"
nolink "false"

\end_inset

,
 biphasic-solute,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-fluxes-w-j"
nolink "false"

\end_inset

,
 triphasic/multiphasic,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-fluxes-w-j"
nolink "false"

\end_inset

,
 fluid-FSI and biphasic-FSI materials.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid force
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Net fluid force across biphasic (sliding-biphasic),
 biphasic-solute (sliding-biphasic-solute) and multiphasic (sliding-multiphasic) contact interface.
 Evaluated by integrating the fluid pressure 
\begin_inset Formula $p$
\end_inset

 over the contact surface.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid force2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Alternative calculation of the net fluid force 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid heat supply density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average heat supply density of a fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid kinetic energy density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average kinetic energy densify of a fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid load support 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The total fluid load support across a named surface 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid mass flow rate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mass flow rate across a named surface,
 
\begin_inset Formula $\dot{m}=\int_{A}\rho\mathbf{v}\cdot\mathbf{n}\,dA$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid pressure 
\begin_inset Formula $p$
\end_inset

 in biphasic,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bp-stress"
nolink "false"

\end_inset

,
 biphasic-solute,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-effective-p-c"
nolink "false"

\end_inset

,
 triphasic/multiphasic materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
nolink "false"

\end_inset

,
 and fluid materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid rate of deformation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid rate of deformation tensor 
\begin_inset Formula $\mathbf{D}$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid shear viscosity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average shear viscosity of a fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid strain energy density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average shear energy density of fluid element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid stress
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid stress 
\begin_inset Formula $\boldsymbol{\sigma}$
\end_inset

,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cfd-stress"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid stress power density
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid stress power 
\begin_inset Formula $\boldsymbol{\sigma}:\mathbf{D}$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid surface energy flux 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The total energy flux across a named surface for a fluid analysis 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid surface force
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Net force exerted by a fluid on a named surface,
 
\begin_inset Formula $\mathbf{f}=-\int_{A}\mathbf{t}\,dA$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid surface pressure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average fluid pressure on each face of a surface,
 evaluated from the nodal values of the fluid dilatation on that face
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid surface traction power 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Net traction power across a named surface of a fluid analysis 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 in fluid and fluid-FSI materials,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid volume ratio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid volume ratio 
\begin_inset Formula $J$
\end_inset

,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid vorticity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid vorticity,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Fluids"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
heat flux 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The average heat flux inside an element of a heat-transfer analysis 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
kinetic energy density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The average kinetic energy density in an element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lagrange strain 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The average Lagrange strain in an element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
left Hencky
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Left Hencky strain 
\begin_inset Formula $\mathbf{h}=\frac{1}{2}\ln\mathbf{b}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
left stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Left stretch tensor 
\begin_inset Formula $\mathbf{V}=\mathbf{b}^{1/2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
local fluid load support
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Local fluid load support on biphasic contact surfaces
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nested damage 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The average damage in an elastic mixture 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal acceleration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The acceleration at the nodes 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal contact gap
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact gap distance,
 evaluated at contact surface nodes 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal contact pressure
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact pressure,
 evaluated at contact surface nodes 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal contact traction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact traction vectors,
 evaluated at contact surface nodes 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal fluid flux 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid flux in biphasic,
 biphasic-solute,
 triphasic,
 multiphasic,
 fluid-FSI and biphasic-FSI materials
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal fluid velocity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 in fluid and fluid-FSI materials
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal stress 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The Cauchy stress,
 projected to the nodes.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal surface traction 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact nodal tractions 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal vector gap 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Contact gap vector at surface nodes 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal velocity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The nodal velocities 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
osmolarity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element's average osmolarity in biphasic/triphasic/multiphasic analysis 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stores heterogeneous material parameter data 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure gap 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pressure gap between opposing surfaces in a biphasic contact analysis 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reaction forces 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The nodal reaction forces.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
receptor-ligand concentration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Receptor-ligand concentration in a biphasic-solute analysis.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
referential fixed charge density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Referential fixed charge density 
\begin_inset Formula $c_{r}^{F}$
\end_inset

,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-CFD-mass-balance"
nolink "false"

\end_inset

,
 which may evolve with chemical reactions,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-referential-FCD"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

,
 which may evolve with chemical reactions,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-referential-solid-vol-frac"
nolink "false"

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative fluid velocity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element fluid velocity relative to mesh 
\begin_inset Formula $\mathbf{w}$
\end_inset

 in fluid and fluid-FSI materials
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative volume
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Relative volume 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
right Hencky
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Right Hencky strain 
\begin_inset Formula $\mathbf{H}=\frac{1}{2}\ln\mathbf{C}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
right stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Right stretch tensor 
\begin_inset Formula $\mathbf{U}=\mathbf{C}^{1/2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid acceleration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body center of mass acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid angular acceleration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body angular acceleration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid angular momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body angular momentum 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid angular position
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body rotation pseudo-vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid angular velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body angular velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid force 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total force applied to the rigid body 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid kinetic energy
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body kinetic energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid linear momentum 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body linear momentum 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid position
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body center of mass position 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid rotation vector 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body rotation pseudo-vector 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid torque
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body moment 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rigid body center of mass velocity 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RVE generations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of generations in reactive viscoelastic material
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RVE reforming bonds
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fraction of weak bonds available to break and reform in reactive viscoelastic material
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RVE strain
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Strain measure used in strain-dependent reactive viscoelastic relaxation and weak bond recruitment
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sbm concentration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element solid-bound molecule concentration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sbm referential apparent density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element solid-bound molecule referential apparent density 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell director 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The shell director 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell relative volume 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Relative volume of shell element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell strain 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average strain in shell element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shell thickness
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shell thickness 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solute concentration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solute concentration 
\begin_inset Formula $c$
\end_inset

 in biphasic-solute materials,
 or 
\begin_inset Formula $c^{\alpha}$
\end_inset

 in triphasic/multiphasic materials 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solute flux
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solute flux 
\begin_inset Formula $\mathbf{j}$
\end_inset

 in biphasic-solute materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bs-fluxes-w-j"
nolink "false"

\end_inset

,
 or 
\begin_inset Formula $\mathbf{j}^{\alpha}$
\end_inset

 in triphasic/multiphasic materials,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-fluxes-w-j"
nolink "false"

\end_inset

.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specific strain energy 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element specific strain energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SPR principal stress 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Principal stress values obtained via SPR projection 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SPR stress 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cauchy stress obtained via SPR projection 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SPR-P1 stress 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cauchy stress obtained via SPR projection (first-order projection) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strain energy density
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Strain energy density 
\begin_inset Formula $\Psi\left(\mathbf{C}\right)$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cauchy stress 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
surface traction 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nodal surface tractions of nodes on a contact surface 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
uncoupled pressure 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The pressure of an uncoupled material 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ut4 nodal stress 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stresses at the nodes of the UT4 element 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector gap 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The vector gap at nodes of a contact surface 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
velocity
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Node
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nodal velocities (fluid nodal velocities in fluid analyses)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
volume fraction 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Average element volume fraction of a solid mixture 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in-situ target stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the fiber stretch induced by the initial prestrain gradient
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
prestrain stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the stretch induced by the effective prestrain gradient
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
prestrain correction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the 3x3 prestrain correction tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SPR prestrain correction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The 3x3 prestrain correction tensor (recovered with SPR)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Materials
\begin_inset CommandInset label
LatexCommand label
name "chap:Materials"

\end_inset


\end_layout

\begin_layout Standard
The following sections describe the material parameters for each of the available constitutive models,
 along with a short description of each material.
 A more detailed theoretical description of the constitutive models can be found in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Elastic Solids
\begin_inset CommandInset label
LatexCommand label
name "sec:Elastic-Solids"

\end_inset


\end_layout

\begin_layout Standard
This section describes the elastic materials,
 which are materials defined by a hyperelastic strain-energy function.
 A distinction will be made between so-called 
\shape italic
unconstrained 
\shape default
and 
\shape italic
uncoupled 
\shape default
materials.
 The former describe materials that can undergo volumetric compression.
 The latter are used for modeling (nearly-) incompressible materials,
 thus their constitutive models are constrained to produce an isochoric deformation,
 as long as the user has selected a sufficiently large bulk modulus to enforce that constraint.
\end_layout

\begin_layout Subsection
Specifying Fiber Orientation or Material Axes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Specifying-Fiber-Orientation"

\end_inset


\end_layout

\begin_layout Standard
Some of the materials are transversely isotropic,
 requiring the specification of an initial material direction,
 which is called a 
\shape italic
fiber
\shape default
 direction in FEBio.
 Other materials are orthotropic,
 requiring the specification of initial material axes that define the three planes of symmetry for those materials.
 Only one of these specifications should be provided.
 By default,
 material axes are aligned with the global Cartesian basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 and the fiber direction is along 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

.
 Local fiber or material axes orientation may be specified in several ways.
 FEBio gives the option to automatically generate the orientation,
 based on some user-specified parameters.
 However,
 the user can override this feature and specify the fiber or axes directions for each element manually in the 
\shape italic
ElementData
\shape default
 section.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:MeshData-Section"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details on how to do this.
\end_layout

\begin_layout Subsubsection
Transversely Isotropic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Materials"

\end_inset


\end_layout

\begin_layout Standard
For transversely isotropic materials fiber orientation is specified with the 
\shape italic
fiber 
\shape default
element.
 This element takes one attribute,
 namely 
\shape italic
type
\shape default
,
 which specifies the type of the fiber generator.
 The possible values are specified in the following table.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
type
\shape default
 Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
local
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use local element numbering (1) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Define the fiber orientation as a constant vector (2) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
spherical
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specifies a spherical fiber distribution (3) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cylindrical
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specifies a cylindrical fiber distribution (4) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
angles
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specifies the fiber direction using spherical angles (5) 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
If the 
\shape italic
type 
\shape default
attribute is omitted,
 the fiber distribution will follow the local element nodes 1 and 2.
 This would be the same as setting the fiber attribute to 
\shape italic
local 
\shape default
and setting the value to 
\begin_inset Quotes eld
\end_inset

1,2
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Comments
\shape default
:
\end_layout

\begin_layout Enumerate
In this case,
 the fiber direction is determined by local element node numbering.
 The value is interpreted as the local node numbers of the nodes that define the direction of the fiber.
 The following example defines a local fiber axis by local element nodes 1 and 2.
 This option is very useful when the local fiber direction can be interpreted as following one of the mesh edges.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<fiber type="local">1,2</fiber>
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigLocalFiberDirectionOption.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
\emph on
local
\emph default
 fiber direction option
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The fiber orientation is specified by a vector.
 The value is the direction of the fiber.
 The following defines all element fiber directions in the direction of the vector [1,0,0]:
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigVectorFiberDirectionOption.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
\emph on
vector
\emph default
 fiber direction option
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The fiber orientation is determined by a point in space and the global location of each element integration point.
 The value is the location of the point.
 The following example defines a spherical fiber distribution centered at [0,0,1]:
\end_layout

\begin_deeper
\begin_layout LyX-Code
<fiber type="spherical">0,0,1</fiber>
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigSphericalFiberDirectionOption.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
\emph on
spherical
\emph default
 fiber direction option
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\shape italic
cylindrical
\shape default
:
 This type generates a fiber distribution that is cylindrical.
 The following subparameters must be defined.
 
\end_layout

\begin_deeper
\begin_layout Description

\shape italic
\emph on
center
\emph default
 
\shape default
defines the center of the cylinder 
\end_layout

\begin_layout Description

\shape italic
\emph on
axis
\shape default
\emph default
 defines the axis of the cylinder 
\end_layout

\begin_layout Description

\shape italic
\emph on
vector
\shape default
\emph default
 defines a vector that will be transported around the cylinder 
\end_layout

\begin_layout LyX-Code
<fiber type="cylindrical">
\end_layout

\begin_layout LyX-Code
  <center>0,0,0</center>
\end_layout

\begin_layout LyX-Code
  <axis>0,0,1</axis>
\end_layout

\begin_layout LyX-Code
  <vector>0,1,0</vector>
\end_layout

\begin_layout LyX-Code
</fiber>
\end_layout

\end_deeper
\begin_layout Enumerate

\shape italic
angles
\shape default
:
 This type generates a fiber orientation via the specification of spherical angles (azimuth and declination) relative to the local material axes (or global coordinate system,
 if no local material axes are defined).
 The following subparameters must be defined.
\end_layout

\begin_deeper
\begin_layout Description

\shape italic
\emph on
theta
\emph default
 
\shape default
azimuth angle (in degrees) 
\end_layout

\begin_layout Description

\shape italic
\emph on
phi
\shape default
\emph default
 declination angle (in degrees) 
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigSCS.png

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\series bold
Spherical angles
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The fiber is oriented along 
\begin_inset Formula 
\[
\mathbf{e}_{r}=\cos\theta\sin\phi\,\mathbf{e}_{1}+\sin\theta\sin\phi\,\mathbf{e}_{2}+\cos\phi\,\mathbf{e}_{3},0\leqslant\theta<2\pi,\;0\leqslant\phi\leqslant\pi,
\]

\end_inset

where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal vectors representing the local element coordinate system (when specified,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

),
 or global coordinate system.
\end_layout

\begin_layout LyX-Code
<fiber type="angles">
\end_layout

\begin_layout LyX-Code
  <theta>20</center>
\end_layout

\begin_layout LyX-Code
  <phi>90</phi>
\end_layout

\begin_layout LyX-Code
</fiber>
\end_layout

\begin_layout Standard
When specifying a fiber direction 
\begin_inset Formula $\mathbf{a}$
\end_inset

,
 FEBio generates a set of orthogonal material axes as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

.
 generated with 
\begin_inset Formula $\mathbf{d}=\boldsymbol{j}$
\end_inset

,
 or else 
\begin_inset Formula $\mathbf{d}=\boldsymbol{k}$
\end_inset

 if 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is collinear with 
\begin_inset Formula $\boldsymbol{j}$
\end_inset

 (where the triple 
\series bold

\begin_inset Formula $\boldsymbol{i,j,k}$
\end_inset


\series default
 refers to unit vectors defining the global coordinate system,
 i.e.
 
\begin_inset Formula $\boldsymbol{i}=\left(1,0,0\right)$
\end_inset

,
 etc.).
 Because of the non-uniqueness of these material axes (only 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

 is along a uniquely defined direction in a 
\shape italic
fiber
\shape default
 element),
 caution should be used when material axes are compounded,
 as may occur in nested materials such as solid mixtures described in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

 & 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 To enforce uniqueness,
 use the 
\shape italic
mat_axis
\shape default
 element instead of the 
\shape italic
fiber
\shape default
 element.
\end_layout

\end_deeper
\begin_layout Subsubsection
Orthotropic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthotropic-Materials"

\end_inset


\end_layout

\begin_layout Standard
For orthotropic materials,
 the user needs to specify two fiber directions 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 and 
\begin_inset Formula $\mathbf{d}$
\end_inset

.
 From these FEBio will generate an orthonormal set of material axes vectors as follows:
 
\begin_inset Formula 
\[
\mathbf{e}_{1}=\frac{\mathbf{a}}{\left\Vert \mathbf{a}\right\Vert },\quad\mathbf{e}_{2}=\mathbf{e}_{3}\times\mathbf{e}_{1},\quad\mathbf{e}_{3}=\frac{\mathbf{a}\times\mathbf{d}}{\left\Vert \mathbf{a}\times\mathbf{d}\right\Vert }\,.
\]

\end_inset

The vectors 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset

 
\series default
and 
\series bold

\begin_inset Formula $\mathbf{d}$
\end_inset

 
\series default
are defined using the 
\shape italic
mat_axis 
\shape default
element.
 This element takes a 
\shape italic
type
\shape default
 attribute,
 which can take on the following values:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="none" valignment="top" width="68pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
local
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use local element numbering (1) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
vector
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the vectors 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 and 
\series bold

\begin_inset Formula $\mathbf{d}$
\end_inset


\series default
 directly.
 (2) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
angles
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify the angles 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 [deg].
 (3)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments
\shape default
:
\end_layout

\begin_layout Enumerate
When specifying 
\shape italic
local 
\shape default
as the material axis type,
 the value is interpreted as a list of three local element node numbers.
 When specifying zero for all three,
 the default (1,2,4) is used.
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<mat_axis type="local">0,0,0</mat_axis>
\end_layout

\end_deeper
\begin_layout Enumerate
When using the 
\shape italic
vector 
\shape default
type,
 you need to define the two generator vectors 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $d$
\end_inset

.
 These are specified as child elements of the 
\shape italic
mat_axis 
\shape default
element:
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
  <a>1,0,0</a>
\end_layout

\begin_layout LyX-Code
  <d>0,1,0</d>
\end_layout

\begin_layout LyX-Code
</mat_axis>
\end_layout

\end_deeper
\begin_layout Enumerate
When using the 
\shape italic
angle 
\shape default
type,
 you need to define the two angles 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 in degrees.
 These are specified as child elements of the 
\shape italic
mat_axis 
\shape default
element:
 
\end_layout

\begin_deeper
\begin_layout LyX-Code
<mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
  <theta>0</theta>
\end_layout

\begin_layout LyX-Code
  <phi>90</phi>
\end_layout

\begin_layout LyX-Code
</mat_axis>
\end_layout

\begin_layout Standard
The material axes 
\begin_inset Formula $\left\{ \mathbf{e}_{r},\mathbf{e}_{\theta},\mathbf{e}_{\varphi}\right\} $
\end_inset

 are related to the global Cartesian basis (or local element axes) 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 via
\begin_inset Formula 
\[
\begin{aligned}\mathbf{e}_{r} & =\cos\theta\sin\phi\,\mathbf{e}_{1}+\sin\theta\sin\phi\,\mathbf{e}_{2}+\cos\phi\,\mathbf{e}_{3}\\
\mathbf{e}_{\theta} & =-\sin\theta\,\mathbf{e}_{1}+\cos\theta\,\mathbf{e}_{2}\\
\mathbf{e}_{\varphi} & =-\cos\theta\cos\phi\,\mathbf{e}_{1}-\sin\theta\cos\phi\,\mathbf{e}_{2}+\sin\phi\,\mathbf{e}_{3}
\end{aligned}
\,.
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Uncoupled Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Materials"

\end_inset


\end_layout

\begin_layout Standard
Uncoupled,
 nearly-incompressible hyperelastic materials are described by a strain energy function that features an additive decomposition of the hyperelastic strain energy into deviatoric and dilational parts 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\begin{equation}
\Psi\left(\mathbf{C}\right)=\tilde{\Psi}\left(\tilde{\mathbf{C}}\right)+U\left(J\right),\label{eq1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\tilde{C}}=\mathbf{\tilde{F}}\cdot\mathbf{\tilde{F}}^{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}$
\end_inset

 is the deviatoric part of the deformation gradient.
 The resulting 2
\begin_inset Formula $^{\mathrm{nd}}$
\end_inset

 Piola-Kirchhoff stress is given by 
\begin_inset Formula 
\begin{equation}
\mathbf{S}=J^{-2/3}\Dev\left[\mathbf{\tilde{S}}\right]+pJ\mathbf{C}^{-1},\label{eq2}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{S}}=2\frac{\partial\tilde{\Psi}}{\partial\mathbf{\tilde{C}}}\quad,\label{eq3}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
p:=\frac{dU}{dJ},\label{eq4}
\end{equation}

\end_inset

and 
\begin_inset Formula $\Dev\left[\cdot\right]$
\end_inset

 is the deviatoric operator in the material frame.
\end_layout

\begin_layout Standard
The corresponding Cauchy stress is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\dev\left[\tilde{\boldsymbol{\sigma}}\right]+p\mathbf{I},\label{eq5}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}=J^{-1}\mathbf{\tilde{F}}\cdot\mathbf{\tilde{S}}\cdot\mathbf{\tilde{F}}^{T}$
\end_inset

 and 
\begin_inset Formula $\dev\left[\cdot\right]$
\end_inset

 is the deviatoric operator in the spatial frame.
\end_layout

\begin_layout Standard
For these materials,
 the entire bulk (volumetric) behavior is determined by the function 
\begin_inset Formula $U\left(J\right)$
\end_inset

,
 and 
\begin_inset Formula $p$
\end_inset

 represents the entire hydrostatic stress.
 The function 
\begin_inset Formula $U\left(J\right)$
\end_inset

 is constructed to have a value of 0 for 
\begin_inset Formula $J=$
\end_inset

1 and to have a positive value for all other values of 
\begin_inset Formula $J>$
\end_inset

0.
\end_layout

\begin_layout Standard
All of these materials make use of the three-field element described by Simo and Taylor 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
 This element uses a trilinear interpolation of the displacement field and piecewise-constant interpolations for the pressure and volume ratio.
\end_layout

\begin_layout Standard
The uncoupled materials and the associated three-field element are very effective for representing nearly incompressible material behavior.
 Fully incompressible behavior can be obtained using an augmented Lagrangian method.
 To use the augmented Lagrangian method for enforcement of the incompressibility constraint to a user-defined tolerance,
 the user must define two additional material parameters:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<laugon>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Turn augmented Lagrangian on for this material or off (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (off) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<atol>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Augmentation tolerance (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments
\shape default
:
\end_layout

\begin_layout Enumerate
A value of 
\shape italic
1 
\shape default
(one) turns augmentation on,
 where a value of 0 (zero) turns it off.
 
\end_layout

\begin_layout Enumerate
The augmentation tolerance determines the convergence condition that is used for the augmented Lagrangian method:
 convergence is reached when the relative ratio of the lagrange multiplier norm of the previous augmentation 
\begin_inset Formula $\left\Vert \lambda_{k}\right\Vert $
\end_inset

 to the current one 
\begin_inset Formula $\left\Vert \lambda_{k+1}\right\Vert $
\end_inset

 is less than the specified value:
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left|\frac{\left\Vert \lambda_{k+1}\right\Vert -\left\Vert \lambda_{k}\right\Vert }{\left\Vert \lambda_{k+1}\right\Vert }\right|<\varepsilon.
\]

\end_inset

Thus,
 a value of 0.01 implies that the change in norm between the previous augmentation loop and the current loop is less than 1%.
\end_layout

\begin_layout Standard
The augmented Lagrangian method for incompressibility enforcement is available for all materials that are based on an uncoupled hyperelastic strain energy function.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>5</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.4</c2>
\end_layout

\begin_layout LyX-Code
  <k>10000</k>
\end_layout

\begin_layout LyX-Code
  <laugon>1</laugon> 
\begin_inset Formula $\leftarrow$
\end_inset

 turns on augmented Lagrangian iterations
\end_layout

\begin_layout LyX-Code
  <atol>0.05</atol> 
\begin_inset Formula $\leftarrow$
\end_inset

 sets the augmentation tolerance
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Arruda-Boyce
\begin_inset CommandInset label
LatexCommand label
name "subsec:Arruda-Boyce"

\end_inset


\end_layout

\begin_layout Standard
This material describes an incompressible Arruda-Boyce model 
\begin_inset CommandInset citation
LatexCommand citep
key "Arruda93"
literal "true"

\end_inset

.
 The following material parameters are required:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
initial modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<N>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
number of links in chain
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The uncoupled strain energy function for the Arruda-Boyce material is given by:
 
\begin_inset Formula 
\[
\Psi=\mu\sum\limits_{i=1}^{5}\frac{C_{i}}{N^{i-1}}\left(\tilde{I}_{1}^{i}-3^{i}\right)+U\left(J\right),
\]

\end_inset

where,
 
\begin_inset Formula $C_{1}=\frac{1}{2},C_{2}=\frac{1}{20},C_{3}=\frac{11}{1050},C_{4}=\frac{19}{7000},C_{5}=\frac{519}{673750}$
\end_inset

 and 
\begin_inset Formula $I_{1}$
\end_inset

the first invariant of the right Cauchy-Green tensor.
 The volumetric strain function 
\begin_inset Formula $U$
\end_inset

 is defined as follows,
 
\begin_inset Formula 
\[
U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}\,.
\]

\end_inset

This material model was proposed by Arruda and Boyce 
\begin_inset CommandInset citation
LatexCommand citep
key "Arruda93"
literal "true"

\end_inset

 and is based on an eight-chain representation of the macromolecular network structure of polymer chains.
 The strain energy form represents a truncated Taylor series of the inverse Langevin function,
 which arises in the statistical treatment of non-Gaussian chains.
 The parameter 
\begin_inset Formula $N$
\end_inset

 is related to the locking stretch 
\begin_inset Formula $\lambda_{L}$
\end_inset

,
 the stretch at which the chains reach their full extended state,
 by 
\begin_inset Formula $\lambda_{L}=\sqrt{N}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="Arruda-Boyce">
\end_layout

\begin_layout LyX-Code
  <mu>0.09</mu>
\end_layout

\begin_layout LyX-Code
  <N>26.5</N>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution Uncoupled
\begin_inset CommandInset label
LatexCommand label
name "subsec:EFD-Uncoupled"

\end_inset


\end_layout

\begin_layout Standard
The material type for an ellipsoidal continuous fiber distribution in an uncoupled formulation is 
\begin_inset Quotes eld
\end_inset


\shape italic
EFD uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable uncoupled material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\beta_{1},\beta_{2},\beta_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\xi_{1},\xi_{2},\xi_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 for this material is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Lanir83,Ateshian07a,Ateshian09a"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\tilde{\boldsymbol{\sigma}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\sigma}_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta.
\]

\end_inset


\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\tilde{\lambda}_{n}$
\end_inset

,
 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction (in the reference configuration),
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

,
 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}$
\end_inset

,
 and 
\begin_inset Formula $H\left(.\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber stress is determined from a fiber strain energy function in the usual manner,
 
\begin_inset Formula 
\[
\tilde{\sigma}_{n}=\frac{2\tilde{I}_{n}}{J}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,
\]

\end_inset

where in this material,
 
\begin_inset Formula 
\[
\tilde{\Psi}\left(\mathbf{n},\tilde{I}_{n}\right)=\xi\left(\mathbf{n}\right)\left(\tilde{I}_{n}-1\right)^{\beta\left(\mathbf{n}\right)}\,.
\]

\end_inset

The materials parameters 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\xi$
\end_inset

 are determined from:
 
\begin_inset Formula 
\[
\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}
\end{aligned}
\,.
\]

\end_inset

The orientation of the material axis can be defined as explained in detail in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="EFD uncoupled">
\end_layout

\begin_layout LyX-Code
    <ksi>10,
 12,
 15</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution Mooney-Rivlin
\begin_inset CommandInset label
LatexCommand label
name "subsec:EFD-Mooney-Rivlin"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Mooney-Rivlin material with an ellipsoidal continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
EFD Mooney-Rivlin
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin parameter c1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin parameter c2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\beta_{1},\beta_{2},\beta_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\xi_{1},\xi_{2},\xi_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 for this material is given by,
 
\begin_inset Formula 
\[
\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{MR}+\tilde{\boldsymbol{\sigma}}_{f}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{MR}$
\end_inset

 is the stress from the Mooney-Rivlin basis (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin"
nolink "false"

\end_inset

),
 and 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{f}$
\end_inset

 is the stress contribution from the ellipsoidal fiber distribution (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:EFD-Uncoupled"
nolink "false"

\end_inset

).
 The orientation of the material axes can be defined as explained in detail in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="EFD Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  <beta>4.5,4.5,4.5</beta>
\end_layout

\begin_layout LyX-Code
  <ksi>1,1,1</ksi>
\end_layout

\begin_layout LyX-Code
  <k>20000</k>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution Veronda-Westmann
\begin_inset CommandInset label
LatexCommand label
name "subsec:EFD-Veronda-Westmann"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Veronda-Westmann material with an ellipsoidal continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
EFD Veronda-Westmann
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
First VW coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second VW coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left({\beta_{1},\beta_{2},\beta_{3}}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left({\xi_{1},\xi_{2},\xi_{3}}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 for this material is given by,
 
\begin_inset Formula 
\[
\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{VW}+\tilde{\boldsymbol{\sigma}}_{f}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{VW}$
\end_inset

 is the stress from the Veronda-Westmann basis (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Veronda-Westmann"
nolink "false"

\end_inset

),
 and 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}_{f}$
\end_inset

 is the stress contribution from the ellipsoidal fiber distribution (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:EFD-Uncoupled"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="EFD Veronda-Westmann">
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.5</c2>
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
  <beta>4.5,4.5,4.5</beta>
\end_layout

\begin_layout LyX-Code
  <ksi>1,1,1</ksi>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fung Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fung-Orthotropic"

\end_inset


\end_layout

\begin_layout Standard
The material type for orthotropic Fung elasticity 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung79,Fung93"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Fung orthotropic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{1}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{2}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{3}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{12}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{23}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{31}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{12}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{23}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{31}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c$
\end_inset

 coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The hyperelastic strain energy function is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09"
literal "true"

\end_inset

,
 
\begin_inset Formula 
\begin{equation}
\Psi=\frac{1}{2}c\left(e^{\tilde{Q}}-1\right)+U\left(J\right)\,,\label{eq6}
\end{equation}

\end_inset

where,
 
\begin_inset Formula 
\[
\tilde{Q}=c^{-1}\sum\limits_{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{\tilde{E}}^{2}+\sum\limits_{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{\tilde{E}}\right)\left(\mathbf{M}_{b}:\mathbf{\tilde{E}}\right)\right].
\]

\end_inset

Here,
 
\begin_inset Formula $\mathbf{\tilde{E}}=\left(\mathbf{\tilde{C}}-\mathbf{I}\right)/2$
\end_inset

 and 
\begin_inset Formula $\mathbf{M}_{a}=\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

 where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 defines the initial direction of material axis 
\begin_inset Formula $a$
\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

 on how to define the material axes for orthotropic materials.
 The Lam constants 
\begin_inset Formula $\mu_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3)$
\end_inset

 and 
\begin_inset Formula $\lambda_{ab}$
\end_inset

 (
\begin_inset Formula $a,b=1,2,3$
\end_inset

,
 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab})$
\end_inset

 are related to Young's moduli 
\begin_inset Formula $E_{a}$
\end_inset

,
 shear moduli 
\begin_inset Formula $G_{ab}$
\end_inset

 and Poisson's ratios 
\begin_inset Formula $\nu_{ab}$
\end_inset

 via 
\begin_inset Formula 
\[
\begin{aligned} & \left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]^{-1}\\
 & =\left[\begin{array}{cccccc}
\frac{1}{E_{1}} & -\frac{\nu_{12}}{E_{1}} & -\frac{\nu_{13}}{E_{1}} & 0 & 0 & 0\\
-\frac{\nu_{21}}{E_{2}} & \frac{1}{E_{2}} & -\frac{\nu_{23}}{E_{2}} & 0 & 0 & 0\\
-\frac{\nu_{31}}{E_{3}} & -\frac{\nu_{32}}{E_{3}} & \frac{1}{E_{3}} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{G_{12}} & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{G_{23}} & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{G_{31}}
\end{array}\right]
\end{aligned}
.
\]

\end_inset

The orthotropic Lam parameters should produce a positive definite stiffness matrix.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="3" type="Fung orthotropic">
\end_layout

\begin_layout LyX-Code
  <E1>124</E1>
\end_layout

\begin_layout LyX-Code
  <E2>124</E2>
\end_layout

\begin_layout LyX-Code
  <E3>36</E3>
\end_layout

\begin_layout LyX-Code
  <G12>67</G12>
\end_layout

\begin_layout LyX-Code
  <G23>40</G23>
\end_layout

\begin_layout LyX-Code
  <G31>40</G31>
\end_layout

\begin_layout LyX-Code
  <v12>-0.075</v12>
\end_layout

\begin_layout LyX-Code
  <v23>0.87</v23>
\end_layout

\begin_layout LyX-Code
  <v31>0.26</v31>
\end_layout

\begin_layout LyX-Code
  <c>1</c>
\end_layout

\begin_layout LyX-Code
  <k>120000</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Gent Material
\end_layout

\begin_layout Standard
The uncoupled Gent material is defined using the 
\emph on

\begin_inset Quotes eld
\end_inset

Gent
\begin_inset Quotes erd
\end_inset


\emph default
 type string.
 It defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Jm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J_{m}=I_{m}-1$
\end_inset

,
 with 
\begin_inset Formula $I_{m}$
\end_inset

 max value for first invariant 
\begin_inset Formula $I_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain energy of this material is defined via an uncoupled formulation,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi_{r}=\tilde{\Psi}_{r}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)
\]

\end_inset

Here,
 the deviatoric strain energy is given by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\tilde{\Psi}=-\frac{\mu J_{m}}{2}\ln\left(1-\frac{\tilde{I}_{1}-3}{J_{m}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="Gent">
\end_layout

\begin_layout LyX-Code
  <G>3.14</G>
\end_layout

\begin_layout LyX-Code
  <Jm>1.5</Jm>
\end_layout

\begin_layout LyX-Code
  <k>1e5</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Uncoupled Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow-Uncoupled"

\end_inset


\end_layout

\begin_layout Standard
The material type for the uncoupled Holmes-Mow material is 
\emph on
uncoupled Holmes-Mow
\emph default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus 
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stiffening coefficient 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material model uncouples deviatoric and volumetric behaviors,
 
\begin_inset Formula 
\[
\Psi_{r}=\tilde{\Psi}_{r}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)
\]

\end_inset

The deviatoric strain-energy function is given by
\begin_inset Formula 
\[
\tilde{\Psi}_{r}=\frac{1}{2}\frac{\mu}{\beta}\left(e^{\tilde{Q}}-1\right)
\]

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is the shear modulus and
\begin_inset Formula 
\[
\tilde{Q}=\beta\left(\tilde{I}_{1}-3\right)
\]

\end_inset

where 
\begin_inset Formula $\beta$
\end_inset

 is the exponential stiffening coefficient.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="uncoupled Holmes-Mow">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <mu>0.5</mu>
\end_layout

\begin_layout LyX-Code
  <beta>2</beta>
\end_layout

\begin_layout LyX-Code
  <k>5000</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Holzapfel-Gasser-Ogden
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holzapfel-Gasser-Ogden"

\end_inset


\end_layout

\begin_layout Standard
The material type for the uncoupled Holzapfel-Gasser-Ogden material 
\begin_inset CommandInset citation
LatexCommand citep
key "Gasser06"
literal "true"

\end_inset

 is 
\emph on
Holzapfel-Gasser-Ogden
\emph default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus of ground matrix
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber exponential coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gamma>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber mean orientation angle 
\begin_inset Formula $\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
deg
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber dispersion
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material model uncouples deviatoric and volumetric behaviors.
 The deviatoric strain-energy function is given by:
 
\begin_inset Formula 
\[
\Psi_{r}=\tilde{\Psi}_{r}\left(\tilde{\mathbf{C}}\right)+U\left(J\right)
\]

\end_inset

where
\begin_inset Formula 
\[
\tilde{\Psi}_{r}=\frac{c}{2}\left(\tilde{I}_{1}-3\right)+\frac{k_{1}}{2k_{2}}\sum_{\alpha=1}^{2}\left(\exp\left(k_{2}\left\langle \tilde{E}_{\alpha}\right\rangle ^{2}\right)-1\right)
\]

\end_inset

and the default volumetric strain energy function is
\begin_inset Formula 
\[
U\left(J\right)=\frac{k}{2}\left(\frac{J^{2}-1}{2}-\ln J\right)
\]

\end_inset

The fiber strain is
\begin_inset Formula 
\[
\tilde{E}_{\alpha}=\kappa\left(\tilde{I}_{1}-3\right)+\left(1-3\kappa\right)\left(\tilde{I}_{4\alpha}-1\right)
\]

\end_inset

where 
\begin_inset Formula $\tilde{I}_{1}=\tr\tilde{\mathbf{C}}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{4\alpha}=\mathbf{a}_{\alpha r}\cdot\tilde{\mathbf{C}}\cdot\mathbf{a}_{\alpha r}$
\end_inset

.
 The Macaulay brackets around 
\begin_inset Formula $\left\langle \tilde{E}_{\alpha}\right\rangle $
\end_inset

 indicate that this term is zero when 
\begin_inset Formula $\tilde{E}_{\alpha}<0$
\end_inset

 and equal to 
\begin_inset Formula $\tilde{E}_{\alpha}$
\end_inset

 when this strain is positive.
\end_layout

\begin_layout Standard
There are two fiber families along the vectors 
\begin_inset Formula $\mathbf{a}_{\alpha r}$
\end_inset

 (
\begin_inset Formula $\alpha=1,2$
\end_inset

),
 lying in the 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2}\right\} $
\end_inset

 plane of the local material axes 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

,
 making an angle 
\begin_inset Formula $\pm\gamma$
\end_inset

 with respect to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

.
 Each fiber family has a dispersion 
\begin_inset Formula $\kappa$
\end_inset

,
 where 
\begin_inset Formula $0\le\kappa\le\frac{1}{3}$
\end_inset

.
 When 
\begin_inset Formula $\kappa=0$
\end_inset

 there is no fiber dispersion,
 implying that all the fibers in that family act along the angle 
\begin_inset Formula $\pm\gamma$
\end_inset

;
 the value 
\begin_inset Formula $\kappa=\frac{1}{3}$
\end_inset

 represents an isotropic fiber dispersion.
 All other intermediate values of 
\begin_inset Formula $\kappa$
\end_inset

 produce a 
\begin_inset Formula $\pi-$
\end_inset

periodic von Mises fiber distribution,
 as described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Gasser06"
literal "true"

\end_inset

.
 
\begin_inset Formula $c$
\end_inset

 is the shear modulus of the ground matrix;
 
\begin_inset Formula $k_{1}$
\end_inset

 is the fiber modulus and 
\begin_inset Formula $k_{2}$
\end_inset

 is the exponential coefficient.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="Holzapfel-Gasser-Ogden">
\end_layout

\begin_layout LyX-Code
  <c>7.64</c>
\end_layout

\begin_layout LyX-Code
  <k1>996.6</k1>
\end_layout

\begin_layout LyX-Code
  <k2>524.6</k2>
\end_layout

\begin_layout LyX-Code
  <gamma>49.98</gamma>
\end_layout

\begin_layout LyX-Code
  <kappa>0.226</kappa>
\end_layout

\begin_layout LyX-Code
  <k>1e5</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Mooney-Rivlin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mooney-Rivlin"

\end_inset


\end_layout

\begin_layout Standard
The material type for uncoupled Mooney-Rivlin materials is 
\shape italic
Mooney-Rivlin
\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coefficient of first invariant term
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coefficient of second invariant term
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material model is a hyperelastic Mooney-Rivlin type with uncoupled deviatoric and volumetric behavior.
 The strain-energy function is given by:
 
\begin_inset Formula 
\[
\Psi=C_{1}\left(\tilde{I}_{1}-3\right)+C_{2}\left(\tilde{I}_{2}-3\right)+\frac{1}{2}K\left(\ln J\right)^{2}\,.
\]

\end_inset


\begin_inset Formula $C_{1}$
\end_inset

 and 
\begin_inset Formula $C_{2}$
\end_inset

 are the Mooney-Rivlin material coefficients.
 The variables 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the first and second invariants of the deviatoric right Cauchy-Green deformation tensor 
\begin_inset Formula $\mathbf{\tilde{C}}$
\end_inset

.
 The coefficient 
\begin_inset Formula $K$
\end_inset

 is a bulk modulus-like penalty parameter and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient tensor.
 When 
\begin_inset Formula $C_{2}=0$
\end_inset

,
 this model reduces to an uncoupled version of the neo-Hookean constitutive model.
\end_layout

\begin_layout Standard
This material model uses a three-field element formulation,
 interpolating displacements as linear field variables and pressure and volume ratio as piecewise constant on each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
This material model is useful for modeling certain types of isotropic materials that exhibit some limited compressibility,
 i.e.
 100 < (
\begin_inset Formula $K$
\end_inset

/
\begin_inset Formula $C_{\mathrm{1}})$
\end_inset

 < 10000.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>20.0</c2>
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Muscle Material
\begin_inset CommandInset label
LatexCommand label
name "subsec:Muscle-Material"

\end_inset


\end_layout

\begin_layout Standard
This material model implements the constitutive model developed by Silvia S.
 Blemker 
\begin_inset CommandInset citation
LatexCommand citep
key "Blemker04"
literal "true"

\end_inset

.
 The material type for the muscle material is 
\shape italic
muscle material
\shape default
.
 The model is designed to simulate the passive and active material behavior of skeletal muscle.
 It defines the following parameters:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
along fiber shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cross fiber shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<p1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential stress coefficients
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
 
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<p2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber uncrimping factor
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Lofl>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optimal fiber length
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<smax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum isometric stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<activation>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
activation level
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The main difference between this material formulation compared to other transversely hyperelastic materials is that it is formulated using a set of new invariants,
 originally due to Criscione 
\begin_inset CommandInset citation
LatexCommand citep
key "Criscione01"
literal "true"

\end_inset

,
 instead of the usual five invariants proposed by A.J.M.
 Spencer 
\begin_inset CommandInset citation
LatexCommand citep
key "Spencer84"
literal "true"

\end_inset

.
 For this particular material,
 only two of the five Criscione invariants are used.
 The strain energy function is defined as follows:
 
\begin_inset Formula 
\[
\Psi\left(B_{1},B_{2},\lambda\right)=G_{1}\tilde{B}_{1}^{2}+G_{2}\tilde{B}_{2}^{2}+F_{m}\left(\tilde{\lambda}\right)+U\left(J\right).
\]

\end_inset

The function 
\begin_inset Formula $F_{m}$
\end_inset

is the strain energy contribution of the muscle fibers.
 It is defined as follows:
 
\begin_inset Formula 
\[
\lambda\frac{\partial F_{m}}{\partial\lambda}=\sigma_{\max}\left(f_{m}^{\text{passive}}\left(\lambda\right)+\alpha f_{m}^{\text{active}}\left(\lambda\right)\right)\frac{\lambda}{\lambda_{ofl}},
\]

\end_inset

where,
 
\begin_inset Formula 
\[
f_{m}^{\text{passive}}\left(\lambda\right)=\begin{cases}
0 & \lambda\leqslant\lambda_{ofl}\\
P_{1}\left(e^{P_{2}\left(\lambda/\lambda_{ofl}-1\right)}-1\right) & \lambda_{ofl}<\lambda<\lambda^{\ast}\\
P_{3}\lambda/\lambda_{ofl}+P_{4} & \lambda\geqslant\lambda^{\ast}
\end{cases}\,,
\]

\end_inset

and 
\begin_inset Formula 
\[
f_{m}^{\text{active}}\left(\lambda\right)=\begin{cases}
9\left(\lambda/\lambda_{ofl}-0.4\right)^{2} & \lambda\leqslant0.6\lambda_{ofl}\\
9\left(\lambda/\lambda_{ofl}-1.6\right)^{2} & \lambda\geqslant1.4\lambda_{ofl}\\
1-4\left(1-\lambda/\lambda_{ofl}\right)^{2} & 0.6\lambda_{ofl}<\lambda<1.4\lambda_{ofl}
\end{cases}\,.
\]

\end_inset

The values 
\begin_inset Formula $P_{3}$
\end_inset

and 
\begin_inset Formula $P_{4}$
\end_inset

 are determined by requiring 
\begin_inset Formula $C^{0}$
\end_inset

and 
\begin_inset Formula $C^{1}$
\end_inset

continuity at 
\begin_inset Formula $\lambda=\lambda^{\ast}$
\end_inset

.
\end_layout

\begin_layout Standard
The parameter 
\begin_inset Formula $\alpha$
\end_inset

 is the activation level and can be specified using the 
\emph on
activation
\shape italic
\emph default
 
\shape default
element.
 You can specify a loadcurve using the 
\shape italic
lc 
\shape default
attribute.
 The value is interpreted as a scale factor when a loadcurve is defined or as the constant activation level when no loadcurve is defined.
\end_layout

\begin_layout Standard
The muscle fiber direction is specified similarly to the transversely isotropic Mooney-Rivlin model.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="muscle material">
\end_layout

\begin_layout LyX-Code
  <g1>500</g1>
\end_layout

\begin_layout LyX-Code
  <g2>500</g2>
\end_layout

\begin_layout LyX-Code
  <p1>0.05</p1>
\end_layout

\begin_layout LyX-Code
  <p2>6.6</p2>
\end_layout

\begin_layout LyX-Code
  <smax>3e5</smax>
\end_layout

\begin_layout LyX-Code
  <Lofl>1.07</Lofl>
\end_layout

\begin_layout LyX-Code
  <lambda>1.4</lambda>
\end_layout

\begin_layout LyX-Code
  <k>1e6</k>
\end_layout

\begin_layout LyX-Code
  <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ogden
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden"

\end_inset


\end_layout

\begin_layout Standard
This material describes an incompressible hyperelastic Ogden material 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c[n]>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coefficient of n
\begin_inset Formula $^{\mathrm{th}}$
\end_inset

 term,
 where n can range from 1 to 6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<m[n]>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponent of n
\begin_inset Formula $^{\mathrm{th}}$
\end_inset

 term,
 where n can range from 1 to 6 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The uncoupled hyperelastic strain energy function for this material is given in terms of the eigenvalues of the deformation tensor:
 
\begin_inset Formula 
\[
\Psi=\sum\limits_{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\tilde{\lambda}_{1}^{m_{i}}+\tilde{\lambda}_{2}^{m_{i}}+\tilde{\lambda}_{3}^{m_{i}}-3\right)+U\left(J\right).
\]

\end_inset

Here,
 
\begin_inset Formula $\tilde{\lambda}_{i}^{2}$
\end_inset

 are the eigenvalues of 
\begin_inset Formula $\mathbf{\tilde{C}}$
\end_inset

,
 
\begin_inset Formula $c_{i}$
\end_inset

and 
\begin_inset Formula $m_{i}$
\end_inset

are material coefficients and 
\begin_inset Formula $N$
\end_inset

 ranges from 1 to 6.
 Note that you only have to include the material parameters for the terms you intend to use.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="Ogden">
\end_layout

\begin_layout LyX-Code
  <m1>2.4</m1>
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Tendon Material
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tendon-Material"

\end_inset


\end_layout

\begin_layout Standard
The material type for the tendon material is 
\shape italic
tendon material
\shape default
.
 The tendon material is similar to the muscle material 
\begin_inset CommandInset citation
LatexCommand citep
key "Blemker04"
literal "true"

\end_inset

.
 The only difference is the fiber function.
 For tendon material this is defined as:
 
\begin_inset Formula 
\[
\lambda\frac{\partial F_{t}}{\partial\lambda}=\sigma\left(\lambda\right),
\]

\end_inset

where 
\begin_inset Formula 
\[
\sigma\left(\lambda\right)=\begin{cases}
0 & \lambda\leqslant1\\
L_{1}\left(e^{L_{2}\left(\lambda-1\right)}-1\right) & 1<\lambda<\lambda^{\ast}\\
L_{3}\lambda+L_{4} & \lambda\geqslant\lambda^{\ast}
\end{cases}\,.
\]

\end_inset

The parameters 
\begin_inset Formula $L_{3}$
\end_inset

and 
\begin_inset Formula $L_{4}$
\end_inset

are determined by requiring 
\begin_inset Formula $C^{0}$
\end_inset

 and 
\begin_inset Formula $C^{1}$
\end_inset

 continuity at 
\begin_inset Formula $\lambda^{\ast}$
\end_inset

.
\end_layout

\begin_layout Standard
The material parameters for this material are listed below.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
along fiber shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cross fiber shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential stress coefficients
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber uncrimping factor
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The tendon fiber direction is specified similarly to the transversely isotropic Mooney-Rivlin model.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="tendon material">
\end_layout

\begin_layout LyX-Code
  <g1>5e4</g1>
\end_layout

\begin_layout LyX-Code
  <g2>5e4</g2>
\end_layout

\begin_layout LyX-Code
  <l1>2.7e6/l1>
\end_layout

\begin_layout LyX-Code
  <l2>46.4</l2>
\end_layout

\begin_layout LyX-Code
  <lambda>1.03</lambda>
\end_layout

\begin_layout LyX-Code
  <k>1e7</k>
\end_layout

\begin_layout LyX-Code
  <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Tension-Compression Nonlinear Orthotropic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Tension-Compression-Nonlinear-Ortho"

\end_inset


\end_layout

\begin_layout Standard
The material type for the tension-compression nonlinear orthotropic material is 
\begin_inset Quotes eld
\end_inset


\shape italic
TC nonlinear orthotropic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters are defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
First Mooney-Rivlin material parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Mooney-Rivlin material parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the 
\begin_inset Formula $\beta$
\end_inset

 parameter (see below)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the 
\begin_inset Formula $\xi$
\end_inset

 parameter (see below)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mat_axis>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
defines the material axes
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material is based on the following uncoupled hyperelastic strain energy function 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian07c"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\Psi\left(\mathbf{C},\lambda_{1},\lambda_{2},\lambda_{3}\right)=\tilde{\Psi}_{iso}\left(\mathbf{\tilde{C}}\right)+\sum\limits_{i=1}^{3}\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)+U\left(J\right)\,.
\]

\end_inset

The isotropic strain energy 
\begin_inset Formula $\tilde{\Psi}_{iso}$
\end_inset

and the dilatational energy 
\begin_inset Formula $U$
\end_inset

 are the same as for the Mooney-Rivlin material.
 The tension-compression term is defined as follows:
 
\begin_inset Formula 
\[
\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)=\begin{cases}
\xi_{i}\left(\tilde{\lambda}_{i}-1\right)^{\beta_{i}} & \tilde{\lambda}_{i}>1\\
0 & \tilde{\lambda}_{i}\leqslant1
\end{cases}\quad\xi_{i}\geqslant0\quad\left(\text{no sum over }i\right)\,.
\]

\end_inset

The 
\begin_inset Formula $\tilde{\lambda}_{i}$
\end_inset

 parameters are the deviatoric fiber stretches of the local material fibers:
 
\begin_inset Formula 
\[
\tilde{\lambda}_{i}=\left(\mathbf{a}_{i}^{0}\cdot\mathbf{\tilde{C}}\cdot\mathbf{a}_{i}^{0}\right)^{1/2}\,.
\]

\end_inset

The local material fibers are defined (in the reference frame) as an orthonormal set of vectors 
\begin_inset Formula $\mathbf{a}_{i}^{0}$
\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

 for more information.
 As with all uncoupled materials,
 this material uses the three-field element formulation.
\end_layout

\begin_layout Standard
A complete example for this material follows.
\end_layout

\begin_layout LyX-Code
<material id="7" name="cartilage" type="TC nonlinear orthotropic">
\end_layout

\begin_layout LyX-Code
  <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
  <beta>4.3,4.3,4.3</beta>
\end_layout

\begin_layout LyX-Code
  <ksi>4525,
 4525,
 4525</ksi>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Transversely Isotropic Mooney-Rivlin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Mooney-Rivlin"

\end_inset


\end_layout

\begin_layout Standard
The material type for transversely isotropic Mooney-Rivlin materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
trans iso Mooney-Rivlin
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin coefficient 1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin coefficient 2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stress coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c4>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber uncrimping coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c5>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modulus of straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam_max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fiber>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber distribution option
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<active_contraction>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optional active contraction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This constitutive model can be used to represent a material that has a single preferred fiber direction and was developed for application to biological soft tissues 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso98,Quapp98,Weiss96"
literal "true"

\end_inset

.
 It can be used to model tissues such as tendons,
 ligaments and muscle.
 The elastic response of the tissue is assumed to arise from the resistance of the fiber family and an isotropic matrix.
 It is assumed that the uncoupled strain energy function can be written as follows:
 
\begin_inset Formula 
\[
\Psi=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+F_{2}\left(\tilde{\lambda}\right)+\frac{K}{2}\left[\ln\left(J\right)\right]^{2}.
\]

\end_inset

Here 
\begin_inset Formula $\tilde{I}_{1}$
\end_inset

 and 
\begin_inset Formula $\tilde{I}_{2}$
\end_inset

 are the first and second invariants of the deviatoric version of the right Cauchy Green deformation tensor 
\begin_inset Formula $\mathbf{\tilde{C}}$
\end_inset

 and 
\begin_inset Formula $\tilde{\lambda}$
\end_inset

 is the deviatoric part of the stretch along the fiber direction (
\begin_inset Formula $\tilde{\lambda}^{2}=\mathbf{a}_{0}\cdot\mathbf{\tilde{C}}\cdot\mathbf{a}_{0}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{a}_{0}$
\end_inset

 is the initial fiber direction),
 and 
\begin_inset Formula $J=\det\left(\mathbf{F}\right)$
\end_inset

 is the Jacobian of the deformation (volume ratio).
 The function 
\begin_inset Formula $F_{1}$
\end_inset

 represents the material response of the isotropic ground substance matrix and is the same as the Mooney-Rivlin form specified above,
 while 
\begin_inset Formula $F_{2}$
\end_inset

 represents the contribution from the fiber family.
 The strain energy of the fiber family is as follows:
 
\begin_inset Formula 
\[
F_{2}\left(\tilde{\lambda}\right)=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{-C_{4}}\left(\Ei\left(C_{4}\tilde{\lambda}\right)-\Ei\left(C_{4}\right)\right)-\ln\tilde{\lambda}\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\left(\tilde{\lambda}-1\right)+C_{6}\ln\tilde{\lambda} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,
\]

\end_inset

where 
\begin_inset Formula $\Ei\left(\cdot\right)$
\end_inset

 is the exponential integral function.
 The resulting fiber stress is evaluated from 
\begin_inset Formula 
\[
\tilde{\lambda}\frac{\partial F_{2}}{\partial\tilde{\lambda}}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\tilde{\lambda}-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\tilde{\lambda}+C_{6} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $C_{1}$
\end_inset

 and 
\begin_inset Formula $C_{2}$
\end_inset

 are the Mooney-Rivlin material coefficients,

\shape italic
 lam_max
\shape default
 (
\begin_inset Formula $\lambda_{m})$
\end_inset

 is the stretch at which the fibers are straightened,
 
\begin_inset Formula $C_{3}$
\end_inset

scales the exponential stresses,
 
\begin_inset Formula $C_{4}$
\end_inset

 is the rate of uncrimping of the fibers,
 and 
\begin_inset Formula $C_{5}$
\end_inset

is the modulus of the straightened fibers.
 
\begin_inset Formula $C_{6}$
\end_inset

 is determined from the requirement that the stress is continuous at 
\begin_inset Formula $\lambda_{m}$
\end_inset

.
\end_layout

\begin_layout Standard
This material model uses a three-field element formulation,
 interpolating displacements as linear field variables and pressure and volume ratio as piecewise constant on each element 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The fiber orientation can be specified as explained in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
 An optional active contraction model can also be defined for this material.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fiber-Active-Contraction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a transversely isotropic material with a Mooney-Rivlin basis.
 It defines a homogeneous fiber direction and uses the active fiber contraction feature.
\end_layout

\begin_layout LyX-Code
<material id="3" type="trans iso Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>13.85</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <c3>2.07</c3>
\end_layout

\begin_layout LyX-Code
  <c4>61.44</c4>
\end_layout

\begin_layout LyX-Code
  <c5>640.7</c5>
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.03</lam_max>
\end_layout

\begin_layout LyX-Code
  <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Transversely Isotropic Veronda-Westmann
\begin_inset CommandInset label
LatexCommand label
name "subsec:Transversely-Isotropic-Veronda-Westmann"

\end_inset


\end_layout

\begin_layout Standard
The material type for transversely isotropic Veronda-Westmann materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
trans iso Veronda-Westmann
\begin_inset Quotes erd
\end_inset


\shape default
 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss2002"
literal "true"

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann coefficient 1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann coefficient 2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stress coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c4>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber uncrimping coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c5>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modulus of straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam_max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fiber>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber distribution option.
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<active_contraction>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optional active contraction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This uncoupled hyperelastic material differs from the Transversely Isotropic Mooney-Rivlin model in that it uses the Veronda-Westmann model for the isotropic matrix.
 The interpretation of the material parameters,
 except 
\begin_inset Formula $C_{1}$
\end_inset

 and 
\begin_inset Formula $C_{2}$
\end_inset

is identical to this material model.
\end_layout

\begin_layout Standard
The fiber distribution option is explained in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
 An optional active contraction model can also be defined for this material.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fiber-Active-Contraction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for more details.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a transversely isotropic material model with a Veronda-Westmann basis.
 The fiber direction is implicitly implied as 
\shape italic
local
\shape default
.
\end_layout

\begin_layout LyX-Code
<material id="3" type="trans iso Veronda-Westmann">
\end_layout

\begin_layout LyX-Code
  <c1>13.85</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <c3>2.07</c3>
\end_layout

\begin_layout LyX-Code
  <c4>61.44</c4>
\end_layout

\begin_layout LyX-Code
  <c5>640.7</c5>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.03</lam_max>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Uncoupled Solid Mixture
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Solid-Mixture"

\end_inset


\end_layout

\begin_layout Standard
The material type for for a constrained mixture of uncoupled solids is 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\begin_inset Quotes erd
\end_inset


\shape default
.
 This material describes a mixture of quasi-incompressible elastic solids.
 It is a container for any combination of the materials described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Container tag for solid material
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The mixture may consist of any number of solids.
 The stress tensor for the solid mixture is the sum of the stresses for all the solids.
 The bulk modulus of the uncoupled solid mixture is the sum of the bulk moduli of the individual <solid> materials.
 A bulk modulus specified outside of the <solid> materials will be ignored.
\end_layout

\begin_layout Standard
Material axes may be optionally specified within the <material> level,
 as well as within each <solid>.
 Within the <material> level,
 these represent the local element axes relative to the global coordinate system.
 Within the <solid>,
 they represent local material axes relative to the element.
 If material axes are specified at both levels,
 they are properly compounded to produce local material axes relative to the global coordinate system.
 Material axes specified in the <ElementData> section are equivalent to a specification at the <material> level:
 they correspond to local element axes relative to the global system.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <k>30e3</k>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
    <a>1,0,0</a>
\end_layout

\begin_layout LyX-Code
    <d>0,1,0</d>
\end_layout

\begin_layout LyX-Code
  </mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>2.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="EFD uncoupled">
\end_layout

\begin_layout LyX-Code
    <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
      <a>0.8660254,0.5,0</a>
\end_layout

\begin_layout LyX-Code
      <d>0,0,1</d>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
    <ksi>5,
 1,
 1</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="EFD uncoupled">
\end_layout

\begin_layout LyX-Code
    <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
      <a>0.8660254,-0.5,0</a>
\end_layout

\begin_layout LyX-Code
      <d>0,0,1</d>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
    <ksi>5,
 1,
 1</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Veronda-Westmann
\begin_inset CommandInset label
LatexCommand label
name "subsec:Veronda-Westmann"

\end_inset


\end_layout

\begin_layout Standard
The material type for incompressible Veronda-Westmann materials is 
\shape italic
Veronda-Westmann
\shape default
 
\begin_inset CommandInset citation
LatexCommand citep
key "Veronda70"
literal "true"

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
First VW coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second VW coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model is similar to the Mooney-Rivlin model in that it also uses an uncoupled deviatoric dilatational strain energy:
 
\begin_inset Formula 
\[
\Psi=C_{1}\left[e^{\left(C_{2}\left(\tilde{I}_{1}-3\right)\right)}-1\right]-\frac{C_{1}C_{2}}{2}\left(\tilde{I}_{2}-3\right)+U\left(J\right)\,.
\]

\end_inset

The dilatational term is identical to the one used in the Mooney-Rivlin model.
 This model can be used to describe certain types of biological materials that display exponential stiffening with increasing strain.
 It has been used to describe the response of skin tissue 
\begin_inset CommandInset citation
LatexCommand citep
key "Veronda70"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="Veronda-Westmann">
\end_layout

\begin_layout LyX-Code
  <c1>1000.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>2000.0</c2>
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Mooney-Rivlin Von Mises Distributed Fibers
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mooney-Rivlin-Von-Mises"

\end_inset


\end_layout

\begin_layout Standard

\series bold
(Sclera and other thin soft tissues)
\end_layout

\begin_layout Standard
Authors:
 Ccile L.M.
 Gouget and Michal J.A.
 Girard
\end_layout

\begin_layout Standard
The material type for a thin material where fiber orientation follows a von Mises distribution is 
\begin_inset Quotes eld
\end_inset

Mooney-Rivlin von Mises Fibers
\begin_inset Quotes erd
\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="15" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin coefficient 1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin coefficient 2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stress coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c4>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber uncrimping coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c5>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modulus of straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam_max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tp>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Preferred fiber orientation in radian (angle within the plane of the fibers,
 defined with respect to the first direction given in mat_axis)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[rad] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kf>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber concentration factor 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<vmc>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Choice of von Mises distribution
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
=1 semi-circular von Mises distribution
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
=2 constrained von Mises mixture distribution
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<var_n>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponent (only for vmc=2)
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gipt>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of integration points (value is a multiple of 10)
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mat_axis>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reference frame of the plane of the fibers
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This constitutive model is designed for thin soft tissues.
 Fibers are multi-directional:
 they are distributed within the plane tangent to the tissue surface and they follow a unimodal distribution.
 It is a constitutive model that is suitable for ocular tissues (e.g.
 sclera and cornea) but can be used for other thin soft tissues.
 The proposed strain energy function is as follows:
 
\begin_inset Formula 
\[
\Psi=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+\int\limits_{\theta_{P}-\pi/2}^{\theta_{P}+\pi/2}P\left(\theta\right)F_{2}\left(\tilde{\lambda}\left[\theta\right]\right)d\theta+\frac{K}{2}\left[\ln\left(J\right)\right]^{2},
\]

\end_inset

where 
\begin_inset Formula $P$
\end_inset

 is the 2D unimodal distribution function of the fibers which satisfies the normalization condition:
 
\begin_inset Formula 
\[
\int\limits_{\theta_{P}-\pi/2}^{\theta_{P}+\pi/2}P\left(\theta\right)d\theta=1.
\]

\end_inset


\begin_inset Formula $\theta_{P}$
\end_inset

 is the preferred fiber orientation relative to a local coordinate system (parameter tp).
 The functions 
\begin_inset Formula $F_{1}$
\end_inset

and 
\begin_inset Formula $F_{2}$
\end_inset

 are described in the 
\begin_inset Quotes eld
\end_inset

Transversely Isotropic Mooney-Rivlin
\begin_inset Quotes erd
\end_inset

 model.
 The user can choose between 2 distribution functions using the parameter vmc.
\end_layout

\begin_layout Standard

\series bold
1.
 Semi-circular von Mises distribution (vmc 
\series default
=
\series bold
 1) 
\begin_inset CommandInset citation
LatexCommand citep
key "Girard09"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
The semi-circular von Mises distribution is one of the simplest unimodal distribution in circular statistics.
 It can be expressed as 
\begin_inset Formula 
\[
P\left(\theta\right)=\frac{1}{\pi I_{0}\left(k_{f}\right)}\exp\left[k_{f}\cos\left(2\left(\theta-\theta_{p}\right)\right)\right],
\]

\end_inset

where 
\begin_inset Formula $I_{0}$
\end_inset

 is the modified Bessel function of the first kind (order 0),
 and 
\begin_inset Formula $k_{f}$
\end_inset

 is the fiber concentration factor.
 
\begin_inset Formula $k_{f}$
\end_inset

 controls the amount of fibers that are concentrated along the orientation 
\begin_inset Formula $\theta_{P}$
\end_inset

 as illustrated in the figure below.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigMooneyRivlinVonMises.png

\end_inset


\end_layout

\begin_layout Plain Layout
Polar representation of the semi-circular
\series bold
 
\series default
von-Mises distribution describing in-plane collagen fiber alignment.
 In this case,
 the preferred fiber orientation 
\begin_inset Formula $\theta_{P}$
\end_inset

 is equal to zero degrees.
 When the fiber concentration factor 
\begin_inset Formula $k$
\end_inset

 is equal to zero,
 the collagen fibers have an isotropic distribution in a plane tangent to the scleral wall.
 As 
\begin_inset Formula $k$
\end_inset

 increases,
 the collagen fibers align along the preferred fiber orientation 
\begin_inset Formula $\theta_{P}$
\end_inset

.
 Note that the distributions were plotted on a circle of unit one to ease visualization.
\end_layout

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\series bold
2.
 Constrained von Mises Mixture Distribution (vmc 
\series default
=
\series bold
 2) 
\begin_inset CommandInset citation
LatexCommand citep
key "Gouget12"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
The semi-circular von Mises distribution is ideal for its simplicity but in some instance it fails to accurately describe the isotropic subpopulation of fibers present in thin soft tissues.
 An improved mathematical description is proposed here as a weighted mixture of the semi-circular uniform distribution and the semi-circular von Mises distribution.
 It can be expressed as:
 
\begin_inset Formula 
\[
P\left(\theta\right)=\frac{1-\beta}{\pi}+\frac{\beta}{\pi I_{0}\left(k_{f}\right)}\exp\left[k_{f}\cos\left(2\left(\theta-\theta_{p}\right)\right)\right],
\]

\end_inset

where 
\begin_inset Formula $\beta$
\end_inset

 needs to be constrained for uniqueness and stability.
 
\begin_inset Formula $\beta$
\end_inset

 is expressed as:
 
\begin_inset Formula 
\[
\beta=\left(\frac{I_{1}\left(k_{f}\right)}{I_{0}\left(k_{f}\right)}\right)^{n},
\]

\end_inset

where 
\begin_inset Formula $I_{1}$
\end_inset

 is the modified Bessel function of the first kind (order 1),
 and n is an exponent to be determined experimentally (parameter var_n).
 n=2 has been found to be suitable for the sclera based on fiber distribution measurements using small angle light scattering.
\end_layout

\begin_layout Standard

\series bold
Note about Numerical Integration
\end_layout

\begin_layout Standard
All numerical integrations are performed using a 10-point Gaussian quadrature rule.
 The number of Gaussian integration points can be increased for numerical stability.
 This is controlled through the parameter 
\emph on
gipt
\emph default
.
 We recommend to use at least 
\emph on
gipt
\emph default
 = 20 (2
\begin_inset Formula $\times$
\end_inset

10 integration points).
 Note that the more integration points are used,
 the slower the model will run.
 By increasing the number of integration points,
 one should observe convergence in the numerical accuracy.
 The parameter gipt is required to be a multiple of 10.
\end_layout

\begin_layout Standard

\series bold
Definition of the Fiber Plane
\end_layout

\begin_layout Standard
The user must specify two directions to define a local coordinate system of the plane in which the fibers lay.
 As explained in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

,
 this can be done by defining two directions with the parameter 
\emph on
mat_axis
\emph default
.
 The first direction (vector 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 of 
\emph on
mat_axis
\emph default
) must be the reference direction used to define the angle 
\emph on
tp
\emph default
 (
\begin_inset Formula $\theta_{P}$
\end_inset

).
 The second direction (vector 
\series bold

\begin_inset Formula $\mathbf{d}$
\end_inset


\series default
 of mat_axis) can be any other direction in the plane of the fibers.
 Thus,
 a fiber at angle 
\begin_inset Formula $\theta_{P}$
\end_inset

 will be along the vector 
\begin_inset Formula $\mathbf{v}=\cos\theta_{P}\mathbf{e}_{1}+\sin\theta_{P}\mathbf{e}_{2}$
\end_inset

 where 
\begin_inset Formula $\mathbf{e}_{1}=\mathbf{a}/\left\Vert \mathbf{a}\right\Vert $
\end_inset

,
 
\begin_inset Formula $\mathbf{e}_{2}=\left(\mathbf{e}_{3}\times\mathbf{a}\right)/\left\Vert \mathbf{e}_{3}\times\mathbf{a}\right\Vert $
\end_inset

,
 
\begin_inset Formula $\mathbf{e}_{3}=\left(\mathbf{a}\times\mathbf{d}\right)/\left\Vert \mathbf{a}\times\mathbf{d}\right\Vert $
\end_inset

,
 as was defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\series bold
Note on parameters kf and tp
\end_layout

\begin_layout Standard
The parameters kf and tp can be specified either in the Material section or in the 
\shape italic
ElementData
\shape default
 section with the tag MRVonMisesParameters.
 With this second option the user can define different fiber characteristics for each element separately,
 which can be useful if fiber orientations or concentrations vary spatially.
 The parameter mat_axis can also be defined either in the Material section or in the 
\shape italic
ElementData
\shape default
 section.
\end_layout

\begin_layout Standard

\series bold
Example
\end_layout

\begin_layout Standard
This example defines a thin soft tissue material where fibers are distributed according to a constrained von Mises mixture distribution.
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material 1" type="Mooney-Rivlin von Mises Fibers">
\end_layout

\begin_layout LyX-Code
  <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <c3>50.0</c3>
\end_layout

\begin_layout LyX-Code
  <c4>5.0</c4>
\end_layout

\begin_layout LyX-Code
  <c5>1</c5>
\end_layout

\begin_layout LyX-Code
  <lam_max>10</lam_max>
\end_layout

\begin_layout LyX-Code
  <k>1000000.0</k>
\end_layout

\begin_layout LyX-Code
  <kf>1</kf>
\end_layout

\begin_layout LyX-Code
  <vmc>2</vmc>
\end_layout

\begin_layout LyX-Code
  <var_n>2.0</var_n>
\end_layout

\begin_layout LyX-Code
  <tp>0.0</tp>
\end_layout

\begin_layout LyX-Code
  <gipt>40</gipt>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">4,1,3</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Isotropic Lee-Sacks uncoupled
\begin_inset CommandInset label
LatexCommand label
name "subsec:Kamensky-uncoupled"

\end_inset


\end_layout

\begin_layout Standard
This material implements a Fung-type material,
 as presented in Kamensy,
 CMAME 2018.
 The material formulation is selected by setting the type attribute to "
\family typewriter
uncoupled
\family default
 
\family typewriter
isotropic Lee-Sacks
\family default
".
 It defines the following parameters:
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear-modulus of neo-Hookean matrix
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c1 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c2 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tangent_scale>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scale factor for c0 when used in tangent (default = 1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy density function for this material combines a neo-Hookean matrix with a Fung-type exponential term,
 and is defined as follows.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi=\frac{c_{0}}{2}\left(I_{1}-3\right)+\frac{c_{1}}{2}\left(e^{c_{2}\left(I_{1}-3\right)^{2}}-1\right)
\]

\end_inset


\end_layout

\begin_layout Standard
As reported in Kamensky,
 the exponential term may cause convergence difficulties under certain loading conditions.
 It was reported that increasing the value of 
\begin_inset Formula $c_{0}$
\end_inset

during the stiffness evaluation may improve convergence.
 The default value for 
\emph on
tangent_scale 
\emph default
is 1,
 and thus tangent scaling is not applied.
 A tangent scale factor of 20 was used in Kamensky.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="material1" type="
\family typewriter
uncoupled
\family default
 
\family typewriter
isotropic Lee-Sacks
\family default
">
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
  <c0>10</c0>
\end_layout

\begin_layout LyX-Code
  <c1>0.209</c1>
\end_layout

\begin_layout LyX-Code
  <c2>9.046</c2>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Yeoh Material
\begin_inset CommandInset label
LatexCommand label
name "subsec:Yeoh-Material"

\end_inset


\end_layout

\begin_layout Standard
This material implements a Yeoh material,
 as presented online (https://en.wikipedia.org/wiki/Yeoh_hyperelastic_model).
 The material formulation is selected by setting the type attribute to "Yeoh".
 It defines the following parameters:
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>...<c6>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Elastic moduli of Yeoh material (up to 6)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy density function for this material combines a neo-Hookean matrix with a Fung-type exponential term,
 and is defined as follows.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi=\sum_{i=1}^{6}c_{i}\left(\tilde{I}_{1}-3\right)^{i}
\]

\end_inset


\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="material1" type="Yeoh">
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
  <c1>0.75</c0>
\end_layout

\begin_layout LyX-Code
  <c1>-0.04</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.08</c2>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Fiber Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
Some of the material models described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 which include a fiber model may provide the option to specify an active contraction along that fiber.
 This section lists the types of fiber active contraction models.
\end_layout

\begin_layout Subsubsection
Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The default active contraction model is 
\begin_inset Quotes eld
\end_inset


\emph on
active_contraction
\emph default

\begin_inset Quotes erd
\end_inset

.
 It is based on the formulation of Guccione et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Guccione93"
literal "false"

\end_inset

 and reviewed in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
 The active stress is evaluated as 
\begin_inset Formula $T^{a}\mathbf{a}\otimes\mathbf{a}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the unit vector along the fiber in the current configuration,
 and
\begin_inset Formula 
\[
T^{a}=T_{\max}\frac{Ca_{0}^{2}}{Ca_{0}^{2}+ECa_{50}^{2}}C\left(t\right)
\]

\end_inset

where
\begin_inset Formula 
\[
ECa_{50}=\frac{\left(\text{Ca}_{0}\right)_{\max}}{\sqrt{\exp\left[\beta\left(\lambda\left(t\right)l_{r}-l_{0}\right)\right]-1}}
\]

\end_inset

In this expression,
 
\begin_inset Formula $\lambda\left(t\right)$
\end_inset

 is the fiber stretch ratio at the current time.
 The activation curve 
\begin_inset Formula $C\left(t\right)$
\end_inset

 is represented by the 
\emph on
ascl
\emph default
 property that takes an optional attribute,
 
\shape italic
lc
\shape default
,
 which defines the loadcurve.
 The list of parameters required for this model is as follows.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ascl>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activation scale factor 
\begin_inset Formula $C\left(t\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ca0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intracellular calcium concentration 
\begin_inset Formula $Ca_{0}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<camax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum peak intracellular calcium concentration 
\begin_inset Formula $\left(\text{Ca}_{0}\right)_{\max}$
\end_inset

 (default=ca0)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tension-sarcomere length relation constant 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
No tension sarcomere length 
\begin_inset Formula $l_{0}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<refl>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unloaded sarcomere length 
\begin_inset Formula $l_{r}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Tmax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Isometric tension under maximal activation at camax 
\begin_inset Formula $T_{\max}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a transversely isotropic material with a Mooney-Rivlin basis.
 It defines a homogeneous fiber direction and uses the active fiber contraction feature.
\end_layout

\begin_layout LyX-Code
<material id="3" type="trans iso Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>13.85</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <c3>2.07</c3>
\end_layout

\begin_layout LyX-Code
  <c4>61.44</c4>
\end_layout

\begin_layout LyX-Code
  <c5>640.7</c5>
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.03</lam_max>
\end_layout

\begin_layout LyX-Code
  <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
  <active_contraction type="active_contraction">
\end_layout

\begin_layout LyX-Code
    <ascl lc="1">1</ascl>
\end_layout

\begin_layout LyX-Code
    <ca0>4.35</ca0>
\end_layout

\begin_layout LyX-Code
    <beta>4.75</beta>
\end_layout

\begin_layout LyX-Code
    <l0>1.58</l0>
\end_layout

\begin_layout LyX-Code
    <refl>2.04</refl>
\end_layout

\begin_layout LyX-Code
  </active_contraction>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Force-Velocity Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Force-Velocity-Active-Contractio"

\end_inset


\end_layout

\begin_layout Standard
This material model was formulated by Estrada et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Estrada20"
literal "false"

\end_inset

 and is called 
\begin_inset Quotes eld
\end_inset


\emph on
force-velocity-Estrada
\emph default

\begin_inset Quotes erd
\end_inset

.
 It is a modification of the 
\begin_inset Quotes eld
\end_inset


\emph on
active_contraction
\emph default

\begin_inset Quotes erd
\end_inset

 material based on the formulation of Guccione et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Guccione93"
literal "false"

\end_inset

 described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Active-Contraction"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 based on the fading-memory formulation poroposed by Hunter et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Hunter98"
literal "false"

\end_inset

.
 The active stress is evaluated as 
\begin_inset Formula $T^{a}\mathbf{a}\otimes\mathbf{a}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is the unit vector along the fiber in the current configuration,
 and
\begin_inset Formula 
\[
T^{a}=e\left(t\right)\underbrace{T_{\max}\frac{Ca_{0}^{2}}{Ca_{0}^{2}+ECa_{50}^{2}}}_{\begin{array}{c}
\text{instantaneous length}\\
\text{dependence}
\end{array}}\underbrace{\frac{1+aQ\left(t,\lambda\left(t\right)\right)}{1-Q\left(t,\lambda\left(t\right)\right)}}_{\text{force-velocity}}
\]

\end_inset

where
\begin_inset Formula 
\[
ECa_{50}=\frac{\left(\text{Ca}_{0}\right)_{\max}}{\sqrt{\exp\left[\beta\left(\lambda\left(t\right)l_{r}-l_{0}\right)\right]-1}}
\]

\end_inset

and
\begin_inset Formula 
\[
Q\left(t,\lambda\left(t\right)\right)=\sum_{k=1}^{3}A_{k}\int_{-\infty}^{t}e^{-\alpha_{k}\left(t-\tau\right)}\dot{\lambda}\left(\tau\right)\,d\tau
\]

\end_inset

In these expressions,
 
\begin_inset Formula $\lambda\left(t\right)$
\end_inset

 is the fiber stretch ratio at the current time.
 Here,
 
\begin_inset Formula $T^{a}$
\end_inset

 
\begin_inset Quotes eld
\end_inset

is the product of three distinct components:
 a time-varying normalized activation,
 
\begin_inset Formula $e\left(t\right)$
\end_inset

,
 that defines the time course of force generation throughout the cardiac cycle;
 an instantaneous length-dependent term that scales the peak possible isometric tension based on the current fiber stretch;
 and a force-velocity term that dampens the instantaneous force generation based on the rate of shortening of the fibers
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Estrada20"
literal "false"

\end_inset

.
 The activation curve 
\begin_inset Formula $e\left(t\right)$
\end_inset

 is represented by the 
\emph on
ascl
\emph default
 property that takes an optional attribute,
 
\shape italic
lc
\shape default
,
 which defines the time-dependent loadcurve.
 The list of parameters required for this model is as follows.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ascl>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Activation scale factor 
\begin_inset Formula $e\left(t\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ca0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intracellular calcium concentration 
\begin_inset Formula $Ca_{0}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<camax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum peak intracellular calcium concentration 
\begin_inset Formula $\left(\text{Ca}_{0}\right)_{\max}$
\end_inset

 (default=ca0)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tension-sarcomere length relation constant 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
No tension sarcomere length 
\begin_inset Formula $l_{0}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<refl>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unloaded sarcomere length 
\begin_inset Formula $l_{r}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Tmax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Isometric tension under maximal activation at camax 
\begin_inset Formula $T_{\max}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<A1>,
 <A2>,
 <A3>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameters 
\begin_inset Formula $A_{k}$
\end_inset

 for 
\begin_inset Formula $k=1,2,3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha1>,
 <alpha2>,
 <alpha3>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameters 
\begin_inset Formula $\alpha_{k}$
\end_inset

 for 
\begin_inset Formula $k=1,2,3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<a_t>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $a$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<force_velocity>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set to true (1) by default.
 Set to false (0) to turn off the force-velocity term
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a transversely isotropic material with a Mooney-Rivlin basis.
 It defines a homogeneous fiber direction and uses the active fiber contraction feature.
\end_layout

\begin_layout LyX-Code
<material id="3" type="trans iso Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>13.85</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  <c3>2.07</c3>
\end_layout

\begin_layout LyX-Code
  <c4>61.44</c4>
\end_layout

\begin_layout LyX-Code
  <c5>640.7</c5>
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.03</lam_max>
\end_layout

\begin_layout LyX-Code
  <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
  <active_contraction type="force-velocity-Estrada">
\end_layout

\begin_layout LyX-Code
    <ascl lc="1">1</ascl>
\end_layout

\begin_layout LyX-Code
    <ca0>4.35</ca0>
\end_layout

\begin_layout LyX-Code
    <beta>4.75</beta>
\end_layout

\begin_layout LyX-Code
    <l0>1.58</l0>
\end_layout

\begin_layout LyX-Code
    <refl>1.58</refl>
\end_layout

\begin_layout LyX-Code
	<Tmax>135.7</Tmax>
\end_layout

\begin_layout LyX-Code
	<alpha1>30.30303</alpha1>
\end_layout

\begin_layout LyX-Code
	<A1>50</A1>
\end_layout

\begin_layout LyX-Code
	<a_t>0.5</a_t>
\end_layout

\begin_layout LyX-Code
	<force_velocity>1</force_velocity>
\end_layout

\begin_layout LyX-Code
  </active_contraction>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Unconstrained Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Unconstrained-Materials"

\end_inset


\end_layout

\begin_layout Standard
Unlike the materials in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

,
 these materials do not necessarily assume an additive decomposition of the bulk and deviatoric parts of the strain energy or stress.
 Further,
 these materials can only be used with the standard displacement-based finite element formulation,
 rather than the three-field element formulatoin.
 They should not be used for nearly-incompressible material behavior due to the potential for element locking.
\end_layout

\begin_layout Subsubsection
Arruda-Boyce Unconstrained
\begin_inset CommandInset label
LatexCommand label
name "subsec:Arruda-Boyce-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
The material type for an unconstrained Arruda-Boyce material is 
\emph on
Arruda-Boyce unconstrained
\emph default
.
 This isotropic Arruda-Boyce 
\begin_inset CommandInset citation
LatexCommand citep
key "Arruda93"
literal "false"

\end_inset

 8-chain model has been used in the field of polymer modeling and in cervical biomechanics 
\begin_inset CommandInset citation
LatexCommand citep
key "Shi22"
literal "false"

\end_inset

.
 It is based on the simple freely-jointed-chain model and can be derived using the Langevin equation of statistical mechanics.
 The strain energy density for this material takes the form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Psi(I_{1},J)=\xi\left(\sqrt{\frac{I_{1}}{3N}}\beta+\ln\frac{\beta}{\sinh\beta}\right)-\frac{\xi}{3}\sqrt{N}\beta_{0}\ln J+\frac{1}{2}\kappa(\ln J^{2}-1-2\ln J)\label{eq2-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\noindent
where 
\begin_inset Formula $I_{1}=\tr\mathbf{C}$
\end_inset

 is the first invariant of 
\begin_inset Formula $\mathbf{C}$
\end_inset

,
 
\begin_inset Formula ${\displaystyle \beta=\mathcal{L}^{-1}\left[\sqrt{\frac{I_{1}}{3N}}\right]}$
\end_inset

 is the inverse Langevin equation,
 and 
\begin_inset Formula ${\displaystyle \beta_{0}=\mathcal{L}^{-1}\left[\sqrt{\frac{1}{N}}\right]}$
\end_inset

.
 Here,
 
\begin_inset Formula $\xi=nk\Theta$
\end_inset

 is the initial fiber modulus with 
\begin_inset Formula $n,k,\Theta$
\end_inset

 respectively representing the number of chains per unit volume,
 Boltzmann's constant,
 and the absolute temperature.
 The parameter 
\begin_inset Formula $N=\zeta^{2}$
\end_inset

 is the number of chain segments,
 and 
\begin_inset Formula $\zeta$
\end_inset

 is the locking stretch that represents the extensibility of the material.
\end_layout

\begin_layout Standard
A Taylor series expansion is used to evaluate the inverse Langevin equation.
 The parameter 
\begin_inset Formula $n_{\mathrm{term}}$
\end_inset

 is used to control the number of terms used to evaluate the series;
 
\begin_inset Formula $n_{\mathrm{term}}$
\end_inset

 must be an integer between 3 and 30.
\end_layout

\begin_layout Standard
Langevin mechanics describes a stochastic process with non-Gaussian distribution.
 It will reduce to a Gaussian distribution when the system approaches equilibrium.
 Thus,
 when the material is far from its maximum extensibility,
 i.e.,
 when 
\begin_inset Formula $\zeta=\sqrt{N}$
\end_inset

 is much larger than the stretch,
 this model will reduce to a neo-Hookean material.
\end_layout

\begin_layout Standard
This material The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial fiber modulus 
\begin_inset Formula $\xi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<N>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of chain segments 
\begin_inset Formula $N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n_term>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of terms in the Taylor series expansion 
\begin_inset Formula $n_{\text{term}}$
\end_inset

 (
\begin_inset Formula $3\le n_{\text{term}}\le30$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus 
\begin_inset Formula $\kappa$
\end_inset

 of ground matrix
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Soft Tissue" type="Arruda-Boyce unconstrained">
\end_layout

\begin_layout LyX-Code
	<N>5</N>
\end_layout

\begin_layout LyX-Code
	<ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
	<n_term>30</n_term>
\end_layout

\begin_layout LyX-Code
	<kappa>1</kappa>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Carter-Hayes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Carter-Hayes"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Carter-Hayes material is 
\shape italic
Carter-Hayes
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus at reference density 
\begin_inset Formula $E_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<rho0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reference density 
\begin_inset Formula $\rho_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gamma>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponent of solid-bound molecule density for calculation of Young's modulus 
\begin_inset Formula $\gamma$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<sbm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
index of solid bound molecule
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model describes an unconstrained neo-Hookean material 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

 whose Young's modulus is a power-law function of the referential apparent density 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 of a solid-bound molecule.
 It is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
\Psi_{r}=\frac{E_{Y}}{2\left(1+\nu\right)}\left[\frac{1}{2}\left(\tr\mathbf{C}-3\right)-\ln J+\frac{\nu}{1-2\nu}\left(\ln J\right)^{2}\right].
\]

\end_inset

Here,
 
\begin_inset Formula $\mathbf{C}$
\end_inset

 is the right Cauchy-Green deformation tensor and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient tensor.
\end_layout

\begin_layout Standard
Young's modulus depends on 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 according to a power law 
\begin_inset CommandInset citation
LatexCommand citep
key "Carter76,Carter77"
literal "true"

\end_inset

,
 
\begin_inset Formula 
\[
E_{Y}=E_{0}\left(\frac{\rho_{r}^{\sigma}}{\rho_{0}}\right)^{\gamma}\,.
\]

\end_inset

This type of material references a solid-bound molecule that belongs to a multiphasic mixture.
 Therefore this material may only be used as the solid (or a component of the solid) in a multiphasic mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
nolink "false"

\end_inset

).
 The solid-bound molecule must be defined in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Bound-Molecules"
nolink "false"

\end_inset

) and must be included in the multiphasic mixture using a <solid_bound> tag.
 The parameter 
\shape italic
sbm
\shape default
 must refer to the global index of that solid-bound molecule.
 The value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 is specified within the <solid_bound> tag.
 If a chemical reaction is defined within that multiphasic mixture that alters the value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

,
 lower and upper bounds may be specified for this referential density within the <solid_bound> tag to prevent 
\begin_inset Formula $E_{Y}$
\end_inset

 from reducing to zero or achieving excessively elevated values.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="solid matrix" type="multiphasic">
\end_layout

\begin_layout LyX-Code
  <phi0>0</phi0>
\end_layout

\begin_layout LyX-Code
  <solid_bound sbm="1">
\end_layout

\begin_layout LyX-Code
    <rho0>1</rho0>
\end_layout

\begin_layout LyX-Code
    <rhomin>0.1</rhomin>
\end_layout

\begin_layout LyX-Code
    <rhomax>5</rhomax>
\end_layout

\begin_layout LyX-Code
  </solid_bound>
\end_layout

\begin_layout LyX-Code
  <fixed_charge_density>0</fixed_charge_density>
\end_layout

\begin_layout LyX-Code
  <solid type="Carter-Hayes">
\end_layout

\begin_layout LyX-Code
    <sbm>1</sbm>
\end_layout

\begin_layout LyX-Code
    <E0>10000</E0>
\end_layout

\begin_layout LyX-Code
    <rho0>1</rho0>
\end_layout

\begin_layout LyX-Code
    <gamma>2.0</gamma>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <permeability type="perm-const-iso">
\end_layout

\begin_layout LyX-Code
    <perm>1</perm>
\end_layout

\begin_layout LyX-Code
  </permeability>
\end_layout

\begin_layout LyX-Code
  <osmotic_coefficient type="osm-coef-const">
\end_layout

\begin_layout LyX-Code
    <osmcoef>1</osmcoef>
\end_layout

\begin_layout LyX-Code
  </osmotic_coefficient>
\end_layout

\begin_layout LyX-Code
  <reaction name="solid remodeling" type="mass-action-forward">
\end_layout

\begin_layout LyX-Code
    <Vbar>0</Vbar>
\end_layout

\begin_layout LyX-Code
    <vP sbm="1">1</vP>
\end_layout

\begin_layout LyX-Code
    <forward_rate type="Huiskes reaction rate">
\end_layout

\begin_layout LyX-Code
      <B>1</B>
\end_layout

\begin_layout LyX-Code
      <psi0>0.01</psi0>
\end_layout

\begin_layout LyX-Code
    </forward_rate>
\end_layout

\begin_layout LyX-Code
  </reaction>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Cell Growth
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cell-Growth"

\end_inset


\end_layout

\begin_layout Standard
The material type for cell growth is 
\begin_inset Quotes eld
\end_inset


\shape italic
cell growth
\shape default

\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2012"
literal "true"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phir>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
intracellular solid volume fraction in reference (strain-free) configuration,
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cr>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
intracellular molar content of membrane-impermeant solute (moles per volume of the cell in the reference configuration),
 
\begin_inset Formula $c_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ce>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
extracellular osmolarity,
 
\begin_inset Formula $c_{e}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-\pi\mathbf{I},
\]

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure,
 given by 
\begin_inset Formula 
\[
\pi=RT\left(\frac{c_{r}}{J-\varphi_{r}^{s}}-c_{e}\right),
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume.
 The values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 and absolute temperature 
\begin_inset Formula $T$
\end_inset

 must be specified as global constants.
\end_layout

\begin_layout Standard
Cell growth may be modeled by simply increasing the mass of the intracellular solid matrix and membrane-impermeant solute.
 This is achieved by allowing the parameters 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 to increase over time as a result of growth,
 by associating them with user-defined load curves.
 Since cell growth is often accompanied by cell division,
 and since daughter cells typically achieve the same solid and solute content as their parent,
 it may be convenient to assume that 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $c_{r}$
\end_inset

 increase proportionally,
 though this is not an obligatory relationship.
 To ensure that the initial configuration is a stress-free reference configuration,
 let 
\begin_inset Formula $c_{r}=\left(1-\varphi_{r}^{s}\right)c_{e}$
\end_inset

 in the initial state prior to growth.
\end_layout

\begin_layout Standard

\shape italic
Example (using units of mm,
 N,
 s,
 nmol,
 K)
\shape default
:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <T>298</T>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-06</R>
\end_layout

\begin_layout LyX-Code
    <Fc>0</Fc>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout LyX-Code
<Material>
\end_layout

\begin_layout LyX-Code
  <material id="1" name="Cell" type="cell growth">
\end_layout

\begin_layout LyX-Code
    <phir lc="1">1</phir>
\end_layout

\begin_layout LyX-Code
    <cr lc="2">1</cr>
\end_layout

\begin_layout LyX-Code
    <ce>300</ce>
\end_layout

\begin_layout LyX-Code
  </material>
\end_layout

\begin_layout LyX-Code
</Material>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1" type="smooth">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,0.3</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,0.6</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="2" type="smooth">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,210</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,420</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Kinematic Growth
\begin_inset CommandInset label
LatexCommand label
name "subsec:Kinematic-Growth"

\end_inset


\end_layout

\begin_layout Standard
The material type for kinematic growth is 
\emph on
kinematic growth
\emph default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic material undergoing kinematic growth
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<growth>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the growth model (
\emph on
volume growth
\emph default
,
 
\emph on
area growth
\emph default
,
 
\emph on
fiber growth
\emph default
)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Kinematic growth,
 based on the framework first proposed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Rodriguez94"
literal "false"

\end_inset

,
 uses the multiplicative decomposition of the deformation gradient into
\begin_inset Formula 
\[
\mathbf{F}=\mathbf{F}^{e}\cdot\mathbf{F}^{g}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{F}^{e}$
\end_inset

 represents the elastic deformation and 
\begin_inset Formula $\mathbf{F}^{g}$
\end_inset

 represents the growth.
 The related Jacobians are
\begin_inset Formula 
\[
J^{e}=\det\mathbf{F}^{e}\quad J^{g}=\det\mathbf{F}^{g}\,.
\]

\end_inset

A constitutive model for the growth tensor was provided by 
\begin_inset CommandInset citation
LatexCommand citep
key "Menzel12"
literal "false"

\end_inset

,
\begin_inset Formula 
\[
\mathbf{F}^{g}=\vartheta^{\text{iso}}\mathbf{I}+\left(\vartheta^{\text{ani}}-1\right)\mathbf{n}_{r}\otimes\mathbf{n}_{r}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the referential unit vector for a fiber direction (or normal to an area),
 
\begin_inset Formula $\vartheta^{\text{iso}}$
\end_inset

 represents isotropic growth,
 and 
\begin_inset Formula $\vartheta^{\text{ani}}$
\end_inset

 represents anisotropic growth.
\end_layout

\begin_layout Standard
For 
\emph on
volume growth
\emph default
,
 let 
\begin_inset Formula $\vartheta^{\text{iso}}=\vartheta^{g}$
\end_inset

 and 
\begin_inset Formula $\vartheta^{\text{ani}}=1$
\end_inset

,
 where 
\begin_inset Formula $\vartheta^{g}$
\end_inset

 is called the growth 
\emph on
multiplier
\emph default
 in FEBio,
 which is typically prescribed using a loadcurve.
 For 
\emph on
area growth
\emph default
 in the plane transverse to the normal direction 
\begin_inset Formula $\mathbf{n}$
\end_inset

,
 let 
\begin_inset Formula $\vartheta^{\text{iso}}=\sqrt{\vartheta^{g}}$
\end_inset

 and 
\begin_inset Formula $\vartheta^{\text{ani}}=2-\sqrt{\vartheta^{g}}$
\end_inset

.
 Finally,
 for 
\emph on
fiber growth
\emph default
,
 let 
\begin_inset Formula $\vartheta^{\text{iso}}=1$
\end_inset

 and 
\begin_inset Formula $\vartheta^{\text{ani}}=\vartheta^{g}$
\end_inset

.
 For 
\emph on
general growth
\emph default
 the user specifies the desired values of 
\begin_inset Formula $\vartheta^{\text{iso}}$
\end_inset

 and 
\begin_inset Formula $\vartheta^{\text{ani}}$
\end_inset

.
\end_layout

\begin_layout Standard
Internally,
 the calculations within FEBio require the evaluation of the inverse of 
\begin_inset Formula $\mathbf{F}^{g}$
\end_inset

,
 which is generall given by
\begin_inset Formula 
\[
\left(\mathbf{F}^{g}\right)^{-1}=\frac{1}{\vartheta^{\text{iso}}+\vartheta^{\text{ani}}-1}\left(\left(1+\frac{\vartheta^{\text{ani}}-1}{\vartheta^{\text{iso}}}\right)\mathbf{I}-\frac{\vartheta^{\text{ani}}-1}{\vartheta^{\text{iso}}}\mathbf{n}_{r}\otimes\mathbf{n}_{r}\right)
\]

\end_inset

The mass density of a growing material is evaluated from 
\begin_inset Formula $\rho=\rho_{r}/J$
\end_inset

 where 
\begin_inset Formula $\rho_{r}$
\end_inset

 is the (invariant) referential mass density of the growing solid (when there is neither growth nor deformation) and 
\begin_inset Formula $J=\det\mathbf{F}=\det\mathbf{F}^{e}\det\mathbf{F}^{g}\equiv J^{e}J^{g}$
\end_inset

.
 It follows that the mass density change produced only by the growth is 
\begin_inset Formula $\rho J^{e}\equiv\rho_{rg}=\rho_{r}/J^{g}$
\end_inset

,
 thus 
\begin_inset Formula $J^{g}=\det\mathbf{F}^{g}$
\end_inset

 may be used to evaluate the evolving solid mass density 
\begin_inset Formula $\rho_{rg}$
\end_inset

 due only to growth.
 From the general expression for 
\begin_inset Formula $\mathbf{F}^{g}$
\end_inset

 above it follows that
\begin_inset Formula 
\[
J^{g}=\det\mathbf{F}^{g}=\left(\vartheta^{\text{iso}}\right)^{2}\left(\vartheta^{\text{iso}}+\vartheta^{\text{ani}}-1\right)
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Cubic CLE
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cubic-CLE"

\end_inset


\end_layout

\begin_layout Standard
The material type for a conewise linear elastic (CLE) material with cubic symmetry is 
\shape italic
cubic CLE
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lp1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tensile diagonal first Lam coefficient 
\begin_inset Formula $\lambda_{+1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lm1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compressive diagonal first Lam coefficient 
\begin_inset Formula $\lambda_{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Off-diagonal first Lam coefficient 
\begin_inset Formula $\lambda_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Lam coefficient 
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This bimodular elastic material is specialized from the orthotropic conewise linear elastic material described by Curnier et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"
literal "true"

\end_inset

,
 to the case of cubic symmetry.
 It is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
\Psi_{r}=\mu\mathbf{I}:\mathbf{E}^{2}+\sum\limits_{a=1}^{3}\frac{1}{2}\lambda_{1}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)^{2}+\frac{1}{2}\lambda_{2}\sum\limits_{\begin{array}{c}
b=1\\
b\ne a
\end{array}}^{3}\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{r}:\mathbf{E}\right)\,,
\]

\end_inset

where 
\begin_inset Formula 
\[
\lambda_{1}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]=\begin{cases}
\lambda_{+1} & \mathbf{A}_{a}^{r}:\mathbf{E}\geqslant0\\
\lambda_{-1} & \mathbf{A}_{a}^{r}:\mathbf{\,}.E<0
\end{cases}
\]

\end_inset

Here,
 
\begin_inset Formula ${\mathbf{E}\ensuremath{}}$
\end_inset

 is the Lagrangian strain tensor and 
\begin_inset Formula $\mathbf{A}_{a}^{r}=\mathbf{a}_{a}^{r}\otimes\mathbf{a}_{a}^{r}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{a}_{a}^{r}$
\end_inset

 (
\begin_inset Formula $a=1,2,3$
\end_inset

 ) are orthonormal vectors aligned with the material axes.
 This material response was originally formulated for infinitesimal strain analyses;
 its behavior under finite strains may not be physically realistic.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="cubic CLE">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <lp1>13.01</lp1>
\end_layout

\begin_layout LyX-Code
  <lm1>0.49</lm1>
\end_layout

\begin_layout LyX-Code
  <l2>0.66</l2>
\end_layout

\begin_layout LyX-Code
  <mu>0.16</mu>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Donnan-Equilibrium-Swelling"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Donnan equilibrium swelling pressure is 
\begin_inset Quotes eld
\end_inset


\shape italic
Donnan equilibrium
\shape default

\begin_inset Quotes erd
\end_inset

.
 The swelling pressure is described by the equations for ideal Donnan equilibrium,
 assuming that the material is porous,
 with a charged solid matrix,
 and the external bathing environment consists of a salt solution of monovalent counter-ions 
\begin_inset CommandInset citation
LatexCommand citep
key "OVERBEEK56,Lai91"
literal "true"

\end_inset

.
 Since osmotic swelling must be resisted by a solid matrix,
 this material is not stable on its own.
 It must be combined with an elastic material that resists the swelling,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phiw0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gel porosity (fluid volume fraction) in reference (strain-free) configuration,
 
\begin_inset Formula $\varphi_{0}^{w}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cF0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fixed-charge density in reference (strain-free) configuration,
 
\begin_inset Formula $c_{0}^{F}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<bosm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
external bath osmolarity,
 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Phi>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
osmotic coefficient,
 
\begin_inset Formula $\Phi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the Donnan equilibrium response 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09a"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-\pi\mathbf{I},
\]

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure,
 given by 
\begin_inset Formula 
\[
\pi=RT\Phi\left(\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right),
\]

\end_inset

and 
\begin_inset Formula $c^{F}$
\end_inset

 is the fixed-charge density in the current configuration,
 related to the reference configuration via 
\begin_inset Formula 
\[
c^{F}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}c_{0}^{F},
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume.
 The values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 and absolute temperature 
\begin_inset Formula $T$
\end_inset

 must be specified as global constants.
 For ideal Donnan law,
 use 
\begin_inset Formula $\Phi=1$
\end_inset

.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 may be negative or positive;
 the gel porosity is unitless and must be in the range 
\begin_inset Formula $0<\varphi_{0}^{w}<1$
\end_inset

.
 A self-consistent set of units must be used for this model.
 For example:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(m,
 N,
 s,
 mol,
 K)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(mm,
 N,
 s,
 nmol,
 K) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.314 J/mol
\begin_inset Formula $\cdot$
\end_inset

K
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.31410
\begin_inset Formula $^{\mathrm{-6}}$
\end_inset

 mJ/nmol
\begin_inset Formula $\cdot$
\end_inset

K 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
K
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
K 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{0}^{F}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Eq/m
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

= mEq/L
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nEq/mm
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

= mEq/L 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mol/m
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

= mM
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmol/mm
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

= mM 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\xi_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pa
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MPa 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\pi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pa
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MPa 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Though this material is porous,
 this is not a full-fledged biphasic material as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Materials"
nolink "false"

\end_inset

 for example.
 The behavior described by this material is strictly valid only after the transient response of interstitial fluid and ion fluxes has subsided (thus Donnan 
\shape italic
equilibrium
\shape default
).
\end_layout

\begin_layout Standard
Donnan osmotic swelling reduces to zero when either 
\begin_inset Formula $c_{0}^{F}=0$
\end_inset

 or 
\begin_inset Formula $\bar{c}^{\ast}\to\infty$
\end_inset

.
 Therefore,
 entering any other values for 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 and 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset

 at the initial time point of an analysis produces an instantaneous,
 non-zero swelling pressure.
 Depending on the magnitude of this pressure relative to the solid matrix stiffness,
 the nonlinear analysis may not converge due to this sudden swelling.
 Therefore,
 it is recommended to prescribe a load curve for either <cF0> or <bosm>,
 to ease into the initial swelling prior to the application of other loading conditions.
\end_layout

\begin_layout Standard

\shape italic
Example (using units of mm,
 N,
 s,
 nmol,
 K)
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Donnan equilibrium">
\end_layout

\begin_layout LyX-Code
    <phiw0>0.8</phiw0>
\end_layout

\begin_layout LyX-Code
    <cF0 lc="1">1</cF0>
\end_layout

\begin_layout LyX-Code
    <bosm>300</bosm>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="ellipsoidal fiber distribution">
\end_layout

\begin_layout LyX-Code
    <ksi>0.01,0.01,0.01</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>3,3,3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,0</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,150</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-6</R>
\end_layout

\begin_layout LyX-Code
    <T>310</T>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ellipsoidal-Fiber-Distribution"

\end_inset


\end_layout

\begin_layout Standard
The material type for an ellipsoidal continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
ellipsoidal fiber distribution
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable compressible material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left({\beta_{1},\beta_{2},\beta_{3}}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left({\xi_{1},\xi_{2},\xi_{3}}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this fibrous material is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Lanir83,Ateshian07a,Ateshian09a"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta.
\]

\end_inset

Here,
 
\begin_inset Formula $I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\lambda_{n}$
\end_inset

,
 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction,
 in the reference configuration,
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

,
 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}$
\end_inset

,
 and 
\begin_inset Formula $H\left(.\right)$
\end_inset

is the unit step function that enforces the tension-only contribution.
\end_layout

\begin_layout Standard
The fiber stress is determined from a fiber strain energy function,
 
\begin_inset Formula 
\[
\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n},
\]

\end_inset

where in this material,
 
\begin_inset Formula 
\[
\Psi\left(\mathbf{n},I_{n}\right)=\xi\left(\mathbf{n}\right)\left(I_{n}-1\right)^{\beta\left(\mathbf{n}\right)}.
\]

\end_inset

The materials parameters 
\begin_inset Formula $\beta$
\end_inset

and 
\begin_inset Formula $\xi$
\end_inset

are assumed to vary ellipsoidally with 
\begin_inset Formula $\mathbf{n}$
\end_inset

,
 according to 
\begin_inset Formula 
\[
\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}
\end{aligned}
\,.
\]

\end_inset

The orientation of the material axis can be defined as explained in detail in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="ellipsoidal fiber distribution">
\end_layout

\begin_layout LyX-Code
    <ksi>10,
 12,
 15</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution Neo-Hookean
\begin_inset CommandInset label
LatexCommand label
name "subsec:EFD-Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Neo-Hookean material with an ellipsoidal continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
EFD neo-Hookean
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\beta_{1},\beta_{2},\beta_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\xi_{1},\xi_{2},\xi_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is given by,
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\boldsymbol{\sigma}_{NH}+\boldsymbol{\sigma}_{f}.
\]

\end_inset

Here,
 
\begin_inset Formula $\boldsymbol{\sigma}_{NH}$
\end_inset

 is the stress from the Neo-Hookean basis (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

),
 and 
\begin_inset Formula $\boldsymbol{\sigma}_{f}$
\end_inset

 is the stress contribution from the fibers (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Ellipsoidal-Fiber-Distribution"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="EFD neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E>1</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  <beta>4.5,4.5,4.5</beta>
\end_layout

\begin_layout LyX-Code
  <ksi>1,1,1</ksi>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal Fiber Distribution with Donnan Equilibrium Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:EFD-Donnan-Equilibrium"

\end_inset


\end_layout

\begin_layout Standard
The material type for a swelling pressure combined with an ellipsoidal continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
EFD Donnan equilibrium
\shape default

\begin_inset Quotes erd
\end_inset

.
 The swelling pressure is described by the equations for ideal Donnan equilibrium,
 assuming that the material is porous,
 with a charged solid matrix,
 and the external bathing environment consists of a salt solution of monovalent counter-ions.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phiw0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gel porosity (fluid volume fraction) in reference (strain-free) configuration,
 
\begin_inset Formula $\varphi_{0}^{w}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cF0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fixed-charge density in reference (strain-free) configuration,
 
\begin_inset Formula $c_{0}^{F}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<bosm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
external bath osmolarity,
 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\beta_{1},\beta_{2},\beta_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\left(\xi_{1},\xi_{2},\xi_{3}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is given by,
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\boldsymbol{\sigma}_{DE}+\boldsymbol{\sigma}_{f}\,.
\]

\end_inset


\begin_inset Formula $\boldsymbol{\sigma}_{f}$
\end_inset

 is the stress contribution from the fibers,
 as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

.
 
\begin_inset Formula $\boldsymbol{\sigma}_{DE}$
\end_inset

 is the stress from the Donnan equilibrium response,
 as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Donnan-Equilibrium-Swelling"
nolink "false"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example (using units of mm,
 N,
 s,
 nmol,
 K)
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="EFD Donnan equilibrium">
\end_layout

\begin_layout LyX-Code
  <phiw0>0.8</phiw0>
\end_layout

\begin_layout LyX-Code
  <cF0 lc="1">1</cF0>
\end_layout

\begin_layout LyX-Code
  <bosm>300</bosm>
\end_layout

\begin_layout LyX-Code
  <beta>3,3,3</beta>
\end_layout

\begin_layout LyX-Code
  <ksi>0.01,0.01,0.01</ksi>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,0</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,150</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-6</R>
\end_layout

\begin_layout LyX-Code
    <T>310</T>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fung Orthotropic Compressible
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fung-Orthotropic-Compressible"

\end_inset


\end_layout

\begin_layout Standard
The material type for unconstrained orthotropic Fung elasticity 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung79,Fung93"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Fung-ortho-compressible
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{1}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{2}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{3}$
\end_inset

 Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{12}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{23}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G_{31}$
\end_inset

 shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{12}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{23}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\nu_{31}$
\end_inset

 Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c$
\end_inset

 coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\kappa$
\end_inset

 bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The hyperelastic strain energy function is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian09"
literal "true"

\end_inset

,
 
\begin_inset Formula 
\[
\Psi=\frac{1}{2}c\left(e^{Q}-1\right)+U\left(J\right),
\]

\end_inset

where,
 
\begin_inset Formula 
\[
Q=c^{-1}\sum\limits_{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{E}^{2}+\sum\limits_{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{E}\right)\left(\mathbf{M}_{b}:\mathbf{E}\right)\right],
\]

\end_inset

and 
\begin_inset Formula 
\[
U\left(J\right)=\frac{\kappa}{2}\left(\ln J\right)^{2}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $\mathbf{E}=\left(\mathbf{C}-\mathbf{I}\right)/2$
\end_inset

 and 
\begin_inset Formula $\mathbf{M}_{a}=\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 defines the initial direction of material axis 
\begin_inset Formula $a$
\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

 on how to define the material axes for orthotropic materials.
 The Lam constants 
\begin_inset Formula $\mu_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3)$
\end_inset

 and 
\begin_inset Formula $\lambda_{ab}$
\end_inset

 (
\begin_inset Formula $a,b=1,2,3$
\end_inset

,
 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab})$
\end_inset

 are related to Young's moduli 
\begin_inset Formula $E_{a}$
\end_inset

,
 shear moduli 
\begin_inset Formula $G_{ab}$
\end_inset

 and Poisson's ratios 
\begin_inset Formula $\nu_{ab}$
\end_inset

 via 
\begin_inset Formula 
\[
\begin{aligned} & \left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]^{-1}\\
 & =\left[\begin{array}{cccccc}
\frac{1}{E_{1}} & -\frac{\nu_{12}}{E_{1}} & -\frac{\nu_{13}}{E_{1}} & 0 & 0 & 0\\
-\frac{\nu_{21}}{E_{2}} & \frac{1}{E_{2}} & -\frac{\nu_{23}}{E_{2}} & 0 & 0 & 0\\
-\frac{\nu_{31}}{E_{3}} & -\frac{\nu_{32}}{E_{3}} & \frac{1}{E_{3}} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{G_{12}} & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{G_{23}} & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{G_{31}}
\end{array}\right]
\end{aligned}
\]

\end_inset

The orthotropic Lam parameters should produce a positive definite stiffness matrix.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="3" type="Fung-ortho-compressible">
\end_layout

\begin_layout LyX-Code
  <E1>124</E1>
\end_layout

\begin_layout LyX-Code
  <E2>124</E2>
\end_layout

\begin_layout LyX-Code
  <E3>36</E3>
\end_layout

\begin_layout LyX-Code
  <G12>67</G12>
\end_layout

\begin_layout LyX-Code
  <G23>40</G23>
\end_layout

\begin_layout LyX-Code
  <G31>40</G31>
\end_layout

\begin_layout LyX-Code
  <v12>-0.075</v12>
\end_layout

\begin_layout LyX-Code
  <v23>0.87</v23>
\end_layout

\begin_layout LyX-Code
  <v31>0.26</v31>
\end_layout

\begin_layout LyX-Code
  <c>1</c>
\end_layout

\begin_layout LyX-Code
  <k>120</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Gent Compressible
\end_layout

\begin_layout Standard
The compressible Gent material is defined using the 
\emph on

\begin_inset Quotes eld
\end_inset

compressible Gent
\begin_inset Quotes erd
\end_inset


\emph default
 type string.
 It defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Jm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $J_{m}=I_{m}-1$
\end_inset

,
 with 
\begin_inset Formula $I_{m}$
\end_inset

 max value for first invariant 
\begin_inset Formula $I_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain energy of this material is defined as follows,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi_{r}=-\frac{\mu J_{m}}{2}\ln\left(1-\frac{I_{1}-3}{J_{m}}\right)+\frac{\kappa}{2}\left(\frac{J^{2}-1}{2}-\ln J\right)^{4}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\mu$
\end_inset

 is the shear modulus.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="compressible Gent">
\end_layout

\begin_layout LyX-Code
  <G>3.14</G>
\end_layout

\begin_layout LyX-Code
  <Jm>1.5</Jm>
\end_layout

\begin_layout LyX-Code
  <k>1e5</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:Holmes-Mow"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Holmes-Mow material 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

 is 
\shape italic
Holmes-Mow
\shape default
.
 This isotropic hyperelastic material has been used to represent the solid matrix of articular cartilage 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90,Ateshian97"
literal "true"

\end_inset

 and intervertebral disc 
\begin_inset CommandInset citation
LatexCommand citep
key "Iatridis98"
literal "true"

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stiffening coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The coupled hyperelastic strain-energy function for this material is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
W\left(I_{1},I_{2},J\right)=\frac{1}{2}c\left(e^{Q}-1\right),
\]

\end_inset

where 
\begin_inset Formula $I_{1}$
\end_inset

 and 
\begin_inset Formula $I_{2}$
\end_inset

 are the first and second invariants of the right Cauchy-Green tensor and 
\begin_inset Formula $J$
\end_inset

is the jacobian of the deformation gradient.
 Furthermore,
 
\begin_inset Formula 
\[
\begin{aligned}Q & =\frac{\beta}{\lambda+2\mu}\left[\left(2\mu-\lambda\right)\left(I_{1}-3\right)+\lambda\left(I_{2}-3\right)-\left(\lambda+2\mu\right)\ln J^{2}\right]\\
c & =\frac{\lambda+2\mu}{2\beta}
\end{aligned}
\,,
\]

\end_inset

and 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are the Lam parameters which are related to the more familiar Young's modulus and Poisson's ratio in the usual manner:
 
\begin_inset Formula 
\[
\begin{aligned}\lambda & =\frac{E\nu}{\left(1+\nu\right)\left(1-2\nu\right)}\\
\mu & =\frac{E}{2\left(1+\nu\right)}
\end{aligned}
\,.
\]

\end_inset


\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="3" type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
  <E>1</E>
\end_layout

\begin_layout LyX-Code
  <v>0.35</v>
\end_layout

\begin_layout LyX-Code
  <beta>0.25</beta>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Holzapfel-Gasser-Ogden Unconstrained
\begin_inset CommandInset label
LatexCommand label
name "subsec:HGO-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
The material type for the unconstrained Holzapfel-Gasser-Ogden material 
\begin_inset CommandInset citation
LatexCommand citep
key "Gasser06"
literal "true"

\end_inset

 is 
\emph on
HGO unconstrained
\emph default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus of ground matrix
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber exponential coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gamma>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber mean orientation angle 
\begin_inset Formula $\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
deg
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber dispersion
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy function is given by:
 
\begin_inset Formula 
\[
\begin{aligned}\Psi_{r} & =\frac{c}{2}\left(I_{1}-3\right)-c\ln J+\frac{k_{1}}{2k_{2}}\sum_{\alpha}\left(\exp\left(k_{2}\left\langle E_{\alpha}\right\rangle ^{2}\right)-1\right)\\
 & +\frac{K_{0}}{2}\left(\frac{J^{2}-1}{2}-\ln J\right)
\end{aligned}
\]

\end_inset

The fiber strain is
\begin_inset Formula 
\[
E_{\alpha}=\kappa\left(I_{1}-3\right)+\left(1-3\kappa\right)\left(I_{4\alpha}-1\right)
\]

\end_inset

where 
\begin_inset Formula $I_{1}=\tr\mathbf{C}$
\end_inset

 and 
\begin_inset Formula $I_{4\alpha}=\mathbf{a}_{\alpha r}\cdot\mathbf{C}\cdot\mathbf{a}_{\alpha r}$
\end_inset

.
 The Macaulay brackets around 
\begin_inset Formula $\left\langle \tilde{E}_{\alpha}\right\rangle $
\end_inset

 indicate that this term is zero when 
\begin_inset Formula $E_{\alpha}<0$
\end_inset

 and equal to 
\begin_inset Formula $E_{\alpha}$
\end_inset

 when this strain is positive.
\end_layout

\begin_layout Standard
There are two fiber families along the vectors 
\begin_inset Formula $\mathbf{a}_{\alpha r}$
\end_inset

 (
\begin_inset Formula $\alpha=1,2$
\end_inset

),
 lying in the 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2}\right\} $
\end_inset

 plane of the local material axes 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

,
 making an angle 
\begin_inset Formula $\pm\gamma$
\end_inset

 with respect to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

.
 Each fiber family has a dispersion 
\begin_inset Formula $\kappa$
\end_inset

,
 where 
\begin_inset Formula $0\le\kappa\le\frac{1}{3}$
\end_inset

.
 When 
\begin_inset Formula $\kappa=0$
\end_inset

 there is no fiber dispersion,
 implying that all the fibers in that family act along the angle 
\begin_inset Formula $\pm\gamma$
\end_inset

;
 the value 
\begin_inset Formula $\kappa=\frac{1}{3}$
\end_inset

 represents an isotropic fiber dispersion.
 All other intermediate values of 
\begin_inset Formula $\kappa$
\end_inset

 produce a 
\begin_inset Formula $\pi-$
\end_inset

periodic von Mises fiber distribution,
 as described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Gasser06"
literal "true"

\end_inset

.
 
\begin_inset Formula $c$
\end_inset

 is the shear modulus of the ground matrix;
 
\begin_inset Formula $k_{1}$
\end_inset

 is the fiber modulus and 
\begin_inset Formula $k_{2}$
\end_inset

 is the exponential coefficient.
\end_layout

\begin_layout Standard
Unlike the uncoupled Holzapfel-Gasser-Ogden material presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Holzapfel-Gasser-Ogden"
nolink "false"

\end_inset

,
 this unconstrained version does not enforce isochoric deformation.
 This unconstrained model may be used to describe the porous solid matrix of a biphasic or multiphasic tissue model,
 where pore volume may change in response to influx or efflux of interstitial fluid.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" type="HGO unconstrained">
\end_layout

\begin_layout LyX-Code
  <c>7.64</c>
\end_layout

\begin_layout LyX-Code
  <k1>996.6</k1>
\end_layout

\begin_layout LyX-Code
  <k2>524.6</k2>
\end_layout

\begin_layout LyX-Code
  <gamma>49.98</gamma>
\end_layout

\begin_layout LyX-Code
  <kappa>0.226</kappa>
\end_layout

\begin_layout LyX-Code
  <k>7.64e3</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Isotropic Elastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Isotropic-Elastic"

\end_inset


\end_layout

\begin_layout Standard
The material type for isotropic elasticity is 
\shape italic
isotropic elastic
\shape default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 This material replaces the now-obsolete 
\shape italic
linear elastic 
\shape default
and 
\shape italic
St.Venant-Kirchhoff
\shape default
 materials.
 These materials are still available for backward compatibility although it is recommended to use the 
\shape italic
isotropic elastic
\shape default
 material instead.
\end_layout

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material is an implementation of a hyperelastic constitutive material that reduces to the classical linear elastic material for small strains,
 but is objective for large deformations and rotations.
 The hyperelastic strain-energy function is given by:
 
\begin_inset Formula 
\[
W=\frac{1}{2}\lambda\left(\tr\mathbf{E}\right)^{2}+\mu\mathbf{E}:\mathbf{E}.
\]

\end_inset

Here,
 
\series bold

\begin_inset Formula $\mathbf{E}$
\end_inset


\series default
 is the Euler-Lagrange strain tensor and 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are the Lam parameters,
 which are related to the more familiar Young's modulus 
\begin_inset Formula $E$
\end_inset

 and Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 as follows:
 
\begin_inset Formula 
\[
\lambda=\frac{\nu E}{\left(1+\nu\right)\left(1-2\nu\right)},\mu=\frac{E}{2\left(1+\nu\right)}\,.
\]

\end_inset

It is often convenient to express the material properties using the bulk modulus 
\begin_inset Formula $K$
\end_inset

 and shear modulus 
\begin_inset Formula $G$
\end_inset

.
 To convert to Young's modulus and Poisson's ratio,
 use the following formulas:
 
\begin_inset Formula 
\[
E=\frac{9KG}{3K+G},\quad\nu=\frac{3K-2G}{6K+2G}\,.
\]

\end_inset


\shape italic
Remark:
 
\shape default
Note that although this material is objective,
 it is not advised to use this model for large strains since the behavior may be unphysical.
 For example,
 it can be shown that for a uniaxial tension the stress grows unbounded and the volume tends to zero for finite strains.
 Also for large strains,
 the Young's modulus and Poisson's ratio input values have little relationship to the actual material parameters.
 Therefore it is advisable to use this material only for small strains and/or large rotations.
 To represent isotropic elastic materials under large strain and rotation,
 it is best to use some of the other available nonlinear material models described in this chapter,
 such as the Holmes-Mow material in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Holmes-Mow"
nolink "false"

\end_inset

,
 the neo-Hookean material in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

,
 or the unconstrained Ogden material in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Ogden-Unconstrained"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="isotropic elastic">
\end_layout

\begin_layout LyX-Code
  <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
  <v>0.45</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Orthotropic Elastic
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthotropic-Elastic"

\end_inset


\end_layout

\begin_layout Standard
The material type for orthotropic elasticity is 
\begin_inset Quotes eld
\end_inset


\shape italic
orthotropic elastic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus in the x-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus in the y-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus in the z-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus in the xy-plane
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus in the yz-plane
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<G31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus in the xz-plane
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio between x- and y-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio between y- and z-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio between z- and x-direction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The stress-strain relation for this material is given by 
\begin_inset Formula 
\[
\left[\begin{array}{c}
E_{11}\\
E_{22}\\
E_{33}\\
2E_{23}\\
2E_{31}\\
2E_{12}
\end{array}\right]=\left[\begin{array}{cccccc}
1/E_{1} & -\nu_{21}/E_{2} & -\nu_{31}/E_{3} & 0 & 0 & 0\\
-\nu_{12}/E_{1} & 1/E_{2} & -\nu_{32}/E_{3} & 0 & 0 & 0\\
-\nu_{13}/E_{1} & -\nu_{23}/E_{2} & 1/E_{3} & 0 & 0 & 0\\
0 & 0 & 0 & 1/G_{23} & 0 & 0\\
0 & 0 & 0 & 0 & 1/G_{31} & 0\\
0 & 0 & 0 & 0 & 0 & 1/G_{12}
\end{array}\right]\left[\begin{array}{c}
T_{11}\\
T_{22}\\
T_{33}\\
T_{23}\\
T_{31}\\
T_{12}
\end{array}\right]
\]

\end_inset

Material axes may be specified as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="3" type="orthotropic elastic">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
    <a>0.866,0.5,0</a>
\end_layout

\begin_layout LyX-Code
    <d>-0.5,0.866,0</d>
\end_layout

\begin_layout LyX-Code
  </mat_axis>
\end_layout

\begin_layout LyX-Code
  <E1>1</E1>
\end_layout

\begin_layout LyX-Code
  <E2>2</E2>
\end_layout

\begin_layout LyX-Code
  <E3>3</E3>
\end_layout

\begin_layout LyX-Code
  <v12>0</v12>
\end_layout

\begin_layout LyX-Code
  <v23>0</v23>
\end_layout

\begin_layout LyX-Code
  <v31>0</v31>
\end_layout

\begin_layout LyX-Code
  <G12>1</G12>
\end_layout

\begin_layout LyX-Code
  <G23>1</G23>
\end_layout

\begin_layout LyX-Code
  <G31>1</G31>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Orthotropic CLE
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthotropic-CLE"

\end_inset


\end_layout

\begin_layout Standard
The material type for a conewise linear elastic (CLE) material with orthtropic symmetry is 
\shape italic
orthotropic CLE
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="12" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lp11>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tensile diagonal first Lam coefficient along direction 1 
\begin_inset Formula $\lambda_{+11}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lp22>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tensile diagonal first Lam coefficient along direction 2 
\begin_inset Formula $\lambda_{+22}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lp11>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tensile diagonal first Lam coefficient along direction 3 
\begin_inset Formula $\lambda_{+33}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lm11>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compressive diagonal first Lam coefficient along direction 1 
\begin_inset Formula $\lambda_{-11}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lm22>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compressive diagonal first Lam coefficient along direction 2 
\begin_inset Formula $\lambda_{-22}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lm33>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compressive diagonal first Lam coefficient along direction 3 
\begin_inset Formula $\lambda_{-33}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l12>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Off-diagonal first Lam coefficient in 1-2 plane 
\begin_inset Formula $\lambda_{12}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l23>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Off-diagonal first Lam coefficient in 2-3 plane 
\begin_inset Formula $\lambda_{23}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<l31>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Off-diagonal first Lam coefficient in 3-1 plane 
\begin_inset Formula $\lambda_{31}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Lam coefficient along direction 1 
\begin_inset Formula $\mu_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Lam coefficient along direction 2 
\begin_inset Formula $\mu_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Lam coefficient along direction 3 
\begin_inset Formula $\mu_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This bimodular elastic material is the orthotropic conewise linear elastic material described by Curnier et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Curnier94"
literal "true"

\end_inset

.
 It is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
\Psi_{r}=\sum\limits_{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{r}:\mathbf{E}^{2}+\frac{1}{2}\lambda_{aa}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)^{2}+\sum\limits_{\begin{array}{c}
b=1\\
b\ne a
\end{array}}^{3}\frac{1}{2}\lambda_{ab}\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{r}:\mathbf{E}\right)
\]

\end_inset

where 
\begin_inset Formula $\lambda_{ba}=\lambda_{ab}$
\end_inset

 and 
\begin_inset Formula 
\[
\lambda_{aa}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]=\begin{cases}
\lambda_{+aa} & \mathbf{A}_{a}^{r}:\mathbf{E}\geqslant0\\
\lambda_{-aa} & \mathbf{A}_{a}^{r}:\mathbf{E}<0
\end{cases},\quad a=1,2,3
\]

\end_inset

Here,
 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is the Lagrangian strain tensor and 
\begin_inset Formula $\mathbf{A}_{a}^{r}=\mathbf{a}_{a}^{r}\otimes\mathbf{a}_{a}^{r}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{a}_{a}^{r}$
\end_inset

 (
\begin_inset Formula $a=1,2,3)$
\end_inset

 are orthonormal vectors aligned with the material axes.
 This material response was originally formulated for infinitesimal strain analyses;
 its behavior under finite strains may not be physically realistic.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type=" orthotropic CLE">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <lp11>13.01</lp11>
\end_layout

\begin_layout LyX-Code
  <lp22>13.01</lp22>
\end_layout

\begin_layout LyX-Code
  <lp33>13.01</lp33>
\end_layout

\begin_layout LyX-Code
  <lm11>0.49</lm11>
\end_layout

\begin_layout LyX-Code
  <lm22>0.49</lm22>
\end_layout

\begin_layout LyX-Code
  <lm33>0.49</lm33>
\end_layout

\begin_layout LyX-Code
  <l12>0.66</l12>
\end_layout

\begin_layout LyX-Code
  <l23>0.66</l23>
\end_layout

\begin_layout LyX-Code
  <l31>0.66</l31>
\end_layout

\begin_layout LyX-Code
  <mu1>0.16</mu1>
\end_layout

\begin_layout LyX-Code
  <mu2>0.16</mu2>
\end_layout

\begin_layout LyX-Code
  <mu3>0.16</mu3>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Osmotic Pressure from Virial Expansion
\begin_inset CommandInset label
LatexCommand label
name "subsec:Osmotic-Pressure-Virial"

\end_inset


\end_layout

\begin_layout Standard
The material type for osmotic pressure from virial expansion is 
\begin_inset Quotes eld
\end_inset


\shape italic
osmotic virial expansion
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phiw0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid volume fraction in reference (strain-free) configuration,
 
\begin_inset Formula $\varphi_{r}^{w}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cr>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Concentration of interstitial solute causing the osmotic pressure (moles per volume of the mixture in the reference configuration),
 
\begin_inset Formula $c_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
First virial coefficient 
\begin_inset Formula $c_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default
/
\series bold
n
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second virial coefficient 
\begin_inset Formula $c_{2}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
n
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Third virial coefficient 
\begin_inset Formula $c_{3}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default

\begin_inset Formula $^{\mathrm{7}}$
\end_inset

/
\series bold
n
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-\pi\mathbf{I},
\]

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure,
 given by 
\begin_inset Formula 
\[
\pi=c_{1}c+c_{2}c^{2}+c_{3}c^{3},\quad c=\frac{\varphi_{r}^{w}c_{r}}{J-1+\varphi_{r}^{w}}\,,
\]

\end_inset


\begin_inset Formula $c$
\end_inset

 is the solute concentration in the current configuration,
 and 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume.
\end_layout

\begin_layout Standard
This osmotic swelling pressure in the interstitial fluid of a porous material represents an entropic mechanism whose magnitude is independent of the external bath osmolarity.
 Typically,
 this material should be used in a solid mixture where the swelling pressure is resisted by a solid matrix in tension.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<Material>
\end_layout

\begin_layout LyX-Code
  <material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
    <solid type="osmotic virial expansion">
\end_layout

\begin_layout LyX-Code
      <phiw0>0.8</phiw0>
\end_layout

\begin_layout LyX-Code
      <cr lc="1">100</cr>
\end_layout

\begin_layout LyX-Code
      <c1>2.436e-6</c1>
\end_layout

\begin_layout LyX-Code
      <c2>0</c2>
\end_layout

\begin_layout LyX-Code
      <c3>0</c3>
\end_layout

\begin_layout LyX-Code
    </solid>
\end_layout

\begin_layout LyX-Code
    <solid type="spherical fiber distribution"/>
\end_layout

\begin_layout LyX-Code
  </material>
\end_layout

\begin_layout LyX-Code
</Material>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1" type="smooth">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,0</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,1</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Natural Neo-Hookean
\begin_inset CommandInset label
LatexCommand label
name "subsec:Natural-Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
The material type for a natural Neo-Hookean material is 
\shape italic
natural neo-Hookean
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus 
\begin_inset Formula $E$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model describes an unconstrained Neo-Hookean material using the natural strain tensor 
\begin_inset CommandInset citation
LatexCommand citep
key "Criscione00"
literal "true"

\end_inset

.
 It has a non-linear stress-strain behavior,
 but reduces to the classical linear elasticity model for small strains 
\shape italic
and
\shape default
 small rotations.
 It is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
W=\frac{\kappa}{2}K_{1}^{2}+\mu K_{2}^{2},
\]

\end_inset

where 
\begin_inset Formula $\kappa$
\end_inset

 is the bulk modulus and 
\begin_inset Formula $\mu$
\end_inset

 is the shear modulus,
\begin_inset Formula 
\[
\kappa=\frac{E}{3\left(1-2\nu\right)}\,,\quad\mu=\frac{E}{2\left(1+\nu\right)}
\]

\end_inset

Here,
 
\begin_inset Formula $K_{1}$
\end_inset

 and 
\begin_inset Formula $K_{2}$
\end_inset

 are the first and second invariants of the left natural (Hencky) strain tensor 
\series bold

\begin_inset Formula $\boldsymbol{\eta}=\ln\mathbf{V}$
\end_inset


\series default
 where 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is the left stretch tensor in the polar decomposition 
\begin_inset Formula $\mathbf{F}=\mathbf{V}\cdot\mathbf{R}$
\end_inset

.
\end_layout

\begin_layout Standard
This material model uses a standard displacement-based element formulation,
 so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking.
 For this case,
 use the 
\shape italic
Mooney-Rivlin 
\shape default
material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="natural neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E>200e3</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Neo-Hookean
\begin_inset CommandInset label
LatexCommand label
name "subsec:Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Neo-Hookean material is 
\shape italic
neo-Hookean
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model describes an unconstrained Neo-Hookean material 
\begin_inset CommandInset citation
LatexCommand citep
key "Bonet97"
literal "true"

\end_inset

.
 It has a non-linear stress-strain behavior,
 but reduces to the classical linear elasticity model for small strains 
\shape italic
and
\shape default
 small rotations.
 It is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
W=\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln J+\frac{\lambda}{2}\left(\ln J\right)^{2}.
\]

\end_inset

Here,
 
\begin_inset Formula $I_{1}$
\end_inset

 and 
\begin_inset Formula $I_{2}$
\end_inset

 are the first and second invariants of the right Cauchy-Green deformation tensor 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
 and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient tensor.
 The relationship between the material parameters,
 E,
 and v,
 and the parameters used in the strain-energy function,
 is as follows.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mu=\dfrac{E}{2(1+\nu)}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda=\dfrac{\nu E}{(1+\nu)(1-2\nu)}
\]

\end_inset


\end_layout

\begin_layout Standard
This material model uses a standard displacement-based element formulation,
 so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking.
 For this case,
 use the 
\shape italic
Mooney-Rivlin 
\shape default
material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
  <v>0.45</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Coupled Mooney-Rivlin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Coupled-Mooney-Rivlin"

\end_inset


\end_layout

\begin_layout Standard
The coupled Mooney-Rivlin material describes an unconstrained formulation of the Mooney-Rivlin material.
 The material type for this material is 
\shape italic
coupled Mooney-Rivlin
\shape default
.
 The following material parameters can be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin c1 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin c2 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

Bulk-modulus
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy function is given by the following expression.
 
\begin_inset Formula 
\[
W=c_{1}\left(I_{1}-3\right)+c_{2}\left(I_{2}-3\right)-2\left(c_{1}+2c_{2}\right)\ln J+\frac{k}{2}\left(\ln J\right)^{2}
\]

\end_inset

Here,
 
\begin_inset Formula $I_{1}$
\end_inset

 and 
\begin_inset Formula $I_{2}$
\end_inset

 are the first and second invariants of the right Cauchy-Green deformation tensor 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
 and 
\begin_inset Formula $J$
\end_inset

 is the determinant of the deformation gradient tensor.
\end_layout

\begin_layout Standard
This material model uses a standard displacement-based element formulation,
 so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking.
 For (nearly-) incompressible materials,
 use the 
\shape italic
Mooney-Rivlin 
\shape default
material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mooney-Rivlin"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="coupled Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>1.0</c2>
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Coupled Veronda-Westmann
\begin_inset CommandInset label
LatexCommand label
name "subsec:Coupled-Veronda-Westmann"

\end_inset


\end_layout

\begin_layout Standard
The material type for the coupled Veronda-Westmann material is 
\shape italic
coupled Veronda-Westmann
\shape default
.
 The following material parameters can be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann c1 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann c2 parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

Bulk-modulus
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The coupled Veronda-Westmann material is an unconstrained formulation of the Veronda-Westmann material and is defined by the following strain-energy function.
 
\begin_inset Formula 
\[
W=c_{1}\left(e^{c_{2}\left(I_{1}-3\right)}-1\right)-\frac{c_{1}c_{2}}{2}\left(I_{2}-3\right)+\frac{\lambda}{2}\left(\ln J\right)^{2}
\]

\end_inset

Here,
 
\begin_inset Formula $I_{1}$
\end_inset

 and 
\begin_inset Formula $I_{2}$
\end_inset

 are the first and second invariants of the right Cauchy-Green deformation tensor 
\series bold
C
\series default
 and 
\begin_inset Formula $J$
\end_inset

is the determinant of the deformation gradient tensor.
\end_layout

\begin_layout Standard
This material model uses a standard displacement-based element formulation,
 so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking.
 For (nearly-) incompressible materials,
 use the 
\shape italic
Veronda-Westmann 
\shape default
material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Veronda-Westmann"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="coupled Veronda-Westmann">
\end_layout

\begin_layout LyX-Code
  <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
  <c2>1.0</c2>
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ogden Unconstrained
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ogden-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
This material describes an unconstrained hyperelastic Ogden material
\size small
 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo91"
literal "true"

\end_inset


\size default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c[n]>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coefficient of n
\begin_inset Formula $^{\mathrm{th}}$
\end_inset

 term,
 where n can range from 1 to 6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<m[n]>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponent of n
\begin_inset Formula $^{\mathrm{th\thinspace}}$
\end_inset

term,
 where n can range from 1 to 6 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cp>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk-like modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The hyperelastic strain energy function for this material is given in terms of the eigenvalues of the right or left stretch tensor:
 
\begin_inset Formula 
\[
W\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)=\frac{1}{2}c_{p}\left(J-1\right)^{2}+\sum\limits_{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\lambda_{1}^{m_{i}}+\lambda_{2}^{m_{i}}+\lambda_{3}^{m_{i}}-3-m_{i}\ln J\right).
\]

\end_inset

Here,
 
\begin_inset Formula $\lambda_{i}^{2}$
\end_inset

 are the eigenvalues of the right or left Cauchy deformation tensor,
 
\begin_inset Formula $c_{p}$
\end_inset

,
 
\begin_inset Formula $c_{i}$
\end_inset

 and 
\begin_inset Formula $m_{i}$
\end_inset

are material coefficients and 
\begin_inset Formula $N$
\end_inset

 ranges from 1 to 6.
 Any material parameters that are not specified by the user are assumed to be zero.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="Ogden unconstrained">
\end_layout

\begin_layout LyX-Code
  <m1>2.4</m1>
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <cp>2</cp>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Perfect Osmometer Equilibrium Osmotic Pressure
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perfect-Osmometer-Equilibrium"

\end_inset


\end_layout

\begin_layout Standard
The material type for a perfect osmometer equilibrium swelling pressure is 
\begin_inset Quotes eld
\end_inset


\shape italic
perfect osmometer
\shape default

\begin_inset Quotes erd
\end_inset

.
 The swelling pressure is described by the equations for a perfect osmometer,
 assuming that the material is porous,
 containing an interstitial solution whose solutes cannot be exchanged with the external bathing environment;
 similarly,
 solutes in the external bathing solution cannot be exchanged with the interstitial fluid of the porous material.
 Therefore,
 osmotic pressurization occurs when there is an imbalance between the interstitial and bathing solution osmolarities.
 Since osmotic swelling must be resisted by a solid matrix,
 this material is not stable on its own.
 It must be combined with an elastic material that resists the swelling,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phiw0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gel porosity (fluid volume fraction) in reference (strain-free) configuration,
 
\begin_inset Formula $\varphi_{0}^{w}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<iosm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
interstitial fluid osmolarity in reference configuration,
 
\begin_inset Formula $\bar{c}_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<bosm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
external bath osmolarity,
 
\begin_inset Formula $\bar{c}^{\ast}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this material is the stress from the perfect osmometer equilibrium response:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=-\pi\mathbf{I},
\]

\end_inset

where 
\begin_inset Formula $\pi$
\end_inset

 is the osmotic pressure,
 given by 
\begin_inset Formula 
\[
\pi=RT\left(\bar{c}-\bar{c}^{\ast}\right)\,.
\]

\end_inset


\begin_inset Formula $\bar{c}$
\end_inset

 is the interstitial fluid in the current configuration,
 related to the reference configuration via 
\begin_inset Formula 
\[
\bar{c}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}\bar{c}_{0}\,,
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the relative volume.
 The values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 and absolute temperature 
\begin_inset Formula $T$
\end_inset

 must be specified as global constants.
\end_layout

\begin_layout Standard
Though this material is porous,
 this is not a full-fledged biphasic material as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Materials"
nolink "false"

\end_inset

 for example.
 The behavior described by this material is strictly valid only after the transient response of interstitial fluid and solute fluxes has subsided.
\end_layout

\begin_layout Standard

\shape italic
Example (using units of mm,
 N,
 s,
 nmol,
 K)
\shape default
:
\end_layout

\begin_layout Standard
Hyperosmotic loading of a cell with a membrane-impermeant solute,
 starting from isotonic conditions.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="perfect osmometer">
\end_layout

\begin_layout LyX-Code
    <phiw0>0.8</ phiw0>
\end_layout

\begin_layout LyX-Code
    <iosm>300</cF0>
\end_layout

\begin_layout LyX-Code
    <bosm lc="1">1</bosm>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,300</loadpoint>
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,1500</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-6</R>
\end_layout

\begin_layout LyX-Code
    <T>310</T>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Porous Neo-Hookean
\begin_inset CommandInset label
LatexCommand label
name "subsec:Porous-Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
The material type for a porous neo-Hookean solid is 
\begin_inset Quotes eld
\end_inset


\emph on
porous neo-Hookean
\emph default

\begin_inset Quotes erd
\end_inset

.
 This material describes a porous neo-Hookean material with referential solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 (i.e.,
 porosity 
\begin_inset Formula $\varphi_{r}^{w}=1-\varphi_{r}^{s}$
\end_inset

).
 The pores are compressible but the skeleton is intrinsically incompressible.
 Thus,
 upon pore closure,
 the material behavior needs to switch from compressible to incompressible.
 This material may be used to model the porous solid matrix of a biphasic or multiphasic material,
 in which case it inherits the value of 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 from that parent material.
\end_layout

\begin_layout Standard
The material type for a porous Neo-Hookean material is 
\shape italic
porous neo-Hookean
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
 (
\begin_inset Formula $0\le\varphi_{r}^{s}<1$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model is derived from the following hyperelastic strain-energy function:
 
\begin_inset Formula 
\[
W=\frac{\mu}{2}\left(\bar{I}_{1}-3\right)-\mu\ln\bar{J}\,,
\]

\end_inset

where 
\begin_inset Formula $\bar{J}$
\end_inset

 represents the pore volume ratio,
 evaluated from
\begin_inset Formula 
\[
\bar{J}=\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\,,
\]

\end_inset

and 
\begin_inset Formula $\bar{I}_{1}=\text{tr}\bar{\mathbf{C}}$
\end_inset

,
 with
\begin_inset Formula 
\[
\bar{\mathbf{F}}=\left(\frac{\bar{J}}{J}\right)^{1/3}\mathbf{F}\,,\quad\bar{\mathbf{C}}=\bar{\mathbf{F}}^{T}\cdot\bar{\mathbf{F}}=\left(\frac{\bar{J}}{J}\right)^{2/3}\mathbf{C}\,,
\]

\end_inset

and 
\begin_inset Formula $\bar{J}=\det\bar{\mathbf{F}}$
\end_inset

.
 The porosity 
\begin_inset Formula $\varphi^{w}$
\end_inset

 in the current configuration evolves with the volume ratio 
\begin_inset Formula $J$
\end_inset

 according to
\begin_inset Formula 
\[
\varphi^{w}=\frac{J-1+\varphi_{r}^{w}}{J}=\frac{J-\varphi_{r}^{s}}{J}=\bar{J}\left(1-\varphi_{r}^{s}\right)\,.
\]

\end_inset

Thus,
 pore closure occurs when 
\begin_inset Formula $J=\varphi_{r}^{s}$
\end_inset

 and 
\begin_inset Formula $\bar{J}=0$
\end_inset

.
\end_layout

\begin_layout Standard
By comparison to a standard neo-Hookean material,
 this porous neo-Hookean material has an effective Young's modulus equal to
\begin_inset Formula 
\[
E=\frac{3\mu}{1+\frac{1}{2}\left(\varphi_{r}^{w}\right)^{2}}\,,
\]

\end_inset

and an effective Poisson's ratio equal to
\begin_inset Formula 
\[
\nu=\frac{1-\left(\varphi_{r}^{w}\right)^{2}}{2+\left(\varphi_{r}^{w}\right)^{2}}\,.
\]

\end_inset

Therefore,
 the two material properties that need to be provided are 
\begin_inset Formula $E$
\end_inset

 and the referential porosity 
\begin_inset Formula $\varphi_{r}^{s}=1-\varphi_{r}^{w}$
\end_inset

.
 Poisson's ratio in the limit of infinitesimal strains is dictated by the porosity according to the above formula.
 In particular,
 a highly porous material (
\begin_inset Formula $\varphi_{r}^{w}\to1$
\end_inset

) has an effective Poisson ratio that approaches zero (
\begin_inset Formula $\nu\to0$
\end_inset

) and 
\begin_inset Formula $E\to2\mu$
\end_inset

 in the range of infinitesimal strains.
 A low porosity material (
\begin_inset Formula $\varphi_{r}^{w}\to0$
\end_inset

) has 
\begin_inset Formula $\nu\to\frac{1}{2}$
\end_inset

 and 
\begin_inset Formula $E\to3\mu$
\end_inset

,
 which is the expected behavior of an incompressible neo-Hookean solid.
 Note that setting 
\begin_inset Formula $\varphi_{r}^{w}=0$
\end_inset

 (
\begin_inset Formula $\varphi_{r}^{s}=1$
\end_inset

) would not produce good numerical behavior,
 since the Cauchy stress in an incompressible material would need to be supplemented by a hydrostatic pressure term (a Lagrange multiplier that enforces the incompressibility constraint).
 Nevertheless,
 this compressible porous neo-Hookean material behaves well even for values of 
\begin_inset Formula $\varphi^{w}$
\end_inset

 as low as 
\begin_inset Formula $\sim0.015$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="porous neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <density>1.0</density>
\end_layout

\begin_layout LyX-Code
  <E>1.0</E>
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
</material>
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Lung Material 
\begin_inset CommandInset label
LatexCommand label
name "subsec:LungMaterial"

\end_inset


\end_layout

\begin_layout Standard
This is a material used for modeling human lung tissue as described by Birzle
\begin_inset CommandInset citation
LatexCommand citep
key "Birzle2019"
literal "false"

\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus,
 
\begin_inset Formula $E$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio,
 
\begin_inset Formula $\nu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Birzle-Wall c1 parameter,
 
\begin_inset Formula $c_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Birzle-Wall c3 parameter,
 
\begin_inset Formula $c_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<d1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Birzle-Wall exponential d1 parameter,
 
\begin_inset Formula $d_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<d3>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Birzle-Wall exponential d3 parameter,
 
\begin_inset Formula $d_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This model is derived from the following hyperelastic strain-energy function:
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
W=c\left(I_{1}-3\right)+\frac{c}{\beta}\left(I_{3}^{-\beta}-1\right)+c_{1}\left(I_{3}^{-\frac{1}{3}}I_{1}-3\right)^{d_{1}}+c_{3}\left(I_{3}^{\frac{1}{3}}-1\right)^{d_{3}},
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $I_{1}$
\end_inset

 and 
\begin_inset Formula $I_{2}$
\end_inset

 are the first and second invariants of the right Cauchy-Green deformation tensor 
\series bold

\begin_inset Formula $\mathbf{C}$
\end_inset


\series default
,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
c=\frac{E}{4\left(1+\nu\right)},
\]

\end_inset


\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\beta=\frac{\nu}{1-2\nu}.
\]

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="lung">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <E>1913.7</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3413</v>
\end_layout

\begin_layout LyX-Code
  <c1>278.2</c1>
\end_layout

\begin_layout LyX-Code
  <c3>5.766</c3>
\end_layout

\begin_layout LyX-Code
  <d1>3</d1>
\end_layout

\begin_layout LyX-Code
  <d3>6</d3>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Solid Mixture
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solid-Mixture"

\end_inset


\end_layout

\begin_layout Standard
The material type for a constrained mixture of solids is 
\begin_inset Quotes eld
\end_inset


\emph on
solid mixture
\emph default

\begin_inset Quotes erd
\end_inset

.
 This material describes a mixture of elastic solids that share the same reference configuration and same deformation gradient.
 It is a container for any combination of the unconstrained elastic materials described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Container tag for unconstrained solid material 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The mixture may consist of any number of solids.
 The stress tensor for the solid mixture is the sum of the stresses for all the solids.
\end_layout

\begin_layout Standard
Material axes may be optionally specified within the <material> level,
 as well as within each <solid>.
 Within the <material> level,
 these represent the local element axes relative to the global coordinate system.
 Within the <solid>,
 they represent local material axes relative to the element.
 If material axes are specified at both levels,
 they are properly compounded to produce local material axes relative to the global coordinate system.
 Material axes specified in the <ElementData> section are equivalent to a specification at the <material> level:
 they correspond to local element axes relative to the global system.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="ellipsoidal fiber distribution">
\end_layout

\begin_layout LyX-Code
    <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
      <a>0.8660254,
 0.5,
 0</a>
\end_layout

\begin_layout LyX-Code
      <d>0,0,1</d>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
    <ksi>5,
 1,
 1</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="ellipsoidal fiber distribution">
\end_layout

\begin_layout LyX-Code
    <mat_axis type="vector">
\end_layout

\begin_layout LyX-Code
      <a>0.8660254,-0.5,
 0</a>
\end_layout

\begin_layout LyX-Code
      <d>0,0,1</d>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
    <ksi>5,
 1,
 1</ksi>
\end_layout

\begin_layout LyX-Code
    <beta>2.5,
 3,
 3</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Spherical Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Spherical-Fiber-Distribution"

\end_inset


\end_layout

\begin_layout Standard
The material type for a spherical (isotropic) continuous fiber distribution is 
\begin_inset Quotes eld
\end_inset


\shape italic
spherical fiber distribution
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable compressible material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters 
\begin_inset Formula $\xi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this fibrous material is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Lanir83,Ateshian07a,Ateshian09a"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,.
\]

\end_inset

Here,
 
\begin_inset Formula $I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\lambda_{n}$
\end_inset

,
 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction,
 in the reference configuration,
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

,
 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}$
\end_inset

,
 and 
\begin_inset Formula $H\left(.\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
\end_layout

\begin_layout Standard
The fiber stress is determined from a fiber strain energy function,
 
\begin_inset Formula 
\[
\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}\,,
\]

\end_inset

where in this material,
 the fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi=\frac{\xi}{\alpha}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

,
 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

,
 and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
\end_layout

\begin_layout Standard
Note:
 In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

,
 this expressions produces a power law,
 
\begin_inset Formula 
\[
\lim\limits_{\alpha\to0}\Psi=\xi\left(I_{n}-1\right)^{\beta}
\]

\end_inset

Note:
 When 
\begin_inset Formula $\beta>2$
\end_inset

,
 the fiber modulus is zero at the strain origin (
\begin_inset Formula $I_{n}=1)$
\end_inset

.
 Therefore,
 use 
\begin_inset Formula $\beta>2$
\end_inset

 when a smooth transition in the stress is desired from compression to tension.
 
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="spherical fiber distribution">
\end_layout

\begin_layout LyX-Code
    <ksi>10</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>0</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>2.5</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Spherical Fiber Distribution from Solid-Bound Molecule
\begin_inset CommandInset label
LatexCommand label
name "subsec:Spherical-Fiber-Distribution-SBM"

\end_inset


\end_layout

\begin_layout Standard
The material type for a spherical (isotropic) continuous fiber distribution with fiber modulus dependent on solid-bound molecule content is 
\begin_inset Quotes eld
\end_inset


\shape italic
spherical fiber distribution sbm
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable compressible material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber modulus 
\begin_inset Formula $\xi_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gamma>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber modulus exponent 
\begin_inset Formula $\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<rho0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber mass density 
\begin_inset Formula $\rho_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sbm
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
index of solid-bound molecule 
\begin_inset Formula $\sigma$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Cauchy stress for this fibrous material is given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Lanir83,Ateshian07a,Ateshian09a"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,.
\]

\end_inset

Here,
 
\begin_inset Formula $I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}$
\end_inset

 is the square of the fiber stretch 
\begin_inset Formula $\lambda_{n}$
\end_inset

,
 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the unit vector along the fiber direction,
 in the reference configuration,
 which in spherical angles is directed along 
\begin_inset Formula $\left(\theta,\varphi\right)$
\end_inset

,
 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}$
\end_inset

,
 and 
\begin_inset Formula $H\left(.\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
\end_layout

\begin_layout Standard
The fiber stress is determined from a fiber strain energy function,
 
\begin_inset Formula 
\[
\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}\,,
\]

\end_inset

where in this material,
 the fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi=\frac{\xi}{\alpha}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

,
 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

,
 and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
 The fiber modulus is dependent on the solid-bound molecule referential density 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 according to the power law relation 
\begin_inset Formula 
\[
\xi=\xi_{0}\left(\frac{\rho_{r}^{\sigma}}{\rho_{0}}\right)^{\gamma}\,,
\]

\end_inset

where 
\begin_inset Formula $\rho_{0}$
\end_inset

 is the density at which 
\begin_inset Formula $\xi=\xi_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
This type of material references a solid-bound molecule that belongs to a multiphasic mixture.
 Therefore this material may only be used as the solid (or a component of the solid) in a multiphasic mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
nolink "false"

\end_inset

).
 The solid-bound molecule must be defined in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Bound-Molecules"
nolink "false"

\end_inset

) and must be included in the multiphasic mixture using a <solid_bound> tag.
 The parameter 
\shape italic
sbm
\shape default
 must refer to the global index of that solid-bound molecule.
 The value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 is specified within the <solid_bound> tag.
 If a chemical reaction is defined within that multiphasic mixture that alters the value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

,
 lower and upper bounds may be specified for this referential density within the <solid_bound> tag to prevent 
\begin_inset Formula $\xi$
\end_inset

 from reducing to zero or achieving excessively elevated values.
\end_layout

\begin_layout Standard
Note:
 In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

,
 the expression for 
\begin_inset Formula $\Psi$
\end_inset

 produces a power law,
 
\begin_inset Formula 
\[
\lim\limits_{\alpha\to0}\Psi=\xi\left(I_{n}-1\right)^{\beta}
\]

\end_inset

Note:
 When 
\begin_inset Formula $\beta>2$
\end_inset

,
 the fiber modulus is zero at the strain origin (
\begin_inset Formula $I_{n}=1)$
\end_inset

.
 Therefore,
 use 
\begin_inset Formula $\beta>2$
\end_inset

 when a smooth transition in the stress is desired from compression to tension.
 
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<solid type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="spherical fiber distribution sbm">
\end_layout

\begin_layout LyX-Code
    <alpha>0</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>2.5</beta>
\end_layout

\begin_layout LyX-Code
    <ksi0>10</ksi0>
\end_layout

\begin_layout LyX-Code
    <gamma>2</gamma>
\end_layout

\begin_layout LyX-Code
    <rho0>1</rho0>
\end_layout

\begin_layout LyX-Code
    <sbm>1</sbm>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Coupled Transversely Isotropic Mooney-Rivlin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Coupled-Transversely-Isotropic-MR"

\end_inset


\end_layout

\begin_layout Standard
This material describes a transversely isotropic Mooney-Rivlin material using a fully-coupled formulation.
 It is define through the 
\shape italic
coupled trans-iso Mooney-Rivlin 
\shape default
material type.
 The following material parameters must be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin 
\begin_inset Formula $c_{1}$
\end_inset

 parameter.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mooney-Rivlin 
\begin_inset Formula $c_{2}$
\end_inset

 parameter.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential multiplier 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber scale factor
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber modulus in linear region
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lam_max
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum fiber straightening stretch 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk-like modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy function for this constitutive model is defined by 
\begin_inset Formula 
\[
W=c_{1}\left(I_{1}-3\right)+c_{2}\left(I_{2}-3\right)-2\left(c_{1}+2c_{2}\right)\ln J+F\left(\lambda\right)+U\left(J\right)
\]

\end_inset

The first three terms define the coupled Mooney-Rivlin matrix response.
 The third term is the fiber response which is a function of the fiber stretch 
\begin_inset Formula $\lambda$
\end_inset

 and is defined as in 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"
literal "true"

\end_inset

.
 For 
\begin_inset Formula $U$
\end_inset

,
 the following form is chosen in FEBio.
 
\begin_inset Formula 
\[
U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

is the Jacobian of the deformation.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="coupled trans-iso Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.1</c2>
\end_layout

\begin_layout LyX-Code
  <c3>1</c3>
\end_layout

\begin_layout LyX-Code
  <c4>1</c4>
\end_layout

\begin_layout LyX-Code
  <c5>1.34</c5>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.3</lam_max>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Coupled Transversely Isotropic Veronda-Westmann
\begin_inset CommandInset label
LatexCommand label
name "subsec:Coupled-Transversely-Isotropic-VW"

\end_inset


\end_layout

\begin_layout Standard
This material describes a transversely isotropic Veronda-Westmann material using a fully-coupled formulation.
 It is define through the 
\shape italic
coupled trans-iso Veronda-Westmann 
\shape default
material type.
 The following material parameters must be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann 
\begin_inset Formula $c_{1}$
\end_inset

 parameter.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Veronda-Westmann 
\begin_inset Formula $c_{2}$
\end_inset

 parameter.
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential multiplier 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber scale factor
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fiber modulus in linear region
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lam_max
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum fiber straightening stretch 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk-like modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy function for this constitutive model is defined by 
\begin_inset Formula 
\[
W=c_{1}\left(e^{c_{2}\left(I_{1}-3\right)}-1\right)-\frac{1}{2}c_{1}c_{2}\left(I_{2}-3\right)+F\left(\lambda\right)+U\left(J\right)\,.
\]

\end_inset

The first two terms define the coupled Veronda-Westmann matrix response.
 The third term is the fiber response which is a function of the fiber stretch 
\begin_inset Formula $\lambda$
\end_inset

 and is defined as in 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"
literal "true"

\end_inset

.
 For 
\begin_inset Formula $U$
\end_inset

,
 the following form is chosen in FEBio.
 
\begin_inset Formula 
\[
U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

is the Jacobian of the deformation.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="coupled trans-iso Veronda-Westmann">
\end_layout

\begin_layout LyX-Code
  <c1>1</c1>
\end_layout

\begin_layout LyX-Code
  <c2>0.1</c2>
\end_layout

\begin_layout LyX-Code
  <c3>1</c3>
\end_layout

\begin_layout LyX-Code
  <c4>1</c4>
\end_layout

\begin_layout LyX-Code
  <c5>1.34</c5>
\end_layout

\begin_layout LyX-Code
  <lam_max>1.3</lam_max>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Large Poisson's Ratio Ligament
\begin_inset CommandInset label
LatexCommand label
name "subsec:Large-Poisson's-Ratio"

\end_inset


\end_layout

\begin_layout Standard
This material describes a coupled,
 transversely isotropic material that will conform to a particular Poisson's ratio when stretched along the fiber direction 
\begin_inset CommandInset citation
LatexCommand citep
key "Swedberg2014"
literal "true"

\end_inset

.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber coefficient 
\begin_inset Formula $c_{\mathrm{1}}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c2 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber coefficient 
\begin_inset Formula $c_{\mathrm{2}}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mu
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Matrix coefficient 
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
v0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio parameter 
\begin_inset Formula $v_{\mathrm{0}}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
m
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio parameter 
\begin_inset Formula $m$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Volumetric penalty coefficient 
\begin_inset Formula $\kappa$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain energy function for this constitutive model is a three part expression:
 
\begin_inset Formula 
\[
W=W_{\text{fiber}}+W_{\text{matrix}}+W_{\text{vol}},
\]

\end_inset

where:
 
\begin_inset Formula 
\[
\begin{aligned}W_{\text{fiber}} & =\frac{1}{2}\frac{c_{1}}{c_{2}}\left(e^{c_{2}\left({\lambda-1}\right)^{2}-1}\right),\\
W_{\text{matrix}} & =\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln\left(\sqrt{I_{3}}\right),\\
W_{\text{vol}} & =\frac{\kappa}{2}\left(\ln\left(\frac{I_{5}-I_{1}I_{4}+I_{2}}{I_{4}^{2(m-v_{0})}e^{-4m\left(\lambda-1\right)}}\right)\right)^{2}.
\end{aligned}
\]

\end_inset

In the equations above,
 
\begin_inset Formula $\lambda$
\end_inset

 is the stretch ratio of the material along the fiber direction.
 The desired Poisson's ratio must first be selected based on available data for uniaxial tension along the fiber direction.
 The function with which to fit the Poisson's ratio data is:
 
\begin_inset Formula 
\[
v=-\frac{\lambda^{m-v_{0}}e^{-m\left(\lambda-1\right)}-1}{\lambda-1}\,.
\]

\end_inset

The volumetric penalty coefficient 
\begin_inset Formula $\kappa$
\end_inset

 must be selected to be large enough to enforce the Poisson's function above.
 If this material is to be used in a biphasic representation,
 
\begin_inset Formula $\kappa$
\end_inset

 must be selected based on experimental stress-relaxation data,
 since 
\begin_inset Formula $\kappa$
\end_inset

 has an effect on the biphasic behavior of the material.
 Once 
\begin_inset Formula $\kappa$
\end_inset

,
 
\begin_inset Formula $v_{0}$
\end_inset

,
 and 
\begin_inset Formula $m$
\end_inset

 are chosen,
 
\begin_inset Formula $c_{\mathrm{1}}$
\end_inset

,
 
\begin_inset Formula $c_{\mathrm{2}}$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 should be selected by fitting the stress-strain behavior of the material to experimental data.
 The Cauchy stress of the material is given by:
 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\frac{2}{J}\left(\left(W_{1}+I_{1}W_{2}\right)\mathbf{B}-W_{2}\mathbf{B}^{2}+W_{3}\left(I_{3}\mathbf{1}\right)+W_{4}I_{4}\left(\mathbf{a}\otimes\mathbf{a}\right)+W_{5}I_{4}\left(\mathbf{a}\otimes\mathbf{a}\cdot\mathbf{B}+\mathbf{B}\cdot\mathbf{a}\otimes\mathbf{a}\right)\right)
\]

\end_inset

where 
\begin_inset Formula $J$
\end_inset

 is the jacobian of the deformation gradient 
\begin_inset Formula $\mathbf{F}$
\end_inset

,
 
\series bold

\begin_inset Formula $\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset


\series default
 is the left Cauchy-Green deformation tensor,
 
\series bold

\begin_inset Formula $\mathbf{1}$
\end_inset


\series default
 is the 
\begin_inset Formula $3\times3$
\end_inset

 identity tensor
\series bold
,
 
\begin_inset Formula $\mathbf{a}$
\end_inset

 
\series default
is the fiber orientation vector in the deformed configuration.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="PRLig">
\end_layout

\begin_layout LyX-Code
  <c1>90</c1>
\end_layout

\begin_layout LyX-Code
  <c2>160</c2>
\end_layout

\begin_layout LyX-Code
  <mu>0.025</mu>
\end_layout

\begin_layout LyX-Code
  <v0>5.85</v0>
\end_layout

\begin_layout LyX-Code
  <m>-100</m>
\end_layout

\begin_layout LyX-Code
  <k>1.55</k>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Shenoy-Wang material
\end_layout

\begin_layout Standard
This material implements the constitutive model by Wang et al.
 (Biophysical Journal,
 107,
 2014,
 pp:2592 - 2603),
 which proposes a mechanism for long-range force transmission in fibrous matrices enabled by tension-driven alignment of fibers.
 
\end_layout

\begin_layout Standard
It defines the following parameters.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mu
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix shear modulus 
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
k
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
matrix bulk modulus 
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ef
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stiffness modulus 
\begin_inset Formula $E_{f}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lam_c
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transition point 
\begin_inset Formula $\lambda_{c}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lam_t
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transition interval size 
\begin_inset Formula $\lambda_{t}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strain hardening exponent 
\emph on
n
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strain hardening exponent 
\emph on
m
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The strain-energy density function is given by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
W=W_{\text{b}}+W_{\text{f}},
\]

\end_inset

where:
 
\begin_inset Formula 
\[
\begin{aligned}W_{\text{b}} & =\frac{\mu}{2}\left(\overline{I}_{1}-3\right)+\frac{\kappa}{2}\left(J-1\right)^{2},\\
W_{\text{f}} & =\stackrel[a=1]{3}{\sum}f\left(\lambda_{a}\right),
\end{aligned}
\]

\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset Formula $f$
\end_inset

is defined via its derivative,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial f}{\partial\lambda_{a}}\left(\lambda_{a}\right)=\begin{cases}
0, & \lambda_{a}<\lambda_{1}\\
\frac{E_{f}\left(\frac{\lambda_{a}-\lambda_{1}}{\lambda_{2}-\lambda_{1}}\right)^{n}\left(\lambda_{a}-\lambda_{1}\right)}{n+1}, & \lambda_{1}\leq\lambda_{a}<\lambda_{2}\\
E_{f}\left[\frac{\lambda_{2}-\lambda_{1}}{n+1}+\frac{\left(1+\lambda_{a}-\lambda_{2}\right)^{m+1}-1}{m+1}\right], & \lambda_{a}\geq\lambda_{2}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
Finally,
 the parameters 
\begin_inset Formula $\lambda_{1}$
\end_inset

and 
\begin_inset Formula $\lambda_{2}$
\end_inset

are given as follows.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\lambda_{1} & =\lambda_{c}-\lambda_{t}/2\\
\lambda_{2} & =\lambda_{c}+\lambda_{t}/2
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="Shenoy">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <mu>0.7692</mu>
\end_layout

\begin_layout LyX-Code
  <k>1.667</k>
\end_layout

\begin_layout LyX-Code
  <Ef>134.6</Ef>
\end_layout

\begin_layout LyX-Code
  <lam_c>1.02</lam_c>
\end_layout

\begin_layout LyX-Code
  <lam_t>0.255</lam_t>
\end_layout

\begin_layout LyX-Code
  <n>5</n>
\end_layout

\begin_layout LyX-Code
  <m>30</m>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Fibers
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fibers"

\end_inset


\end_layout

\begin_layout Standard
Fiber materials are used to model one-dimensional structures oriented along a unit vector.
 The associated strain energy density is a function of the normal strain along that vector.
 These fiber models are constructed such that the strain energy is non-zero only when the fiber is in tension,
 under the idealized assumption that fibers do not sustain any load in compression.
 This assumption produces an inherent instability in the material response of fibers,
 therefore such models must be combined with elastic materials that can sustain compression and tension,
 thus serving as models of a ground matrix.
\end_layout

\begin_layout Standard
FEBio accommodates fiber models that can be combined with unconstrained or uncoupled models of the ground matrix.
 Historically,
 unconstrained models of a ground matrix have been combined with unconstrained fiber models,
 whereas uncoupled models of a ground matrix have been combined with uncoupled fiber models.
 The manual sections presented below follow this conventional approach.
\end_layout

\begin_layout Standard
However,
 it should be noted that some authors have expressed concerns about using uncoupled fiber formulations in fiber-matrix material models 
\begin_inset CommandInset citation
LatexCommand citep
key "Sansour08,Helfenstein10,Gultekin19"
literal "true"

\end_inset

,
 due to two fundamental concerns:
 When highly nonlinear fibers become much stiffer than the ground matrix upon loading,
 it may become difficult to enforce an isochoric deformation,
 as would be expected in an uncoupled formulation.
 Furthermore,
 in an uncoupled formulation,
 the strain is split into its deviatoric (isochoric) and volumetric parts and the fiber strain is evaluated only from the deviatoric part.
 This deviatoric fiber strain is not the true fiber strain,
 yet it is used to determine whether the fiber is in tension.
 These factors may result in non-physical deformations,
 as described by Helfenstein et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Helfenstein10"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The solution advocated by these investigators has been to use an uncoupled formulation for the ground matrix only,
 while the fiber models should remain unconstrained 
\begin_inset CommandInset citation
LatexCommand citep
key "Sansour08,Helfenstein10,Gultekin19"
literal "true"

\end_inset

.
 This can be done in FEBio by using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

,
 where the material representing the ground matrix is taken from the list of uncoupled materials in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

,
 whereas fiber models are taken from the list of unconstrained models in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Fiber-Models"
nolink "false"

\end_inset

 or Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Continuous-Fiber"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Unconstrained Fiber Models
\begin_inset CommandInset label
LatexCommand label
name "subsec:Unconstrained-Fiber-Models"

\end_inset


\end_layout

\begin_layout Standard
Since fibers can only sustain tension,
 the materials listed here are not stable on their own.
 They must be combined with a stable material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

,
 within a <solid> tag.
 These fiber models may also be used in continuous fiber distribution models as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Continuous-Fiber"
nolink "false"

\end_inset

,
 within a <fibers> tag.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Exponential-Power Law
\begin_inset CommandInset label
LatexCommand label
name "subsec:fiber-exp-pow"

\end_inset


\end_layout

\begin_layout Standard
The material type for a single fiber with an exponential-power law is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-exp-pow
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable compressible material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\xi,$
\end_inset

 representing a measure of the fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha,$
\end_inset

 coefficient of exponential argument
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta,$
\end_inset

 power of exponential argument
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda_{0},$
\end_inset

 stretch threshold for tensile response
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The Cauchy stress for this fibrous material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=H\left(I_{n}-I_{0}\right)\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n},
\]

\end_inset

where 
\begin_inset Formula $I_{n}=\lambda_{n}^{2}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}$
\end_inset

 is the square of the fiber stretch,
 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}/\lambda_{n}$
\end_inset

,
 
\begin_inset Formula $I_{0}=\lambda_{0}^{2}$
\end_inset

 is the square of the stretch threshold for the tensile response (
\begin_inset Formula $\lambda_{0}=1$
\end_inset

 by default) and 
\begin_inset Formula $H\left(.\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution.
 The fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{n}-I_{0}\right)^{\beta}\right]-1\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

,
 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

,
 and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
\end_layout

\begin_layout Standard
Note:
 In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

,
 this expressions produces a power law,
 
\begin_inset Formula 
\[
\lim\limits_{\alpha\to0}\,\Psi=\frac{\xi}{\beta}\left(I_{n}-I_{0}\right)^{\beta}
\]

\end_inset

Note:
 When 
\begin_inset Formula $\beta>2$
\end_inset

,
 the fiber modulus is zero at the strain origin (
\begin_inset Formula $I_{n}=I_{0})$
\end_inset

.
 Therefore,
 use 
\begin_inset Formula $\beta>2$
\end_inset

 when a smooth transition in the stress is desired from compression to tension.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Single fiber oriented along 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 embedded in a neo-Hookean ground matrix.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
        <theta>0</theta>
\end_layout

\begin_layout LyX-Code
        <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Two fibers in the plane orthogonal to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 oriented at 25 degrees relative to 
\begin_inset Formula $\mathbf{e}_{3}$
\end_inset

,
 embedded in a neo-Hookean ground matrix.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1000.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.45</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <fiber type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>90</theta>
\end_layout

\begin_layout LyX-Code
      <phi>25</phi>
\end_layout

\begin_layout LyX-Code
    </fiber>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <fiber type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>-90</theta>
\end_layout

\begin_layout LyX-Code
      <phi>25</phi>
\end_layout

\begin_layout LyX-Code
    </fiber>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Neo-Hookean Law
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-with-Neo-Hookean"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-NH
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu,$
\end_inset

 representing a measure of the fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi_{n}\left(I_{n}\right)=\frac{\mu}{4}\left(I_{n}-1\right)^{2}\,,
\]

\end_inset

where 
\begin_inset Formula $\mu>0$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a continuous fiber distribution (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Continuous-Fiber"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<fibers type="fiber-NH">
\end_layout

\begin_layout LyX-Code
  <mu>1</mu>
\end_layout

\begin_layout LyX-Code
</fibers>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Natural Neo-Hookean Law
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-with-Neo-Hookean-1"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-natural-NH
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\xi,$
\end_inset

 fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda_{0},$
\end_inset

 stretch threshold for tensile response
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi_{n}\left(\lambda_{n}\right)=\frac{\xi}{2}H\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)\left(\ln\frac{\lambda_{n}}{\lambda_{0}}\right)^{2}\,,
\]

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

 and 
\begin_inset Formula $\lambda_{0}\ge1$
\end_inset

.
 The tensile response engages at the tensile stretch ratio 
\begin_inset Formula $\lambda_{0}$
\end_inset

 (
\begin_inset Formula $\lambda_{0}=1$
\end_inset

 by default).The natural (logarithmic or Hencky) strain along the fiber is 
\begin_inset Formula $\ln\lambda_{n}$
\end_inset

,
 whereas 
\begin_inset Formula $\ln\frac{\lambda_{n}}{\lambda_{0}}=\ln\lambda_{n}-\ln\lambda_{0}$
\end_inset

 is the natural strain relative to the tensile stretch threshold.
 This model produces a stress response which varies linearly with the natural strain.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a solid mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>0.13</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-natural-NH">
\end_layout

\begin_layout LyX-Code
    <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
    <lam0>1.25</lam0>
\end_layout

\begin_layout LyX-Code
    <fiber type="vector">0,0,1</fiber>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Toe-Linear Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Pow-Linear"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-pow-linear
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,$
\end_inset

 the fiber modulus in the linear range (
\begin_inset Formula $E\geqslant0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta,$
\end_inset

 the power-law exponent in the toe region (
\begin_inset Formula $\beta\geqslant2)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda_{0},$
\end_inset

 the stretch ratio when the toe region transitions to the linear region (
\begin_inset Formula $\lambda_{0}>1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi_{n}\left(I_{n}\right)=\begin{cases}
0 & I_{n}<1\\
\frac{\xi}{\beta}\left(I_{n}-1\right)^{\beta} & 1\leqslant I_{n}\leqslant I_{0}\\
B\left(I_{n}-I_{0}\right)-E\left(I_{n}^{1/2}-I_{0}^{1/2}\right)+\frac{\xi}{\beta}\left(I_{0}-1\right)^{\beta} & I_{0}<I_{n}
\end{cases}\,,
\]

\end_inset

where 
\begin_inset Formula $I_{0}=\lambda_{0}^{2}$
\end_inset

,
 
\begin_inset Formula 
\[
\xi=\frac{E}{4\left(\beta-1\right)}I_{0}^{-3/2}\left(I_{0}-1\right)^{2-\beta},\,B=\xi\left(I_{0}-1\right)^{\beta-1}+\frac{E}{2}I_{0}^{-1/2}
\]

\end_inset

For this material type,
 the fiber elasticity at the strain origin reduces to zero unless 
\begin_inset Formula $\beta=2$
\end_inset

.
 
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a solid mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<solid type="fiber-pow-linear">
\end_layout

\begin_layout LyX-Code
  <fiber type="angles">
\end_layout

\begin_layout LyX-Code
    <theta>20</center>
\end_layout

\begin_layout LyX-Code
    <phi>90</phi>
\end_layout

\begin_layout LyX-Code
  </fiber>
\end_layout

\begin_layout LyX-Code
  <E>1</E>
\end_layout

\begin_layout LyX-Code
  <beta>2.5</beta>
\end_layout

\begin_layout LyX-Code
  <lam0>1.06</lam0>
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Exp-Pow-Linear Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Exp-Pow-Linear"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-exp-pow-linear
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,$
\end_inset

 the fiber modulus in the linear range (
\begin_inset Formula $E\geqslant0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha,$
\end_inset

 coefficient of exponential argument
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta,$
\end_inset

 the power-law exponent in the toe region (
\begin_inset Formula $\beta\geqslant2)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda_{0},$
\end_inset

 the stretch ratio when the toe region transitions to the linear region (
\begin_inset Formula $\lambda_{0}>1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\Psi_{n}=\begin{cases}
0 & I_{n}<1\\
\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right) & 1\le I_{n}\le I_{0}\\
B\left(I_{n}-I_{0}\right)-E\left(I_{n}^{1/2}-I_{0}^{1/2}\right)+\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{0}-1\right)^{\beta}\right]-1\right) & I_{n}>I_{0}
\end{cases}
\]

\end_inset

where 
\begin_inset Formula $I_{0}=\lambda_{0}^{2}$
\end_inset

,
 
\begin_inset Formula 
\[
\xi=\frac{E\left(I_{0}-1\right)^{2-\beta}\exp\left[-\alpha\left(I_{0}-1\right)^{\beta}\right]}{4I_{0}^{3/2}\left(\beta-1+\alpha\beta\left(I_{0}-1\right)^{\beta}\right)}
\]

\end_inset

and
\begin_inset Formula 
\[
B=E\frac{2I_{0}\left(\beta-\frac{1}{2}+\alpha\beta\left(I_{0}-1\right)^{\beta}\right)-1}{4I_{0}^{3/2}\left(\beta-1+\alpha\beta\left(I_{0}-1\right)^{\beta}\right)}
\]

\end_inset


\end_layout

\begin_layout Standard
For this material type,
 the fiber elasticity at the strain origin reduces to zero unless 
\begin_inset Formula $\beta=2$
\end_inset

.
 This model reduces to 
\begin_inset Quotes eld
\end_inset


\emph on
fiber-pow-linear
\emph default

\begin_inset Quotes erd
\end_inset

 when 
\begin_inset Formula $\alpha=0$
\end_inset

.
 Alternatively,
 in the limit when 
\begin_inset Formula $I_{0}=1$
\end_inset

,
 the above parameters reduce to 
\begin_inset Formula $\xi=0$
\end_inset

 and 
\begin_inset Formula $B=E/2$
\end_inset

 and the strain energy density takes the quadratic form 
\begin_inset Formula 
\[
\Psi_{n}=\begin{cases}
0 & I_{n}<1\\
\frac{E}{2}\left(I_{n}^{1/2}-1\right)^{2} & I_{n}>1
\end{cases}
\]

\end_inset

where 
\begin_inset Formula $I_{n}^{1/2}=\lambda_{n}$
\end_inset

 is the stretch ratio along the fiber.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a solid mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<solid type="fiber-exp-pow-linear">
\end_layout

\begin_layout LyX-Code
 <E>1080</E>
\end_layout

\begin_layout LyX-Code
 <alpha>1400</alpha>
\end_layout

\begin_layout LyX-Code
 <beta>2.73</beta>
\end_layout

\begin_layout LyX-Code
 <lam0>1.012</lam0>
\end_layout

\begin_layout LyX-Code
 <fiber type="vector">0,0,1</fiber>
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber Exp-Linear
\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-exp-linear
\shape default

\begin_inset Quotes erd
\end_inset

.
 This constitutive fiber model has an initial exponential rise and then grows linearly after a user-specified stretch transition point.
 This fiber material is based on the trans-iso Mooney-Rivlin model introduced in 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"
literal "false"

\end_inset

.
 This material by itself is not stable,
 so it is recommend to use it as part of a solid mixture.
 
\end_layout

\begin_layout Standard
The strain energy is as follows:
 
\begin_inset Formula 
\[
F_{2}\left(\lambda\right)=\begin{cases}
0 & \lambda<1\\
C_{3}\left(e^{-C_{4}}\left(\Ei\left(C_{4}\lambda\right)-\Ei\left(C_{4}\right)\right)-\ln\lambda\right) & 1\le\lambda<\lambda_{m}\\
C_{5}\left(\lambda-\lambda_{m}\right)+C_{6}\ln\frac{\lambda}{\lambda_{m}}+C_{3}\left(e^{-C_{4}}\Ei\left(C_{4}\lambda_{m}\right)-\Ei\left(C_{4}\right)-\ln\lambda_{m}\right) & \lambda_{m}\le\lambda
\end{cases}\,
\]

\end_inset

where 
\begin_inset Formula $\Ei\left(\cdot\right)$
\end_inset

 is the exponential integral function.
 The resulting fiber stress is evaluated from 
\begin_inset Formula 
\[
\lambda\frac{\partial F_{2}}{\partial\lambda}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\lambda-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\lambda+C_{6} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $\lambda_{m}$
\end_inset

 is the stretch at which the fibers are straightened,
 
\begin_inset Formula $C_{3}$
\end_inset

scales the exponential stresses,
 
\begin_inset Formula $C_{4}$
\end_inset

 is the rate of uncrimping of the fibers,
 and 
\begin_inset Formula $C_{5}$
\end_inset

is the modulus of the straightened fibers.
 
\begin_inset Formula $C_{6}$
\end_inset

 is determined from the requirement that the stress is continuous at 
\begin_inset Formula $\lambda_{m}$
\end_inset

 (see below).
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stress coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c4>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber uncrimping coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c5>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modulus of straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
While this material enforces continuity of the strain energy density and stress at 
\begin_inset Formula $\lambda_{m}$
\end_inset

,
 it does not guarantee continuity of the elasticity.
 The continuity of the elasticity is only satisfied if the parameter 
\begin_inset Formula $C_{3}$
\end_inset

 satisfies
\begin_inset Formula 
\[
C_{3}=\frac{C_{5}}{C_{4}}e^{-C_{4}\left(\lambda_{m}-1\right)}
\]

\end_inset

The parameter 
\begin_inset Formula $C_{6}$
\end_inset

 is chosen so that the stress defined above is continuous 
\begin_inset Formula $\lambda_{m}$
\end_inset

 and is determined by,
\begin_inset Formula 
\[
C_{6}=C_{3}\left(e^{C_{4}\left(\lambda_{m}-1\right)}-1\right)-C_{5}\lambda_{m}
\]

\end_inset

To use the form of 
\begin_inset Formula $F_{2}$
\end_inset

 that satisfies continuity of the elasticity at 
\begin_inset Formula $\lambda_{m}$
\end_inset

 the user may set 
\begin_inset Formula $C_{3}=0$
\end_inset

 in the input file,
 and specify 
\begin_inset Formula $C_{4}$
\end_inset

 and 
\begin_inset Formula $C_{5}$
\end_inset

 as explained above.
 When 
\begin_inset Formula $C_{3}=0$
\end_inset

 the code will automatically recalculate 
\begin_inset Formula $C_{3}$
\end_inset

 internally using the formula above.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1e-6</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-linear">
\end_layout

\begin_layout LyX-Code
    <c3>0.0023</c3>
\end_layout

\begin_layout LyX-Code
    <c4>43</c4>
\end_layout

\begin_layout LyX-Code
    <c5>3</c5>
\end_layout

\begin_layout LyX-Code
    <lambda>1.05</lambda>
\end_layout

\begin_layout LyX-Code
    <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber as Entropy Chain
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Entropy-Chain"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\emph on
fiber-entropy-chain
\emph default

\begin_inset Quotes erd
\end_inset

.
 It was proposed by 
\begin_inset CommandInset citation
LatexCommand citep
key "Shi22"
literal "false"

\end_inset

.
 This fiber model is based on statistical mechanics to reflect the entropy-driven nature of a biological fiber.
 The model is derived from the freely-jointed-chain mechanism.
 Its strain energy is directly related to the entropic change of the chains in the material,
 given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi_{n}\left(I_{n}\right)=\xi N\left(\sqrt{\frac{I_{n}}{N}}\beta+\ln\frac{\beta}{\sinh\beta}\right)-\frac{\xi\sqrt{N}}{2}\beta_{0}I_{n}-\alpha_{00}
\]

\end_inset


\end_layout

\begin_layout Standard
\noindent
where 
\begin_inset Formula $I_{n}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}$
\end_inset

 is the square of the stretch ratio along the referential fiber direction 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

.
 The inverse Langevin equation relates the parameter 
\begin_inset Formula $\beta$
\end_inset

 to 
\begin_inset Formula $I_{n}$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 according to 
\begin_inset Formula ${\displaystyle \beta=\mathcal{L}^{-1}\left[\sqrt{\frac{I_{n}}{N}}\right]}$
\end_inset

.
 Here,
 
\begin_inset Formula $\beta_{0}$
\end_inset

 is the value of 
\begin_inset Formula $\beta$
\end_inset

 when 
\begin_inset Formula $I_{n}=1$
\end_inset

,
 and
\begin_inset Formula $\alpha_{00}$
\end_inset

 is needed to produce a state of zero energy at 
\begin_inset Formula $I_{n}=1$
\end_inset

.
 The parameter 
\begin_inset Formula $\xi=nk\Theta$
\end_inset

 is the initial fiber stiffness,
 with 
\begin_inset Formula $n$
\end_inset

,
 
\begin_inset Formula $k$
\end_inset

,
 and 
\begin_inset Formula $\Theta$
\end_inset

 respectively representing the number of chains per unit volume,
 Boltzmann's constant,
 and the absolute temperature.
 The parameter 
\begin_inset Formula $N=\zeta^{2}$
\end_inset

 is the number of chain segments,
 and 
\begin_inset Formula $\zeta$
\end_inset

 is the locking stretch,
 representing the extensibility of the fiber.
 The Langevin function is given by 
\begin_inset Formula $\mathcal{L}\left(x\right)=\coth x-\frac{1}{x}$
\end_inset

.
\end_layout

\begin_layout Standard
When evaluating the inverse Langevin equation,
 a Taylor series expansion is applied for computational stability.
 The parameter 
\begin_inset Formula $n_{\mathrm{term}}$
\end_inset

 is used to control the number of terms used to evaluate the equation;
 it must be an integer between 3 and 30.
\end_layout

\begin_layout Standard
\noindent
The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<N>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Square of locking stretch
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n_term>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of Taylor series terms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shear modulus fir fiber-matrix interaction
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Soft Tissue" type="solid mixture">
\end_layout

\begin_layout LyX-Code
	<solid type="Arruda-Boyce unconstrained">
\end_layout

\begin_layout LyX-Code
	  <N>2</N>
\end_layout

\begin_layout LyX-Code
	  <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
	  <n_term>30</n_term>
\end_layout

\begin_layout LyX-Code
	  <kappa>1</kappa>
\end_layout

\begin_layout LyX-Code
        </solid>
\end_layout

\begin_layout LyX-Code
        <solid type="continuous fiber distribution">
\end_layout

\begin_layout LyX-Code
          <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
            <theta>0</theta>
\end_layout

\begin_layout LyX-Code
            <phi>0</phi>
\end_layout

\begin_layout LyX-Code
          </mat_axis>
\end_layout

\begin_layout LyX-Code
          <fibers type="fiber-entropy-chain">
\end_layout

\begin_layout LyX-Code
            <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
            <N>2</N>
\end_layout

\begin_layout LyX-Code
            <n_term>30</n_term>
\end_layout

\begin_layout LyX-Code
          </fibers>
\end_layout

\begin_layout LyX-Code
          <distribution type="von-Mises-3d">
\end_layout

\begin_layout LyX-Code
            <b>0.3</b>
\end_layout

\begin_layout LyX-Code
          </distribution>
\end_layout

\begin_layout LyX-Code
          <scheme type="fibers-3d-fei">
\end_layout

\begin_layout LyX-Code
            <resolution>196</resolution>
\end_layout

\begin_layout LyX-Code
          </scheme>
\end_layout

\begin_layout LyX-Code
        </solid>
\end_layout

\begin_layout LyX-Code
      </material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Uncoupled Fiber Models
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Fiber-Models"

\end_inset


\end_layout

\begin_layout Standard
Since fibers can only sustain tension,
 the materials listed here are not stable on their own.
 They must be combined with a stable material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

,
 within a <solid> tag.
 These fiber models may also be used in continuous fiber distribution models as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Continuous-Fiber"
nolink "false"

\end_inset

,
 using a <fibers> tag.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Exponential-Power Law,
 Uncoupled Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:fiber-exp-pow-uncoupled"

\end_inset


\end_layout

\begin_layout Standard
The material type for a single fiber with an exponential-power law,
 in an uncoupled strain energy formulation,
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-exp-pow-uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 Since fibers can only sustain tension,
 this material is not stable on its own.
 It must be combined with a stable uncoupled material that acts as a ground matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\xi,$
\end_inset

 representing a measure of the fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha,$
\end_inset

 coefficient of exponential argument
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta,$
\end_inset

 power of exponential argument
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The stress 
\begin_inset Formula $\tilde{\boldsymbol{\sigma}}$
\end_inset

 for this fibrous material is given by 
\begin_inset Formula 
\[
\tilde{\boldsymbol{\sigma}}=H\left(\tilde{I}_{n}-1\right)\frac{2\tilde{I}_{n}}{J}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n},
\]

\end_inset

where 
\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{n}_{r}\cdot\mathbf{\tilde{C}}\cdot\mathbf{n}_{r}$
\end_inset

 is the square of the fiber stretch,
 
\begin_inset Formula $\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{n}_{r}/\tilde{\lambda}_{n}$
\end_inset

,
 and 
\begin_inset Formula $H\left(.\right)$
\end_inset

 is the unit step function that enforces the tension-only contribution..
 The fiber strain energy density is given by 
\begin_inset Formula 
\[
\tilde{\Psi}=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(\tilde{I}_{n}-1\right)^{\beta}\right]-1\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\xi>0$
\end_inset

,
 
\begin_inset Formula $\alpha\geqslant0$
\end_inset

,
 and 
\begin_inset Formula $\beta\geqslant2$
\end_inset

.
\end_layout

\begin_layout Standard
Note:
 In the limit when 
\begin_inset Formula $\alpha\to0$
\end_inset

,
 this expressions produces a power law,
 
\begin_inset Formula 
\[
\lim\limits_{\alpha\to0}\tilde{\Psi}=\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta}.
\]

\end_inset

Note:
 When 
\begin_inset Formula $\beta>2$
\end_inset

,
 the fiber modulus is zero at the strain origin (
\begin_inset Formula $\tilde{I}_{n}=1)$
\end_inset

.
 Therefore,
 use 
\begin_inset Formula $\beta>2$
\end_inset

 when a smooth transition in the stress is desired from compression to tension.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Single fiber oriented along 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 embedded in a Mooney-Rivlin ground matrix.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <k>10e3</k>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow-uncoupled">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
        <theta>0</theta>
\end_layout

\begin_layout LyX-Code
        <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Two fibers in the plane orthogonal to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 oriented at 25 degrees relative to 
\begin_inset Formula $\mathbf{e}_{3}$
\end_inset

,
 embedded in a Mooney-Rivlin ground matrix.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <k>10e3</k>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow-uncoupled">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
        <theta>90</theta>
\end_layout

\begin_layout LyX-Code
        <phi>25</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="fiber-exp-pow-uncoupled">
\end_layout

\begin_layout LyX-Code
    <ksi>5</ksi>
\end_layout

\begin_layout LyX-Code
    <alpha>20</alpha>
\end_layout

\begin_layout LyX-Code
    <beta>3</beta>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
        <theta>-90</theta>
\end_layout

\begin_layout LyX-Code
        <phi>25</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber Kiousis Uncoupled
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fiber-Kiousus-Uncoupled"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-Kiousis-uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 It is based on the material model proposed by Kiousis et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Kiousis08,Kiousis09"
literal "true"

\end_inset

 for modeling the balloon in a balloon-stent 
\end_layout

\begin_layout Standard
+system.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<d1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{1},$
\end_inset

 represents a measure of the fiber modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<d2>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d_{2},$
\end_inset

 square of the stretch ratio when the fiber engages
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n,$
\end_inset

 power exponent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\tilde{\Psi}_{n}\left(I_{n}\right)=\begin{cases}
\frac{d_{1}}{n}\left(\tilde{I}_{n}-d_{2}\right)^{n} & \tilde{I}_{n}\ge d_{2}\\
0 & \tilde{I}_{n}<d_{2}
\end{cases}\,,
\]

\end_inset

where 
\begin_inset Formula $\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{n}_{r}\cdot\mathbf{\tilde{C}}\cdot\mathbf{n}_{r}$
\end_inset

 is the square of the fiber stretch and 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the unit vector along the fiber direction in its reference configuration.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a continuous fiber distribution (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Continuous-Fiber"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<fibers type="fiber-Kiousis-uncoupled">
\end_layout

\begin_layout LyX-Code
  <d1>500</d1>
\end_layout

\begin_layout LyX-Code
  <d2>2.25</d2>
\end_layout

\begin_layout LyX-Code
  <n>3</n>
\end_layout

\begin_layout LyX-Code
</fibers>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Fiber with Toe-Linear Response,
 Uncoupled Formulation
\begin_inset CommandInset label
LatexCommand label
name "subsec:fiber-toe-linear-uncoupled"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\shape italic
fiber-pow-linear-uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E,$
\end_inset

 the fiber modulus in the linear range (
\begin_inset Formula $E\geqslant0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta,$
\end_inset

 the power-law exponent in the toe region (
\begin_inset Formula $\beta\geqslant2)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lam0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda_{0},$
\end_inset

 the stretch ratio when the toe region transitions to the linear region (
\begin_inset Formula $\lambda_{0}>1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fiber strain energy density is given by 
\begin_inset Formula 
\[
\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)=\begin{cases}
0 & \tilde{I}_{n}<1\\
\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta} & 1\leqslant\tilde{I}_{n}\leqslant I_{0}\\
B\left(\tilde{I}_{n}-I_{0}\right)-E\left(\tilde{I}_{n}^{1/2}-I_{0}^{1/2}\right)+\frac{\xi}{\beta}\left(I_{0}-1\right)^{\beta} & I_{0}<\tilde{I}_{n}
\end{cases}\,,
\]

\end_inset

where 
\begin_inset Formula $I_{0}=\lambda_{0}^{2}$
\end_inset

,
 
\begin_inset Formula 
\[
\xi=\frac{E}{4\left(\beta-1\right)}I_{0}^{-3/2}\left(I_{0}-1\right)^{2-\beta},\,B=\xi\left(I_{0}-1\right)^{\beta-1}+\frac{E}{2}I_{0}^{-1/2}\,.
\]

\end_inset


\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Fiber model as specified in a solid mixture (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

)
\end_layout

\begin_layout LyX-Code
<solid type="fiber-pow-linear-uncoupled">
\end_layout

\begin_layout LyX-Code
  <fiber type="angles">
\end_layout

\begin_layout LyX-Code
    <theta>20</center>
\end_layout

\begin_layout LyX-Code
    <phi>90</phi>
\end_layout

\begin_layout LyX-Code
  </fiber>
\end_layout

\begin_layout LyX-Code
  <E>1</E>
\end_layout

\begin_layout LyX-Code
  <beta>2.5</beta>
\end_layout

\begin_layout LyX-Code
  <lam0>1.06</lam0>
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Subsubsection
Uncoupled Fiber Exp-Linear
\end_layout

\begin_layout Standard
This constitutive fiber model has an initial exponential rise and then grows linearly after a user-specified stretch transition point.
 This fiber material is based on the trans-iso Mooney-Rivlin model introduced in 
\begin_inset CommandInset citation
LatexCommand citep
key "Weiss96"
literal "false"

\end_inset

.
 This material by itself is not stable,
 so it is recommend to use it as part of a solid mixture.
 
\end_layout

\begin_layout Standard
The strain energy is as follows:
 
\begin_inset Formula 
\[
F_{2}\left(\tilde{\lambda}\right)=\begin{cases}
0 & \tilde{\lambda}<1\\
C_{3}\left(e^{-C_{4}}\left(\Ei\left(C_{4}\tilde{\lambda}\right)-\Ei\left(C_{4}\right)\right)-\ln\tilde{\lambda}\right) & 1\le\tilde{\lambda}<\lambda_{m}\\
C_{5}\left(\tilde{\lambda}-\lambda_{m}\right)+C_{6}\ln\frac{\tilde{\lambda}}{\lambda_{m}}+C_{3}\left(e^{-C_{4}}\Ei\left(C_{4}\lambda_{m}\right)-\Ei\left(C_{4}\right)-\ln\lambda_{m}\right) & \lambda_{m}\le\tilde{\lambda}
\end{cases}\,
\]

\end_inset

where 
\begin_inset Formula $\Ei\left(\cdot\right)$
\end_inset

 is the exponential integral function.
 The resulting fiber stress is evaluated from 
\begin_inset Formula 
\[
\tilde{\lambda}\frac{\partial F_{2}}{\partial\tilde{\lambda}}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\tilde{\lambda}-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\tilde{\lambda}+C_{6} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.
\]

\end_inset

Here,
 
\begin_inset Formula $\lambda_{m}$
\end_inset

 is the stretch at which the fibers are straightened,
 
\begin_inset Formula $C_{3}$
\end_inset

scales the exponential stresses,
 
\begin_inset Formula $C_{4}$
\end_inset

 is the rate of uncrimping of the fibers,
 and 
\begin_inset Formula $C_{5}$
\end_inset

is the modulus of the straightened fibers.
 
\begin_inset Formula $C_{6}$
\end_inset

 is determined from the requirement that the stress is continuous at 
\begin_inset Formula $\lambda_{m}$
\end_inset

 (see below).
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c3>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential stress coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c4>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber uncrimping coefficient
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c5>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Modulus of straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber stretch for straightened fibers
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fiber>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fiber distribution option
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
While this material enforces continuity of the strain energy density and stress at 
\begin_inset Formula $\lambda_{m}$
\end_inset

,
 it does not enforce continuity of the elasticity.
 To enforce continuity of all three parameters,
 we need to let
\begin_inset Formula 
\[
C_{3}=\frac{C_{5}}{C_{4}}e^{-C_{4}\left(\lambda_{m}-1\right)}
\]

\end_inset

The parameter 
\begin_inset Formula $C_{6}$
\end_inset

 is chosen so that the stress defined above is continuous 
\begin_inset Formula $\lambda_{m}$
\end_inset

 and is determined by,
\begin_inset Formula 
\[
C_{6}=C_{3}\left(e^{C_{4}\left(\lambda_{m}-1\right)}-1\right)-C_{5}\lambda_{m}
\]

\end_inset

To enforce contintuity of the elasticity at 
\begin_inset Formula $\lambda_{m}$
\end_inset

 the user may also set 
\begin_inset Formula $C_{3}=0$
\end_inset

 in the input file,
 and specify 
\begin_inset Formula $C_{4}$
\end_inset

 and 
\begin_inset Formula $C_{5}$
\end_inset

 as explained above.
 When 
\begin_inset Formula $C_{3}=0$
\end_inset

 the code will automatically recalculate 
\begin_inset Formula $C_{3}$
\end_inset

 internally.
 Using the above formula to calculate 
\begin_inset Formula $C_{3}$
\end_inset

 manually for use in the first form can also enforce continuity of the elastic modulus at 
\begin_inset Formula $\lambda_{m}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <k>10</k>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>2.5e-07</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="uncoupled fiber-exp-linear">
\end_layout

\begin_layout LyX-Code
    <c3>0.00234</c3>
\end_layout

\begin_layout LyX-Code
    <c4>43</c4>
\end_layout

\begin_layout LyX-Code
    <c5>3</c5>
\end_layout

\begin_layout LyX-Code
    <lambda>1.05</lambda>
\end_layout

\begin_layout LyX-Code
    <fiber type="vector">1,0,0</fiber>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Uncoupled Fiber as Entropy Chain
\begin_inset CommandInset label
LatexCommand label
name "subsec:UC-Fiber-Entropy-Chain"

\end_inset


\end_layout

\begin_layout Standard
This material type is 
\begin_inset Quotes eld
\end_inset


\emph on
uncoupled fiber-entropy-chain
\emph default

\begin_inset Quotes erd
\end_inset

.
 It was proposed by 
\begin_inset CommandInset citation
LatexCommand citep
key "Shi22"
literal "false"

\end_inset

.
 This fiber model is based on statistical mechanics to reflect the entropy-driven nature of a biological fiber.
 The model is derived from the freely-jointed-chain mechanism.
 Its strain energy is directly related to the entropic change of the chains in the material,
 given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi_{n}(\tilde{I}_{n})=\xi N\left(\sqrt{\frac{\tilde{I}_{n}}{N}}\beta+\text{ln}\frac{\beta}{\sinh\beta}\right)-\frac{\xi\sqrt{N}}{2}\beta_{0}\tilde{I}_{n}-\alpha_{00}
\]

\end_inset


\end_layout

\begin_layout Standard
\noindent
where 
\begin_inset Formula $\tilde{I}_{n}=\mathbf{n}_{r}\cdot\tilde{\mathbf{C}}\cdot\mathbf{n}_{r}$
\end_inset

 is the deviatoric measure of the stretch ratio along the referential fiber direction 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

.
 The inverse Langevin equation relates the parameter 
\begin_inset Formula $\beta$
\end_inset

 to 
\begin_inset Formula $I_{n}$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 according to 
\begin_inset Formula ${\displaystyle \beta=\mathcal{L}^{-1}\left(\sqrt{\frac{I_{n}}{N}}\right)}$
\end_inset

.
 Here,
 
\begin_inset Formula $\beta_{0}$
\end_inset

 is the value of 
\begin_inset Formula $\beta$
\end_inset

 when 
\begin_inset Formula $I_{n}=1$
\end_inset

,
 and 
\begin_inset Formula $\alpha_{00}$
\end_inset

 is needed to produce a state of zero energy at 
\begin_inset Formula $I_{n}=1$
\end_inset

.
 The parameter 
\begin_inset Formula $\xi=nk\Theta$
\end_inset

 is the initial fiber stiffness,
 with 
\begin_inset Formula $n$
\end_inset

,
 
\begin_inset Formula $k$
\end_inset

,
 and 
\begin_inset Formula $\Theta$
\end_inset

 respectively representing the number of chains per unit volume,
 Boltzmann's constant,
 and the absolute temperature.
 The parameter 
\begin_inset Formula $N=\zeta^{2}$
\end_inset

 is the number of chain segments,
 and 
\begin_inset Formula $\zeta$
\end_inset

 is the locking stretch,
 representing the extensibility of the fiber.
 The Langevin function is given by 
\begin_inset Formula $\mathcal{L}\left(x\right)=\coth x-\frac{1}{x}$
\end_inset

.
\end_layout

\begin_layout Standard
When evaluating the inverse Langevin equation,
 a Taylor series expansion is applied for computational stability.
 The parameter 
\begin_inset Formula $n_{\mathrm{term}}$
\end_inset

 is used to control the number of terms used to evaluate the equation;
 it must be an integer between 3 and 30.
\end_layout

\begin_layout Standard
\noindent
The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<ksi>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<N>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Square of locking stretch
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n_term>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of Taylor series terms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Soft Tissue" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
	<k>1e4</k>
\end_layout

\begin_layout LyX-Code
	<solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
	  <c1>10.0</c1>
\end_layout

\begin_layout LyX-Code
	  <c2>0</c2>
\end_layout

\begin_layout LyX-Code
	</solid>
\end_layout

\begin_layout LyX-Code
	<solid type="uncoupled fiber-entropy-chain">
\end_layout

\begin_layout LyX-Code
	  <N>2.3</N>
\end_layout

\begin_layout LyX-Code
	  <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
	  <n_term>25</n_term>
\end_layout

\begin_layout LyX-Code
	  <fiber type="vector">0,0,1</fiber>
\end_layout

\begin_layout LyX-Code
	</solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Continuous Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:Continuous-Fiber-Distribution"

\end_inset


\end_layout

\begin_layout Standard
A continuous fiber distribution has a strain energy density that integrates the contributions from fiber bundles oriented along all directions emanating from a point in the continuum,
\begin_inset Formula 
\[
\Psi_{r}\left(\mathbf{C}\right)=\int_{A}H\left(I_{n}-1\right)R\left(\mathbf{n}_{r}\right)\Psi_{n}\left(I_{n}\right)\,dA\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 is the unit vector along the fiber orientation in the reference configuration,
 
\begin_inset Formula $I_{n}=\mathbf{n}_{r}\cdot\mathbf{C}\cdot\mathbf{n}_{r}$
\end_inset

 is the normal component of 
\begin_inset Formula $\mathbf{C}$
\end_inset

 along 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 (also the square of the stretch ratio along that direction),
 and 
\begin_inset Formula $A$
\end_inset

 represents the unit sphere (for 3D fiber distributions) or unit circle (for 2D fiber distributions) over which the integration is performed 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou2016"
literal "true"

\end_inset

.
 Thus,
 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

 spans all directions from the origin to points on the unit sphere or unit circle.
 In the integrand,
 
\begin_inset Formula $\Psi_{n}$
\end_inset

 represents the strain energy density of the fiber bundle oriented along 
\begin_inset Formula $\mathbf{n}_{r}$
\end_inset

;
 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the Heaviside unit step function that includes only fibers that are in tension;
 and 
\begin_inset Formula $R\left(\mathbf{n}_{r}\right)$
\end_inset

 is the fiber density distribution function that specifies the spatial fractional distribution of fibers.
 This function satisfies the constraint
\begin_inset Formula 
\[
\int_{A}R\left(\mathbf{n}_{r}\right)\,dA=1\,.
\]

\end_inset

Fiber constitutive models may be taken from the list given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Fiber-Models"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
For a material with an uncoupled strain energy density the corresponding expression is
\begin_inset Formula 
\[
\tilde{\Psi}_{r}\left(\tilde{\mathbf{C}}\right)=\int_{A}H\left(\tilde{I}_{n}-1\right)R\left(\mathbf{n}_{r}\right)\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)\,dA\,,
\]

\end_inset

where 
\begin_inset Formula $\tilde{I}_{n}=\mathbf{n}_{r}\cdot\tilde{\mathbf{C}}\cdot\mathbf{n}_{r}$
\end_inset

.
 In this case,
 fiber constitutive models may be taken from the list given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Fiber-Models"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Unconstrained Continuous Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Unconstrained-Continuous-Fiber"

\end_inset


\end_layout

\begin_layout Standard
The material type for an unconstrained continuous fiber distribution material is 
\shape italic

\begin_inset Quotes eld
\end_inset

continuous fiber distribution
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fibers>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fiber material response 
\begin_inset Formula $\Psi_{n}\left(I_{n}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<distribution>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fiber density distribution 
\begin_inset Formula $R\left(\mathbf{n}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<scheme>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Numerical integration scheme
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <fibers> tag encloses a description of the fiber constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Fiber-Models"
nolink "false"

\end_inset

.
 The <distribution> tag encloses a description of the fiber density distribution function,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Distribution"
nolink "false"

\end_inset

.
 The <scheme> tag specifies the numerical integration scheme,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Scheme"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>1</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="continuous fiber distribution">
\end_layout

\begin_layout LyX-Code
    <fibers type="fiber-exponential-power-law">
\end_layout

\begin_layout LyX-Code
      <alpha>0</alpha>
\end_layout

\begin_layout LyX-Code
      <beta>2</beta>
\end_layout

\begin_layout LyX-Code
      <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
    </fibers>
\end_layout

\begin_layout LyX-Code
    <distribution type="spherical">
\end_layout

\begin_layout LyX-Code
    </distribution>
\end_layout

\begin_layout LyX-Code
    <scheme type="fibers-3d-gkt">
\end_layout

\begin_layout LyX-Code
      <nph>7</nph>
\end_layout

\begin_layout LyX-Code
      <nth>11</nth>
\end_layout

\begin_layout LyX-Code
    </scheme>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Uncoupled Continuous Fiber Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Continuous-Fiber"

\end_inset


\end_layout

\begin_layout Standard
The material type for an uncoupled continuous fiber distribution material is 
\shape italic

\begin_inset Quotes eld
\end_inset

continuous fiber distribution uncoupled
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fibers>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fiber material response 
\begin_inset Formula $\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<distribution>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fiber density distribution 
\begin_inset Formula $R\left(\mathbf{n}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<scheme>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Numerical integration scheme
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <fibers> tag encloses a description of the fiber constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Fiber-Models"
nolink "false"

\end_inset

.
 The <distribution> tag encloses a description of the fiber density distribution function,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Distribution"
nolink "false"

\end_inset

.
 The <scheme> tag specifies the numerical integration scheme,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Scheme"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <c1>1</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0.3</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="continuous fiber distribution uncoupled">
\end_layout

\begin_layout LyX-Code
    <fibers type="fiber-exponential-power-law-uncoupled">
\end_layout

\begin_layout LyX-Code
      <alpha>0</alpha>
\end_layout

\begin_layout LyX-Code
      <beta>2</beta>
\end_layout

\begin_layout LyX-Code
      <ksi>1</ksi>
\end_layout

\begin_layout LyX-Code
    </fibers>
\end_layout

\begin_layout LyX-Code
    <distribution type="spherical">
\end_layout

\begin_layout LyX-Code
    </distribution>
\end_layout

\begin_layout LyX-Code
    <scheme type="fibers-3d-gkt">
\end_layout

\begin_layout LyX-Code
      <nph>7</nph>
\end_layout

\begin_layout LyX-Code
      <nth>11</nth>
\end_layout

\begin_layout LyX-Code
    </scheme>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Distribution"

\end_inset


\end_layout

\begin_layout Standard
A fiber density distribution function is needed in the specification of a continuous fiber distribution.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Spherical
\begin_inset CommandInset label
LatexCommand label
name "subsec:Spherical"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
spherical
\shape default

\begin_inset Quotes erd
\end_inset

 models an isotropic 3D distribution.
 This distribution corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=\frac{1}{4\pi}\,.
\]

\end_inset

It requires no additional parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/FigSphericalDistribution.png

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="spherical">
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Ellipsoidal
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ellipsoidal"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
ellipsoidal
\shape default

\begin_inset Quotes erd
\end_inset

 models a generally orthotropic 3D distribution.
 It corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=C^{-1}\left[\left(\frac{n_{1}}{a}\right)^{2}+\left(\frac{n_{2}}{b}\right)^{2}+\left(\frac{n_{3}}{c}\right)^{2}\right]^{-1/2}\,,
\]

\end_inset

where 
\begin_inset Formula $\left(n_{1},n_{2},n_{3}\right)$
\end_inset

 are the components of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 in the local Cartesian basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 of each element,
 when specified (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

) or the global basis by default;
 and 
\begin_inset Formula $C$
\end_inset

 is calculated to satisfy the integration constraint on 
\begin_inset Formula $R\left(\mathbf{n}\right)$
\end_inset

.
 The parameters 
\begin_inset Formula $\left(a,b,c\right)$
\end_inset

 represents the semi-principal axes of the ellipsoid and must be positive.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<spa>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The semi-principal axes 
\begin_inset Formula $\left(a,b,c\right)$
\end_inset

 of the ellipsoid
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The value of 
\begin_inset Formula $C$
\end_inset

 is automatically adjusted to account for the values of the semi-principal axes 
\begin_inset Formula $\left(a,b,c\right)$
\end_inset

.
 Therefore,
 only the relative ratios of these parameters matter.
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/FigEllipsoidalDistribution.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="ellipsoidal">
\end_layout

\begin_layout LyX-Code
  <spa>3,2,1</spa>
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset Formula $\pi-$
\end_inset

Periodic von Mises Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:Periodic-von-Mises"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
von-Mises-3d
\shape default

\begin_inset Quotes erd
\end_inset

 models a transversely isotropic 3D distribution 
\begin_inset CommandInset citation
LatexCommand citep
key "Gasser06"
literal "true"

\end_inset

.
 It corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=\frac{1}{\pi}\sqrt{\frac{b}{2\pi}}\frac{\exp\left(2bn_{1}^{2}\right)}{\mbox{erfi}\left(\sqrt{2b}\right)}\,,
\]

\end_inset

where 
\begin_inset Formula $\left(n_{1},n_{2},n_{3}\right)$
\end_inset

 are the components of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 in the local Cartesian basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 of each element,
 when specified (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

) or the global basis by default;
 and 
\begin_inset Formula $b$
\end_inset

 is the concentration parameter (
\begin_inset Formula $b>0)$
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<b>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The concentration parameter 
\begin_inset Formula $b$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/FigPiPeriodicVonMisesDistribution.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="von-Mises-3d">
\end_layout

\begin_layout LyX-Code
  <b>0.5</b>
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Circular
\begin_inset CommandInset label
LatexCommand label
name "subsec:Circular"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
circular
\shape default

\begin_inset Quotes erd
\end_inset

 models a transversely isotropic 2D distribution.
 This distribution corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=\frac{1}{2\pi}\,.
\]

\end_inset

It requires no additional parameters.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="circular">
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Elliptical
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elliptical"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
elliptical
\shape default

\begin_inset Quotes erd
\end_inset

 models an orthotropic 2D distribution.
 This distribution corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=C^{-1}\left[\left(\frac{n_{1}}{a}\right)^{2}+\left(\frac{n_{2}}{b}\right)^{2}\right]^{-1/2}
\]

\end_inset

where 
\begin_inset Formula $\left(n_{1},n_{2},n_{3}\right)$
\end_inset

 are the components of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 in the local Cartesian basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 of each element,
 when specified (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

) or the global basis by default,
 implying that the elliptical distribution lies in the 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2}\right\} $
\end_inset

 plane;
 and 
\begin_inset Formula $\left(a,b\right)$
\end_inset

 are the semi-principal axes of the ellipse.
 Here,
 
\begin_inset Formula $C=4bK\left(e\right)$
\end_inset

 where 
\begin_inset Formula $K$
\end_inset

 is the complete elliptic integral of the first kind and 
\begin_inset Formula 
\[
e=\sqrt{1-\frac{b^{2}}{a^{2}}}
\]

\end_inset

is the ellipse eccentricity.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<spa1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The semi-principal axis 
\begin_inset Formula $a$
\end_inset

 of the ellipse
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<spa2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The semi-principal axis 
\begin_inset Formula $b$
\end_inset

 of the ellipse
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/FigEllipticalDistribution.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="elliptical">
\end_layout

\begin_layout LyX-Code
  <spa1>8</spa1>
\end_layout

\begin_layout LyX-Code
  <spa2>1</spa2>
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
von Mises Distribution
\begin_inset CommandInset label
LatexCommand label
name "subsec:von-Mises-Distribution"

\end_inset


\end_layout

\begin_layout Standard
The fiber density distribution type 
\begin_inset Quotes eld
\end_inset


\shape italic
von-Mises-2d
\shape default

\begin_inset Quotes erd
\end_inset

 models an orthotropic 2D distribution.
 This distribution corresponds to 
\begin_inset Formula 
\[
R\left(\mathbf{n}\right)=\frac{\exp\left[b\left(2n_{1}^{2}-1\right)\right]}{2\pi I_{0}\left(b\right)}
\]

\end_inset

where 
\begin_inset Formula $\left(n_{1},n_{2},n_{3}\right)$
\end_inset

 are the components of 
\begin_inset Formula $\mathbf{n}$
\end_inset

 in the local Cartesian basis 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 of each element,
 when specified (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

) or the global basis by default,
 with the distribution lying in the 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2}\right\} $
\end_inset

 plane;
 and 
\begin_inset Formula $b$
\end_inset

 is the concentration parameter (
\begin_inset Formula $b>0)$
\end_inset

.
 
\begin_inset Formula $I_{0}$
\end_inset

 is the modified Bessel function of the first kind of order 0.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<b>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The concentration parameter 
\begin_inset Formula $b$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/FigVonMisesDistribution.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<distribution type="von-Mises-2d">
\end_layout

\begin_layout LyX-Code
  <b>3</b>
\end_layout

\begin_layout LyX-Code
</distribution>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Scheme
\begin_inset CommandInset label
LatexCommand label
name "subsec:Scheme"

\end_inset


\end_layout

\begin_layout Standard
A numerical integration scheme is needed in the specification of a continuous fiber distribution to perform the integration over the unit sphere (3D) or the unit circle (2D).
 Use the uncoupled version of the scheme when modeling an uncoupled continuous fiber distribution.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Gauss-Kronrod Trapezoidal Rule
\begin_inset CommandInset label
LatexCommand label
name "subsec:Gauss-Kronrod-Trapezoidal-Rule"

\end_inset


\end_layout

\begin_layout Standard
The scheme type for the Gauss-Kronrod trapezoidal rule is 
\shape italic

\begin_inset Quotes eld
\end_inset

fibers-3d-gkt
\begin_inset Quotes erd
\end_inset


\shape default
 for unconstrained and uncoupled continuous fiber distributions.
 This integration rule should only be used with 3D fiber density distributions.
 This scheme automatically limits the range of integration to fibers that are in tension 
\begin_inset CommandInset citation
LatexCommand citep
key "Hou16"
literal "true"

\end_inset

.
 A Gauss-Kronrod quadrature rule is employed for integration across latitudes of the unit sphere.
 A trapezoidal rule is used for integration across longitudes.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<nph>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of integration points across latitudes
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<nth>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of integration points across longitudes
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameter <nph> must be one of the values 7,
 11,
 15,
 19,
 23 and 27.
 The parameter <nth> may be any number greater than 0.
 Odd values for <nth> produce more accurate results than even values.
 A recommended combination is nph=7 and nth=31.
 The total number of integration points is 
\begin_inset Formula $N=$
\end_inset

nph nth.
 Increasing values of 
\begin_inset Formula $N$
\end_inset

 require increasing computational time.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<scheme type="fibers-3d-gkt">
\end_layout

\begin_layout LyX-Code
  <nph>7</nph>
\end_layout

\begin_layout LyX-Code
  <nth>31</nth>
\end_layout

\begin_layout LyX-Code
</scheme>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Finite Element Integration Rule
\begin_inset CommandInset label
LatexCommand label
name "subsec:Finite-Element-Integration"

\end_inset


\end_layout

\begin_layout Standard
The scheme type for the finite element integration rule is 
\shape italic

\begin_inset Quotes eld
\end_inset

fibers-3d-fei
\begin_inset Quotes erd
\end_inset


\shape default
 for unconstrained and uncoupled continuous fiber distributions.
 This integration rule should only be used with 3D fiber density distributions.
 This scheme discretizes the unit sphere into a set of 
\begin_inset Formula $N$
\end_inset

 spherical triangles of nearly identical surface areas.
 The unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 passes through the centroid of each surface element.
 The integration is performed as a summation over 
\begin_inset Formula $N$
\end_inset

.
 For each direction 
\begin_inset Formula $\mathbf{n}$
\end_inset

 the stress is evaluated only if the fiber bundle is in tension along that direction.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<resolution>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the number of integration points 
\begin_inset Formula $N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameter <resolution> must be one of the values 20,
 34,
 60,
 74,
 196,
 210,
 396,
 410,
 596,
 610,
 796,
 810,
 996,
 1010,
 1196,
 1210,
 1396,
 1410,
 1596,
 1610,
 and 1796.
 A recommended combination is nph=7 and nth=31.
 A conservative choice for producing accurate results under general loading conditions is 
\begin_inset Formula $N=$
\end_inset

1610.
 Increasing values of 
\begin_inset Formula $N$
\end_inset

 require increasing computational time.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigFiniteElementIntegration.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example 
\shape default
:
\end_layout

\begin_layout LyX-Code
<scheme type="fibers-3d-fei">
\end_layout

\begin_layout LyX-Code
  <resolution>1610</resolution>
\end_layout

\begin_layout LyX-Code
</scheme>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Trapezoidal Rule
\begin_inset CommandInset label
LatexCommand label
name "subsec:Trapezoidal-Rule"

\end_inset


\end_layout

\begin_layout Standard
The scheme type for the trapezoidal integration rule is 
\shape italic

\begin_inset Quotes eld
\end_inset

fibers-2d-trapezoidal
\begin_inset Quotes erd
\end_inset


\shape default
 for unconstrained and uncoupled continuous fiber distributions.
 This integration rule should only be used with 2D fiber density distributions.
 This scheme discretizes the unit circle into a set of 
\begin_inset Formula $N$
\end_inset

 circular arcs of identical lengths.
 The unit normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 passes through the centroid of each arc element.
 The integration is performed as a summation over 
\begin_inset Formula $N$
\end_inset

.
 For each direction 
\begin_inset Formula $\mathbf{n}$
\end_inset

 the stress is evaluated only if the fiber bundle is in tension along that direction.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<nth>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of integration points 
\begin_inset Formula $N$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameter <nth> may be any number greater than 0.
 Odd values for <nth> produce more accurate results than even values.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<scheme type="fibers-2d-trapezoidal">
\end_layout

\begin_layout LyX-Code
  <nth>31</nth>
\end_layout

\begin_layout LyX-Code
</scheme>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Viscoelastic Solids
\begin_inset CommandInset label
LatexCommand label
name "sec:Viscoelastic-Solids"

\end_inset


\end_layout

\begin_layout Subsection
Uncoupled Viscoelastic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Viscoelastic-Materials"

\end_inset


\end_layout

\begin_layout Standard
These materials produce a viscoelastic response only for the deviatoric stress response.
 They must be used whenever the elastic response is uncoupled,
 as in the materials described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
The material type for these materials is 
\begin_inset Quotes eld
\end_inset

uncoupled viscoelastic
\begin_inset Quotes erd
\end_inset

.
 The following parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
units
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
viscoelastic coefficient 
\begin_inset Formula $\gamma_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1>-<t6>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relaxation times
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g1>-<g6>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
viscoelastic coefficients
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic component (must be an uncoupled elastic solid)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{S}\left(t\right)=\int\limits_{-\infty}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}}{ds}\,ds
\]

\end_inset

For a uncoupled viscoelastic material,
 the second Piola Kirchhoff stress can be written as follows 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso98"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\mathbf{S}\left(t\right)=pJ\,\mathbf{C}^{-1}+J^{-2/3}\int\limits_{-\infty}^{t}G\left(t-s\right)\frac{d\left(\Dev\left[\mathbf{\tilde{S}}^{e}\right]\right)}{ds}\,ds\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{\tilde{S}}^{e}$
\end_inset

 is the elastic stress derived from 
\begin_inset Formula $\tilde{W}\left(\mathbf{\tilde{C}}\right)$
\end_inset

 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

) and 
\begin_inset Formula $G$
\end_inset

 is the relaxation function.
 It is assumed that the relaxation function is given by the following discrete relaxation spectrum:
 
\begin_inset Formula 
\[
G\left(t\right)=\gamma_{0}+\sum\limits_{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right),
\]

\end_inset

Note that the user does not have to enter all the 
\begin_inset Formula $\tau_{i}$
\end_inset

 and 
\begin_inset Formula $\gamma_{i}$
\end_inset

 coefficients.
 Instead,
 only the values that are used need to be entered.
 So,
 if 
\begin_inset Formula $N$
\end_inset

 is 2,
 only 
\begin_inset Formula $\tau_{1}$
\end_inset

,
 
\begin_inset Formula $\tau_{2}$
\end_inset

,
 
\begin_inset Formula $\gamma_{1}$
\end_inset

 and 
\begin_inset Formula $\gamma_{2}$
\end_inset

have to be entered.
\end_layout

\begin_layout Standard
The 
\shape italic
elastic 
\shape default
parameter describes the elastic material as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material 1" type="uncoupled viscoelastic">
\end_layout

\begin_layout LyX-Code
  <g1>0.95</g1>
\end_layout

\begin_layout LyX-Code
  <t1>0.01</t1>
\end_layout

\begin_layout LyX-Code
  <k>100</k>
\end_layout

\begin_layout LyX-Code
  <elastic type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0.0</c2>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsection
Unconstrained Viscoelastic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Unconstrained-Viscoelastic-Materi"

\end_inset


\end_layout

\begin_layout Standard
The material type for viscoelastic materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
viscoelastic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
units
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
viscoelastic coefficient 
\begin_inset Formula $\gamma_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1>-<t6>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relaxation times
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g1>-<g6>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
viscoelastic coefficients
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
elastic component (must be an unconstrained elastic solid)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For a viscoelastic material,
 the second Piola Kirchhoff stress can be written as follows 
\begin_inset CommandInset citation
LatexCommand citep
key "Puso98"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\mathbf{S}\left(t\right)=\int\limits_{-\infty}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}}{ds}\,ds\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 is the elastic stress and 
\begin_inset Formula $G$
\end_inset

 is the relaxation function.
 It is assumed that the relaxation function is given by the following discrete relaxation spectrum:
 
\begin_inset Formula 
\[
G\left(t\right)=\gamma_{0}+\sum\limits_{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right)\,,
\]

\end_inset

Note that the user does not have to enter all the 
\begin_inset Formula $\tau_{i}$
\end_inset

 and 
\begin_inset Formula $\gamma_{i}$
\end_inset

 coefficients.
 Instead,
 only the values that are used need to be entered.
 So,
 if 
\begin_inset Formula $N$
\end_inset

 is 2,
 only 
\begin_inset Formula $\tau_{1}$
\end_inset

,
 
\begin_inset Formula $\tau_{2}$
\end_inset

,
 
\begin_inset Formula $\gamma_{1}$
\end_inset

 and 
\begin_inset Formula $\gamma_{2}$
\end_inset

have to be entered.
\end_layout

\begin_layout Standard
The 
\shape italic
elastic 
\shape default
parameter describes the elastic material as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material 1" type="viscoelastic">
\end_layout

\begin_layout LyX-Code
  <g1>0.95</g1>
\end_layout

\begin_layout LyX-Code
  <t1>0.01</t1>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1</E>
\end_layout

\begin_layout LyX-Code
    <v>0.0</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Viscoelastic Solid
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Viscoelastic-Solid"

\end_inset


\end_layout

\begin_layout Standard
Reactive viscoelasticity models a material as a mixture of strong bonds,
 which are permanent,
 and weak bonds,
 which break and reform in response to loading 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian15"
literal "true"

\end_inset

.
 Strong bonds produce the equilibrium elastic response,
 whereas weak bonds produce the transient viscous response.
 For a compressive reactive viscoelastic solid,
 the strain energy density is given by 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\sum\limits_{u}w^{u}\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)\label{eq:rvs-sed}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Psi_{r}^{e}$
\end_inset

 is the strain energy density of strong bonds and 
\begin_inset Formula $\Psi_{0}^{b}$
\end_inset

 is the strain energy density of weak bonds,
 when they all belong to the same generation.
 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient of the strong bonds and the initial weak bond generation,
 wherease 
\begin_inset Formula $\mathbf{F}^{u}$
\end_inset

 is the relative deformation gradient for the 
\begin_inset Formula $u-$
\end_inset

generation weak bonds,
 such that 
\begin_inset Formula $\mathbf{F}^{u}\left(u\right)=\mathbf{R}\left(u\right)$
\end_inset

 (the rotation tensor in the polar decomposition of 
\begin_inset Formula $\mathbf{F}$
\end_inset

) at time 
\begin_inset Formula $u$
\end_inset

,
 thus 
\begin_inset Formula $\mathbf{F}^{u}\left(t\right)=\mathbf{F}\left(t\right)\cdot\mathbf{U}^{-1}\left(u\right)$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{U}$
\end_inset

 is the right-stretch tensor of 
\begin_inset Formula $\mathbf{F}=\mathbf{R}\cdot\mathbf{U}$
\end_inset

.
 In this expression,
 
\begin_inset Formula $w^{u}\left(\mathbf{X},t\right)$
\end_inset

 is the mass fraction of 
\begin_inset Formula $u-$
\end_inset

generation weak bonds,
 which evolves over time as described next.
 The summation is taken over all generations 
\begin_inset Formula $u$
\end_inset

 that were created prior to the current time 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Standard
Any number of valid solutions may exist for 
\begin_inset Formula $w^{u}$
\end_inset

,
 based on constitutive assumptions for the weak bond mass fraction supply 
\begin_inset Formula $\hat{w}^{u}$
\end_inset

.
 In particular,
 for 
\begin_inset Formula $u-$
\end_inset

generation bonds reforming in an unloaded state during the time interval 
\begin_inset Formula $u\leqslant t<v$
\end_inset

,
 and subsequently breaking in response to loading at 
\begin_inset Formula $t=v$
\end_inset

,
 Type I bond kinetics provides a solution of the form 
\begin_inset Formula 
\begin{equation}
w^{u}\left(\mathbf{X},t\right)=\begin{cases}
0 & t<u\\
f^{u}\left(\mathbf{X},t\right) & u\leqslant t<v\\
f^{u}\left(\mathbf{X},v\right)g\left(\mathbf{F}\left(v\right);\mathbf{X},t-v\right) & v\leqslant t
\end{cases}\label{eq:rvs-mass-fractions}
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
f^{u}\left(\mathbf{X},t\right)=1-\sum\limits_{\gamma<u}w^{\gamma}\left(\mathbf{X},t\right)\label{eq:rvs-reformed-bond-fraction}
\end{equation}

\end_inset

and 
\begin_inset Formula $g\left(\mathbf{F}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 is a reduced relaxation function which may assume any number of valid forms.
 (A reduced relaxation function 
\begin_inset Formula $g\left(t\right)$
\end_inset

 satisfies 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

 and 
\begin_inset Formula $g\left(t\to\infty\right)=0$
\end_inset

,
 and decreases monotonically with 
\begin_inset Formula $t$
\end_inset

.) In particular,
 
\begin_inset Formula $g$
\end_inset

 may depend on the strain at time 
\begin_inset Formula $v$
\end_inset

 relative to the reference configuration of the 
\begin_inset Formula $u-$
\end_inset

generation.
 In the recursive expression above,
 the earliest generation 
\begin_inset Formula $u=-\infty$
\end_inset

,
 which is initially at rest,
 produces 
\begin_inset Formula $w^{u}\left(t\right)=1$
\end_inset

 for 
\begin_inset Formula $t<v$
\end_inset

 and 
\begin_inset Formula $w^{u}\left(t\right)=g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right)$
\end_inset

 for 
\begin_inset Formula $t\geqslant v$
\end_inset

;
 this latter expression seeds the recursion for subsequent generations.
 Therefore,
 providing a functional form for 
\begin_inset Formula $g$
\end_inset

 suffices to produce the solution for all bond generations 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard
For Type II bond kinetics,
 the solution for the mass fractions is given by 
\begin_inset Formula 
\begin{equation}
w^{u}\left(t\right)=\begin{cases}
0 & t<u\\
1-g\left(t-u\right) & u\leqslant t<v\\
g\left(t-v\right)-g\left(t-u\right) & v\leqslant t
\end{cases}\,.\label{eq:rvs-mass-fractions-II}
\end{equation}

\end_inset

For this type of bond kinetics,
 the reduced relaxation function 
\begin_inset Formula $g$
\end_inset

 cannot depend on the magnitude of the strain,
 because strain-dependence might violate the constraint 
\begin_inset Formula $0\leqslant w^{u}\leqslant1$
\end_inset

.
 Thus,
 type II bond kinetics is only valid for quasilinear viscoelasticity,
 whereas type I bond kinetics also encompasses nonlinear viscoelasticity.
\end_layout

\begin_layout Standard
For all bond kinetics,
 it is also possible to constrain the occurrence of the breaking-and-reforming reaction to specific forms of the strain.
 For example,
 the reaction may be allowed to proceed only in the case of dilatational strain,
 or only in the case of distortional strain.
\end_layout

\begin_layout Standard
For a material with an uncoupled formulation,
 the strain energy density has the form 
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=U\left(J\right)+\tilde{\Psi}_{r}^{e}\left(\mathbf{\tilde{F}}\right)+\sum\limits_{u}w^{u}\tilde{\Psi}_{0}^{b}\left(\mathbf{\tilde{F}}^{u}\right)\label{eq:rvs-sed-uncoupled}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
The material type for a compressive reactive viscoelastic solid is 
\begin_inset Quotes eld
\end_inset


\emph on
reactive viscoelastic
\emph default

\begin_inset Quotes erd
\end_inset

.
 For the uncoupled formulation the material type is 
\begin_inset Quotes eld
\end_inset

uncoupled reactive viscoelastic
\begin_inset Quotes erd
\end_inset

.
 The following parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="middle" width="40page%">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kinetics>
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bond kinetics type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<trigger>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Strain invariants that trigger weak bond breakage and reformation
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<wmin>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bond mass fraction threshold 
\begin_inset Formula $w_{\min}$
\end_inset

 for triggering new generation or merging and culling oldest generation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<emin>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Strain threshold 
\begin_inset Formula $e_{\min}$
\end_inset

 for triggering new generation (
\begin_inset Formula $e_{\min}\ge0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Elastic (strong bond) material
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<bond>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Weak bond material
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<relaxation>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reduced relaxation function
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<recruitment>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Weak bond recruitment function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <kinetics> parameter should be set to 1 for Type I bond kinetics or 2 for Type II bond kinetics.
 The <trigger> parameter should be set 0 when weak bonds break and reform in response to any form of the strain;
 it should be set to 1 when the trigger is distortional strain;
 and it should be set to 2 when the trigger is dilatational strain,
\begin_inset Formula 
\begin{equation}
\text{trigger}=\begin{cases}
1\text{ for any strain} & \left\Vert \Delta\mathbf{E}\right\Vert \\
2\text{ for distortional strain} & \left\Vert \dev\Delta\boldsymbol{\eta}\right\Vert \\
3\text{ for dilatational strain} & \left|\ln\left(\det\Delta\mathbf{F}\right)\right|
\end{cases}\label{eq:rvs-trigger}
\end{equation}

\end_inset

where 
\begin_inset Formula $\Delta\mathbf{E}=\frac{1}{2}\left(\Delta\mathbf{F}^{T}\cdot\Delta\mathbf{F}-\mathbf{I}\right)$
\end_inset

 is the incremental Lagrange strain,
 
\begin_inset Formula $\Delta\boldsymbol{\eta}=\ln\Delta\mathbf{V}$
\end_inset

 is the incremental natural strain,
 where 
\begin_inset Formula $\Delta\mathbf{V}$
\end_inset

 is the left stretch tensor of 
\begin_inset Formula $\Delta\mathbf{F}$
\end_inset

,
 and 
\begin_inset Formula $\Delta\mathbf{F}=\mathbf{F}\left(t_{n+1}\right)\cdot\mathbf{F}^{-1}\left(t^{m}\right)$
\end_inset

,
 where 
\begin_inset Formula $t_{n+1}$
\end_inset

 is the current time and 
\begin_inset Formula $t^{m}$
\end_inset

 is the birth time of the most recent weak bond generation.
\end_layout

\begin_layout Standard
The <elastic> and <bond> materials may be selected from the list of unconstrained elastic materials given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

 (for 
\begin_inset Quotes eld
\end_inset

reactive viscoelastic
\begin_inset Quotes erd
\end_inset

) or from the list of uncoupled elastic materials in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

 (for 
\begin_inset Quotes eld
\end_inset

uncoupled reactive viscoelastic
\begin_inset Quotes erd
\end_inset

).
 The <relaxation> material may be selected from the list of reduced relaxation functions provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Relaxation-Functions"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
The <recruitment> material may be selected from the list of weak bond recruitment functions 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Cumulative-Distribution-Function"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 This optional material specification can be used to model nonlinear viscoelasticity where the weak bond response becomes more significant with increasing strain,
 substituting eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rvs-sed"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 with
\begin_inset Formula 
\begin{equation}
\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\sum\limits_{u}w^{u}F\left(\Xi\left(u\right)\right)\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)\,.\label{eq:rvs-reformed-with-recruitment}
\end{equation}

\end_inset

Here,
 
\begin_inset Formula $\Xi$
\end_inset

 is a measure of the current state of strain,
 similar to the measures shown in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rvs-trigger"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Thus,
 
\begin_inset Formula $\Xi=\left\Vert \mathbf{E}\right\Vert $
\end_inset

,
 or 
\begin_inset Formula $\Xi=\left\Vert \dev\boldsymbol{\eta}\right\Vert $
\end_inset

,
 or 
\begin_inset Formula $\Xi=\left|\ln\left(\det\mathbf{F}\right)\right|$
\end_inset

,
 based on the choice of the <trigger> parameter.
 In effect,
 
\begin_inset Formula $F\left(\Xi\left(u\right)\right)$
\end_inset

 enhances the weak bond response of generation 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard
The parameters <wmin> and <emin> can be adjusted to improve computational efficiency by reducing the number of generations 
\begin_inset Formula $u$
\end_inset

 in an analysis.
 In practice,
 the value of <emin> should be no greater than one-hundredth of the equilibrium strain in a loading configuration.
 The parameter <wmin> must be in the range 
\begin_inset Formula $0\le w_{\min}\le1$
\end_inset

.
 In practice,
 a good balance between accuracy and efficiency is achieved by using 
\begin_inset Formula $w_{\min}\le0.05$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout LyX-Code
<material id="1" name="RV solid" type="reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
  <kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
  <trigger>0</trigger>
\end_layout

\begin_layout LyX-Code
  <wmin>0.05</wmin>
\end_layout

\begin_layout LyX-Code
  <emin>0.001</emin>
\end_layout

\begin_layout LyX-Code
  <elastic type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>1</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
    <beta>0.5</beta>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <bond type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>1</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
    <beta>0.5</beta>
\end_layout

\begin_layout LyX-Code
  </bond>
\end_layout

\begin_layout LyX-Code
  <relaxation type="relaxation-exponential">
\end_layout

\begin_layout LyX-Code
    <tau>4</tau>
\end_layout

\begin_layout LyX-Code
  </relaxation>
\end_layout

\begin_layout LyX-Code
  <recruitment type="recruitment power">
\end_layout

\begin_layout LyX-Code
    <mu0>1</mu0>
\end_layout

\begin_layout LyX-Code
    <mu1>30</mu1>
\end_layout

\begin_layout LyX-Code
    <alpha>2</alpha>
\end_layout

\begin_layout LyX-Code
    <scale>1</scale>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsection
Relaxation Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Relaxation-Functions"

\end_inset


\end_layout

\begin_layout Subsubsection
Exponential
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exponential"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-exponential
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(t\right)=e^{-t/\tau}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Exponential Distortional
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exp-Distortional"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-exp-distortion
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic time 
\begin_inset Formula $\tau_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=e^{-\left(t-v\right)/\tau\left[K_{2}\left(v\right)\right]}
\]

\end_inset

where 
\begin_inset Formula 
\[
\tau\left(K_{2}\left(v\right)\right)=\tau_{0}+\tau_{1}\cdot\left(K_{2}\left(v\right)\right)^{\alpha}
\]

\end_inset

In general,
 
\begin_inset Formula $K_{2}=\left|\dev\boldsymbol{\eta}\right|$
\end_inset

 where 
\begin_inset Formula $\boldsymbol{\eta}=\ln\mathbf{V}$
\end_inset

 is the spatial natural (left Hencky) strain tensor and 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is the left stretch tensor.
 
\begin_inset Formula $K_{2}$
\end_inset

 is evaluated at the time 
\begin_inset Formula $v$
\end_inset

 when weak bonds from the 
\begin_inset Formula $u-$
\end_inset

generation start breaking.
\end_layout

\begin_layout Subsubsection
Exponential Distortional User-Specified
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exp-Dist-User"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-exp-dist-user
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=e^{-\left(t-v\right)/\tau\left[K_{2}\left(v\right)\right]}
\]

\end_inset

where 
\begin_inset Formula $\tau\left(K_{2}\left(v\right)\right)$
\end_inset

 is given as a mathematical expression (type=
\begin_inset Quotes qrd
\end_inset

math
\begin_inset Quotes qrd
\end_inset

),
 or as a loadcurve (type=
\begin_inset Quotes qrd
\end_inset

point
\begin_inset Quotes qrd
\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="RVE" type="reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
  <kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
  <trigger>1</trigger>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>0.13</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <bond type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>0.52</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </bond>
\end_layout

\begin_layout LyX-Code
  <relaxation type="relaxation-exp-dist-user">
\end_layout

\begin_layout LyX-Code
    <tau type="math">1.0+2.0*(K2^0.5)</tau>
\end_layout

\begin_layout LyX-Code
  </relaxation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="RVE UC" type="uncoupled reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
  <kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
  <trigger>1</trigger>
\end_layout

\begin_layout LyX-Code
  <k>25</k>
\end_layout

\begin_layout LyX-Code
  <elastic type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <c1>0.025</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <bond type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <c1>0.025</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </bond>
\end_layout

\begin_layout LyX-Code
  <relaxation type="relaxation-exp-dist-user">
\end_layout

\begin_layout LyX-Code
    <tau type="point">
\end_layout

\begin_layout LyX-Code
      <interpolate>SMOOTH</interpolate>
\end_layout

\begin_layout LyX-Code
      <points>
\end_layout

\begin_layout LyX-Code
        <point>0.00,
 1.00</point>
\end_layout

\begin_layout LyX-Code
        <point>0.25,
 2.00</point>
\end_layout

\begin_layout LyX-Code
        <point>0.50,
 2.41</point>
\end_layout

\begin_layout LyX-Code
        <point>0.75,
 2.73</point>
\end_layout

\begin_layout LyX-Code
        <point>1.00,
 3.00</point>
\end_layout

\begin_layout LyX-Code
      </points>
\end_layout

\begin_layout LyX-Code
    </tau>
\end_layout

\begin_layout LyX-Code
  </relaxation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Exponential Continuous Spectrum
\begin_inset CommandInset label
LatexCommand label
name "subsec:CSexp"

\end_inset


\end_layout

\begin_layout Standard
This relaxation function is derived from a continuous exponential relaxation spectrum,
 see 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
 The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-CSexp
\begin_inset Quotes erd
\end_inset

.
 The following material parameter needs to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This parameter must satisfy 
\begin_inset Formula $\tau>0$
\end_inset

.
 The reduced relaxation function for this material type is given by
\begin_inset Formula 
\[
g\left(t\right)=2\sqrt{\frac{t}{\tau}}K_{1}\left(2\sqrt{\frac{t}{\tau}}\right)
\]

\end_inset

where 
\begin_inset Formula $K_{1}\left(z\right)$
\end_inset

 is the modified Bessel function of the second kind,
 of order 1.
\end_layout

\begin_layout Subsubsection
Exponential Continuous Spectrum Distortional User-Specified
\begin_inset CommandInset label
LatexCommand label
name "subsec:CSexp-dist-user"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:CSexp"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for the description of this relaxation function.
 When the material parameters vary with the distortional strain 
\begin_inset Formula $K_{2}$
\end_inset

,
 the material type is 
\begin_inset Quotes eld
\end_inset

relaxation-CSexp-dist-user
\begin_inset Quotes erd
\end_inset

.
 The following material parameter needs to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The definition of 
\begin_inset Formula $K_{2}$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for examples of how to specify these functions.
\end_layout

\begin_layout Subsubsection
Fung
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fung"

\end_inset


\end_layout

\begin_layout Standard
This relaxation function,
 which is derived from a continuous relaxation spectrum,
 was introduced by Fung 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung81"
literal "false"

\end_inset

.
 The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Fung
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{2}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
These parameters must satisfy 
\begin_inset Formula $\tau_{2}>\tau_{1}$
\end_inset

.
 The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(t\right)=\frac{\tau_{2}e^{-t/\tau_{2}}-\tau_{1}e^{-t/\tau_{1}}+t\left[\Ei\left(-\frac{t}{\tau_{2}}\right)-\Ei\left(-\frac{t}{\tau_{1}}\right)\right]}{\tau_{2}-\tau_{1}}
\]

\end_inset

where 
\begin_inset Formula $\Ei\left(\cdot\right)$
\end_inset

 is the exponential integral function.
\end_layout

\begin_layout Subsubsection
Malkin
\begin_inset CommandInset label
LatexCommand label
name "subsec:Malkin"

\end_inset


\end_layout

\begin_layout Standard
This relaxation function is derived from the continuous relaxation spectrum given in 
\begin_inset CommandInset citation
LatexCommand citep
key "Malkin06"
literal "false"

\end_inset

.
 The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Malkin
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset

 (
\begin_inset Formula $\ge1$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
These parameters must satisfy 
\begin_inset Formula $\tau_{2}>\tau_{1}>0$
\end_inset

.
 When 
\begin_inset Formula $\beta>1$
\end_inset

,
 the reduced relaxation function for this material type is given by
\begin_inset Formula 
\[
g\left(t\right)=\frac{\left(\beta-1\right)t^{1-\beta}}{\tau_{1}^{1-\beta}-\tau_{2}^{1-\beta}}\left[\Gamma\left(\beta-1,\frac{t}{\tau_{2}}\right)-\Gamma\left(\beta-1,\frac{t}{\tau_{1}}\right)\right]
\]

\end_inset

where 
\begin_inset Formula $\Gamma\left(a,z\right)$
\end_inset

 is the incomplete gamma function.
 In the limit as 
\begin_inset Formula $\beta\to1$
\end_inset

 this function reduces to the form given by 
\begin_inset CommandInset citation
LatexCommand citep
key "Fung72"
literal "false"

\end_inset

,
\begin_inset Formula 
\[
g\left(t\right)=\frac{\Gamma\left(0,\frac{t}{\tau_{2}}\right)-\Gamma\left(0,\frac{t}{\tau_{1}}\right)}{\ln\frac{\tau_{2}}{\tau_{1}}}=\frac{\Ei\left(-\frac{t}{\tau_{2}}\right)-\Ei\left(-\frac{t}{\tau_{1}}\right)}{\ln\frac{\tau_{1}}{\tau_{2}}}
\]

\end_inset

where 
\begin_inset Formula $\Ei\left(z\right)$
\end_inset

 is the exponential integral function.
\end_layout

\begin_layout Subsubsection
Malkin Distortional
\begin_inset CommandInset label
LatexCommand label
name "subsec:Malkin-distortional"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Malkin"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for the description of this relaxation function.
 When the material parameters vary with the distortional strain 
\begin_inset Formula $K_{2}$
\end_inset

 according to
\begin_inset Formula 
\[
\begin{aligned}\tau_{1}\left(K_{2}\right) & =\tau_{10}+\tau_{11}\exp\left(-\frac{K_{2}}{s_{1}}\right)\\
\tau_{2}\left(K_{2}\right) & =\tau_{20}+\tau_{21}\exp\left(-\frac{K_{2}}{s_{2}}\right)
\end{aligned}
\]

\end_inset

 the material type is 
\begin_inset Quotes eld
\end_inset

relaxation-Malkin-distortion
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1c0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\tau_{10}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1c1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\tau_{11}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1s0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $s_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t2c0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\tau_{20}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t2c1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\tau_{21}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t2s0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $s_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poiwer exponent 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The definition of 
\begin_inset Formula $K_{2}$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for examples of how to specify these functions.
\end_layout

\begin_layout Subsubsection
Malkin Distortional User-Specified
\begin_inset CommandInset label
LatexCommand label
name "subsec:Malkin-dist-user"

\end_inset


\end_layout

\begin_layout Standard
See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Malkin"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for the description of this relaxation function.
 When the material parameters vary with the distortional strain 
\begin_inset Formula $K_{2}$
\end_inset

,
 the material type is 
\begin_inset Quotes eld
\end_inset

relaxation-Malkin-dist-user
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1 type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau2 type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The definition of 
\begin_inset Formula $K_{2}$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for examples of how to specify these functions.
\end_layout

\begin_layout Subsubsection
Park
\begin_inset CommandInset label
LatexCommand label
name "subsec:Park"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Park
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(t\right)=\frac{1}{1+\left(\frac{t}{\tau}\right)^{\beta}}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Park Distortional
\begin_inset CommandInset label
LatexCommand label
name "subsec:Park-Distortional"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Park-distortion
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent at zero strain 
\begin_inset Formula $\beta_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent at zero strain 
\begin_inset Formula $\beta_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=\frac{1}{1+\left(\frac{t-v}{\tau}\right)^{\beta}}
\]

\end_inset

where 
\begin_inset Formula 
\[
\tau=\tau_{0}+\tau_{1}\cdot\left(K_{2}\left(v\right)\right)^{\alpha}
\]

\end_inset

and 
\begin_inset Formula 
\[
\beta=\beta_{0}+\beta_{1}\cdot\left(K_{2}\left(v\right)\right)^{\alpha}
\]

\end_inset

The definition of 
\begin_inset Formula $K_{2}\left(v\right)$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Park Distortional User-Specified
\begin_inset CommandInset label
LatexCommand label
name "subsec:Park-Dist-User"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Park-dist-user
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=\frac{1}{1+\left(\frac{t-v}{\tau}\right)^{\beta}}
\]

\end_inset

where 
\begin_inset Formula $\tau\left(K_{2}\left(v\right)\right)$
\end_inset

 and 
\begin_inset Formula $\beta\left(K_{2}\left(v\right)\right)$
\end_inset

 are user-specified functions,
 given either as mathematical expressions or loadcurves.
 The definition of 
\begin_inset Formula $K_{2}\left(v\right)$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for examples of how to specify these functions.
\end_layout

\begin_layout Subsubsection
Power
\begin_inset CommandInset label
LatexCommand label
name "subsec:Power"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-power
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(t\right)=\frac{1}{\left(1+\frac{t}{\tau}\right)^{\beta}}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Power Distortional
\begin_inset CommandInset label
LatexCommand label
name "subsec:Power-Distortional"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-power-distortion
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent at zero strain 
\begin_inset Formula $\beta_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent at zero strain 
\begin_inset Formula $\beta_{1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=\frac{1}{\left(1+\frac{t-v}{\tau}\right)^{\beta}}
\]

\end_inset

where 
\begin_inset Formula 
\[
\tau=\tau_{0}+\tau_{1}\cdot\left(K_{2}\left(v\right)\right)^{\alpha}
\]

\end_inset

and 
\begin_inset Formula 
\[
\beta=\beta_{0}+\beta_{1}\cdot\left(K_{2}\left(v\right)\right)^{\alpha}
\]

\end_inset

The definition of 
\begin_inset Formula $K_{2}\left(v\right)$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Power
\begin_inset CommandInset label
LatexCommand label
name "subsec:Power-dist-user"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-power-dist-user
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta type=
\begin_inset Quotes qrd
\end_inset

math | point
\begin_inset Quotes qrd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(\mathbf{F}\left(v\right);t-v\right)=\frac{1}{\left(1+\frac{t-v}{\tau}\right)^{\beta}}
\]

\end_inset

where 
\begin_inset Formula $\tau\left(K_{2}\left(v\right)\right)$
\end_inset

 and 
\begin_inset Formula $\beta\left(K_{2}\left(v\right)\right)$
\end_inset

 are user-specified functions,
 given either as mathematical expressions or loadcurves.
 The definition of 
\begin_inset Formula $K_{2}\left(v\right)$
\end_inset

 is given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
nolink "false"

\end_inset

.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Exp-Dist-User"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 for examples of how to specify these functions.
\end_layout

\begin_layout Subsubsection
Prony
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prony"

\end_inset


\end_layout

\begin_layout Standard
The material type for this relaxation function is 
\begin_inset Quotes eld
\end_inset

relaxation-Prony
\begin_inset Quotes erd
\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Weight factor 
\begin_inset Formula $\gamma_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<g6>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Weight factor 
\begin_inset Formula $\gamma_{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t6>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic relaxation time 
\begin_inset Formula $\tau_{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The reduced relaxation function for this material type is given by 
\begin_inset Formula 
\[
g\left(t\right)=\frac{\sum_{i=1}^{6}\gamma_{i}e^{-t/\tau_{i}}}{\sum_{i=1}^{6}\gamma_{i}}
\]

\end_inset

The coefficients 
\begin_inset Formula $\gamma_{i}$
\end_inset

 are normalized by 
\begin_inset Formula $\sum_{i}\gamma_{i}$
\end_inset

 to enforce 
\begin_inset Formula $g\left(0\right)=1$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Weak Bond Recruitment Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Weak-Bond-Recruitment"

\end_inset


\end_layout

\begin_layout Standard
Weak bond recruitment functions make it possible to model highly nonlinear viscoelastic responses,
 where the viscous part of the response increases with increasing strain.
\end_layout

\begin_layout Subsubsection
Power
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-power"

\end_inset


\end_layout

\begin_layout Standard
The material type for a power weak bond recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment power
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{0}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{1}$
\end_inset

 (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\alpha$
\end_inset

 (default=2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<scale>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scale factor 
\begin_inset Formula $s$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment function is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\mu_{0}+\mu_{1}\left(\frac{\Xi}{s}\right)^{\alpha},
\]

\end_inset

where 
\begin_inset Formula $\Xi$
\end_inset

 is the measure of strain that triggers a new reactive weak bond generation.
 This function is unbounded with increasing 
\begin_inset Formula $\Xi$
\end_inset

.
 Users should typically employ 
\begin_inset Formula $\mu_{0}=1$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment power">
\end_layout

\begin_layout LyX-Code
  <mu0>1</mu0>
\end_layout

\begin_layout LyX-Code
  <mu1>10</mu1>
\end_layout

\begin_layout LyX-Code
  <alpha>2</alpha>
\end_layout

\begin_layout LyX-Code
  <scale>0.06</scale>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Exponential
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-exponential"

\end_inset


\end_layout

\begin_layout Standard
The material type for an exponential weak bond recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment exponential
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{0}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{1}$
\end_inset

 (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Power exponent 
\begin_inset Formula $\alpha$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<scale>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scale factor 
\begin_inset Formula $s$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment function is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\mu_{0}\exp\left(\mu_{1}\left(\frac{\Xi}{s}\right)^{\alpha}\right)
\]

\end_inset

where 
\begin_inset Formula $\Xi$
\end_inset

 is the measure of strain that triggers a new reactive weak bond generation.
 This function is unbounded with increasing 
\begin_inset Formula $\Xi$
\end_inset

.
 Users should typically employ 
\begin_inset Formula $\mu_{0}=1$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment exponential">
\end_layout

\begin_layout LyX-Code
  <mu0>1</mu0>
\end_layout

\begin_layout LyX-Code
  <mu1>2</mu1>
\end_layout

\begin_layout LyX-Code
  <alpha>0.5</alpha>
\end_layout

\begin_layout LyX-Code
  <scale>0.06</scale>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Polynomial
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-poly"

\end_inset


\end_layout

\begin_layout Standard
The material type for a polynomial weak bond recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment polynomial
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{0}$
\end_inset

 (default=1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu1>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{1}$
\end_inset

 (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu2>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{2}$
\end_inset

 (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment function is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\mu_{0}+\mu_{1}\Xi+\mu_{2}\Xi^{2}
\]

\end_inset

where 
\begin_inset Formula $\Xi$
\end_inset

 is the measure of strain that triggers a new reactive weak bond generation.
 This function is unbounded with increasing 
\begin_inset Formula $\Xi$
\end_inset

.
 Users should typically employ 
\begin_inset Formula $\mu_{0}=1$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment poly">
\end_layout

\begin_layout LyX-Code
  <mu0>1</mu0>
\end_layout

\begin_layout LyX-Code
  <mu1>0</mu1>
\end_layout

\begin_layout LyX-Code
  <mu3>50</mu3>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
User
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-user"

\end_inset


\end_layout

\begin_layout Standard
The material type for a user-defined bond recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment user
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<function>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify a user function type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment function 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 is specified by the user.
 It can be a constant,
 linear ramp,
 mathematical expression,
 a series of points,
 or a step function.
 It is the user's responsibility to ensure that the function starts at 1 and rises monotonically.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment user">
\end_layout

\begin_layout LyX-Code
  <function type="point">
\end_layout

\begin_layout LyX-Code
    <interpolate>linear</interpolate>
\end_layout

\begin_layout LyX-Code
    <extend>constant</extend>
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <pt>0,1</pt>
\end_layout

\begin_layout LyX-Code
      <pt>0.063,1</pt>
\end_layout

\begin_layout LyX-Code
      <pt>0.13,1.8</pt>
\end_layout

\begin_layout LyX-Code
    </points>
\end_layout

\begin_layout LyX-Code
  </function>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Log-Normal
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-log-normal"

\end_inset


\end_layout

\begin_layout Standard
The material type for a log-normal recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment log-normal
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<sigma>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\sigma$
\end_inset

 (
\begin_inset Formula $\sigma>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum increase 
\begin_inset Formula $r$
\end_inset

 in bond recruitment from 1 (default is 0)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment function is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=1+\frac{r}{2}\text{erfc}\left[-\frac{\ln\left(\Xi/\mu\right)}{\sigma\sqrt{2}}\right]\,.
\]

\end_inset

Its minimum value is 
\begin_inset Formula $1$
\end_inset

 and its maximum value is 
\begin_inset Formula $1+r$
\end_inset

 as 
\begin_inset Formula $\Xi/\mu\to\infty$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment log-normal">
\end_layout

\begin_layout LyX-Code
  <mu>0.3</mu>
\end_layout

\begin_layout LyX-Code
  <sigma>0.25</sigma>
\end_layout

\begin_layout LyX-Code
  <max>4</max>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Weibull
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-Weibull"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Weibull recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment Weibull
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum increase 
\begin_inset Formula $r$
\end_inset

 in bond recruitment from 1 (default is 0)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the recruitment functions is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=1+r\left(1-\exp\left[-\left(\Xi/\mu\right)^{\alpha}\right]\right)\,.
\]

\end_inset

Its minimum value is 
\begin_inset Formula $1$
\end_inset

 and its maximum value is 
\begin_inset Formula $1+r$
\end_inset

 as 
\begin_inset Formula $\Xi/\mu\to\infty$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment Weibull">
\end_layout

\begin_layout LyX-Code
  <mu>0.3</mu>
\end_layout

\begin_layout LyX-Code
  <alpha>2.0</alpha>
\end_layout

\begin_layout LyX-Code
  <max>4</max>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Quintic Polynomial
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-quintic"

\end_inset


\end_layout

\begin_layout Standard
The material type for a quintic polynomial bond recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment quintic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mumin>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{\min}$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu_{\min}>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mumax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{\max}$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu_{\max}>\mu_{\min})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum increase 
\begin_inset Formula $r$
\end_inset

 in bond recruitment from 1 (default is 0)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the bond recruitment function is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\begin{cases}
1 & \Xi\leqslant\mu_{\min}\\
1+rx^{3}\left(10-15x+6x^{2}\right) & \mu_{\min}<\Xi\leqslant\mu_{\max}\\
1+r & \mu_{\max}<\Xi
\end{cases}\,,\quad x=\frac{\Xi-\mu_{\min}}{\mu_{\max}-\mu_{\min}}\,.
\]

\end_inset

Its minimum value is 
\begin_inset Formula $1$
\end_inset

 and its maximum value is 
\begin_inset Formula $1+r$
\end_inset

 when 
\begin_inset Formula $\Xi\ge\mu_{\text{max}}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment quintic">
\end_layout

\begin_layout LyX-Code
  <mumin>0.2</mumin>
\end_layout

\begin_layout LyX-Code
  <mumax>0.4</mumax>
\end_layout

\begin_layout LyX-Code
  <Dmax>4</Dmax>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Subsubsection
Gamma
\begin_inset CommandInset label
LatexCommand label
name "subsec:recruitment-gamma"

\end_inset


\end_layout

\begin_layout Standard
The material type for a gamma recruitment function is 
\begin_inset Quotes eld
\end_inset


\shape italic
recruitment gamma
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha>0$
\end_inset

) 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum increase 
\begin_inset Formula $r$
\end_inset

 in bond recruitment from 1 (default is 0)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the bond recruitment functions is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=1+r\frac{\gamma\left(\alpha,\Xi/\mu\right)}{\Gamma\left(\alpha,0\right)}\,,
\]

\end_inset

where 
\begin_inset Formula $\gamma\left(\alpha,z\right)$
\end_inset

 and 
\begin_inset Formula $\Gamma\left(\alpha,z\right)$
\end_inset

 are the lower and upper incomplete gamma functions,
 respectively.
 The normalization by 
\begin_inset Formula $\Gamma\left(\alpha,0\right)$
\end_inset

 ensures that this function is bounded by 
\begin_inset Formula $1\le F\left(\Xi\right)\le1+r$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<recruitment type="recruitment gamma">
\end_layout

\begin_layout LyX-Code
  <alpha>3</alpha>
\end_layout

\begin_layout LyX-Code
  <mu>0.4</mu>
\end_layout

\begin_layout LyX-Code
  <max>4</max>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Damage Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Damage-Mechanics"

\end_inset


\end_layout

\begin_layout Standard
A material may accumulate damage over a single cycle or multiple cycles of loading which alters its properties.
 In the classical framework of damage mechanics this attenuation of the material properties is described by a single scalar damage variable 
\begin_inset Formula $D$
\end_inset

 when the material is isotropic (
\begin_inset Formula $0\leqslant D\leqslant1)$
\end_inset

.
 For anisotropic materials however,
 classical frameworks require that we introduce a function of the fourth-order damage tensor 
\begin_inset Formula $\mathcal{D}$
\end_inset

 to account for anisotropic damage.
 In FEBio,
 we use a reactive damage mechanics framework where the elastic response is proportional to the total number of intact bonds in the material and where,
 at any given time in the loading history,
 
\begin_inset Formula $D$
\end_inset

 represents the mass fraction of bonds that have broken.
 In this reactive framework,
 it is possible to also model damage in anisotropic materials by assuming that multiple bond types exist in the material,
 each of which may get damaged under different circumstances.
 Each bond type 
\begin_inset Formula $b$
\end_inset

 may be described by a distinct solid constituent within a solid mixture (see Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

),
 each having its own scalar damage variable 
\begin_inset Formula $D^{b}$
\end_inset

.
\end_layout

\begin_layout Standard
For a given bond type,
 the strain energy density 
\begin_inset Formula $\Psi_{r}\left(D,\mathbf{F}\right)$
\end_inset

 of a damaged material is given by 
\begin_inset Formula 
\[
\Psi_{r}=\left(1-D\right)\Psi_{0}\,,
\]

\end_inset

where 
\begin_inset Formula $\Psi_{0}\left(\mathbf{F}\right)$
\end_inset

 is the strain energy density when all bonds of that type are intact.
 Here,
 
\begin_inset Formula $1-D$
\end_inset

 represents the mass fraction of bonds that remains intact.
 Similarly,
 the Cauchy stress 
\begin_inset Formula $\boldsymbol{\sigma}\left(D,\mathbf{F}\right)$
\end_inset

 of the damaged material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\left(1-D\right)\boldsymbol{\sigma}_{0}\,,
\]

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)$
\end_inset

 is the stress in the intact material,
 at a given strain,
 as derived from 
\begin_inset Formula $\Psi_{0}\left(\mathbf{F}\right)$
\end_inset

.
 The intact material may be based on any of the elastic materials described in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
The evolution of the damage variable 
\begin_inset Formula $D$
\end_inset

 is determined by a user-selected scalar damage criterion measure 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 (
\begin_inset Formula $\Xi$
\end_inset

 is the capital form of 
\begin_inset Formula $\xi)$
\end_inset

.
 For example,
 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 may represent the strain energy density,
 or von Mises stress,
 or maximum principal normal strain,
 etc.
 If 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 exceeds a given threshold at some state of deformation 
\begin_inset Formula $\mathbf{F}$
\end_inset

,
 then damage may initiate or progress further.
 If all bonds fail at a single threshold value 
\begin_inset Formula $\Xi_{m}$
\end_inset

,
 the material undergoes fracture.
 More commonly,
 bonds may fail with increasing probability as 
\begin_inset Formula $\Xi$
\end_inset

 increases over a given range.
 Consequently,
 the evolution of damage may be based on a user-selected cumulative distribution function (c.d.f.) 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

,
 such that 
\begin_inset Formula $D\left(t\right)=F\left(\Xi_{m}\right)$
\end_inset

 where 
\begin_inset Formula $\Xi_{m}$
\end_inset

 is the maximum value of 
\begin_inset Formula $\Xi$
\end_inset

 achieved over the loading history up until the current time 
\begin_inset Formula $t$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Damage Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Damage"

\end_inset


\end_layout

\begin_layout Standard
The material types for damage materials are 
\shape italic

\begin_inset Quotes eld
\end_inset

elastic damage
\begin_inset Quotes erd
\end_inset


\shape default
 and 
\shape italic

\begin_inset Quotes eld
\end_inset

uncoupled elastic damage
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic material
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<damage>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the cumulative distribution function 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<criterion>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the damage criterion 
\begin_inset Formula $\Xi$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <elastic> tag encloses a description of the constitutive relation of the intact elastic material and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

 for unconstrained materials (used with 
\shape italic

\begin_inset Quotes eld
\end_inset

elastic damage
\begin_inset Quotes erd
\end_inset


\shape default
) and Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Materials"
nolink "false"

\end_inset

 for uncoupled materials (used with 
\shape italic

\begin_inset Quotes eld
\end_inset

uncoupled elastic damage
\begin_inset Quotes erd
\end_inset


\shape default
).
 The <damage> tag encloses a description of the cumulative distribution function and associated material properties,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Cumulative-Distribution-Function"
nolink "false"

\end_inset

.
 The <criterion> tag encloses a description of the damage criterion,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="elastic damage">
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>0.13</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
    <alpha>8</alpha>
\end_layout

\begin_layout LyX-Code
    <mu>0.3</mu>
\end_layout

\begin_layout LyX-Code
    <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
  </damage>
\end_layout

\begin_layout LyX-Code
  <criterion type="DC max normal Lagrange strain">
\end_layout

\begin_layout LyX-Code
  </criterion>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Cumulative Distribution Functions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cumulative-Distribution-Function"

\end_inset


\end_layout

\begin_layout Standard
Cumulative distribution functions provide the function 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 that determines the evolution of the damage variable 
\begin_inset Formula $D$
\end_inset

 based on the maximum value of the failure criterion 
\begin_inset Formula $\Xi$
\end_inset

 up until the current time.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Simo
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-Simo"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "para:mylabel47"

\end_inset

 The material type for Simo's c.d.f.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF Simo
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<a>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\alpha>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<b>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\beta$
\end_inset

 (
\begin_inset Formula $0\leqslant\beta\leqslant1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=1-\beta-\left(1-\beta\right)\frac{\alpha}{\Xi}\left(1-e^{-\Xi/\alpha}\right)\,.
\]

\end_inset

Note that 
\begin_inset Formula 
\[
\lim\limits_{\Xi\to\infty}F\left(\Xi\right)=1-\beta
\]

\end_inset

represents the maximum allowable damage.
 Therefore,
 
\begin_inset Formula $\beta$
\end_inset

 regulates the maximum allowable damage,
 whereas 
\begin_inset Formula $\alpha$
\end_inset

 controls the rate at which 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 increases with increasing 
\begin_inset Formula $\Xi$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFSimo.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF Simo">
\end_layout

\begin_layout LyX-Code
  <a>0.1</a>
\end_layout

\begin_layout LyX-Code
  <b>0</b>
\end_layout

\begin_layout LyX-Code
  <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Log-Normal
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-log-normal"

\end_inset


\end_layout

\begin_layout Standard
The material type for a log-normal c.d.f.
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF log-normal
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<sigma>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\sigma$
\end_inset

 (
\begin_inset Formula $\sigma>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Dmax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum allowable damage (optional,
 default is 1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\frac{1}{2}\text{erfc}\left[-\frac{\ln\left(\Xi/\mu\right)}{\sigma\sqrt{2}}\right]\,.
\]

\end_inset

Note that 
\begin_inset Formula 
\[
F\left(\mu\right)=1/2,
\]

\end_inset

which shows that 
\begin_inset Formula $\mu$
\end_inset

 is the value of 
\begin_inset Formula $\Xi$
\end_inset

 at which half of the bonds break.
 Here,
 
\begin_inset Formula $\sigma$
\end_inset

 regulates the rate at which damage increases with increasing 
\begin_inset Formula $\Xi$
\end_inset

,
 with smaller values of 
\begin_inset Formula $\sigma$
\end_inset

 producing a more rapid increase.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFLogNormal.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF log-normal">
\end_layout

\begin_layout LyX-Code
  <mu>1</mu>
\end_layout

\begin_layout LyX-Code
  <sigma>0.5</sigma>
\end_layout

\begin_layout LyX-Code
  <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Weibull
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-Weibull"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Weibull c.d.f.
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF Weibull
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Dmax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum allowable damage (optional,
 default is 1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=1-\exp\left[-\left(\Xi/\mu\right)^{\alpha}\right]\,.
\]

\end_inset

Note that 
\begin_inset Formula 
\[
F\left(\mu\right)=1-e^{-1}\approx0.63\,,
\]

\end_inset

which shows that 
\begin_inset Formula $\mu$
\end_inset

 is the value of 
\begin_inset Formula $\Xi$
\end_inset

 at which the fraction 
\begin_inset Formula $1-e^{-1}$
\end_inset

 of bonds break.
 Here,
 
\begin_inset Formula $\alpha$
\end_inset

 regulates the rate at which damage increases with increasing 
\begin_inset Formula $\Xi$
\end_inset

,
 with higher values of 
\begin_inset Formula $\alpha$
\end_inset

 producing a more rapid increase.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFWeibull.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
  <mu>1</mu>
\end_layout

\begin_layout LyX-Code
  <alpha>5.0</alpha>
\end_layout

\begin_layout LyX-Code
  <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Quintic Polynomial
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-quintic"

\end_inset


\end_layout

\begin_layout Standard
The material type for a quintic polynomial c.d.f.
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF quintic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mumin>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{\min}$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu_{\min}>0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mumax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu_{\max}$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu_{\max}>\mu_{\min})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Dmax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum allowable damage (optional,
 default is 1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\begin{cases}
0 & \Xi\leqslant\mu_{\min}\\
x^{3}\left(10-15x+6x^{2}\right) & \mu_{\min}<\Xi\leqslant\mu_{\max}\\
1 & \mu_{\max}<\Xi
\end{cases}\,,\quad x=\frac{\Xi-\mu_{\min}}{\mu_{\max}-\mu_{\min}}\,.
\]

\end_inset

Note that 
\begin_inset Formula 
\[
F\left(\frac{1}{2}\left(\mu_{\min}+\mu_{\max}\right)\right)=\frac{1}{2}\,,
\]

\end_inset

which shows that 
\begin_inset Formula $\left(\mu_{\min}+\mu_{\max}\right)/2$
\end_inset

 is the value of 
\begin_inset Formula $\Xi$
\end_inset

 at which half of the bonds break.
 The range 
\begin_inset Formula $\mu_{\max}-\mu_{\min}$
\end_inset

 regulates the rate at which damage increases with increasing 
\begin_inset Formula $\Xi$
\end_inset

,
 with a narrower range producing a more rapid increase.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFQuintic.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF quintic">
\end_layout

\begin_layout LyX-Code
  <mumin>0.3</mumin>
\end_layout

\begin_layout LyX-Code
  <mumax>1.7</mumax>
\end_layout

\begin_layout LyX-Code
  <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Gamma
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-gamma"

\end_inset


\end_layout

\begin_layout Standard
The material type for a gamma c.d.f.
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF gamma
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha>0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi$
\end_inset

,
 
\begin_inset Formula $\mu>0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=\frac{\gamma\left(\alpha,\Xi/\mu\right)}{\Gamma\left(\alpha,0\right)}\,,
\]

\end_inset

where 
\begin_inset Formula $\gamma\left(\alpha,z\right)$
\end_inset

 and 
\begin_inset Formula $\Gamma\left(\alpha,z\right)$
\end_inset

 are the lower and upper incomplete gamma functions,
 respectively.
 The normalization by 
\begin_inset Formula $\Gamma\left(\alpha,0\right)$
\end_inset

 ensures that this function is bounded by 
\begin_inset Formula $0\le F\left(\Xi\right)\le1$
\end_inset

.
 The figure below uses 
\begin_inset Formula $\mu=0.15$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFgamma.png
	lyxscale 50
	width 4in

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF gamma">
\end_layout

\begin_layout LyX-Code
  <alpha>3</alpha>
\end_layout

\begin_layout LyX-Code
  <mu>0.15</mu>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Step
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-Step"

\end_inset


\end_layout

\begin_layout Standard
The material type for a step c.d.f.
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF step
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\mu$
\end_inset

 (same units as 
\begin_inset Formula $\Xi)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Xi$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Dmax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum allowable damage (optional,
 default is 1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the c.d.f.
 is given by 
\begin_inset Formula 
\[
F\left(\Xi\right)=H\left(\Xi\right)\quad,
\]

\end_inset

where 
\begin_inset Formula $H\left(\cdot\right)$
\end_inset

 is the Heaviside unit step function.
 The step c.d.f.
 may be used to model fracture.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Graphics
	filename Figures/FigDamageCDFStep.png

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF step">
\end_layout

\begin_layout LyX-Code
  <mu>1.0</mu>
\end_layout

\begin_layout LyX-Code
  <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
</damage>
\end_layout

\begin_layout Subsubsection
User
\begin_inset CommandInset label
LatexCommand label
name "subsec:CDF-user"

\end_inset


\end_layout

\begin_layout Standard
The material type for a user-defined CDF is 
\begin_inset Quotes eld
\end_inset


\shape italic
CDF user
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cdf>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify a user function type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material the CDF 
\begin_inset Formula $F\left(\Xi\right)$
\end_inset

 is specified by the user.
 It can be a constant,
 linear ramp,
 mathematical expression,
 a series of points,
 or a step function.
 It is the user's responsibility to ensure that the function rises monotonically from 0 to 1 and does not exceed unity.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<damage type="CDF user">
\end_layout

\begin_layout LyX-Code
  <cdf type="point">
\end_layout

\begin_layout LyX-Code
    <interpolate>control points</interpolate>
\end_layout

\begin_layout LyX-Code
    <extend>constant</extend>
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <pt>0,0</pt>
\end_layout

\begin_layout LyX-Code
      <pt>0.49,0</pt>
\end_layout

\begin_layout LyX-Code
	  <pt>0.5,0</pt>
\end_layout

\begin_layout LyX-Code
      <pt>0.99,0</pt>
\end_layout

\begin_layout LyX-Code
      <pt>1.01,1</pt>
\end_layout

\begin_layout LyX-Code
      <pt>1.49,1</pt>
\end_layout

\begin_layout LyX-Code
      <pt>1.5,1</pt>
\end_layout

\begin_layout LyX-Code
      <pt>2.5,1</pt>
\end_layout

\begin_layout LyX-Code
    </points>
\end_layout

\begin_layout LyX-Code
  </cdf>
\end_layout

\begin_layout LyX-Code
</recruitment>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Damage or Yield Criterion
\begin_inset CommandInset label
LatexCommand label
name "subsec:Damage-Yield-Criterion"

\end_inset


\end_layout

\begin_layout Standard
The damage criterion provides the functional form of 
\begin_inset Formula $\Xi\left(\mathbf{F}\right)$
\end_inset

 that determines the evolution of damage.
 It can also be used to define the yield criterion in the reactive plasticity framework.
 All the functions currently modeled in FEBio are defined over the range 
\begin_inset Formula $\Xi\in\left[0,\infty\right[$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Simo
\begin_inset CommandInset label
LatexCommand label
name "subsec:DC-Simo"

\end_inset


\end_layout

\begin_layout Standard
The material type for Simo's damage criterion 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
DC Simo
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\sqrt{2\Psi_{0}\left(\mathbf{F}\right)}
\]

\end_inset


\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC Simo"/>
\end_layout

\begin_layout Subsubsection
Strain Energy Density
\begin_inset CommandInset label
LatexCommand label
name "subsec:Strain-Energy-Density"

\end_inset


\end_layout

\begin_layout Standard
The material type for strain energy density damage criterion is 
\begin_inset Quotes eld
\end_inset


\shape italic
DC strain energy density
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\Psi_{0}\left(\mathbf{F}\right)
\]

\end_inset


\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC strain energy density"/>
\end_layout

\begin_layout Subsubsection
Specific Strain Energy
\begin_inset CommandInset label
LatexCommand label
name "subsec:Specific-Strain-Energy"

\end_inset


\end_layout

\begin_layout Standard
The material type for specific strain energy damage criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC specific strain energy
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\Psi_{0}\left(\mathbf{F}\right)/\rho
\]

\end_inset

where 
\begin_inset Formula $\rho$
\end_inset

 is the elastic material's density.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC specific strain energy"/>
\end_layout

\begin_layout Subsubsection
Von Mises Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Von-Mises-Stress"

\end_inset


\end_layout

\begin_layout Standard
The material type for von Mises stress damage or yield criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC von Mises stress
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\sqrt{\frac{3}{2}\dev\boldsymbol{\sigma}:\dev\boldsymbol{\sigma}}=\sqrt{\frac{1}{2}\left[\left(\sigma_{1}-\sigma_{2}\right)^{2}+\left(\sigma_{2}-\sigma_{3}\right)^{2}+\left(\sigma_{3}-\sigma_{1}\right)^{2}\right]}
\]

\end_inset

where 
\begin_inset Formula $\sigma_{1},\sigma_{2},\sigma_{3}$
\end_inset

 are the principal values of 
\begin_inset Formula $\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC von Mises stress"/>
\end_layout

\begin_layout Subsubsection
Maximum Shear Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Maximum-Shear-Stress"

\end_inset


\end_layout

\begin_layout Standard
The material type for maximum shear stress damage or yield criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC max shear stress
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\max\left(\frac{\left|\sigma_{1}-\sigma_{2}\right|}{2},\frac{\left|\sigma_{2}-\sigma_{3}\right|}{2},\frac{\left|\sigma_{3}-\sigma_{1}\right|}{2}\right)
\]

\end_inset

where 
\begin_inset Formula $\sigma_{1},\sigma_{2},\sigma_{3}$
\end_inset

 are the principal values of 
\begin_inset Formula $\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC max shear stress"/>
\end_layout

\begin_layout Subsubsection
Maximum Normal Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Maximum-Normal-Stress"

\end_inset


\end_layout

\begin_layout Standard
The material type for maximum normal stress damage or yield criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC max normal stress
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\max\left(\sigma_{1},\sigma_{2},\sigma_{3}\right)
\]

\end_inset

where 
\begin_inset Formula $\sigma_{1},\sigma_{2},\sigma_{3}$
\end_inset

 are the principal values of 
\begin_inset Formula $\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC max normal stress"/>
\end_layout

\begin_layout Subsubsection
Drucker Shear Stress
\begin_inset CommandInset label
LatexCommand label
name "subsec:Drucker-Shear-Stress"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Drucker shear stress criterion is 
\emph on

\begin_inset Quotes eld
\end_inset

DC Drucker shear stress
\begin_inset Quotes erd
\end_inset


\emph default
.
 It is based on the yield criterion for plasticity introduced in 
\begin_inset CommandInset citation
LatexCommand citep
key "Drucker49"
literal "true"

\end_inset

.
 For this criterion,
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=k=\left(J_{2}^{3}-cJ_{3}^{2}\right)^{1/6}
\]

\end_inset

where 
\begin_inset Formula $J_{2}=\frac{1}{2}\dev\boldsymbol{\sigma}_{0}:\dev\boldsymbol{\sigma}_{0}$
\end_inset

,
 
\begin_inset Formula $J_{3}=\det\left(\dev\boldsymbol{\sigma}_{0}\right)$
\end_inset

,
 
\begin_inset Formula $k$
\end_inset

 is the yield limit in simple shear and 
\begin_inset Formula $c$
\end_inset

 is a user-specified non-dimensional material constant which must lie in the range 
\begin_inset Formula $-\frac{27}{8}\le c\le\frac{9}{4}$
\end_inset

.
 To better understand the meaning of 
\begin_inset Formula $k$
\end_inset

,
 consider uniaxial loading of a bar which yields at the normal stress value of 
\begin_inset Formula $\sigma_{y}$
\end_inset

.
 In this case,
\begin_inset Formula 
\[
k=\frac{\sigma_{y}}{\sqrt{3}}\left(1-\frac{4}{27}c\right)^{1/6}\quad\frac{\sigma_{y}}{\sqrt{3}}\left(\frac{2}{3}\right)^{1/6}\le k\le\frac{\sigma_{y}}{\sqrt{3}}\left(\frac{3}{2}\right)^{1/6}
\]

\end_inset

In the special case when 
\begin_inset Formula $c=0$
\end_inset

 the Drucker criterion reduces to the von Mises criterion,
 with 
\begin_inset Formula $k=\sigma_{y}/\sqrt{3}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC Drucker shear stress">
\end_layout

\begin_layout LyX-Code
  <c>2.25</c>
\end_layout

\begin_layout LyX-Code
</criterion>
\end_layout

\begin_layout Subsubsection
Maximum Normal Lagrange Strain
\begin_inset CommandInset label
LatexCommand label
name "subsec:Maximum-Normal-Lagrange"

\end_inset


\end_layout

\begin_layout Standard
The material type for maximum normal Lagrange strain damage criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC max normal Lagrange strain
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
 
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\max\left(E_{1},E_{2},E_{3}\right)
\]

\end_inset

where 
\begin_inset Formula $E_{1},E_{2},E_{3}$
\end_inset

 are the principal values of 
\begin_inset Formula $\mathbf{E}=\left(\mathbf{F}^{T}\cdot\mathbf{F}-\mathbf{I}\right)/2$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<criterion type="DC max normal Lagrange strain"/>
\end_layout

\begin_layout Subsubsection
Octahedral Shear Strain
\begin_inset CommandInset label
LatexCommand label
name "subsec:Octahedral-Shear-Strain"

\end_inset


\end_layout

\begin_layout Standard
The material type for octahedral strain damage criterion is 
\shape italic

\begin_inset Quotes eld
\end_inset

DC octahedral shear strain
\begin_inset Quotes erd
\end_inset


\shape default
.
 For this criterion,
\begin_inset Formula 
\[
\Xi\left(\mathbf{F}\right)=\sqrt{\frac{2}{3}\dev\mathbf{E}:\dev\mathbf{E}}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is the Lagrange strain tensor.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Plasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Plasticity"

\end_inset


\end_layout

\begin_layout Subsection
Kinematic 
\begin_inset Quotes eld
\end_inset

Hardening
\begin_inset Quotes erd
\end_inset

 Response
\begin_inset CommandInset label
LatexCommand label
name "subsec:Kinematic-Hardening-Response"

\end_inset


\end_layout

\begin_layout Standard
Reactive plasticity models a material as a mixture of bonds that break in response to loading and reform in a stressed state 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "true"

\end_inset

.
 This framework is based on constrained reactive mixtures of solids 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10a"
literal "true"

\end_inset

.
 A reactively plastic solid consists of a mixture of 
\begin_inset Formula $n_{f}$
\end_inset

 bond families,
 all of which share the same elastic response characterized by the user-defined strain energy density 
\begin_inset Formula $\Psi_{0}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 each of which yields at a different threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 of a user-defined yield measure 
\begin_inset Formula $\Phi$
\end_inset

 (such as the von Mises stress,
 see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 When all 
\begin_inset Formula $n_{f}$
\end_inset

 bond families have yielded,
 the response becomes perfectly plastic,
 implying that the yield measure no longer increases with increasing strain.
 When 
\begin_inset Formula $n^{f}>1$
\end_inset

 the stress-strain response exhibits the characteristic kinematic 
\begin_inset Quotes eld
\end_inset

hardening
\begin_inset Quotes erd
\end_inset

 response consistent with the Bauschinger effect of classical plasticity theory 
\begin_inset CommandInset citation
LatexCommand citep
key "Skelton97"
literal "true"

\end_inset

.
 Optionally,
 an additional bond family may be included that never yields,
 remaining elastic over the entire loading history and imparting a linear 
\begin_inset Quotes eld
\end_inset

hardening
\begin_inset Quotes erd
\end_inset

 regime.
\end_layout

\begin_layout Standard
The deformation gradient of a reactive plasticity material is 
\begin_inset Formula $\mathbf{F}^{s}$
\end_inset

 and its associated mixture stress 
\begin_inset Formula $\boldsymbol{\sigma}\left(\mathbf{F}^{s}\right)$
\end_inset

 is evaluated as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}\left(\mathbf{F}^{s}\right)=\sum_{\beta}w_{\beta}\left(w_{\beta}^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{F}^{s}\right)+w_{\beta}^{y}\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{y}\right)\right)\,,\label{eq:rp-mixture-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $w_{\beta}$
\end_inset

 is the user-defined mass fraction of each bond family 
\begin_inset Formula $\beta$
\end_inset

 in the mixture,
 
\begin_inset Formula $w_{\beta}^{s}$
\end_inset

 is the evolving mass fraction of intact bonds in family 
\begin_inset Formula $\beta$
\end_inset

 which still exhibit an elastic response,
 and 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

 is the evolving mass fraction of bonds in family 
\begin_inset Formula $\beta$
\end_inset

 which have yielded (broken and reformed in a new reference configuration).
 These mass fractions satisfy 
\begin_inset Formula $\sum_{\beta}w_{\beta}=1$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{s}+w_{\beta}^{y}=1$
\end_inset

.
 The bond breaking-and-reforming reaction is denoted by 
\begin_inset Formula $\mathcal{E}_{\beta}^{s}\to\mathcal{E}_{\beta}^{y}$
\end_inset

,
 where 
\begin_inset Formula $\mathcal{E}_{\beta}^{s}$
\end_inset

 is the species associated with intact bonds while 
\begin_inset Formula $\mathcal{E}_{\beta}^{y}$
\end_inset

 is associated with yielded bonds,
 in bond family 
\begin_inset Formula $\beta$
\end_inset

.
 The mass fractions of bond family 
\begin_inset Formula $\beta$
\end_inset

 satisfy 
\begin_inset Formula $w_{\beta}^{s}=1$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}=0$
\end_inset

 prior to yielding,
 and 
\begin_inset Formula $w_{\beta}^{s}=0$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}=1$
\end_inset

 after yielding.
 Here,
 
\begin_inset Formula $\mathbf{F}_{\beta}^{y}$
\end_inset

 is the deformation gradient of yielded bonds 
\begin_inset Formula $\beta$
\end_inset

 relative to the deformation when the yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 was first reached;
 it is calculated from the relation 
\begin_inset Formula $\mathbf{F}^{s}=\mathbf{F}_{\beta}^{y}\cdot\mathbf{F}_{\beta}^{ys}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 is a function of state that maps the yielded configuration 
\begin_inset Formula $\mathbf{X}^{y}$
\end_inset

 relative to the global reference configuration 
\begin_inset Formula $\mathbf{X}^{s}$
\end_inset

.
 The specific form of the constitutive model for 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 used in FEBio can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "true"

\end_inset

 and the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
 Currently that constitutive model is not user-definable,
 though the user has the option to enforce isochoric plastic flow,
 implying that 
\begin_inset Formula $\det\mathbf{F}_{\beta}^{ys}=1$
\end_inset

.
 The stress 
\begin_inset Formula $\boldsymbol{\sigma}_{0}$
\end_inset

 in the above relation for 
\begin_inset Formula $\boldsymbol{\sigma}\left(\mathbf{F}^{s}\right)$
\end_inset

 may be evaluated for any argument 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)=\frac{1}{J}\frac{\partial\Psi_{0}}{\partial\mathbf{F}}\cdot\mathbf{F}^{T}\,,\label{eq:rp-hyperelasticity}
\end{equation}

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Subsection
Plastic Flow Curve
\begin_inset CommandInset label
LatexCommand label
name "subsec:Plastic-Flow-Curve"

\end_inset


\end_layout

\begin_layout Standard
Since each bond family behaves elastically until it yields,
 a family's yield threshold 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 is generally not the value recorded on a stress-strain curve when the slope changes.
 That value may be called the 
\shape italic
apparent yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

,
 which can be related to the true yield threshold 
\begin_inset Formula $\Phi_{m\beta}=\Phi\left(\varepsilon_{\beta}\right)$
\end_inset

,
 where 
\begin_inset Formula $\varepsilon_{\beta}$
\end_inset

 is the true (logarithmic or Hencky) strain at which bond family 
\begin_inset Formula $\beta$
\end_inset

 yields,
 by assuming a linear elastic stress-strain relationship prior to yielding,
 
\begin_inset Formula $\Phi\left(\varepsilon\right)=E\varepsilon$
\end_inset

,
 where 
\begin_inset Formula $E$
\end_inset

 is the elastic material's Young's modulus.
 This assumption makes it possible to relate the bond family mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 to the values of 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 and 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 via
\begin_inset Formula 
\[
\begin{aligned}\Phi_{m\beta} & =\Phi_{m,\beta-1}+\frac{\Upsilon_{\beta}-\Upsilon_{\beta-1}}{1-\sum_{b=0}^{\beta-1}w_{b}}\,, & \Phi_{m0} & =\Upsilon_{0}\,.\end{aligned}
\]

\end_inset

More details can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "true"

\end_inset

.
 FEBio offers several different methods for specifying the plastic flow curve parameters 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

,
 which are used internally to evaluate 
\begin_inset Formula $\Phi_{m\beta}$
\end_inset

 and 
\begin_inset Formula $w_{\beta}$
\end_inset

:
\end_layout

\begin_layout Subsubsection
User-Specified Flow Curve
\end_layout

\begin_layout Standard
A user-specified flow curve may be provided using the plastic flow curve material type 
\begin_inset Quotes eld
\end_inset


\emph on
PFC user
\emph default

\begin_inset Quotes erd
\end_inset

.
 The user enters a list of points representing 
\begin_inset Formula $\left(\varepsilon_{\beta},\Upsilon_{\beta}\right)$
\end_inset

,
 where 
\begin_inset Formula $\varepsilon_{\beta}$
\end_inset

 is the true strain corresponding to the apparent yield threshold 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

.
 Here,
 
\begin_inset Formula $\varepsilon_{\beta}$
\end_inset

 represents the total strain,
 not the plastic strain.
 The first point provided in this list,
 
\begin_inset Formula $\left(\varepsilon_{0},\Upsilon_{0}\right)$
\end_inset

,
 corresponds to the yield strain 
\begin_inset Formula $\varepsilon_{0}$
\end_inset

 and yield stress 
\begin_inset Formula $\Upsilon_{0}$
\end_inset

 for this material,
 such that the ratio 
\begin_inset Formula $\Upsilon_{0}/\varepsilon_{0}$
\end_inset

 is used internally to calculate Young's modulus 
\begin_inset Formula $E$
\end_inset

 for the selected material used in this plasticity analysis.
 It is the user's responsibility to ensure this consistency.
 The number of bond families,
 
\begin_inset Formula $n_{f}$
\end_inset

,
 is automatically set to the number of user-specified points on this flow curve.
 To maintain computational efficiency it is recommended to keep this number small,
 e.g.,
 no greater than 30 points.
 Specifying only one point produces an elastic-perfectly plastic material response.
\end_layout

\begin_layout Standard
The response produced by the reactive plasticity material will agree nearly exactly with the user-specified points as long as the strain 
\begin_inset Formula $\varepsilon$
\end_inset

 remains in the infinitesimal range.
 However,
 as the strain 
\begin_inset Formula $\varepsilon$
\end_inset

 becomes finite,
 the reactive plasticity response may deviate non-negligibly from the user-specified flow curve,
 due to the nonlinearity of the hyperelastic relation describing the elastic response of the material.
 In practice,
 for isotropic elastic responses,
 using a 
\begin_inset Quotes eld
\end_inset


\emph on
natural neo-Hookean
\emph default

\begin_inset Quotes erd
\end_inset

 material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Natural-Neo-Hookean"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) will produce the least amount of deviation when using large strains,
 since its uniaxial stress-strain response is nearly linear with 
\begin_inset Formula $\varepsilon$
\end_inset

,
 
\begin_inset Formula $\Phi\left(\varepsilon\right)=E\varepsilon\,e^{-\left(1-2\nu\right)\varepsilon}$
\end_inset

,
 where 
\begin_inset Formula $E$
\end_inset

 is Young's modulus and 
\begin_inset Formula $\nu$
\end_inset

 is Poisson's ratio.
 As 
\begin_inset Formula $\nu$
\end_inset

 approaches 
\begin_inset Formula $\frac{1}{2}$
\end_inset

 this expression produces an exact linear response under uniaxial loading,
 
\begin_inset Formula $\Phi\left(\varepsilon\right)=E\varepsilon$
\end_inset

,
 even under finite deformation.
 When using 
\begin_inset Formula $\nu<\frac{1}{2}$
\end_inset

,
 care must be taken not to exceed 
\begin_inset Formula $\varepsilon_{\text{max}}=\left(1-2\nu\right)^{-1}$
\end_inset

,
 since the slope of 
\begin_inset Formula $\Phi\left(\varepsilon\right)$
\end_inset

 becomes zero at that value and negative beyond it.
 
\end_layout

\begin_layout Subsubsection
Mathematical Expression for Flow Curve
\end_layout

\begin_layout Standard
Alternatively,
 a mathematical expression may be supplied to describe 
\begin_inset Formula $\Upsilon\left(\varepsilon\right)$
\end_inset

,
 using the plastic flow curve material type 
\begin_inset Quotes eld
\end_inset


\emph on
PFC math
\emph default

\begin_inset Quotes erd
\end_inset

.
 The following parameters must also be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<nf>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of bond families 
\begin_inset Formula $n_{f}$
\end_inset

 (
\begin_inset Formula $n_{f}>0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<e0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The value of 
\begin_inset Formula $\varepsilon_{0}$
\end_inset

 that produces 
\begin_inset Formula $\Upsilon\left(\varepsilon_{0}\right)=\Upsilon_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<emax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The highest value of 
\begin_inset Formula $\varepsilon$
\end_inset

 expected in this analysis
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
It is the user's responsibility to ensure that the supplied mathematical function produces 
\begin_inset Formula $\Upsilon_{0}/\varepsilon_{0}$
\end_inset

 equal to Young's modulus for the elastic material model being used.
 The actual response produced by the reactive plasticity material will agree nearly exactly with the mathematical expression for 
\begin_inset Formula $\Upsilon\left(\varepsilon\right)$
\end_inset

 as long as the strain 
\begin_inset Formula $\varepsilon$
\end_inset

 remains in the infinitesimal range.
 However,
 as the strain 
\begin_inset Formula $\varepsilon$
\end_inset

 becomes finite,
 the reactive plasticity response may deviate non-negligibly from the user-specified flow curve,
 due to the nonlinearity of the hyperelastic relation describing the elastic response of the material.
 In practice,
 for isotropic elastic responses,
 using a 
\begin_inset Quotes eld
\end_inset


\emph on
natural neo-Hookean
\emph default

\begin_inset Quotes erd
\end_inset

 material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Natural-Neo-Hookean"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) will produce the least amount of deviation when using large strains,
 since its uniaxial stress-strain response is nearly linear with 
\begin_inset Formula $\varepsilon$
\end_inset

,
 
\begin_inset Formula $\Phi\left(\varepsilon\right)=E\varepsilon\,e^{-\left(1-2\nu\right)\varepsilon}$
\end_inset

,
 where 
\begin_inset Formula $E$
\end_inset

 is Young's modulus and 
\begin_inset Formula $\nu$
\end_inset

 is Poisson's ratio.
 As 
\begin_inset Formula $\nu$
\end_inset

 approaches 
\begin_inset Formula $\frac{1}{2}$
\end_inset

 this expression produces an exact linear response under uniaxial loading,
 
\begin_inset Formula $\Phi\left(\varepsilon\right)=E\varepsilon$
\end_inset

,
 even under finite deformation.
 When using 
\begin_inset Formula $\nu<\frac{1}{2}$
\end_inset

,
 care must be taken not to exceed 
\begin_inset Formula $\varepsilon_{\text{max}}=\left(1-2\nu\right)^{-1}$
\end_inset

,
 since the slope of 
\begin_inset Formula $\Phi\left(\varepsilon\right)$
\end_inset

 becomes zero at that value and negative beyond it.
 
\end_layout

\begin_layout Subsubsection
Custom Flow Curve
\end_layout

\begin_layout Standard
This custom method for specifying the flow curve was provided in the paper that introduced reactive plasticity 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "true"

\end_inset

,
 therefore it is called 
\begin_inset Quotes eld
\end_inset


\emph on
PFC paper
\emph default

\begin_inset Quotes erd
\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<nf>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of bond families 
\begin_inset Formula $n_{f}$
\end_inset

 (
\begin_inset Formula $n_{f}>0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Y0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lowest yield threshold 
\begin_inset Formula $\Upsilon_{0}$
\end_inset

 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

a-b)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Phi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Ymax>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Highest yield threshold 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

a-b)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\begin_inset Formula $\Phi$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<w0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fraction 
\begin_inset Formula $w_{0}$
\end_inset

 of bonds that yield at 
\begin_inset Formula $\Upsilon_{0}$
\end_inset

 (
\begin_inset Formula $0\le w_{0}\le1$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<we>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fraction 
\begin_inset Formula $w_{e}$
\end_inset

 of bonds than never yield (
\begin_inset Formula $0\le w_{e}\le1$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<r>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bias factor 
\begin_inset Formula $r$
\end_inset

 for consecutive increments of 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 over the range 
\begin_inset Formula $\left[\Upsilon_{0},\Upsilon_{\text{max}}\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This method assumes that 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 values are evenly distributed between the 
\shape italic
initial yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\text{0}}$
\end_inset

 (e.g.,
 the yield stress) and a 
\shape italic
final yield threshold
\shape default
 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

,
 parameters which may be identified from a stress strain curve (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

a-b).
 Beyond 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

,
 the material either behaves as if it is perfectly plastic (a scenario which may be valid around the ultimate strength,
 for example),
 or it transitions to a linear hardening regime.
 
\end_layout

\begin_layout Standard
The family mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 govern the influence of each family on the overall material response.
 The simplest model for 
\begin_inset Formula $w_{\beta}$
\end_inset

 involves specifying the mass fraction of the first yielding family 
\begin_inset Formula $w_{0}$
\end_inset

,
 which controls the slope of the initial post-yield response (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

a),
 and then evenly weighting the rest of the bond families.
 In cases where the material transitions to a linear hardening regime,
 we can recover this behavior by adding one more bond family,
 
\begin_inset Formula $\beta=n_{f}$
\end_inset

,
 that never yields,
 thus remaining elastic.
 The associated mass fraction 
\begin_inset Formula $w_{\beta}$
\end_inset


\shape italic
\emph on
 for 
\begin_inset Formula $\beta=n_{f}$
\end_inset

 is called the 
\emph default
elastic mass fraction
\shape default
 and denoted 
\begin_inset Formula $w_{e}$
\end_inset

;
 a non-zero value for this parameter may be specified whenever we wish to include linear hardening behavior (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

b).
 The effect of the mass fraction parameters 
\begin_inset Formula $w_{0}$
\end_inset

 and 
\begin_inset Formula $w_{e}$
\end_inset

 is explored parametrically in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

c and Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

d,
 respectively.
 In general,
 most ductile materials have 
\begin_inset Formula $w_{0}$
\end_inset

 very close to unity,
 which provides hardening behavior over a finite strain range.
 As 
\begin_inset Formula $w_{0}\to1$
\end_inset

 the stress-strain behavior approaches perfect plasticity.
 In contrast,
 when 
\begin_inset Formula $w_{e}=0$
\end_inset

,
 the material response becomes perfectly plastic once the final yield threshold 
\begin_inset Formula $\Upsilon_{\text{max}}$
\end_inset

 has been exceeded.
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Figures/FigReactivePlasticityYieldModel.png
	lyxscale 20
	width 6in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Modeling uniaxial stress-strain curves using the parameters given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Kinematic-Hardening-Response"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Identification of parameters on idealized stress-strain curves showing (a) a plateau in the stress,
 or (b) exhibiting a region of linear hardening.
 The yielding behavior is fully described by the set of parameters 
\begin_inset Formula $\left\{ n_{f},\Upsilon_{0},\Upsilon_{\text{max}},w_{0},w_{e},r\right\} $
\end_inset

.
 Parametric variations of (c) 
\begin_inset Formula $w_{0}$
\end_inset

 and (d) 
\begin_inset Formula $w_{e}$
\end_inset

 illustrate their influence on the stress-strain response;
 other parameters are held fixed.
 In (c-d) 
\begin_inset Formula $n_{f}=10$
\end_inset

,
 
\begin_inset Formula $\Upsilon_{0}=600$
\end_inset

 MPa,
 
\begin_inset Formula $\Upsilon_{\text{max}}=1000$
\end_inset

 MPa,
 and 
\begin_inset Formula $r=1$
\end_inset

.
 In (c),
 
\begin_inset Formula $w_{e}=0$
\end_inset

 and in (d) 
\begin_inset Formula $w_{0}=0.75$
\end_inset

.
\color black

\begin_inset CommandInset label
LatexCommand label
name "fig:hardening-family-parametric-curves"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

As 
\begin_inset Formula $w_{e}$
\end_inset

 increases,
 a region of linear hardening is seen on a plot of the true stress against strain.
 For most ductile materials,
 
\begin_inset Formula $w_{e}$
\end_inset

 is usually 
\begin_inset Formula $0$
\end_inset

 or on the order of 
\begin_inset Formula $0.001$
\end_inset

.
\end_layout

\begin_layout Standard
It is also possible to introduce a 
\shape italic
bias factor
\shape default
 
\begin_inset Formula $r$
\end_inset

,
 which allows a geometric progression rather than uniform spacing of the apparent yield thresholds and family mass fractions.
 The bias factor 
\begin_inset Formula $r$
\end_inset

 has the effect of modifying the shape of the hardening region between 
\begin_inset Formula $\Upsilon_{0}$
\end_inset

 and 
\begin_inset Formula $\Upsilon_{\text{max }}$
\end_inset

 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

b).
 The full set of material parameters is then given by 
\begin_inset Formula $\left\{ n_{f},\Upsilon_{0},\Upsilon_{\text{max}},w_{0},w_{e},r\right\} $
\end_inset

.
 Setting 
\begin_inset Formula $r=1$
\end_inset

 recovers the uniform distribution.
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hardening-family-parametric-curves"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

a-b graphically describes the influence of each parameter on simplified stress-strain curves,
 showing how these parameters may be extracted from experimental data.
\end_layout

\begin_layout Standard
Default values in FEBio are 
\begin_inset Formula $n_{f}=1$
\end_inset

,
 
\begin_inset Formula $w_{0}=1$
\end_inset

,
\begin_inset Formula $w_{e}=0$
\end_inset

,
 
\begin_inset Formula $\Upsilon_{0}=\Upsilon_{\text{max}}=0$
\end_inset

,
 
\begin_inset Formula $r=0.9$
\end_inset

.
\end_layout

\begin_layout Subsection
Specification of Reactive Elasto-Plastic Solid
\begin_inset CommandInset label
LatexCommand label
name "subsec:Reactive-Elastoplastic-Solid"

\end_inset


\end_layout

\begin_layout Standard
The material type of a reactive elasto-plastic solid with kinematic hardening is 
\begin_inset Quotes eld
\end_inset


\emph on
reactive plasticity
\emph default

\begin_inset Quotes erd
\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<isochoric>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag (0 or 1) for enforcing isochoric plastic flow (1 implies 
\begin_inset Formula $\det\mathbf{F}_{\beta}^{ys}=1,\,\forall\beta$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<yield_criterion>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<flow_curve>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the plastic flow curve (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Plastic-Flow-Curve"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <elastic> tag encloses a description of the constitutive relation of the intact elastic material and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

 for unconstrained materials.
 The <yield_criterion> tag encloses a description of the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
nolink "false"

\end_inset

.
 The <flow_curve> tag encloses a description of the relation between bond mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 and apparent yield stresses 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 for the bond family 
\begin_inset Formula $\beta$
\end_inset

 as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Plastic-Flow-Curve"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.The default value in FEBio is isochoric=1.
\end_layout

\begin_layout Standard

\shape italic
Example:
 Idealized elastic-perfectly plastic response of steel (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>8.05e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>200e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.30</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <Y0>450</Y0>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
 Annealed mild steel (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>7.85e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>205e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.29</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <nf>15</nf>
\end_layout

\begin_layout LyX-Code
    <Y0>220</Y0>
\end_layout

\begin_layout LyX-Code
    <Ymax>490</Ymax>
\end_layout

\begin_layout LyX-Code
    <w0>0.973</w0>
\end_layout

\begin_layout LyX-Code
    <we>0</we>
\end_layout

\begin_layout LyX-Code
    <r>1</r>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
 Annealed copper (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>7.764e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>120e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.34</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <nf>15</nf>
\end_layout

\begin_layout LyX-Code
    <Y0>60</Y0>
\end_layout

\begin_layout LyX-Code
    <Ymax>288</Ymax>
\end_layout

\begin_layout LyX-Code
    <w0>0.988</w0>
\end_layout

\begin_layout LyX-Code
    <we>0</we>
\end_layout

\begin_layout LyX-Code
    <r>1</r>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
 Unaged maraging steel (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>8.00e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>165e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.33</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <nf>22</nf>
\end_layout

\begin_layout LyX-Code
    <Y0>398</Y0>
\end_layout

\begin_layout LyX-Code
    <Ymax>1010</Ymax>
\end_layout

\begin_layout LyX-Code
    <w0>0</w0>
\end_layout

\begin_layout LyX-Code
    <we>0</we>
\end_layout

\begin_layout LyX-Code
    <r>0.9</r>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
 Annealed aluminum 1100 (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>2.71e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>68e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.33</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <nf>18</nf>
\end_layout

\begin_layout LyX-Code
    <Y0>63</Y0>
\end_layout

\begin_layout LyX-Code
    <Ymax>112</Ymax>
\end_layout

\begin_layout LyX-Code
    <w0>0.994</w0>
\end_layout

\begin_layout LyX-Code
    <we>0</we>
\end_layout

\begin_layout LyX-Code
    <r>0.6</r>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Standard

\shape italic
Example:
 Mild steel (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="natural neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>2.71e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>206e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.30</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC math">
\end_layout

\begin_layout LyX-Code
    <nf>15</nf>
\end_layout

\begin_layout LyX-Code
    <emin>0.0008403</emin>
\end_layout

\begin_layout LyX-Code
    <emax>1.3</emax>
\end_layout

\begin_layout LyX-Code
    <plastic_response>545.46*(0.011024+eps)^0.2589</plastic_response>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Standard

\shape italic
Example:
 Steel (in-lbf-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" name="Steel" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="natural neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>29911000</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC user">
\end_layout

\begin_layout LyX-Code
  <plastic_response type="point">
\end_layout

\begin_layout LyX-Code
    <interpolate>SMOOTH</interpolate>
\end_layout

\begin_layout LyX-Code
    <points>
\end_layout

\begin_layout LyX-Code
      <point> 0.002,
 59822 </point>
\end_layout

\begin_layout LyX-Code
      <point> 0.002841,
 64450 </point>
\end_layout

\begin_layout LyX-Code
      <point> 0.00469,
 68500 </point>
\end_layout

\begin_layout LyX-Code
      <point> 0.00953,
 72000 </point>
\end_layout

\begin_layout LyX-Code
      <point> 0.0193,
 75000 </point>
\end_layout

\begin_layout LyX-Code
    </points>
\end_layout

\begin_layout LyX-Code
    </plastic_response>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard

\shape italic
Example:
 elastic-perfectly plastic response,
 using PFC math flow curve
\end_layout

\begin_layout LyX-Code
<material id="1" name="Elastoplastic Math" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <density>1</density>
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>200000</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC math">
\end_layout

\begin_layout LyX-Code
    <nf>1</nf>
\end_layout

\begin_layout LyX-Code
    <e0>0.001</e0>
\end_layout

\begin_layout LyX-Code
    <emax>1</emax>
\end_layout

\begin_layout LyX-Code
    <plastic_response type="math">200</plastic_response>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout LyX-Code
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Elasto-Plastic Damage Mechanics
\begin_inset CommandInset label
LatexCommand label
name "sec:Plasticity-with-damage"

\end_inset


\end_layout

\begin_layout Standard
Plastic deformation (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) is often coupled with damage,
 as the finite deformation and plastic flow of a loaded material typically induces some amount of failure.
 Within the constrained reactive mixture framework adopted in FEBio,
 damage is produced by bonds breaking permanently (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 which reduces the generation mass fractions 
\begin_inset Formula $w_{\beta}^{s}$
\end_inset

 or 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Zimmerman21"
literal "true"

\end_inset

.
 In our treatment of elastoplastic damage we assume that both intact and yielded bonds may become damaged.
 Intact bonds belong to the 
\begin_inset Formula $s-$
\end_inset

generation which is present at 
\begin_inset Formula $t=-\infty$
\end_inset

.
 Once yielding occurs,
 all successive generations of that family are labeled as yielded bonds 
\begin_inset Formula $y$
\end_inset

.
 This distinction is necessary so we can then distinguish between damage to intact bonds (elastic damage) and damage to yielded bonds (plastic damage),
 since intact bonds which get damaged never have the ability to yield.
 Damage to intact bonds is represented by the reaction
\begin_inset Formula $\mathcal{E}_{\beta}^{s}\to\mathcal{E}_{\beta}^{b}$
\end_inset

,
 where 
\begin_inset Formula $\mathcal{E}_{\beta}^{b}$
\end_inset

 is the species associated with broken bonds in bond family 
\begin_inset Formula $\beta$
\end_inset

.
 It may represent some initial damage value for a material with defects,
 or damage due to intermolecular failure of bonds that never yielded;
 this damage alters the value of 
\begin_inset Formula $w_{\beta}^{s}$
\end_inset

 and we refer to it as 
\emph on
elastic damage
\emph default
.
 Damage to yielded bonds represents 
\emph on
plastic damage
\emph default
;
 it is represented by the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{y}\to\mathcal{E}_{\beta}^{b}$
\end_inset

 and it alters the value of 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

.
 The mechanism of damage and the failure measure may be different for these two types of bonds,
 particularly since a stress- or energy-based failure measure may not be appropriate for plastic damage.
 It is important to note that the nature of the plastic deformation described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 remains unchanged.
 Damage modifies the material behavior by reducing the fraction of bonds in various generations,
 which scales the response accordingly.
\end_layout

\begin_layout Standard
In a reactive constrained mixture framework the insertion of damage into the reactive plasticity formulation is straightforward.
 Since bonds break permanently in a damage reaction,
 there is no need to define a function of state 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 to describe a (non-existing) reformed configuration.
 Furthermore,
 the specific free energy of broken bonds is zero.
 The scalar 
\shape italic
elastic damage criterion
\shape default
 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}^{s}\right)$
\end_inset

,
 which is taken to have the same functional form for all bond families 
\begin_inset Formula $\beta$
\end_inset

,
 is the analog to the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

 for plasticity.
 As shown in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 the main contrast with reactive plasticity is that not all bonds in the family 
\begin_inset Formula $\beta$
\end_inset

 break simultaneously at a single 
\shape italic
elastic damage threshold
\shape default
 
\begin_inset Formula $\Xi_{m\beta}^{e}$
\end_inset

.
 Instead,
 the fraction of broken bonds varies as a function of 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}^{s}\right)$
\end_inset

,
 denoted by 
\begin_inset Formula $F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

,
 such that 
\begin_inset Formula $0\le F^{e}\left(\Xi_{\beta}^{e}\right)\le1$
\end_inset

.
 Here,
 
\begin_inset Formula $F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

 is a function of state;
 it must be a monotonically increasing function of its argument to satisfy the Clausius-Duhem inequality 
\begin_inset CommandInset citation
LatexCommand citep
key "Nims16"
literal "true"

\end_inset

.
 We may view 
\begin_inset Formula $F^{e}$
\end_inset

 as a cumulative distribution function (CDF),
 whose corresponding probability distribution function (PDF) represents the probability of damage at a particular value of 
\begin_inset Formula $\Xi_{\beta}^{e}$
\end_inset

.
\end_layout

\begin_layout Subsection
Theoretical Formulation
\end_layout

\begin_layout Standard
Here,
 we sketch the structure of the elastoplastic damage theory in FEBio.
 Since each bond family in reactive plasticity yields all at once,
 we can easily split an elastoplastic damage theory into two parts to represent elastic and plastic damage regimes.
 Assume that the first yielding reaction for bond family 
\begin_inset Formula $\beta$
\end_inset

 occurs at time 
\begin_inset Formula $t=u_{\beta}$
\end_inset

.
 Prior to this initial yielding,
 the damage behavior described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 applies,
 and the material composition is generally a mixture of intact (
\begin_inset Formula $\text{\ensuremath{\mathcal{E}_{\beta}^{s}}}$
\end_inset

) and broken (
\begin_inset Formula $\mathcal{E}_{\beta}^{b}$
\end_inset

) bonds satisfying the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{s}\to\mathcal{E}_{\beta}^{b}$
\end_inset

.
 The corresponding bond mass fractions satisfy 
\begin_inset Formula $1=w_{\beta}^{s}+w_{\beta}^{b}$
\end_inset

 and 
\begin_inset Formula $w_{\beta}^{y}=0$
\end_inset

,
 where 
\begin_inset Formula $w_{\beta}^{b}=F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset

 is the elastic damage in bond family 
\begin_inset Formula $\beta$
\end_inset

.
 At 
\begin_inset Formula $t=u_{\beta}$
\end_inset

,
 the remaining intact bonds 
\begin_inset Formula $w_{\beta}^{s}=1-w_{\beta}^{b}$
\end_inset

 all yield,
 following the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{s}\to\mathcal{E}_{\beta}^{y}$
\end_inset

.
 The family mass balance is then given as 
\begin_inset Formula $1=w_{\beta}^{y}+w_{\beta}^{b}$
\end_inset

,
 since 
\begin_inset Formula $w_{\beta}^{s}=0$
\end_inset

 after yielding.
 
\end_layout

\begin_layout Standard
For time 
\begin_inset Formula $t>u_{\beta}$
\end_inset

,
 yielded bonds may continue to yield,
 but they may also sustain damage according to the reaction 
\begin_inset Formula $\mathcal{E}_{\beta}^{y}\to\mathcal{E}_{\beta}^{b}$
\end_inset

,
 which reduces their mass fraction 
\begin_inset Formula $w_{\beta}^{y}$
\end_inset

.
 Damage to yielded bonds may occur based on a function of state (often described as a plastic strain,
 though it is not an observable kinematic variable),
 which is distinct from the measure of elastic damage.
 Therefore,
 we denote the 
\shape italic
plastic damage measure
\shape default
 as 
\begin_inset Formula $\Xi^{p}\left(\mathbf{F}_{\beta}^{ys}\right)$
\end_inset

 and its cumulative distribution function by 
\begin_inset Formula $F^{p}\left(\Xi_{\beta}^{p}\right)$
\end_inset

,
 under the assumption that all bond families 
\begin_inset Formula $\beta$
\end_inset

 share the same functional forms for 
\begin_inset Formula $\Xi^{p}$
\end_inset

 and 
\begin_inset Formula $F^{p}$
\end_inset

.
 For each bond family 
\begin_inset Formula $\beta$
\end_inset

,
 only the remaining undamaged fraction 
\begin_inset Formula $1-F^{p}\left(\Xi_{\beta}^{p}\right)$
\end_inset

 of yielded bonds may break and reform as the next yielded generation.
\end_layout

\begin_layout Standard
It must be recognized that,
 just as 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 is a constitutively-prescribed function of state and does not carry the meaning of a plastic deformation gradient,
 the plastic damage measure 
\begin_inset Formula $\Xi^{p}\left(\mathbf{F}_{\beta}^{ys}\right)$
\end_inset

 is also a function of state.
 This quantity is called a plastic strain for convenience only.
\end_layout

\begin_layout Subsubsection
Stress and Damage
\end_layout

\begin_layout Standard
Recognizing that damaged (broken) bonds do not store free energy,
 the mixture stress is given by
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=\sum_{\beta}w_{\beta}\left(w_{\beta}^{s}\boldsymbol{\sigma}_{0}\left(\mathbf{F}^{s}\right)+w_{\beta}^{y}\boldsymbol{\sigma}_{0}\left(\mathbf{F}_{\beta}^{y}\right)\right)\,,\label{eq:plasticdmg-mixture-stress}
\end{equation}

\end_inset

where the stresses 
\begin_inset Formula $\boldsymbol{\sigma}_{0}$
\end_inset

 are given by the standard hyperelasticity relation in Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:rp-hyperelasticity"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 The reactive mixture equivalent of the damage variable 
\begin_inset Formula $D$
\end_inset

 may be evaluated for elastoplastic damage as the fraction of all bonds that are broken,
\begin_inset Formula 
\begin{equation}
D=w^{b}=\sum_{\beta}w_{\beta}w_{\beta}^{b}\,.\label{eq:plasticdmg-damage-variable}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Damage Measures
\begin_inset CommandInset label
LatexCommand label
name "subsec:Yielded-damage-reaction"

\end_inset


\end_layout

\begin_layout Standard
For elastic damage,
 we may use the same functional measure as proposed for plastic yielding (e.g.,
 the von Mises stress);
 this implies that the functions 
\begin_inset Formula $\Xi^{e}$
\end_inset

 and 
\begin_inset Formula $\Phi$
\end_inset

 have the same form.
 For plastic damage of bonds in family 
\begin_inset Formula $\beta$
\end_inset

,
 we use the constitutively-determined mapping 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}$
\end_inset

 to define plastic right Cauchy-Green and Lagrange strain tensors through
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{C}_{\beta}^{ys} & =\left(\mathbf{F}_{\beta}^{ys}\right)^{T}\cdot\mathbf{F}_{\beta}^{ys}\\
\mathbf{E}_{\beta}^{ys} & =\frac{1}{2}\left(\mathbf{C}_{\beta}^{ys}-\mathbf{I}\right)
\end{aligned}
\,.
\end{equation}

\end_inset

One possible constitutive relation for 
\begin_inset Formula $\Xi^{p}$
\end_inset

,
 which remains valid for general deformations,
 is to set it equal to the 
\shape italic
effective plastic strain
\shape default
 
\begin_inset Formula $e_{\beta}^{p}$
\end_inset

 for the various bond families 
\begin_inset Formula $\beta$
\end_inset

,
 
\begin_inset Formula 
\begin{equation}
e_{\beta}^{p}=\sqrt{\frac{2}{3}\dev\mathbf{E}_{\beta}^{ys}:\dev\mathbf{E}_{\beta}^{ys}}\,.\label{eq:plasticdmg-effective-plastic-strain}
\end{equation}

\end_inset

In a numerical implementation,
 the effective plastic strain 
\begin_inset Formula $e_{0}^{p}$
\end_inset

 of the first bond family to yield may be reported as the effective plastic strain in the entire material,
 for consistency with plastic strain measures in classical models of plasticity.
\end_layout

\begin_layout Standard
Quantities in this section do not represent plastic strains or plastic strain tensors,
 though we adopt the terminology due to similarities.
 Recall that the non-observable function of state 
\begin_inset Formula $\mathbf{F}_{\beta}^{ys}=\mathbf{F}_{\beta}^{ys}\left(\mathbf{F}^{s},\rho_{r\beta}^{\alpha}\right)$
\end_inset

 is a time-invariant mapping providing the reference configuration of a yielded bond 
\begin_inset Formula $y$
\end_inset

 with respect to the reference configuration of the master constituent 
\begin_inset Formula $s$
\end_inset

,
 for family 
\begin_inset Formula $\beta$
\end_inset

.
 The quantities 
\begin_inset Formula $\mathbf{C}_{\beta}^{ys}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}_{\beta}^{ys}$
\end_inset

 then also represent non-observable functions of state calculated as strain tensors.
 Consequently,
 
\begin_inset Formula $e_{\beta}^{p}$
\end_inset

 is a measure of the relative motion of the reference configuration of bond family 
\begin_inset Formula $\beta$
\end_inset

 ,
 expressed as a scalar 
\begin_inset Quotes eld
\end_inset

strain
\begin_inset Quotes erd
\end_inset

.
 Physically,
 this amounts to the modeling assumption that once the breaking-and-reforming process takes a bond family out of a local neighborhood centered about its original position,
 the bond begins to degrade with further breaking-and-reforming processes.
 That each of these quantities exists for every bond family 
\begin_inset Formula $\beta$
\end_inset

 emphasizes the lack of any true or unique plastic strain measure in this framework.
\end_layout

\begin_layout Subsection
Specification of Reactive Elasto-Plastic Damage Solid
\begin_inset CommandInset label
LatexCommand label
name "subsec:Reactive-Elastoplastic-Damage"

\end_inset


\end_layout

\begin_layout Standard
The material type of a reactive elasto-plastic damage solid with kinematic hardening is 
\begin_inset Quotes eld
\end_inset


\emph on
reactive plastic damage
\emph default

\begin_inset Quotes erd
\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<isochoric>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flag (0 or 1) for enforcing isochoric plastic flow (1 implies 
\begin_inset Formula $\det\mathbf{F}_{\beta}^{ys}=1,\,\forall\beta$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<yield_criterion>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<flow_curve>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the plastic flow curve (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Plastic-Flow-Curve"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<plastic_damage>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the plastic damage CDF 
\begin_inset Formula $F^{p}\left(\Xi_{\beta}^{p}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<plastic_damage_criterion>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the plastic damage criterion 
\begin_inset Formula $\Xi^{p}\left(\mathbf{F}_{\beta}^{ys}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic_damage>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic damage CDF 
\begin_inset Formula $F^{e}\left(\Xi_{\beta}^{e}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<elastic_damage_criterion>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the elastic damage criterion 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}^{s}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <elastic> tag encloses a description of the constitutive relation of the intact elastic material and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

 for unconstrained materials.
 The <yield_criterion> tag encloses a description of the yield criterion 
\begin_inset Formula $\Phi$
\end_inset

,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
nolink "false"

\end_inset

.
 The <flow_curve> tag encloses a description of the relation between bond mass fractions 
\begin_inset Formula $w_{\beta}$
\end_inset

 and apparent yield stresses 
\begin_inset Formula $\Upsilon_{\beta}$
\end_inset

 for the bond family 
\begin_inset Formula $\beta$
\end_inset

 as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Plastic-Flow-Curve"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 The plastic and elastic damage CDFs,
 in the <plastic_damage> and <elastic_damage> tags respectively,
 may be selected from Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Cumulative-Distribution-Function"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 whereas the corresponding damage criteria <plastic_damage_criterion> and <elastic_damage_criterion> may be selected from Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Damage-Yield-Criterion"
nolink "false"

\end_inset

.
 Default values are 
\begin_inset Formula $n_{f}=1$
\end_inset

,
 
\begin_inset Formula $w_{0}=1$
\end_inset

,
\begin_inset Formula $w_{e}=0$
\end_inset

,
 
\begin_inset Formula $\Upsilon_{0}=\Upsilon_{\text{max}}=0$
\end_inset

,
 
\begin_inset Formula $r=0.9$
\end_inset

,
 and isochoric=1.
 If only plastic damage needs to be modeled,
 the tags <elastic_damage> and <elastic_damage_criterion> may be omitted.
 If <plastic_damage> and <plastic_damage_criterion> are also omitted the material response becomes identical to the 
\begin_inset Quotes eld
\end_inset


\emph on
reactive plasticity
\emph default

\begin_inset Quotes erd
\end_inset

 material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Reactive-Elastoplastic-Solid"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
 
\shape default
\emph on
A-533 Grade B class 1 nuclear pressure vessel steel
\shape italic
\emph default
 (mm-N-s units)
\end_layout

\begin_layout LyX-Code
<material id="1" type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
  <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>8.00e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>206.9e3</E>
\end_layout

\begin_layout LyX-Code
    <v>0.29</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <yield_criterion type="
\shape italic
\emph on
DC von Mises stress
\shape default
\emph default
"/>
\end_layout

\begin_layout LyX-Code
  <flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
    <nf>10</nf>
\end_layout

\begin_layout LyX-Code
    <Y0>458</Y0>
\end_layout

\begin_layout LyX-Code
    <Ymax>730</Ymax>
\end_layout

\begin_layout LyX-Code
    <w0>0.985</w0>
\end_layout

\begin_layout LyX-Code
    <we>0.00072</we>
\end_layout

\begin_layout LyX-Code
    <r>1</r>
\end_layout

\begin_layout LyX-Code
  </flow_curve>
\end_layout

\begin_layout LyX-Code
  <plastic_damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
    <mu>3.3</mu>
\end_layout

\begin_layout LyX-Code
    <alpha>3</alpha>
\end_layout

\begin_layout LyX-Code
    <Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
  </plastic_damage>
\end_layout

\begin_layout LyX-Code
  <plastic_damage_criterion type="DC octahedral shear strain"/>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Viscoplasticity
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Viscoplasticity"

\end_inset


\end_layout

\begin_layout Standard
A reactive viscoelastic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelastic-Solid"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) consists of an 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 material,
 which imparts the equilibrium elastic response,
 and a 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 material,
 which imparts the viscous response.
 The 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 response may be attributed to strong molecular bonds (e.g.,
 covalent bonds) in a material region,
 that don't break in the absence of damage,
 whereas the 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 response is attributed to weak molecular bonds (e.g.,
 hydrogen bonds) in the material region,
 that break under loading,
 and reform in a stress-free state.
\end_layout

\begin_layout Standard
To model viscoplasticity in a reactive framework,
 one may use a 
\begin_inset Quotes eld
\end_inset


\emph on
reactive plasticity
\emph default

\begin_inset Quotes erd
\end_inset

 material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Plasticity"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) as the type of 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\begin_inset Quotes erd
\end_inset


\emph default
 material appearing in a 
\begin_inset Quotes eld
\end_inset


\emph on
reactive viscoelastic
\emph default

\begin_inset Quotes erd
\end_inset

 material.
 The 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 material may be modeled as recommended previously (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelastic-Solid"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout LyX-Code

\emph on
Example:
 Reactive visoelasticity with reactive plasticity
\end_layout

\begin_layout LyX-Code
<material id="2" name="Material2" type="reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
	<density>1</density>
\end_layout

\begin_layout LyX-Code
	<wmin>0.001</wmin>
\end_layout

\begin_layout LyX-Code
	<kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
	<trigger>0</trigger>
\end_layout

\begin_layout LyX-Code
	<emin>0</emin>
\end_layout

\begin_layout LyX-Code
	<elastic type="reactive plasticity">
\end_layout

\begin_layout LyX-Code
		<isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
		<rtol>0.0001</rtol>
\end_layout

\begin_layout LyX-Code
		<secant_tangent>1</secant_tangent>
\end_layout

\begin_layout LyX-Code
		<elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
			<E>73000</E>
\end_layout

\begin_layout LyX-Code
			<v>0.3</v>
\end_layout

\begin_layout LyX-Code
		</elastic>
\end_layout

\begin_layout LyX-Code
		<yield_criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
		<flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
			<Y0>330</Y0>
\end_layout

\begin_layout LyX-Code
			<Ymax>489</Ymax>
\end_layout

\begin_layout LyX-Code
			<w0>0.967</w0>
\end_layout

\begin_layout LyX-Code
			<we>0</we>
\end_layout

\begin_layout LyX-Code
			<nf>15</nf>
\end_layout

\begin_layout LyX-Code
			<r>1</r>
\end_layout

\begin_layout LyX-Code
		</flow_curve>
\end_layout

\begin_layout LyX-Code
	</elastic>
\end_layout

\begin_layout LyX-Code
	<bond type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
		<density>1</density>
\end_layout

\begin_layout LyX-Code
		<E>7300</E>
\end_layout

\begin_layout LyX-Code
		<v>0.3</v>
\end_layout

\begin_layout LyX-Code
	</bond>
\end_layout

\begin_layout LyX-Code
	<relaxation type="relaxation-exponential">
\end_layout

\begin_layout LyX-Code
		<tau>1.5</tau>
\end_layout

\begin_layout LyX-Code
	</relaxation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Reactive Viscoelasticity and Viscoplasticity with Damage
\begin_inset CommandInset label
LatexCommand label
name "sec:Reactive-Viscoelasticity-Damage"

\end_inset


\end_layout

\begin_layout Standard
A reactive viscoelastic material may undergo damage as detailed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian23b"
literal "false"

\end_inset

.
 Reactive viscoelastic materials (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Viscoelastic-Solid"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) consist of an 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 material,
 which imparts the equilibrium elastic response,
 and a 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 material,
 which imparts the viscous response.
 The 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 response may be attributed to strong molecular bonds (e.g.,
 covalent bonds) in a material region,
 that don't break in the absence of damage,
 whereas the 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 response is attributed to weak molecular bonds (e.g.,
 hydrogen bonds) in the material region,
 that break under loading,
 and reform in a stress-free state.
\end_layout

\begin_layout Standard
It follows from this definition that the 
\begin_inset Quotes eld
\end_inset

elastic
\begin_inset Quotes erd
\end_inset

 material of a 
\begin_inset Quotes eld
\end_inset

reactive viscoelastic
\begin_inset Quotes erd
\end_inset

 material may undergo damage,
 as described for example in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 This damage is cause by the breaking of strong molecular bonds in the material region,
 and the associated damage variable 
\begin_inset Formula $D$
\end_inset

 represents the mass fraction of the material region whose strong bonds have broken.
 However,
 when strong molecular bonds break,
 the gap between molecular constituents of that material region may increase,
 also preventing the formation of weak moleculer bonds (e.g.,
 since hydrogen bonds may only form when there is sufficient proximity between moeities associated with these bonds).
 Based on the work of Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "false"

\end_inset

,
 we can adopt the constitutive assumption that the fraction of weak bonds that fails is the same as the fraction 
\begin_inset Formula $D$
\end_inset

 of strong bonds that fail 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian23b"
literal "false"

\end_inset

.
 Therefore,
 the stress 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 produced by strong bonds in a material region may be attenuated as 
\begin_inset Formula $\left(1-D\right)\boldsymbol{\sigma}^{e}$
\end_inset

,
 just like the stress 
\begin_inset Formula $\boldsymbol{\sigma}^{b}$
\end_inset

 produced by weak bonds may be reduced to 
\begin_inset Formula $\left(1-D\right)\boldsymbol{\sigma}^{b}$
\end_inset

.
\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

reactive viscoelastic
\begin_inset Quotes erd
\end_inset

 material in FEBio automatically recognizes if its 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 component happens to be a 
\begin_inset Quotes eld
\end_inset


\emph on
elastic damage
\emph default

\begin_inset Quotes erd
\end_inset

 material,
 or a 
\begin_inset Quotes eld
\end_inset


\emph on
reactive plastic damage
\emph default

\begin_inset Quotes erd
\end_inset

 material.
 In either of these cases,
 it will prescribe the damage 
\begin_inset Formula $D$
\end_inset

 calculated from the 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 response to the 
\begin_inset Quotes eld
\end_inset


\emph on
bond
\emph default

\begin_inset Quotes erd
\end_inset

 response.
 In other words,
 it is possible to model viscoelastic damage and viscoplastic damage in FEBio.
\end_layout

\begin_layout LyX-Code

\emph on
Example:
 Reactive viscoelasticity with elastic damage
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
	<density>1</density>
\end_layout

\begin_layout LyX-Code
	<wmin>0.001</wmin>
\end_layout

\begin_layout LyX-Code
	<kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
	<trigger>0</trigger>
\end_layout

\begin_layout LyX-Code
	<emin>0.0001</emin>
\end_layout

\begin_layout LyX-Code
	<elastic type="elastic damage">
\end_layout

\begin_layout LyX-Code
		<elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
			<E>1000</E>
\end_layout

\begin_layout LyX-Code
			<v>0.3</v>
\end_layout

\begin_layout LyX-Code
		</elastic>
\end_layout

\begin_layout LyX-Code
		<damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
			<Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
			<alpha>2.5</alpha>
\end_layout

\begin_layout LyX-Code
			<mu>125</mu>
\end_layout

\begin_layout LyX-Code
			<ploc>0</ploc>
\end_layout

\begin_layout LyX-Code
		</damage>
\end_layout

\begin_layout LyX-Code
		<criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
	</elastic>
\end_layout

\begin_layout LyX-Code
	<bond type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
		<E>2000</E>
\end_layout

\begin_layout LyX-Code
		<v>0.3</v>
\end_layout

\begin_layout LyX-Code
	</bond>
\end_layout

\begin_layout LyX-Code
	<relaxation type="relaxation-exponential">
\end_layout

\begin_layout LyX-Code
		<tau>5</tau>
\end_layout

\begin_layout LyX-Code
	</relaxation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout LyX-Code

\emph on
Example:
 Reactive viscoelasticity with reactive plastic damage
\end_layout

\begin_layout LyX-Code
<material id="2" name="Material2" type="reactive viscoelastic">
\end_layout

\begin_layout LyX-Code
	<density>1</density>
\end_layout

\begin_layout LyX-Code
	<wmin>0.001</wmin>
\end_layout

\begin_layout LyX-Code
	<kinetics>1</kinetics>
\end_layout

\begin_layout LyX-Code
	<trigger>0</trigger>
\end_layout

\begin_layout LyX-Code
	<emin>0</emin>
\end_layout

\begin_layout LyX-Code
	<elastic type="reactive plastic damage">
\end_layout

\begin_layout LyX-Code
		<isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
		<rtol>0.0001</rtol>
\end_layout

\begin_layout LyX-Code
		<secant_tangent>1</secant_tangent>
\end_layout

\begin_layout LyX-Code
		<elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
			<E>73000</E>
\end_layout

\begin_layout LyX-Code
			<v>0.3</v>
\end_layout

\begin_layout LyX-Code
		</elastic>
\end_layout

\begin_layout LyX-Code
		<yield_criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
		<flow_curve type="PFC paper">
\end_layout

\begin_layout LyX-Code
			<Y0>330</Y0>
\end_layout

\begin_layout LyX-Code
			<Ymax>489</Ymax>
\end_layout

\begin_layout LyX-Code
			<w0>0.967</w0>
\end_layout

\begin_layout LyX-Code
			<we>0</we>
\end_layout

\begin_layout LyX-Code
			<nf>15</nf>
\end_layout

\begin_layout LyX-Code
			<r>1</r>
\end_layout

\begin_layout LyX-Code
		</flow_curve>
\end_layout

\begin_layout LyX-Code
		<plastic_damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
			<Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
			<alpha>0.65</alpha>
\end_layout

\begin_layout LyX-Code
			<mu>7.95</mu>
\end_layout

\begin_layout LyX-Code
			<ploc>0</ploc>
\end_layout

\begin_layout LyX-Code
		</plastic_damage>
\end_layout

\begin_layout LyX-Code
		<plastic_damage_criterion type="DC octahedral shear strain"/>
\end_layout

\begin_layout LyX-Code
	</elastic>
\end_layout

\begin_layout LyX-Code
	<bond type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
		<E>7300</E>
\end_layout

\begin_layout LyX-Code
		<v>0.3</v>
\end_layout

\begin_layout LyX-Code
	</bond>
\end_layout

\begin_layout LyX-Code
	<relaxation type="relaxation-exponential">
\end_layout

\begin_layout LyX-Code
		<tau>1.5</tau>
\end_layout

\begin_layout LyX-Code
	</relaxation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Viscoelastic Damage
\begin_inset CommandInset label
LatexCommand label
name "sec:Viscoelastic-Damage"

\end_inset


\end_layout

\begin_layout Standard
A viscoelastic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Viscoelastic-Solids"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) is fundamentally a continuum representation of the Standard Solid in classical viscoelasticity,
 valid under finite deformation in the context of quasilinear viscoelasticity.
 The standard solid consists of a spring 
\begin_inset Formula $e$
\end_inset

 in parallel with a Maxwell element (a spring 
\begin_inset Formula $s$
\end_inset

 and dashpot 
\begin_inset Formula $d$
\end_inset

 in series).
 The spring stiffness in the Maxwell element is assumed to be equal to 
\begin_inset Formula $\gamma$
\end_inset

 times the stiffness of the parallel spring.
 The elastic spring response may be a nonlinear function of the strain but the viscoelastic response must be linear (i.e.,
 it must obey Boltzmann's superposition principle,
 equivalent to stating that the Maxwell element response is governed by a linear ordinary differential equation,
 or ODE).
 In general,
 a viscoelastic material of this type may undergo damage,
 using the framework provided by Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "false"

\end_inset

.
 In FEBio we model this framework by adopting additional constitutive assumptions not provided by Simo,
 but outlined in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian23b"
literal "false"

\end_inset

 and in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
 The FEBio formulation for viscoelastic damage relies on a proper formulation of the strain energy density of the Standard Solid,
 which is then employed in the analysis of viscoelastic damage.
 The strain energy density 
\begin_inset Formula $\Psi_{r}\left(\mathbf{F}\right)$
\end_inset

 of the viscoelastic solid is given by 
\begin_inset Formula 
\[
\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\gamma\Psi_{r}^{e}\left(\mathbf{F}_{s}\right)
\]

\end_inset

where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the (observable) deformation gradient of the material (also of the elastic spring 
\begin_inset Formula $e$
\end_inset

),
 
\begin_inset Formula $\mathbf{F}_{s}$
\end_inset

 is the deformation gradient associated with the Maxwell spring 
\begin_inset Formula $s$
\end_inset

 (an internal variable which evolves based on a first-order ODE),
 and 
\begin_inset Formula $\Psi_{r}^{e}$
\end_inset

 is the strain energy density of the elastic spring.
 Let 
\begin_inset Formula $\mathbf{S}^{e}$
\end_inset

 denote the second Piola-Kirchhoff stress in the elastic spring,
 obtained from the standard hyperelasticity relation 
\begin_inset Formula $\mathbf{S}^{e}=\partial\Psi_{r}\left(\mathbf{F}\right)/\partial\mathbf{E}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is the Lagrange strain tensor evaluated from 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 It follows from the above relation for the strain energy density that 
\begin_inset Formula $\mathbf{S}\left(\mathbf{F}\right)=\mathbf{S}^{e}\left(\mathbf{F}\right)+\gamma\mathbf{S}^{e}\left(\mathbf{F}_{s}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
Damage 
\begin_inset Formula $D^{e}$
\end_inset

 is produced in the elastic spring 
\begin_inset Formula $e$
\end_inset

 according to the framework described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 based on a user-defined damage criterion 
\begin_inset Formula $\Xi^{e}\left(\mathbf{F}\right)$
\end_inset

 (such as von Mises stress or maximum principal normal stress),
 such that 
\begin_inset Formula $0\le D^{e}\le1$
\end_inset

 represents the range from zero to complete damage.
 The resulting stress in the elastic spring is now given by the attenuated value 
\begin_inset Formula $\left(1-D^{e}\right)\mathbf{S}^{e}$
\end_inset


\begin_inset Formula $\left(\mathbf{F}\right)$
\end_inset

.
 Based on Simo 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo87"
literal "false"

\end_inset

,
 FEBio assumes that the damage in the Maxwell element is similarly given by 
\begin_inset Formula $\left(1-D^{e}\right)\gamma\mathbf{S}^{e}\left(\mathbf{F}_{s}\right)$
\end_inset

.
 Thus,
 the stress in a damaged viscoelastic material in FEBio is evaluated from 
\begin_inset Formula $\left(1-D^{e}\right)\mathbf{S}\left(\mathbf{F}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
The specification of a material with 
\begin_inset Quotes eld
\end_inset


\emph on
viscoelastic damage
\emph default

\begin_inset Quotes erd
\end_inset

 takes the same form as that of a viscoelastic material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Viscoelastic-Solids"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 except that the 
\begin_inset Quotes eld
\end_inset


\emph on
elastic
\emph default

\begin_inset Quotes erd
\end_inset

 component should now consist of an 
\begin_inset Quotes eld
\end_inset


\emph on
elastic damage
\emph default

\begin_inset Quotes erd
\end_inset

 material type,
 whose specification is outlined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Reactive-Damage-Mechanics"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
 Viscoelastic damage
\end_layout

\begin_layout LyX-Code
<material id="1" name="Material1" type="viscoelastic damage">
\end_layout

\begin_layout LyX-Code
	<density>1</density>
\end_layout

\begin_layout LyX-Code
	<t1>5</t1>
\end_layout

\begin_layout LyX-Code
	<t2>1</t2>
\end_layout

\begin_layout LyX-Code
	<t3>1</t3>
\end_layout

\begin_layout LyX-Code
	<t4>1</t4>
\end_layout

\begin_layout LyX-Code
	<t5>1</t5>
\end_layout

\begin_layout LyX-Code
	<t6>1</t6>
\end_layout

\begin_layout LyX-Code
	<g0>1</g0>
\end_layout

\begin_layout LyX-Code
	<g1>2</g1>
\end_layout

\begin_layout LyX-Code
	<g2>0</g2>
\end_layout

\begin_layout LyX-Code
	<g3>0</g3>
\end_layout

\begin_layout LyX-Code
	<g4>0</g4>
\end_layout

\begin_layout LyX-Code
	<g5>0</g5>
\end_layout

\begin_layout LyX-Code
	<g6>0</g6>
\end_layout

\begin_layout LyX-Code
	<elastic type="elastic damage">
\end_layout

\begin_layout LyX-Code
		<elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
			<E>1000</E>
\end_layout

\begin_layout LyX-Code
			<v>0.3</v>
\end_layout

\begin_layout LyX-Code
		</elastic>
\end_layout

\begin_layout LyX-Code
		<damage type="CDF Weibull">
\end_layout

\begin_layout LyX-Code
			<Dmax>1</Dmax>
\end_layout

\begin_layout LyX-Code
			<alpha>2.5</alpha>
\end_layout

\begin_layout LyX-Code
			<mu>125</mu>
\end_layout

\begin_layout LyX-Code
			<ploc>0</ploc>
\end_layout

\begin_layout LyX-Code
		</damage>
\end_layout

\begin_layout LyX-Code
		<criterion type="DC von Mises stress"/>
\end_layout

\begin_layout LyX-Code
	</elastic>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Multigeneration Solids
\begin_inset CommandInset label
LatexCommand label
name "sec:Multigeneration-Solids"

\end_inset


\end_layout

\begin_layout Standard
This type of material 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian10a"
literal "true"

\end_inset

 implements a mechanism for multigenerational interstitial growth of solids whereby each growth generation 
\begin_inset Formula $\gamma$
\end_inset

 has a distinct reference configuration 
\begin_inset Formula $\mathbf{X}^{\gamma}$
\end_inset

 determined at the time 
\begin_inset Formula $t^{\gamma}$
\end_inset

 of its deposition.
 Therefore,
 the solid matrix of a growing material consists of a multiplicity of intermingled porous bodies,
 each representing a generation 
\begin_inset Formula $\gamma$
\end_inset

,
 all of which are constrained to move together in the current configuration 
\begin_inset Formula $\mathbf{x}$
\end_inset

.
 The deformation gradient of each generation is 
\begin_inset Formula $\mathbf{F}^{\gamma}=\partial\mathbf{x}/\partial\mathbf{X}^{\gamma}$
\end_inset

.
 The first generation (
\begin_inset Formula $\gamma=1)$
\end_inset

 is assumed to be present at time 
\begin_inset Formula $t^{1}=0$
\end_inset

,
 therefore its reference configuration is 
\begin_inset Formula $\mathbf{X}^{1}\equiv\mathbf{X}$
\end_inset

 and its deformation gradient 
\begin_inset Formula $\mathbf{F}^{1}=\partial\mathbf{x}/\partial\mathbf{X}^{1}$
\end_inset

 is equivalent to 
\begin_inset Formula $\mathbf{F}=\partial\mathbf{x}/\partial\mathbf{X}$
\end_inset

.
 Each generation's reference configuration 
\begin_inset Formula $\mathbf{X}^{\gamma}$
\end_inset

 has a one-to-one mapping 
\begin_inset Formula $\mathbf{F}^{\gamma1}=\partial\mathbf{X}^{\gamma}/\partial\mathbf{X}^{1}$
\end_inset

 with the master reference configuration 
\begin_inset Formula $\mathbf{X}^{1}$
\end_inset

,
 which is that of the first generation.
 This mapping is postulated based on a constitutive assumption with regard to that generation's state of stress at the time of its deposition.
 In the current implementation,
 the newly deposited generation is assumed to be in a stress-free state,
 even though the underlying material is in a loaded configuration.
 Therefore,
 the mapping between generation 
\begin_inset Formula $\gamma$
\end_inset

 and the first generation is simply 
\begin_inset Formula $\mathbf{F}^{\gamma1}=\mathbf{F}^{1}\left(\mathbf{X}^{1},t^{\gamma}\right)\equiv\mathbf{F}\left(\mathbf{X},t^{\gamma}\right)$
\end_inset

.
 In other words,
 when generation 
\begin_inset Formula $\gamma$
\end_inset

 first comes into existence,
 its reference configuration is the current configuration at time 
\begin_inset Formula $t^{\gamma}$
\end_inset

.
 Note that 
\begin_inset Formula $\mathbf{F}^{\gamma1}$
\end_inset

 is a time-invariant (though not necessarily homogeneous) quantity that is determined uniquely at the birth of a generation.
\end_layout

\begin_layout Standard
The state of stress in a multigeneration solid is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}=\sum\limits_{\gamma}\frac{1}{J^{\gamma1}}\boldsymbol{\sigma}^{\gamma}\left(\mathbf{F}^{\gamma}\right)
\]

\end_inset

where 
\begin_inset Formula $\boldsymbol{\sigma}^{\gamma}\left(\mathbf{F}^{\gamma}\right)$
\end_inset

 is the state of stress in the generation 
\begin_inset Formula $\gamma$
\end_inset

,
 as would be evaluated from a strain energy density function whose reference configuration is 
\begin_inset Formula $\mathbf{X}^{\gamma}$
\end_inset

.
 In the above equation,
 
\begin_inset Formula $J^{\gamma1}=\det\mathbf{F}^{\gamma1}$
\end_inset

 and the factor 
\begin_inset Formula $1/J^{\gamma1}$
\end_inset

 ensures that the strain energy density of each generation is properly normalized the volume of the material in the master reference configuration 
\begin_inset Formula $\mathbf{X}^{1}$
\end_inset

,
 when summing up the stresses in all the generations.
\end_layout

\begin_layout Standard
Multigeneration solids typically exhibit residual stresses when 
\begin_inset Formula $\mathbf{F}^{\gamma1}$
\end_inset

 is inhomogeneous.
\end_layout

\begin_layout Subsection
General Specification of Multigeneration Solids
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Multigen"

\end_inset


\end_layout

\begin_layout Standard
The material type for a multigeneration solid is 
\shape italic

\begin_inset Quotes eld
\end_inset

multigeneration
\begin_inset Quotes erd
\end_inset


\shape default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
As of FEBio version 2.0,
 the format for definining multi-generation materials has changed.
 The previous format where the generations are defined in the 
\shape italic
Globals 
\shape default
section is no longer supported.
\end_layout

\end_inset

.
 This material describes a mixture of elastic solids,
 each created in a specific generation.
 It is a container for any combination of the elastic materials described.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<generation>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Definition of a generation.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <generation> tag defines a new generation.
 It takes the following child elements.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<start_time>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

birth
\begin_inset Quotes erd
\end_inset

-time for this generation
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the constitutive model for this generation
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The 
\shape italic
solid 
\shape default
element defins the solid matrix constitutive relation and associated material properties.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Growing Solid" type="multigeneration">
\end_layout

\begin_layout LyX-Code
  <generation id="1">
\end_layout

\begin_layout LyX-Code
    <start_time>0.0</start_time>
\end_layout

\begin_layout LyX-Code
    <solid type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
      <density>1</density>
\end_layout

\begin_layout LyX-Code
      <E>1</E>
\end_layout

\begin_layout LyX-Code
      <v>0</v>
\end_layout

\begin_layout LyX-Code
      <beta>0.1</beta>
\end_layout

\begin_layout LyX-Code
    </solid>
\end_layout

\begin_layout LyX-Code
  </generation>
\end_layout

\begin_layout LyX-Code
  <generation id="2">
\end_layout

\begin_layout LyX-Code
    <start_time>1.0</start_time>
\end_layout

\begin_layout LyX-Code
    <solid type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
      <density>1</density>
\end_layout

\begin_layout LyX-Code
      <E>1</E>
\end_layout

\begin_layout LyX-Code
      <v>0</v>
\end_layout

\begin_layout LyX-Code
      <beta>0.1</beta>
\end_layout

\begin_layout LyX-Code
    </solid>
\end_layout

\begin_layout LyX-Code
  </generation>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The corresponding value of 
\begin_inset Formula $t^{\gamma}$
\end_inset

 for each of the generations is provided in the <Globals> section.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Generations>
\end_layout

\begin_layout LyX-Code
    <gen id="1">0.0</gen>
\end_layout

\begin_layout LyX-Code
    <gen id="2">1.0</gen>
\end_layout

\begin_layout LyX-Code
  </Generations>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Materials"

\end_inset


\end_layout

\begin_layout Standard
Biphasic materials may be used to model a porous medium consisting of a mixture of a porous-permeable solid matrix and an interstitial fluid.
 Each of these mixture constituents is assumed to be intrinsically incompressible.
 This means that the true densities of the solid and fluid are invariant in space and time;
 this assumption further implies that a biphasic mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure.
 Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions.
 The Cauchy stress 
\begin_inset Formula ${\rm \boldsymbol{\sigma}}$
\end_inset

 in a biphasic material is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+{\rm \boldsymbol{\sigma}}^{e}\,,\label{eq:bp-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the interstitial fluid pressure and 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress resulting from the deformation of the porous solid matrix.
 Therefore,
 the constitutive relation of the solid matrix should be chosen from the list of unconstrained materials provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The user is referred to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

 for a general description of the biphasic theory.
\end_layout

\begin_layout Standard
In addition to selecting a constitutive relation for the solid matrix,
 a constitutive relation must also be selected for the hydraulic permeability of the interstitial fluid flowing within the porous deformable solid matrix.
 The hydraulic permeability relates the volumetric flux of the fluid relative to the solid,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

,
 to the interstitial fluid pressure gradient,
 
\begin_inset Formula $\nabla p$
\end_inset

,
 according to
\begin_inset Formula 
\begin{equation}
\mathbf{w}=-\mathbf{k}\cdot\grad p\,,\label{eq:bp-flux}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability tensor.
 (Note that this expression does not account for the contribution of external body forces on the fluid.)
\end_layout

\begin_layout Standard
The governing equations for biphasic materials are the mixture momentum balance under quasi-static conditions,
 in the absence of external body force,
 
\begin_inset Formula 
\begin{equation}
\divg{\rm \boldsymbol{\sigma}}=-\grad p+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,,\label{eq:bp-momentum-balance}
\end{equation}

\end_inset

and the mixture mass balance,
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\label{eq:bp-mixture-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

 is the solid velocity.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Biphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Biphasic"

\end_inset


\end_layout

\begin_layout Standard
The material type for a biphasic material is 
\shape italic

\begin_inset Quotes eld
\end_inset

biphasic
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the solid matrix
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in the reference configuration (
\begin_inset Formula $0<\varphi_{r}^{s}<1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fluid_density>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid density 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<permeability>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the hydraulic permeability
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solvent_supply>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fluid supply 
\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tau>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stabilization parameter 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <solid> tag encloses a description of the solid matrix constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The <permeability> tag encloses a description of the permeability constitutive relation and associated material properties,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Permeability-Materials"
nolink "false"

\end_inset

.
 The parameter <phi0> must be greater than 0 (no solid) and less than 1 (no porosity).
 The volume fraction of fluid (also known as the porosity) in the reference configuration is given by 
\begin_inset Formula $1-\varphi_{r}^{s}$
\end_inset

.
 The fluid density 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 specified in <fluid_density> and the solid density 
\begin_inset Formula $\rho_{T}^{s}$
\end_inset

 specified in <density> within the <solid> tag are needed only when body forces are prescribed.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Biphasic tissue" type="biphasic">
\end_layout

\begin_layout LyX-Code
  <solid name="Elasticity" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
  <permeability name="Permeability" type="perm-const-iso">
\end_layout

\begin_layout LyX-Code
    ...
 (description of permeability material)
\end_layout

\begin_layout LyX-Code
  </permeability>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The stabilization parameter 
\begin_inset Formula $\tau$
\end_inset

 can be used to reduced oscillations in the fluid pressure field produced under certain loading conditions,
 when the finite element mesh is relatively coarse in the vicinity of a free-draining boundary (a boundary on which the fluid pressure is set to zero).
 When this occurs it is best to refine the mesh (create thinner elements in the direction normal to the boundary) to overcome these oscillations.
 When mesh refinement is not feasible or practical,
 one may use a non-zero stabilization parameter 
\begin_inset Formula $\tau$
\end_inset

.
 FEBio uses an implementation based on the formulation of Aguilar et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Aguilar08"
literal "false"

\end_inset

.
 In our adaptation of this formulation the parameter 
\begin_inset Formula $\tau$
\end_inset

 has units of time.
 Its value is best estimated by identifying the thickness 
\begin_inset Formula $h$
\end_inset

 of elements on the free-draining boundary,
 the characteristic modulus 
\begin_inset Formula $E$
\end_inset

 of the solid matrix and hydraulic permeability 
\begin_inset Formula $k$
\end_inset

 in these elements.
 Then 
\begin_inset Formula $\tau$
\end_inset

 may be set approximately to 
\begin_inset Formula $h^{2}/\left(E\cdot k\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Permeability Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Permeability-Materials"

\end_inset


\end_layout

\begin_layout Standard
Permeability materials provide a constitutive relation for the hydraulic permeability of a biphasic material.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Constant Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
The material type for constant isotropic permeability is 
\begin_inset Quotes eld
\end_inset


\shape italic
perm-const-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeability 
\begin_inset Formula $k$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This isotropic material model uses the biphasic theory for describing the time-dependent material behavior of materials that consist of both a solid and fluid phase 
\begin_inset CommandInset citation
LatexCommand citep
key "Mow80"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
When the permeability is isotropic,
 
\begin_inset Formula 
\[
\mathbf{k}=k\,\mathbf{I}
\]

\end_inset

For this material model,
 
\begin_inset Formula $k$
\end_inset

 is constant.
 Generally,
 this assumption is only reasonable when strains are small.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<permeability name="Permeability" type="perm-const-iso">
\end_layout

\begin_layout LyX-Code
  <perm>0.001</perm>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Exponential Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Exponential-Isotropic-Permeability"

\end_inset


\end_layout

\begin_layout Standard
The material type for exponential isotropic permeability is 
\begin_inset Quotes eld
\end_inset


\shape italic
perm-exp-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic hydraulic permeability 
\begin_inset Formula $k_{0}$
\end_inset

 in the reference state
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential strain-dependence coefficient 
\begin_inset Formula $M$
\end_inset

 (
\begin_inset Formula $M\ge0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This isotropic material model has the general form
\begin_inset Formula 
\[
\mathbf{k}=k\left(J\right)\,\mathbf{I}
\]

\end_inset

where 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 is the determinant of the deformation gradient.
 For this material model,
\begin_inset Formula 
\[
k\left(J\right)=k_{0}\exp\left(M\frac{J-1}{J-\varphi_{0}}\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\varphi_{0}$
\end_inset

 is the referential solid volume fraction of the porous solid matrix.
 Pore closure occurs as 
\begin_inset Formula $J$
\end_inset

 approaches 
\begin_inset Formula $\varphi_{0}$
\end_inset

 from above,
 in which case the permeability reduces to zero,
\begin_inset Formula 
\[
\lim_{J\to\varphi_{0}}k\left(J\right)=0\,.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigPermExpIso.png
	lyxscale 50
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Exponential isotropic permeability,
 showing dependence of 
\begin_inset Formula $k\left(J\right)/k_{0}$
\end_inset

 on material parameter 
\begin_inset Formula $M$
\end_inset

,
 when 
\begin_inset Formula $\varphi_{0}=0.2$
\end_inset

 and 
\begin_inset Formula $\varphi_{0}<J\le1.2$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Representative variations of 
\begin_inset Formula $k\left(J\right)/k_{0}$
\end_inset

 are shown in the figure.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<permeability name="Permeability" type="perm-exp-iso">
\end_layout

\begin_layout LyX-Code
  <perm>0.001</perm>
\end_layout

\begin_layout LyX-Code
  <M>1.5</M>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Holmes-Mow
\begin_inset CommandInset label
LatexCommand label
name "subsec:perm-Holmes-Mow"

\end_inset


\end_layout

\begin_layout Standard
The material type for Holmes-Mow permeability is 
\shape italic

\begin_inset Quotes eld
\end_inset

perm-Holmes-Mow
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic hydraulic permeability 
\begin_inset Formula $k_{0}$
\end_inset

 in the reference state
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential strain-dependence coefficient 
\begin_inset Formula $M$
\end_inset

 (
\begin_inset Formula $M\ge0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha\ge0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This isotropic material is similar to the constant isotropic permeability material described above,
 except that it uses a strain-dependent permeability tensor 
\begin_inset CommandInset citation
LatexCommand citep
key "Holmes90"
literal "true"

\end_inset

:
 
\begin_inset Formula 
\[
\mathbf{k}=k\left(J\right)\mathbf{I},
\]

\end_inset

where,
 
\begin_inset Formula 
\[
k\left(J\right)=k_{0}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha}e^{\frac{1}{2}M\left(J^{2}-1\right)}\,,
\]

\end_inset

and 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where
\series bold
 
\begin_inset Formula $\mathbf{F}$
\end_inset

 
\series default
is the deformation gradient.
 Here,
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction in the current configuration and 
\begin_inset Formula $\varphi_{0}=\varphi_{r}^{s}\left(0\right)$
\end_inset

 is its value in the reference configuration.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a permeability material of the Holmes-Mow type.
\end_layout

\begin_layout LyX-Code
<permeability type="perm-Holmes-Mow">
\end_layout

\begin_layout LyX-Code
  <perm>0.001</perm>
\end_layout

\begin_layout LyX-Code
  <M>1.5</M>
\end_layout

\begin_layout LyX-Code
  <alpha>2</alpha>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Referentially Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Permeabi"

\end_inset


\end_layout

\begin_layout Standard
The material type for a biphasic material with strain-dependent permeability which is isotropic in the reference configuration is 
\shape italic

\begin_inset Quotes eld
\end_inset

perm-ref-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeability 
\begin_inset Formula $k_{0r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeability 
\begin_inset Formula $k_{1r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeability 
\begin_inset Formula $k_{2r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential strain-dependence coefficient 
\begin_inset Formula $M$
\end_inset

 (
\begin_inset Formula $M\geqslant0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\[
\mathbf{k}=\left(k_{0r}\mathbf{I}+\frac{k_{1r}}{J^{2}}\mathbf{b}+\frac{k_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha}e^{M\left(J^{2}-1\right)/2},
\]

\end_inset

where 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient,
 and 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 Here,
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction in the current configuration and 
\begin_inset Formula $\varphi_{0}=\varphi_{r}^{s}\left(0\right)$
\end_inset

 is its value in the reference configuration.Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is isotropic and given by 
\begin_inset Formula $\mathbf{k}=\left(k_{0r}+k_{1r}+k_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<permeability name="Permeability" type="perm-ref-iso">
\end_layout

\begin_layout LyX-Code
  <perm0>0.001</perm0>
\end_layout

\begin_layout LyX-Code
  <perm1>0.005</perm1>
\end_layout

\begin_layout LyX-Code
  <perm2>0.002</perm2>
\end_layout

\begin_layout LyX-Code
  <M>1.5</M>
\end_layout

\begin_layout LyX-Code
  <alpha>2</alpha>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Referentially Orthotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Permea"

\end_inset


\end_layout

\begin_layout Standard
The material type for a poroelastic material with strain-dependent permeability which is orthotropic in the reference configuration is 
\shape italic

\begin_inset Quotes eld
\end_inset

perm-ref-ortho
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic hydraulic permeability 
\begin_inset Formula $k_{0r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm1> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeabilities 
\begin_inset Formula $k_{1r}^{a}$
\end_inset

 along orthogonal directions (
\begin_inset Formula $a=1,2,3$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm2> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic permeabilities 
\begin_inset Formula $k_{2r}^{a}$
\end_inset

 along orthogonal directions (
\begin_inset Formula $a=1,2,3$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic exponential strain-dependence coefficient 
\begin_inset Formula $M_{0}$
\end_inset

 (
\begin_inset Formula $M_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
orthotropic exponential strain-dependence coefficient 
\begin_inset Formula $M_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3$
\end_inset

,
 
\begin_inset Formula $M_{a}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic power-law exponent 
\begin_inset Formula $\alpha_{0}$
\end_inset

 (
\begin_inset Formula $\alpha_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent 
\begin_inset Formula $\alpha_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3$
\end_inset

,
 
\begin_inset Formula $\alpha_{a}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\[
\mathbf{k}=k_{0}\mathbf{I}+\sum\limits_{a=1}^{3}k_{1}^{a}\mathbf{m}_{a}+k_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,
\]

\end_inset

where,
 
\begin_inset Formula 
\[
\begin{aligned}k_{0} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\\
k_{1}^{a} & =\frac{k_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\\
k_{2}^{a} & =\frac{k_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}
\end{aligned}
,\quad a=1,2,3\,.
\]

\end_inset


\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensors representing the spatial structural tensors describing the orthogonal planes of symmetry,
 given by 
\begin_inset Formula 
\[
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry (defined as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthotropic-Materials"
nolink "false"

\end_inset

).
 Here,
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction in the current configuration and 
\begin_inset Formula $\varphi_{0}=\varphi_{r}^{s}\left(0\right)$
\end_inset

 is its value in the reference configuration.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is given by 
\begin_inset Formula $\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits_{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<permeability name="Permeability" type="perm-ref-ortho">
\end_layout

\begin_layout LyX-Code
  <perm0>0.001</perm0>
\end_layout

\begin_layout LyX-Code
  <perm1>0.01,
 0.02,
 0.03</perm1>
\end_layout

\begin_layout LyX-Code
  <perm2>0.001,
 0.002,
 0.003</perm2>
\end_layout

\begin_layout LyX-Code
  <M0>0.5</M0>
\end_layout

\begin_layout LyX-Code
  <M>1.5,
 2.0,
 2.5</M>
\end_layout

\begin_layout LyX-Code
  <alpha0>1.5</alpha0>
\end_layout

\begin_layout LyX-Code
  <alpha>2,
 2.5,
 3</alpha>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Referentially Transversely Isotropic Permeability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Trans-Iso-Perm"

\end_inset


\end_layout

\begin_layout Standard
The material type for a biphasic material with strain-dependent permeability which is transversely isotropic in the reference configuration is 
\shape italic

\begin_inset Quotes eld
\end_inset

perm-ref-trans-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic hydraulic permeability 
\begin_inset Formula $k_{0r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm1A>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
axial hydraulic permeability 
\begin_inset Formula $k_{1r}^{A}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm2A>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
axial hydraulic permeability 
\begin_inset Formula $k_{2r}^{A}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm1T>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transverse hydraulic permeability 
\begin_inset Formula $k_{1r}^{T}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<perm2T>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transverse hydraulic permeability 
\begin_inset Formula $k_{2r}^{T}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic exponential strain-dependence coefficient 
\begin_inset Formula $M_{0}$
\end_inset

 (
\begin_inset Formula $M_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<MA>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
axial exponential strain-dependence coefficient 
\begin_inset Formula $M_{A}$
\end_inset

 (
\begin_inset Formula $M_{A}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<MT>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transverse exponential strain-dependence coefficient 
\begin_inset Formula $M_{T}$
\end_inset

 (
\begin_inset Formula $M_{T}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic power-law exponent 
\begin_inset Formula $\alpha_{0}$
\end_inset

 (
\begin_inset Formula $\alpha_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alphaA>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
axial power-law exponent 
\begin_inset Formula $\alpha_{A}$
\end_inset

 (
\begin_inset Formula $\alpha_{A}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alphaT>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
transverse power-law exponent 
\begin_inset Formula $\alpha_{T}$
\end_inset

 (
\begin_inset Formula $\alpha_{T}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\[
\begin{aligned}\mathbf{k} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{0}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\mathbf{I}\\
 & +\left(\frac{k_{1r}^{T}}{J^{2}}\left(\mathbf{b}-\mathbf{m}\right)+\frac{k_{2r}^{T}}{2J^{4}}\left[2\mathbf{b}^{2}-\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right]\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{T}}e^{M_{T}\left(J^{2}-1\right)/2}\\
 & +\left(\frac{1}{J^{2}}k_{1r}^{A}\mathbf{m}+\frac{1}{2J^{4}}k_{2r}^{A}\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{0}}\right)^{\alpha_{A}}e^{M_{A}\left(J^{2}-1\right)/2}
\end{aligned}
,
\]

\end_inset

where 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient,
 and 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 
\begin_inset Formula $\mathbf{m}$
\end_inset

 is a second order tensor representing the spatial structural tensor describing the axial direction,
 given by 
\begin_inset Formula 
\[
\mathbf{m}=\mathbf{F}\cdot\left(\mathbf{V}\otimes\mathbf{V}\right)\cdot\mathbf{F}^{T}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is a unit vector along the axial direction (defined as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

).
 Here,
 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction in the current configuration and 
\begin_inset Formula $\varphi_{0}=\varphi_{r}^{s}\left(0\right)$
\end_inset

 is its value in the reference configuration.
 Note that the permeability in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is given by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{k_{|F=I}}=\left(k_{0r}+k_{1r}^{T}+k_{2r}^{T}\right)\mathbf{I}+\left(k_{1r}^{A}-k_{1r}^{T}+k_{2r}^{A}-k_{2r}^{T}\right)\left(\mathbf{V}\otimes\mathbf{V}\right)
\]

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<permeability name="Permeability" type="perm-ref-trans-iso">
\end_layout

\begin_layout LyX-Code
  <perm0>0.002</perm0>
\end_layout

\begin_layout LyX-Code
  <perm1A>0.01</perm1A>
\end_layout

\begin_layout LyX-Code
  <perm2A>0.01</perm2A>
\end_layout

\begin_layout LyX-Code
  <perm1T>0.001</perm1T>
\end_layout

\begin_layout LyX-Code
  <perm2T>0.05</perm2T>
\end_layout

\begin_layout LyX-Code
  <M0>1.0</M0>
\end_layout

\begin_layout LyX-Code
  <MA>0.5</MA>
\end_layout

\begin_layout LyX-Code
  <MT>1.5</MT>
\end_layout

\begin_layout LyX-Code
  <alpha0>1.0</alpha0>
\end_layout

\begin_layout LyX-Code
  <alphaA>0.5</alphaA>
\end_layout

\begin_layout LyX-Code
  <alphaT>2.0</alphaT>
\end_layout

\begin_layout LyX-Code
</permeability>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Fluid Supply Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Supply-Materials"

\end_inset


\end_layout

\begin_layout Standard
Fluid supply materials may be used to simulate an external source of fluid,
 such as supply from microvasculature that is not modeled explicitly.
 The fluid supply term,
 
\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset

,
 appears in the mass balance relation for the mixture,
 
\begin_inset Formula 
\[
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}\,.
\]

\end_inset


\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset

 has units of reciprocal time [
\series bold
t
\series default

\begin_inset Formula $^{\mathrm{-1}}$
\end_inset

];
 it represents the rate at which the volume fraction of fluid changes with time.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Starling Equation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Starling-Equation"

\end_inset


\end_layout

\begin_layout Standard
The material type for Starling's equation for fluid supply is 
\shape italic

\begin_inset Quotes eld
\end_inset

Starling
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kp>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic filtration coefficient,
 
\begin_inset Formula $k_{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<pv>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fluid pressure in external source,
 
\begin_inset Formula $p_{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fluid supply is given by Starling's equation,
 
\begin_inset Formula 
\[
\hat{\varphi}^{w}=k_{p}\left(p_{v}-p\right)\,,
\]

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure in the biphasic material.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a fluid supply material of the Starling type.
\end_layout

\begin_layout LyX-Code
<solvent_supply type="Starling">
\end_layout

\begin_layout LyX-Code
  <kp>0.001</kp>
\end_layout

\begin_layout LyX-Code
  <pv>0.1</pv>
\end_layout

\begin_layout LyX-Code
</solvent_supply>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Biphasic-Solute Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Biphasic-Solute-Materials"

\end_inset


\end_layout

\begin_layout Standard
Biphasic-solute materials may be used to model the transport of a solvent and a solute in a neutral porous solid matrix,
 under isothermal conditions.
 Each of these mixture constituents is assumed to be intrinsically incompressible.
 This means that their true densities are invariant in space and time;
 this assumption further implies that a biphasic-solute mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure.
 Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions.
 Therefore,
 the constitutive relation of the solid matrix should be chosen from the list of unconstrained materials provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The volume fraction of the solute is assumed to be negligible relative to the volume fractions of the solid or solvent.
 This means that the mixture will not change in volume as the solute concentration changes.
 As the solute transports through the mixture,
 it may experience frictional interactions with the solvent and the solid.
 This friction may act as a hindrance to the solute transport,
 or may help convect the solute through the mixture.
 The distinction between frictional exchanges with the solvent and solid is embodied in the specification of two diffusivities for the solute:
 The free diffusivity,
 which represents diffusivity in the absence of a solid matrix (frictional exchange only with the solvent) and the mixture diffusivity,
 which represents the combined frictional interactions with the solvent and solid matrix.
 The user is referred to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

 for a more detailed description of the biphasic-solute theory.
\end_layout

\begin_layout Standard
Due to steric volume exclusion and short-range electrostatic interactions,
 the solute may not have access to all of the pores of the solid matrix.
 In other words,
 only a fraction 
\begin_inset Formula $\kappa$
\end_inset

 of the pores is able to accommodate a solute of a particular size (
\begin_inset Formula $0<\kappa\leqslant1)$
\end_inset

.
 Furthermore,
 the activity 
\begin_inset Formula $\gamma$
\end_inset

 of the solute (the extent by which the solute concentration influences its chemical potential) may be similarly altered by the surrounding porous solid matrix.
 Therefore,
 the combined effects of volume exclusion and attenuation of activity may be represented by the effective solubility 
\begin_inset Formula $\tilde{\kappa}=\kappa/\gamma$
\end_inset

,
 such that the chemical potential 
\begin_inset Formula $\mu$
\end_inset

 of the solute is given by 
\begin_inset Formula 
\begin{equation}
\mu=\mu_{0}\left(\theta\right)+\frac{R\theta}{M}\ln\frac{c}{\tilde{\kappa}}\,.\label{eq:bs-solute-chemical-potential}
\end{equation}

\end_inset

In this expression,
 
\begin_inset Formula $\mu_{0}$
\end_inset

 is the solute chemical potential at some reference temperature 
\begin_inset Formula $\theta$
\end_inset

;
 
\begin_inset Formula $c$
\end_inset

 is the solute concentration on a solution-volume basis (number of moles of solute per volume of interstitial fluid in the mixture);
 
\begin_inset Formula $M$
\end_inset

 is the solute molecular weight (an invariant quantity);
 and 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant.
 In a biphasic-solute material,
 a constitutive relation is needed for 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

;
 in general,
 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 may be a function of the solid matrix strain and the solute concentration.
 In FEBio,
 the dependence of the effective solubility on the solid matrix strain is currently constrained to a dependence on 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
In a biphasic-solute material,
 the interstitial fluid pressure 
\begin_inset Formula $p$
\end_inset

 is influenced by both mechanical and chemical environments.
 In other words,
 this pressure includes both mechanical and osmotic contributions,
 the latter arising from the presence of the solute.
 The solvent mechano-chemical potential 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-R\theta\Phi c\right)\,,\label{eq:bs-solvent-chemical-potential}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{0}^{w}$
\end_inset

 is the solvent chemical potential at some reference temperature 
\begin_inset Formula $\theta$
\end_inset

;
 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true density of the solvent (an invariant property for an intrinsically incompressible fluid);
 and 
\begin_inset Formula $\Phi$
\end_inset

 is the osmotic coefficient which represents the extent by which the solute concentration influences the solvent chemical potential.
 In a biphasic-solute material,
 a constitutive relation is needed for 
\begin_inset Formula $\Phi$
\end_inset

;
 in general,
 
\begin_inset Formula $\Phi$
\end_inset

 may be a function of the solid matrix strain and the solute concentration.
 In FEBio,
 the dependence of the osmotic coefficient on the solid matrix strain is currently constrained to a dependence on 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
The solute mechano-chemical potential is nearly equal to its chemical potential because the solute volume fraction is assumed to be negligible.
 In general,
 momentum and energy balances evaluated across a boundary surface in a biphasic-solute mixture require that the mechano-chemical potentials of solvent and solute be continuous across that surface.
 These continuity requirements are enforced automatically in FEBio by defining the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 and solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\Phi c\\
\tilde{c} & =\frac{c}{\tilde{\kappa}}
\end{aligned}
\,.\label{eq:bs-effective-p-c}
\end{equation}

\end_inset

Therefore,
 nodal variables in FEBio consist of the solid matrix displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

,
 the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

,
 and the effective solute concentration 
\begin_inset Formula $\tilde{c}$
\end_inset

.
 Essential boundary conditions must be imposed on these variables,
 and not on the actual pressure 
\begin_inset Formula $p$
\end_inset

 or concentration 
\begin_inset Formula $c$
\end_inset

.
 (In a biphasic material however,
 since 
\begin_inset Formula $c=0$
\end_inset

,
 the effective and actual fluid pressures are the same,
 
\begin_inset Formula $p=\tilde{p}$
\end_inset

.)
\end_layout

\begin_layout Standard
The mixture stress in a biphasic-solute material is given by 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}$
\end_inset

,
 where 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress arising from the solid matrix strain.
 The mixture traction on a surface with unit outward normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

.
 This traction is continuous across the boundary surface.
 Therefore,
 the corresponding natural boundary condition for a biphasic-solute mixture is 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

.
 (In other words,
 if no boundary condition is imposed on the solid matrix displacement or mixture traction,
 the natural boundary condition is in effect.)
\end_layout

\begin_layout Standard
The natural boundary conditions for the solvent and solute are similarly 
\begin_inset Formula $\mathbf{w}\cdot\mathbf{n}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}\cdot\mathbf{n}=0$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is the volumetric flux of solvent relative to the solid and 
\begin_inset Formula $\mathbf{j}$
\end_inset

 is the molar flux of solute relative to the solid.
 In general,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}$
\end_inset

 are given by 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\mathbf{\tilde{k}}\cdot\left(\nabla\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\nabla\tilde{c}\right)\\
\mathbf{j} & =\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\nabla\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)
\end{aligned}
\,,\label{eq:bs-fluxes-w-j}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\frac{\tilde{\kappa}c}{d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1}\label{eq:bs-effective-perm}
\end{equation}

\end_inset

is the effective hydraulic permeability of the interstitial fluid solution (solvent and solute) through the porous solid matrix;
 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability of the solvent through the porous solid matrix;
 
\begin_inset Formula $\mathbf{d}$
\end_inset

 is the solute diffusivity through the mixture (frictional interactions with solvent and solid);
 and 
\begin_inset Formula $d_{0}$
\end_inset

 is the solute free diffusivity (frictional interactions with solvent only).
 
\begin_inset Formula $\varphi^{w}\approx1-\varphi^{s}$
\end_inset

 is the solid matrix porosity in the current configuration.
 The above expressions for the solvent and solute flux do not account for external body forces.
\end_layout

\begin_layout Standard
The governing equations for a biphasic-solute material are the momentum balance for the mixture,
 Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bp-momentum-balance"
nolink "false"

\end_inset

,
 the mass balance for the mixture,
 which reduces to Eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:bp-mixture-mass-balance"
nolink "false"

\end_inset

 under the assumption of dilute solutions,
 and the mass balance for the solute,
 
\begin_inset Formula 
\begin{equation}
\frac{\partial\left(\varphi^{w}c\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}c\mathbf{v}^{s}\right)=0\,.\label{eq:bs-solute-mass-balance}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Guidelines for Biphasic-Solute Analyses
\begin_inset CommandInset label
LatexCommand label
name "subsec:Guidelines-for-Biphasic-Solute"

\end_inset


\end_layout

\begin_layout Subsubsection
Prescribed Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Standard
In most analyses,
 it may be assumed that the ambient fluid pressure in the external environment is zero,
 thus 
\begin_inset Formula $p_{\ast}=0$
\end_inset

,
 where the subscripted asterisk is used to denote environmental conditions.
 The ambient solute concentration may be represented by 
\begin_inset Formula $c_{\ast}$
\end_inset

.
 It follows that the effective fluid pressure in the external environment is 
\begin_inset Formula $\tilde{p}_{\ast}=-R\theta\Phi_{\ast}c_{\ast}$
\end_inset

 and the effective concentration is 
\begin_inset Formula $\tilde{c}_{\ast}=c_{\ast}/\tilde{\kappa}_{\ast}$
\end_inset

.
 Therefore,
 in biphasic-solute analyses,
 whenever the external environment contains a solute at a concentration of 
\begin_inset Formula $c_{\ast}$
\end_inset

,
 the user must remember to prescribe non-zero boundary conditions for the effective solute concentration 
\shape italic
and
\shape default
 the effective fluid pressure.
\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $p_{\ast}=0$
\end_inset

 also implies that prescribed mixture normal tractions (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mixture-Normal-Traction"
nolink "false"

\end_inset

) represent only the traction above ambient conditions.
 Note that users are not obligated to assume that 
\begin_inset Formula $p_{\ast}=0$
\end_inset

.
 However,
 if a non-zero value is assumed for the ambient pressure,
 then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions.
\end_layout

\begin_layout Subsubsection
Prescribed Initial Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Initial-Conditions"

\end_inset


\end_layout

\begin_layout Standard
When a biphasic-solute material is initially exposed to a given external environment with effective pressure 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and effective concentration 
\begin_inset Formula $\tilde{c}_{\ast}$
\end_inset

,
 the initial conditions inside the material should be set to 
\begin_inset Formula $\tilde{p}=\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}=\tilde{c}_{\ast}$
\end_inset

 in order to produce the correct initial state.
 The values of 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}_{\ast}$
\end_inset

 should be evaluated as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Boundary-Conditions-1"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Biphasic-Solute Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-BS-Materials"

\end_inset


\end_layout

\begin_layout Standard
The material type for a biphasic-solute material is 
\shape italic

\begin_inset Quotes eld
\end_inset

biphasic-solute
\begin_inset Quotes erd
\end_inset


\shape default
.
 Constitutive relations must be provided for the solid matrix,
 the hydraulic permeability 
\begin_inset Formula $\mathbf{k}$
\end_inset

,
 the solute diffusivities 
\begin_inset Formula $\mathbf{d}$
\end_inset

 and 
\begin_inset Formula $d_{0}$
\end_inset

,
 the effective solubility 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 and the osmotic coefficient 
\begin_inset Formula $\Phi$
\end_inset

.
 Therefore,
 the following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solid matrix 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in the reference configuration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<permeability>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the hydraulic permeability 
\begin_inset Formula $\mathbf{k}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<osmotic_coefficient>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the osmotic coefficient 
\begin_inset Formula $\Phi\quad\mathbf{d}d_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solute>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute properties 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <solid> tag encloses a description of the solid matrix constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The solid volume fraction in the reference configuration,
 <phi0>,
 must be greater than 0 (no solid) and less than 1 (only solid).
 The volume fraction of fluid (also known as the porosity) in the reference configuration is given by 
\begin_inset Formula $1-\varphi_{0}$
\end_inset

.
 The <permeability> tag encloses a description of the permeability constitutive relation and associated material properties,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Permeability-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
The <solute> tag provides a description of the solute in the biphasic-solute mixture.
 This tag includes the required 
\shape italic
sol
\shape default
 attribute,
 which should reference a solute 
\shape italic
id
\shape default
 from the <Solutes> description in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

).
 The following parameters must be defined in this description:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diffusivity>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute diffusivities 
\begin_inset Formula $\mathbf{d}$
\end_inset

 and 
\begin_inset Formula $d_{0}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solubility>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute effective solubility 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <diffusivity> and <solubility> tags enclose descriptions of materials that may be selected from the lists presented in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Diffusivity-Materials"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solubility-Materials"
nolink "false"

\end_inset

,
 respectively.
 Each solute tag must include a 
\begin_inset Quotes eld
\end_inset

sol
\begin_inset Quotes erd
\end_inset

 attribute.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Biological tissue" type="biphasic-solute">
\end_layout

\begin_layout LyX-Code
  <solid name="Elasticity" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
  <permeability name="Permeability" type="perm-const-iso">
\end_layout

\begin_layout LyX-Code
    ...
 (description of permeability material)
\end_layout

\begin_layout LyX-Code
  </permeability>
\end_layout

\begin_layout LyX-Code
  <osmotic_coefficient name="Osmotic" type="osm-coef-const">
\end_layout

\begin_layout LyX-Code
    ...
 (description of osmotic coefficient material)
\end_layout

\begin_layout LyX-Code
  </osmotic_coefficient>
\end_layout

\begin_layout LyX-Code
  <solute sol="1">
\end_layout

\begin_layout LyX-Code
    <diffusivity name="Diffusivity" type="diff-const-iso">
\end_layout

\begin_layout LyX-Code
      ...
 (description of diffusivity material)
\end_layout

\begin_layout LyX-Code
    </diffusivity>
\end_layout

\begin_layout LyX-Code
    <solubility name="Solubility" type="solub-const">
\end_layout

\begin_layout LyX-Code
      ...
 (description of solubility material)
\end_layout

\begin_layout LyX-Code
    </solubility>
\end_layout

\begin_layout LyX-Code
  </solute>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
When a biphasic-solute material is employed in an analysis,
 it is also necessary to specify the values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 [
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default
/
\series bold
n
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
T
\series default
] and absolute temperature 
\begin_inset Formula $\theta$
\end_inset

 [
\series bold
T
\series default
] under <Constants> in the <Globals> section,
 using a self-consistent set of units.
 A solute must also be defined in the <Solutes> section,
 whose id should be associated with the 
\begin_inset Quotes eld
\end_inset

sol
\begin_inset Quotes erd
\end_inset

 attribute in the solute material description.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314</R>
\end_layout

\begin_layout LyX-Code
    <T>298</T>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
  <Solutes>
\end_layout

\begin_layout LyX-Code
    <solute id="1" name="neutral">
\end_layout

\begin_layout LyX-Code
      <charge_number>0</charge_number>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
  </Solutes>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard
It is also possible to create models with biphasic-solute materials that use different solutes in different regions.
 In that case,
 introduce additional solute entries in the <Solutes> section and refer to those solute ids in the biphasic-solute material descriptions.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Diffusivity Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Diffusivity-Materials"

\end_inset


\end_layout

\begin_layout Standard
Diffusivity materials provide a constitutive relation for the solute diffusivity in a biphasic-solute material.
 In general,
 the diffusivity tensor 
\begin_inset Formula $\mathbf{d}$
\end_inset

 may be a function of strain and solute concentration.
\end_layout

\begin_layout Subsubsection
Constant Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Isotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
The material type for constant isotropic diffusivity materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
diff-const-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<free_diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
free diffusivity 
\begin_inset Formula $d_{0}$
\end_inset

 of solute (diffusivity in solution)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
constant isotropic diffusivity 
\begin_inset Formula $d$
\end_inset

 of solute in biphasic-solute mixture
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
When the permeability is isotropic,
 
\begin_inset Formula 
\[
\mathbf{d}=d\,\mathbf{I}
\]

\end_inset

For this material model,
 
\begin_inset Formula $d$
\end_inset

 is constant.
 This assumption is only true when strains are small.
 Note that the user must specify 
\begin_inset Formula $d\leqslant d_{0}$
\end_inset

,
 since a solute cannot diffuse through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<diffusivity name="Permeability" type="diff-const-iso">
\end_layout

\begin_layout LyX-Code
  <free_diff>1e-9</ free_diff >
\end_layout

\begin_layout LyX-Code
  <diff>0.5e-9</diff>
\end_layout

\begin_layout LyX-Code
</diffusivity>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Constant Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Orthotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
The material type for constant orthotropic diffusivity materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
diff-const-ortho
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<free_diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
free diffusivity 
\begin_inset Formula $d_{0}$
\end_inset

 of solute (diffusivity in solution)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivities 
\begin_inset Formula $d^{a}$
\end_inset

 along orthogonal directions (
\begin_inset Formula $a=1,2,3)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
When the permeability is orhotropic,
 
\begin_inset Formula 
\[
\mathbf{d}=\sum\limits_{a=1}^{3}d^{a}\mathbf{V}_{a}\otimes\mathbf{V}_{a}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry (defined as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

).
 For this material model,
 
\begin_inset Formula $d^{a}$
\end_inset

's are constant.
 Therefore this model should be used only when strains are small.
 Note that the user must specify 
\begin_inset Formula $d^{a}\leqslant d_{0}$
\end_inset

,
 since a solute cannot diffuse through the biphasic-solute mixture faster than in free solution.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<diffusivity name="Permeability" type="diff-const-ortho">
\end_layout

\begin_layout LyX-Code
  <free_diff>0.005</free_diff >
\end_layout

\begin_layout LyX-Code
  <diff>0.002,0.001,0.003</diff>
\end_layout

\begin_layout LyX-Code
</diffusivity>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Referentially Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Isotropic-Diffusiv"

\end_inset


\end_layout

\begin_layout Standard
The material type for a strain-dependent diffusivity tensor which is isotropic in the reference configuration is 
\shape italic

\begin_inset Quotes eld
\end_inset

diff-ref-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<free_diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
free diffusivity 
\begin_inset Formula $d_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivity 
\begin_inset Formula $d_{0r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivity 
\begin_inset Formula $d_{1r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivity 
\begin_inset Formula $d_{2r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponential strain-dependence coefficient 
\begin_inset Formula $M$
\end_inset

 (
\begin_inset Formula $M\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $\alpha\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\[
\mathbf{d}=\left(d_{0r}\mathbf{I}+\frac{d_{1r}}{J^{2}}\mathbf{b}+\frac{d_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2},
\]

\end_inset

where 
\begin_inset Formula $J$
\end_inset

is the jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient,
 and 
\begin_inset Formula $\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
 Note that the diffusivity in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is isotropic and given by 
\begin_inset Formula $\mathbf{d}=\left(d_{0r}+d_{1r}+d_{2r}\right)\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<diffusivity name="Diffusivity" type="diff-ref-iso">
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
  <free_diff>0.005</free_diff>
\end_layout

\begin_layout LyX-Code
  <diff0>0.001</diff0>
\end_layout

\begin_layout LyX-Code
  <diff1>0.005</diff1>
\end_layout

\begin_layout LyX-Code
  <diff2>0.002</diff2>
\end_layout

\begin_layout LyX-Code
  <M>1.5</M>
\end_layout

\begin_layout LyX-Code
  <alpha>2</alpha>
\end_layout

\begin_layout LyX-Code
</diffusivity>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Referentially Orthotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Referentially-Orthotropic-Diffus"

\end_inset


\end_layout

\begin_layout Standard
The material type for a strain-dependent diffusivity which is orthotropic in the reference configuration is 
\shape italic

\begin_inset Quotes eld
\end_inset

diff-ref-ortho
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<free_diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
free diffusivity 
\begin_inset Formula $d_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic diffusivity 
\begin_inset Formula $d_{0r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff1> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivities 
\begin_inset Formula $d_{1r}^{a}$
\end_inset

 along orthogonal directions (
\begin_inset Formula $a=1,2,3$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diff2> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivities 
\begin_inset Formula $d_{2r}^{a}$
\end_inset

 along orthogonal directions (
\begin_inset Formula $a=1,2,3$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic exponential strain-dependence coefficient 
\begin_inset Formula $M_{0}$
\end_inset

 (
\begin_inset Formula $M_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<M> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
orthotropic exponential strain-dependence coefficient 
\begin_inset Formula $M_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3$
\end_inset

,
 
\begin_inset Formula $M_{a}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isotropic power-law exponent 
\begin_inset Formula $\alpha_{0}$
\end_inset

 (
\begin_inset Formula $\alpha_{0}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alpha>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent 
\begin_inset Formula $\alpha_{a}$
\end_inset

 (
\begin_inset Formula $a=1,2,3$
\end_inset

,
 
\begin_inset Formula $\alpha_{a}\geqslant0$
\end_inset

)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a strain-dependent diffusivity tensor that accommodates strain-induced anisotropy:
 
\begin_inset Formula 
\[
\mathbf{d}=d_{0}\mathbf{I}+\sum\limits_{a=1}^{3}d_{1}^{a}\mathbf{m}_{a}+d_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right),
\]

\end_inset

where,
 
\begin_inset Formula 
\[
\begin{aligned}d_{0} & =d_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\\
d_{1}^{a} & =\frac{d_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\\
d_{2}^{a} & =\frac{d_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}
\end{aligned}
,\quad a=1,2,3
\]

\end_inset


\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient.
 
\begin_inset Formula $\mathbf{m}_{a}$
\end_inset

 are second order tensors representing the spatial structural tensors describing the orthogonal planes of symmetry,
 given by 
\begin_inset Formula 
\[
\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{V}_{a}$
\end_inset

 are orthonormal vectors normal to the planes of symmetry (defined as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

).
 Note that the diffusivity in the reference state (
\begin_inset Formula $\mathbf{F}=\mathbf{I})$
\end_inset

 is given by 
\begin_inset Formula $\mathbf{d}=d_{0r}\mathbf{I}+\sum\limits_{a=1}^{3}\left(d_{1r}^{a}+d_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<diffusivity name="Diffusivity" type="diff-ref-ortho">
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
  <free_diff>0.005</free_diff>
\end_layout

\begin_layout LyX-Code
  <diff00>0.001</diff00>
\end_layout

\begin_layout LyX-Code
  <diff1>0.01,
 0.02,
 0.03</diff1>
\end_layout

\begin_layout LyX-Code
  <diff2>0.001,
 0.002,
 0.003</diff2>
\end_layout

\begin_layout LyX-Code
  <M0>0.5</M0>
\end_layout

\begin_layout LyX-Code
  <M>1.5,
 2.0,
 2.5</M>
\end_layout

\begin_layout LyX-Code
  <alpha0>1.5</alpha0>
\end_layout

\begin_layout LyX-Code
  <alpha>2,
 2.5,
 3</alpha>
\end_layout

\begin_layout LyX-Code
</diffusivity>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Albro Isotropic Diffusivity
\begin_inset CommandInset label
LatexCommand label
name "subsec:Albro-Isotropic-Diffusivity"

\end_inset


\end_layout

\begin_layout Standard
The material type for a porosity and concentration-dependent diffusivity which is isotropic is 
\shape italic

\begin_inset Quotes eld
\end_inset

diff-Albro-iso
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<free_diff>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
free diffusivity 
\begin_inset Formula $d_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cdinv>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
inverse of characteristic concentration for concentration-dependence 
\begin_inset Formula $c_{D}^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

/
\series bold
n
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<alphad> 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
coefficient of porosity-dependence 
\begin_inset Formula $\alpha_{D}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This material uses a porosity and concentration-dependent diffusivity tensor that remains isotropic with deformation:
 
\begin_inset Formula 
\[
\mathbf{d}=d_{0}\exp\left(-\alpha_{D}\frac{1-\varphi^{w}}{\varphi^{w}}-\frac{c}{c_{D}}\right)\mathbf{I},
\]

\end_inset

where 
\begin_inset Formula $c_{D}^{-1}=1/c_{D}$
\end_inset

 and the porosity 
\begin_inset Formula $\varphi^{w}$
\end_inset

 varies with deformation according to the kinematic constraint 
\begin_inset Formula 
\[
\varphi^{w}=1-\frac{\varphi_{r}^{s}}{J}\,.
\]

\end_inset


\begin_inset Formula $J$
\end_inset

 is the Jacobian of the deformation,
 i.e.
 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

 where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is the deformation gradient and 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the referential solid volume fraction.
 Here,
 
\begin_inset Formula $c$
\end_inset

 represents the actual concentration of the solute whose diffusivity is given by 
\begin_inset Formula $\mathbf{d}$
\end_inset

.
 This constitutive relation is based on the experimental findings reported by Albro et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Albro09"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<solute sol="1">
\end_layout

\begin_layout LyX-Code
  <diffusivity type="diff-Albro-iso">
\end_layout

\begin_layout LyX-Code
    <free_diff>123e-6</free_diff>
\end_layout

\begin_layout LyX-Code
    <alphad>18</alphad>
\end_layout

\begin_layout LyX-Code
    <cdinv>0.0625</cdinv>
\end_layout

\begin_layout LyX-Code
  </diffusivity>
\end_layout

\begin_layout LyX-Code
  <solubility type="solub-const">
\end_layout

\begin_layout LyX-Code
    <solub>1</solub>
\end_layout

\begin_layout LyX-Code
  </solubility>
\end_layout

\begin_layout LyX-Code
</solute>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Solubility Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solubility-Materials"

\end_inset


\end_layout

\begin_layout Subsubsection
Constant Solubility
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Solubility"

\end_inset


\end_layout

\begin_layout Standard
The material type for constant solubility materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
solub-const
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solub>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solubility 
\begin_inset Formula $\tilde{\kappa}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material model,
 
\begin_inset Formula $\tilde{\kappa}$
\end_inset

 is constant.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<solubility name="Solubility" type="solub-const">
\end_layout

\begin_layout LyX-Code
  <solub>1</solub>
\end_layout

\begin_layout LyX-Code
</solubility>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Osmotic Coefficient Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Osmotic-Coefficient-Materials"

\end_inset


\end_layout

\begin_layout Subsubsection
Constant Osmotic Coefficient
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Osmotic-Coefficient"

\end_inset


\end_layout

\begin_layout Standard
The material type for constant osmotic coefficient materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
osm-coef-const
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<osmcoef>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Osmotic coefficient 
\begin_inset Formula $\Phi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this material model,
 
\begin_inset Formula $\Phi$
\end_inset

 is constant.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<osmotic_coefficient name="Osmotic coefficient" type="osm-coef-const">
\end_layout

\begin_layout LyX-Code
  <osmcoef>1</osmcoef>
\end_layout

\begin_layout LyX-Code
</osmotic_coefficient>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Triphasic and Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Triphasic-Multiphasic-Materials"

\end_inset


\end_layout

\begin_layout Standard
Triphasic materials may be used to model the transport of a solvent and a pair of monovalent salt counter-ions (two solutes with charge numbers 
\begin_inset Formula $+$
\end_inset

1 and -1) in a charged porous solid matrix,
 under isothermal conditions.
 Multiphasic materials may be used to model the transport of a solvent and any number of neutral or charged solutes;
 a triphasic mixture is a special case of a multiphasic mixture.
 Each of the mixture constituents is assumed to be intrinsically incompressible.
 This means that their true densities are invariant in space and time;
 this assumption further implies that a multiphasic mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure.
 Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions.
 Therefore,
 the constitutive relation of the solid matrix should be chosen from the list of unconstrained materials provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The volume fraction of the solutes is assumed to be negligible relative to the volume fractions of the solid or solvent.
 This means that the mixture will not change in volume as the solute concentrations change.
 As the solutes transport through the mixture,
 they may experience frictional interactions with the solvent and the solid.
 This friction may act as a hindrance to the solute transport,
 or may help convect the solutes through the mixture.
 The distinction between frictional exchanges with the solvent and solid is embodied in the specification of two diffusivities for each solute:
 The free diffusivity,
 which represents diffusivity in the absence of a solid matrix (frictional exchange only with the solvent) and the mixture diffusivity,
 which represents the combined frictional interactions with the solvent and solid matrix.
 The user is referred to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

 for a more detailed description of triphasic and multiphasic theory.
\end_layout

\begin_layout Standard
Due to steric volume exclusion and short-range electrostatic interactions,
 a solute 
\begin_inset Formula $\alpha$
\end_inset

 may not have access to all of the pores of the solid matrix.
 In other words,
 only a fraction 
\begin_inset Formula $\kappa^{\alpha}$
\end_inset

 of the pores is able to accommodate solute 
\begin_inset Formula $\alpha$
\end_inset

 (
\begin_inset Formula $0<\kappa^{\alpha}\leqslant1)$
\end_inset

.
 Furthermore,
 the activity 
\begin_inset Formula $\gamma^{\alpha}$
\end_inset

 of solute 
\begin_inset Formula $\alpha$
\end_inset

 (the extent by which the solute concentration influences its chemical potential) may be similarly altered by the surrounding porous solid matrix.
 Therefore,
 the combined effects of volume exclusion and attenuation of activity may be represented by the effective solubility 
\begin_inset Formula $\hat{\kappa}^{\alpha}=\kappa^{\alpha}/\gamma^{\alpha}$
\end_inset

,
 such that the chemical potential 
\begin_inset Formula $\mu$
\end_inset

 of the solute is given by 
\begin_inset Formula 
\begin{equation}
\mu^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}\,.\label{eq:mp-solute-chemical-potential}
\end{equation}

\end_inset

In this expression,
 
\begin_inset Formula $\mu_{0}^{\alpha}$
\end_inset

 is the solute chemical potential at some reference temperature 
\begin_inset Formula $\theta$
\end_inset

;
 
\begin_inset Formula $c^{\alpha}$
\end_inset

 is the solute concentration on a solution-volume basis (number of moles of solute per volume of interstitial fluid in the mixture);
 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the solute molecular weight (an invariant quantity);
 and 
\begin_inset Formula $R$
\end_inset

 is the universal gas constant.
 In a triphasic material,
 a constitutive relation is needed for 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

;
 in general,
 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

 may be a function of the solid matrix strain and the solute concentration.
 In FEBio,
 the dependence of the effective solubility on the solid matrix strain is currently constrained to a dependence on 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
The solid matrix of a multiphasic material may be charged and its charge density is given by 
\begin_inset Formula $c^{F}$
\end_inset

.
 This charge density may be either negative or positive.
 The charge density varies with the deformation,
 increasing when the pore volume decreases.
 Based on the balance of mass for the solid,
 
\begin_inset Formula 
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F},\label{eq:mp-CFD-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 is the solid volume fraction and 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 is the fixed charge density in the reference configuration.
\end_layout

\begin_layout Standard
In the multiphasic theory it is assumed that electroneutrality is satisfied at all times.
 In other words,
 the net charge of the mixture is always zero (neutral).
 This electroneutrality condition is represented by a constraint equation on the ion concentrations,
 
\begin_inset Formula 
\begin{equation}
c^{F}+\sum\limits_{\alpha}z^{\alpha}c^{\alpha}=0\,,\label{eq:mp-electroneutrality}
\end{equation}

\end_inset

where 
\begin_inset Formula $z^{\alpha}$
\end_inset

 is the charge number of solute 
\begin_inset Formula $\alpha z^{-}=-1$
\end_inset

.
 Since the concentrations of the cation and anion inside the triphasic material are not the same,
 an electrical potential difference is produced between the interstitial and external environments.
 The electric potential in the triphasic mixture is denoted by 
\begin_inset Formula $\psi$
\end_inset

 and its effect combines with the chemical potential of each solute to produce the electrochemical potential 
\begin_inset Formula $\tilde{\mu}^{\alpha}$
\end_inset

,
 where 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}+\frac{z^{\alpha}}{M^{\alpha}}F_{c}\psi\,.\label{eq:mp-solute-ecp}
\end{equation}

\end_inset

In this expression,
 
\begin_inset Formula $F_{c}$
\end_inset

 represents Faraday's constant.
 It is also possible to rearrange this expression as 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\left[\exp\left(z^{\alpha}\frac{F_{c}\psi}{R\theta}\right)\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}\right]\,.\label{eq:mp-solute-ecp-redux}
\end{equation}

\end_inset

In a multiphasic material,
 the interstitial fluid pressure 
\begin_inset Formula $p$
\end_inset

 is influenced by both mechanical and chemical environments.
 In other words,
 this pressure includes both mechanical and osmotic contributions,
 the latter arising from the presence of the solutes.
 The solvent mechano-chemical potential 
\begin_inset Formula $\tilde{\mu}^{w}$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-R\theta\Phi\sum\limits_{\alpha}c^{\alpha}\right)\,,\label{eq:mp-solven-mcp}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{0}^{w}$
\end_inset

 is the solvent chemical potential at some reference temperature 
\begin_inset Formula $\theta$
\end_inset

;
 
\begin_inset Formula $\rho_{T}^{w}$
\end_inset

 is the true density of the solvent (an invariant property for an intrinsically incompressible fluid);
 and 
\begin_inset Formula $\Phi$
\end_inset

 is the osmotic coefficient which represents the extent by which the solute concentrations influence the solvent chemical potential.
 In a multiphasic material,
 a constitutive relation is needed for 
\begin_inset Formula $\Phi$
\end_inset

;
 in general,
 
\begin_inset Formula $\Phi$
\end_inset

 may be a function of the solid matrix strain and the solute concentrations.
 In FEBio,
 the dependence of the osmotic coefficient on the solid matrix strain is currently constrained to a dependence on 
\begin_inset Formula $J=\det\mathbf{F}$
\end_inset

.
\end_layout

\begin_layout Standard
The solute mechano-electrochemical potential is nearly equal to its electrochemical potential because the solute volume fraction is assumed to be negligible.
 The solvent mechano-electrochemical potential is the same as its mechano-chemical potential,
 since the solvent is neutral in a multiphasic mixture.
 In general,
 momentum and energy balances evaluated across a boundary surface in a multiphasic mixture require that the mechano-electrochemical potentials of solvent and solutes be continuous across that surface.
 These continuity requirements are enforced automatically in FEBio by defining the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 and solute concentration 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\Phi\sum\nolimits_{\alpha}c^{\alpha}\\
\tilde{c}^{\alpha} & =c^{\alpha}/\tilde{\kappa}^{\alpha}
\end{aligned}
\,,\label{eq:mp-effective-p-c}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\exp\left(-z^{\alpha}\frac{F_{c}\psi}{R\theta}\right)\label{eq:mp-partition-coeff}
\end{equation}

\end_inset

is the partition coefficient for solute 
\begin_inset Formula $\alpha$
\end_inset

.
 The partition coefficient incorporates the combined effects of solubility and long-range electrostatic interactions to determine the ratio of interstitial to external concentration for that solute.
 Therefore,
 the effective concentration represents a measure of the 
\shape italic
activity
\shape default
 of the solute,
 as understood in chemistry.
 The effective fluid pressure represents that part of the pressure which is over and above osmotic effects.
\end_layout

\begin_layout Standard
In FEBio,
 nodal variables consist of the solid matrix displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

,
 the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

,
 and the effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

.
 Essential boundary conditions must be imposed on these variables,
 and not on the actual pressure 
\begin_inset Formula $p$
\end_inset

 or concentrations 
\begin_inset Formula $c^{\alpha}$
\end_inset

.
 (In a biphasic material however,
 since 
\begin_inset Formula $c^{\alpha}=0$
\end_inset

,
 the effective and actual fluid pressures are the same,
 
\begin_inset Formula $p=\tilde{p}$
\end_inset

.)
\end_layout

\begin_layout Standard
The mixture stress in a triphasic material is given by 
\begin_inset Formula $\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}$
\end_inset

,
 where 
\begin_inset Formula $\boldsymbol{\sigma}^{e}$
\end_inset

 is the stress arising from the solid matrix strain.
 The mixture traction on a surface with unit outward normal 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is 
\begin_inset Formula $\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}$
\end_inset

.
 This traction is continuous across the boundary surface.
 Therefore,
 the corresponding natural boundary condition for a multiphasic mixture is 
\begin_inset Formula $\mathbf{t}=\mathbf{0}$
\end_inset

.
 (In other words,
 if no boundary condition is imposed on the solid matrix displacement or mixture traction,
 the natural boundary condition is in effect.)
\end_layout

\begin_layout Standard
The natural boundary conditions for the solvent and solutes are similarly 
\begin_inset Formula $\mathbf{w}\cdot\mathbf{n}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}^{\alpha}\cdot\mathbf{n}=0$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{w}$
\end_inset

 is the volumetric flux of solvent relative to the solid and 
\begin_inset Formula $\mathbf{j}^{\alpha}$
\end_inset

 is the molar flux of solute 
\begin_inset Formula $\alpha$
\end_inset

 relative to the solid.
 In general,
 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $\mathbf{j}^{\alpha}$
\end_inset

 are given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{aligned}\mathbf{w} & =-\mathbf{\tilde{k}}\cdot\left(\nabla\tilde{p}+R\theta\sum\limits_{\alpha}\frac{\tilde{\kappa}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\nabla\tilde{c}^{\alpha}\right),\\
\mathbf{j}^{\alpha} & =\tilde{\kappa}^{\alpha}\,\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\nabla\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\right),
\end{aligned}
\label{eq:mp-fluxes-w-j}
\end{equation}

\end_inset

where
\begin_inset Formula 
\begin{equation}
\mathbf{\tilde{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\sum\limits_{\alpha}\frac{\tilde{\kappa}^{\alpha}c^{\alpha}}{d_{0}^{\alpha}}\left(\mathbf{I}-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\right)\right]^{-1}\label{eq:mp-effective-perm}
\end{equation}

\end_inset

is the effective hydraulic permeability of the interstitial fluid solution (solvent and solutes) through the porous solid matrix;
 
\begin_inset Formula $\mathbf{k}$
\end_inset

 is the hydraulic permeability of the solvent through the porous solid matrix;
 
\begin_inset Formula $\mathbf{d}^{\alpha}$
\end_inset

 is the diffusivity of solute 
\begin_inset Formula $\alpha$
\end_inset

 through the mixture (frictional interactions with solvent and solid);
 and 
\begin_inset Formula $d_{0}^{\alpha}$
\end_inset

 is its free diffusivity (frictional interactions with solvent only).
 
\begin_inset Formula $\varphi^{w}\approx1-\varphi^{s}$
\end_inset

 is the solid matrix porosity in the current configuration.
 The above expressions for the solvent and solute flux do not account for external body forces.
\end_layout

\begin_layout Standard
Also see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Guidelines-for-Multiphasic"
nolink "false"

\end_inset

 for additional guidelines for running multiphasic materials.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Guidelines for Multiphasic Analyses
\begin_inset CommandInset label
LatexCommand label
name "subsec:Guidelines-Multiphasic-Analyses"

\end_inset


\end_layout

\begin_layout Subsubsection
Initial State of Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Initial-State-Swelling"

\end_inset


\end_layout

\begin_layout Standard
Under traction-free conditions,
 a multiphasic material is usually in a state of swelling due to the osmotic pressure difference between the interstitial fluid and the external environment.
 This osmotic pressure arises from the difference in interstitial versus external concentrations of cations and anions,
 caused by the charged solid matrix and the requirement to satisfy electroneutrality.
 An osmotic pressure difference arising from such electrostatic interactions is known as the 
\shape italic
Donnan osmotic pressure
\shape default
.
 When the Donnan pressure is non-zero,
 traction-free conditions do not produce stress-free conditions for the solid matrix,
 since the matrix must expand until its stressed state resists the swelling pressure.
\end_layout

\begin_layout Standard
The Donnan pressure reduces to zero when the fixed charged density is zero,
 or when the external environment is infinitely hypertonic (having ion concentrations infinitely greater than the interstitial fixed charge density).
 Since these two conditions represent special cases,
 it is generally necessary to devise methods for achieving the desired initial state of swelling,
 in an analysis where loads or displacements need to be prescribed over and above this swollen state.
 Swelling occurs as a result of the influx of solvent into the porous solid matrix.
 This influx is a time-dependent process that could require extensive analysis time.
 Therefore,
 it is computationally efficacious to achieve the initial state of swelling by using a multi-step analysis (Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Multi-step-Analysis"
nolink "false"

\end_inset

) where the first step is a steady-state analysis (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Control-Parameters"
nolink "false"

\end_inset

).
 In this steady-state step,
 the fixed charge density may be ramped up from zero to the desired value using a load curve for that property or,
 alternatively,
 the external environmental conditions may be reduced from a very high hypertonic state down to the desired level.
 In the second step,
 prescribed displacement boundary conditions (when needed) may be specified to be of type 
\shape italic
relative
\shape default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Zero-Displacement"
nolink "false"

\end_inset

),
 so that they become superposed over and above the initial swelling state.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<Module type="multiphasic"/>
\end_layout

\begin_layout LyX-Code
<Step>
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
    <analysis>STEADY-STATE</analysis>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
</Step>
\end_layout

\begin_layout LyX-Code
<Step>
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
  <Boundary>
\end_layout

\begin_layout LyX-Code
    <bc type="prescribe" node_set="set1">
\end_layout

\begin_layout LyX-Code
      <dof>z</dof>
\end_layout

\begin_layout LyX-Code
      <scale>1</scale>
\end_layout

\begin_layout LyX-Code
      <relative>1</relative>
\end_layout

\begin_layout LyX-Code
    </prescribe>
\end_layout

\begin_layout LyX-Code
  </Boundary>
\end_layout

\begin_layout LyX-Code
</Step>
\end_layout

\begin_layout Subsubsection
Prescribed Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-BC-Multiphasic"

\end_inset


\end_layout

\begin_layout Standard
In most analyses,
 it may be assumed that the ambient fluid pressure and electric potential in the external environment are zero,
 thus 
\begin_inset Formula $p_{\ast}=0$
\end_inset

 and 
\begin_inset Formula $\psi_{\ast}=0$
\end_inset

,
 where the subscripted asterisk is used to denote environmental conditions.
 Since the external environment does not include a solid matrix,
 the fixed charge density there is zero.
 For example,
 in a triphasic analysis,
 
\begin_inset Formula $c_{\ast}^{+}=c_{\ast}^{-}\equiv c_{\ast}$
\end_inset

.
 It follows that the effective fluid pressure in the external environment is 
\begin_inset Formula $\tilde{p}_{\ast}=-R\theta\Phi_{\ast}\sum\nolimits_{\alpha}c_{\ast}^{\alpha}$
\end_inset

 and the effective concentrations are 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\hat{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}$
\end_inset

.
 Therefore,
 in multiphasic analyses,
 whenever the external environment contains solutes with non-zero concentrations 
\begin_inset Formula $c_{\ast}^{\alpha}$
\end_inset

,
 the user must remember to prescribe non-zero boundary conditions for the effective solute concentrations 
\shape italic
and
\shape default
 the effective fluid pressure.
\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $p_{\ast}=0$
\end_inset

 also implies that prescribed mixture normal tractions (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mixture-Normal-Traction"
nolink "false"

\end_inset

) represent only the traction above ambient conditions.
 Note that users are not obligated to assume that 
\begin_inset Formula $p_{\ast}=0$
\end_inset

.
 However,
 if a non-zero value is assumed for the ambient pressure,
 then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions.
 Similarly,
 users are not required to assume that 
\begin_inset Formula $\psi_{\ast}=0$
\end_inset

;
 when a non-zero value is assumed for the electric potential of the external environment,
 the prescribed boundary conditions for the effective concentrations should be evaluated using the corresponding partition coefficient,
 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\tilde{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Prescribed Initial Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-IC-Multiphasic"

\end_inset


\end_layout

\begin_layout Standard
When a multiphasic material is initially exposed to a given external environment with effective pressure 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and effective concentrations 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}$
\end_inset

,
 the initial conditions inside the material should be set to 
\begin_inset Formula $\tilde{p}=\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}=\tilde{c}_{\ast}^{\alpha}$
\end_inset

 in order to expedite the evaluation of the initial state of swelling.
 The values of 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}$
\end_inset

 should be evaluated as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Boundary-Conditions-1"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Prescribed Effective Solute Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Effective-Solute-Flux"

\end_inset


\end_layout

\begin_layout Standard
The finite element formulation for multiphasic materials in FEBio requires that the natural boundary condition for solute 
\begin_inset Formula $\alpha$
\end_inset

 be prescribed as 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}\equiv j_{n}^{\alpha}+\sum\nolimits_{\beta}z^{\beta}j_{n}^{\beta}$
\end_inset

,
 where 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}$
\end_inset

 is the effective solute flux.
 For a mixture containing only neutral solutes (
\begin_inset Formula $z^{\beta}=0,\,\forall\beta$
\end_inset

 ),
 it follows that 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Prescribed Electric Current Density
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Electric-Current"

\end_inset


\end_layout

\begin_layout Standard
The electric current density in a mixture is a linear superposition of the ion fluxes,
 
\begin_inset Formula 
\begin{equation}
\mathbf{I}_{e}=F_{c}\sum\limits_{\alpha}z^{\alpha}\mathbf{j}^{\alpha}\,.\label{eq:mp-electric-current-density}
\end{equation}

\end_inset

Since only the normal component 
\begin_inset Formula $j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}$
\end_inset

 of ion fluxes may be prescribed at a boundary,
 it follows that only the normal component 
\begin_inset Formula $I_{n}=\mathbf{I}_{e}\cdot\mathbf{n}$
\end_inset

 of the current density may be prescribed.
 To prescribe 
\begin_inset Formula $I_{n}$
\end_inset

,
 it is necessary to know the nature of the ion species in the mixture,
 and how the current is being applied.
 For example,
 if the ions in the triphasic mixture consist of Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

,
 and if the current is being applied using silver/silver chloride (Ag/AgCl) electrodes,
 a chemical reaction occurs at the anode where Ag combines with Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

 to produce AgCl,
 donating an electron to the electrode to transport the current.
 At the cathode,
 the reverse process takes place.
 Therefore,
 in this system,
 there is only flux of Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

 and no flux of Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 (
\begin_inset Formula $j_{n}^{+}=0$
\end_inset

) at the electrode-mixture interface,
 so that the prescribed boundary condition should be 
\begin_inset Formula $j_{n}^{-}=-I_{n}/F_{c}$
\end_inset

.
 Since 
\begin_inset Formula $z^{+}=+1$
\end_inset

 and 
\begin_inset Formula $z^{-}=-1$
\end_inset

 in a triphasic mixture,
 the corresponding effective fluxes are given by 
\begin_inset Formula $\tilde{j}_{n}^{+}=2j_{n}^{+}-j_{n}^{-}=I_{n}/F_{c}$
\end_inset

 and 
\begin_inset Formula $\tilde{j}_{n}^{-}=j_{n}^{+}=0$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Electrical Grounding
\begin_inset CommandInset label
LatexCommand label
name "subsec:Electrical-Grounding"

\end_inset


\end_layout

\begin_layout Standard
If a multiphasic mixture containing ions is completely surrounded by ion-impermeant boundaries it is necessary to ground the mixture to prevent unconstrained fluctuations of the electric potential.
 Grounding is performed by prescribing the effective concentration of one or more ions,
 at a location inside the mixture or on one of its boundaries corresponding to the location of the grounding electrode.
 The choice of ion(s) to constrain may be guided by the type of grounding electrode and the reference electrolyte bath in which it is inserted.
\end_layout

\begin_layout Subsubsection
Neglecting Osmotic Effects
\begin_inset CommandInset label
LatexCommand label
name "subsec:Ignoring-Osmotic-Effects"

\end_inset


\end_layout

\begin_layout Standard
Osmotic effects can be neglected in a multiphasic analysis by setting the osmotic coefficient to zero,
 
\begin_inset Formula $\Phi=0$
\end_inset

.
 In that case,
 the effective fluid pressure and the actual fluid pressure become equivalent measures,
 
\begin_inset Formula $\tilde{p}=p$
\end_inset

,
 as for the case of a biphasic mixture.
\end_layout

\begin_layout Subsubsection
Solutes as 'Solid-Bound Molecules'
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solutes-as-SBMs"

\end_inset


\end_layout

\begin_layout Standard
In multiphasic analyses,
 FEBio solves for the solid displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

,
 the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

,
 and the effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\alpha}$
\end_inset

,
 at all the nodes,
 representing all the degrees of freedom in an analysis.
 Once the solution has converged at each time point,
 FEBio solves for the referential mass densities 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 of solid-bound molecules by solving the corresponding mass balance equation in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-sbm-mass-balance"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 at integration points,
 in a single numerical integration step.
 This approach reduces the number of degrees of freedom that need to be solved simultaneously by the FEBio solver.
 However,
 occasionally,
 the numerical solution for 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 may produce numerical round-off errors that may get amplified as the analysis time progresses.
 
\end_layout

\begin_layout Standard
An alternative to using solid-bound molecules is to define solutes 
\begin_inset Formula $\sigma$
\end_inset

 whose diffusivity 
\begin_inset Formula $\mathbf{d}^{\sigma}$
\end_inset

 in the mixture is set to 
\begin_inset Formula $\mathbf{0}$
\end_inset

 (however,
 the free diffusivity 
\begin_inset Formula $d_{0}^{\sigma}$
\end_inset

 should not be set to zero,
 to prevent a division by zero;
 its exact value is not important,
 thus let 
\begin_inset Formula $d_{0}^{\sigma}=1$
\end_inset

).
 Then,
 FEBio treats these solutes as equivalent to solid-bound molecules:
 (1) Their concentration does not contribute to the osmolarity of the interstitial fluid;
 (2) their concentration contributes to the fixed charge density 
\begin_inset Formula $c^{F}$
\end_inset

 in the current configuration;
 (3) these solutes do not contribute to the effective hydraulic permeability 
\begin_inset Formula $\tilde{\mathbf{k}}$
\end_inset

 of the porous multiphasic mixture;
 (4) these solutes can be involved in chemical reactions;
 (5) while their initial effective concentration may be prescribed,
 it must not contribute to the prescribed initial effective fluid pressure,
 and the user should not prescribe any boundary conditions on the effective concentration of these solutes.
 Using these 'solid-bound' solutes increases the number of degrees of freedom in an FEBio analysis;
 however,
 unlike solid-bound molecules,
 the solution for the effective concentration of these solutes remains as accurate as all other degrees of freedom in an analysis.
\end_layout

\begin_layout Standard
To evaluate the contribution of these solutes to the referential solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 and to chemical reactions,
 it should be recalled that the concentration 
\begin_inset Formula $c^{\sigma}$
\end_inset

 is related to the referential mass density 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 via eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:concentration-density-relations"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 Using the expression for 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-referential-solid-vol-frac"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 we find that
\begin_inset Formula 
\[
\varphi_{r}^{s}=\varphi_{0}^{s}+\left(J-\varphi_{r}^{s}\right)\sum\limits_{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}
\]

\end_inset

which can be solved for 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 using the concentrations 
\begin_inset Formula $c^{\sigma}$
\end_inset

,
\begin_inset Formula 
\[
\varphi_{r}^{s}=\frac{\varphi_{0}^{s}+J\sum\limits_{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}}{1+\sum\limits_{\sigma}\frac{M^{\sigma}c^{\sigma}}{\rho_{T}^{\sigma}}}\,.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Multiphasic Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Multiphasic-Mat"

\end_inset


\end_layout

\begin_layout Standard
The material type for a multiphasic material is 
\begin_inset Quotes eld
\end_inset


\shape italic
multiphasic
\shape default

\begin_inset Quotes erd
\end_inset

.
 Constitutive relations must be provided for the solid matrix,
 the mixture fixed charge density,
 the hydraulic permeability 
\begin_inset Formula $\mathbf{k}$
\end_inset

,
 the osmotic coefficient 
\begin_inset Formula $\Phi$
\end_inset

,
 and the properties of each solute:
 the solute diffusivity in the mixture 
\begin_inset Formula $\mathbf{d}^{\alpha}$
\end_inset

,
 the solute free diffusivity 
\begin_inset Formula $d_{0}^{\alpha}$
\end_inset

,
 and the solute effective solubility 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

.
 Therefore,
 the following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solid matrix
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in the reference configuration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fixed_charge_density>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fixed charge density 
\begin_inset Formula $c_{r}^{F}$
\end_inset

 in the reference configuration
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<permeability>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the hydraulic permeability 
\begin_inset Formula $\mathbf{k}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solvent_supply>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solvent supply 
\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<osmotic_coefficient>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the osmotic coefficient 
\begin_inset Formula $\Phi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solute>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute properties
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid_bound>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of solid-bound molecule
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <solid> tag encloses a description of the solid matrix constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The solid volume fraction in the reference configuration,
 <phi0>,
 must be greater than 0 (no solid) and less than 1 (only solid).
 The volume fraction of fluid (also known as the porosity) in the reference configuration is given by 
\begin_inset Formula $1-\varphi_{0}$
\end_inset

.
 The <fixed_charge_density> may be negative,
 positive,
 or zero.
 The <permeability> and <osmotic_coefficient> tags enclose descriptions of the permeability and osmotic coefficient constitutive relations and their associated material properties,
 as may be selected from the list presented in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Permeability-Materials"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Osmotic-Coefficient-Materials"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
The optional <solute> tag provides a description of each solute in the multiphasic mixture.
 Multiple solutes may be defined.
 Each tag includes the required 
\shape italic
sol
\shape default
 attribute,
 which should reference a solute 
\shape italic
id
\shape default
 from the <Solutes> description in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

).
 The following parameters must be defined in this description:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<diffusivity>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute diffusivities 
\begin_inset Formula $\mathbf{d}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $d_{0}^{\alpha}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solubility>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specification of the solute effective solubility 
\begin_inset Formula $\hat{\kappa}^{\alpha}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <diffusivity> and <solubility> tags enclose descriptions of materials that may be selected from the lists presented in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Diffusivity-Materials"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solubility-Materials"
nolink "false"

\end_inset

,
 respectively.
 Each solute tag must include a 
\begin_inset Quotes eld
\end_inset

sol
\begin_inset Quotes erd
\end_inset

 attribute
\end_layout

\begin_layout Standard
The optional <solid_bound> tag specifies which solid-bound molecule should be included in the multiphasic mixture.
 Multiple solid-bound molecules may be specified.
 Each tag should include the required 
\shape italic
sbm
\shape default
 attribute,
 which references an 
\shape italic
id
\shape default
 from the <SolidBoundMolecules> description in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Bound-Molecules"
nolink "false"

\end_inset

).
 The following parameter must be defined in this description:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<rho0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
initial value of the referential apparent density of the solid-bound molecule 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<rhomin>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optional minimum allowable value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 (zero by default)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<rhomax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optional maximum allowable value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 (none by default)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
If a chemical reaction involves this solid-bound molecule its referential apparent density may evolve over time.
 The user may place lower and upper bounds on the allowable range of an evolving 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" name="Media" type="multiphasic">
\end_layout

\begin_layout LyX-Code
  <phi0>0.2</phi0>
\end_layout

\begin_layout LyX-Code
  <fixed_charge_density>-40</fixed_charge_density>
\end_layout

\begin_layout LyX-Code
  <solid name="Solid Matrix" type="Holmes-Mow">
\end_layout

\begin_layout LyX-Code
    <density>1</density>
\end_layout

\begin_layout LyX-Code
    <E>0.28</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
    <beta>0</beta>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <permeability name="Permeability" type="perm-Holmes-Mow">
\end_layout

\begin_layout LyX-Code
    <perm>1e-3</perm>
\end_layout

\begin_layout LyX-Code
    <M>0</M>
\end_layout

\begin_layout LyX-Code
    <alpha>0</alpha>
\end_layout

\begin_layout LyX-Code
  </permeability>
\end_layout

\begin_layout LyX-Code
  <osmotic_coefficient name="Ideal" type="osm-coef-const">
\end_layout

\begin_layout LyX-Code
    <osmcoef>1.0</osmcoef>
\end_layout

\begin_layout LyX-Code
  </osmotic_coefficient>
\end_layout

\begin_layout LyX-Code
  <solute sol="1">
\end_layout

\begin_layout LyX-Code
    <diffusivity name="Diffusivity" type="diff-const-iso">
\end_layout

\begin_layout LyX-Code
      <free_diff>1e-3</free_diff>
\end_layout

\begin_layout LyX-Code
      <diff>1e-3</diff>
\end_layout

\begin_layout LyX-Code
    </diffusivity>
\end_layout

\begin_layout LyX-Code
    <solubility name="Solubility" type="solub-const">
\end_layout

\begin_layout LyX-Code
      <solub>1.0</solub>
\end_layout

\begin_layout LyX-Code
    </solubility>
\end_layout

\begin_layout LyX-Code
  </solute>
\end_layout

\begin_layout LyX-Code
  <solute sol="2">
\end_layout

\begin_layout LyX-Code
    <diffusivity name="Diffusivity" type="diff-const-iso">
\end_layout

\begin_layout LyX-Code
      <free_diff>1e-3</free_diff>
\end_layout

\begin_layout LyX-Code
      <diff>1e-3</diff>
\end_layout

\begin_layout LyX-Code
    </diffusivity>
\end_layout

\begin_layout LyX-Code
    <solubility name="Solubility" type="solub-const">
\end_layout

\begin_layout LyX-Code
      <solub>1.0</solub>
\end_layout

\begin_layout LyX-Code
    </solubility>
\end_layout

\begin_layout LyX-Code
  </solute>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
When a multiphasic material is employed in an analysis,
 it is also necessary to specify the values of the universal gas constant 
\begin_inset Formula $R$
\end_inset

 [
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default
/
\series bold
n
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
T
\series default
],
 absolute temperature 
\begin_inset Formula $\theta$
\end_inset

 [
\series bold
T
\series default
],
 and Faraday's constant 
\begin_inset Formula $F_{c}$
\end_inset

 [
\series bold
Q
\series default
/
\series bold
n
\series default
] in the <Globals> section,
 using a self-consistent set of units.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<Globals>
\end_layout

\begin_layout LyX-Code
  <Constants>
\end_layout

\begin_layout LyX-Code
    <R>8.314e-6</R>
\end_layout

\begin_layout LyX-Code
    <T>298</T>
\end_layout

\begin_layout LyX-Code
    <Fc>96500e-9</Fc>
\end_layout

\begin_layout LyX-Code
  </Constants>
\end_layout

\begin_layout LyX-Code
  <Solutes>
\end_layout

\begin_layout LyX-Code
    <solute id="1" name="Na">
\end_layout

\begin_layout LyX-Code
      <charge_number>1</charge_number>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
    <solute id="2" name="Cl">
\end_layout

\begin_layout LyX-Code
      <charge_number>-1</charge_number>
\end_layout

\begin_layout LyX-Code
    </solute>
\end_layout

\begin_layout LyX-Code
  </Solutes>
\end_layout

\begin_layout LyX-Code
</Globals>
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="17" columns="2">
<features islongtable="true" longtabularalignment="center">
<column alignment="none" valignment="top" width="90pt">
<column alignment="none" valignment="top" width="129pt">
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none" special="p{219pt}">
\begin_inset Text

\begin_layout Plain Layout
Self-consistent units for a triphasic analysis
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none" special="p{219pt}">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Primary Units
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
s 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
length
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
force
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mole
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmol 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
charge
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
temperature
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
K 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none" special="p{219pt}">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Derived Units
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stress
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/mm
\begin_inset Formula $^{\mathrm{2}}$
\end_inset

,
 MPa 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
permeability
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\begin_inset Formula $^{\mathrm{4}}$
\end_inset

/N
\begin_inset Formula $\cdot$
\end_inset

s,
 mm
\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/MPa 
\begin_inset Formula $\cdot$
\end_inset

s 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diffusivity
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/s 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
concentration
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmol/mm
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

,
 mM 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
charge density
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nEq/mm
\begin_inset Formula $^{\mathrm{3}}$
\end_inset

,
 mEq/L 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
voltage
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mV 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current density
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A/mm
\begin_inset Formula $^{\mathrm{2}}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
current
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
It is also possible to create models with multiphasic materials that use different solutes in different regions.
 In that case,
 introduce additional solute entries in the <Solutes> section and refer to those solute ids in the multiphasic material descriptions.
 Generally,
 two adjoining multiphasic regions may share the same solute (e.g.,
 Na in both regions),
 in which case that solute may transport freely across the interface separating these regions;
 or they may share no solute,
 in which case the interface is impermeable to all solutes.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Solvent Supply Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solvent-Supply-Materials"

\end_inset


\end_layout

\begin_layout Standard
Solvent supply materials may be used to simulate an external source of solvent,
 such as supply from microvasculature that is not modeled explicitly.
 The solvent supply term,
 
\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset

,
 appears in the mass balance relation for the mixture,
 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}\,.\label{eq:solvent-supply-mass-balance}
\end{equation}

\end_inset


\begin_inset Formula $\hat{\varphi}^{w}$
\end_inset

 has units of reciprocal time [
\series bold
t
\series default

\begin_inset Formula $^{\mathrm{-1}}$
\end_inset

];
 it represents the rate at which the volume fraction of solvent changes with time.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Starling Equation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Starling-Equation-MP"

\end_inset


\end_layout

\begin_layout Standard
The material type for Starling's equation for fluid supply is 
\shape italic

\begin_inset Quotes eld
\end_inset

Starling
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kp>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hydraulic filtration coefficient,
 
\begin_inset Formula $k_{p}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{2}}$
\end_inset

/
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<pv>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective fluid pressure in external source,
 
\begin_inset Formula $\tilde{p}_{v}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<qc sol=
\begin_inset Quotes erd
\end_inset

n
\begin_inset Quotes erd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
osmotic filtration coefficient,
 
\begin_inset Formula $q_{c}^{\alpha}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

/
\series bold
n
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<cv sol=
\begin_inset Quotes erd
\end_inset

n
\begin_inset Quotes erd
\end_inset

>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
effective solute concentration in external source,
 
\begin_inset Formula $\tilde{c}_{v}^{\alpha}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The fluid supply is given by Starling's equation,
 
\begin_inset Formula 
\[
\hat{\varphi}^{w}=k_{p}\left(\tilde{p}_{v}-\tilde{p}\right)+\sum\limits_{\alpha}q_{c}^{\alpha}\left(\tilde{c}_{v}^{\alpha}-\tilde{c}^{\alpha}\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\tilde{p}$
\end_inset

 is the effective fluid pressure in the multiphasic material.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
This example defines a solvent supply material of the Starling type for a multiphasic mixture containing one solute.
\end_layout

\begin_layout LyX-Code
<solvent_supply type="Starling">
\end_layout

\begin_layout LyX-Code
  <kp>0.001</kp>
\end_layout

\begin_layout LyX-Code
  <pv>0.1</pv>
\end_layout

\begin_layout LyX-Code
  <qc sol="1">1e-5</qc>
\end_layout

\begin_layout LyX-Code
  <cv sol="1">150</cv>
\end_layout

\begin_layout LyX-Code
</solvent_supply>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "sec:Chemical-Reactions"

\end_inset


\end_layout

\begin_layout Standard
The following sections describe FEBio's formulation for analyzing mechanochemical events in neutral or charged deformable porous media under finite deformation.
 The formulation allows full coupling of mechanical and chemical effects,
 providing a framework where material properties and response functions may depend on solid matrix strain as well as solute concentration.
\end_layout

\begin_layout Standard
If you use these capabilities in your published research,
 we request that you cite the following publication describing its development 
\begin_inset CommandInset citation
LatexCommand citep
key "Ateshian2011"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Guidelines for Chemical Reaction Analyses
\begin_inset CommandInset label
LatexCommand label
name "subsec:Guidelines-Chemical-Reactions"

\end_inset


\end_layout

\begin_layout Standard
Chemical reactions may be modeled within a multiphasic mixture.
 The reaction may involve solutes (
\begin_inset Formula $\alpha=\iota)$
\end_inset

 and solid-bound molecules (
\begin_inset Formula $\alpha=\sigma)$
\end_inset

 that move with the solid matrix (
\begin_inset Formula $\mathbf{v}^{\sigma}=\mathbf{v}^{s},\,\forall\sigma)$
\end_inset

.
 Consider a general chemical reaction,
 
\begin_inset Formula 
\begin{equation}
\sum\limits_{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\to\sum\limits_{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha},\label{eq:cr-forward-reaction}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

 is the chemical species representing constituent 
\begin_inset Formula $\alpha$
\end_inset

 in the mixture;
 
\begin_inset Formula $\nu_{R}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\nu_{P}^{\alpha}$
\end_inset

 represent stoichiometric coefficients of the reactants and products,
 respectively.
 To maintain consistency with classical chemical kinetics,
 the analysis of chemical reactions employs molar concentrations 
\begin_inset Formula $c^{\alpha}$
\end_inset

 and molar supplies 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 on a solution-volume basis for all reactants and products,
 whether they are solutes or solid-bound molecular species.
\end_layout

\begin_layout Standard
Since the molar supply of reactants and products is constrained by stoichiometry,
 it follows that all molar supplies 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 in a specific chemical reaction may be related to a 
\shape italic
molar production rate
\shape default
 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 according to 
\begin_inset Formula 
\begin{equation}
\hat{c}^{\alpha}=\nu^{\alpha}\hat{\zeta}\,,\label{eq:cr-concentration-supply}
\end{equation}

\end_inset

where 
\begin_inset Formula $\nu^{\alpha}$
\end_inset

 represents the net stoichiometric coefficient for 
\begin_inset Formula $\mathcal{E}^{\alpha}$
\end_inset

,
 
\begin_inset Formula 
\begin{equation}
\nu^{\alpha}=\nu_{P}^{\alpha}-\nu_{R}^{\alpha}.\label{eq:cr-net-stoich-coeff}
\end{equation}

\end_inset

Thus,
 formulating constitutive relations for 
\begin_inset Formula $\hat{c}^{\alpha}$
\end_inset

 is equivalent to providing a single relation for 
\begin_inset Formula $\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)$
\end_inset

.
 When the chemical reaction is reversible,
 
\begin_inset Formula 
\begin{equation}
\sum\limits_{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\rightleftharpoons\sum\limits_{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha},\label{eq:cr-reversible-reaction}
\end{equation}

\end_inset

the relations of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-concentration-supply"
nolink "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-net-stoich-coeff"
nolink "false"

\end_inset

 still apply but the constitutive relation for 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 would be different.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
Consider the dissociation of CaCl
\begin_inset Formula $_{\mathrm{2}}$
\end_inset

 into ions Ca
\begin_inset Formula $^{\mathrm{2+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

,
 
\begin_inset Formula 
\[
\mbox{CaCl}_{2}\rightleftharpoons\mbox{Ca}^{2+}+2\mbox{Cl}^{-}.
\]

\end_inset

The mixture contains three constituents.
 The stoichiometric coefficients of the reactants are 
\begin_inset Formula $\nu_{R}^{\mbox{CaCl}_{2}}=1$
\end_inset

,
 
\begin_inset Formula $\nu_{R}^{\mbox{Ca}^{2+}}=0$
\end_inset

,
 
\begin_inset Formula $\nu_{R}^{\mbox{Cl}^{-}}=0$
\end_inset

,
 and those of the products are 
\begin_inset Formula $\nu_{P}^{\mbox{CaCl}_{2}}=0$
\end_inset

,
 
\begin_inset Formula $\nu_{P}^{\mbox{Ca}^{2+}}=1$
\end_inset

,
 
\begin_inset Formula $\nu_{P}^{\mbox{Cl}^{-}}=2$
\end_inset

.
\end_layout

\begin_layout Standard
The reaction production rate 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 enters into the governing equations of multiphasic mixtures via the mass balance relation for each solute,
 
\begin_inset Formula 
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\divg\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\nu^{\iota}\hat{\zeta}\,,\label{eq:cr-solute-mass-balance}
\end{equation}

\end_inset

the mass balance for the mixture,
 
\begin_inset Formula 
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\,,\label{eq:cr-mixture-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\overline{\mathcal{V}}=\sum\limits_{\alpha}\nu^{\alpha}\mathcal{V}^{\alpha}$
\end_inset

 and 
\begin_inset Formula $\mathcal{V}^{\alpha}=M^{\alpha}/\rho_{T}^{\alpha}$
\end_inset

 is the molar volume of 
\begin_inset Formula $\alpha$
\end_inset

,
 and the mass balance for solid-bound constituents,
 
\begin_inset Formula 
\begin{equation}
D^{s}\rho_{r}^{\sigma}/Dt=\hat{\rho}_{r}^{\sigma}\,,\label{eq:cr-sbm-mass-balance}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 is the referential apparent mass density (mass of 
\begin_inset Formula $\sigma$
\end_inset

 per mixture volume in the reference configuration),
 and 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}$
\end_inset

 is the referential apparent mass supply of solid constituent 
\begin_inset Formula $\sigma$
\end_inset

,
 related to molar concentrations and supplies via 
\begin_inset Formula 
\begin{equation}
c^{\sigma}=\frac{\rho_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}},\quad\hat{c}^{\sigma}=\frac{\hat{\rho}_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}}\,.\label{eq:concentration-density-relations}
\end{equation}

\end_inset

Internally,
 the content of solid-bound species is stored in 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:concentration-density-relations"
nolink "false"

\end_inset

 is used to evaluate 
\begin_inset Formula $c^{\sigma}$
\end_inset

 when needed for the calculation of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

.
 If a solid-bound molecule is involved in a chemical reaction,
 equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-sbm-mass-balance"
nolink "false"

\end_inset

 is integrated to produce an updated value of 
\begin_inset Formula $\rho_{r}^{\sigma}$
\end_inset

,
 using 
\begin_inset Formula $\hat{\rho}_{r}^{\sigma}=\left(J-\varphi_{r}^{s}\right)M^{\sigma}\nu^{\sigma}\hat{\zeta}$
\end_inset

 based on 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-concentration-supply"
nolink "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:concentration-density-relations"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
Evolving solid content due to chemical reactions implies that the referential solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 may not remain constant.
 This value is updated at every time point using 
\begin_inset Formula 
\begin{equation}
\varphi_{r}^{s}=\varphi_{0}^{s}+\sum\limits_{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\,,\label{eq:cr-referential-solid-vol-frac}
\end{equation}

\end_inset

where 
\begin_inset Formula $\varphi_{0}^{s}$
\end_inset

 is the solid volume fraction specified by the multiphasic material parameter 
\shape italic
phi0
\shape default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Multiphasic-Mat"
nolink "false"

\end_inset

).
 Thus,
 
\begin_inset Formula $\varphi_{0}^{s}$
\end_inset

 may be used to account for the solid volume fraction not contributed explicitly by solid-bound molecules.
 Based on kinematics,
 the solid volume fraction in the current configuration is given by 
\begin_inset Formula $\varphi^{s}=\varphi_{r}^{s}/J$
\end_inset

.
 Therefore,
 since 
\begin_inset Formula $0\leqslant\varphi^{s}\leqslant1$
\end_inset

 by definition,
 it follows that 
\begin_inset Formula $0\leqslant\varphi_{r}^{s}\leqslant J$
\end_inset

,
 implying that the referential solid volume fraction may evolve to values greater than unity when growth leads to swelling of the multiphasic mixture.
\end_layout

\begin_layout Standard
Similarly,
 if solid-bound molecules are charged and their content evolves over time,
 the referential fixed charge density may also evolve with chemical reactions according to 
\begin_inset Formula 
\begin{equation}
c_{r}^{F}=c_{0}^{F}+\frac{1}{1-\varphi_{r}^{s}}\sum\limits_{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\,,\label{eq:cr-referential-FCD}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 is the referential fixed charge density specified by the multiphasic material parameter 
\shape italic
fixed_charge_density
\shape default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Multiphasic-Mat"
nolink "false"

\end_inset

).
 Thus,
 
\begin_inset Formula $c_{0}^{F}$
\end_inset

 may be used to account for the fixed charge density not contributed explicitly by solid-bound molecules.
\end_layout

\begin_layout Standard
A chemical reaction is properly balanced when 
\begin_inset Formula 
\begin{equation}
\sum\limits_{\alpha}\nu^{\alpha}M^{\alpha}=0\,,\label{eq:cr-balanced-reaction}
\end{equation}

\end_inset

where 
\begin_inset Formula $M^{\alpha}$
\end_inset

 is the molar mass of 
\begin_inset Formula $\alpha$
\end_inset

.
 This constraint implies that the net gain in mass of products must be the same as the net loss in mass of reactants.
 However,
 this constraint is not verified in the code,
 allowing users to model chemical reactions with implicit constituents (constituents that are neither explicitly modeled as solutes nor as solid-bound molecules,
 for which 
\begin_inset Formula $\nu^{\alpha}$
\end_inset

 and 
\begin_inset Formula $M^{\alpha}$
\end_inset

 are not given).
 For example,
 a chemical reaction where cells consume glucose to form a protein from amino-acids building blocks may have the form 
\begin_inset Formula 
\[
\mbox{cells}+\mbox{glucose}+\mbox{amino\thinspace acids}\to\mbox{cells}+\mbox{protein}+\mbox{waste\thinspace products}\,.
\]

\end_inset

The user may opt to model only the glucose reactant and the protein product explicitly,
 while the presence of all other species in this reaction is implicit.
 In these types of analyses the user must beware of potential inconsistencies in the evolving mass of reactants and products since only some of those constituents are modeled explicitly.
 In particular,
 the evolution of 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 as given in 
\series bold

\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-referential-solid-vol-frac"
nolink "false"

\end_inset


\series default
 can only account for the explicitly modeled solid-bound molecules.
 Furthermore,
 when some reactants and products are implicit,
 the value of the reaction molar volume 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset

 calculated in the code becomes inaccurate and may produce unexpected results in the evaluation of the mixture mass balance relation in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-mixture-mass-balance"
nolink "false"

\end_inset

.
 Therefore,
 the user is given the option to override the value of 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset

 calculated in the code.
 In particular,
 if the precise molar volumes of all the species in a reaction are not known,
 assuming that 
\begin_inset Formula $\overline{\mathcal{V}}\approx0$
\end_inset

 is a reasonable choice equivalent to assuming that all the constituents have approximately the same density 
\begin_inset Formula $\rho_{T}^{\alpha}$
\end_inset

,
 as may be deduced from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:cr-balanced-reaction"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
Since the electroneutrality condition is enforced in multiphasic mixtures in FEBio,
 it follows that chemical reactions must not violate this condition.
 Enforcing electroneutrality in a chemical reaction is equivalent to satisfying 
\begin_inset Formula 
\begin{equation}
\sum\limits_{\alpha}z^{\alpha}\nu^{\alpha}=0\,.\label{eq:cr-electroneutrality}
\end{equation}

\end_inset

This constraint is checked within the code and an error is generated when it is violated.
\end_layout

\begin_layout Standard
A constitutive relation must be provided for the molar production rate 
\begin_inset Formula $\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)$
\end_inset

 of each chemical reaction.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification for Chemical Reactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Chem-React"

\end_inset


\end_layout

\begin_layout Standard
The material type for a chemical reaction is 
\begin_inset Quotes eld
\end_inset


\shape italic
reaction
\shape default

\begin_inset Quotes erd
\end_inset

.
 The <reaction> tag must appear inside the definition of a multiphasic mixture and the reaction is defined only for that mixture.
 Multiple chemical reactions may be defined in a given mixture.
 Each <reaction> tag must include a 
\shape italic
type
\shape default
 attribute that identifies the constitutive relation for 
\begin_inset Formula $\hat{\zeta}$
\end_inset

.
\end_layout

\begin_layout Standard
The stoichiometric coefficients 
\begin_inset Formula $\nu_{R}^{\alpha}$
\end_inset

 of the reactants and 
\begin_inset Formula $\nu_{P}^{\alpha}$
\end_inset

 for the products must be specified in every reaction.
 Optionally,
 the net reaction molar volume 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset

 may be specified explicitly to override the internal value calculated in the code.
 Therefore,
 the following parameters need to be defined in a chemical reaction:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<vR>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reactant stoichiometric coefficient 
\begin_inset Formula $\nu_{R}^{\alpha}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<vP>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
product stoichiometric coefficient 
\begin_inset Formula $\nu_{P}^{\alpha}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Vbar>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optional override value for 
\begin_inset Formula $\overline{\mathcal{V}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

/
\series bold
n
\series default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Each <vR> and <vP> tag must include either the 
\shape italic
sol
\shape default
 attribute,
 which should reference a solute 
\shape italic
id
\shape default
 from the <Solutes> description in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solutes"
nolink "false"

\end_inset

),
 or the 
\shape italic
sbm
\shape default
 attribute,
 which should reference a solid-bound molecule 
\shape italic
id
\shape default
 from the <SolidBoundMolecules> description in the <Globals> section (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Bound-Molecules"
nolink "false"

\end_inset

).
 Only solutes and solid-bound molecules that have been included in the parent multiphasic mixture may be specified as reactants or products of a chemical reaction.
\end_layout

\begin_layout Standard
Additional parameters may be needed in the definition of a chemical reaction,
 depending on the specific form of the constitutive relation for the production rate.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Chemical Reaction Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Chemical-Reaction-Materials"

\end_inset


\end_layout

\begin_layout Subsubsection
Law of Mass Action for Forward Reactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Forward"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Law of Mass Action for a forward reaction is 
\shape italic
mass-action-forward
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<forward_rate>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specific forward reaction rate 
\begin_inset Formula $k$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this type of reaction the constitutive relation for the molar production rate is given by 
\begin_inset Formula 
\[
\hat{\zeta}=k\prod\limits_{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\,.
\]

\end_inset

The constitutive form of the specific forward reaction rate must be selected from the list of materials given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specific-Reaction-Rate"
nolink "false"

\end_inset

.
 The units of 
\begin_inset Formula $\hat{\zeta}$
\end_inset

 are [
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}\cdot$
\end_inset


\series bold
t
\series default
] and those of 
\begin_inset Formula $c^{\alpha}$
\end_inset

 are [
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

].
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
Consider the forward reaction that produces solid copper sulfide from solid copper and solid sulfur,
 
\begin_inset Formula 
\[
\mbox{Cu}+\mbox{S}\to\mbox{CuS}
\]

\end_inset

All three species are modeled explicitly in the mixture as solid-bound molecules,
 with id's 1 (Cu),
 2 (for S) and 3 (for CuS).
 The chemical reaction material is given by:
\end_layout

\begin_layout LyX-Code
<reaction name="copper sulfide production" type="mass-action-forward">
\end_layout

\begin_layout LyX-Code
  <vR sbm="1">1</vR>
\end_layout

\begin_layout LyX-Code
  <vR sbm="2">1</vR>
\end_layout

\begin_layout LyX-Code
  <vP sbm="3">1</vP>
\end_layout

\begin_layout LyX-Code
  <forward_rate type="constant reaction rate">
\end_layout

\begin_layout LyX-Code
    <k>1e-3</k>
\end_layout

\begin_layout LyX-Code
  </forward_rate>
\end_layout

\begin_layout LyX-Code
</reaction>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Law of Mass Action for Reversible Reactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mass-Action-Reversible"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Law of Mass Action for a reversible reaction is 
\shape italic
mass-action-reversible
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<forward_rate>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specific forward reaction rate 
\begin_inset Formula $k_{F}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<reverse_rate>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specific reverse reaction rate 
\begin_inset Formula $k_{R}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For this type of reaction the constitutive relation for the molar production rate is given by 
\begin_inset Formula 
\[
\hat{\zeta}=\hat{\zeta}_{F}-\hat{\zeta}_{R}\,,
\]

\end_inset

where 
\begin_inset Formula 
\[
\begin{aligned}\hat{\zeta}_{F} & =k_{F}\prod\limits_{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\\
\hat{\zeta}_{R} & =k_{R}\prod\limits_{\alpha}\left(c^{\alpha}\right)^{\nu_{P}^{\alpha}}
\end{aligned}
\,.
\]

\end_inset

The constitutive form of the specific forward and reverse reaction rates must be selected from the list of materials given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specific-Reaction-Rate"
nolink "false"

\end_inset

.
 The units of 
\begin_inset Formula $\hat{\zeta}_{F}$
\end_inset

 and 
\begin_inset Formula $\hat{\zeta}_{R}$
\end_inset

 are [
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}\cdot$
\end_inset


\series bold
t
\series default
] and those of 
\begin_inset Formula $c^{\alpha}$
\end_inset

 are [
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

].
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
Consider the reversible dissociation of CaCl salt into Ca
\begin_inset Formula $^{\mathrm{2+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

 in water,
 
\begin_inset Formula 
\[
\mbox{CaCl}_{2}\rightleftharpoons\mbox{Ca}^{2+}+2\mbox{Cl}^{-}
\]

\end_inset

All three species are modeled explicitly in the mixture as solutes,
 with id's 1 (for CaCl
\begin_inset Formula $_{\mathrm{2}})$
\end_inset

,
 2 (for Ca
\begin_inset Formula $^{\mathrm{2+}})$
\end_inset

 and 3 (for Cl
\begin_inset Formula $^{\mathrm{-}})$
\end_inset

.
 The chemical reaction material is given by:
\end_layout

\begin_layout LyX-Code
<reaction name="CaCl2 dissociation" type="mass-action-reversible">
\end_layout

\begin_layout LyX-Code
  <vR sol="1">1</vR>
\end_layout

\begin_layout LyX-Code
  <vP sol="2">1</vP>
\end_layout

\begin_layout LyX-Code
  <vP sol="3">2</vP>
\end_layout

\begin_layout LyX-Code
  <forward_rate type="constant">
\end_layout

\begin_layout LyX-Code
    <k>1.0</k>
\end_layout

\begin_layout LyX-Code
  </forward_rate>
\end_layout

\begin_layout LyX-Code
  <reverse_rate type="constant">
\end_layout

\begin_layout LyX-Code
    <k>0.1</k>
\end_layout

\begin_layout LyX-Code
  </reverse_rate>
\end_layout

\begin_layout LyX-Code
</reaction>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Michaelis-Menten Reaction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Michaelis-Menten-Reaction"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Michaelis-Menten reaction is 
\shape italic
Michaelis-Menten
\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<forward_rate>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum rate at saturating substrate concentration 
\begin_inset Formula $V_{\max}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Km>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
substrate concentration when reaction rate is half of 
\begin_inset Formula $V_{\max}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<c0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
optional minimum substrate concentration to trigger reaction 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
n
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Michaelis-Menten reaction may be used to model enzyme kinetics where the enzyme 
\begin_inset Formula $\mathcal{E}^{e}$
\end_inset

 triggers the conversion of the substrate 
\begin_inset Formula $\mathcal{E}^{s}$
\end_inset

 into the product 
\begin_inset Formula $\mathcal{E}^{p}$
\end_inset

.
 The product molar supply is given by 
\begin_inset Formula 
\[
\hat{c}^{p}=\begin{cases}
\frac{V_{\max}c^{s}}{K_{m}+c^{s}} & c^{s}\geqslant c_{0}\\
0 & c^{s}<c_{0}
\end{cases}\,,
\]

\end_inset

where 
\begin_inset Formula $c^{s}$
\end_inset

 is the substrate concentration.
 The default value of 
\begin_inset Formula $c_{0}$
\end_inset

 is 0.
 This relation may be derived,
 with some simplifying assumptions,
 by applying the law of mass action to the combination of two reactions,
 
\begin_inset Formula 
\[
\mathcal{E}^{e}+\mathcal{E}^{s}\rightleftharpoons\mathcal{E}^{es}\to\mathcal{E}^{e}+\mathcal{E}^{p}
\]

\end_inset

Since the enzyme is not modeled explicitly in the Michaelis-Menten approximation to these two reactions,
 this reaction model is effectively equivalent to 
\begin_inset Formula 
\[
\mathcal{E}^{s}\to\mathcal{E}^{p}.
\]

\end_inset

Therefore,
 this reaction accepts only one reactant tag <vR> and one product tag <vP>.
 For consistency with the formulation of this reaction,
 the stoichiometric coefficients should be set to 
\begin_inset Formula $\nu_{R}^{s}=\nu_{P}^{p}=1$
\end_inset

,
 so that 
\begin_inset Formula $\hat{c}^{p}=\hat{\zeta}$
\end_inset

.
\end_layout

\begin_layout Standard
The constitutive form of the specific forward reaction rate 
\begin_inset Formula $V_{\max}$
\end_inset

 must be selected from the list of materials given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specific-Reaction-Rate"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<reaction name="enzyme kinetics" type="Michaelis-Menten">
\end_layout

\begin_layout LyX-Code
  <Vbar>0</Vbar>
\end_layout

\begin_layout LyX-Code
  <vR sol="1">1</vR>
\end_layout

\begin_layout LyX-Code
  <vP sol="2">1</vP>
\end_layout

\begin_layout LyX-Code
  <forward_rate type="constant">
\end_layout

\begin_layout LyX-Code
    <k>1.0</k>
\end_layout

\begin_layout LyX-Code
  </forward_rate>
\end_layout

\begin_layout LyX-Code
  <Km>5.0</Km>
\end_layout

\begin_layout LyX-Code
</reaction>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Specific Reaction Rate Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Specific-Reaction-Rate"

\end_inset


\end_layout

\begin_layout Standard
The following sections define specific materials that can be used to define the reaction rate of a chemical reaction.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Constant Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constant-Reaction-Rate"

\end_inset


\end_layout

\begin_layout Standard
The material type for a constant specific reaction rate is 
\shape italic
constant reaction rate
\shape default
.
 The following parameter must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
constant specific reaction rate 
\begin_inset Formula $k$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\shape italic
units vary
\shape default
] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<reaction name="enzyme kinetics" type="Michaelis-Menten">
\end_layout

\begin_layout LyX-Code
  <Vbar>0</Vbar>
\end_layout

\begin_layout LyX-Code
  <vR sol="1">1</vR>
\end_layout

\begin_layout LyX-Code
  <vP sol="2">1</vP>
\end_layout

\begin_layout LyX-Code
  <forward_rate type="constant reaction rate">
\end_layout

\begin_layout LyX-Code
    <k>1.0</k>
\end_layout

\begin_layout LyX-Code
  </forward_rate>
\end_layout

\begin_layout LyX-Code
</reaction>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Huiskes Reaction Rate
\begin_inset CommandInset label
LatexCommand label
name "subsec:Huiskes-Reaction-Rate"

\end_inset


\end_layout

\begin_layout Standard
The material type for the Huiskes reaction rate is 
\shape italic
Huiskes reaction rate
\shape default
.
 This material model employs the bone remodeling framework proposed by Weinans et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Weinans92"
literal "false"

\end_inset

 and extended by Mullender et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mullender94"
literal "false"

\end_inset

.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<B>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
reaction rate per specific strain energy 
\begin_inset Formula $B$
\end_inset

 (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\shape italic
units vary
\shape default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<psi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
specific strain energy at homeostasis 
\begin_inset Formula $\psi_{0}$
\end_inset

 (default=0) 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
F
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
L
\series default
/
\series bold
M
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<D>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
characteristic distance from sensors (default=0)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The Huiskes specific reaction rate has the form 
\begin_inset Formula 
\[
k=\frac{1}{\left(J-\varphi_{r}^{s}\right)M^{s}}\left(B\left(\frac{\Psi_{r}}{\rho_{r}^{s}}-\psi_{0}\right)+\sum_{i=1}^{N}e^{-d_{i}/D}B_{i}\left(\frac{\Psi_{ri}}{\rho_{ri}^{s}}-\psi_{0}\right)\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\Psi_{r}$
\end_inset

 is the strain energy density of the solid (strain energy in current configuration per mixture volume in the reference configuration) and 
\begin_inset Formula $\rho_{r}^{s}=\sum\nolimits_{\sigma}\rho_{r}^{\sigma}$
\end_inset

 is the referential apparent solid density (mass of solid in current configuration per mixture volume in reference configuration).
 The ratio 
\begin_inset Formula $\Psi_{r}/\rho_{r}^{s}$
\end_inset

 is the specific strain energy (strain energy per mass of solid in the current configuration).
 The Huiskes specific reaction rate may assume positive and negative values;
 it reduces to zero at homeostasis,
 when 
\begin_inset Formula $\Psi_{r}/\rho_{r}^{s}=\psi_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
Per Mullender et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mullender94"
literal "false"

\end_inset

,
 the remodeling rate 
\begin_inset Formula $k$
\end_inset

 at the current material point may depend not only on the specific strain energy at the current point,
 but also on its value in the neighborhood of the current point (e.g.,
 due to the presence of neihboring sensing cells that provide some form of feedback at the current location).
 Here,
 
\begin_inset Formula $N$
\end_inset

 represents the number of elements in the neighborhood of the current material point element,
 which fall within a characteristic sensing distance 
\begin_inset Formula $D$
\end_inset

,
 and 
\begin_inset Formula $d_{i}$
\end_inset

 represents the distance between these neighboring points and the current material point.
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $D=0$
\end_inset

 it follows that 
\begin_inset Formula $N=0$
\end_inset

 and the model uses the original formulation of Weinans et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Weinans92"
literal "false"

\end_inset

.
 When 
\begin_inset Formula $D>0$
\end_inset

,
 as per Mullender et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mullender94"
literal "false"

\end_inset

,
 the finite element code first searches for all the neighboring elements 
\begin_inset Formula $N$
\end_inset

 which fall within a distance of 
\begin_inset Formula $d_{i}\le4\times D$
\end_inset

 of the element at which 
\begin_inset Formula $k$
\end_inset

 needs to be evaluated (here,
 using 
\begin_inset Formula $d_{i}\le4\times D$
\end_inset

 implies that the exponential term becomes negligible beyond this distance,
 since 
\begin_inset Formula $e^{-4}=0.0183156$
\end_inset

).
 This search is conducted once,
 at the start of the analysis,
 implying that it is not updated at subsequent time points when the deformation may alter distances.
 With increasing values of 
\begin_inset Formula $D$
\end_inset

,
 the number 
\begin_inset Formula $N$
\end_inset

 of neighboring elements may increase considerably,
 especially in three-dimensional models,
 which will considerably slow down the computation of 
\begin_inset Formula $k$
\end_inset

,
 therefore users must be careful with choosing an appropriate value for 
\begin_inset Formula $D$
\end_inset

.
\end_layout

\begin_layout Standard
Since the referential solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 of a multiphasic mixture evolves with its composition as per eq.
\begin_inset CommandInset ref
LatexCommand pageref
reference "eq:cr-referential-solid-vol-frac"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 users must be careful not to allow 
\begin_inset Formula $J-\varphi_{r}^{s}\to0$
\end_inset

 as Huikes remodeling takes place,
 or else the computation of 
\begin_inset Formula $k$
\end_inset

 from the above formula becomes nearly singular.
 Typically this can be done by specifying the true density of the solid,
 
\begin_inset Formula $\rho_{T}^{s}$
\end_inset

 (<density> in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Bound-Molecules"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 to be much greater than the maximum apparent density 
\begin_inset Formula $\rho_{r}^{s}$
\end_inset

 allowed in the solid remodeling reaction (<rhomax> in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Multiphasic-Mat"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 Then,
 the contribution of the evolving 
\begin_inset Formula $\rho_{r}^{s}$
\end_inset

 to 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand pageref
reference "eq:cr-referential-solid-vol-frac"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 will remain negligible.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout Standard
To reproduce the interstitial solid remodeling theory proposed by Weinans et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Weinans92"
literal "true"

\end_inset

,
 consider the forward reaction 
\begin_inset Formula 
\[
\mbox{cells}+\mbox{solutes}\to\mbox{cells}+\mbox{solid}\,,
\]

\end_inset

where cells convert solutes (e.g.,
 nutrients) into synthesized solid when the specific strain energy exceeds the homeostatic value.
 If the cells and solutes are implicit in this reaction (e.g.,
 if it is assumed that their concentrations change negligibly),
 the production rate of the solid may be given by 
\begin_inset Formula $\hat{\zeta}=k$
\end_inset

 using the law of mass action for a forward rection,
 where 
\begin_inset Formula $k$
\end_inset

 has the form given above.
\end_layout

\begin_layout LyX-Code
<reaction name="solid remodeling" type="mass-action-forward">
\end_layout

\begin_layout LyX-Code
  <vP sbm="1">1</vP>
\end_layout

\begin_layout LyX-Code
  <forward_rate type="Huiskes reaction rate">
\end_layout

\begin_layout LyX-Code
    <B>1.0</B>
\end_layout

\begin_layout LyX-Code
    <psi0>0.01</psi0>
\end_layout

\begin_layout LyX-Code
    <D>0</D>
\end_layout

\begin_layout LyX-Code
  </forward_rate>
\end_layout

\begin_layout LyX-Code
</reaction>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Rigid Body
\begin_inset CommandInset label
LatexCommand label
name "sec:Rigid-Body"

\end_inset


\end_layout

\begin_layout Standard
A rigid body can be defined using the rigid material model.
 The material type for a rigid body is 
\begin_inset Quotes eld
\end_inset


\shape italic
rigid body
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters are defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<density>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Density of rigid body
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<center_of_mass>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Position of the center of mass
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
L
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<E>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Young's modulus
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<v>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson's ratio
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ] 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
If the 
\shape italic
center_of_mass 
\shape default
parameter is omitted,
 FEBio will calculate the center of mass automatically.
 In this case,
 a density 
\shape italic
must
\shape default
 be specified.
 If the 
\shape italic
center_of_mass 
\shape default
is defined the 
\shape italic
density 
\shape default
parameter may be omitted.
 Omitting both will generate an error message.
\end_layout

\begin_layout Standard
The Young's modulus 
\begin_inset Formula $E$
\end_inset

and Poisson ratio 
\begin_inset Formula $v$
\end_inset

 currently have no effect on the results.
 The only place where they are used is in the calculation of a material stiffness for some auto-penalty contact formulation.
 If you are using contact it is advised to enter sensible values.
 Otherwise these parameters may be omitted.
\end_layout

\begin_layout Standard
The degrees of freedom of a rigid body are initially unconstrained
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 This is different from previous versions of FEBio where rigid bodies were initially fully constrained.
\end_layout

\end_inset

.
 This implies that a rigid body is free to move in all three directions and rotate about any of the coordinate axes.
 To constrain a rigid body degree of freedom you may use the 
\emph on
Constraints
\emph default
 sections (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Rigid-Constraints"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="rigid body">
\end_layout

\begin_layout LyX-Code
  <density>1.0</density>
\end_layout

\begin_layout LyX-Code
  <center_of_mass>0,0,0</center_of_mass>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "sec:Active-Contraction"

\end_inset


\end_layout

\begin_layout Standard
Active contraction materials may be used to impose a (typically) contractile stress within a solid material,
 by incorporating the contraction material within a solid mixture.
 The total stress in the solid mixture is simply 
\begin_inset Formula $\boldsymbol{\sigma}=\boldsymbol{\sigma}^{s}+\boldsymbol{\sigma}^{a}$
\end_inset

,
 where 
\begin_inset Formula $\boldsymbol{\sigma}^{s}$
\end_inset

 is the solid stress (due to strain and strain history),
 and 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 is the active contractile stress.
 The calculation of the contractile stress is the same,
 wether the solid mixture consists of uncoupled or unconstrained materials.
\end_layout

\begin_layout Subsection
Contraction in Mixtures of Uncoupled Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Contraction-Mixtures-Uncoupled"

\end_inset


\end_layout

\begin_layout Standard
When the solid mixture consists of uncoupled materials,
 the active contraction material should be selected from the list below.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Uncoupled Prescribed Uniaxial Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Uniaxial-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed active contraction along a single direction (or fiber) in an uncoupled solid mixture is 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled
\shape default
 
\shape italic
prescribed uniaxial active contraction
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable uncoupled material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In the reference configuration,
 the fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{n}\otimes\mathbf{n}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}$
\end_inset

 is the stretched fiber orientation in the current (deformed) configuration.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Uniaxial contraction along 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 in a mixture containing a Mooney-Rivlin solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <k>1000</k>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed uniaxial active contraction uncoupled">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>0</theta>
\end_layout

\begin_layout LyX-Code
      <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Uncoupled Prescribed Transversely Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-TISO-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed isotropic active contraction in a plane transverse to a given direction (or fiber),
 in an uncoupled solid mixture,
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
prescribed trans iso active contraction uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable uncoupled material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In the reference configuration,
 the fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\left(\mathbf{B}-\mathbf{n}\otimes\mathbf{n}\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{e}_{1}$
\end_inset

 is the stretched fiber orientation in the current (deformed) configuration and 
\begin_inset Formula $\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Isotropic contraction in plane transverse to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 in a mixture containing a Mooney-Rivlin solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
    <k>1000</k>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed trans iso active contraction uncoupled">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>0</theta>
\end_layout

\begin_layout LyX-Code
      <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Uncoupled Prescribed Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Uncoupled-Isotropic-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed isotropic active contraction,
 in an uncoupled solid mixture,
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
prescribed isotropic active contraction uncoupled
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable uncoupled material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
uncoupled solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="none" valignment="top" width="189pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{B}\,.
\]

\end_inset

Note:
 If the solid material in the mixture is (nearly) incompressible,
 this isotropic contraction will cause no change in the deformation.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Isotropic contraction in a mixture containing a Mooney-Rivlin solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
    <k>5.0</k>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed isotropic active contraction uncoupled">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Prescribed Fiber Stress
\end_layout

\begin_layout Standard
An active fiber stress,
 based on a Hill formulation,
 can be added via the material 
\begin_inset Quotes eld
\end_inset


\emph on
uncoupled active fiber stress
\emph default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable compressible material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\emph on
uncoupled solid mixture
\emph default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Uncoupled-Solid-Mixture"
nolink "false"

\end_inset

.
 The stress is given by,
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T\left(\tilde{\lambda}\right)\mathbf{\mathrm{dev}A}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\mathbf{A=a\otimes a},$
\end_inset

with 
\series bold
a
\series default
 the unit vector describing the fiber direction in the spatial frame,
 
\emph on

\begin_inset Formula $\tilde{\lambda}$
\end_inset


\emph default
is the deviatoric fiber stretch,
 
\emph on
J 
\emph default
is the jacobian of the deformation,
 and 
\begin_inset Formula 
\[
T\left(\tilde{\lambda}\right)=s_{max}a\left(t\right)s_{TL}\left(\tilde{\lambda}\right)s_{TV}\left(\dot{\tilde{\lambda}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
The parameters are defined below.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scale factor for defining maximum stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
activation level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stl
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function defining the stress-stretch relatioship for the material
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stv
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function defining the stress-stretch rate relatioship for the material.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameters
\begin_inset Formula $s_{TL}$
\end_inset

and 
\begin_inset Formula $s_{TV}$
\end_inset

are functions that need to be defined in place.
 There are currently two ways of defining these functions,
 either via a mathematical expression or a list of sample points.
 An example is given below.
 If these parametes are omitted,
 they are replaced by the constant 1 in the equation for the stress above.
 
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
An example defining the stl parameter via a mathematical expression.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="uncoupled active fiber stress">
\end_layout

\begin_layout LyX-Code
    <smax>1.5</smax>
\end_layout

\begin_layout LyX-Code
    <a lc="1">0.1</a>
\end_layout

\begin_layout LyX-Code
    <stl type="math">
\end_layout

\begin_layout LyX-Code
      <math>(l-1)^2</math>
\end_layout

\begin_layout LyX-Code
    </stl>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
An example defining the stl parameter via a point list.
\end_layout

\begin_layout LyX-Code
<material id="1" type="uncoupled solid mixture">
\end_layout

\begin_layout LyX-Code
  <k>100.0</k>
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
    <c1>1.0</c1>
\end_layout

\begin_layout LyX-Code
    <c2>0</c2>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="uncoupled active fiber stress">
\end_layout

\begin_layout LyX-Code
    <smax>1.5</smax>
\end_layout

\begin_layout LyX-Code
    <a lc="1">0.1</a>
\end_layout

\begin_layout LyX-Code
    <stl type="point">
\end_layout

\begin_layout LyX-Code
      <interpolate>linear</interpolate>
\end_layout

\begin_layout LyX-Code
      <points>
\end_layout

\begin_layout LyX-Code
        <pt>0,0</pt>
\end_layout

\begin_layout LyX-Code
        <pt>1,0</pt>
\end_layout

\begin_layout LyX-Code
        <pt>2,1</pt>
\end_layout

\begin_layout LyX-Code
      </points>
\end_layout

\begin_layout LyX-Code
    </stl>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Contraction in Mixtures of Unconstrained Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Contraction-Mixtures-Unconstrained"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsubsec:mylabel27"

\end_inset

 When the solid mixture consists of unconstrained materials,
 the active contraction material should be selected from the list below.
\end_layout

\begin_layout Subsubsection
Prescribed Uniaxial Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Uniaxial-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed active contraction along a single direction (or fiber) in a solid mixture of unconstrained materials is 
\begin_inset Quotes eld
\end_inset


\shape italic
prescribed uniaxial active contraction
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable compressible material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In the reference configuration,
 the fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{n}\otimes\mathbf{n}\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{e}_{1}$
\end_inset

 is the stretched fiber orientation in the current (deformed) configuration.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Uniaxial contraction along 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 in a mixture containing a neo-Hookean solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed uniaxial active contraction">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>0</theta>
\end_layout

\begin_layout LyX-Code
      <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Prescribed Transversely Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-TISO-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed isotropic active contraction in a plane transverse to a given direction (or fiber),
 in a solid mixture of unconstrained materials,
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
prescribed trans iso active contraction
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable compressible material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In the reference configuration,
 the fiber is oriented along the unit vector 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 where 
\begin_inset Formula $\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} $
\end_inset

 are orthonormal basis vectors representing the local element coordinate system when specified (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Specifying-Fiber-Orientation"
nolink "false"

\end_inset

),
 or else the global Cartesian coordinate system.
 The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\left(\mathbf{B}-\mathbf{n}\otimes\mathbf{n}\right)\,,
\]

\end_inset

where 
\begin_inset Formula $\mathbf{n}=\mathbf{F}\cdot\mathbf{e}_{1}$
\end_inset

 is the stretched fiber orientation in the current (deformed) configuration and 
\begin_inset Formula $\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}$
\end_inset

 is the left Cauchy-Green tensor.
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Isotropic contraction in plane transverse to 
\begin_inset Formula $\mathbf{e}_{1}$
\end_inset

,
 in a mixture containing a neo-Hookean solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed trans iso active contraction">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
    <mat_axis type="angles">
\end_layout

\begin_layout LyX-Code
      <theta>0</theta>
\end_layout

\begin_layout LyX-Code
      <phi>90</phi>
\end_layout

\begin_layout LyX-Code
    </mat_axis>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Prescribed Isotropic Active Contraction
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Isotropic-Contraction"

\end_inset


\end_layout

\begin_layout Standard
The material type for prescribed isotropic active contraction,
 in a solid mixture of unconstrained materials,
 is 
\begin_inset Quotes eld
\end_inset


\shape italic
prescribed isotropic active contraction
\shape default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable compressible material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\shape italic
solid mixture
\shape default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The following material parameters need to be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<T0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T_{0},$
\end_inset

 representing the prescribed stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The active stress 
\begin_inset Formula $\boldsymbol{\sigma}^{a}$
\end_inset

 for this material is given by 
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{B}\,.
\]

\end_inset


\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
Isotropic contraction in a mixture containing a neo-Hookean solid.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="prescribed isotropic active contraction">
\end_layout

\begin_layout LyX-Code
    <T0 lc="2">1</T0>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Subsubsection
Prescribed Fiber Stress
\end_layout

\begin_layout Standard
An active fiber stress,
 based on a Hill formulation,
 can be added via the material 
\begin_inset Quotes eld
\end_inset


\emph on
active fiber stress
\emph default

\begin_inset Quotes erd
\end_inset

.
 This material must be combined with a stable compressible material that acts as a passive matrix,
 using a 
\begin_inset Quotes eld
\end_inset


\emph on
solid mixture
\emph default

\begin_inset Quotes erd
\end_inset

 container as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solid-Mixture"
nolink "false"

\end_inset

.
 The stress is given by,
\begin_inset Formula 
\[
\boldsymbol{\sigma}^{a}=J^{-1}T\left(\lambda\right)\mathbf{A}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\mathbf{A=a\otimes a},$
\end_inset

with 
\series bold
a
\series default
 the unit vector describing the fiber direction in the spatial frame,
 
\emph on

\begin_inset Formula $\lambda$
\end_inset


\emph default
is the fiber stretch,
 
\emph on
J 
\emph default
is the jacobian of the deformation,
 and 
\begin_inset Formula 
\[
T\left(\lambda\right)=s_{max}a\left(t\right)s_{TL}\left(\lambda\right)s_{TV}\left(\dot{\lambda}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
The parameters are defined below.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
smax
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scale factor for defining maximum stress
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
activation level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stl
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function defining the stress-stretch relatioship for the material
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stv
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function defining the stress-stretch rate relatioship for the material.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameters
\begin_inset Formula $s_{TL}$
\end_inset

and 
\begin_inset Formula $s_{TV}$
\end_inset

are functions that need to be defined in place.
 There are currently two ways of defining these functions,
 either via a mathematical expression or a list of sample points.
 An example is given below.
 If these parametes are omitted,
 they are replaced by the constant 1 in the equation for the stress above.
 
\end_layout

\begin_layout Standard

\shape italic
Example
\shape default
:
\end_layout

\begin_layout Standard
An example defining the stl parameter via a mathematical expression.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="active fiber stress">
\end_layout

\begin_layout LyX-Code
    <smax>150</smax>
\end_layout

\begin_layout LyX-Code
    <a lc="1">0.1</a>
\end_layout

\begin_layout LyX-Code
    <stl type="math">
\end_layout

\begin_layout LyX-Code
      <math>(l-1)^2</math>
\end_layout

\begin_layout LyX-Code
    </stl>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
An example defining the stl parameter via a point list.
\end_layout

\begin_layout LyX-Code
<material id="1" type="solid mixture">
\end_layout

\begin_layout LyX-Code
  <mat_axis type="local">0,0,0</mat_axis>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <solid type="active fiber stress">
\end_layout

\begin_layout LyX-Code
    <smax>150</smax>
\end_layout

\begin_layout LyX-Code
    <a lc="1">0.1</a>
\end_layout

\begin_layout LyX-Code
    <stl type="point">
\end_layout

\begin_layout LyX-Code
      <interpolate>linear</interpolate>
\end_layout

\begin_layout LyX-Code
      <points>
\end_layout

\begin_layout LyX-Code
        <pt>0,0</pt>
\end_layout

\begin_layout LyX-Code
        <pt>1,0</pt>
\end_layout

\begin_layout LyX-Code
        <pt>2,1</pt>
\end_layout

\begin_layout LyX-Code
      </points>
\end_layout

\begin_layout LyX-Code
    </stl>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Section
Viscous Fluids
\begin_inset CommandInset label
LatexCommand label
name "sec:Fluids"

\end_inset


\end_layout

\begin_layout Standard
Fluid mechanics analyses may be used to examine fluid flow over fixed domains.
 Fluid-structure interactions (FSI) may be used to examine fluid flow over deforming domains.
 It is also possible to perform solute (mass) transport analyses in fluid mixtures using the fluid-solutes module.
 FEBio's fluid,
 fluid-FSI and fluid-solutes modules treat the fluid as isothermal (constant and uniform temperature) and compressible;
 incompressible flow is simulated by prescribing a physically realistic bulk modulus 
\begin_inset Formula $K$
\end_inset

 to model the fluid's elastic compressibility (for example,
 
\begin_inset Formula $K=2.2\,\text{GPa}$
\end_inset

 for water at room temperature).
 The Cauchy stress 
\begin_inset Formula ${\rm \boldsymbol{\sigma}}^{f}$
\end_inset

 in a fluid is given by 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}^{f}=-p\mathbf{I}+\boldsymbol{\tau}\,,\label{eq:cfd-stress}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the fluid pressure arising from the elastic and osmotic responses and 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 is the viscous stress resulting from the fluid viscosity and its rate of deformation.
 FEBio's fluid solver uses the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

,
 instead of the 
\emph on
effective fluid pressure
\emph default
 
\begin_inset Formula $\tilde{p}$
\end_inset

,
 as a nodal degree of freedom.
 The effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 may differ from the actual fluid pressure 
\begin_inset Formula $p$
\end_inset

 if solutes are present in the fluid mixture,
 as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 In fluid analyses the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 is also the elastic contribution to the fluid pressure,
 resulting from changes in 
\begin_inset Formula $e^{f}$
\end_inset

.
 FEBio provides several alternative constitutive models for the elastic response 
\begin_inset Formula $\tilde{p}\left(e^{f}\right)$
\end_inset

,
 including
\begin_inset Formula 
\begin{equation}
\begin{aligned}\tilde{p}\left(e^{f}\right) & =-Ke^{f} & \text{linear}\\
\tilde{p}\left(e^{f}\right) & =K\left(\frac{1}{1+e^{f}}-1\right) & \text{nonlinear}\\
\tilde{p}\left(e^{f}\right) & =-K\frac{\ln\left(1+e^{f}\right)}{1+e^{f}} & \text{log nonlinear}
\end{aligned}
\label{eq:fluid-pressure-state}
\end{equation}

\end_inset

where 
\begin_inset Formula $K$
\end_inset

 is the fluid's bulk modulus (a physical property that may be looked up or measured).
 The reason for selecting 
\begin_inset Formula $e^{f}$
\end_inset

 instead of 
\begin_inset Formula $\tilde{p}$
\end_inset

 is that the dilatation (volumetric strain) is a kinematic measure,
 just like the fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 (the other nodal degree of freedom) and its associated rate of deformation tensor,
 whereas 
\begin_inset Formula $\tilde{p}$
\end_inset

 is a function of state (it needs to be formulated as a function of the deformation,
 just like the viscous fluid stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

).
 Here,
 
\begin_inset Formula $\tilde{p}$
\end_inset

 is called the 
\emph on
elastic pressure
\emph default
 because it represents the elastic response (equivalent to the stress-strain response in hyperelasticity for solid mechanics) of the fluid under isothermal conditions.
 The 
\emph on
linear
\emph default
 model in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 is useful for nearly-incompressible flow,
 typically used for liquids.
 However,
 if one expects high volumetric strains in the flow (e.g.,
 at a stagnation point in a high-velocity fluid flow problem),
 it may be better to employ one of the two 
\emph on
nonlinear
\emph default
 formulations in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 In particular,
 for an ideal gas,
 the gauge pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 is given by
\begin_inset Formula 
\begin{equation}
\tilde{p}=P_{r}\left(\frac{\theta}{J^{f}\theta_{r}}-1\right)\quad J^{f}=1+e^{f}\label{eq:ideal-gas-pressure}
\end{equation}

\end_inset

where 
\begin_inset Formula $\theta_{r}$
\end_inset

 is the (arbitrarily selected) reference temperature and 
\begin_inset Formula $P_{r}$
\end_inset

 is the corresponding referential absolute pressure (at 
\begin_inset Formula $\theta=\theta_{r}$
\end_inset

 and 
\begin_inset Formula $J^{f}=1$
\end_inset

).
 When an ideal gas undergoes an isothermal process (
\begin_inset Formula $\theta=\theta_{r}$
\end_inset

),
 eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ideal-gas-pressure"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 reduces to the 
\emph on
nonlinear
\emph default
 model in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 with bulk modulus 
\begin_inset Formula $K=P_{r}$
\end_inset

.
 Thus,
 the 
\emph on
nonlinear
\emph default
 model is consistent with ideal gas law under isothermal processes.
 Isothermal processes produce zero heat flux,
 
\begin_inset Formula $\mathbf{q}=\mathbf{0}$
\end_inset

,
 however heat is generated by the fluid viscosity at the rate 
\begin_inset Formula $\boldsymbol{\tau}:\mathbf{D}^{f}$
\end_inset

 where 
\begin_inset Formula $\mathbf{D}^{f}$
\end_inset

 is the rate of deformation tensor for the fluid (see below).
 Therefore,
 to maintain isothermal conditions,
 we must assume that this heat is implicitly radiated into or out of the fluid domain.
 For isentropic processes it can be shown that the temperature variation in an ideal gas obeys 
\begin_inset Formula $\theta/\theta_{r}=\left(J^{f}\right)^{1-\gamma}$
\end_inset

,
 where 
\begin_inset Formula $\gamma$
\end_inset

 is the ratio of isobaric to isochoric specific heat capacities,
 
\begin_inset Formula $\gamma=c_{p0}/c_{v0}$
\end_inset

.
 In that case,
 the pressure in an ideal gas evolves according to 
\begin_inset Formula $\tilde{p}=P_{r}\left(\left(1+e^{f}\right)^{-\gamma}-1\right)$
\end_inset

,
 which represents a fourth alternative to the three models presented in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 with 
\begin_inset Formula $K=P_{r}$
\end_inset

.
 Contrary to the simplifying assumptions found in thermodynamic textbooks,
 an isentropic process is not automatically adiabatic (although the reverse is true).
 Therefore,
 when modeling ideal gases undergoing isentropic processes,
 it is also assumed that the equation of energy balance is implicitly satisfied by suitably radiating heat into or out of the fluid domain.
\end_layout

\begin_layout Standard
The fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 is evaluated from the dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 (the relative change in volume,
 or volumetric strain) using the user-specified model from eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 (the default is 
\emph on
linear
\emph default
),
 where 
\begin_inset Formula $e^{f}=J^{f}-1$
\end_inset

 and 
\begin_inset Formula $J^{f}$
\end_inset

 is the fluid volume ratio.
 The fluid density 
\begin_inset Formula $\rho^{f}$
\end_inset

 varies with 
\begin_inset Formula $J^{f}$
\end_inset

 according to
\begin_inset Formula 
\begin{equation}
\rho^{f}=\frac{\rho_{r}^{f}}{J^{f}}\,,\label{eq:cfd-density}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho_{r}^{f}$
\end_inset

 is the fluid density in the reference configuration (when the pressure 
\begin_inset Formula $p$
\end_inset

 is zero).
 The dependence of 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 on the fluid rate of deformation tensor 
\begin_inset Formula $\mathbf{D}^{f}=\frac{1}{2}\left(\grad\mathbf{v}^{f}+\grad^{T}\mathbf{v}^{f}\right)$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{v}^{f}=$
\end_inset

fluid velocity,
 is given by a constitutive model which may be chosen from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Viscous-Fluid-Materials"
nolink "false"

\end_inset

.
 Though Newtonian and non-Newtonian fluids may be analyzed in this framework,
 all fluids are purely viscous (no viscoelasticity is included in this formulation).
 Setting the viscosity to zero is allowable,
 for the purpose of analyzing inviscid flow.
 The user is referred to the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

 for a general description of this isothermal compressible viscous flow framework.
\end_layout

\begin_layout Standard
For fluid analyses,
 which are performed over a fixed mesh,
 FEBio solves for the components of the fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 and fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 at each node.
 In contrast,
 fluid-FSI analyses are performed over deforming meshes and FEBio treats fluid-FSI domains as a mixture of a viscous fluid 
\begin_inset Formula $f$
\end_inset

 and a massless,
 frictionless porous solid 
\begin_inset Formula $s$
\end_inset

.
 Thus,
 the fluid encounters zero resistance as it flows through the deforming mesh (porous solid).
 The solid constituent of a fluid-FSI domain regularizes the mesh deformation;
 it is a hyperelastic solid whose constitutive relation is selected by the user;
 the recommended choice is the unconstrained neo-Hookean solid defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

,
 with 
\begin_inset Formula $\nu=0$
\end_inset

 and 
\begin_inset Formula $E$
\end_inset

 set to a very small (but non-zero) value.
 For fluid-FSI analyses,
 FEBio solves for the solid displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

,
 the fluid velocity 
\begin_inset Formula $\mathbf{w}$
\end_inset

 relative to the mesh,
 and the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

.
 The fluid velocity is then calculated as 
\begin_inset Formula 
\begin{equation}
\mathbf{v}^{f}=\mathbf{v}^{s}+\mathbf{w}\,,\label{eq:FSI-fluid-velocity}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

 is the mesh velocity (the material time derivative of the solid displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

).
 Since the mesh is fixed in a standard fluid analysis,
 
\begin_inset Formula $\mathbf{v}^{s}=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}^{f}=\mathbf{w}$
\end_inset

 in that case.
 Therefore,
 we use 
\begin_inset Formula $\mathbf{w}$
\end_inset

 to refer to the fluid velocity degrees of freedom for fluid and fluid-FSI analyses.
 For both types of analyses,
 the no-slip condition for viscous fluids flowing along a boundary is satisfied by setting 
\begin_inset Formula $\mathbf{w}=\mathbf{0}$
\end_inset

 on that boundary.
\end_layout

\begin_layout Standard
On any fluid boundary,
 the outward surface normal may be denoted by 
\begin_inset Formula $\mathbf{n}$
\end_inset

 and the traction vector on the fluid is given by 
\begin_inset Formula $\mathbf{t}^{f}=\boldsymbol{\sigma}^{f}\cdot\mathbf{n}=-p\,\mathbf{n}+\mathbf{t}^{\tau}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 is the viscous traction.
 Essential (Dirichlet) boundary conditions may be prescribed on 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $e^{f}$
\end_inset

,
 while natural (Neumann) boundary conditions may be prescribed on 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $w_{n}$
\end_inset

.
 The appearance of velocity in both essential and natural boundary conditions may seem surprising at first.
 To better understand the nature of these boundary conditions,
 it is convenient to separate the velocity into its normal and tangential components,
 
\begin_inset Formula $\mathbf{w}=w_{n}\mathbf{n}+\mathbf{w}_{t}$
\end_inset

,
 where 
\begin_inset Formula $\mathbf{w}_{t}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{w}$
\end_inset

.
 In particular,
 for inviscid flow,
 the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 and its corresponding traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 are both zero,
 leaving 
\begin_inset Formula $w_{n}$
\end_inset

 as the sole natural boundary condition;
 similarly,
 
\begin_inset Formula $e^{f}$
\end_inset

 becomes the only essential boundary condition in such flows,
 since 
\begin_inset Formula $\mathbf{w}_{t}$
\end_inset

 is unknown 
\emph on
a priori
\emph default
 on a frictionless boundary and must be obtained from the solution of the analysis.
 
\end_layout

\begin_layout Standard
In general,
 prescribing 
\begin_inset Formula $e^{f}$
\end_inset

 is equivalent to prescribing the elastic fluid pressure,
 since 
\begin_inset Formula $p$
\end_inset

 is only a function of 
\begin_inset Formula $e^{f}$
\end_inset

 according to eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:fluid-pressure-state"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 On a boundary where no conditions are prescribed explicitly,
 we conclude that 
\begin_inset Formula $w_{n}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

,
 which represents a frictionless wall.
 Conversely,
 it is possible to prescribe 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 on a boundary to produce a desired inflow or outflow while simultaneously stabilizing the flow conditions by prescribing a suitable viscous traction.
 Prescribing essential boundary conditions 
\begin_inset Formula $\mathbf{w}_{t}$
\end_inset

 and 
\begin_inset Formula $e^{f}$
\end_inset

 determines the tangential velocity on a boundary as well as the elastic fluid pressure 
\begin_inset Formula $p$
\end_inset

,
 leaving the option to also prescribe the normal component of the viscous traction,
 
\begin_inset Formula $t_{n}^{\tau}=\mathbf{t}^{\tau}\cdot\mathbf{n}$
\end_inset

,
 to completely determine the normal traction 
\begin_inset Formula $t_{n}^{f}=\mathbf{t}^{f}\cdot\mathbf{n}$
\end_inset

 (or else 
\begin_inset Formula $t_{n}^{\tau}$
\end_inset

 naturally equals zero).
 Mixed boundary conditions represent common physical features:
 Prescribing 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}_{t}$
\end_inset

 completely determines the velocity 
\begin_inset Formula $\mathbf{w}$
\end_inset

 on a boundary;
 prescribing 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 and 
\begin_inset Formula $e$
\end_inset

 completely determines the traction 
\begin_inset Formula $\mathbf{t}^{f}=\boldsymbol{\sigma}^{f}\cdot\mathbf{n}$
\end_inset

 on a boundary.
 Note that 
\begin_inset Formula $w_{n}$
\end_inset

 and 
\begin_inset Formula $e^{f}$
\end_inset

 are mutually exclusive boundary conditions,
 and the same holds for 
\begin_inset Formula $\mathbf{w}_{t}$
\end_inset

 and the tangential component of the viscous traction,
 
\begin_inset Formula $\mathbf{t}_{t}^{\tau}=\left(\mathbf{I}-\mathbf{n}\otimes\mathbf{n}\right)\cdot\mathbf{t}^{\tau}$
\end_inset

.
\end_layout

\begin_layout Standard
For viscous fluids,
 the no-slip boundary condition at an impermeable wall is enforced by setting 
\begin_inset Formula $\mathbf{w}_{t}=\mathbf{0}$
\end_inset

,
 whereas the wall impermeability condition implies 
\begin_inset Formula $w_{n}=0$
\end_inset

.
 Therefore,
 these conditions may be combined by prescribing wx,
 wy and wz components of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 to zero.
 FEBio offers a range of options for conveniently prescribing natural and mixed conditions on boundary surfaces in fluid analyses (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Surface-Loads"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Fluid Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Specification-Fluid"

\end_inset


\end_layout

\begin_layout Standard
The material type for a fluid material is 
\shape italic

\begin_inset Quotes eld
\end_inset

fluid
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<density>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid referential density 
\begin_inset Formula $\rho_{r}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
M
\series default
/
\series bold
L
\series default

\begin_inset Formula $^{\mathrm{3}}$
\end_inset

] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bulk modulus 
\begin_inset Formula $K$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<viscous>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of viscous model for 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <viscous> tag encloses a description of the viscous stress constitutive relation and associated material properties,
 as may be selected from the list provided in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Viscous-Fluid-Materials"
nolink "false"

\end_inset

.
 The parameters <density> and <k> must be greater than 0.
 These parameters are always required.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Water" type="fluid">
\end_layout

\begin_layout LyX-Code
	<density>1</density>
\end_layout

\begin_layout LyX-Code
	<k>2.2e+09</k>
\end_layout

\begin_layout LyX-Code
	<viscous type="Newtonian fluid">
\end_layout

\begin_layout LyX-Code
		<mu>0.001</mu>
\end_layout

\begin_layout LyX-Code
		<kappa>0</kappa>
\end_layout

\begin_layout LyX-Code
	</viscous>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Viscous Fluid Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Viscous-Fluid-Materials"

\end_inset


\end_layout

\begin_layout Standard
Viscous fluid materials provide a constitutive relation for the dependence of the viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 on the rate of deformation tensor 
\begin_inset Formula $\mathbf{D}^{f}$
\end_inset

 of a fluid.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Newtonian Fluid
\begin_inset CommandInset label
LatexCommand label
name "subsec:Newtonian-Fluid"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Newtonian fluid is 
\begin_inset Quotes eld
\end_inset


\shape italic
Newtonian fluid
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity 
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bulk viscosity 
\begin_inset Formula $\kappa$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=\left(\kappa-\frac{2}{3}\mu\right)\left(\tr\mathbf{D}\right)\mathbf{I}+2\mu\mathbf{D}
\]

\end_inset

Stokes' condition is a constitutive assumption that sets 
\begin_inset Formula $\tr\boldsymbol{\tau}=0$
\end_inset

,
 implying that 
\begin_inset Formula $\kappa=0$
\end_inset

.
 This assumption is only valid for some fluids (e.g.,
 monoatomic gas 
\begin_inset CommandInset citation
LatexCommand citep
key "Panton06"
literal "true"

\end_inset

).
 Users may use or ignore this assumption by selecting an appropriate value for 
\begin_inset Formula $\kappa$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Newtonian fluid">
\end_layout

\begin_layout LyX-Code
	<mu>0.001</mu>
\end_layout

\begin_layout LyX-Code
	<kappa>0</kappa>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Bingham Fluid
\begin_inset CommandInset label
LatexCommand label
name "subsec:Bingham-Fluid"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Bingham fluid 
\begin_inset CommandInset citation
LatexCommand citep
key "Papanastasiou87"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Bingham
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at infinite shear rate,
 
\begin_inset Formula $\mu_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<tauy>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yield stress,
 
\begin_inset Formula $\tau_{y}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\mu_{\infty}+\frac{\tau_{y}}{\dot{\gamma}}\left(1-e^{-n\dot{\gamma}}\right)
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
 In the limit as 
\begin_inset Formula $\dot{\gamma}\to0$
\end_inset

 the viscosity is given by 
\begin_inset Formula $\mu=\mu_{\infty}+n\tau_{y}$
\end_inset

.
 If we define the scalar shear stress 
\begin_inset Formula $\tau=\sqrt{\boldsymbol{\tau}:\boldsymbol{\tau}/2}$
\end_inset

,
 if follows that 
\begin_inset Formula $\tau=\mu_{\infty}\dot{\gamma}+\tau_{y}\left(1-e^{-n\dot{\gamma}}\right)$
\end_inset

.
 Effectively,
 this constitutive model represents a bilinear response for 
\begin_inset Formula $\tau$
\end_inset

 versus 
\begin_inset Formula $\dot{\gamma}$
\end_inset

,
 with a slope of 
\begin_inset Formula $\mu_{\infty}+n\tau_{y}$
\end_inset

 when 
\begin_inset Formula $\tau<\tau_{y}$
\end_inset

 and 
\begin_inset Formula $\mu=\mu_{\infty}$
\end_inset

 when 
\begin_inset Formula $\tau>\tau_{y}$
\end_inset

.
 The exponential function rounds the corner at the intersection of these two lines.
 For an ideal Bingham fluid one would need to let 
\begin_inset Formula $n\to\infty$
\end_inset

.
 In practice,
 values of 
\begin_inset Formula $n$
\end_inset

 between 5 and 50 work well,
 with the lower end of this range producing faster convergence of the finite element solution.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Bingham">
\end_layout

\begin_layout LyX-Code
	<mu>1</mu>
\end_layout

\begin_layout LyX-Code
	<tauy>40</tauy>
\end_layout

\begin_layout LyX-Code
	<n>40</n>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Carreau Model
\begin_inset CommandInset label
LatexCommand label
name "subsec:Carreau-Fluid"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Carreau model 
\begin_inset CommandInset citation
LatexCommand citep
key "Cho91"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Carreau
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at zero shear rate,
 
\begin_inset Formula $\mu_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mui>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at infinite shear rate,
 
\begin_inset Formula $\mu_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time constant
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\left(1+\left(\lambda\dot{\gamma}\right)^{2}\right)^{\left(n-1\right)/2}
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Carreau">
\end_layout

\begin_layout LyX-Code
	<mu0>0.056</mu0>
\end_layout

\begin_layout LyX-Code
	<mui>0.0035</mui>
\end_layout

\begin_layout LyX-Code
	<lambda>3.3</lambda>
\end_layout

\begin_layout LyX-Code
	<n>0.36</n>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Carreau-Yasuda Model
\begin_inset CommandInset label
LatexCommand label
name "subsec:Carreau-Yasuda-Model"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Carreau-Yasuda model 
\begin_inset CommandInset citation
LatexCommand citep
key "Cho91"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Carreau-Yasuda
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at zero shear rate,
 
\begin_inset Formula $\mu_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mui>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at infinite shear rate,
 
\begin_inset Formula $\mu_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time constant
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<n>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<a>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
power-law exponent divider
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\left(1+\left(\lambda\dot{\gamma}\right)^{a}\right)^{\left(n-1\right)/a}
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Carreau-Yasuda">
\end_layout

\begin_layout LyX-Code
	<mu0>0.056</mu0>
\end_layout

\begin_layout LyX-Code
	<mui>0.0035</mui>
\end_layout

\begin_layout LyX-Code
	<lambda>1.9</lambda>
\end_layout

\begin_layout LyX-Code
	<n>0.22</n>
\end_layout

\begin_layout LyX-Code
	<a>1.25</a>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Powell-Eyring Model
\begin_inset CommandInset label
LatexCommand label
name "subsec:Powell-Eyring-Model"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Powell-Eyring model 
\begin_inset CommandInset citation
LatexCommand citep
key "Cho91"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\emph on
Powell-Eyring
\shape italic
\emph default

\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at zero shear rate,
 
\begin_inset Formula $\mu_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mui>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at infinite shear rate,
 
\begin_inset Formula $\mu_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time constant
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\frac{\sinh^{-1}\lambda\dot{\gamma}}{\lambda\dot{\gamma}}
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Powell-Eyring">
\end_layout

\begin_layout LyX-Code
	<mu0>0.056</mu0>
\end_layout

\begin_layout LyX-Code
	<mui>0.0035</mui>
\end_layout

\begin_layout LyX-Code
	<lambda>5.4</lambda>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Cross Model
\begin_inset CommandInset label
LatexCommand label
name "subsec:Cross-Model"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Cross model 
\begin_inset CommandInset citation
LatexCommand citep
key "Cho91"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Cross
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at zero shear rate,
 
\begin_inset Formula $\mu_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
] 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mui>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at infinite shear rate,
 
\begin_inset Formula $\mu_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<lambda>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time constant
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<m>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exponent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\mu_{\infty}+\left(\mu_{0}-\mu_{\infty}\right)\frac{1}{1+\left(\lambda\dot{\gamma}\right)^{m}}
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Cross">
\end_layout

\begin_layout LyX-Code
	<mu0>0.056</mu0>
\end_layout

\begin_layout LyX-Code
	<mui>0.0035</mui>
\end_layout

\begin_layout LyX-Code
	<lambda>1.0</lambda>
\end_layout

\begin_layout LyX-Code
	<m>1.0</m>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Quemada Model
\begin_inset CommandInset label
LatexCommand label
name "subsec:Quemada-Fluid"

\end_inset


\end_layout

\begin_layout Standard
The material type for a Quemada model 
\begin_inset CommandInset citation
LatexCommand citep
key "Quemada78"
literal "true"

\end_inset

 is 
\begin_inset Quotes eld
\end_inset


\shape italic
Quemada
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<mu0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
shear viscosity at zero shear rate suspension volume fraction,
 
\begin_inset Formula $\mu_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
P
\series default

\begin_inset Formula $\cdot$
\end_inset


\series bold
t
\series default
]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<H>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
suspension volume fraction,
 
\begin_inset Formula $H$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k0>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
intrinsic relative viscosity at zero shear rate,
 
\begin_inset Formula $k_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kinf>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
intrinsic relative viscosity at infinite shear rate,
 
\begin_inset Formula $k_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gc>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
critical shear rate,
 
\begin_inset Formula $\dot{\gamma}_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[
\series bold
t
\series default

\begin_inset Formula $^{-1}$
\end_inset

]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The viscous shear stress for this material model is
\begin_inset Formula 
\[
\boldsymbol{\tau}=2\mu\mathbf{D}
\]

\end_inset

where
\begin_inset Formula 
\[
\mu=\frac{\mu_{0}}{\left(1-k\frac{H}{2}\right)^{2}}
\]

\end_inset

and
\begin_inset Formula 
\[
k=\frac{k_{0}+k_{\infty}\sqrt{\dot{\gamma}_{r}}}{1+\sqrt{\dot{\gamma}_{r}}}\,,\quad\dot{\gamma}_{r}=\frac{\dot{\gamma}}{\dot{\gamma}_{c}}
\]

\end_inset

Here,
 
\begin_inset Formula $\dot{\gamma}=\sqrt{2\mathbf{D}:\mathbf{D}}$
\end_inset

 is the engineering shear rate.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<viscous type="Quemada">
\end_layout

\begin_layout LyX-Code
	<mu0>0.03</mu0>
\end_layout

\begin_layout LyX-Code
	<H>0.5</H>
\end_layout

\begin_layout LyX-Code
	<k0>3.691</k0>
\end_layout

\begin_layout LyX-Code
	<kinf>1.778</kinf>
\end_layout

\begin_layout LyX-Code
    <gc>2.30</gc>
\end_layout

\begin_layout LyX-Code
</viscous>
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
General Specification of Fluid-FSI Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Fluid-FSI-Materials"

\end_inset


\end_layout

\begin_layout Standard
The material type for a fluid-FSI material is 
\shape italic

\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset


\shape default
.
 This type of material is used for fluid flow through a deforming mesh.
 The material is treated as a special case of fluid-solid mixture,
 with the solid material used to regularize the mesh deformation.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fluid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of fluid model 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of elastic solid model for mesh deformation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <fluid> tag encloses a description of the fluid,
 as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Fluid"
nolink "false"

\end_inset

.
 The <solid> tag encloses a description of the solid,
 which should be modeled as an unconstrained elastic solid,
 as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The recommended choice is the unconstrained neo-Hookean solid defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

,
 with 
\begin_inset Formula $\nu=0$
\end_inset

 and 
\begin_inset Formula $E$
\end_inset

 set to a very small (but non-zero) value.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Fluid-FSI domain" type="fluid-FSI">
\end_layout

\begin_layout LyX-Code
  <fluid type="fluid">
\end_layout

\begin_layout LyX-Code
    <density>1000</density>
\end_layout

\begin_layout LyX-Code
    <k>2.2e9</k>
\end_layout

\begin_layout LyX-Code
    <viscous type="Newtonian fluid">
\end_layout

\begin_layout LyX-Code
      <mu>0.001</mu>
\end_layout

\begin_layout LyX-Code
      <kappa>0</kappa>
\end_layout

\begin_layout LyX-Code
    </viscous>
\end_layout

\begin_layout LyX-Code
  </fluid>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>0</density>
\end_layout

\begin_layout LyX-Code
    <E>1e-9</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The value of <density> in the <solid> material is internally set to zero regardless of the user-defined value,
 since the deforming mesh should not be subjected to inertial forces.
\end_layout

\begin_layout Subsection
General Specification of Biphasic-FSI Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Fluid-BFSI-Materials"

\end_inset


\end_layout

\begin_layout Standard
The material type for a biphasic-FSI material is 
\shape italic

\begin_inset Quotes eld
\end_inset

biphasic-FSI
\begin_inset Quotes erd
\end_inset


\shape default
.
 This is a hybrid biphasic material used for modeling dynamic viscous fluid flow and frictional filtration through a porous-deformable solid.
 In contrast to the standard biphasic material described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Materials"
nolink "false"

\end_inset

,
 this material accommodates fluid viscosity and fluid dynamics;
 therefore it can be interfaced seamlessly with a fluid-FSI material to allow viscous fluid transport across that interface.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<phi0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
solid volume fraction 
\begin_inset Formula $\varphi_{r}^{s}$
\end_inset

 in the reference configuration (
\begin_inset Formula $0<\varphi_{r}^{s}<1)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[ ]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fluid>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the fluid material
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the porous solid material
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<permeability>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of the hydraulic permeability
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The parameter <phi0> must be greater than 0 (no solid) and less than 1 (no porosity).
 The <fluid> tag encloses a description of the fluid,
 as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Fluid"
nolink "false"

\end_inset

.
 The <solid> tag encloses a description of the solid matrix constitutive relation and associated material properties,
 such as those selected from the list provided in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Elastic-Solids"
nolink "false"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multigeneration-Solids"
nolink "false"

\end_inset

.
 The <permeability> tag encloses a description of the permeability constitutive relation and associated material properties,
 as may be selected from the list presented in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Permeability-Materials"
nolink "false"

\end_inset

.
 To simulate the special case of zero friction between the fluid and solid (such as in the fluid-FSI material),
 it is permissible to set the permeability to zero.
 
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="2" name="Material2" type="biphasic-FSI">
\end_layout

\begin_layout LyX-Code
  <phi0>0.25</phi0>
\end_layout

\begin_layout LyX-Code
  <fluid type="fluid">
\end_layout

\begin_layout LyX-Code
    <density>1e-9</density>
\end_layout

\begin_layout LyX-Code
    <k>1e+09</k>
\end_layout

\begin_layout LyX-Code
    <viscous type="Newtonian fluid">
\end_layout

\begin_layout LyX-Code
      <mu>1</mu>
\end_layout

\begin_layout LyX-Code
      <kappa>0</kappa>
\end_layout

\begin_layout LyX-Code
    </viscous>
\end_layout

\begin_layout LyX-Code
  </fluid>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>2e-9</density>
\end_layout

\begin_layout LyX-Code
    <E>200</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
  <permeability type="perm-const-iso">
\end_layout

\begin_layout LyX-Code
    <perm>0.005625</perm>
\end_layout

\begin_layout LyX-Code
  </permeability>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The value of <density> in the <fluid> and <solid> materials represents the true mass density of each constituent.
\end_layout

\begin_layout Subsection
General Specification of Fluid-Solutes Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-Fluid-Solutes"

\end_inset


\end_layout

\begin_layout Standard
The material type for a fluid-solutes material is 
\shape italic

\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset


\shape default
.
 This type of material is used for fluid flow and solute mass transport through a fixed mesh.
 The following parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<fluid>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of fluid model
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<osmotic_coefficient>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of osmotic coefficient for fluid-solutes mixture
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<solute>
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specification of (any number of) solute(s)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The <fluid> tag encloses a description of the fluid,
 as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Specification-Fluid"
nolink "false"

\end_inset

.
 The <solid> tag encloses a description of the solid,
 which should be modeled as an unconstrained elastic solid,
 as given in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Unconstrained-Materials"
nolink "false"

\end_inset

.
 The recommended choice is the unconstrained neo-Hookean solid defined in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

,
 with 
\begin_inset Formula $\nu=0$
\end_inset

 and 
\begin_inset Formula $E$
\end_inset

 set to a very small (but non-zero) value.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" name="Fluid-FSI domain" type="fluid-FSI">
\end_layout

\begin_layout LyX-Code
  <fluid type="fluid">
\end_layout

\begin_layout LyX-Code
    <density>1000</density>
\end_layout

\begin_layout LyX-Code
    <k>2.2e9</k>
\end_layout

\begin_layout LyX-Code
    <viscous type="Newtonian fluid">
\end_layout

\begin_layout LyX-Code
      <mu>0.001</mu>
\end_layout

\begin_layout LyX-Code
      <kappa>0</kappa>
\end_layout

\begin_layout LyX-Code
    </viscous>
\end_layout

\begin_layout LyX-Code
  </fluid>
\end_layout

\begin_layout LyX-Code
  <solid type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <density>0</density>
\end_layout

\begin_layout LyX-Code
    <E>1e-9</E>
\end_layout

\begin_layout LyX-Code
    <v>0</v>
\end_layout

\begin_layout LyX-Code
  </solid>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The value of <density> in the <solid> material is internally set to zero regardless of the user-defined value,
 since the deforming mesh should not be subjected to inertial forces.
\end_layout

\begin_layout Section
Prestrain material
\end_layout

\begin_layout Standard
In FEBio a prestrain can be defined for most materials that allows the user to prestrain or prestress the model before loading is applied.
 This is useful for modeling biologically tissues that exhibit residual strain,
 or whose initial state cannot assumed to be stress-free (e.g.
 arteries from in-vivo image data.) 
\end_layout

\begin_layout Standard
If you use this feature in your published research,
 please cite the corresponding paper that details the theoretical framework and the implementation in FEBio 
\begin_inset CommandInset citation
LatexCommand citep
key "Maas2016"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
In the modeling of biological tissues there are various reasons why the model needs to start from a prestressed configuration.
 For example,
 the biological tissue may exhibit residual stress or in situ stress.
 Or the geometry is taken from in vivo data and is subjected to loads in the reference configuration.
 In these cases,
 the reference configuration cannot be considered stress-free and this so-called prestress must somehow be accounted for.
 In large strain analysis,
 stresses are usually not additive and in addition,
 it must somehow be ensured that these prestresses are in equilibrium in the reference configuration.
 In general,
 this makes prestressing the reference configuration challenging in large strain analyses.
\end_layout

\begin_layout Standard
Progress can be made by assuming that the material is hyperelastic and that a prestrain can be found that defines the prestress via the hyperelastic constitutive formulation.
 Usually this prestrain is characterized by a second-order tensor,
 termed the prestrain gradient and here denoted by 
\begin_inset Formula $\mathnormal{\boldsymbol{F}}_{p}$
\end_inset

.
 The interpretation of this tensor is that its inverse,
 applied to a small neighborhood of a point in the reference configuration,
 would render this neighborhood stress-free.
 The total elastic response of the material is then defined via the elastic deformation gradient.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{F_{e}=}\boldsymbol{F\cdot F_{p}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\boldsymbol{F}$
\end_inset

is the deformation gradient that is the result of subsequent loading of the reference configuration.
 Finally,
 the Cauchy stress and spatial elasticity tangent are given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma=\mathcal{F}\left(F_{e}\right),}\boldsymbol{\;c=\mathcal{G\left(\mathnormal{F_{e}}\right)}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $\boldsymbol{\mathcal{F}}$
\end_inset

 and 
\emph on

\begin_inset Formula $\mathcal{\boldsymbol{G}}$
\end_inset


\emph default
 are the same response functions from the natural material,
 i.e.
 the response of the material that starts from a stress-free configuration.
 
\end_layout

\begin_layout Standard
It must be noted that although 
\begin_inset Formula $\mathnormal{\boldsymbol{F}}_{p}$
\end_inset

 is termed the prestrain gradient,
 in general it will not be the derivative of a deformation map.
 Consequently,
 a global stress-free reference configuration may not exist and the mapping of a neighborhood in the reference configuration to a stress-free state can at best be defined only locally.
 
\end_layout

\begin_layout Standard
In addition,
 it must also be recognized that the prestrain gradient is not unique.
 Due to the requirements of objectivity in the presence of material symmetries,
 the prestrain gradients 
\begin_inset Formula $\mathnormal{\boldsymbol{F}}_{p}$
\end_inset

 and 
\begin_inset Formula $\mathnormal{\boldsymbol{F'}}_{p}=\boldsymbol{F_{p}Q}$
\end_inset

 ,
 where 
\begin_inset Formula $\boldsymbol{Q}$
\end_inset

 is any orthogonal tensor,
 must result in the same material response.
 This implies that the prestrain can only be dependent on the right stretch tensor 
\begin_inset Formula $\boldsymbol{V_{p}}$
\end_inset

.
 However,
 in general even the right-stretch tensor cannot be defined uniquely.
 For instance,
 an isotropic material would only depend on the eigenvalues of this tensor and thus any tensor of the form 
\begin_inset Formula $\boldsymbol{RDR^{T}}$
\end_inset

,
 where 
\begin_inset Formula $\boldsymbol{R}$
\end_inset

 is any orthogonal tensor and 
\begin_inset Formula $\boldsymbol{D}$
\end_inset

 is a diagonal tensor with the three eigenvalues of 
\begin_inset Formula $\boldsymbol{V_{p}}$
\end_inset

on its diagonal,
 would render the same material response.
 In the presence of material symmetries,
 the situation is similar although 
\begin_inset Formula $\boldsymbol{R}$
\end_inset

 will only be part of the symmetry group.
\end_layout

\begin_layout Standard
Despite the fact that 
\begin_inset Formula $\mathnormal{\boldsymbol{F}}_{p}$
\end_inset

 is not unique,
 it is far from arbitrary.
 The most important restriction is that the resulting prestress field 
\begin_inset Formula $\boldsymbol{\sigma}_{p}$
\end_inset

must be in equilibrium with the prestressed reference configuration.
 In other words it must hold that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
div\boldsymbol{\sigma}_{p}=\boldsymbol{0}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
in the interior of the reference domain (in the absence of body forces) and that on the free boundaries of the domain
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\sigma}_{p}\cdot\boldsymbol{n}=0
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In a finite element simulation,
 when these conditions are not satisfied,
 the mesh will distort and a new reference state is obtained as well as an altered prestrain field.
 We will denote the deformation gradient between the original (incompatible) reference configuration and prestressed reference configuration by 
\begin_inset Formula $\boldsymbol{F}_{c}$
\end_inset

.
 When the mesh distorts the effectively applied prestrain field is also altered.
 In general,
 this is not desired and a correction to the prestrain field is necessary that either eliminates the distortion or finds a new reference geometry in which the desired prestrain field is supported.
\end_layout

\begin_layout Standard
The prestrain framework as currently implemented assumes that the total effective prestrain that is compatible with the possibly altered prestressed reference configuration is given by the following multiplicative decomposition.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{F}_{p}=\boldsymbol{F}_{c}\cdot\boldsymbol{\hat{F}}_{p}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Both the prestrain gradient and the distortion are in general unknown.
 The framework implements an iterative algorithm that updates 
\begin_inset Formula $\boldsymbol{F}_{c}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\hat{F}}_{p}$
\end_inset

 until an effective prestrain gradient is found that is compatible with the possibly distorted reference configuration.
 Without loss of generality the framework assumes that the altered prestrain gradient 
\begin_inset Formula $\boldsymbol{\hat{F}}_{p}$
\end_inset

is itself given by the multiplicative decomposition
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{\hat{F}}_{p}=\boldsymbol{G}\cdot\boldsymbol{F}_{0}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{F}_{0}$
\end_inset

 is an initial guess for the prestrain gradient and 
\begin_inset Formula $\mathbf{G}$
\end_inset

 is a correction factor.
 The algorithm starts by initializing 
\begin_inset Formula $\mathbf{F}_{0}$
\end_inset

 to a user-defined value and 
\begin_inset Formula $\mathbf{G}$
\end_inset

 to the identity.
 This initial value can be specified in a variety of ways and the code that generates this initial guess is called the prestrain generator.
 The framework provides several prestrain generators and users can easily add new ones.
 Then,
 a forward analysis is executed keeping 
\begin_inset Formula $\hat{\mathbf{F}}_{p}$
\end_inset

fixed.
 Unless the initial guess was compatible with the reference configuration,
 the mesh will distort.
 This distortion will define the new value for 
\begin_inset Formula $\mathbf{G}$
\end_inset

 which can be calculated directly from the nodal displacements in the usual manner.
 Next,
 the framework will update using a user-defined update rule.
 How 
\begin_inset Formula $\mathbf{G}$
\end_inset

 is updated depends on the particular application and the framework expects the user do provide the desired update rule.
 The current implementation provides two particular update rules:
 one to eliminate the distortion and one to enforce a particular form of the prestrain gradient.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:The-Prestrain-Update"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 on how to use these update rules.
 In addition,
 users can easily implement new update rules.
 After this update,
 a new forward analysis is executed.
 This process is repeated until 
\begin_inset Formula $\mathbf{G}$
\end_inset

 converges.
\end_layout

\begin_layout Subsection
The Prestrain Material
\end_layout

\begin_layout Standard
Prestrain can be applied by defining the 
\emph on
prestrain
\emph default
 material.
 This material acts as a wrapper to the underlying elastic constitutive model.
 There are two flavors of this material,
 one for coupled materials and one for uncoupled.
 In either case,
 the material defines two properties.
 The 
\emph on
elastic
\emph default
 property defines the elastic constitutive model.
 Any of the materials in FEBio could be used,
 however,
 the prestrain material has only been validated for hyperelastic materials.
 The second property,
 called 
\emph on
prestrain
\emph default
,
 defines the prestrain generator.
 This property defines how the initial prestrain gradient is calculated.
 Currently,
 it can be defined as a full second order matrix or as a fiber stretch.
 The prestrain data can be defined at the material level or at the element level.
 
\end_layout

\begin_layout Standard
The 
\emph on
prestrain
\emph default
 property defines the way that the initial prestrain gradient tensor is calculated.
 An algorithm that calculates the initial prestrain based on user input is here referred to as a prestrain generator.
 The type attribute is used to create a specific instance of a prestrain generator.
 Currently,
 the following generators are available.
\end_layout

\begin_layout Subsubsection
prestrain gradient
\end_layout

\begin_layout Standard
The 
\emph on
prestrain gradient 
\emph default
generator defines the full prestrain gradient matrix either for the entire material or for each element separately.
 It has the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
ramp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scale factor that ramps up the prestrain gradient (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
F0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3x3 target prestrain gradient matrix
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The prestrain gradient that is applied is calculated by the following equation.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{F}_{g}=\mathbf{I}\left(1-r\right)+\mathbf{F}_{0}r
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $F_{g}$
\end_inset

 is the applied prestrain gradient,
 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the 3x3 identity tensor,
 
\begin_inset Formula $\mathbf{F}_{0}$
\end_inset

 is the target prestrain gradient,
 defined by F0 parameter,
 and 
\emph on
r
\emph default
 is the ramp factor.
 
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout Standard
In this example,
 the prestrain gradient is ramped up to a desired gradient value via a load controller.
 
\end_layout

\begin_layout LyX-Code
<material id="1" type="prestrain elastic">
\end_layout

\begin_layout LyX-Code
  <elastic type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
    <E>1.0</E>
\end_layout

\begin_layout LyX-Code
    <v>0.3</v>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <prestrain type="prestrain gradient">
\end_layout

\begin_layout LyX-Code
    <ramp lc=
\begin_inset Quotes qrd
\end_inset

1
\begin_inset Quotes qrd
\end_inset

>1.0</ramp>
\end_layout

\begin_layout LyX-Code
    <F0>2,0,0,0,2,0,0,0,2</F0>
\end_layout

\begin_layout LyX-Code
  </prestrain>
\end_layout

\begin_layout LyX-Code
</material> 
\end_layout

\begin_layout Subsubsection
in-situ stretch
\end_layout

\begin_layout Standard
The 
\emph on
in-situ stretch
\emph default
 generator option calculates a prestrain gradient based on a fiber stretch and the fiber vector defined by the elastic material of the prestrain material.
 This implies that this elastic material must define a 
\emph on
fiber
\emph default
 property.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
initial values
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
initial fiber stretch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
isochoric
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
use the isochoric prestrain generator option
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
This option generates one of the following prestrain gradients,
 depending on the isochoric option.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{F}}_{p,iso}=\mathbf{Q}\left[\begin{array}{ccc}
\lambda\\
 & \lambda^{-1/2}\\
 &  & \lambda^{-1/2}
\end{array}\right]\mathbf{Q^{\mathrm{\mathit{T}}}},\qquad\hat{\mathbf{F}}_{p,uni}=\mathbf{Q}\left[\begin{array}{ccc}
\lambda\\
 & 1\\
 &  & 1
\end{array}\right]\mathbf{Q^{\mathit{T}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If the 
\emph on
isochoric
\emph default
 option is set to 1,
 then 
\begin_inset Formula $\hat{\mathbf{F}}_{p,iso}$
\end_inset

is used.
 Otherwise,
 
\begin_inset Formula $\hat{\mathbf{F}}_{p,uni}$
\end_inset

is used.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The rotation tensor is defined implicitly via the fiber vector 
\begin_inset Formula $\boldsymbol{a}$
\end_inset

 and the prestrain gradient tensor is effectively determined via,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{\mathbf{F}}_{p,iso}=\lambda\mathbf{A}+\mu\left(\boldsymbol{1-}\mathbf{A}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\mathbf{A}=\boldsymbol{a}\otimes\boldsymbol{a},$
\end_inset


\begin_inset Formula $\lambda$
\end_inset

 the prescribed fiber stretch,
 and 
\begin_inset Formula $\mu=\lambda^{-1/2}$
\end_inset

 or 
\begin_inset Formula $\mu=1$
\end_inset

 depending on the 
\emph on
isochoric 
\emph default
option.
\end_layout

\begin_layout Standard

\emph on
Example:
\end_layout

\begin_layout LyX-Code
<material id="1" type="prestrain elastic">
\end_layout

\begin_layout LyX-Code
   <elastic type="coupled trans-iso Mooney-Rivlin">
\end_layout

\begin_layout LyX-Code
        <k>0.1</k>
\end_layout

\begin_layout LyX-Code
        <density>1e-09</density>
\end_layout

\begin_layout LyX-Code
        <c1>0.01</c1>
\end_layout

\begin_layout LyX-Code
        <c2>0</c2>
\end_layout

\begin_layout LyX-Code
        <c3>0.0139</c3>
\end_layout

\begin_layout LyX-Code
        <c4>116.22</c4>
\end_layout

\begin_layout LyX-Code
        <c5>535.09</c5>
\end_layout

\begin_layout LyX-Code
        <lam_max>1.046</lam_max>
\end_layout

\begin_layout LyX-Code
        <fiber type="vector">-0.0804,-0.508,-0.858</fiber>
\end_layout

\begin_layout LyX-Code
  </elastic>
\end_layout

\begin_layout LyX-Code
  <prestrain type="in-situ stretch">
\end_layout

\begin_layout LyX-Code
    <stretch lc="1">1.05</stretch>
\end_layout

\begin_layout LyX-Code
    <isochoric>1</isochoric>
\end_layout

\begin_layout LyX-Code
  </prestrain>
\end_layout

\begin_layout LyX-Code
</material> 
\end_layout

\begin_layout Section
Continuous-Discontinuous Damage
\begin_inset CommandInset label
LatexCommand label
name "sec:Continuous-Damage-1"

\end_inset


\end_layout

\begin_layout Standard
In this damage formulation,
 the damage variable D is embedded inside the strain-energy function.
 The implementation follows largely the formulation in Balzani [
\begin_inset CommandInset citation
LatexCommand citep
key "BALZANI2012139"
literal "false"

\end_inset

] and is further detailed in [
\begin_inset CommandInset citation
LatexCommand citep
key "ALLAN2022105342"
literal "false"

\end_inset

].
 
\end_layout

\begin_layout Standard
The scalar damage variable 
\begin_inset Formula $\mathit{D}$
\end_inset

 is embedded in the strain energy function of the fibers,
 its relationship is dependent on the Continuous Damage solid constituent chosen.
 The scalar damage variable 
\begin_inset Formula $\mathit{D}$
\end_inset

 has continuous and discontinuous damage components defined by damage internal damage variables 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

.
 
\end_layout

\begin_layout Standard
The following material damage parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<Dmax>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $D_{\infty}$
\end_inset

(
\begin_inset Formula $0\leqslant D_{\infty}\leqslant1)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<beta_s>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\beta_{s}$
\end_inset

 (
\begin_inset Formula $\beta_{s}>0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<gamma_max>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\gamma_{\infty}$
\end_inset

 (
\begin_inset Formula $\gamma_{\infty}>0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<t0>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $t_{0}$
\end_inset

 (
\begin_inset Formula $t_{0}\geq0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Note the parameter 
\begin_inset Formula $\mathit{t_{0}}$
\end_inset

 is the time in the current loading situation where the damage model is initiated.
\end_layout

\begin_layout Standard
The scalar damage variable 
\begin_inset Formula $\mathit{D}$
\end_inset

 is a function of 
\begin_inset Formula $\beta$
\end_inset

,
 the continuous damage variable,
 and is given by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\mathit{D(\beta)=D_{s}\left[1-\exp\left(\frac{\ln(1-r_{s})}{\beta_{s}}\beta\right)\right]},$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\beta$
\end_inset

 is defined by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\beta=\left\langle \tilde{\beta}-\tilde{\beta_{ini}}\right\rangle $
\end_inset

 with 
\begin_inset Formula $\tilde{\beta}=\intop_{0}^{t}\dot{\Psi^{0}}ds$
\end_inset

,
\end_layout

\begin_layout Standard
and 
\begin_inset Formula $\beta_{s}$
\end_inset

 is the value of the internal material variable 
\begin_inset Formula $\beta$
\end_inset

 that has reached a certain fraction 
\begin_inset Formula $\mathit{r_{s}}$
\end_inset

(
\begin_inset Formula $0\leqslant r_{s}\leqslant1$
\end_inset

) of the maximal damage value 
\begin_inset Formula $\mathit{D}_{s}$
\end_inset

 for a fixed maximum load level.
 At 
\begin_inset Formula $\beta=\beta_{s}$
\end_inset

,
 the overall damage 
\begin_inset Formula $D=r_{s}*D_{s}$
\end_inset

.
 For example,
 in Figure 1,
 
\begin_inset Formula $D_{s}=1,$
\end_inset


\begin_inset Formula $r_{s}=0.5,$
\end_inset

and 
\begin_inset Formula $\beta_{s}=1$
\end_inset

,
 meaning the overall damage in this cycle has reached 50% of the maximal damage value 
\begin_inset Formula $\mathit{D}_{s}$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename Figures/beta.png
	scale 80

\end_inset


\end_layout

\begin_layout Standard
\align center
Overall Damage variable 
\begin_inset Formula $\mathit{D}$
\end_inset

as a function of Continuous Damage variable 
\begin_inset Formula $\mathit{\beta}$
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
To make sure damage evolution begins to accumulate only when damage is accrued,
 
\begin_inset Formula $\tilde{\beta_{ini}}$
\end_inset

 is the internal variable 
\begin_inset Formula $\tilde{\beta}$
\end_inset

 at an initial damage state and 
\begin_inset Formula $\Psi^{0}$
\end_inset

 is the undamaged effective strain energy density of the fibrils.
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathit{D_{s}}$
\end_inset

 is a function increasing the maximally reachable damage value for increased maximum load levels.
 It is assumed that the maximum damage is itself a function of the internal variable 
\begin_inset Formula $\gamma$
\end_inset

,
 describing the discontinuous damage variable and is given by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\mathit{D_{s}(\gamma)=D_{\infty}\left[1-\exp\left(\frac{\ln(1-r_{\infty})}{\gamma_{\infty}}\gamma\right)\right],}$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\gamma$
\end_inset

 is defined by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\gamma=\underset{s\epsilon\left[0,t\right]}{max}\left\langle \varPsi^{0}-\varPsi_{ini}^{0}\right\rangle ,
\]

\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset Formula $\gamma_{\infty}$
\end_inset

 is the value of the internal material variable 
\begin_inset Formula $\gamma$
\end_inset

 that has reached a certain fraction 
\begin_inset Formula $\mathit{r_{\infty}}(0\leqslant r_{\infty}\leqslant1)$
\end_inset

 of the maximal damage value 
\begin_inset Formula $\mathit{D}_{\infty}$
\end_inset

 for a fixed maximum load level.
 At 
\begin_inset Formula $\gamma=\gamma_{\infty}$
\end_inset

,
 the overall damage 
\begin_inset Formula $D_{s}=r_{\infty}*D_{\infty}$
\end_inset

 (the same relationship can be adapted from Figure 1 with 
\begin_inset Formula $\gamma\sim\beta,r_{\infty}\sim r_{s},D_{\infty}\sim D_{s},D_{s}\sim D$
\end_inset

).
 
\begin_inset Formula $\Psi_{ini}^{0}$
\end_inset

 denotes the strain energy density at an initial damage state obtained at the limit of the physiological domain (e.g.
 in relation to arterial expansion).
 It is the initial damage strain energy threshold value for the fibers.
 The time associated with the loading history is denoted by 
\begin_inset Formula $\mathit{s\epsilon\mathbb{\mathbb{R}}}$
\end_inset

and the time associated with the current loading situation is represented by 
\begin_inset Formula $\mathit{t\epsilon\mathbb{R^{+}}}$
\end_inset

.
\end_layout

\begin_layout Standard
The strain energy is assumed to be of the following form,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\Psi(C,D)=m(P(C,D))$
\end_inset

,
\end_layout

\begin_layout Standard
where the modified internal energy function 
\begin_inset Formula $\mathit{P(C,D)}=(1-D)\bar{P}-c$
\end_inset

 with the scalar damage variable 
\begin_inset Formula $\mathit{D}$
\end_inset

 (defined above).
 
\begin_inset Formula $m(P(C,D))$
\end_inset

 is a convex and monotonically increasing function,
 whose first derivative is zero in the origin.
 Possible functions of 
\begin_inset Formula $\bar{P}$
\end_inset

 are given by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\bar{P}_{1}:=J_{4}^{(a)}$
\end_inset

,
\begin_inset Formula $\bar{P}_{3}:=K_{1}^{(a)}$
\end_inset

,
\begin_inset Formula $\bar{P}_{2}:=K_{2}^{(a)}$
\end_inset

,
\begin_inset Formula $\bar{P}_{4}:=K_{3}^{(a)}$
\end_inset

,
\end_layout

\begin_layout Standard
\align center
(
\begin_inset Formula $\bar{P}_{5}:=I_{1},\bar{P}_{6}:=I_{2},\bar{P}_{7}:=I_{3}$
\end_inset

),
\end_layout

\begin_layout Standard
where 
\begin_inset Formula $a$
\end_inset

 denotes the direction of the fibers.
 In this formulation we take 
\begin_inset Formula $\bar{P}=\varPsi^{0}$
\end_inset

.
 Note The fifth invariant is not polyconvex,
 therefore alternative polyconvex invariant functions are defined as
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $K_{1}^{(a)}=tr\left[\mathrm{Cof}CM_{(a)}\right]=J_{5}^{(a)}-I_{1}J_{4}^{(a)}+I_{2}$
\end_inset

,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $K_{2}^{(a)}=tr\left[C(I-M_{(a)})\right]=I_{1}-J_{4}^{(a)}$
\end_inset

,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $K_{3}^{(a)}=tr\left[\mathrm{Cof}C(I-M_{(a)})\right]=I_{1}J_{4}^{(a)}+J_{5}^{(a)}$
\end_inset

.
\end_layout

\begin_layout Standard
The subtraction of 
\begin_inset Formula $c$
\end_inset

 ensures the stress-free reference configuration for the undamaged case is satisfied,
 
\begin_inset Formula $c$
\end_inset

 is the value of the function 
\begin_inset Formula $\bar{P}$
\end_inset

 in the natural state and is given by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $c$
\end_inset

=
\begin_inset Formula $\bar{P_{i}}(C=I)$
\end_inset

 for 
\begin_inset Formula $i=1,...,7).$
\end_inset

 
\end_layout

\begin_layout Subsection
Damage Fiber Power
\begin_inset CommandInset label
LatexCommand label
name "subsec:Damage-Fiber-Power"

\end_inset


\end_layout

\begin_layout Standard
The material type for Damage Fiber Power is 
\begin_inset Quotes eld
\end_inset


\shape italic
damage fiber power
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<a1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha_{1}$
\end_inset

 (
\begin_inset Formula $\alpha_{1}>0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<a2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\alpha_{2}$
\end_inset

 (
\begin_inset Formula $\alpha_{2}>1)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\kappa$
\end_inset

 (
\begin_inset Formula $0\leqslant\kappa\leqslant2/3)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
By setting,
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\Psi^{0}=\kappa\mathit{I_{1}+\left(1-\frac{3}{2}\kappa\right)\mathit{K_{3}}}$
\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset Formula $\mathit{m(P)=\alpha_{1}(P)^{\alpha_{2}},}$
\end_inset

the strain-energy form above can be made suitable for modeling damage,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\varPsi(C,D)=\alpha_{1}\left(\left(1-D\right)\left[\kappa I_{1}+\left(1-\frac{3}{2}\kappa\right)K_{3}\right]-c\right)^{\alpha_{2}}$
\end_inset

.
\end_layout

\begin_layout Standard
The Cauchy stress takes on the following form,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\sigma=\frac{2}{J}(1-D)\frac{dm}{dP}\left[\kappa b+\left(1-\frac{3}{2}\kappa\right)\left[bI_{4}+I_{1}I_{4}m-I_{4}a\bigodot ba\right]\right]$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<solid type="damage fiber power"> 				
\end_layout

\begin_layout LyX-Code
  <a1>1400</a1> 				
\end_layout

\begin_layout LyX-Code
  <a2>2.2</a2> 				
\end_layout

\begin_layout LyX-Code
  <kappa>1e-08</kappa> 				
\end_layout

\begin_layout LyX-Code
  <t0>0.98</t0> 				
\end_layout

\begin_layout LyX-Code
  <Dmax>0.96</Dmax> 				
\end_layout

\begin_layout LyX-Code
  <beta_s>0.06</beta_s> 				
\end_layout

\begin_layout LyX-Code
  <gamma_max>17.98</gamma_max> 				
\end_layout

\begin_layout LyX-Code
  <fiber type="angles"> 					
\end_layout

\begin_layout LyX-Code
    <theta>-39.87</theta> 					
\end_layout

\begin_layout LyX-Code
    <phi>90</phi> 				
\end_layout

\begin_layout LyX-Code
  </fiber> 			
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Subsection
Damage Fiber Exponential
\begin_inset CommandInset label
LatexCommand label
name "subsec:Damage-Fiber-Exponential"

\end_inset


\end_layout

\begin_layout Standard
The material type for Damage Fiber Exponential is 
\begin_inset Quotes eld
\end_inset


\shape italic
damage fiber exponential
\begin_inset Quotes erd
\end_inset


\shape default
.
 The following material parameters must be defined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k1>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\kappa_{1}$
\end_inset

 (
\begin_inset Formula $\kappa_{1}>0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<k2>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\kappa_{2}$
\end_inset

 (
\begin_inset Formula $\kappa_{2}>0)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<kappa>
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter 
\begin_inset Formula $\kappa$
\end_inset

 (
\begin_inset Formula $0\leqslant\kappa\leqslant1/3)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The effective strain-energy function is given by,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\Psi^{0}=\kappa I_{1}+(1-3\kappa)I_{4}$
\end_inset


\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\mathit{m(P)=\frac{k_{1}}{2k_{2}}\left\{ \exp\left(k_{2}\left\langle P\right\rangle ^{2}\right)-1\right\} ,}$
\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $a$
\end_inset

 denotes the direction of the fibers.
\end_layout

\begin_layout Standard
So that,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\Psi=\frac{k_{1}}{2k_{2}}\left\{ \exp\left(k_{2}\left\langle \left(1-D_{a}\right)\left(\kappa I_{1}-\left(1-3\kappa\right)I_{4}\right)-1\right\rangle ^{2}\right)-1\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
The Cauchy stress then takes on the following form,
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula $\sigma=\frac{2}{J}(1-D)\frac{dm}{dP}\left[\kappa b+(1-3\kappa)I_{4}m\right]$
\end_inset

.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<solid type="damage fiber exponential"> 
\end_layout

\begin_layout LyX-Code
  <k1>1288.97</k1> 
\end_layout

\begin_layout LyX-Code
  <k2>400</k2> 
\end_layout

\begin_layout LyX-Code
  <kappa>0.2</kappa> 
\end_layout

\begin_layout LyX-Code
  <t0>0.9</t0> 
\end_layout

\begin_layout LyX-Code
  <Dmax>0.99</Dmax> 
\end_layout

\begin_layout LyX-Code
  <beta_s>0.001</beta_s> 
\end_layout

\begin_layout LyX-Code
  <gamma_max>6.67</gamma_max> 
\end_layout

\begin_layout LyX-Code
  <fiber type="angles"> 
\end_layout

\begin_layout LyX-Code
    <theta>-54.94</theta> 
\end_layout

\begin_layout LyX-Code
    <phi>90</phi> 
\end_layout

\begin_layout LyX-Code
  </fiber> 
\end_layout

\begin_layout LyX-Code
</solid>
\end_layout

\begin_layout Subsection
Damage Fiber exp-linear
\end_layout

\begin_layout Standard
This continuous damage formulation uses a slightly modified damage formulation.
 The total damage is here defined as,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D=D_{1}+D_{2}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $D_{1}$
\end_inset

defines the same damage term as defined above.
 The 
\begin_inset Formula $D_{2}$
\end_inset

is defined as follows,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D_{2}=D_{3}\left[a\left(\mathrm{exp}\left(b\beta\right)-1\right)+c\left(\mathrm{exp}\left(d\beta\right)-1\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
The material parameters 
\emph on
a
\emph default
 and 
\emph on
c
\emph default
 control the magnitude of the continuous damage of the two phenomena:
 1) slow,
 constant increased in damage,
 2) sharp jump in damage near failure.
 The other material parameters,
 
\emph on
b
\emph default
 and 
\emph on
d
\emph default
,
 control the rate of continuous damage accumulation for the two phenomena mentioned above,
 and is a function of the collagen discontinuous damage.
 Furthermore,
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D_{3}\left(\gamma\right)=\frac{D_{3\infty}}{1+exp\left(-\left(\gamma-\gamma_{0}\right)/r_{\gamma}\right)}
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\begin_inset Formula $D_{3\infty}$
\end_inset

 is the maximum achievable discontinuous damage possible for the model,
 
\begin_inset Formula $\gamma_{0}$
\end_inset

 determines the shape of the curve,
 and 
\begin_inset Formula $r_{\gamma}$
\end_inset

 controls the rate of discontinuous damage accumulation.
\end_layout

\begin_layout Standard
The additional damage parameters to define the 
\begin_inset Formula $D_{2}$
\end_inset

 term,
 are as follows.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D2_a
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $a$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D2_b
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $b$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D2_c
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $c$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D2_d
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $d$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D3_inf
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $D_{3\infty}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D3_g0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\gamma_{0}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D3_rg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $r_{\gamma}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The effective strain-energy function is given by,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Psi^{0}=\sqrt{I_{4}}
\]

\end_inset


\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
m\left(P\right)=\left\{ \begin{array}{cc}
c_{3}\left(\exp\left(-c_{4}\right)\left(Ei\left(c_{4}\left(P+1\right)\right)-Ei\left(c_{4}\right)\right)-\log\left(P+1\right)\right), & P\leqq\lambda^{*}+1\\
c_{5}P+c_{6}\log\left(P+1\right)+d & P>\lambda^{*}+1
\end{array}\right.
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 
\emph on
d
\emph default
 is determined by requiring continuity at 
\begin_inset Formula $\lambda^{*}$
\end_inset

.
\end_layout

\begin_layout Standard
The (elastic) material parameters for this material are as follows.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $c_{3}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $c_{4}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $c_{5}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
c6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $c_{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lambda
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter 
\begin_inset Formula $\lambda^{*},$
\end_inset

the transition between exponential and linear regions.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Section
First-Order Homogenization
\end_layout

\begin_layout Standard
This document describes how to use the first-order homogenization feature in FEBio.
 Homogenization refers to the process of evaluating the physical response of a macro model by explicitly solving a separate finite element model that represents the micro structure of the material.
 This micro-model is referred to as the Representative Volume Element (RVE).
 In the first-order approach it is assumed that the macro and micro scales are separated,
 which implies that the size of the RVE is negligible compared to the size of the macro model.
\end_layout

\begin_layout Subsection
Macro model definition
\end_layout

\begin_layout Standard
For the most part,
 the definition of the macro-model is a standard finite element model with properly chosen boundary conditions.
 The use of first-order homogenization is controlled entirely by the material definition.
 
\end_layout

\begin_layout Standard
To use the first-order homogenization formulation use the micro-material material.
 This material has the following parameters.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameters
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RVE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The file name of the RVE model (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/A
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rve_type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The type of RVE model (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bc_set
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The name of the nodeset (in the RVE) that defines the outside surface (3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(optional)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
probe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defines a point in the macro model where the RVE will be tracked.
 (4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Standard
1.
 The RVE parameter defines the file name of the RVE model.
 The RVE is a standard FE model,
 although somewhat slimmed down.
 See the rve_type parameter definition and the section RVE model definition below.
\end_layout

\begin_layout Standard
2.
 This parameter determines the type of RVE (and its assumed boundary conditions) that will be used and must be one of the following values.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
rve_type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prescribed displacement RVE:
 The position of all RVE boundary nodes is fully prescribed
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Periodic RVE:
 RVE with periodic boundary constraints.
 Constraints are enforced with linear constraints.
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
3.
 The bc_set defines the name of the nodeset (defined in the RVE model),
 that defines the outside surface.
 In general,
 this parameter does not need to be defined.
 It is only needed for problems using rve_type = 0,
 and for which the RVE geometry is not a closed cube.
 
\end_layout

\begin_layout Standard
4.
 By default,
 FEBio will only output the deformation of the macro model to the plot file.
 It will not output any results from the RVE models.
 (Given there could be thousands of RVE models,
 this would be too cumbersome to do.) However,
 users can request FEBio to output the deformation of the RVE model at specific points in the model using the probe option.
 The probe tag requires the following child tags.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
probe parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element_id
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the ID of the element to probe
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gausspt
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the index of the integration point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
output file name for RVE model
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
RVE model definition
\end_layout

\begin_layout Standard
The RVE model is a standard FE model,
 with a few caveats.
\end_layout

\begin_layout Itemize
The time stepping parameters will be ignored,
 since the macro model controls the time stepping of the RVE to make sure that both models advance in sync.
 
\end_layout

\begin_layout Itemize
The boundary conditions of the RVE depend on the rve_type parameter:
 
\end_layout

\begin_deeper
\begin_layout Itemize
rve_type = 0:
 The RVE model should not have any boundary conditions applied.
 The RVE may define a nodeset that defines the outside surface of the RVE.
 This is generally not needed,
 but must be defined when the RVE geometry is not a closed cube.
 
\end_layout

\begin_layout Itemize
rve_type = 1:
 The RVE should have periodic constraints applied for all opposing surfaces.
 
\end_layout

\end_deeper
\begin_layout Itemize
The RVE model does not need an Output section,
 but may define the plotfile section.
 This will be used to define the conents of the probe's plotfiles.
 
\end_layout

\begin_layout Itemize
The size of the RVE is assumed to be much smaller than the macro model.
 It is allowed to use a different length unit for the coordinates of the RVE nodes.
 However,
 the unit of stress must be the same for both the macro model and the RVE model.
 
\end_layout

\begin_layout Chapter
Restart Input file
\begin_inset CommandInset label
LatexCommand label
name "chap:Restart-Input-file"

\end_inset


\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Restart-Introduction"

\end_inset


\end_layout

\begin_layout Standard
Users can request FEBio to output a binary dump file.
 This dump file can be used to restart the analysis from the time point saved in the dump file.
 The user can restart the analysis either directly from this binary dump file or via a restart input file,
 which is described in this chapter.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Restarting-a-Run"
nolink "false"

\end_inset

 for more information on how to use the restart feature.
 
\end_layout

\begin_layout Standard
This chapter describes the format of the restart input file.
 This file is used to redefine some parameters when restarting a previously terminated run and can also be used to extend the analysis.
 The structure is very similar to the FEBio input file and also uses XML formatting.
 Since the file uses XML,
 the first line must be the XML header:
\end_layout

\begin_layout LyX-Code
<?xml version="1.0" encoding="ISO-8859-1"?>
\end_layout

\begin_layout Standard
The next line contains the root element of the restart file,
 and has to be:
\end_layout

\begin_layout LyX-Code
<febio_restart version="2.0">
\end_layout

\begin_layout Standard
The restart file is composed of the following sections.
 These sections are sub-elements of the 
\shape italic
febio_restart 
\shape default
root element.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\series bold
\shape italic
\emph on
Archive
\series default
\shape default
\emph default
 define the binary dump file used for restarting.
 
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\series bold
\shape italic
\emph on
Control
\series default
\shape default
\emph default
 redefine some control parameters.
 
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\series bold
\shape italic
\emph on
LoadData
\series default
\shape default
\emph default
 redefine or add some loadcurves.
 
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\series bold
Step
\series default
 add an analysis step.
\end_layout

\begin_layout Standard
All sections are optional except for the Archive section.
 In the following paragraphs we describe the different sections in more detail.
\end_layout

\begin_layout Section
The Archive Section
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Archive-Section"

\end_inset


\end_layout

\begin_layout Standard
The Archive section must be the first sub-element of the 
\shape italic
febio_restart 
\shape default
root element.
 This section defines the name of the binary dump file:
\end_layout

\begin_layout LyX-Code
<Archive>archive.dmp</Archive>
\end_layout

\begin_layout Standard
This file will be created by FEBio when requested by the user and contains the solution of the analysis up to the last converged time step.
 
\end_layout

\begin_layout Section
The Control Section
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Control-Section"

\end_inset


\end_layout

\begin_layout Standard
The following control parameters can be redefined:
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dtol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance for displacements 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
etol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance for energy 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rtol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
convergence tolerance for residual 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lstol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
line search tolerance 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_refs
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of stiffness reformations 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_ups
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maximum number of BFGS updates 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
restart
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
restart file generation flag 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
plot_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
defines the frequency of the plot file generation 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Section
The LoadData Section
\begin_inset CommandInset label
LatexCommand label
name "sec:The-LoadData-Section"

\end_inset


\end_layout

\begin_layout Standard
In the LoadData section some or all of the load curves can be redefined,
 or new load curves can be added.
 The syntax is identical to the LoadData section of the FEBio input file:
\end_layout

\begin_layout LyX-Code
<LoadData>
\end_layout

\begin_layout LyX-Code
  <loadcurve id="1">
\end_layout

\begin_layout LyX-Code
    <loadpoint>0,
 0</loadpoint>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
    <loadpoint>1,
 0.54</loadpoint>
\end_layout

\begin_layout LyX-Code
  </loadcurve>
\end_layout

\begin_layout LyX-Code
</LoadData>
\end_layout

\begin_layout Standard
In this case,
 the loadcurve 
\shape italic
id 
\shape default
is the loadcurve number of the loadcurve that the user wishes to redefine.
 
\end_layout

\begin_layout Standard
New loadcurves can be added as well.
 This is useful when in addition adding new Step sections,
 where new boundary conditions are defined.
 When adding new loadcurves,
 make sure to continue the numbering of the parent input file.
 That is,
 if the last loadcurve of the parent input file has and id of n,
 then the first new load curve defined here must have id of n+1.
\end_layout

\begin_layout Section
The Step Section 
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Step-Section-1"

\end_inset


\end_layout

\begin_layout Standard
The Step section can be used to add additional analysis steps to the model.
 These steps are executed after the initial model has completed.
 This section cannot be used to modify the steps defined in the parent file.
 See chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Multi-step-Analysis"
nolink "false"

\end_inset

 for more information on the Step section or multi-step analyses in general.
 
\end_layout

\begin_layout Standard
Using the Step section,
 additional boundary conditions,
 loads,
 contact definitions,
 etc.
 can be added,
 just like in a regular model input file.
 The syntax is the same as the Step section in the regular model input file.
 The only difference is that the type attribute is required to define the type of analysis.
 The type has the same role as the Module section in the regular FEBio input file.
\end_layout

\begin_layout Section
Example
\begin_inset CommandInset label
LatexCommand label
name "sec:Example"

\end_inset


\end_layout

\begin_layout Subsection
Example 1
\end_layout

\begin_layout Standard
The following example defines a restart input file.
 No parameters are redefined.
 Only the mandatory 
\shape italic
Archive 
\shape default
element is defined.
 In this case the analysis will simply continue where it left off:
\end_layout

\begin_layout LyX-Code
<?xml version="1.0" encoding="ISO-8859-1"?>
\end_layout

\begin_layout LyX-Code
<febio_restart version="1.0">
\end_layout

\begin_layout LyX-Code
  <Archive>out.dmp</Archive>
\end_layout

\begin_layout LyX-Code
</febio_restart>
\end_layout

\begin_layout Subsection
Example 2
\end_layout

\begin_layout Standard
In the following example an additional step is defined,
 which defines a new boundary condition and a new loadcurve.
 
\end_layout

\begin_layout LyX-Code
<?xml version="1.0" encoding="utf-8"?>
\end_layout

\begin_layout LyX-Code
<febio_restart version="2.0">
\end_layout

\begin_layout LyX-Code
  <Archive>out.dmp</Archive>
\end_layout

\begin_layout LyX-Code
  <Step type="solid">
\end_layout

\begin_layout LyX-Code
    <Control>
\end_layout

\begin_layout LyX-Code
      <time_steps>10</time_steps>
\end_layout

\begin_layout LyX-Code
      <step_size>0.1</step_size>
\end_layout

\begin_layout LyX-Code
    </Control>
\end_layout

\begin_layout LyX-Code
    <Boundary>
\end_layout

\begin_layout LyX-Code
      <prescribe bc="x" node_set="set1">
\end_layout

\begin_layout LyX-Code
         <scale lc="2">1.0</scale>
\end_layout

\begin_layout LyX-Code
      </prescribe>
\end_layout

\begin_layout LyX-Code
    </Boundary>
\end_layout

\begin_layout LyX-Code
  </Step>
\end_layout

\begin_layout LyX-Code
  <LoadData>
\end_layout

\begin_layout LyX-Code
    <loadcurve id="2" type="linear">
\end_layout

\begin_layout LyX-Code
      <point>1,
 0</point>
\end_layout

\begin_layout LyX-Code
      <point>2,
 1</point>
\end_layout

\begin_layout LyX-Code
    </loadcuve>
\end_layout

\begin_layout LyX-Code
  </LoadData>
\end_layout

\begin_layout LyX-Code
</febio_restart>
\end_layout

\begin_layout Standard
Notice the 
\begin_inset Quotes eld
\end_inset

type
\begin_inset Quotes erd
\end_inset

 attribute in the Step section.
 This serves a similar purpose as the Module section in the FEBio input file and defines the solver that FEBio will use to solve this step.
 This attribute is required when defining steps in the restart file.
 (The Module section is not supported in the restart input file.)
\end_layout

\begin_layout Standard
The prescribed boundary condition references a node set named 
\begin_inset Quotes eld
\end_inset

set1
\begin_inset Quotes erd
\end_inset

.
 This node set must be defined in the parent input file.
 No new node sets (or surfaces,
 etc.) can be defined in the restart input file.
 
\end_layout

\begin_layout Chapter
Multi-Step Analysis
\begin_inset CommandInset label
LatexCommand label
name "chap:Multi-step-Analysis"

\end_inset


\end_layout

\begin_layout Standard
A multi-step analysis is defined using multiple steps,
 where in each step the user can redefine control parameters,
 boundary conditions,
 loads,
 contact interfaces,
 and other model components.
 This is useful,
 for instance,
 for defining time-dependent boundary conditions or for switching between different analysis types during the simulation.
\end_layout

\begin_layout Standard
Multi-step models require a slightly different file organization compared to single-step models.
 More specifically,
 the Control section is not specified at the top of the input file.
 Instead,
 a 
\series bold
\shape italic
Steps
\series default
 
\shape default
section is added at the bottom of the file,
 which contains a list of 
\series bold
step 
\series default
sub-sections for each step.
 Each step then defines its own 
\emph on
Control 
\emph default
section,
 boundary conditions,
 loads,
 etc.
 
\end_layout

\begin_layout Section
The Step Section
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Step-Section"

\end_inset


\end_layout

\begin_layout Standard
The multi-step analysis feature organizes the input file in a slightly different way:
 the 
\series bold
\emph on
Control
\series default
 
\emph default
section is no longer defined at the top of the file,
 and instead,
 a new 
\series bold
\emph on
Steps
\series default
\emph default
 section is added to the bottom of the file,
 which will contain a list of analysis steps.
 Each analysis step requires its own 
\series bold
\shape italic
step
\series default
 
\shape default
sub-section.
 In this step section,
 the user can redefine the control section,
 boundary section,
 loads,
 contact,
 and other model components.
 The following format is suggested when defining a multi-step analysis:
\end_layout

\begin_layout LyX-Code
<febio_spec version="4.0">
\end_layout

\begin_layout LyX-Code
  <Module type="solid"/>
\end_layout

\begin_layout LyX-Code
  <Material>
\end_layout

\begin_layout LyX-Code
    <!-- materials go here -->
\end_layout

\begin_layout LyX-Code
  </Material>
\end_layout

\begin_layout LyX-Code
  <Mesh>
\end_layout

\begin_layout LyX-Code
    <!-- mesh definition goes here -->
\end_layout

\begin_layout LyX-Code
  </Mesh>
\end_layout

\begin_layout LyX-Code
  <MeshDomains>
\end_layout

\begin_layout LyX-Code
    <!-- mesh domains goes here -->
\end_layout

\begin_layout LyX-Code
  </MeshDomains>
\end_layout

\begin_layout LyX-Code
  <Boundary>
\end_layout

\begin_layout LyX-Code
    <!-- global boundary conditions -->
\end_layout

\begin_layout LyX-Code
  </Boundary>
\end_layout

\begin_layout LyX-Code
  <LoadData>
\end_layout

\begin_layout LyX-Code
    <!-- load curve data goes here -->
\end_layout

\begin_layout LyX-Code
  </LoadData>
\end_layout

\begin_layout LyX-Code
  
\series bold
<Steps>
\end_layout

\begin_layout LyX-Code

\series bold
    <step>
\end_layout

\begin_layout LyX-Code

\series bold
      <Control>
\end_layout

\begin_layout LyX-Code

\series bold
        <!-- local control settings -->
\end_layout

\begin_layout LyX-Code

\series bold
      </Control>
\end_layout

\begin_layout LyX-Code

\series bold
      <Boundary>
\end_layout

\begin_layout LyX-Code

\series bold
        <!-- local boundary conditions -->
\end_layout

\begin_layout LyX-Code

\series bold
      </Boundary>
\end_layout

\begin_layout LyX-Code

\series bold
    </step>
\end_layout

\begin_layout LyX-Code

\series bold
  </Steps>
\end_layout

\begin_layout LyX-Code
</febio_spec>
\end_layout

\begin_layout Standard
The first part of the file looks similar to a normal input file,
 except that the control section is not specified.
 Also,
 the Boundary,
 Loads,
 Constraints,
 Contact,
 sections should only contain global boundary conditions,
 i.e.
 boundary conditions that will remain active in all analysis steps.
\end_layout

\begin_layout Standard
At the end of the file the user defines as many 
\series bold
step
\series default
 sections as needed.
 In each 
\series bold
step
\series default
 section,
 the user can now define the control parameters and model components.
\end_layout

\begin_layout Standard
The sub-sections that can be defined in a step are:
 
\end_layout

\begin_layout Description
Control Defines the steps control parameter,
 such time stepping,
 solver settings,
 etc.
\end_layout

\begin_layout Description
Initial Applies initial conditions that take effect at the start of the step.
 
\end_layout

\begin_layout Description
Boundary Defines boundary conditions that are only applied in this step.
 
\end_layout

\begin_layout Description
Loads Defines loads that are only applied in this step.
 
\end_layout

\begin_layout Description
Constraints Defines constraints that are only applied in this step.
 
\end_layout

\begin_layout Description
Rigid Defines rigid constraints,
 loads,
 and connectors in this step.
\end_layout

\begin_layout Description
MeshAdaptor Defines mesh adaptors that will be applied in this step.
 
\end_layout

\begin_layout Subsection
Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Standard
In a multi-step analysis boundary conditions can be applied that are only active during the step.
 This applies to the 
\shape italic
Boundary
\shape default
,
 
\shape italic
Loads
\shape default
,
 
\shape italic
Contact 
\shape default
and 
\shape italic
Constraints 
\shape default
section of the FEBio input file.
 These sections can thus be placed inside the 
\shape italic
Step 
\shape default
section to define a boundary condition that is only active during the step.
 If one of these sections is defined before the first 
\shape italic
Step
\shape default
 section,
 the corresponding boundary conditions remain enforced during all the steps.
\end_layout

\begin_layout Subsection
Relative Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Relative-Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Standard
Some boundary conditions can be defined as relative boundary conditions.
 This means that the corresponding conditions will be applied to the final configuration of the previous step and not to the original reference configuration.
 For example,
 if a prescribed displacement is defined as relative the displacement will be taken with respect to the positions of the final configuration of the previous step.
 This makes it possible,
 for example,
 to switch between load and displacement controlled boundary conditions in multi-step analyses.
\end_layout

\begin_layout Section
An Example
\begin_inset CommandInset label
LatexCommand label
name "sec:An-Example"

\end_inset


\end_layout

\begin_layout Standard
The following example illustrates the use of the multi-step feature of FEBio.
 This problem defines two steps.
 In the first step,
 a single element is stretched using a prescribed displacement boundary condition.
 In the second step,
 the boundary condition is removed and the analysis type is switched from quasi-static to a dynamic analysis.
 Note the presence of the global fixed boundary constraints,
 which will remain enforced during both steps:
\end_layout

\begin_layout Verbatim

<?xml version="1.0" encoding="ISO-8859-1"?>
\end_layout

\begin_layout Verbatim

<febio_spec version="4.0">
\end_layout

\begin_layout Verbatim

	<Module type="solid"/>
\end_layout

\begin_layout Verbatim

	<Material>
\end_layout

\begin_layout Verbatim

		<material id="1" name="Material 1" type="neo-Hookean">
\end_layout

\begin_layout Verbatim

			<density>1.0</density>
\end_layout

\begin_layout Verbatim

			<E>1</E>
\end_layout

\begin_layout Verbatim

			<v>0.45</v>
\end_layout

\begin_layout Verbatim

		</material>
\end_layout

\begin_layout Verbatim

	</Material>
\end_layout

\begin_layout Verbatim

	<Mesh>
\end_layout

\begin_layout Verbatim

		<Nodes>
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="1">-2.0,-0.5,
 0.0</node>
=======
			<node id="1">-2.0,-0.5, 0.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="2">-2.0,-0.5,
 1.0</node>
=======
			<node id="2">-2.0,-0.5, 1.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="3">-2.0,
 0.5,
 0.0</node>
=======
			<node id="3">-2.0, 0.5, 0.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="4">-2.0,
 0.5,
 1.0</node>
=======
			<node id="4">-2.0, 0.5, 1.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="5"> 2.0,-0.5,
 0.0</node>
=======
			<node id="5"> 2.0,-0.5, 0.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="6"> 2.0,-0.5,
 1.0</node>
=======
			<node id="6"> 2.0,-0.5, 1.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="7"> 2.0,
 0.5,
 0.0</node>
=======
			<node id="7"> 2.0, 0.5, 0.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

<<<<<<< HEAD
			<node id="8"> 2.0,
 0.5,
 1.0</node>
=======
			<node id="8"> 2.0, 0.5, 1.0</node>
>>>>>>> 1d8f8d60bc9d7683e8561212780f1d9b83622536
\end_layout

\begin_layout Verbatim

		</Nodes>
\end_layout

\begin_layout Verbatim

		<Elements type="hex8" name="Part1">
\end_layout

\begin_layout Verbatim

			<elem id="1">1,5,7,3,2,6,8,4</elem>
\end_layout

\begin_layout Verbatim

		</Elements>
\end_layout

\begin_layout Verbatim

		<NodeSet name="set1">
\end_layout

\begin_layout Verbatim

			<node id="1"/>
\end_layout

\begin_layout Verbatim

			<node id="2"/>
\end_layout

\begin_layout Verbatim

			<node id="3"/>
\end_layout

\begin_layout Verbatim

			<node id="4"/>
\end_layout

\begin_layout Verbatim

		</NodeSet>
\end_layout

\begin_layout Verbatim

		<NodeSet name="set2">
\end_layout

\begin_layout Verbatim

			<node id="1"/>
\end_layout

\begin_layout Verbatim

			<node id="2"/>
\end_layout

\begin_layout Verbatim

			<node id="5"/>
\end_layout

\begin_layout Verbatim

			<node id="6"/>
\end_layout

\begin_layout Verbatim

		</NodeSet>
\end_layout

\begin_layout Verbatim

		<NodeSet name="set3">
\end_layout

\begin_layout Verbatim

			<node id="1"/>
\end_layout

\begin_layout Verbatim

			<node id="3"/>
\end_layout

\begin_layout Verbatim

			<node id="5"/>
\end_layout

\begin_layout Verbatim

			<node id="7"/>
\end_layout

\begin_layout Verbatim

		</NodeSet>
\end_layout

\begin_layout Verbatim

		<NodeSet name="set4">
\end_layout

\begin_layout Verbatim

			<node id="5"/>
\end_layout

\begin_layout Verbatim

			<node id="6"/>
\end_layout

\begin_layout Verbatim

			<node id="7"/>
\end_layout

\begin_layout Verbatim

			<node id="8"/>
\end_layout

\begin_layout Verbatim

		</NodeSet>
\end_layout

\begin_layout Verbatim

	</Mesh>
\end_layout

\begin_layout Verbatim

	<MeshDomains>
\end_layout

\begin_layout Verbatim

		<SolidDomain name="Part1" mat="Material 1"/>
\end_layout

\begin_layout Verbatim

	</MeshDomains>
\end_layout

\begin_layout Verbatim

	<Boundary>
\end_layout

\begin_layout Verbatim

		<bc type="zero displacement" node_set="set1">
\end_layout

\begin_layout Verbatim

			<dofs>x,y,z</dofs>
\end_layout

\begin_layout Verbatim

		</bc>
\end_layout

\begin_layout Verbatim

	</Boundary>
\end_layout

\begin_layout Verbatim

	<LoadData>
\end_layout

\begin_layout Verbatim

		<load_controller id="1" type="loadcurve">
\end_layout

\begin_layout Verbatim

			<points>
\end_layout

\begin_layout Verbatim

				<point>0,0</point>
\end_layout

\begin_layout Verbatim

				<point>1,0.1</point>
\end_layout

\begin_layout Verbatim

			</points>
\end_layout

\begin_layout Verbatim

		</load_controller>
\end_layout

\begin_layout Verbatim

	</LoadData>
\end_layout

\begin_layout Verbatim

	<Step>
\end_layout

\begin_layout Verbatim

		<step id="1">
\end_layout

\begin_layout Verbatim

			<Control>
\end_layout

\begin_layout Verbatim

				<time_steps>10</time_steps>
\end_layout

\begin_layout Verbatim

				<step_size>0.1</step_size>
\end_layout

\begin_layout Verbatim

			</Control>
\end_layout

\begin_layout Verbatim

			<Boundary>
\end_layout

\begin_layout Verbatim

				<bc type="prescribed displacement" node_set="set4">
\end_layout

\begin_layout Verbatim

					<dof>x</dof>
\end_layout

\begin_layout Verbatim

					<scale lc="1">1.0</scale>
\end_layout

\begin_layout Verbatim

				</bc>
\end_layout

\begin_layout Verbatim

			</Boundary>
\end_layout

\begin_layout Verbatim

		</step>
\end_layout

\begin_layout Verbatim

		<step id="2">
\end_layout

\begin_layout Verbatim

			<Control>
\end_layout

\begin_layout Verbatim

				<time_steps>50</time_steps>
\end_layout

\begin_layout Verbatim

				<step_size>0.5</step_size>
\end_layout

\begin_layout Verbatim

				<analysis>DYNAMIC</analysis>
\end_layout

\begin_layout Verbatim

			</Control>
\end_layout

\begin_layout Verbatim

		</step>
\end_layout

\begin_layout Verbatim

	</Step>
\end_layout

\begin_layout Verbatim

</febio_spec>
\end_layout

\begin_layout Verbatim

\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Parameter Optimization
\begin_inset CommandInset label
LatexCommand label
name "chap:Parameter-Optimization"

\end_inset


\end_layout

\begin_layout Standard
This chapter describes FEBio's parameter optimization module.
 This module tries to estimate model parameters by solving an inverse finite element problem,
 where the 
\begin_inset Quotes eld
\end_inset

solution
\begin_inset Quotes erd
\end_inset

 of the problem is known,
 and the problem's model parameters are sought.
 For instance,
 the solution can be an experimentally determined reaction force curve,
 and the unknown parameters are the material parameters that will recreate the reaction force curve by solving a forward FE problem.
 Another common application is determining the model parameters that achieve a desired load,
 displacement,
 or other goal.
 
\end_layout

\begin_layout Standard
In any case,
 the opimization module tries to minimize an objective function of the form,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\varphi\left(\mathbf{a}\right)=\sum\limits_{i=1}^{n}\left[y_{i}-f\left(x_{i};\mathbf{a}\right)\right]^{2}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here,
 the 
\begin_inset Formula $\left(x_{i},y_{i}\right)$
\end_inset

 are user-defined data pairs and 
\begin_inset Formula $f\left(x;\mathbf{a}\right)$
\end_inset

is the function that extracts the corresponding data from the model.
 The optimization module tries to find the model parameters 
\series bold
a
\series default
 that minimize the function 
\begin_inset Formula $\varphi$
\end_inset

.
 It does this by repeatedly evaluating the function 
\begin_inset Formula $f$
\end_inset

,
 which will usually call FEBio to solve a forward FE problem.
 
\end_layout

\begin_layout Standard
The optimization module requires a separate input file that describes all the information needed for solving an optimization problem.
 This input file is described next.
\end_layout

\begin_layout Section
Optimization Input File
\begin_inset CommandInset label
LatexCommand label
name "sec:Optimization-Input-File"

\end_inset


\end_layout

\begin_layout Standard
Like all FEBio input files,
 the parameter optimization input file is an xml-formatted text file.
 The following sections are defined:
\end_layout

\begin_layout Description

\shape italic
\emph on
Task
\shape default
\emph default
 optional section defining the task that is executed to solve the FE problem.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Options
\shape default
\emph default
 optional section defining the optimization control parameters.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Objective
\shape default
\emph default
 defines the objective function that will be minimized.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Parameters
\shape default
\emph default
 defines the model parameters that are to be determined.
 
\end_layout

\begin_layout Description

\shape italic
\emph on
Constraints
\shape default
\emph default
 defines linear constraints for the model parameters (requires a solution method that supports linear constraints,
 e.g.
 constrained levmar).
 
\end_layout

\begin_layout Standard
In the following paragraphs each section will be explained in detail.
\end_layout

\begin_layout Subsection
Task Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Model-Section"

\end_inset


\end_layout

\begin_layout Standard
The optional Task section can be used to define the task that is executed by FEBio when solving the FE model.
 By default,
 FEBio will solve the standard forward problem,
 but if needed,
 a custom task can be defined.
 
\end_layout

\begin_layout Subsection
Options Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Options-Section"

\end_inset


\end_layout

\begin_layout Standard
This section defines the control parameters for the optimization.
 The options that can be defined will depend on the chosen optimization method,
 which is set with an attribute of the Options section.
 The following table shows the currently supported optimization algorithms.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
levmar
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Levenberg-Marquardt 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
constrained levmar
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Levenberg-Marquardt with linear constraints (1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
powell
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Powell's method
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
scan
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter domain scanning (2)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments:
\end_layout

\begin_layout Enumerate
The 
\begin_inset Quotes eld
\end_inset

constrained levmar
\begin_inset Quotes erd
\end_inset

 uses the third-party levmar library
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{http://users.ics.forth.gr/~lourakis/levmar/}
\end_layout

\end_inset

.
 For additional information please see the library's home page.
 
\end_layout

\begin_layout Enumerate
The 
\begin_inset Quotes eld
\end_inset

scan
\begin_inset Quotes erd
\end_inset

 method will iterate over the parameter range in increments defined by the fourth parameter value defined in the Parameter section.
 It returns the parameters that resulted in the lowest objective value of visited points,
 but it may not be the actual minimum.
 
\end_layout

\begin_layout Standard
Note that the Options section is optional.
 When omitted,
 the levmar method is used with default values for the control parameters.
 
\end_layout

\begin_layout Standard
The following parameters can be defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="3in">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Default
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
obj_tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Convergence tolerance for objective function.
 (1)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
f_diff_scale
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Forward difference scale factor (2)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the amount of output that is generated on screen and in the logfile by the FEBio solver (3)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_NEVER 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tau
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Step size scale factor (4)
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0e-3 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the amount of output generated by the optimization module (5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_ITERATIONS
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
For example,
\end_layout

\begin_layout LyX-Code
<Options type="constrained levmar">
\end_layout

\begin_layout LyX-Code
  <obj_tol>0.001</obj_tol>
\end_layout

\begin_layout LyX-Code
  <f_diff_scale>0.001</f_diff_scale>
\end_layout

\begin_layout LyX-Code
  <print_level>PRINT_ITERATIONS</print_level>
\end_layout

\begin_layout LyX-Code
</Options>
\end_layout

\begin_layout Standard

\shape italic
Comments:
\end_layout

\begin_layout Enumerate
The objective function that is to be minimized is a function of the form:
 
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\varphi\left(\mathbf{a}\right)=\sum\limits_{i=1}^{n}\left[y_{i}-f\left(x_{i};\mathbf{a}\right)\right]^{2}.
\]

\end_inset

Here,
 
\begin_inset Formula $f\left(x;\mathbf{a}\right)$
\end_inset

 is the function that describes the model,
 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset

 
\series default
is a vector with the (unknown) model parameters and the 
\begin_inset Formula $\left(x_{i},y_{i}\right)$
\end_inset

 are the user-defined data that approximates the ideal model.
\end_layout

\end_deeper
\begin_layout Enumerate
The optimization method currently implemented requires the calculation of the gradient of the model function 
\begin_inset Formula $f$
\end_inset

 with respect to the model parameters 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
.
 Since this gradient is not known,
 it will be approximated using forward differences.
 For example,
 the 
\begin_inset Formula $k$
\end_inset

-th component of the gradient is approximated as follows.
 
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial f}{\partial a_{k}}\approx\frac{1}{\delta a_{k}}\left[f\left(a_{1},\cdots,a_{k}+\delta a_{k},\cdots,a_{m}\right)-f\left(a_{1},\cdots,a_{k},\cdots,a_{m}\right)\right]
\]

\end_inset

The value for 
\begin_inset Formula $\delta a_{k}$
\end_inset

is determined from the following formula.
 
\begin_inset Formula 
\[
\delta a_{k}=\varepsilon\left(1+a_{k}\right)
\]

\end_inset

where,
 
\begin_inset Formula $\varepsilon$
\end_inset

is the forward difference scale factor which can be set by the user with the 
\shape italic
fdiff_scale 
\shape default
option.
\end_layout

\end_deeper
\begin_layout Enumerate
The 
\shape italic
log_level 
\shape default
allows the user to control exactly how much output from the time iterations of each optimization iteration is written to the screen and logfile.
 The following values are allowed:
 
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_DEFAULT
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use default settings (may be omitted) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_NEVER
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Don't generate any output 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_FILE_ONLY
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Save to the logfile only 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_SCREEN_ONLY
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Only print to the screen 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LOG_FILE_AND_SCREEN
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Save to the logfile and print to the screen 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
The step size scale factor 
\shape italic
tau
\shape default
 can be set as an input only for the Constrained Levenberg-Marquardt method.
 It scales the initial guess for the damping parameter.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
print_level 
\emph default
sets how much output is generated during the optimizations.
 In particular,
 it controls if the objective function values are printed are not.
 The following values are allowed:
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_ITERATIONS
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print minimal iterations info
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PRINT_VERBOSE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print a lot of information,
 incl.
 objective function values
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\end_deeper
\begin_layout Subsection
Parameters Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Parameters-Section"

\end_inset


\end_layout

\begin_layout Standard
This section defines the material parameters that are to be determined.
 Each parameter is defined using the 
\shape italic
param 
\shape default
element:
\end_layout

\begin_layout LyX-Code
<Parameters>
\end_layout

\begin_layout LyX-Code
  <param name="[name]">[guess],
 [min],
 [max],
 [scale]</param>
\end_layout

\begin_layout LyX-Code
</Parameters>
\end_layout

\begin_layout Standard
The 
\shape italic
name 
\shape default
attribute gives the name of the parameter that is to be determined.
 The following section describes the format to reference a model parameter.
 Each parameter takes four values:
 [guess] is the initial guess for this parameter,
 [min] and [max] are the minimum and maximum values respectively for this parameter,
 and [scale] is a representative scale (magnitude) for this parameter (although the precise interpretation of this parameter depends on the particular solver).
 This value is used to normalize the optimization parameter and improve convergence.
 If not specified by the user,
 it defaults to the initial guess.
\end_layout

\begin_layout Standard
For example,
 to optimize the material parameters of a neo-Hookean solid,
 named 
\shape italic
mat1,
 
\emph on
use the following syntax.
\end_layout

\begin_layout LyX-Code
<Parameters>
\end_layout

\begin_layout LyX-Code
  <param name="fem.material('mat1').E">1.0,
 0.0,
 5.0,
 1.0</param>
\end_layout

\begin_layout LyX-Code
  <param name="fem.material('mat1').v">0.1,
 0.0,
 0.5,
 1.0</param>
\end_layout

\begin_layout LyX-Code
</Parameters>
\end_layout

\begin_layout Standard
This example defines two material parameters.
 The first component of the name (here 
\shape italic
mat1
\shape default
) is the name of the material as defined in the model input file.
 The second component (here 
\emph on
E
\emph default
 and 
\emph on
v
\emph default
) are the names of the material parameters.
 See Appendix B for more information on how to reference model parameters.
\end_layout

\begin_layout Subsection
Objective Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Function-Section"

\end_inset


\end_layout

\begin_layout Standard
This section defines the functional model that is used to evaluate the objective function (i.e.
 the function 
\begin_inset Formula $f$
\end_inset

 above).
 The particular functional model is defined via the 
\emph on
type
\emph default
 attribute,
 and the following table lists the available options.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
data-fit
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fits data,
 usually specified as a function of time,
 to a model output parameter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
target
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Optimizes until one or more output model parameters achieve a target value.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element-data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The target data is defined as a tabulated list of element values.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
node-data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The target data is defined as a tabulated list of nodal values.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
These options will be described separetely in the following sections.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
The data-fit model
\end_layout

\begin_layout Standard
The 
\emph on
data-fit
\emph default
 model tries to fit predicted FE data to a user-defined data curve.
 The data curve usually represents some experimentally obtained result,
 e.g.
 reaction force as a function of time.
 The data-fit model needs a data source,
 i.e.
 a function for extracting the model data,
 and the data curve.
 
\end_layout

\begin_layout LyX-Code
<Objective type="data-fit">
\end_layout

\begin_layout LyX-Code
  <fnc type="[enter type]">
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </fnc>
\end_layout

\begin_layout LyX-Code
  <data>
\end_layout

\begin_layout LyX-Code
    <pt>0,
 0</pt>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
    <pt>1,
 1</pt>
\end_layout

\begin_layout LyX-Code
  </data>
\end_layout

\begin_layout LyX-Code
</Objective>
\end_layout

\begin_layout Standard
The data source is defined by the type attribute of the fnc tag.
 The following table shows the supported values.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The function will track the evolution of a model parameter.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
filter_positive_only
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The function tracks the evoluation of a model parameter,
 but filters only the positive values.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
filter_sum
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The function is defined by summing nodal values.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\series bold
parameter
\end_layout

\begin_layout Standard
In the case of 
\emph on
parameter
\emph default
,
 a child element defines the parameter that will act as the data source for the objective function.
 (See Appendix B on more information on referencing model parameters.)
\end_layout

\begin_layout LyX-Code
<fnc type="parameter">
\end_layout

\begin_layout LyX-Code
  <param name="fem.rigidbody('rigid').Fz"/>
\end_layout

\begin_layout LyX-Code
</fnc>
\end_layout

\begin_layout Standard
This defines the data function as a function of time.
 You can also change the ordinate of the function to create other functional dependencies.
 For example,
 the following creates a load-displacement curve for a rigid body.
 
\end_layout

\begin_layout LyX-Code
<fnc type="parameter">
\end_layout

\begin_layout LyX-Code
  <ordinate name="fem.rigidbody('rigid').position.x"/>
\end_layout

\begin_layout LyX-Code
  <param name="fem.rigidbody('rigid').Fz"/>
\end_layout

\begin_layout LyX-Code
</fnc>
\end_layout

\begin_layout Standard
As another example,
 the following creates a stress-strain curve for a single solid element,
 using the left Hencky (logarithmic) strain component along the z-axis (denoted by 
\emph on
hz
\emph default
),
 and the Cauchy normal stress component along z-axis (denoted by 
\emph on
sz
\emph default
) in element number 1,
\end_layout

\begin_layout LyX-Code
<fnc type="parameter">
\end_layout

\begin_layout LyX-Code
  <ordinate name="fem.element_data('hz',1)"/>
\end_layout

\begin_layout LyX-Code
  <param name="fem.element_data('sz',1)"/>
\end_layout

\begin_layout LyX-Code
</fnc>
\end_layout

\begin_layout Standard

\series bold
filter_positive_only
\end_layout

\begin_layout Standard
This option requires another data source that is needed to extract model data (e.g.
 parameter),
 but only positive values are returned.
 If the model parameter's value is negative,
 zero will be returned by the function.
\end_layout

\begin_layout LyX-Code
<fnc type="filter_positive_only">
\end_layout

\begin_layout LyX-Code
  <source type="parameter">
\end_layout

\begin_layout LyX-Code
    <param name="fem.rigidbody('rigid').Fz"/>
\end_layout

\begin_layout LyX-Code
  </source>
\end_layout

\begin_layout LyX-Code
</fnc>
\end_layout

\begin_layout Standard

\series bold
filter_sum
\end_layout

\begin_layout Standard
This option will sum up nodal values and use that in the objective function.
 The summed value is always assumed to be a function of time.
 The following example illustrates how this option can be used to define an objective function from the sum of nodal reaction forces.
 
\end_layout

\begin_layout LyX-Code
<fnc type="filter_sum">
\end_layout

\begin_layout LyX-Code
  <node_data data="Rx" node_set="top surface"/>
\end_layout

\begin_layout LyX-Code
</fnc>
\end_layout

\begin_layout Subsubsection
The target model
\end_layout

\begin_layout Standard
The 
\emph on
target 
\emph default
model tries to optimize model parameters such that one or more output variables achieve a user-defined target value.
 This model requires a list of variables and target values for each variable.
 
\end_layout

\begin_layout LyX-Code
<Objective type="target">
\end_layout

\begin_layout LyX-Code
  <var name="[enter name]">[target value]</var>
\end_layout

\begin_layout LyX-Code
  ...
\end_layout

\begin_layout LyX-Code
</Objective>
\end_layout

\begin_layout Standard
The name refers to a model output parameter.
 The example below will optimize until the X-euler angle of the rigid body 'Material2' becomes 0.5.
 
\end_layout

\begin_layout LyX-Code
<Objective type="target">
\end_layout

\begin_layout LyX-Code
  <var name="fem.rigidbody('Material2').euler.y">0.5</var>
\end_layout

\begin_layout LyX-Code
</Objective>
\end_layout

\begin_layout Subsubsection
The element-data model
\end_layout

\begin_layout Standard
The 
\emph on
element-data 
\emph default
model uses a tabulated list of element values as the target for the optimization.
 In addition,
 it requires an output variable that will be matched against the element data.
 
\end_layout

\begin_layout LyX-Code
<Objective type="element-data">
\end_layout

\begin_layout LyX-Code
  <var type="[enter variable name]"/>
\end_layout

\begin_layout LyX-Code
  <data>
\end_layout

\begin_layout LyX-Code
    <elem id="1">0.123</elem>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </data>
\end_layout

\begin_layout LyX-Code
</Objective>
\end_layout

\begin_layout Standard
The variable can be any of the element output data listed in the logfile section (See 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:ElementSet-Section"
nolink "false"

\end_inset

).
 
\end_layout

\begin_layout Subsubsection
The node-data model
\end_layout

\begin_layout Standard
The 
\emph on
node-data 
\emph default
model uses a tabulated list of nodal values as the target for the optimization.
 In addition,
 it requires an output variable that will be matched against the nodal data.
 
\end_layout

\begin_layout LyX-Code
<Objective type="node-data">
\end_layout

\begin_layout LyX-Code
  <var type="[enter variable name]"/>
\end_layout

\begin_layout LyX-Code
  <data>
\end_layout

\begin_layout LyX-Code
    <node id="1">0.123</elem>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </data>
\end_layout

\begin_layout LyX-Code
</Objective>
\end_layout

\begin_layout Standard
The variable can be any of the node output data listed in the logfile section (See 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Node_Data-Class"
nolink "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Constraints Section
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constraints-Section"

\end_inset


\end_layout

\begin_layout Standard
The Constrained Levenberg-Marquardt method allows linear constraints on the material parameters.
 If 
\series bold

\begin_inset Formula $\mathbf{a}$
\end_inset


\series default
 is the material parameter vector,
 then the linear constraint is of the form:
 
\begin_inset Formula 
\[
c_{1}a_{1}+c_{2}a_{2}+...+c_{n}a_{n}+b=0\quad.
\]

\end_inset

The coefficients 
\begin_inset Formula $c_{1},c_{2},...,c_{n},b$
\end_inset

 are the inputs of the constraint tag.
 For example,
 if the linear constraint is 
\begin_inset Formula $2a_{1}-a_{2}+3=0$
\end_inset

 ,
 then the Constraints section would be:
\end_layout

\begin_layout LyX-Code
<Constraints>
\end_layout

\begin_layout LyX-Code
  <constraint>2,
 -1,
 3</constraint>
\end_layout

\begin_layout LyX-Code
</Constraints>
\end_layout

\begin_layout Section
Running a Parameter Optimization
\begin_inset CommandInset label
LatexCommand label
name "sec:Running-Parameter-Optimization"

\end_inset


\end_layout

\begin_layout Standard
As explained above,
 a parameter optimization problem is described using two input files.
 First,
 a standard FEBio input file that defines the mesh,
 materials,
 boundary conditions,
 etc.
 The second input file describes the parameter optimization problem,
 such as the objective and which model parameters are to be optimized.
 The format of the second file is described above.
 A parameter optimization can only be initiated from the command line.
 For example:
\end_layout

\begin_layout LyX-Code
>febio i model.feb s optim.feb
\end_layout

\begin_layout Standard
The output of a parameter optimization analysis is a log file that contains the screen output of the FEBio run as well as the optimized parameter values.
\end_layout

\begin_layout Section
An Example Input File
\begin_inset CommandInset label
LatexCommand label
name "sec:An-Example-Input"

\end_inset


\end_layout

\begin_layout Standard
Below follows a complete example of an optimization input file.
\end_layout

\begin_layout LyX-Code
<?xml version="1.0"?>
\end_layout

\begin_layout LyX-Code
<febio_optimize version="2.0">
\end_layout

\begin_layout LyX-Code
  <Options>
\end_layout

\begin_layout LyX-Code
    <obj_tol>0.001</obj_tol>
\end_layout

\begin_layout LyX-Code
    <f_diff_scale>0.001</f_diff_scale>
\end_layout

\begin_layout LyX-Code
  </Options>
\end_layout

\begin_layout LyX-Code
  <Parameters>
\end_layout

\begin_layout LyX-Code
    <param name="fem.material[0].E">1,
 0,
 5</param>
\end_layout

\begin_layout LyX-Code
    <param name="fem.material[0].v">-0.5,
 0,
 0.5</param>
\end_layout

\begin_layout LyX-Code
  </Parameters>
\end_layout

\begin_layout LyX-Code
  <Objective type="data-fit">
\end_layout

\begin_layout LyX-Code
    <fnc type="parameter">
\end_layout

\begin_layout LyX-Code
      <param name="fem.rigidbody('rigid').Fz"/>
\end_layout

\begin_layout LyX-Code
    </fnc>
\end_layout

\begin_layout LyX-Code
    <data>
\end_layout

\begin_layout LyX-Code
      <point>0.0,
 0</point>
\end_layout

\begin_layout LyX-Code
      <point>0.5,
 1</point>
\end_layout

\begin_layout LyX-Code
      <point>1.0,
 2</point>
\end_layout

\begin_layout LyX-Code
    </data>
\end_layout

\begin_layout LyX-Code
  </Objective>
\end_layout

\begin_layout LyX-Code
</febio_optimize>
\end_layout

\begin_layout Standard

\shape italic
Comments
\shape default
:
\end_layout

\begin_layout Enumerate
Notice that the xml root element is 
\shape italic
febio_optimize
\shape default
 for the optimization input file.
 The version number has to be 2.0 (the 1.0 version is no longer supported).
\end_layout

\begin_layout Enumerate
The FEBio input file that contains the actual FE model data has to defined on the command line using the -i command option.
 This file is a standard FEBio input file that defines all geometry,
 materials,
 boundary conditions and more.
 
\end_layout

\begin_layout Enumerate
The initial values of the parameters are defined in the optimization input file.
 The values in the model input file are ignored.
 
\end_layout

\begin_layout Enumerate
The 
\shape italic
Options 
\shape default
section is included here,
 but can be omitted.
 If omitted default values will be used for all control parameters.
\end_layout

\begin_layout Chapter
Troubleshooting
\begin_inset CommandInset label
LatexCommand label
name "chap:Troubleshooting"

\end_inset


\end_layout

\begin_layout Standard
Running a nonlinear finite element analysis can be a very challenging task.
 The large deformations and complex constitutive models can make it very difficult to obtain a converged solution.
 There are many causes for nonconvergence,
 ranging from element inversions,
 material instability,
 failure to enforce contact constraints and many more.
 Sometimes it is possible that FEBio gives you a converged solution,
 but the solution is meaningless or at least not what was expected.
\end_layout

\begin_layout Standard
Fortunately,
 many of these issues can be prevented or solved with little effort.
 This chapter discusses some strategies to prevent common problems and to troubleshoot a problematic run.
 It offers some sanity checks before you run your model which can save you a lot of frustration down the road.
 And when things do go bad,
 we hope that the strategies suggested here may prove helpful.
\end_layout

\begin_layout Standard
However,
 keep in mind,
 that the finite element method cannot solve all problems.
 It is a very powerful numerical method,
 but with limitations.
 Understanding these limitations and how they affect your modeling work is crucial in becoming a good analysist.
\end_layout

\begin_layout Section
Before You Run Your Model
\begin_inset CommandInset label
LatexCommand label
name "sec:Before-You-Run"

\end_inset


\end_layout

\begin_layout Standard
In this section we'll discuss what a well-defined finite element model is and some things you may need to check before you run your model in FEBio.
\end_layout

\begin_layout Standard
A well-defined finite element model contains a finite element mesh,
 a valid material and properly defined boundary and contact conditions in order to define a unique solution to the problem under study.
 We will look at each of these requirements in more detail in the following sections.
\end_layout

\begin_layout Subsection
The Finite Element Mesh
\begin_inset CommandInset label
LatexCommand label
name "subsec:Finite-Element-Mesh"

\end_inset


\end_layout

\begin_layout Standard
A finite element mesh is required to solve a problem with FEBio.
 The mesh defines a discretization of the problem domain in nodes and connected elements.
 FEBio only supports certain elements and thus the mesh must be composed of elements from this set.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Elements-Section"
nolink "false"

\end_inset

 for a discussion of the supported elements.
 In addition,
 FEBio assumes a specific ordering of the nodes of an element.
 FEBio cannot discover if the nodes are in the correct order,
 but if they are not,
 FEBio will most likely have trouble converging or throw negative jacobians.
 If FEBio discovers negative jacobians before the first time step,
 it is likely that the nodes of the elements are not defined in the proper order.
\end_layout

\begin_layout Standard
For shell elements,
 the initial thickness of an element is also important.
 When elements are too thick (the thickness is of the same order as the element size),
 FEBio may complain about negative jacobians.
 This may be particularly a problem in areas of high curvature.
 The only solution around this issue might be to remesh the problematic area.
\end_layout

\begin_layout Subsection
Materials
\begin_inset CommandInset label
LatexCommand label
name "subsec:Materials"

\end_inset


\end_layout

\begin_layout Standard
A material in FEBio defines the constitutive response of the domain to which the material is assigned.
 See Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Materials"
nolink "false"

\end_inset

 for a detailed list of all the available materials in FEBio.
 It is important to understand that the module defines which materials you can use.
 For example,
 the biphasic material cannot be used in the 
\shape italic
solid 
\shape default
module.
 Although some cases of invalid material use are caught,
 in many situations the resulting behavior is undefined.
 The following table shows a list of some of FEBio's special materials and the modules in which they can be used.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="6">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Material
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Solid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Biphasic
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Solute
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Multiphasic
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Heat
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
biphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\series default
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
biphasic-solute
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
triphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
multiphasic
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
isotropic Fourier
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
YES
\series default
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
In addition to using the proper materials for a given module,
 it is also important to understand that most material parameters have a limited range in which they define valid constitutive behavior.
 For example,
 in a neo-Hookean material the Young's modulus must be positive and the Poisson's ratio must larger than -1 and less than 0.5.
 FEBio has most of these limits implemented in the code and will throw an error when a parameter value is defined that falls outside the valid range.
\end_layout

\begin_layout Standard
Since material parameters can be defined as functions of time through a loadcurve,
 FEBio will check all parameters at the beginning of each time step.
 When a parameter has become invalid the run will be aborted.
\end_layout

\begin_layout Standard
Some constitutive models are only valid for a limited amount of deformation.
 All materials in FEBio are designed for large deformation (in the sense that they are objective under arbitrary deformation),
 but that does not imply unlimited deformation.
 When the deformation becomes too large,
 the material response may become unphysical and although FEBio gives an answer,
 the result may be meaningless (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Understanding-the-Solution"
nolink "false"

\end_inset

 for a discussion on interpreting the result).
 Some materials also become unstable at extremely large deformations.
 A classical example is the Mooney-Rivlin material.
 For a certain range of values of the material parameters,
 and under certain loading conditions,
 the stress-strain response can have a zero slope at large deformations.
 In that case,
 FEBio will most likely not be able to converge since the slope of the stress-strain response is used to progress towards the solution.
\end_layout

\begin_layout Subsection
Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Trouble-Boundary-Conditions"

\end_inset


\end_layout

\begin_layout Standard
Boundary conditions are necessary to uniquely define the solution of the problem under study.
 Improperly defined boundary conditions can lead to underconstrained or overconstrained problems.
\end_layout

\begin_layout Standard
If the problem is underconstrained the solution is not uniquely defined and FEBio will not be able to find a solution.
 The most common example of an undercontrained problem is one where the rigid body modes are not constrained.
 A rigid body mode is a mode of deformation that does alter the stress in the body.
 Affine translation and rotation of the entire mesh are two ways to introduce a rigid body mode.
 In a (quasi-)static finite element analysis all rigid body modes must be properly constrained in order to find a unique solution.
 This can often very easily be achieved by constraining and edge or face of the model from moving at all.
\end_layout

\begin_layout Standard
If the problem is over-constrained,
 FEBio will usually find an answer but it is probably not the solution that was sought.
 The most common cause of an over-constrained model is one that has conflicting boundary conditions.
 For example,
 a force is applied to a node that is fixed.
\end_layout

\begin_layout Section
Debugging a Model
\begin_inset CommandInset label
LatexCommand label
name "sec:Debugging-a-Model"

\end_inset


\end_layout

\begin_layout Standard
When a model is not running as expected,
 the first thing to try is rerun the problem using FEBio's debug mode.
 Debug mode can be activated by adding a g on the command line.
 For example,
\end_layout

\begin_layout LyX-Code
>febio i file.feb -g
\end_layout

\begin_layout Standard
When in debug mode,
 FEBio will do additional checks during the solution (e.g.
 check for NAN's,
 check for zeroes on the diagonal of the stiffness matrix,
 etc.) and will store all non-converged states to the plot file.
 Inspecting these non-converged states can often be useful to identify the cause of the problem.
 (E.g.
 when the model seems to disappear at some point might indicate a rigid body mode.)
\end_layout

\begin_layout Standard
Since storing all non-converged states may make the plot-file too large for post-processing,
 debug mode can also be turned on during the analysis.
 To do this,
 start the problem normally (without the debug flag g).
 Then,
 right before the problem starts to fail,
 interrupt the run (using ctrl+c) and wait for the FEBio prompt to appear.
 Once it appears,
 enter 
\shape italic
debug 
\shape default
[ENTER],
 and then 
\shape italic
cont 
\shape default
[ENTER] to continue the run in debug mode.
 Alternatively,
 a break point can be specified on the command line or at the FEBio prompt,
 which will instruct FEBio to break at a particular point in the analysis.
 At that point,
 the febio prompt will appear,
 and the debug mode can be toggled.
 For more information on setting breakpoints,
 consult section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Setting-break-points"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
Another option is to use the -g2 flag,
 instead of the -g flag.
 This flag will do all of the debug checks,
 but only output the non-converged state that caused febio to fail to the plot file.
 
\end_layout

\begin_layout Section
Common Issues
\begin_inset CommandInset label
LatexCommand label
name "sec:Common-Issues"

\end_inset


\end_layout

\begin_layout Standard
In this section we take a look at some of the most common problems you may run into when solving a finite element problem with FEBio.
 We'll discuss possible causes of and solutions to these issues.
\end_layout

\begin_layout Subsection
Inverted elements
\begin_inset CommandInset label
LatexCommand label
name "subsec:Inverted-elements"

\end_inset


\end_layout

\begin_layout Standard
When an element inverts,
 the element becomes so distorted that in certain areas of the element the Jacobian becomes zero or negative.
 In order to obtain a physically realistic solution,
 the Jacobian of the deformation must be positive at all points of the domain.
 Thus,
 when a negative Jacobian is found in an element,
 FEBio cannot continue.
 Fortunatly,
 FEBio's automatic time-stepping algorithm can usually circumvent this problem by cutting the time step back and retrying the step using a smaller time step.
 In addition,
 FEBio will recalculate the global stiffness matrix.
 The combination of a reduced time step and a refactored stiffness matrix will often be sufficient to overcome the negative Jacobian.
 However,
 when it is not,
 you may have run into a more serious problem.
 These are some of the common causes that may require additional user intervention.
\end_layout

\begin_layout Standard
By default,
 when FEBio encounters inverted elements,
 it will print an error message stating that 
\begin_inset Quotes eld
\end_inset

negative jacobians
\begin_inset Quotes erd
\end_inset

 were detected.
 You can request FEBio to print out a detailed list of the inverted elements,
 by setting the 
\emph on
output_negative_jacobians
\emph default
 configuration flag in the FEBio configuration file.
 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Configuration-File"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

)
\end_layout

\begin_layout Subsubsection
Material instability
\begin_inset CommandInset label
LatexCommand label
name "subsec:Material-instability"

\end_inset


\end_layout

\begin_layout Standard
At large deformations,
 some materials can become unstable.
 This is usually caused by a softening of the material at large deformations.
 When the material softens too much the global stiffness matrix can become ill-conditioned and FEBio will not be able to find the correct solution.
 Unfortunately,
 there is no easy solution around this issue and you may need to consider using a different constitutive model.
\end_layout

\begin_layout Subsubsection
Time step too large
\begin_inset CommandInset label
LatexCommand label
name "subsec:Time-step-too-large"

\end_inset


\end_layout

\begin_layout Standard
Altough the auto-time stepper will automatically adjust the time step in case of trouble,
 it is designed to work within user defined limits and sometimes they are not set properly to solve the problem.
 The most common issue is that the minimum time step is set too large.
 Cutting back the minimum in addition to the initial time step can often help in preventing negative Jacobians.
\end_layout

\begin_layout Subsubsection
Elements too distorted
\begin_inset CommandInset label
LatexCommand label
name "subsec:Elements-too-distorted"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "para:elements"

\end_inset

 When elemens get too distorted they might not be able to deform any further without inverting the element.
 In this case,
 it may be necessary to adjust the mesh in the area where the elements are inverting.
\end_layout

\begin_layout Subsubsection
Shells are too thick
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shells-too-thick"

\end_inset


\end_layout

\begin_layout Standard
A shell is an element where it is assumed that one dimension is much smaller compared to the other two directions.
 When the mesh is really fine,
 this assumption may no longer be valid and it could happen that the shell becomes too thick.
 When a shell gets too thick it can create negative Jacobians in the out-of-plane integration points,
 especially in areas of high curvature.
 To overcome this,
 you may need to remesh the affected area,
 adjust the shell thickness or even replace the shells with solid elements.
\end_layout

\begin_layout Subsubsection
Rigid body modes
\begin_inset CommandInset label
LatexCommand label
name "subsec:Rigid-body-modes"

\end_inset


\end_layout

\begin_layout Standard
A rigid body mode is a mode of deformation that does not alter the stress in the body.
 Uniform translation or rotation of the entire model are two possible rigid body modes.
 In the presence of a rigid body mode,
 the solution is not uniquely defined and FEBio will most likely throw negative Jacobians.
 The solution is to identify the rigid body mode and to eliminate it by applying additional constraints to the model.
\end_layout

\begin_layout Subsection
Failure to converge
\begin_inset CommandInset label
LatexCommand label
name "subsec:Failure-to-converge"

\end_inset


\end_layout

\begin_layout Standard
FEBio uses an iterative method to solve the nonlinear finite element equations.
 This means that for each time step the solution for that step is obtained by a succession of iterations,
 where each iteration brings the model (hopefully) closer to the solution for that step.
 An iterative method requires a convergence criterium to decide when to stop iterating and FEBio uses no less than three criteria.
 (In biphasic and multiphasic problems additional convergence criteria are used for the pressure and concentration degrees of freedom.) The convergence norm for each of these criteria is defined by the user in the control section of the input file.
\end_layout

\begin_layout Standard
Sometimes it happens that FEBio cannot converge on a time step.
 We'll take a look at some of the most common causes in the next following sections.
 Also take a look at possible causes of element inversions above.
 Sometimes,
 the issues that cause an element inversion may also manifest themselves in convergence problems before the element actually inverts.
\end_layout

\begin_layout Subsubsection
No loads applied
\begin_inset CommandInset label
LatexCommand label
name "subsec:No-loads-applied"

\end_inset


\end_layout

\begin_layout Standard
Perhaps surprisingly,
 when no loads are applied,
 FEBio will often struggle to find a solution.
 The reason (and solution!) is simple.
 Although no loads are applied,
 FEBio still performs many calculations and due to round-off errors,
 the result of these calculations may render the convergence norms not exactly zero.
 FEBio then tries to apply the convergence criteria to these really small norms and again due to round-off error will not be able to satisfy the convergence criteria.
\end_layout

\begin_layout Standard
FEBio can actually detect this situation.
 It looks at the residual norm and when this is smaller than a user-defined limit it assumes that no loads are present and moves on to the next time step.
 However,
 this limit is actually problem dependent and it can happen that for your particular problem the limit is set too small.
 In that case,
 the solution is to increase the limit.
 This can be done by setting the 
\shape italic
min_residual 
\shape default
parameter in the 
\shape italic
Control 
\shape default
section of the input file.
 For example,
\end_layout

\begin_layout LyX-Code
<min_residual>1e-15</min_residual>
\end_layout

\begin_layout Standard
If the residual norm now drops below this value,
 FEBio will consider the time step converged and move on to the next time step.
\end_layout

\begin_layout Subsubsection
Convergence Tolerance Too Tight 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Convergence-Tolerance-Too-Tight"

\end_inset


\end_layout

\begin_layout Standard
In some cases,
 the default convergence tolerances are too tight and FEBio will not be able to converge.
 In that case,
 adjusting the affected convergence norms is a possible solution.
 This is done by editing the corresponding norms in the Control section of the input file.
 However,
 this should only be done when no other cause can be identified for the convergence problems.
\end_layout

\begin_layout Subsubsection
Forcing convergence
\begin_inset CommandInset label
LatexCommand label
name "subsec:Forcing-convergence"

\end_inset


\end_layout

\begin_layout Standard
It is possible to force a time step to converge.
 This can be done by interrupting the run (using ctrl+c) and then enter the 
\shape italic
conv 
\shape default
command at the FEBio prompt.
 This will force the time step to converge and FEBio will continue with the next time step.
 This is not a recommended practice as the solution may become unstable and in fact it is unlikely that FEBio will be able to converge any of the following time steps.
 However,
 it can be useful in some scenarios.
 For example,
 if there is no load applied in the initial time step and FEBio has trouble getting past this initial step (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:No-loads-applied"
nolink "false"

\end_inset

) or when you want to store the current state to the plot file without having to rerun the problem in debug mode (although the 
\shape italic
plot 
\shape default
command or 
\shape italic
debug 
\shape default
command might be better alternatives).
\end_layout

\begin_layout Subsubsection
Problems due to Contact
\begin_inset CommandInset label
LatexCommand label
name "subsec:Problems-due-Contact"

\end_inset


\end_layout

\begin_layout Standard
When contact interfaces are defined,
 convergence problems can often be traced back to problems with the contact interfaces.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Guidelines-for-Contact"
nolink "false"

\end_inset

 for more details on how to properly use contact interfaces in FEBio.
\end_layout

\begin_layout Section
Guidelines for Dynamic Analyses
\end_layout

\begin_layout Standard
A dynamic analysis differs from a quasi-static analysis in that the mass inertia of the model is taken into account.
 This adds an explicit time-dependency to the model (through the nodal velocities and accelerations) and therefore the solver needs to integrate the equations of motion in time.
 There are several integration schemes available in FEBio.
 
\end_layout

\begin_layout Subsection
Implicit Dynamics Solver
\end_layout

\begin_layout Standard
The implicit solid solver implements the generalized alpha integration rule,
 which can be controlled via several parameters.
 Although the default settings will usually suffice,
 there might be instances where the parameters should be modified.
 (For example,
 see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:False-Transient-Analysis"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
The main parameter that controls the time integration of the solid solver is the 
\family typewriter
rhoi
\family default
 parameter.
 The following rules apply:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\rho_{\infty}=-1$
\end_inset

,
 All other integration parameters are set to one.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $0\leqq\rho_{\infty}\leqq1$
\end_inset

,
 Newmark integration parameters are set to defaults,
 based on the value of 
\begin_inset Formula $\rho_{\infty}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Any other value for 
\begin_inset Formula $\rho_{\infty}$
\end_inset

,
 default/user-specified values for Newmark integration parameters are not modified.
 
\end_layout

\begin_layout Subsection
Explicit Dynamics Solver
\end_layout

\begin_layout Standard
The explicit solver uses a midpoint time integration rule.
 
\end_layout

\begin_layout Standard
An important aspect of the explicit solver is that is uses a 
\begin_inset Quotes eld
\end_inset

lumped
\begin_inset Quotes erd
\end_inset

 mass matrix,
 which reduces the mass matrix to a diagonal form.
 There are currently two lumping algorithms implemented:
 
\end_layout

\begin_layout Description
row-sum The matrix elements of each row are summed together and the sum is assigned to the diagonal.
 
\end_layout

\begin_layout Description
HRZ-lumping This is the preferred method of lumping for higher-order elements.
 However,
 it should not be used for shells.
 
\end_layout

\begin_layout Subsection
False Transient Analysis
\begin_inset CommandInset label
LatexCommand label
name "subsec:False-Transient-Analysis"

\end_inset


\end_layout

\begin_layout Standard
Quasi-static models may sometimes exhibit instabilities that may prevent the default Newton-based solver from converging.
 In such situations,
 a dynamic analysis can be tried instead,
 with the anticipation that the inertia of the model provides sufficient stability to solve the model successfully.
 Since in these situations,
 only the long-term quasi-static solution is sought,
 it is important to damp the oscillations introduced by the dynamics of the system.
 Such damping can be accomplished several ways.
 
\end_layout

\begin_layout Standard
The generalized-alpha time integration scheme of the implicit solver uses several parameters that control the overall energy-conservation of the model.
 By choosing these parameters such that the system looses energy over time,
 artifical damping can be introduced.
 
\end_layout

\begin_layout Standard
The 
\family typewriter
rhoi
\family default
 control parameter controls the amount of artificial damping.
 This parameters takes a value between 0 (more numerical damping) and 1 (least numerical damping).
 Thus,
 by setting this value to 0,
 the most numerical damping can be introduced.
 
\end_layout

\begin_layout Standard
The 
\family typewriter
rhoi
\family default
 control parameter sets the actual alpha,
 beta,
 gamma parameters of the generalized-alpha rule.
 Instead of using rhoi,
 users can set these actual parameters directly.
 To introduce the most numerical damping,
 set the values as follows.
 
\end_layout

\begin_layout LyX-Code
<rhoi>-2</rhoi>             
\end_layout

\begin_layout LyX-Code
<gamma>1.5</gamma>
\end_layout

\begin_layout LyX-Code
<beta>1</beta>
\end_layout

\begin_layout Standard
Note that rhoi needs to be set to -2 so that FEBio uses the actual alpha,
 beta,
 gamma parameters.
 
\end_layout

\begin_layout Section
Guidelines for Contact Problems
\begin_inset CommandInset label
LatexCommand label
name "sec:Guidelines-for-Contact"

\end_inset


\end_layout

\begin_layout Standard
FEBio offers many contact interfaces which allow the user to model complex boundary interactions.
 However,
 this capability comes at a price and the use of contact interfaces may create several problems in the solution process.
 It is hoped that the guidelines presented in this section may prevent many of the most common problems with contact.
\end_layout

\begin_layout Standard
Most of the contact algorithms implemented in FEBio offer two contact enforcement methods:
 a penalty method and an augmented Lagrangian method.
 Since the strategies for these two methods are slightly different,
 we will look at them separately.
 These algorithms are discussed in much more detail in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://febio.org/knowledgebase/}{
\backslash
emph{FEBio Theory Manual}}
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
The penalty method
\begin_inset CommandInset label
LatexCommand label
name "subsec:The-penalty-method"

\end_inset


\end_layout

\begin_layout Standard
The penalty method enforces contact by 
\begin_inset Quotes eld
\end_inset

penalizing
\begin_inset Quotes erd
\end_inset

 (in an energy sense) any deviation from the contact constraint.
 In other words,
 when the two contacting surfaces penetrate,
 a force is generated proportional to the distance of penetration,
 which has the effect that the surfaces will now repell each other.
 The strength of this repelling force is controlled by the user through the 
\shape italic
penalty factor
\shape default
.
\end_layout

\begin_layout Standard
The obvious downside of this method is that some penetration is necessary to generate the contact force.
 The larger the penalty factor,
 the smaller this penetration needs to be and thus the better the contact constraint is enforced.
 However,
 choosing the penalty factor too large may cause the problem to become unstable since the contact force (and corresponding stiffness) will dominate the other forces in the model.
 Choosing a good penalty factor can thus be often difficult and may require several attempts before getting it 
\begin_inset Quotes eld
\end_inset

right
\begin_inset Quotes erd
\end_inset

.
 To help with choosing a penalty factor,
 FEBio offers the 
\shape italic
auto_penalty 
\shape default
option for many of its contact interfaces which will estimate a good penalty factor based on element size and initial material stiffness.
 However,
 even then it may still take a few tries before getting the penalty factor good enough.
\end_layout

\begin_layout Subsection
Augmented Lagrangian Method
\begin_inset CommandInset label
LatexCommand label
name "subsec:Augmented-Lagrangian-Method"

\end_inset


\end_layout

\begin_layout Standard
In theory,
 in the presence of constraints,
 the corresponding Lagrange multipliers must be calculated which,
 in the case of contact,
 correspond to the contact forces that enforce the contact constraint exactly.
 Unfortunately,
 the exact evaluation of these Lagrange multipliers is numerically very challenging and therefore in FEBio it was decided to evaluate these Lagrange multipliers using an iterative method,
 named the 
\shape italic
Augmented Lagrangian 
\shape default
method.
 Using this method,
 FEBio will solve a time step several times (these iterations are termed 
\shape italic
augmentations
\shape default
),
 where each time the approximate Lagrange mutlipliers are updated (or 
\shape italic
augmented
\shape default
).
\end_layout

\begin_layout Standard
The obvious drawback of this method is that now each time step has to be solved several times.
 However,
 the advantage of avoiding the numerical problems of obtaining the exact Lagrange multipliers and the fact that in most contact problems very little extra work is needed to solve these augmentations,
 makes this method very attractive.
 In addition,
 it often gives better enforcement of the contact constraint compared to the penalty method.
\end_layout

\begin_layout Standard
So why not just use the augmented Lagrangian method?
 Well,
 often the penalty method will give good results and since the penalty method is much faster,
 it is often the preferred choice of many analysists.
\end_layout

\begin_layout Standard
In many cases,
 users are only interested in the final time step.
 For these users it may be of interest that it is possible to use the augmented Lagrange method only in the final time step.
 This can be done by defining a loadcurve for the 
\shape italic
tolerance
\shape default
 contact parameter,
 which sets the convergence tolerance for the augmentations.
 (Note that you still need to set the enforcement method,
 i.e.
 the 
\emph on
laugon
\emph default
 paramerter,
 to AUGLAG (=1)).
 Then,
 define the corresponding loadcurve as zero everywhere except for the final time step.
 FEBio will now only use the augmented Lagrangian method in the final time step (and the penalty method all other steps).
\end_layout

\begin_layout Subsection
Initial Separation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Initial-Separation"

\end_inset


\end_layout

\begin_layout Standard
FEBio often struggles with problems that have an initial separation.
 This is especially so when the problem is force-driven,
 meaning that the deformation of the model is driven by a force (opposed to displacement-driven problems).
 In general,
 when the contact interface is necessary to define a well-constrained problem it is best to avoid initial separation if possible.
 Another way around this issue is to first use a displacement to bring the surfaces in contact and then replace the displacement with a force.
\end_layout

\begin_layout Section
Cautionary Note for Steady-State Biphasic and Multiphasic Analyses
\begin_inset CommandInset label
LatexCommand label
name "sec:Guidelines-Steady-State"

\end_inset


\end_layout

\begin_layout Standard
Biphasic,
 biphasic-solute and multiphasic analyses are generally transient analyses,
 involving mass transport (solvent and solutes) through a porous permeable domain.
 The default setting for these analyses is the transient mode (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Module-Section"
nolink "false"

\end_inset

).
 When a steady-state analysis is requested (
\emph on
<analysis type="steady-state"/>
\emph default
),
 the code simplifies the governing equations by setting time derivatives of the solid displacement and solute concentrations to zero.
 It is important to understand that this simplification is only applicable to analyses where interface conditions between sub-domains,
 and boundary conditions with the external environment,
 allow mass exchanges for the solvent and all solutes.
 If a domain or sub-domain is completely sealed such that it prevents solvent or solute exchanges,
 a steady-state analysis should not be used,
 as it would not capture these sealed conditions and would lead to erroneous results.
 For those types of problems,
 always use a transient analysis to obtain the correct solution.
 In those cases,
 a steady-state response may be obtained efficiently by temporarily increasing the transport properties (hydraulic permeability and solute diffusivities) by orders of magnitude via load curves,
 and/or by increasing the size of time steps.
\end_layout

\begin_layout Section
Guidelines for Multiphasic Analyses
\begin_inset CommandInset label
LatexCommand label
name "sec:Guidelines-for-Multiphasic"

\end_inset


\end_layout

\begin_layout Subsection
Initial State of Swelling
\begin_inset CommandInset label
LatexCommand label
name "subsec:Initial-State-Swelling-1"

\end_inset


\end_layout

\begin_layout Standard
Under traction-free conditions,
 a multiphasic material is usually in a state of swelling due to the osmotic pressure difference between the interstitial fluid and the external environment.
 This osmotic pressure arises from the difference in interstitial versus external concentrations of cations and anions,
 caused by the charged solid matrix and the requirement to satisfy electroneutrality.
 An osmotic pressure difference arising from such electrostatic interactions is known as the 
\shape italic
Donnan osmotic pressure
\shape default
.
 When the Donnan pressure is non-zero,
 traction-free conditions do not produce stress-free conditions for the solid matrix,
 since the matrix must expand until its stressed state resists the swelling pressure.
\end_layout

\begin_layout Standard
The Donnan pressure reduces to zero when the fixed charged density is zero,
 or when the external environment is infinitely hypertonic (having ion concentrations infinitely greater than the interstitial fixed charge density).
 Since these two conditions represent special cases,
 it is generally necessary to devise methods for achieving the desired initial state of swelling,
 in an analysis where loads or displacements need to be prescribed over and above this swollen state.
 Swelling occurs as a result of the influx of solvent into the porous solid matrix.
 This influx is a time-dependent process that could require extensive analysis time.
 Therefore,
 it is computationally efficacious to achieve the initial state of swelling by using a multi-step analysis (Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Multi-step-Analysis"
nolink "false"

\end_inset

) where the first step is a steady-state analysis (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Control-Parameters"
nolink "false"

\end_inset

).
 In this steady-state step,
 the fixed charge density may be ramped up from zero to the desired value using a load curve for that property or,
 alternatively,
 the external environmental conditions may be reduced from a very high hypertonic state down to the desired level.
 In the second step,
 prescribed displacement boundary conditions (when needed) may be specified to be of type 
\shape italic
relative
\shape default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Zero-Displacement"
nolink "false"

\end_inset

),
 so that they become superposed over and above the initial swelling state.
\end_layout

\begin_layout Standard

\shape italic
Example:
\end_layout

\begin_layout LyX-Code
<Module type="multiphasic"/>
\end_layout

\begin_layout LyX-Code
<!-- rest of file -->
\end_layout

\begin_layout LyX-Code
<Step>
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
    <analysis type="steady-state"/>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
</Step>
\end_layout

\begin_layout LyX-Code
<Step>
\end_layout

\begin_layout LyX-Code
  <Control>
\end_layout

\begin_layout LyX-Code
    ...
\end_layout

\begin_layout LyX-Code
  </Control>
\end_layout

\begin_layout LyX-Code
  <Boundary>
\end_layout

\begin_layout LyX-Code
    <prescribe type="relative">
\end_layout

\begin_layout LyX-Code
      <node id="22" bc="z" lc="4">1</node>
\end_layout

\begin_layout LyX-Code
      ...
\end_layout

\begin_layout LyX-Code
    </prescribe>
\end_layout

\begin_layout LyX-Code
  </Boundary>
\end_layout

\begin_layout LyX-Code
</Step>
\end_layout

\begin_layout Subsection
Prescribed Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Boundary-Conditions-1"

\end_inset


\end_layout

\begin_layout Standard
In most analyses,
 it may be assumed that the ambient fluid pressure and electric potential in the external environment are zero,
 thus 
\begin_inset Formula $p_{\ast}=0$
\end_inset

 and 
\begin_inset Formula $\psi_{\ast}=0$
\end_inset

,
 where the subscripted asterisk is used to denote environmental conditions.
 Since the external environment does not include a solid matrix,
 the fixed charge density there is zero.
 For example,
 for a triphasic analysis,
 
\begin_inset Formula $c_{\ast}^{+}=c_{\ast}^{-}\equiv c_{\ast}$
\end_inset

.
 It follows that the effective fluid pressure in the external environment is 
\begin_inset Formula $\tilde{p}_{\ast}=-R\theta\Phi_{\ast}\sum\nolimits_{\alpha}c_{\ast}^{\alpha}$
\end_inset

 and the effective concentrations are 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\hat{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}$
\end_inset

.
 Therefore,
 in multiphasic analyses,
 whenever the external environment contains solutes with concentrations 
\begin_inset Formula $c_{\ast}^{\alpha}$
\end_inset

,
 the user must remember to prescribe non-zero boundary conditions for the effective solute concentrations 
\shape italic
and
\shape default
 the effective fluid pressure.
\end_layout

\begin_layout Standard
Letting 
\begin_inset Formula $p_{\ast}=0$
\end_inset

 also implies that prescribed mixture normal tractions (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Mixture-Normal-Traction"
nolink "false"

\end_inset

) represent only the traction above ambient conditions.
 Note that users are not obligated to assume that 
\begin_inset Formula $p_{\ast}=0$
\end_inset

.
 However,
 if a non-zero value is assumed for the ambient pressure,
 then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions.
 Similarly,
 users are not required to assume that 
\begin_inset Formula $\psi_{\ast}=0$
\end_inset

;
 when a non-zero value is assumed for the electric potential of the external environment,
 the prescribed boundary conditions for the effective concentrations should be evaluated using the corresponding partition coefficient,
 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\tilde{\kappa}_{\ast}^{\alpha}$
\end_inset

.
\end_layout

\begin_layout Subsection
Prescribed Initial Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Initial-Conditions-1"

\end_inset


\end_layout

\begin_layout Standard
When a multiphasic material is initially exposed to a given external environment with effective pressure 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and effective concentrations 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}$
\end_inset

,
 the initial conditions inside the material should be set to 
\begin_inset Formula $\tilde{p}=\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}^{\alpha}=\tilde{c}_{\ast}^{\alpha}$
\end_inset

 in order to expedite the evaluation of the initial state of swelling.
 The values of 
\begin_inset Formula $\tilde{p}_{\ast}$
\end_inset

 and 
\begin_inset Formula $\tilde{c}_{\ast}^{\alpha}$
\end_inset

 should be evaluated as described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Boundary-Conditions-1"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Prescribed Effective Solute Flux
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Effective-Solute-Flux-1"

\end_inset


\end_layout

\begin_layout Standard
The finite element formulation for multiphasic materials in FEBio requires that the natural boundary condition for solute 
\begin_inset Formula $\alpha$
\end_inset

 be prescribed as 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}\equiv j_{n}^{\alpha}+\sum\nolimits_{\beta}z^{\beta}j_{n}^{\beta}$
\end_inset

,
 where 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}$
\end_inset

 is the effective solute flux.
 For a mixture containing only neutral solutes (
\begin_inset Formula $z^{\beta}=0,\,\forall\beta$
\end_inset

 ),
 it follows that 
\begin_inset Formula $\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}$
\end_inset

.
\end_layout

\begin_layout Subsection
Prescribed Electric Current Density
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prescribed-Electric-Current-1"

\end_inset


\end_layout

\begin_layout Standard
The electric current density in a mixture is a linear superposition of the ion fluxes,
 
\begin_inset Formula 
\[
\mathbf{I}_{e}=F_{c}\sum\limits_{\alpha}z^{\alpha}\mathbf{j}^{\alpha}\,.
\]

\end_inset

Since only the normal component 
\begin_inset Formula $j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}$
\end_inset

 of ion fluxes may be prescribed at a boundary,
 it follows that only the normal component 
\begin_inset Formula $I_{n}=\mathbf{I}_{e}\cdot\mathbf{n}$
\end_inset

 of the current density may be prescribed.
 To prescribe 
\begin_inset Formula $I_{n}$
\end_inset

,
 it is necessary to know the nature of the ion species in the mixture,
 and how the current is being applied.
 For example,
 if the ions in the triphasic mixture consist of Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 and Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

,
 and if the current is being applied using silver/silver chloride (Ag/AgCl) electrodes,
 a chemical reaction occurs at the anode where Ag combines with Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

 to produce AgCl,
 donating an electron to the electrode to transport the current.
 At the cathode,
 the reverse process takes place.
 Therefore,
 in this system,
 there is only flux of Cl
\begin_inset Formula $^{\mathrm{-}}$
\end_inset

 and no flux of Na
\begin_inset Formula $^{\mathrm{+}}$
\end_inset

 (
\begin_inset Formula $j_{n}^{+}=0)$
\end_inset

 at the electrode-mixture interface,
 so that the prescribed boundary condition should be 
\begin_inset Formula $j_{n}^{-}=-I_{n}/F_{c}$
\end_inset

.
 Since 
\begin_inset Formula $z^{+}=+1$
\end_inset

 and 
\begin_inset Formula $z^{-}=-1$
\end_inset

 in a triphasic mixture,
 the corresponding effective fluxes are given by 
\begin_inset Formula $\tilde{j}_{n}^{+}=2j_{n}^{+}-j_{n}^{-}=I_{n}/F_{c}$
\end_inset

 and 
\begin_inset Formula $\tilde{j}_{n}^{-}=j_{n}^{+}=0$
\end_inset

.
\end_layout

\begin_layout Subsection
Electrical Grounding
\begin_inset CommandInset label
LatexCommand label
name "subsec:Electrical-Grounding-1"

\end_inset


\end_layout

\begin_layout Standard
If a multiphasic mixture containing ions is completely surrounded by ion-impermeant boundaries it is necessary to ground the mixture to prevent unconstrained fluctuations of the electric potential.
 Grounding is performed by prescribing the effective concentration of one or more ions,
 at a location inside the mixture or on one of its boundaries corresponding to the location of the grounding electrode.
 The choice of ion(s) to constrain may be guided by the type of grounding electrode and the reference electrolyte bath in which it is inserted.
\end_layout

\begin_layout Section
Guidelines for Fluid Analyses
\begin_inset CommandInset label
LatexCommand label
name "sec:Guidelines-Fluid-Analyses"

\end_inset


\end_layout

\begin_layout Standard
Currently,
 the fluid solvers of FEBio can be used to solve for isothermal fluid mechanics problems (
\begin_inset Quotes eld
\end_inset

fluid
\begin_inset Quotes erd
\end_inset

 solver),
 isothermal fluid-structure interaction problems (
\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset

 solver,
 Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Structure-Interactions"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) and isothermal fluid mechanics with solute (mass) transport (
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 solver).
 When solutes are included in an analysis,
 their treatment is very similar to the 
\begin_inset Quotes eld
\end_inset

multiphasic
\begin_inset Quotes erd
\end_inset

 solver described in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Triphasic-Multiphasic-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 The fluid pressure 
\begin_inset Formula $p$
\end_inset

 and solute concentrations 
\begin_inset Formula $c^{\iota}$
\end_inset

 in a fluid-solutes domain are thus related to the effective fluid pressure 
\begin_inset Formula $\tilde{p}$
\end_inset

 and effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

,
 to account for the possibility that the solutes are electrically charged.
 The theoretical treatment of solutes in the 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 solver follows that of the 
\begin_inset Quotes eld
\end_inset

multiphasic
\begin_inset Quotes erd
\end_inset

 solver,
 with the following simplifications:
 (a) The effective solubility 
\begin_inset Formula $\hat{\kappa}^{\iota}$
\end_inset

 appearing in the expression for the partition coefficient 
\begin_inset Formula $\tilde{\kappa}^{\iota}$
\end_inset

 in eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

 only embodies non-ideal physico-chemical behavior (whereas 
\begin_inset Formula $\hat{\kappa}^{\iota}$
\end_inset

 in a multiphasic mixture with a porous solid matrix can also embody the steric volume exclusion of solutes from the pore space);
 therefore,
 one should always set 
\begin_inset Formula $\hat{\kappa}^{\iota}=1$
\end_inset

 when modeling ideal behavior in a 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 analysis.
 (b) Since there is no porous solid matrix that can hinder solute transport,
 the diffusivity tensor 
\begin_inset Formula $\mathbf{d}^{\iota}$
\end_inset

 of a solute in a 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 mixture is always equal to 
\begin_inset Formula $d_{0}^{\iota}\mathbf{I}$
\end_inset

,
 where 
\begin_inset Formula $d_{0}^{\iota}$
\end_inset

 is the solute diffusivity in free solution.
 Thus,
 even though FEBio requires users to specify a value for 
\begin_inset Formula $\mathbf{d}^{\iota}$
\end_inset

,
 that value is essentially ignored in the 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 solver code,
 where it is replaced by 
\begin_inset Formula $d_{0}^{\iota}\mathbf{I}$
\end_inset

.
 If users would like to neglect osmotic pressure in a 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 analysis,
 the osmotic coefficient 
\begin_inset Formula $\Phi$
\end_inset

 should be set to zero,
 producing 
\begin_inset Formula $\tilde{p}=p$
\end_inset

.
 Moreover,
 in the absence of solutes (
\begin_inset Formula $c^{\iota}=0$
\end_inset

 for all 
\begin_inset Formula $\iota$
\end_inset

,
 as in the 
\begin_inset Quotes eld
\end_inset

fluid
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset

 solvers) this relation holds automatically.
 Therefore,
 when dealing with the 
\begin_inset Quotes eld
\end_inset

fluid
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset

 solvers,
 we do not need to add the 
\begin_inset Quotes eld
\end_inset

effective
\begin_inset Quotes erd
\end_inset

 modifier when mentioning the fluid pressure.
\end_layout

\begin_layout Standard
There are two broad categories of materials available for 
\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset

 analyses:
 (1) 
\emph on
fluid-FSI
\emph default

\begin_inset Quotes erd
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Fluid-FSI-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 and (2) 
\emph on
biphasic-FSI
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Fluid-BFSI-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
 A 
\emph on
fluid-FSI
\emph default
 material is used to describe a fluid domain whose mesh is deformable;
 though a solid material (typically 
\emph on
neo-Hookean
\emph default
) must be assigned to the mesh of a 
\emph on
fluid-FSI
\emph default
 material,
 its mass density is ignored and it is the user's responsibility to ascribe a negligible elasticity to this solid domain,
 whose sole purpose is to regularize the mesh deformation.
 A 
\emph on
biphasic-FSI
\emph default
 material considers that the deformable domain is a biphasic material (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biphasic-Materials"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

),
 with a porous-permeable solid domain that has non-negligible mass density,
 solid volume fraction,
 solid matrix stiffness,
 and hydraulic permeability.
 The interstitial fluid of such a domain may also be ascribed a viscosity (Newtonian or non-Newtonian).
\end_layout

\begin_layout Subsection
Degrees of Freedom and Boundary Conditions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-DOFs-BCs"

\end_inset


\end_layout

\begin_layout Standard
The nodal degrees of freedom for 
\begin_inset Quotes eld
\end_inset

fluid
\begin_inset Quotes erd
\end_inset

 analyses are the nodal fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 and nodal fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

.
 For a 
\begin_inset Quotes eld
\end_inset

fluid-FSI
\begin_inset Quotes erd
\end_inset

 analysis the nodal fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 is replaced with the relative fluid flux 
\begin_inset Formula $\mathbf{w}=\varphi^{f}\left(\mathbf{v}^{f}-\mathbf{v}^{s}\right)$
\end_inset

 and supplemented with the nodal solid displacement,
 
\begin_inset Formula $\mathbf{u}$
\end_inset

,
 whose material time derivative equals the solid velocity 
\begin_inset Formula $\mathbf{v}^{s}$
\end_inset

.
 Here,
 
\begin_inset Formula $\varphi^{f}$
\end_inset

 represents the fluid volume fraction (porosity) of the fluid-FSI domain,
 which is prescribed by the user in a 
\emph on
biphasic-FSI
\emph default
 material (via the complementary solid volume fraction) or automatically set to 
\begin_inset Formula $\varphi^{f}=1$
\end_inset

 in a 
\emph on
fluid-FSI
\emph default
 material.
 Thus,
 the degrees of freedom of a fluid-FSI analysis reduce to those of a fluid (or fluid-solutes) analysis in the limit when 
\begin_inset Formula $\varphi^{f}\to1$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}^{s}\to\mathbf{0}$
\end_inset

.
 For 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 analyses,
 the nodal degrees of freedom include the effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

;
 as for 
\begin_inset Quotes eld
\end_inset

multiphasic
\begin_inset Quotes erd
\end_inset

 analyses,
 it is assumed that solutes occupy a negligible volume fraction in the mixture (thus 
\begin_inset Formula $\varphi^{f}=1$
\end_inset

 for 
\begin_inset Quotes eld
\end_inset

fluid-solutes
\begin_inset Quotes erd
\end_inset

 analyses).
\end_layout

\begin_layout Standard
The fluid Cauchy stress is given by 
\begin_inset Formula $\boldsymbol{\sigma}^{f}=-p\mathbf{I}+\boldsymbol{\tau}$
\end_inset

,
 where 
\begin_inset Formula $p$
\end_inset

 is the actual (not the effective) fluid pressure,
 as per eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 The viscous stress 
\begin_inset Formula $\boldsymbol{\tau}$
\end_inset

 depends on the fluid rate of deformation tensor 
\begin_inset Formula $\mathbf{D}^{f}$
\end_inset

 according to a user-selected constitutive relation,
 such as 
\emph on
Newtonian fluid
\emph default
.
\end_layout

\begin_layout Standard
In any of the fluid analysis types,
 the user may prescribe any of the components of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 as an essential boundary condition,
 or the corresponding component of the viscous traction 
\begin_inset Formula $\mathbf{t}^{\tau}=\boldsymbol{\tau}\cdot\mathbf{n}$
\end_inset

 as a natural boundary condition (
\begin_inset Formula $\mathbf{n}$
\end_inset

 being the normal to the boundary surface).
 When neither a component of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 nor the corresponding component of 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 is prescribed explicitly,
 the latter is naturally assumed to be zero.
 Similarly,
 the user may prescribe 
\begin_inset Formula $e^{f}$
\end_inset

 (or 
\begin_inset Formula $\tilde{p}\left(e^{f}\right)$
\end_inset

,
 see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Pressure"
nolink "false"

\end_inset

) as an essential boundary condition,
 or 
\begin_inset Formula $w_{n}=\mathbf{w}\cdot\mathbf{n}$
\end_inset

 as a natural boundary condition.
 When neither is prescribed explicitly,
 it is naturally assumed that 
\begin_inset Formula $w_{n}=0$
\end_inset

.
 Natural boundary conditions are useful for creating symmetry planes in fluid analyses,
 where the normal fluid velocity and the viscous traction are zero:
 On those symmetry planes,
 no boundary conditions should be specified.
\end_layout

\begin_layout Standard
It is noteworthy that the fluid formulation in FEBio allows the prescription of the nodal value of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 as an essential boundary condition,
 and the surface value of 
\begin_inset Formula $w_{n}$
\end_inset

 as a natural boundary condition.
 On boundaries where the fluid velocity is completely prescribed,
 i.e.,
 when normal and tangential components are known (and not zero),
 prescribing 
\begin_inset Formula $\mathbf{w}$
\end_inset

 and 
\begin_inset Formula $w_{n}$
\end_inset

 instead of just 
\begin_inset Formula $\mathbf{w}$
\end_inset

 produces the best computational outcome.
 In those cases,
 the user should use the 
\emph on
fluid velocity
\emph default
 surface load,
 which combines both boundary conditions (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Velocity"
nolink "false"

\end_inset

).
 If the user only wants to prescribe a known normal velocity 
\begin_inset Formula $w_{n}$
\end_inset

 and leave the tangential velocity unspecified,
 use the 
\emph on
fluid normal velocity
\emph default
 surface load (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Normal-Velocity"
nolink "false"

\end_inset

);
 this surface load also provides the option of setting the tangential fluid velocity to zero.
 Finally,
 if the user wants the velocity to remain normal to the selected surface (e.g.,
 an inlet or outlet surface on which 
\begin_inset Formula $e^{f}$
\end_inset

 is prescribed or fixed),
 but does not know the velocity magnitude 
\emph on
a priori
\emph default
,
 use the 
\emph on
normal fluid velocity 
\emph default
constraint (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Normal-Fluid-Velocity"
nolink "false"

\end_inset

) to enforce this condition.
\end_layout

\begin_layout Standard
A viscous fluid satisfies the no-slip condition on a physical boundary surface.
 This means that 
\begin_inset Formula $\mathbf{w}=\mathbf{0}$
\end_inset

 on no-slip boundaries.
 This boundary condition can be enforced simply by fixing the three components of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Displacement"
nolink "false"

\end_inset

) and not specifying any value for 
\begin_inset Formula $e^{f}$
\end_inset

 on that surface (which naturally enforces 
\begin_inset Formula $w_{n}=0$
\end_inset

).
\end_layout

\begin_layout Standard
Computational fluid dynamics analyses are often performed over a mesh that truncates the real fluid domain.
 Thus,
 fluid may enter the finite element domain across some upstream inlet boundary and leave the domain across some downstream outlet boundary.
 The exact flow conditions on these boundaries may not be known,
 thus they have to be approximated using best guesses.
 Arguably,
 the viscous traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

 is the least intuitive boundary condition to guess.
 On an outlet boundary,
 it is necessary to prescribe or fix the dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 to overcome the natural boundary condition 
\begin_inset Formula $w_{n}=0$
\end_inset

.
 However,
 in most cases the tangential components of 
\begin_inset Formula $\mathbf{w}$
\end_inset

 on that boundary are not known,
 therefore they cannot be fixed or prescribed,
 leading to the natural condition 
\begin_inset Formula $\mathbf{t}^{\tau}=\mathbf{0}$
\end_inset

.
 This natural condition may work fine in some cases,
 but it will often fail numerically when vortices being shed inside the finite element domain try to cross the outlet boundary.
 In those cases,
 consider using the 
\emph on
fluid backflow stabilization 
\emph default
(Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Backflow-Stabilization"
nolink "false"

\end_inset

) and 
\emph on
fluid tangential stabilization
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Tangential-Stabilization"
nolink "false"

\end_inset

) surface loads,
 which prescribe a velocity-dependent viscous traction 
\begin_inset Formula $\mathbf{t}^{\tau}$
\end_inset

.
\end_layout

\begin_layout Standard
Similarly,
 on an inlet boundary that shares an edge with a no-slip surface,
 prescribing the fluid velocity 
\begin_inset Formula $\mathbf{w}$
\end_inset

 on the inlet boundary may not accurately reproduce the velocity profile in the boundary layer that would be produced on the adjoining no-slip surface.
 This potential mismatch could result in numerical instabilities;
 in such cases,
 prescribing a dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 on the shared edge may mitigate this issue.
\end_layout

\begin_layout Subsection
Biased Meshes for Boundary Layers
\end_layout

\begin_layout Standard
In fluid analyses,
 boundary layers will form in the vicinity of no-slip boundaries,
 where the velocity magnitude varies rapidly with the distance from a no-slip surface.
 The thickness of boundary layers decreases with increasing Reynolds number.
 To capture these boundary layers accurately in a fluid finite element analysis,
 it is necessary to refine the mesh to produce thinner elements closer to the no-slip boundaries.
 This is done most conveniently by using mesh biasing tools,
 available in various meshing software programs,
 or post-hoc boundary-layer meshing tool that modify an existing mesh.
 Both of these options are available in FEBioStudio.
 Boundary layer meshing should always be used in fluid analyses in FEBio.
 Whereas other finite element codes employ numerical stabilization techniques that partially alleviate the need for biased meshes,
 FEBio does not employ such techniques.
 Therefore,
 using uniform finite element meshes may fail to produce numerical convergence,
 even in some seemingly simple problems.
 Users should keep in mind that biased meshes don't necessarily require more nodes and elements,
 therefore there is no automatic computational cost for using biased meshes.
\end_layout

\begin_layout Subsection
Computational Efficiency:
 Broyden's Method
\end_layout

\begin_layout Standard
Fluid analyses produce a non-symmetric stiffness matrix and the resulting system of equations may be efficiently solved using Broyden's quasi-Newton method,
 where an approximation to the matrix inverse is produced at each iteration after the first full-Newton iteration of a time step.
 In fluid analyses,
 it is often possible to achieve convergence at each time step without having to perform additional full-Newton updates.
 Therefore,
 it is recommended to set 
\emph on
max_updates
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Control-Section"
nolink "false"

\end_inset

) to a large number (e.g.,
 50),
 along with setting 
\emph on
diverge_reform
\emph default
 to 0 (false),
 which leads to a more efficient solution scheme.
 A further advantage arises in fluid analyses since the mesh remains invariant over time:
 it is often possible to continue using Broyden updates even across time steps,
 without performing a full-Newton iteration at the start of that step,
 by setting 
\emph on
reform_each_time_step
\emph default
 to 0 (false).
 In that case,
 the solver will continue using Broyden updates up to the value of 
\emph on
max_updates
\emph default
,
 before performing a full Newton update.
\end_layout

\begin_layout Subsection
Dynamic versus Steady-State Analyses
\end_layout

\begin_layout Standard
FEBio runs fluid analyses in dynamic mode by default,
 because many fluid flow problems do not have a steady-state solution,
 since the governing equations are nonlinear.
 For example,
 many flows may exhibit vortex shedding as fluid flows across an obstacle,
 such as a flow constriction or a solid body.
 Even if some form of periodicity emerges under specific flow conditions,
 as in the von Karman vortex street,
 the corresponding solution is not in steady state.
 However,
 for some low Reynolds number laminar flows,
 a steady-state response may exist and FEBio will attempt to find that solution when using analysis type 
\begin_inset Quotes eld
\end_inset

steady-state
\begin_inset Quotes erd
\end_inset

 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Control-Section"
nolink "false"

\end_inset

).
 The user should be aware that,
 under steady-state analyses,
 the solution may not necessarily converge as efficiently to the final solution as would a dynamic analysis that allows the solution to reach steady state after a sufficiently long time.
 The best choice of analysis type for steady-state problems may need to be determined by trial and error.
\end_layout

\begin_layout Subsection
Isothermal Compressible Flow versus Acoustics
\end_layout

\begin_layout Standard
The governing equations for fluid flow in FEBio represent isothermal conditions,
 thus eliminating temperature as a variable in the numerical analysis.
 Since the fluid solver accommodates some measure of fluid compressibility (via the fluid dilatation variable 
\begin_inset Formula $e^{f}$
\end_inset

),
 it is possible to solve for pressure wave propagation in fluids using this formulation.
 However,
 from a theoretical perspective,
 it should be recognized that the speed of sound (i.e.,
 the wave speed) in isothermal (constant temperature) flow is different from the speed of sound in isentropic (constant entropy) flow.
 The field of acoustics typically examines pressure wave propagations under isentropic conditions,
 which are found to be more consistent with experimental measurements of the speed of sound in air.
 Therefore,
 the FEBio fluid solver may not produce realistic wave speeds when simulating acoustics.
 A fluid solver for isentropic flow may be developed for FEBio in the future.
\end_layout

\begin_layout Subsection
Fluid-Structure Interactions
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Structure-Interactions"

\end_inset


\end_layout

\begin_layout Standard
Fluid-structure interactions (FSI) may be modeled in FEBio using the 
\emph on
fluid-FSI
\emph default
 module (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Module-Section"
nolink "false"

\end_inset

).
 In an FSI analysis the finite element mesh defining the fluid domain is deformable,
 so that the shape of the fluid domain does not have to remain fixed over time.
 The fluid flows through the deforming mesh,
 just as it does in standard computational fluid dynamics (CFD) analyses with fixed meshes.
 The deformation of the fluid domain may be controlled by prescribing suitable boundary conditions (so-called 
\emph on
moving boundary problems
\emph default
) and by interactions with solid domains.
 For example,
 fluid may flow inside a flexible tube and the fluid pressure may cause the tube to expand or contract;
 the tube itself may be pinched at some location,
 reducing the cross-section through which fluid flows.
 The tube wall is a deformable solid domain which may be modeled in FEBio using any of the solid material models described in Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Elastic-Solids"
nolink "false"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multigeneration-Solids"
nolink "false"

\end_inset

,
 or it may be modeled as a porous deformable domain containing a viscous fluid,
 in which case one should use the 
\emph on
biphasic-FSI
\emph default
 material for the tube wall (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Fluid-BFSI-Materials"
nolink "false"

\end_inset

).
 The inner tube (the fluid domain) should be modeled as a 
\emph on
fluid-FSI
\emph default
 material (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-Fluid-FSI-Materials"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
In FEBio,
 a 
\emph on
fluid-FSI
\emph default
 material is modeled as a specialized fluid-solid mixture where the solid matrix density is zero and its stiffness should be set to a negligible value.
 In contrast,
 a 
\emph on
biphasic-FSI
\emph default
 material is a full-fledged fluid-solid mixture,
 where the solid may have mass and exhibit any desired nonlinear elastic or inelastic response.
 Both FSI materials require the user to define a 
\emph on
fluid
\emph default
 material from the same list as those available for CFD analyses (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fluids"
nolink "false"

\end_inset

).
 It also requires the user to define a 
\emph on
solid
\emph default
 material to regularize the mesh deformation,
 which may be selected from Sections
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Elastic-Solids"
nolink "false"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multigeneration-Solids"
nolink "false"

\end_inset

 for a 
\emph on
biphasic-FSI
\emph default
 material.
 In contrast,
 the 
\emph on
solid
\emph default
 material of a 
\emph on
fluid-FSI
\emph default
 material is massless (the 
\emph on
density
\emph default
 value entered by the user is ignored and reset internally to zero).
 Among all the choices available in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Elastic-Solids"
nolink "false"

\end_inset

,
 it is recommended to use the 
\emph on
neo-Hookean
\emph default
 elastic solid (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Neo-Hookean"
nolink "false"

\end_inset

),
 setting Poisson's ratio 
\begin_inset Formula $\nu$
\end_inset

 to zero and Young's modulus 
\begin_inset Formula $E$
\end_inset

 to a very low value (a few orders of magnitude smaller than the moduli of surrounding solid domains).
\end_layout

\begin_layout Standard
The degrees of freedom at each node of a FSI domain consist of the components of the solid displacement 
\begin_inset Formula $\mathbf{u}$
\end_inset

 (which describe the mesh deformation),
 the fluid velocity 
\begin_inset Formula $\mathbf{w}$
\end_inset

 relative to the solid,
 and the fluid dilatation 
\begin_inset Formula $e^{f}$
\end_inset

.
 Essential boundary conditions may be prescribed on any of these degrees of freedom.
 For example,
 in a moving boundary problem,
 the motion of a boundary may be prescribed by setting the relevant components of 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 A no-slip boundary between an FSI material and a solid domain may be defined by simply setting 
\begin_inset Formula $\mathbf{w}=\mathbf{0}$
\end_inset

,
 regardless of the motion of that boundary.
 In general,
 all boundary conditions described for CFD analyses in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-DOFs-BCs"
nolink "false"

\end_inset

 may be applied identically to FSI analyses.
\end_layout

\begin_layout Standard
Currently in FEBio,
 the mesh of a 
\emph on
fluid/biphasic-FSI
\emph default
 material domain must be continuous with the mesh of surrounding solid domains.
 The surface between domains,
 which consists of the shared faces of adjoining finite elements from each domain,
 is called the FSI interface.
 Because the mesh is continuous,
 the solid displacement and the solid component of the traction are automatically continuous across FSI interfaces;
 when fluid is present on both sides of the interface,
 the relative fluid flux is also automatically continuous.
 In other words,
 when two FSI domains are adjoining (e.g.,
 fluid-FSI with fluid-FSI,
 or fluid-FSI with biphasic-FSI),
 all boundary conditions are automatically satisfied across those interfaces.
 However,
 when an FSI domain interfaces with a solid domain,
 the fluid component of the traction in the 
\emph on
fluid-FSI
\emph default
 and 
\emph on
biphasic-FSI
\emph default
 domains must be explicitly transferred to the solid domain across that interface.
 This is done by prescribing a 
\emph on
fluid-FSI traction
\emph default
 or a 
\emph on
biphasic-FSI traction
\emph default
 on that interface (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-FSI-Traction"
nolink "false"

\end_inset

).
 This surface load does not require any user-defined parameters;
 its sole purpose is to identify those FSI interfaces where the fluid traction must be properly transferred to the surrounding solid domain.
 Omitting this boundary condition means that the fluid traction (i.e.,
 the fluid pressure and the normal and tangential viscous components of the fluid stress) have no effect on this interface;
 the interface may still deform in response to the motion of the solid domain.
 For example,
 when a fluid interacts with a rigid solid domain whose motion is entirely prescribed,
 it is not necessary to apply a 
\emph on
fluid-FSI traction
\emph default
 at the interface between the fluid and rigid solid domains.
\end_layout

\begin_layout Standard
A 
\emph on
fluid-FSI traction
\emph default
 is also required on free fluid surfaces,
 such as the surface of a fluid in open channel flow,
 in order to properly capture the motion of that surface (such as waves).
 This condition is required since the net traction 
\begin_inset Formula $\mathbf{t}$
\end_inset

 on a free surface is zero.
 As the fluid-FSI domain is modeled as a specialized solid-fluid mixture,
 the net traction consists of the sum of solid and fluid tractions,
 
\begin_inset Formula $\mathbf{t}=\mathbf{t}^{s}+\mathbf{t}^{f}$
\end_inset

.
 Setting 
\begin_inset Formula $\mathbf{t}$
\end_inset

 to zero produces a traction 
\begin_inset Formula $\mathbf{t}^{s}=-\mathbf{t}^{f}$
\end_inset

 on the solid mesh,
 allowing it to deform to the proper shape.
\end_layout

\begin_layout Standard
Here are a few cautionary notes to keep in mind when running FSI analyses:
 (1) Depending on the problem being analyzed,
 fluid-structure interactions may cause significant mesh deformations that lead to mesh distortion.
 Currently,
 adaptive meshing is not yet available to relieve this mesh distortion,
 therefore analyses and meshes need to be designed to minimize this effect or to terminate before the solution becomes too corrupted.
 (2) It is possible to pinch a solid domain that surrounds a fluid domain until the flow cross-section has reduced considerably;
 however it is not possible to completely shut off the flow,
 as this would require reducing the volume of some finite elements to zero.
 (3) While it is possible to model the deformation of free fluid surfaces,
 such as the formation of surface waves in open channel flow or the deformation of fluid blobs floating in a gravity-free environment,
 it is not possible to model the separation of such fluid domains into sub-domains such as spraying fluid droplets;
 this means that analyses where such phenomena are expected to happen will likely fail.
 (4) Whereas standard CFD analyses may be jump-started by prescribing a relatively large fluid velocity at the very first time step of an analysis,
 these types of boundary conditions may lead to dynamic oscillations and potential instabilities in an FSI analysis;
 therefore,
 users must be more considerate when prescribing boundary conditions for FSI analyses.
\end_layout

\begin_layout Subsection
Fluid-Solutes Analyses
\begin_inset CommandInset label
LatexCommand label
name "subsec:Fluid-Solutes-Analyses"

\end_inset


\end_layout

\begin_layout Standard
Fluid-solutes analyses introduce two types of molar fluxes into an analysis:
 (1) The diffusive molar flux 
\begin_inset Formula $\mathbf{j}_{d}^{\iota}=-\tilde{\kappa}^{\iota}d_{0}^{\iota}\grad\tilde{c}^{\iota}$
\end_inset

 and (2) the sedimentation flux 
\begin_inset Formula $\mathbf{j}_{b}^{\iota}=s^{\iota}c^{\iota}\mathbf{b}^{\iota}$
\end_inset

,
 where 
\begin_inset Formula $s^{\iota}\equiv d_{0}^{\iota}\frac{M^{\iota}}{R\theta}$
\end_inset

 is the sedimentation coefficient and 
\begin_inset Formula $\mathbf{b}^{\iota}$
\end_inset

 is the body force acting on solute 
\begin_inset Formula $\iota$
\end_inset

.
 These molar fluxes represent the flux of the solute relative to the solvent.
 The natural boundary condition for solutes is 
\begin_inset Formula $\tilde{j}_{n}^{\iota}=0$
\end_inset

,
 where 
\begin_inset Formula 
\begin{equation}
\tilde{j}_{n}^{\iota}=\left(\mathbf{j}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}^{\gamma}\right)\cdot\mathbf{n}\label{eq:normal-effective-solute-flux}
\end{equation}

\end_inset

is the normal component of the effective molar flux 
\begin_inset Formula $\mathbf{j}^{\iota}+\sum_{\gamma}z^{\gamma}\mathbf{j}^{\gamma}$
\end_inset

 on a boundary,
 with 
\begin_inset Formula $\mathbf{j}^{\iota}=\mathbf{j}_{d}^{\iota}+\mathbf{j}_{b}^{\iota}$
\end_inset

 representing the sum of diffusive and sedimentation fluxes.
 The effective molar flux is constructed in this manner to enforce the electroneutrality condition,
\begin_inset Formula 
\begin{equation}
\sum_{\iota}z^{\iota}c^{\iota}=0\label{eq:electroneutrality-condition}
\end{equation}

\end_inset

as also done in 
\begin_inset Quotes eld
\end_inset

multiphasic
\begin_inset Quotes erd
\end_inset

 analyses (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prescribed-Effective-Solute-Flux"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

).
\end_layout

\begin_layout Standard
Zero natural flux 
\begin_inset Formula $\tilde{j}_{n}^{\iota}$
\end_inset

 implies that the solute moves at the velocity of the solvent (the fluid).
 Therefore,
 if the fluid satisfies 
\begin_inset Formula $v_{n}^{f}=0$
\end_inset

 on that boundary,
 the solute will not transport across it.
 But if the fluid is allowed to transport across the boundary (e.g.,
 using a prescribed fluid pressure),
 the solute can also transport across the boundary via convection.
 Therefore,
 for open flows or flows through conduits,
 where the fluid pressure is prescribed (e.g.,
 set to zero) at an outlet boundary,
 no specific boundary condition needs to be prescribed on the solute in order for the latter to convect freely with the solvent at that outlet boundary.
 However,
 if the solvent exhibits back flow on that boundary in a manner that requires the application of the 
\emph on
fluid backflow stabilization
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Backflow-Stabilization"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) and 
\emph on
fluid tangential stabilization
\emph default
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Tangential-Stabilization"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) surfaces loads,
 then consider also using the 
\emph on
solute backflow stabilization
\emph default
 surface load (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Solute-Backflow-Stabilization"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

) on that boundary,
 to produce more physically-realistic solute flows on such truncated domains,
 and improve numerical convergence.
\end_layout

\begin_layout Standard
The fluid pressure 
\begin_inset Formula $p$
\end_inset

 in a fluid-solutes analysis is given by eq.
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:mp-effective-p-c"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
 To prescribe the fluid pressure 
\begin_inset Formula $p$
\end_inset

 on the boundary of a fluid-solutes domain,
 use the fluid pressure boundary condition specified in Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Fluid-Pressure-BC"
plural "false"
caps "false"
noprefix "false"
nolink "false"

\end_inset

.
\end_layout

\begin_layout Standard
By default,
 the fluid-solutes solver employs the 
\emph on
staggered
\emph default
 
\emph on
equation_scheme
\emph default
 format for the stiffness matrix,
 and solves for the nodal fluid velocity 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

,
 nodal dilatation 
\begin_inset Formula $e^{f}$
\end_inset

 and nodal effective solute concentrations 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

 using a 
\emph on
coupled
\emph default
 
\emph on
solve_strategy
\emph default
.
 This default settings works well when the Peclet number (the ratio of solute convective velocity to solute diffusive velocity) is relatively low (e.g.,
 less than 100).
 For these problems,
 using the default value of 
\emph on
ctol=0.01
\emph default
 is generally appropriate.
 However,
 if users notice significant convergence difficulties on the solute concentration as the Peclet number approaches 100 or greater,
 consider setting 
\emph on
ctol=0
\emph default
.
 When solving strongly convective solute transport problems with high Peclet numbers (e.g.,
 greater than 1000),
 diffusion will be negligible compared to convection.
 In that case,
 users should switch to 
\emph on
equation_scheme=block
\emph default
 and 
\emph on
solve_strategy=sequential
\emph default
 and set 
\emph on
ctol=0
\emph default
 to increase the chances of achieving a converged numerical solution.
 The rationale for these choices is explained in the FEBio journal article associated with this fluid-solutes solver 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim23"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
As done in the multiphasic solver,
 the solute volume fraction is considered negligible in fluid mixtures modeled in the fluid-solutes solver.
 Therefore,
 the volume of a fluid mixture will not change with increasing solute concentrations.
 When a solute is convected by the solvent,
 it means that the solvent exerts a frictional force on the solute,
 whose magnitude is inversely proportional to the solute diffusivity 
\begin_inset Formula $d_{0}^{\iota}$
\end_inset

.
 In the fluid-solutes solver,
 the acceleration of solutes is considered negligible,
 implying that the velocity of the solute in the solvent reaches its terminal velocity instantaneously (thus,
 inertial forces are negligible compared to the drag force between solute and solvent).
\end_layout

\begin_layout Standard
According to Newton's third law stating that every action force has an equal and opposite reaction force,
 the drag force exerted by the solvent on the solute is balanced by an equal and opposite reaction force exerted by the solute on the solvent.
 However,
 by default,
 this reaction force on the solvent is turned off in the fluid-solutes solver.
 In other words,
 the motion of the solvent affects that of the solute,
 but the motion of the solute does not affect the solvent.
 This default setting is adopted because it represent the common form of diffusion-reaction equations modeled in most of the mass transport literature.
 Therefore,
 when modeling solute diffusion problems in a stationary solvent (e.g.,
 in the absence of pressure or velocity-driven solvent flows),
 the diffusive flux of a solute will not drag the solvent,
 keeping it in a stationary state.
 When the solvent motion is driven by solute concentration gradients,
 we call it 
\emph on
osmosis
\emph default
.
 There is no common term describing solvent motion caused by solute sedimentation (motion of solute under the action of a body force),
 so we use the term 
\emph on
osmosis
\emph default
 to describe this phenomenon as well.
 Users can override the default setting of the fluid-solutes solver by checking the 
\emph on
include osmosis 
\emph default
box in the fluid-solutes material definition.
 When this box is checked,
 the solvent will have a force exerted on it by the solute (either due to diffusion or sedimentation,
 or both),
 causing it to move.
\end_layout

\begin_layout Standard
High-Peclet number flows are notoriously difficult to solve numerically.
 In FEBio we have reported valid solutions for a Peclet number as high as 
\begin_inset Formula $10^{11}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Shim23"
literal "false"

\end_inset

,
 thanks to the specific finite element formulation employed in the fluid-solutes solver,
 and the use of the sequential solver when needed.
 Nevertheless,
 the fluid-solutes solver is not fool-proof.
 In some problems,
 spurious increases in solute concentration can occur,
 seemingly randomly in the mesh,
 even when using a highly regular mesh.
 In many of these cases,
 this type of numerical artifact may go away by simply refining the mesh.
 However,
 users should be aware that this artifact may emerge 'silently',
 meaning that it does not necessarily produce slower numerical convergence that could hint at this problem.
\end_layout

\begin_layout Standard
The explanation for this behavior is that the numerical solutions to the effective solute concentrations at large Peclet numbers are effectively solutions to the partial differential equation 
\begin_inset Formula $D^{f}\left(J^{f}c^{\iota}\right)/Dt=0$
\end_inset

,
 as reviewed in the Theory Manual.
 This integration is performed based on the current solution for 
\begin_inset Formula $J^{f}=1+e^{f}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}^{f}$
\end_inset

 as well as the structure of the mesh.
 Any ill-conditioning in the mesh (such as a mesh which is too coarse) may introduce a numerical round-off error in the calculation of 
\begin_inset Formula $\tilde{c}^{\iota}$
\end_inset

,
 and there is no other sufficiently dominant term in the solute mass balance equation that can dampen or correct for such numerical round-offs.
 Thus,
 they may grow over time.
 Mesh refinements are required when encountering these circumstances.
\end_layout

\begin_layout Standard
Other boundary conditions for the solute (such as the essential boundary condition 
\begin_inset Formula $\tilde{c}^{\iota}=0$
\end_inset

) may also improve predictions when using relatively coarse meshes,
 preventing the occurrence of spurious rises which often initiate on boundaries.
 Unfortunately,
 in some problems,
 this option forces users to adopt a non-physical boundary condition which may produce unacceptable results.
 This workaround may not be needed when using a sufficiently refined mesh,
 though finer meshes typically require longer solution times.
 Also note that highly irregular meshes near no-slip boundaries may cause spurious rises in solute concentration in high Peclet number flows.
 Therefore,
 it is recommended to use suitable meshing techniques for generating boundary layer meshes,
 such as stacking pentahedral elements atop tetrahedral elements when using unstructured tetrahedral meshes.
 For diffusion-dominated or reaction-dominated flows however,
 these numerical concerns may not arise.
 Nevertheless,
 a thorough understanding of the underlying physics of these problems is essential for properly prescribing boundary conditions,
 and the number and size of time increments in a finite element analysis.
\end_layout

\begin_layout Standard
The default settings for the fluid-solutes solver force it to reform the stiffness matrix at the start of each time step.
 This is a standard requirement in most of the FEBio solvers (including solid and structural mechanics,
 and standard biphasic and multiphasic domains),
 though it had previously been demonstrated that the fluid solver could avoid reforming the stiffness matrix even after achieving convergence at a given time step,
 producing a very efficient computational scheme.
 Unfortunately,
 this increased efficiency is not always an option with the fluid-solutes solver,
 because the stiffness matrix contains terms that depend significantly on the solute concentrations.
 As these concentrations evolve over time and space,
 it becomes essential to update the stiffness matrix to reflect those changes.
 Therefore,
 consider using the direct sparse solver from the Intel MKL library (
\emph on
linear_solver=Mkl dss
\emph default
) to improve computational efficiency during matrix factorization,
 in comparison to the Pardiso solver from the same library.
 Moreover,
 in applications where the initial solute concentration is non-zero,
 and non-negligible compared to the prescribed change in concentration on an inlet boundary,
 it may be possible to solve a fluid-solutes problem more efficiently without reforming the stiffness matrix at each time step.
\end_layout

\begin_layout Section
Understanding the Solution
\begin_inset CommandInset label
LatexCommand label
name "sec:Understanding-the-Solution"

\end_inset


\end_layout

\begin_layout Standard
Okay,
 FEBio found a solution.
 Great,
 but how do you know it is the right one?
 Well,
 it turns out this is in fact a harder question than it may seem.
 In any finite element model there are numerous assumptions and approximations and trying to discuss all of these is outside the scope of this section.
 Instead,
 we'll look at some of the most typical problems that FEBio users have run into.
\end_layout

\begin_layout Subsection
Mesh convergence
\begin_inset CommandInset label
LatexCommand label
name "subsec:Mesh-convergence"

\end_inset


\end_layout

\begin_layout Standard
The solution calculated by FEBio only applies to the mesh for which it was solved.
 However,
 the 
\begin_inset Quotes eld
\end_inset

exact
\begin_inset Quotes erd
\end_inset

 solution must be independent of the mesh and therefore a mesh convergence study is almost always necessary to make sure the FEBio solution is close to this exact solution.
 In practice this means that a model must be run several times with an increasingly finer mesh to find out at which mesh density the FEBio solution no longer changes.
\end_layout

\begin_layout Subsection
Constraint enforcement
\begin_inset CommandInset label
LatexCommand label
name "subsec:Constraint-enforcement"

\end_inset


\end_layout

\begin_layout Standard
FEBio uses many iterative algorithms for enforcing constraints.
 For each of these contraints the user must verify that the solution indeed satisfies these constraints sufficiently.
 The two most common constraints used in FEBio are incompressibility and contact.
\end_layout

\begin_layout Standard
For uncoupled materials,
 incompressibility (for hexahedral elements) is handled in FEBio using a three-field formulation in addition to the enforcement of the incompressibility constraint.
 This constraint is usually enforced using a penalty formulation (although an augmented Lagrangian method is also available).
 To inspect whether the incompressibility constraint is satisfied sufficiently the user can look at the volume ratio which has to be close to one.
 If it deviates from one too much the user needs to increase the 
\begin_inset Quotes eld
\end_inset

bulk modulus
\begin_inset Quotes erd
\end_inset

 of the material.
\end_layout

\begin_layout Standard
For coupled materials,
 incompressibility is not treated explicitly and care must be taken when using coupled materials in a near-incompressible regime (e.g.
 setting the Poisson's ratio too close to 0.5 for a neo-Hookean material).
 In that case,
 the solution will most likely 
\begin_inset Quotes eld
\end_inset

lock
\begin_inset Quotes erd
\end_inset

 which manifests itself in displacements that are too small.
 Inspection of the volume ratio may not be sufficient to identify locking.
 However,
 a mesh convergence study will often help in identifying this problem.
\end_layout

\begin_layout Standard
When a contact constraint is not sufficiently enforced,
 the contacting surfaces will have penetrated.
 This problem is usually identified easily by looking at the deformed model in a post-processing software (e.g.
 PostView).
 Increasing the penalty factor and/or decreasing the augmented Lagrangian tolerance should solve this problem.
\end_layout

\begin_layout Section
Guidelines for Using Prestrain
\end_layout

\begin_layout Standard
There are a variety of ways in which prestrain can be added to an FEBio model,
 but the recommended approach  a two-step approach  is outlined here.
 
\end_layout

\begin_layout Standard
In the first step,
 the prestrain is enforced on the model.
 This is accomplished by making sure the part that will be prestrained uses the prestrain elastic material (or uncoupled prestrain elastic for uncoupled hyperelastic materials).
 A suitable prestrain generator must be defined as well.
 In addition,
 one of the update rules can be specified as a nonlinear constraint in order to modify the effective prestrain field.
 The boundary conditions in this step should be minimal but sufficient to ensure a well-defined finite element problem.
\end_layout

\begin_layout Standard
After the first step converges,
 the model is successfully prestrained.
 However,
 depending on the application,
 the reference geometry could have changed and this may complicate the application of further loads (most of FEBio will still use the original geometry as the reference geometry).
 To eliminate this potential source of confusion,
 it is recommended to apply the prestrain initial condition (see chapter 4) which essentially fixes the prestrain gradient and resets the reference geometry to the current geometry.
 FEBio will then apply any subsequent loads to this new reference geometry.
 One caveat of this approach is that the plotfile still stores the original reference geometry.
 To prevent inconsistencies in the plotfile it is recommend suppressing the creation of the plot file in the first step.
 This is done by setting the following control flag in the Control section of the first step.
 
\end_layout

\begin_layout LyX-Code
<plot_level>PLOT_NEVER</plot_level>
\end_layout

\begin_layout Standard
Then,
 in the Control section of the second step,
 restore the plot level value.
 
\end_layout

\begin_layout LyX-Code
<plot_level>PLOT_DEFAULT</plot_level>
\end_layout

\begin_layout Standard
Now,
 the new reference configuration resulting after the prestrain analysis step,
 will be the reference configuration that is used in the plot file.
 
\end_layout

\begin_layout Section
Guidelines for using the CG-solid solver
\end_layout

\begin_layout Standard
The nonlinear conjugate gradient solver,
 CG-solid,
 is an alternative solution algorithm for static solid mechanics problems.
 It does not currently support dynamic problems,
 fluids,
 etc.
 This solver has advantages in several situations:
 
\end_layout

\begin_layout Itemize
It uses much less memory and therefore allows bigger problems to be solved on a given computer than the standard Newton-based solvers
\end_layout

\begin_layout Itemize
Its performance scales better for large problems and it may be faster for very large problems (but see the limitations below);
 
\end_layout

\begin_layout Itemize
For nonlinear problems with buckling or other instabilities it can converge much more reliably than the standard solver;
 
\end_layout

\begin_layout Itemize
For many problems it will converge in a single timestep.
 
\end_layout

\begin_layout Standard
However,
 it also has some disadvantages:
 
\end_layout

\begin_layout Itemize
For small models it is typically slower than the BFGS solver;
 
\end_layout

\begin_layout Itemize
Although it usually converges in a single timestep,
 it requires a much larger number of iterations to do so.
 It is therefore inefficient if many timesteps are needed to produce intermediate results or follow the progression of a problem;
\end_layout

\begin_layout Itemize
The number of iterations it requires to converge is proportional to the number of elements across the longest dimension of the mesh.
 It therefore performs best for compact problems with similar numbers of elements in each direction.
 For example a cube with equal numbers of elements in each direction would solve much faster than a flat sheet or a long,
 thin beam with the same total number of elements;
 
\end_layout

\begin_layout Itemize
It does not currently work well for shell elements or freely moving rigid bodies.
 The way it works is quite different from the Newton-based solver and the problem may need to be defined differently for optimum results:
 
\end_layout

\begin_layout Itemize
The convergence criteria in FEBio measure the change in the solution on each iteration as a fraction of the total change for the timestep.
 Because the CG solver converges in a much larger number of smaller steps,
 the convergence criteria must be set smaller than for the BFGS solver.
 The default values are dtol=1e-6 and etol=0.001,
 but it may be necessary to reduce these further to ensure full convergence.
 Check the solution carefully to make sure that it is correct and reduce dtol further if necessary.
\end_layout

\begin_layout Itemize
The rate of convergence is quite slow near to the solution so if the convergence tolerance is set too small the solution may take much longer.
 
\end_layout

\begin_layout Itemize
It is usually best to use a single timestep if possible,
 rather than many smaller steps as is normal for the Newton solver.
 More timesteps will greatly increase the solution time.
 
\end_layout

\begin_layout Itemize
Unlike the Newton-based solvers,
 prescribed displacements are applied only to the nodes they affect at first and take many iterations to propagate through the adjoining mesh.
 This means that they can often cause excessive deformation of the adjacent elements,
 for example a compressive prescribed displacement can push the surface layer of nodes right through the adjoining elements causing a negative Jacobian error.
 Unlike the BFGS solver,
 where prescribed displacements often give more stable convergence,
 it is better to apply forces where possible and to avoid prescribed displacements.
 
\end_layout

\begin_layout Itemize
If prescribed displacements are essential,
 it may be necessary to use smaller timesteps to avoid excessive distortion of the adjoining elements.
 In this case it is possible to slacken the convergence criteria for the intermediate steps and then apply a tighter tolerance for the final step to generate a correct solution.
 
\end_layout

\begin_layout Itemize
The preconditioner improves convergence when the stiffness of the nodes varies,
 for example because of different element sizes,
 different materials or features such as quadratic elements with midside nodes.
 For problems where all the elements are the same it offers no great advantage and may even cause slower convergence in some cases.
 It is therefore best to use it for irregular meshes,
 multiple materials,
 quadratic elements and contact problems,
 but for problems with regular meshes where all the elements are a similar size it may be better to turn it off.
 
\end_layout

\begin_layout Itemize
For problems with large deformation and displacements the solver may take a very large number of iterations to converge.
 The solver proceeds by many small,
 cautious steps,
 unlike the Newton-based solvers,
 which attempt to jump straight to the final answer on each iteration.
 It is therefore much more reliable but may need thousands or tens of thousands of iterations to reach the solution.
 
\end_layout

\begin_layout Section
Limitations of FEBio
\begin_inset CommandInset label
LatexCommand label
name "sec:Limitations-of-FEBio"

\end_inset


\end_layout

\begin_layout Standard
If you run into a problem that you can't seem to solve,
 maybe you ran into a limitation of FEBio.
 This section discusses some important limitations of the software and how they may affect the outcome of your analysis.
\end_layout

\begin_layout Subsection
Geometrical instabilities
\begin_inset CommandInset label
LatexCommand label
name "subsec:Geometrical-instabilities"

\end_inset


\end_layout

\begin_layout Standard
A geometrical instability is a point in the solution at which several paths for continuing the solution are possible.
 Typical examples are buckling of a column.
 FEBio's Newton based solvers cannot handle buckling since usually at these points,
 the material's elasticity tangent is not uniquely defined.
 Although in some cases FEBio will be able to pass a buckling point,
 in most cases,
 FEBio will not be able to converge to a solution.
\end_layout

\begin_layout Subsection
Material instabilities
\begin_inset CommandInset label
LatexCommand label
name "subsec:Material-instabilities"

\end_inset


\end_layout

\begin_layout Standard
A material instability is a point in the stress-strain response where the slope of the stress-strain curve effectively becomes zero.
 Since FEBio's Newton based solvers use this slope to advance the solution,
 a zero slope would mean an infinite step and FEBio will not be able to continue.
\end_layout

\begin_layout Standard
The slope (or more accurately the elasticity tangent tensor) does not have to be zero to cause problems.
 For materials that soften at large deformations,
 this slope may become so small that it renders the global stiffness matrix ill-conditioned.
 It is unlikely that FEBio will be able to continue and even if it finds a solution,
 it may not be useful.
\end_layout

\begin_layout Subsection
Remeshing
\begin_inset CommandInset label
LatexCommand label
name "subsec:Remeshing"

\end_inset


\end_layout

\begin_layout Standard
FEBio is designed to solve problems that can undergo large deformations.
 However,
 when the deformations become too large it can happen that the finite element mesh cannot be distorted any further without inverting elements.
 In that case,
 FEBio will not be able to continue the solution and will most likely terminate with a negative jacobian error message.
\end_layout

\begin_layout Standard
One possible solution to this problem is to remesh the model at the point at which the deformation become too large,
 but currently FEBio does not have any remeshing capabilities.
 The only remedy at this point is to plan ahead and design your mesh in such a way that the elements will not invert in the range of deformation that you are interested in (e.g.
 place a butterfly mesh in sharp corners or make the mesh finer in areas of larger deformation).
\end_layout

\begin_layout Subsection
Force-driven Problems
\begin_inset CommandInset label
LatexCommand label
name "subsec:Force-driven-Problems"

\end_inset


\end_layout

\begin_layout Standard
When the primary method of deforming the model is a force,
 the problem is said to be force-driven.
 (Opposed to a displacement-driven model where the deformation is caused by displacement boundary conditions.) Force-driven forces are inherently unstable and FEBio has limited capabilities of handling such problems
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
 As of FEBio 2.0,
 some features are available that may help with this issue,
 but they are still experimental.
\end_layout

\end_inset

.
 The cause of this instability can easily be explained using a simple example.
 Imagine a box that is constrained in all directions except one.
 In the unconstrained direction,
 apply two equal but opposite forces on opposite faces.
 In order to prevent the box from flying away,
 the box must generate stresses which balance the applied forces exactly.
 Unfortunately,
 the numerical solution will only be approximate due to numerical round-off errors inherent in the calculation.
 Even the slightest deviation from balancing the forces exactly will create a net-force which in turn causes the model to fly off in the unconstrained direction (in which a rigid body mode now exists).
\end_layout

\begin_layout Standard
Usually,
 these problems are circumvented by adjusting the boundary conditions so that rigid body modes cannot exist.
 In the previous example this can be done by only modeling half of the box and enforcing a symmetry boundary condition.
 However,
 in some cases this is not possible.
 This is often the case in force-driven contact problems,
 where the contact interface is necessary to define a well-constrained model.
 When there is an initial separation (or even when the surfaces have no initial overlap) the initial contact force is zero,
 which is equivalent to having no contact enforcement,
 and thus the model is under-constrained.
 Therefore,
 for force-driven contact problems it is important to have some initial contact before starting the analysis.
\end_layout

\begin_layout Subsection
Solutions obtained on Multi-processor Machines
\begin_inset CommandInset label
LatexCommand label
name "subsec:Solutions-Multi-Processor"

\end_inset


\end_layout

\begin_layout Standard
Although technically not a limitation of FEBio it is important that users are aware that in some cases you may get a different convergence history or sometimes even a slightly different answer when you run the same model twice on a multi-processor machine.
 This is caused by the fact that on multi-processor machines the same calculations can be executed in a different order and due to the accumulation of numerical round-off errors may result in slightly different answers.
 The type of problems that are mostly affected by this are problems that are close too being ill-conditioned.
 Also,
 problems that have many time steps or require many iterations for each time step may be affected by this.
\end_layout

\begin_layout Standard
If you experience different answers for the same problem,
 try running the model on just one processor (if possible).
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Using-Multiple-Processors"
nolink "false"

\end_inset

 for more information on how to run FEBio on multi-processor machines.
\end_layout

\begin_layout Section
Where to Get More Help
\begin_inset CommandInset label
LatexCommand label
name "sec:Where-More-Help"

\end_inset


\end_layout

\begin_layout Standard
When you get here,
 you may be ready to pull all your hair out,
 but fret not,
 all is not lost.
 In fact,
 some people may have run into a similar issue and found a solution.
 The first place to find these people is on the FEBio user's forum (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
url{https://forums.febio.org/}
\end_layout

\end_inset

).
 This forum contains hundreds of posts by FEBio users and is monitored by the FEBio developers who will always be more than happy to help you with your problems.
 In addition,
 this forum can be used to report bugs or to request a new feature.
 It is the ideal portal to find help with your problems so don't hesitate to use it!
\end_layout

\begin_layout Chapter
Configuration File
\begin_inset CommandInset label
LatexCommand label
name "chap:Configuration-File"

\end_inset


\end_layout

\begin_layout Section
Overview
\end_layout

\begin_layout Standard
FEBio requires a configuration file to run.
 The purpose of this file is to store platform-specific settings such as the default linear solver.
 See Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Configuration-file"
nolink "false"

\end_inset

 for more information on how to use this file.
 This section details the format of this file.
\end_layout

\begin_layout Standard
The configuration file uses an xml format.
 The root element must be 
\shape italic
febio_config
\shape default
.
 The required attribute 
\shape italic
version 
\shape default
specifies the version number of the format.
 Currently this value must be set to 
\begin_inset Quotes eld
\end_inset

3.0
\begin_inset Quotes erd
\end_inset

.
 The following elements are defined.
\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace defskip
\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Description
\series default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
default_linear_solver
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the default linear solver for the platform (1) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
import
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Load a plugin file (2) 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
set
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
define an alias (3)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if_debug
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Process child tags only for debug versions of FEBio (4)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
if_release
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Process child tags only for release versions of FEBio (4)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
output_negative_jacobians
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output a detailed list of inverted elements when negative jacobians are encountered (5)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_model_params
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print the values of load controlled parameters at the start of each time step (6)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
show_warnings_and_errors
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print warnings and errors to the screen (7)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
Comments:
\end_layout

\begin_layout Enumerate
FEBio supports several linear solvers,
 such as Pardiso and Skyline.
 Not all solvers are available for all platforms.
 Only the Skyline solver is available for all platforms.
 As of version 1.2,
 the Pardiso solver is available on all platforms for which FEBio is distributed.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Configuring-Linear-Solvers"
nolink "false"

\end_inset

 on how to configure the linear solvers.
\end_layout

\begin_layout Enumerate
As of FEBio 2.0 the user can create and use plugins designed for FEBio.
 These plugins extend the standard capabilities without the need to recompile the FEBio code.
 See Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:FEBio-Plugins"
nolink "false"

\end_inset

 for more information on using plugins in FEBio.
 
\end_layout

\begin_layout Enumerate
As of FEBio 2.5 the configuration file supports aliases which can be used to define plugin paths.
 The 
\shape italic
set 
\shape default
tag defines an alias.
 The name of the alias is specified via the 
\shape italic
name 
\shape default
attribute.
 Aliases are accessed using the $(
\shape italic
name
\shape default
) syntax.
 See below for an example.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
if_debug/if_release
\emph default
 tags allow users to customize settings based on whether a debug or release version of FEBio is processing the configuration file.
 (Note that the debug version refers to how FEBio was compiled.
 It does not refer to the -g command line option.) The versions of FEBio distributed through the website are release versions.
 A debug version of FEBio can only be obtained by building FEBio with the _DEBUG preprocessor command.
 
\end_layout

\begin_layout Enumerate
When elements become inverted,
 FEBio prints an error message that 
\begin_inset Quotes eld
\end_inset

negative jacobians
\begin_inset Quotes erd
\end_inset

 are encountered.
 If you wish to see a detailed list of the inverted elements,
 you can set the 
\emph on
output_negative_jacobians
\emph default
 flag to 1.
\end_layout

\begin_layout Enumerate
The 
\emph on
print_model_params
\emph default
 parameter can be used to print values of load-controlled parameters to the screen and log file.
 If disabled,
 the values are not printed to the screen or log file.
 For models that use many load-controlled parameters this can be useful to reduce the amount of output generated by FEBio.
 By default,
 this parameter is on.
 
\end_layout

\begin_layout Enumerate
The 
\emph on
show_warnings_and_errors 
\emph default
parameter can be used to decide whether or not to print warning and error messages.
 The default value is on.
 
\end_layout

\begin_layout Standard
An example configuration file that sets the default linear solver to pardiso,
 defines an alias,
 and loads a plugin.
\end_layout

\begin_layout LyX-Code
<?xml version="1.0" encoding="ISO-8859-1"?>
\end_layout

\begin_layout LyX-Code
<febio_config version="3.0">
\end_layout

\begin_layout LyX-Code
  <default_linear_solver type="pardiso"/>
\end_layout

\begin_layout LyX-Code
  <set name="PluginsDir">C:
\backslash
path
\backslash
to
\backslash
plugins</set>
\end_layout

\begin_layout LyX-Code
  <import>$(PluginsDir)
\backslash
myplugin.dll</import>
\end_layout

\begin_layout LyX-Code
</febio_config>
\end_layout

\begin_layout Section
Configuring Linear Solvers
\begin_inset CommandInset label
LatexCommand label
name "sec:Configuring-Linear-Solvers"

\end_inset


\end_layout

\begin_layout Standard
FEBio offers several direct and iterative linear solvers that can be used to solve the linear system of equations of the FE model.
 Users can configure these linear solvers in the configuration file with the 
\family typewriter
default_linear_solver
\family default
 tag.
 The particular linear solver is selected via the 
\family typewriter
type
\family default
 attribute.
 The following table lists the possible values,
 the solver type,
 and the supported matrix format.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
solver
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
matrix format
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pardiso
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A sparse direct solver,
 from the MKL library.
 (default)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S/U
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
skyline
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A sparse direct solver,
 but not as efficient as pardiso.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mkl_dss
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The DSS solver from the MKL library.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S/U
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fgmres
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An implementation of the GMRES algorithm,
 from MKL .
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An implementation of the CG algorithm,
 from MKL .
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
boomeramg
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An algebraic multigrid solver,
 from the HYPRE library.
 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S/U
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
schur
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A block based iterative solver.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
It
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
accelerate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Apple-specific sparse solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
D/It
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S/U
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
D=direct solver,
 It=iterative solver,
 S = symmetric format,
 U = unsymmetric format,
 B = block format.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Iterative solvers can be configured with preconditioners,
 which attempt to reduce the condition number of the matrix.
 Preconditioning is highly recommended and often necessary for reducing the number of iterations needed by the iterative solver to converge the solution.
 Any of the linear solvers listed above can be used as a preconditioner.
 In addition,
 the following specialized preconditioners are also available.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
preconditioner
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
matrix format
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ilu0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Incomplete LU decomposition with no fill-in
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unsymmetric
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ilut
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Incomplete LU decomposition with custom fill-in
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unsymmetric
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ichol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Incompletly Cholesky decomposition with no fill-in
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diagonal
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Diagonal preconditioner made from the diagonal of the matrix
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
any
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The following sections describe each of these solvers and preconditioners in more detail.
\end_layout

\begin_layout Subsection
Pardiso
\end_layout

\begin_layout Standard
The Pardiso solver is an effecient sparse direct linear solver and is the default linear solver.
 FEBio uses the implementation from the MKL library.
 It does not require any configuration parameters.
 It can take symmetric,
 unsymmetric,
 and structurally symmetric sparse matrix formats.
 
\end_layout

\begin_layout Subsection
Skyline
\end_layout

\begin_layout Standard
The Skyline solver was initially added for users who build their own copy of FEBio and did not have access to third party linear solvers.
 It is a sparse direct solver,
 but not as efficient as Pardiso and not recommended for large problems.
 When using this solver,
 it is highly recommended to set the 
\family typewriter
optimize_bw
\family default
 flag in the model file's Control section,
 which attempts to minimize the matrix bandwidth.
 It does not require any configuration parameters and only works with symmetric matrices.
 
\end_layout

\begin_layout Subsection
MKL_DSS
\end_layout

\begin_layout Standard
The MKL library also offers another direct solver,
 called DSS (Direct-Sparse-Solver).
 This solver is very promising and appears to perform better for many problems than the pardiso solver.
 Currently,
 in FEBio4,
 pardiso remains the default mostly for backward compatibility reasons,
 but it is often worthwhile to see if the mkl_dss solver performs better.
 
\end_layout

\begin_layout Subsection
FGMRES
\end_layout

\begin_layout Standard
This iterative linear solver,
 from the MKL library,
 implements the GMRES algorithm,
 which is an efficient Krylov-based iterative solution strategy.
 It requires several configuration parameters,
 listed below,
 and only works with unsymmetric matrices.
 In the table below,
 
\series bold
N
\series default
 refers to the number of equations.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_iter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum number of iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
min(N,150)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative residual tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
abs_tol
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
absolute residual tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-12
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The amount of information printed (0,1,
 or 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail_max_iters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indicates whether reaching max iters is a failure or not (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 (true)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pc_left
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The left preconditioner
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pc_right
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The right preconditioner
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
When using FGMRES as a preconditioner it is recommended to set the fail_max_iters flag to zero.
 
\end_layout

\begin_layout Subsection
CG
\end_layout

\begin_layout Standard
This iterative linear solver,
 from the MKL library,
 implements the Conjugate Gradient algorithm,
 which is an efficient Krylov-based iterative solution strategy for symmetric systems.
 It requires several configuration parameters,
 listed below,
 and only works with symmetric matrices.
 In the table below,
 
\series bold
N
\series default
 refers to the number of equations.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_iter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum number of iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
min(N,150)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative residual tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The amount of information printed (0,1,
 or 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pc_left
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The left preconditioner
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(none)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
BoomerAMG
\end_layout

\begin_layout Standard
This solver,
 from the HYPRE library,
 is an adaptive multigrid solver.
 It often works better as a preconditioner to an iterative solver than as a stand-alone solver.
 
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="16" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_iter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum number of iterations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tol
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relative residual tolerance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The amount of information printed (0,1,
 or 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max_levels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The max number of multigrid levels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
coarsen_type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Method of grid coarsening
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(library default)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
use_num_funcs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use dimensionality of solution variable in coarsening
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relax_type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
relaxation type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
interp_type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
interpolation type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strong_threshold
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
strong threshold
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
p_max_elmts
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P max elements
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
num_sweeps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of sweeps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
agg_num_levels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Aggressive number of levels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodal
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nodal option
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
do_jacobi
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Do jacobi preconditioning
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fail_max_iters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fail on max iterations (1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 (true)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\emph on
Comments
\emph default
:
\end_layout

\begin_layout Enumerate
When using this solver as a preconditioner,
 it is recommended to set the fail_max_iters flag to 0.
 
\end_layout

\begin_layout Subsection
Schur
\end_layout

\begin_layout Standard
The Schur solver is a linear solver that takes a 2x2 block structured matrix and solves the linear system by decomposing it in its Schur-complement form.
 Thus,
 instead of solving the following system directly,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\begin{array}{cc}
A & B\\
C & D
\end{array}\right]\left[\begin{array}{c}
u\\
v
\end{array}\right]=\left[\begin{array}{c}
a\\
b
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
it first solves for v,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Sv=b-CA^{-1}a
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $S=D-CA^{-1}B$
\end_inset

 is the Schur complement of A.
 Then the Schur solver solves for u,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u=A^{-1}\left(a-Bv\right)
\]

\end_inset


\end_layout

\begin_layout Standard
In order to use this solver,
 users need to select how they wish to solve the A-block,
 and how to solve the Schur complement.
 For the A-block users can choose any of the linear solvers listed above,
 either direct or iterative.
 For the Schur complement users can only choose a Krylov-based iterative solver (FGMRES or CG) because FEBio does not form the Schur complement explicitly.
 
\end_layout

\begin_layout Standard
This solver is often more effective as a preconditioner for FGMRES.
 In this case,
 the A-block and Schur complement only need to be solved approximately.
 See the examples section below for some example configurations.
 This solver requires a block-structured matrix.
 In order to generate the block structure you need to set the 
\family typewriter
equation_scheme
\family default
 control parameter to 1 in the model input file.
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_level
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The amount of information printed (0,1,
 or 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
schur_block
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Take the Schur complement of A (=0) or D (=1)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
do_jacobi
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Do Jacobi preconditioning
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zero_D_block
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Is the D-block zero?
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A_solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The solver for the A-block (outside the Schur complement)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
user specified
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
schur_solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The iterative solver for solving Schur complement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
user specified
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
schur_A_solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The solver for the A block in the Schur complement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(same as A_solver)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Accelerate
\end_layout

\begin_layout Standard
The Accelerate sparse solver is only available on Apple computers (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://developer.apple.com/documentation/accelerate/sparse_solvers
\end_layout

\end_inset

).
 It uses the native Accelerate framework of Mac OS.
 It may be used as a direct solver or an iterative solver.
 Users should consult the Apple documentation to determine optimal settings for this solver,
 based on their application.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
parameter
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
default
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
print_condition_number
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Print the matrix condition number
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iterative
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use iterative solver
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 (false)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
factorization
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Factorization method (0 to 6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U:5=QR,
 S:4=DLTTPP
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
order_method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ordering algorithm (0 to 2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U:2=COLAMD,
 S:0=AMD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iterative_method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Iterative method (0 to 4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4=LSMR
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The factorization methods include:
 0=Cholesky,
 1=LDLT,
 2=LDLTUnpivoted,
 3=LDLTSBK,
 4=LDLTTPP ,
 5=QR,
 6=CholeskyAtA (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://developer.apple.com/documentation/accelerate/sparsefactorization_t
\end_layout

\end_inset

).
 The ordering algorithms include:
 0=AMD,
 1=Metis,
 2=COLAMD (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://developer.apple.com/documentation/accelerate/sparseorder_t
\end_layout

\end_inset

).
 The iterative methods include:
 0=ConjugateGradient,
 1=GMRES,
 2=DQGMRES,
 3=FGMRES,
 4=LSMR (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://developer.apple.com/documentation/accelerate/sparse_solvers/sparse_iterative_methods
\end_layout

\end_inset

).
\end_layout

\begin_layout Subsection
Examples
\end_layout

\begin_layout Standard

\series bold
Example 1.
 
\series default
The default pardiso solver is defined in the configuration file using the following syntax.
 It does not require any parameters.
\end_layout

\begin_layout LyX-Code
<default_linear_solver type="pardiso"/>
\end_layout

\begin_layout Standard

\series bold
Example 2.
 
\series default
This example shows how to set up the FGMRES solver with an ILU0 preconditioner.
 
\end_layout

\begin_layout LyX-Code
<default_linear_solver type="fgmres">
\begin_inset Newline newline
\end_inset

  <max_iter>100</max_iter>
\end_layout

\begin_layout LyX-Code
  <tol>1e-5</tol>
\end_layout

\begin_layout LyX-Code
  <pc_left type="ilu0"/>
\end_layout

\begin_layout LyX-Code
</default_linear_solver>
\end_layout

\begin_layout Standard

\series bold
Example 3.
 
\series default
This example sets up an FGMRES solver with a Schur preconditioner.
 For the Schur system we use pardiso for solving the A-block outside of the Schur complement and approximate the A-block inside the Schur complement with its diagonal.
 This solver requires a block-structured matrix.
 In order to generate the block structure you need to set the 
\family typewriter
equation_scheme
\family default
 control parameter to 1 in the model input file.
 
\end_layout

\begin_layout LyX-Code
<default_linear_solver type="fgmres">
\begin_inset Newline newline
\end_inset

 <print_level>2</print_level>
\begin_inset Newline newline
\end_inset

 <max_iter>100</max_iter>
\begin_inset Newline newline
\end_inset

 <tol>1e-5</tol>
\begin_inset Newline newline
\end_inset

 <abs_tol>1e-9</abs_tol>
\begin_inset Newline newline
\end_inset

 <pc_left type="schur">
\begin_inset Newline newline
\end_inset

   <print_level>0</print_level>
\begin_inset Newline newline
\end_inset

   <do_jacobi>0</do_jacobi>
\begin_inset Newline newline
\end_inset

   <A_solver type="pardiso"/>
\begin_inset Newline newline
\end_inset

   <schur_pc>0</schur_pc>
\begin_inset Newline newline
\end_inset

   <schur_A_solver type="diagonal"/>
\begin_inset Newline newline
\end_inset

   <schur_solver type="fgmres">
\begin_inset Newline newline
\end_inset

     <print_level>0</print_level>
\begin_inset Newline newline
\end_inset

     <max_iter>100</max_iter>
\begin_inset Newline newline
\end_inset

     <tol>0.05</tol>
\begin_inset Newline newline
\end_inset

     <fail_max_iters>0</fail_max_iters>
\begin_inset Newline newline
\end_inset

   </schur_solver>
\begin_inset Newline newline
\end_inset

  </pc_left>
\begin_inset Newline newline
\end_inset

 </default_linear_solver>
\end_layout

\begin_layout Chapter
FEBio Plugins
\begin_inset CommandInset label
LatexCommand label
name "chap:FEBio-Plugins"

\end_inset


\end_layout

\begin_layout Standard
As of version 2.0 FEBio supports plugins.
 Plugins are dynamic libraries that extend the capabilities of FEBio at runtime without the need to recompile the entire source code.
 This offers the user a powerful mechanism for extending the default feature set of FEBio with little effort.
 In addition,
 the development of the plugin is independent of the FEBio source code,
 which implies that upgrading to a newer version of FEBio will not require a recompilation of the plugin
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
When upgrading to a newer version of FEBio,
 it may be necessary to recompile the plugin if the plugin interface was changed.
 As long as the plugin remains compatible with the new interface,
 no code changes are required.
\end_layout

\end_inset

.
 Using plugins,
 users can create custom materials,
 boundary conditions,
 loads,
 output variables,
 etc.,
 and even couple FEBio to other codes.
\end_layout

\begin_layout Standard
The 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{https://help.febio.org/doxygen/html/index.html}{
\backslash
emph{FEBio Developer's 
\end_layout

\begin_layout Plain Layout

Manual}}
\end_layout

\end_inset

 explains in detail how to create these plugins.
 In this section we outline how to use the plugins with FEBio.
 
\end_layout

\begin_layout Section

\series bold
Using Plugins
\end_layout

\begin_layout Standard
A plugin is compiled into a dynamic library (dll or dylib) or shared object (so) and contains the compiled code of the library.
 In order to use this plugin,
 you must add the path to the plugin file in the FEBio configuration file (see Chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Configuration-File"
nolink "false"

\end_inset

 for a discussion of the configuration file).
 For each plugin,
 an 
\shape italic
import 
\shape default
item has to be added in this configuration file.
 For example,
\end_layout

\begin_layout LyX-Code
<import>myplugin.dll</import>
\end_layout

\begin_layout Standard
You may need to add the full path to the plugin if FEBio has problems locating the plugin.
\end_layout

\begin_layout LyX-Code
<import>C:
\backslash
path
\backslash
to
\backslash
my
\backslash
plugins
\backslash
myplugin.dll</import>
\end_layout

\begin_layout Standard
When FEBio starts,
 it will first load all the plugins that are defined in the configuration file before it reads the input file.
 This way,
 sections in the input file that require the plugin's capabilities will already be available for use.
\end_layout

\begin_layout Standard
An alternative way for loading a plugin is using the 
\series bold
-import
\series default
 command line option.
 
\end_layout

\begin_layout LyX-Code
>febio -i input.feb 
\series bold
-import myplugin.dll
\end_layout

\begin_layout Standard
In this example,
 FEBio will look for the file 
\emph on
myplugin.dll
\emph default
 in the current working directory.
 If the plugin file is located in a different folder than the current working directory,
 you must prepend the relative or absolute path to the file.
 Note that if the path contains spaces,
 you need to wrap it in quotes.
 
\end_layout

\begin_layout LyX-Code
>febio -i input.feb -import "C:
\backslash
path
\backslash
to
\backslash
my custom plugin
\backslash
myplugin.dll"
\end_layout

\begin_layout Section
Error Messages
\end_layout

\begin_layout Standard
If FEBio cannot find a plugin it will print an error message.
 There are several reasons why a plugin fails to load.
 Below is a list of possible error messages and some actions that can be taken to prevent the error.
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Failed to load the file
\begin_inset Quotes erd
\end_inset


\emph default
:
 Most likely FEBio cannot find the plugin file specified in the configuration file.
 Make sure that the file name including the path is correct and that there are no spaces at the start or end of the import tag's value string.
 
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Required plugin function PluginNumClasses not found
\begin_inset Quotes erd
\end_inset


\emph default
:
 The plugin is missing a required function that FEBio needs to communicate with the plugin.
 Notify the developer of the plugin to fix this.
 
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Required plugin function PluginGetFactory not found
\begin_inset Quotes erd
\end_inset


\emph default
:
 The plugin is missing a required function that FEBio needs to communicate with the plugin.
 Notify the developer of the plugin to fix this.
 
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Invalid number of classes returned by PluginNumClasses
\begin_inset Quotes erd
\end_inset

:

\emph default
 There was a problem with the plugin's innitialization.
 Notify the developer of the plugin to fix this.
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Required plugin function GetSDKVersion not found
\begin_inset Quotes erd
\end_inset


\emph default
:
 The plugin is missing a required function that FEBio needs to communicate with the plugin.
 Notify the developer of the plugin to fix this.
\end_layout

\begin_layout Itemize

\emph on
\begin_inset Quotes eld
\end_inset

Invalid SDK version
\begin_inset Quotes erd
\end_inset


\emph default
:
 The plugin was compiled with a version of the SDK that is not compatible with the current FEBio version.
 This most likely means that the plugin must be rebuilt with a newer version of the SDK.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Chapter
\start_of_appendix
Heterogeneous model parameters
\end_layout

\begin_layout Standard
Many model parameters can be made dependent on the reference coordinates.
 This is useful,
 for instance,
 for defining inhomogeneous materials,
 where some material parameters depend on the spatial position.
 
\end_layout

\begin_layout Standard
There are two mechanisms for creating heterogeneous parameters:
 a mathematical expression,
 or a map.
 The type of the parameter is set via the 
\emph on
type 
\emph default
attribute,
 which can take on two values.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
type
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
math
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Define a math parameter via a mathematical expression
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
map
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Define a mapped parameter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
const
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Define a constant parameter (default)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
The two types of parameters are described in more detail in the sections below.
 
\end_layout

\begin_layout Standard
The 
\emph on
type 
\emph default
attribute can be omitted.
 In that case,
 it is assumed to be a const parameter,
 unless the tag's value is not a number.
 In that case,
 it is assumed to be a math parameter.
 
\end_layout

\begin_layout Standard
FEBio performs parameter validation at the start of an analysis where the values of parameters are checked against the valid ranges as defined in the code.
 However,
 it is important to keep in mind that this validation is only performed on constant parameters.
 For math and map parameters,
 it is up to the user to ensure that all values over the relevant mesh partition are valid.
 
\end_layout

\begin_layout Section
Math parameters
\end_layout

\begin_layout Standard
For math parameters,
 add the type=
\begin_inset Quotes erd
\end_inset

math
\begin_inset Quotes erd
\end_inset

 attribute to the parameter's definition.
 The value of the parameter tag can then be any mathematical expression.
 The upper case letters X,
 Y,
 Z,
 are used to denote material coordinates.
 The letter 
\emph on
t
\emph default
 denotes time.
 The algebraic operators +,
 -,
 *,
 /,
 ^ are supported,
 as well as the list of functions listed in Appendix C.
 
\end_layout

\begin_layout LyX-Code
<material id="1" name="my_material" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E 
\series bold
type="math"
\series default
>X+Y+Z</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
You can also use the component's other parameters inside mathematical expressions.
 
\end_layout

\begin_layout LyX-Code
<material id="1" name="my_material" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <density>1.0</density>
\end_layout

\begin_layout LyX-Code
  <E 
\series bold
type="math"
\series default
>2*density+0.1</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The names of maps are also allowed in mathematical expressions.
 For instance,
 assume that a map,
 named 
\begin_inset Quotes eld
\end_inset

E_map
\begin_inset Quotes erd
\end_inset

 is defined in the MeshData section.
 Then the following is a valid mathematical expression.
 
\end_layout

\begin_layout LyX-Code
<E 
\series bold
type="math"
\series default
>2*E_map+X</E>
\end_layout

\begin_layout Section
Mapped parameters
\end_layout

\begin_layout Standard
For mapped parameters,
 use the attribute type=
\begin_inset Quotes eld
\end_inset

map
\begin_inset Quotes erd
\end_inset

.
 In this case,
 the value of the parameter is the name of the map that is defined in the MeshData section.
 
\end_layout

\begin_layout LyX-Code
<material id="1" name="my_material" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E 
\series bold
type="map"
\series default
>map_E</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Standard
The map is defined in the MeshData section.
 
\end_layout

\begin_layout LyX-Code
<ElementData name="map_E" elem_set="Part1">
\end_layout

\begin_layout LyX-Code
  <elem lid="1">1.23</elem>
\end_layout

\begin_layout LyX-Code
  <elem lid="2">4.56</elem>
\end_layout

\begin_layout LyX-Code
</ElementData>
\end_layout

\begin_layout Standard
Note that it is also possible to use maps in mathematical expressions.
 
\end_layout

\begin_layout LyX-Code
<material id="1" name="my_material" type="neo-Hookean">
\end_layout

\begin_layout LyX-Code
  <E type="math">5.0*map_E</E>
\end_layout

\begin_layout LyX-Code
  <v>0.3</v>
\end_layout

\begin_layout LyX-Code
</material>
\end_layout

\begin_layout Chapter
Referencing Parameters
\end_layout

\begin_layout Standard
This appendix details how that model parameters can be referenced in the FEBio input files.
 This is used to
\end_layout

\begin_layout Itemize
write model parameters to the output file.
\end_layout

\begin_layout Itemize
reference model parameters in the parameter optimization input file.
 
\end_layout

\begin_layout Standard
The general format follows the following rule:
\end_layout

\begin_layout LyX-Code
fem.property.property...property.parameter.component
\end_layout

\begin_layout Standard
Properties and parameters are referenced by tags separated by a periods.
 The first tag must be the 
\emph on
fem
\emph default
 tag,
 which serves as the name of the model.
 (In future version this name can be user defined,
 but for now is fixed).
 Next,
 the name of a model property must follow.
 The following properties are currently defined:
\end_layout

\begin_layout Itemize

\series bold
material
\series default
:
 references a material,
 defined in the 
\emph on
Material 
\emph default
section.
\end_layout

\begin_layout Itemize

\series bold
bc_fixed
\series default
:
 references a fixed bc,
 defined in the 
\emph on
Boundary
\emph default
 section.
\end_layout

\begin_layout Itemize

\series bold
bc_prescribed
\series default
:
 references a prescribed bc,
 defined in the 
\emph on
Boundary
\emph default
 section.
\end_layout

\begin_layout Itemize

\series bold
nodal_load
\series default
:
 references a nodal load,
 defined in the 
\emph on
Loads
\emph default
 section.
\end_layout

\begin_layout Itemize

\series bold
surface_load
\series default
:
 references a surface load,
 defined in the 
\emph on
Loads
\emph default
 section.
\end_layout

\begin_layout Itemize

\series bold
body_load
\series default
:
 references a body load,
 define in the 
\emph on
Loads
\emph default
 section.
\end_layout

\begin_layout Itemize

\series bold
rigid_body
\series default
:
 references a rigid body.
 Rigid bodies are defined implicitly via rigid materials.
 
\end_layout

\begin_layout Standard
All of these properties define arrays.
 A specific property can be referenced via square brackets.
 For instance,
 to reference the first material in the model,
 do this
\end_layout

\begin_layout LyX-Code
fem.material[0]
\end_layout

\begin_layout Standard
Alternatively,
 a property can also be reference by name or by ID.
 In either case,
 use round brackets.
 For instance,
 to reference by ID,
 do
\end_layout

\begin_layout LyX-Code
fem.material(1)
\end_layout

\begin_layout Standard
The ID refers to the 
\begin_inset Quotes eld
\end_inset

id
\begin_inset Quotes erd
\end_inset

 attribute that can be specified for most model components.
 To reference by name,
 
\end_layout

\begin_layout LyX-Code
fem.material('MyMaterial')
\end_layout

\begin_layout Standard
Note the single quotes around the material name.
 The name is defined via the 
\begin_inset Quotes eld
\end_inset

name
\begin_inset Quotes erd
\end_inset

 attribute.
\end_layout

\begin_layout Standard
Note that rigid bodies can only be referenced via their material name.
\end_layout

\begin_layout LyX-Code
fem.rigidbody('MyRigidMaterial')
\end_layout

\begin_layout Standard
Each property can have a list of parameters and sub-properties.
 To reference a parameter,
 just end the reference string with the name of the parameter.
 For example,
\end_layout

\begin_layout LyX-Code
fem.material[0].E
\end_layout

\begin_layout Standard
Sub-properties are referenced similarly.
 For example,
 assume that the first material is a biphasic material that defines the solid property.
 
\end_layout

\begin_layout LyX-Code
fem.material[0].solid.E
\end_layout

\begin_layout Standard
If the parameter itself is an array,
 a specific item in the array is referenced using square brackets.
 For example,
 for an EFD-neo Hookean material,
 
\end_layout

\begin_layout LyX-Code
fem.material[0].ksi[0]
\end_layout

\begin_layout Standard
In cases where the model parameter does not define a scalar it is possible to reference the components of the parameter.
 For instance,
 a vec3 parameter defines an x,
 y,
 and z component.
\end_layout

\begin_layout LyX-Code
fem.body_load[0].force.x
\end_layout

\begin_layout Standard
Nodal positions can also be referenced using the 
\emph on
mesh 
\emph default
property.
 
\end_layout

\begin_layout LyX-Code
fem.mesh.node[0].position.x
\end_layout

\begin_layout Standard
In certain applications (e.g.
 optimization),
 it is also possible to reference output data,
 i.e.
 data that is normally used in the logfile section of the input file.
 This data is considered read-only.
 For example,
 the following references the 'sx' (xx-stress) of element with id 1.
 
\end_layout

\begin_layout LyX-Code
fem.element_data('sx',
 1)
\end_layout

\begin_layout Standard
Another example evaluates the enclosed volume of a surface (assuming the surface is closed).
 
\end_layout

\begin_layout LyX-Code
fem.surface_data('volume',
 'SomeSurface1')
\end_layout

\begin_layout Chapter
Math Expression
\end_layout

\begin_layout Standard
Many model parameters can be defined via mathematical expression.
 This appendix documents the syntax of this capability.
 
\end_layout

\begin_layout Section
Functions
\end_layout

\begin_layout Standard
The following functions are currently supported.
 
\end_layout

\begin_layout Description
sin(x) The sine function.
\end_layout

\begin_layout Description
cos(x) The cosine function
\end_layout

\begin_layout Description
tan(x) The tangent function
\end_layout

\begin_layout Description
csc(x) The cosecans function
\end_layout

\begin_layout Description
sec(x) The secans function
\end_layout

\begin_layout Description
cot(x) The cotangent function
\end_layout

\begin_layout Description
acos(x) The arccosine function
\end_layout

\begin_layout Description
asin(x) The arcsine function
\end_layout

\begin_layout Description
cosh(x) The hyperbolic cosine function
\end_layout

\begin_layout Description
sinh(x) The hyperbolic sine function
\end_layout

\begin_layout Description
tanh(x) The hyperbolic tangent function
\end_layout

\begin_layout Description
ln(x) The natural logarithm
\end_layout

\begin_layout Description
log(x) The logarithm with base 10
\end_layout

\begin_layout Description
exp(x) The exponential function
\end_layout

\begin_layout Description
sqrt(x) The square root function
\end_layout

\begin_layout Description
abs(x) The absolute value function
\end_layout

\begin_layout Description
sgn(x) The sign function
\end_layout

\begin_layout Description
H(x) The Heaviside function (x = 0.5 at zero)
\end_layout

\begin_layout Description
step(x) The right-continuous unit step function 
\end_layout

\begin_layout Description
J0(x) Bessel function of the first kind,
 order 0
\end_layout

\begin_layout Description
J1(x) Bessel function of the first kind,
 order 1
\end_layout

\begin_layout Description
Jn(x,n) Bessel function of the first kind,
 order 
\emph on
n
\end_layout

\begin_layout Description
Y0(x) Bessel function of the second kind,
 order 0
\end_layout

\begin_layout Description
Y1(x) Bessel function of the second kind,
 order 1
\end_layout

\begin_layout Description
Yn(x,n) Bessel function of the second kind,
 order 
\emph on
n
\end_layout

\begin_layout Description
sinc(x) The 
\emph on
sinc
\emph default
 function (i.e.
 sin(x)/x) 
\end_layout

\begin_layout Description
fac(n) The factorial of 
\emph on
n
\end_layout

\begin_layout Description
erf(x) The 
\emph on
error
\emph default
 function
\end_layout

\begin_layout Description
erfc(x) The complementary error function (erfc(x) = 1 - erf(x))
\end_layout

\begin_layout Description
tgamma(x) The 
\emph on
Gamma
\emph default
 function
\end_layout

\begin_layout Description
atan2(x,y) The two-parameter arctangent function
\end_layout

\begin_layout Description
pow(x,y) The y-th power of x
\end_layout

\begin_layout Description
Tn(n,x) The Chebyshev polynomial of order 
\emph on
n
\end_layout

\begin_layout Description
binomial(n,m) The binomial of (n,m)
\end_layout

\begin_layout Description
max(x1,...,xn) Returns the maximum value of the values listed
\end_layout

\begin_layout Description
min(x1,...,xn) Returns the minimum value of the values listed
\end_layout

\begin_layout Description
avg(x1,...,xn) Returns the average value of the values listed
\end_layout

\begin_layout Section
Constants
\end_layout

\begin_layout Standard
The following predefined constants are supported:
\end_layout

\begin_layout Description
pi The value of pi ( = 3.1415926535897932385)
\end_layout

\begin_layout Description
e The value of exp(1) (= 2.7182818284590452354)
\end_layout

\begin_layout Description
gamma The Euler-Mascheroni constant (= 0.57721566490153286061)
\end_layout

\begin_layout Description
_inf_ A very large number (= 1e308)
\end_layout

\begin_layout Chapter
FEBio Binary Database Specification
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
This appendix describes the structure of the FEBio binary database (more commonly referred to as the FEBio plot file),
 which stores the results of a FEBio analysis.
 The FEBio binary database format is both self-describing and extendible.
 A user can understand the contents of the file by simply parsing the block structure of the file.
 The file format is made extendible by providing an abstract layer between the data and the file system.
 This layer defines the file structure as a hierarchy of data blocks.
 The result is that each file is now structured similarly as a file folder.
 Each block can be viewed as a file in the folder and each branch in the hierarchy as a sub-folder.
\end_layout

\begin_layout Standard
The database consists of four parts:
 
\end_layout

\begin_layout Enumerate
the 
\series bold
header 
\series default
contains some general info that may be useful for parsing the rest of the file.
 
\end_layout

\begin_layout Enumerate
the 
\series bold
dictionary 
\series default
presents a textual description for each data field in the file.
 This can be used to identify the contents of each data field.
 
\end_layout

\begin_layout Enumerate
the 
\series bold
mesh section 
\series default
defines the mesh of the model.
 
\end_layout

\begin_layout Enumerate
the 
\series bold
state sections 
\series default
contain the actual data or results for the field variables.
 
\end_layout

\begin_layout Standard
The following sections describe the details of the database format.
 In the next section,
 the block-structure of the file is explained.
 The sections thereafter describe the different parts of the database.
 
\end_layout

\begin_layout Subsection
Changes in this version
\end_layout

\begin_layout Standard
This appendix describes version 3.0 of the binary database format.
 This version of the FEBio Binary Database Specification differs in a few important aspects from the previous version.
 It addresses the following issues:
 
\end_layout

\begin_layout Standard
 Reduce plot file size by describing rigid bodies via rigid body mechanics.
 
\end_layout

\begin_layout Standard
 Reduce plot file size by identifying non-mutable data,
 which is data that that does not change in different states.
 
\end_layout

\begin_layout Standard
 Add support for more generic objects that may not be represented via the mesh.
 In FE simulations,
 additional structures can be present that interact with the FE parts,
 but are themselves not part of the FE mesh.
 Examples are rigid bodies and the various mechanisms to connect rigid bodies (e.g.
 springs,
 joints,
 etc.).
 
\end_layout

\begin_layout Standard
 The State section was modified so that the position of non-rigid nodes is redefined in each section.
 
\end_layout

\begin_layout Section
Block Structure
\end_layout

\begin_layout Subsection
Overview
\end_layout

\begin_layout Standard
The FEBio binary database uses an abstract layer to communicate with the file system.
 This achieves two goals.
 The first is that the content of a file becomes independent of the file system that wrote the file.
 Big endian systems can read files created with small endian systems and vice versa.
 The second goal is that the data is now stored in a hierarchical structure which is easy to search and modify.
 This means that future additions and changes can be made fairly easily without losing backward compatibility.
 In addition,
 the self-describing feature of the format even allows for some forward compatibility.
\end_layout

\begin_layout Standard
As mentioned above,
 the file is structured as a hierarchy of blocks.
 Each block consists of three fields:
 a DWORD identifier,
 followed by a DWORD containing the size of the data chunk in bytes and then the actual data.
 (A DWORD is a double word meaning an unsigned integer of 4 bytes.)
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigAppendixD_fig1.png

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Each block in the plot file consists of three fields:
 a DWORD with an identifier,
 a DWORD containing the size of the block and finally the data of the block,
 which can be child blocks.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This data may be either numeric data (such as the data of a field variable) or child blocks.
 If the block has children,
 it is referred to as a 
\emph on
branch
\emph default
.
 If the block only contains numeric data,
 it is referred to as a 
\emph on
leaf
\emph default
.
\end_layout

\begin_layout Subsection
Parsing the FEBio plot file
\end_layout

\begin_layout Standard
Although the FEBio plot file in essence is a hierarchy of blocks as described above,
 there are a few more caveats that are important for parsing the FEBio file.
 
\end_layout

\begin_layout Standard
The first DWORD of the file is a tag that identifies the FEBio plot file.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FEBio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x00464542
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FEBio identifier tag
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The first tag of the plot file is an identifier that can be used to see if the file is indeed an febio plot file.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Parsers should read this number and use it to identify whether the file is indeed a proper FEBio plot file.
 If the value differs,
 then that means that the file is either not a valid plot file,
 or that the endianness of the system that wrote the file is different than that of the system that is reading the file.
 In the latter case,
 a byte swap will be necessary when reading data from the file.
\end_layout

\begin_layout Standard

\series bold
\emph on
NOTE:
 Note that the FEBio tag is not followed by a size tag.
 The reason is that when FEBio is writing the file it does not know the length of the final file yet.
\end_layout

\begin_layout Standard
After the FEBio tag,
 the content of the file follows,
 organized in the hierarchical block structure described above.
 At the highest level,
 the plot file has a single root block,
 followed by a mesh block and a series of state blocks.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
TAG
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ROOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Root block of FEBio plot file
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MESH
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01040000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mesh block containing the mesh definition
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STATE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02000000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
State block containing results of a single time step
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The overall structure of the plot file consistes of a root section,
 a mesh section,
 and multiple state sections.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
After the root block,
 the mesh section follows which defines the mesh of the model.
 Then,
 at least one state blocks follow.
 There will be one state block for each time step in the FEBio plot file.
 Note that these blocks are not child blocks of the root block.
 In the following figure,
 the high-level structure of the FEBio plot file is depicted for a file that has two state blocks.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigAppendixD_fig2.png

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example structure for a plot file containing a root section and two data sections.
 Each section is composed of three fields.
 A DWORD containing the section ID,
 followed by a DWORD containing the size of the section block and finally the actual data (which may be child blocks).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As explained above,
 the first DWORD will be the FEBio identifier.
 The first block in the file will always be the ROOT block,
 which will contain the header and dictionary.
 Then,
 the mesh section follows,
 which defines the mesh.
 After that,
 the state blocks follow,
 which will contain the actual results.
 Each block has three fields.
 The first field is a DWORD,
 identifying the section.
 For the first block,
 this will be ROOT,
 for the second block this will be MESH,
 and for the other blocks this will be STATE.
 The next DWORD is the size of the entire block.
 Finally,
 the actual data will follow,
 which for the ROOT,
 MESH and STATE blocks will contain child blocks.
\end_layout

\begin_layout Section
Root Section
\end_layout

\begin_layout Standard
The ROOT section is the first block in the file.
 This block contains the 
\emph on
header
\emph default
 and 
\emph on
dictionary
\emph default
 sections as child blocks.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01010000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contains the header section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DICTIONARY
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
contains the dictionary section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The Root section has two child sections,
 the 
\emph on
header 
\emph default
and the 
\emph on
dictionary 
\emph default
sections.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
These sections will be detailed below.
\end_layout

\begin_layout Subsection
Header Section
\end_layout

\begin_layout Standard
The first section of the root block is the header section.
 It stores the following data:
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VERSION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01010001
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
version of the file format
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
COMPRESSION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01010004
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compression flag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AUTHOR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01010005
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Author name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SOFTWARE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01010006
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Software that generated this file
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Header Section
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Currently,
 the VERSION will always be 0x0008.
 The COMPRESSION flag indicates whether the mesh and state sections are compressed or not.
 Data compression is an optional feature for plot files,
 and will not be discussed in this document.
 The AUTHOR contains the name of the person who created the file.
 The SOFTWARE tag contains the name of the software that generated the file.
 (Note that not all header data might be present in a plot file.
 For instance,
 as of FEBio3,
 the AUTHOR tag is not written to the plot file.) 
\end_layout

\begin_layout Subsection
Dictionary Section
\end_layout

\begin_layout Standard
When running a FEBio analysis,
 FEBio will store the values of certain user-selected variables (e.g.
 stress,
 temperature,
 fluid pressure,
 etc.) to the plot file.
 In order for a parser to know which variables were written,
 it needs to read the dictionary section.
 This section stores a list of variables,
 including their names,
 which are stored in the plot file.
 Specifically,
 three attributes are stored for each data variable:
 a name that provides a description of the data,
 the data type (scalar,
 vector,
 tensor) and the storage format.
 In addition,
 the variables are grouped by category.
 Data variables can be defined for node sets,
 domains (element sets) and surfaces.
 In addition,
 global variables (which are not associated with any part of the model) can also be defined.
 Each of these categories has their own sub-section in the dictionary.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GLOBAL_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01021000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lists global data in model
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODESET_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01023000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lists data associated with the node sets
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOMAIN_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01024000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lists data associated with domains
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01025000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lists data associated with surfaces
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Dictionary Section
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that all of these sections are optional.
 For example,
 if a model does not define global data,
 that section will not be part of the plot file.
\end_layout

\begin_layout Standard
Each of these sub-sections defines a list of dictionary items defined by the following tag.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DICTIONARY_ITEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of dictionary item
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The dictionary consists of 
\emph on
dictionary items
\emph default
.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each dictionary item contains three fields.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM_TYPE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
type of data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM_FORMAT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020003
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
storage format of data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM_NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020004
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
textual description of data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM_ARRAY_SIZE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020005
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size of array variables
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM_ARRAY_NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01020006
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name of array variable
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Structure of dictionary item.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The ITEM_ARRAY_SIZE and ITEM_ARRAY_NAME are only used for array variables.
 The ITEM_ARRAY_SIZE defines the number of data items in the array.
 For each data item,
 the ITEM_ARRAY_NAME defines an optional name for that item.
 
\end_layout

\begin_layout Standard
The type of the data can be any of the following values.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ITEM_TYPE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
VALUE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FLOAT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
single precision (s.p.) floating point
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VEC3F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3D vector of s.p.
 floats (stored in x,
 y,
 z order)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MAT3FS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric 2nd order tensor of s.p.
 floats (stored in xx,
 yy,
 zz,
 xy,
 yz,
 xz order)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MAT3FD
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
diagonal matrix of s.p.
 floats (stored in xx,
 yy,
 zz order).
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TENS4FS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
symmetric fourth-order tensor of s.p.
 floats.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MAT3F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3x3 matrix of floats (stored in row order).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ARRAY_FLOAT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Array of floats.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ARRAY_VEC3F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Array of vec3f.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The supported data types.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
As explained below,
 data will be stored for different regions of the mesh,
 where a region can be a node set,
 a surface,
 or a domain (element set).
 A region is composed of items where an item is a single shape in the region.
 For node sets,
 an item will refer to a node,
 for surfaces this will be a facet and for domains an item will refer to an element.
 The storage format defines how many values are written for each region and how the values relate to the geometry of the region or items.
 The following values are currently defined.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ITEM_FORMAT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
VALUE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
one value for each node of the region
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ITEM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
one value for each item
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MULT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
one value for each node for each item
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The different storage format identifiers.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The easiest format to understand is the ITEM format which simply stores one value for each item of the region.
 Thus,
 one value for each node or for each facet or for each element,
 depending on the region type.
 The MULT format defines a value for each node of each item.
 For example,
 for a surface of quads,
 the data will contain four values for each facet,
 one for each of the four nodes.
 The NODE format stores a single value for each node of the region.
 Each type of region (node set,
 surface,
 or domain) implicitly also defines a set of nodes,
 namely all the nodes that are part of that region.
 With the NODE format,
 the user defines a single value for each of the nodes in this implicit node set.
 This will be explained in more detail below in the state section.
 
\end_layout

\begin_layout Standard
Note that the storage formats are only important for surfaces and domains.
 For other categories (e.g.
 node sets),
 all formats are essentially equivalent,
 and can safely be ignored.
 
\end_layout

\begin_layout Section
Mesh Section
\end_layout

\begin_layout Standard
The Mesh section defines the mesh of the model and its decomposition into separate regions.
 A region can be a node set,
 a surface (i.e.
 facet set),
 or a domain (element set).
 The mesh section is defined by the following sub-sections.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE_SECTION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of node section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOMAIN_SECTION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of domain section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE_SECTION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of surface section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODESET_SECTION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of node set section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PARTS_SECTION
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01045000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of parts section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The child sections of the 
\emph on
Mesh 
\emph default
section.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Node Section
\end_layout

\begin_layout Standard
The NODE section defines a set of nodes of the mesh.
 Each node section starts with a NODE_HEADER followed by a NODE_COORDS section.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE_HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
node header
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE_COORDS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
node data list
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Node section consists of a header and a list of coordinates.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The header contains the following information.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041101
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
number of nodes (N) in this NODE section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DIM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041102
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dimension of node set (i.e.
 nr.
 of coords)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01041103
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
name of node set.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The header of the Node section.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The NODES parameter defines the number of nodes defined in this section.
 The DIM parameter sets the number of coordinates that will be defined for each node (e.g.
 3 for 3D problems).
 Each NODE section also implicitly defines a node set.
 The NAME attribute defines the name of this node set.
\end_layout

\begin_layout Standard
Then the NODE_COORDS section follows,
 which defines the nodal data for each node.
 This data field stores the nodal IDs and coordinates for all the nodes in the mesh.
 The size of the field is defined by N*DWORD + DIM*N*FLOAT where N is the number of nodes in the mesh (as defined in the header section),
 DIM is the dimension,
 and FLOAT is the size of a single precision floating point number (4 bytes).
 The order of the data is (e.g.
 if DIM equals 3),
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ID1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
x1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
y1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
z1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
...
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
IDn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
xn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
yn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
zn
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Here,
 x[i] is the x-coordinate of node i and similarly for y and z.
 
\end_layout

\begin_layout Subsection
Domain Section
\end_layout

\begin_layout Standard
The Domain section lists all domains (i.e.
 element sets) in the mesh.
 Each domain is identified by a DOMAIN section.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOMAIN
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of a domain section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Domain section consists of a list of domains.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each domain is defined by two sub-sections,
 a 
\emph on
domain header
\emph default
 and an 
\emph on
element list
\emph default
.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOMAIN_HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042101
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of domain header
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ELEMENT_LIST
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
list of element connectivity
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Each domain section consists of a header section and an element list.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
domain header
\emph default
 contains the following data fields.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ELEM_TYPE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042102
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
element type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PART_ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042103
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
part ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ELEMENTS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01032104
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
number of elements
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01032105
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
an optional name for this domain
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The domain header section.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The ELEM_TYPE defines the type of elements stored in the domain.
 It can have one of the following values.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ELEM_TYPE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
VALUE
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
HEX8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8-node hexahedron solid element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PENTA6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6-node pentahedron solid element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TET4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node tetrahedron solid element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
QUAD4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4-node quadrilateral shell element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TRI3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3-node triangular shell element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TRUSS2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2-node linear truss element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
HEX20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20-node quadratic hexahedral element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TET10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10-node quadratic tetrahedral element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TET15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15-node quadratic tetrahedral element
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
HEX27
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27-node quadratic hexahedral element
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The supported element types.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The PART_ID corresponds to the ID of one of the parts defined in the Parts section.
 
\end_layout

\begin_layout Standard
The ELEMENTS field is the number of elements in the domain.
\end_layout

\begin_layout Standard
After the domain header the element list follows.
 For each element it defines an ELEMENT data field.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ELEMENT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01042201
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Element ID and connectivity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD*(NE+1)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Each element is defined by an ID and a list of nodes that defines the connectivity.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
If NE is the number of nodes per element,
 then this data field stores NE+1 DWORDS.
 The first DWORD is the element ID,
 a unique number that identifies the element.
 The following NE DWORDs define the element connectivity.
 
\end_layout

\begin_layout Subsection
Surface Section
\end_layout

\begin_layout Standard
The surface section defines the surfaces of the mesh for which data is stored in the plot file.
 Each surface begins with a SURFACE section.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of a surface section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Surface section consists of a list of surface definitions.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface section follows a similar structure as the domain section,
 namely a
\emph on
 surface header
\emph default
 followed by a 
\emph on
facet list
\emph default
.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE_HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043101
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of surface header
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FACET_LIST
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
facet connectivity list
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Each surface is defined by a header section and a facet list.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The surface header contains the following data fields.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE_ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043102
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
surface ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FACETS
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043103
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of facets
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043104
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A name for this surface
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MAX_FACET_NODES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043105
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max nodes per facet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The surface header section.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The SURFACE_ID is a unique identifier and FACETS is the number of facets in the surface.
\end_layout

\begin_layout Standard
The FACET_LIST follows the header and contains a FACET data field for each facet in the surface.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FACET
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01043201
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
facet definition
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD*NF
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
A facet definition.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here,
 NF = MAX_FACET_NODES + 2.
 The first DWORD is a unique identifier (which currently should be ignored).
 The second DWORD is the number of nodes for this facet.
 This also defines the facet type.
 (For instance,
 3 nodes define a triangle,
 4 nodes define a quadrilateral).
 Next,
 the node IDs follow.
 
\end_layout

\begin_layout Subsection
Node Set Section
\end_layout

\begin_layout Standard
The Node Set section defines all the node sets where a node set is a named collection of nodes.
 Each nodeset begins with the NODESET section.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODESET
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of a nodeset section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Node Set section consists of a list of NODESET sections.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Next,
 a header section and a node list section follow.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODESET_HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044101
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of nodeset header
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE_LIST
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
node list
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Each nodeset consists of a header and a list of node numbers.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The header is composed of the following chunks.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODESET_ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044102
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nodeset ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODES
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044104
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of nodes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01044103
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
An optional name for this nodeset
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The node set header.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The node list is a list of all the nodes that belong to this node set.
 All node indices are zero-based.
\end_layout

\begin_layout Subsection
Parts Section
\end_layout

\begin_layout Standard
The Parts section lists the parts defined in the plot file.
 For each part,
 a PART section is written.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PART
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01045100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
beginning of a part definition
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The Part section consists of a list of parts.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Then,
 for each part the following fields are written.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PART_ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01045101
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ID of part
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PART_NAME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x01045102
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name of part
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CHAR64
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
A part definition.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The ID is a unique number that will be used in the domain definitions to refer to this part.
 The NAME is a textual description that can be used by the post-processor to present the part to the user.
\end_layout

\begin_layout Section
State Section
\end_layout

\begin_layout Standard
The 
\emph on
state
\emph default
 section is where all the actual data is stored.
 FEBio will store one state section for each time step in the analysis.
 Each state defines two sub-sections,
 namely the 
\emph on
state header
\emph default
 and the 
\emph on
state data
\emph default
.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STATE_HEADER
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02010000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
state header section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STATE_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
state data section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The State section consists of a header and a data section.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
State Header
\end_layout

\begin_layout Standard
The STATE_HEADER contains the following data field.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STATE_TIME
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02010002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
time stamp of state
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FLOAT
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The state header section.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
State Data Section
\end_layout

\begin_layout Standard
The STATE_DATA section stores the data for this state.
 It is composed of several sub-sections where each section corresponds to a data category as defined in the dictionary.
 The following sub-sections can thus be defined.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GLOBAL_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
define global data section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODE_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020300
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
define nodal data section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOMAIN_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020400
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
define domain data section
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SURFACE_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
define surface data section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Each data section is composed of several child sections.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
Note that FEBio currently doesnt write global data sections.
\end_layout

\begin_layout Standard
Each of these sub-sections follows a similar structure.
 For each of the variables defined in the dictionary corresponding to the data category,
 a STATE_DATA section is defined.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
STATE_DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
defines a data section
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
State Data section.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each state data section has two fields.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Tag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
size
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
REGION_ID
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ID of region
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DWORD
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DATA
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0x02020003
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
actual data
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
?
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
State data sub-sections.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The REGION_ID refers to the ID of the region for which this data variable is defined.
\end_layout

\begin_layout Standard
It is important to note that for node sets,
 a value of zero for the REGION_ID refers to the master node set which is the set containing all the nodes in the model.
 This node set is defined implicitly and will not be part of the list of node sets.
\end_layout

\begin_layout Standard
The DATA field contains the actual data.
 The size of this field is variable and is determined by the data type and storage format as defined in the dictionary as well as the number of items in the corresponding region.
 For example,
 for a domain that has NE elements,
 the size of the DATA field,
 using a type of FLOAT and a storage format of FMT_ITEM will be NE*FLOAT.
 
\end_layout

\begin_layout Standard
When a surface or domain stores its data in the FMT_NODE format,
 then the parser needs to figure out how many nodes are implicitly defined by the region and what the node order is.
 An implicit nodeset can be constructed by simple enumeration:
 each item of the region lists the nodes its visits and no nodes can be visited more than once.
 So for example,
 consider the surface of three faces shown in the figure below.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement document
alignment document
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/FigAppendixD_fig3.png

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Example illustrating enumeration algorithm that defines the node ordering for the implicit node set defined by a surface.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each facet has four nodes.
 The first four nodes of the implicit node set are simply the four nodes of the first element.
 The second element skips its first node,
 since it is already visited,
 add its second node (which becomes node 5) and its third (node 6) and skips its fourth node.
 Similarly,
 the third element adds its second (node 7) and third (node 8) and skips its third and fourth.
 Thus,
 this surface defines an implicit node set containing 6 nodes in the order as shown in figure 3.
 Consequently,
 if this surface stores its data in FMT_NODE format,
 then the corresponding data section will contain six values,
 one for each of the nodes in the implicit node set.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "FEBio3"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
